(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpfsCore = factory()}(typeof self !== 'undefined' ? self : this, function () {
var IpfsCore=(()=>{var K4e=Object.create;var o3=Object.defineProperty;var V4e=Object.getOwnPropertyDescriptor;var z4e=Object.getOwnPropertyNames;var H4e=Object.getPrototypeOf,$4e=Object.prototype.hasOwnProperty;var XC=r=>o3(r,"__esModule",{value:!0});var va=(r=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(r,{get:(e,t)=>(typeof require!="undefined"?require:e)[t]}):r)(function(r){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});var Ue=(r,e)=>()=>(r&&(e=r(r=0)),e);var m=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Tt=(r,e)=>{XC(r);for(var t in e)o3(r,t,{get:e[t],enumerable:!0})},G4e=(r,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of z4e(e))!$4e.call(r,i)&&i!=="default"&&o3(r,i,{get:()=>e[i],enumerable:!(t=V4e(e,i))||t.enumerable});return r},R=r=>G4e(XC(o3(r!=null?K4e(H4e(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var JC=m(a3=>{f();"use strict";a3.byteLength=Y4e;a3.toByteArray=Q4e;a3.fromByteArray=e6e;var Ea=[],Ls=[],W4e=typeof Uint8Array!="undefined"?Uint8Array:Array,C_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Of=0,QC=C_.length;Of<QC;++Of)Ea[Of]=C_[Of],Ls[C_.charCodeAt(Of)]=Of;var Of,QC;Ls["-".charCodeAt(0)]=62;Ls["_".charCodeAt(0)]=63;function ZC(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function Y4e(r){var e=ZC(r),t=e[0],i=e[1];return(t+i)*3/4-i}function X4e(r,e,t){return(e+t)*3/4-t}function Q4e(r){var e,t=ZC(r),i=t[0],n=t[1],s=new W4e(X4e(r,i,n)),o=0,a=n>0?i-4:i,c;for(c=0;c<a;c+=4)e=Ls[r.charCodeAt(c)]<<18|Ls[r.charCodeAt(c+1)]<<12|Ls[r.charCodeAt(c+2)]<<6|Ls[r.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return n===2&&(e=Ls[r.charCodeAt(c)]<<2|Ls[r.charCodeAt(c+1)]>>4,s[o++]=e&255),n===1&&(e=Ls[r.charCodeAt(c)]<<10|Ls[r.charCodeAt(c+1)]<<4|Ls[r.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function Z4e(r){return Ea[r>>18&63]+Ea[r>>12&63]+Ea[r>>6&63]+Ea[r&63]}function J4e(r,e,t){for(var i,n=[],s=e;s<t;s+=3)i=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),n.push(Z4e(i));return n.join("")}function e6e(r){for(var e,t=r.length,i=t%3,n=[],s=16383,o=0,a=t-i;o<a;o+=s)n.push(J4e(r,o,o+s>a?a:o+s));return i===1?(e=r[t-1],n.push(Ea[e>>2]+Ea[e<<4&63]+"==")):i===2&&(e=(r[t-2]<<8)+r[t-1],n.push(Ea[e>>10]+Ea[e>>4&63]+Ea[e<<2&63]+"=")),n.join("")}});var eO=m(O_=>{f();O_.read=function(r,e,t,i,n){var s,o,a=n*8-i-1,c=(1<<a)-1,u=c>>1,l=-7,d=t?n-1:0,h=t?-1:1,p=r[e+d];for(d+=h,s=p&(1<<-l)-1,p>>=-l,l+=a;l>0;s=s*256+r[e+d],d+=h,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=i;l>0;o=o*256+r[e+d],d+=h,l-=8);if(s===0)s=1-u;else{if(s===c)return o?NaN:(p?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-u}return(p?-1:1)*o*Math.pow(2,s-i)};O_.write=function(r,e,t,i,n,s){var o,a,c,u=s*8-n-1,l=(1<<u)-1,d=l>>1,h=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,y=i?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+d>=1?e+=h/c:e+=h*Math.pow(2,1-d),e*c>=2&&(o++,c/=2),o+d>=l?(a=0,o=l):o+d>=1?(a=(e*c-1)*Math.pow(2,n),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,n),o=0));n>=8;r[t+p]=a&255,p+=y,a/=256,n-=8);for(o=o<<n|a,u+=n;u>0;r[t+p]=o&255,p+=y,o/=256,u-=8);r[t+p-y]|=g*128}});var ci=m(Bh=>{f();"use strict";var k_=JC(),kh=eO(),tO=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Bh.Buffer=oe;Bh.SlowBuffer=o6e;Bh.INSPECT_MAX_BYTES=50;var c3=2147483647;Bh.kMaxLength=c3;oe.TYPED_ARRAY_SUPPORT=t6e();!oe.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function t6e(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch(r){return!1}}Object.defineProperty(oe.prototype,"parent",{enumerable:!0,get:function(){if(!!oe.isBuffer(this))return this.buffer}});Object.defineProperty(oe.prototype,"offset",{enumerable:!0,get:function(){if(!!oe.isBuffer(this))return this.byteOffset}});function Nc(r){if(r>c3)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,oe.prototype),e}function oe(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return D_(r)}return rO(r,e,t)}oe.poolSize=8192;function rO(r,e,t){if(typeof r=="string")return i6e(r,e);if(ArrayBuffer.isView(r))return n6e(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(Sa(r,ArrayBuffer)||r&&Sa(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(Sa(r,SharedArrayBuffer)||r&&Sa(r.buffer,SharedArrayBuffer)))return B_(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return oe.from(i,e,t);let n=s6e(r);if(n)return n;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return oe.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}oe.from=function(r,e,t){return rO(r,e,t)};Object.setPrototypeOf(oe.prototype,Uint8Array.prototype);Object.setPrototypeOf(oe,Uint8Array);function iO(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function r6e(r,e,t){return iO(r),r<=0?Nc(r):e!==void 0?typeof t=="string"?Nc(r).fill(e,t):Nc(r).fill(e):Nc(r)}oe.alloc=function(r,e,t){return r6e(r,e,t)};function D_(r){return iO(r),Nc(r<0?0:L_(r)|0)}oe.allocUnsafe=function(r){return D_(r)};oe.allocUnsafeSlow=function(r){return D_(r)};function i6e(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!oe.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=nO(r,e)|0,i=Nc(t),n=i.write(r,e);return n!==t&&(i=i.slice(0,n)),i}function N_(r){let e=r.length<0?0:L_(r.length)|0,t=Nc(e);for(let i=0;i<e;i+=1)t[i]=r[i]&255;return t}function n6e(r){if(Sa(r,Uint8Array)){let e=new Uint8Array(r);return B_(e.buffer,e.byteOffset,e.byteLength)}return N_(r)}function B_(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,oe.prototype),i}function s6e(r){if(oe.isBuffer(r)){let e=L_(r.length)|0,t=Nc(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||q_(r.length)?Nc(0):N_(r);if(r.type==="Buffer"&&Array.isArray(r.data))return N_(r.data)}function L_(r){if(r>=c3)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c3.toString(16)+" bytes");return r|0}function o6e(r){return+r!=r&&(r=0),oe.alloc(+r)}oe.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==oe.prototype};oe.compare=function(e,t){if(Sa(e,Uint8Array)&&(e=oe.from(e,e.offset,e.byteLength)),Sa(t,Uint8Array)&&(t=oe.from(t,t.offset,t.byteLength)),!oe.isBuffer(e)||!oe.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,n=t.length;for(let s=0,o=Math.min(i,n);s<o;++s)if(e[s]!==t[s]){i=e[s],n=t[s];break}return i<n?-1:n<i?1:0};oe.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};oe.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return oe.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;let n=oe.allocUnsafe(t),s=0;for(i=0;i<e.length;++i){let o=e[i];if(Sa(o,Uint8Array))s+o.length>n.length?(oe.isBuffer(o)||(o=oe.from(o)),o.copy(n,s)):Uint8Array.prototype.set.call(n,o,s);else if(oe.isBuffer(o))o.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return n};function nO(r,e){if(oe.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||Sa(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return j_(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return gO(r).length;default:if(n)return i?-1:j_(r).length;e=(""+e).toLowerCase(),n=!0}}oe.byteLength=nO;function a6e(r,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return m6e(this,e,t);case"utf8":case"utf-8":return aO(this,e,t);case"ascii":return y6e(this,e,t);case"latin1":case"binary":return g6e(this,e,t);case"base64":return h6e(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b6e(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}oe.prototype._isBuffer=!0;function kf(r,e,t){let i=r[e];r[e]=r[t],r[t]=i}oe.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)kf(this,t,t+1);return this};oe.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)kf(this,t,t+3),kf(this,t+1,t+2);return this};oe.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)kf(this,t,t+7),kf(this,t+1,t+6),kf(this,t+2,t+5),kf(this,t+3,t+4);return this};oe.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?aO(this,0,e):a6e.apply(this,arguments)};oe.prototype.toLocaleString=oe.prototype.toString;oe.prototype.equals=function(e){if(!oe.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:oe.compare(this,e)===0};oe.prototype.inspect=function(){let e="",t=Bh.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};tO&&(oe.prototype[tO]=oe.prototype.inspect);oe.prototype.compare=function(e,t,i,n,s){if(Sa(e,Uint8Array)&&(e=oe.from(e,e.offset,e.byteLength)),!oe.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),t<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=i)return 0;if(n>=s)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;let o=s-n,a=i-t,c=Math.min(o,a),u=this.slice(n,s),l=e.slice(t,i);for(let d=0;d<c;++d)if(u[d]!==l[d]){o=u[d],a=l[d];break}return o<a?-1:a<o?1:0};function sO(r,e,t,i,n){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,q_(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0)if(n)t=0;else return-1;if(typeof e=="string"&&(e=oe.from(e,i)),oe.isBuffer(e))return e.length===0?-1:oO(r,e,t,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):oO(r,[e],t,i,n);throw new TypeError("val must be string, number or Buffer")}function oO(r,e,t,i,n){let s=1,o=r.length,a=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;s=2,o/=2,a/=2,t/=2}function c(l,d){return s===1?l[d]:l.readUInt16BE(d*s)}let u;if(n){let l=-1;for(u=t;u<o;u++)if(c(r,u)===c(e,l===-1?0:u-l)){if(l===-1&&(l=u),u-l+1===a)return l*s}else l!==-1&&(u-=u-l),l=-1}else for(t+a>o&&(t=o-a),u=t;u>=0;u--){let l=!0;for(let d=0;d<a;d++)if(c(r,u+d)!==c(e,d)){l=!1;break}if(l)return u}return-1}oe.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1};oe.prototype.indexOf=function(e,t,i){return sO(this,e,t,i,!0)};oe.prototype.lastIndexOf=function(e,t,i){return sO(this,e,t,i,!1)};function c6e(r,e,t,i){t=Number(t)||0;let n=r.length-t;i?(i=Number(i),i>n&&(i=n)):i=n;let s=e.length;i>s/2&&(i=s/2);let o;for(o=0;o<i;++o){let a=parseInt(e.substr(o*2,2),16);if(q_(a))return o;r[t+o]=a}return o}function u6e(r,e,t,i){return u3(j_(e,r.length-t),r,t,i)}function l6e(r,e,t,i){return u3(E6e(e),r,t,i)}function f6e(r,e,t,i){return u3(gO(e),r,t,i)}function d6e(r,e,t,i){return u3(S6e(e,r.length-t),r,t,i)}oe.prototype.write=function(e,t,i,n){if(t===void 0)n="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")n=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-t;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return c6e(this,e,t,i);case"utf8":case"utf-8":return u6e(this,e,t,i);case"ascii":case"latin1":case"binary":return l6e(this,e,t,i);case"base64":return f6e(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return d6e(this,e,t,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};oe.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function h6e(r,e,t){return e===0&&t===r.length?k_.fromByteArray(r):k_.fromByteArray(r.slice(e,t))}function aO(r,e,t){t=Math.min(r.length,t);let i=[],n=e;for(;n<t;){let s=r[n],o=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a<=t){let c,u,l,d;switch(a){case 1:s<128&&(o=s);break;case 2:c=r[n+1],(c&192)==128&&(d=(s&31)<<6|c&63,d>127&&(o=d));break;case 3:c=r[n+1],u=r[n+2],(c&192)==128&&(u&192)==128&&(d=(s&15)<<12|(c&63)<<6|u&63,d>2047&&(d<55296||d>57343)&&(o=d));break;case 4:c=r[n+1],u=r[n+2],l=r[n+3],(c&192)==128&&(u&192)==128&&(l&192)==128&&(d=(s&15)<<18|(c&63)<<12|(u&63)<<6|l&63,d>65535&&d<1114112&&(o=d))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),n+=a}return p6e(i)}var cO=4096;function p6e(r){let e=r.length;if(e<=cO)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=cO));return t}function y6e(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]&127);return i}function g6e(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]);return i}function m6e(r,e,t){let i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let n="";for(let s=e;s<t;++s)n+=R6e[r[s]];return n}function b6e(r,e,t){let i=r.slice(e,t),n="";for(let s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}oe.prototype.slice=function(e,t){let i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);let n=this.subarray(e,t);return Object.setPrototypeOf(n,oe.prototype),n};function Ki(r,e,t){if(r%1!=0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}oe.prototype.readUintLE=oe.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||Ki(e,t,this.length);let n=this[e],s=1,o=0;for(;++o<t&&(s*=256);)n+=this[e+o]*s;return n};oe.prototype.readUintBE=oe.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||Ki(e,t,this.length);let n=this[e+--t],s=1;for(;t>0&&(s*=256);)n+=this[e+--t]*s;return n};oe.prototype.readUint8=oe.prototype.readUInt8=function(e,t){return e=e>>>0,t||Ki(e,1,this.length),this[e]};oe.prototype.readUint16LE=oe.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||Ki(e,2,this.length),this[e]|this[e+1]<<8};oe.prototype.readUint16BE=oe.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||Ki(e,2,this.length),this[e]<<8|this[e+1]};oe.prototype.readUint32LE=oe.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||Ki(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};oe.prototype.readUint32BE=oe.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||Ki(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};oe.prototype.readBigUInt64LE=qu(function(e){e=e>>>0,Nh(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&oy(e,this.length-8);let n=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))});oe.prototype.readBigUInt64BE=qu(function(e){e=e>>>0,Nh(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&oy(e,this.length-8);let n=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(s)});oe.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||Ki(e,t,this.length);let n=this[e],s=1,o=0;for(;++o<t&&(s*=256);)n+=this[e+o]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n};oe.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||Ki(e,t,this.length);let n=t,s=1,o=this[e+--n];for(;n>0&&(s*=256);)o+=this[e+--n]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*t)),o};oe.prototype.readInt8=function(e,t){return e=e>>>0,t||Ki(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};oe.prototype.readInt16LE=function(e,t){e=e>>>0,t||Ki(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};oe.prototype.readInt16BE=function(e,t){e=e>>>0,t||Ki(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};oe.prototype.readInt32LE=function(e,t){return e=e>>>0,t||Ki(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};oe.prototype.readInt32BE=function(e,t){return e=e>>>0,t||Ki(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};oe.prototype.readBigInt64LE=qu(function(e){e=e>>>0,Nh(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&oy(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});oe.prototype.readBigInt64BE=qu(function(e){e=e>>>0,Nh(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&oy(e,this.length-8);let n=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});oe.prototype.readFloatLE=function(e,t){return e=e>>>0,t||Ki(e,4,this.length),kh.read(this,e,!0,23,4)};oe.prototype.readFloatBE=function(e,t){return e=e>>>0,t||Ki(e,4,this.length),kh.read(this,e,!1,23,4)};oe.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||Ki(e,8,this.length),kh.read(this,e,!0,52,8)};oe.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||Ki(e,8,this.length),kh.read(this,e,!1,52,8)};function zn(r,e,t,i,n,s){if(!oe.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}oe.prototype.writeUintLE=oe.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;zn(this,e,t,i,a,0)}let s=1,o=0;for(this[t]=e&255;++o<i&&(s*=256);)this[t+o]=e/s&255;return t+i};oe.prototype.writeUintBE=oe.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;zn(this,e,t,i,a,0)}let s=i-1,o=1;for(this[t+s]=e&255;--s>=0&&(o*=256);)this[t+s]=e/o&255;return t+i};oe.prototype.writeUint8=oe.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||zn(this,e,t,1,255,0),this[t]=e&255,t+1};oe.prototype.writeUint16LE=oe.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||zn(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};oe.prototype.writeUint16BE=oe.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||zn(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};oe.prototype.writeUint32LE=oe.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||zn(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};oe.prototype.writeUint32BE=oe.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||zn(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function uO(r,e,t,i,n){yO(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,t}function lO(r,e,t,i,n){yO(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t+7]=s,s=s>>8,r[t+6]=s,s=s>>8,r[t+5]=s,s=s>>8,r[t+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=o,o=o>>8,r[t+2]=o,o=o>>8,r[t+1]=o,o=o>>8,r[t]=o,t+8}oe.prototype.writeBigUInt64LE=qu(function(e,t=0){return uO(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});oe.prototype.writeBigUInt64BE=qu(function(e,t=0){return lO(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});oe.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let c=Math.pow(2,8*i-1);zn(this,e,t,i,c-1,-c)}let s=0,o=1,a=0;for(this[t]=e&255;++s<i&&(o*=256);)e<0&&a===0&&this[t+s-1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i};oe.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let c=Math.pow(2,8*i-1);zn(this,e,t,i,c-1,-c)}let s=i-1,o=1,a=0;for(this[t+s]=e&255;--s>=0&&(o*=256);)e<0&&a===0&&this[t+s+1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i};oe.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||zn(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};oe.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||zn(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};oe.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||zn(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};oe.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||zn(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};oe.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||zn(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};oe.prototype.writeBigInt64LE=qu(function(e,t=0){return uO(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});oe.prototype.writeBigInt64BE=qu(function(e,t=0){return lO(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function fO(r,e,t,i,n,s){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function dO(r,e,t,i,n){return e=+e,t=t>>>0,n||fO(r,e,t,4,34028234663852886e22,-34028234663852886e22),kh.write(r,e,t,i,23,4),t+4}oe.prototype.writeFloatLE=function(e,t,i){return dO(this,e,t,!0,i)};oe.prototype.writeFloatBE=function(e,t,i){return dO(this,e,t,!1,i)};function hO(r,e,t,i,n){return e=+e,t=t>>>0,n||fO(r,e,t,8,17976931348623157e292,-17976931348623157e292),kh.write(r,e,t,i,52,8),t+8}oe.prototype.writeDoubleLE=function(e,t,i){return hO(this,e,t,!0,i)};oe.prototype.writeDoubleBE=function(e,t,i){return hO(this,e,t,!1,i)};oe.prototype.copy=function(e,t,i,n){if(!oe.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);let s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),s};oe.prototype.fill=function(e,t,i,n){if(typeof e=="string"){if(typeof t=="string"?(n=t,t=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!oe.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let o=e.charCodeAt(0);(n==="utf8"&&o<128||n==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let s;if(typeof e=="number")for(s=t;s<i;++s)this[s]=e;else{let o=oe.isBuffer(e)?e:oe.from(e,n),a=o.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=o[s%a]}return this};var Dh={};function M_(r,e,t){Dh[r]=class extends t{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}M_("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);M_("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);M_("ERR_OUT_OF_RANGE",function(r,e,t){let i=`The value of "${r}" is out of range.`,n=t;return Number.isInteger(t)&&Math.abs(t)>2**32?n=pO(String(t)):typeof t=="bigint"&&(n=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(n=pO(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function pO(r){let e="",t=r.length,i=r[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function w6e(r,e,t){Nh(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&oy(e,r.length-(t+1))}function yO(r,e,t,i,n,s){if(r>t||r<e){let o=typeof e=="bigint"?"n":"",a;throw s>3?e===0||e===BigInt(0)?a=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:a=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:a=`>= ${e}${o} and <= ${t}${o}`,new Dh.ERR_OUT_OF_RANGE("value",a,r)}w6e(i,n,s)}function Nh(r,e){if(typeof r!="number")throw new Dh.ERR_INVALID_ARG_TYPE(e,"number",r)}function oy(r,e,t){throw Math.floor(r)!==r?(Nh(r,t),new Dh.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new Dh.ERR_BUFFER_OUT_OF_BOUNDS:new Dh.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}var _6e=/[^+/0-9A-Za-z-_]/g;function v6e(r){if(r=r.split("=")[0],r=r.trim().replace(_6e,""),r.length<2)return"";for(;r.length%4!=0;)r=r+"=";return r}function j_(r,e){e=e||1/0;let t,i=r.length,n=null,s=[];for(let o=0;o<i;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function E6e(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function S6e(r,e){let t,i,n,s=[];for(let o=0;o<r.length&&!((e-=2)<0);++o)t=r.charCodeAt(o),i=t>>8,n=t%256,s.push(n),s.push(i);return s}function gO(r){return k_.toByteArray(v6e(r))}function u3(r,e,t,i){let n;for(n=0;n<i&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function Sa(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function q_(r){return r!==r}var R6e=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let i=t*16;for(let n=0;n<16;++n)e[i+n]=r[t]+r[n]}return e}();function qu(r){return typeof BigInt=="undefined"?A6e:r}function A6e(){throw new Error("BigInt not supported")}});var vO=m((xJe,_O)=>{f();var ui=_O.exports={},Ra,Aa;function U_(){throw new Error("setTimeout has not been defined")}function F_(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Ra=setTimeout:Ra=U_}catch(r){Ra=U_}try{typeof clearTimeout=="function"?Aa=clearTimeout:Aa=F_}catch(r){Aa=F_}})();function mO(r){if(Ra===setTimeout)return setTimeout(r,0);if((Ra===U_||!Ra)&&setTimeout)return Ra=setTimeout,setTimeout(r,0);try{return Ra(r,0)}catch(e){try{return Ra.call(null,r,0)}catch(t){return Ra.call(this,r,0)}}}function x6e(r){if(Aa===clearTimeout)return clearTimeout(r);if((Aa===F_||!Aa)&&clearTimeout)return Aa=clearTimeout,clearTimeout(r);try{return Aa(r)}catch(e){try{return Aa.call(null,r)}catch(t){return Aa.call(this,r)}}}var Bc=[],Lh=!1,Df,l3=-1;function I6e(){!Lh||!Df||(Lh=!1,Df.length?Bc=Df.concat(Bc):l3=-1,Bc.length&&bO())}function bO(){if(!Lh){var r=mO(I6e);Lh=!0;for(var e=Bc.length;e;){for(Df=Bc,Bc=[];++l3<e;)Df&&Df[l3].run();l3=-1,e=Bc.length}Df=null,Lh=!1,x6e(r)}}ui.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];Bc.push(new wO(r,e)),Bc.length===1&&!Lh&&mO(bO)};function wO(r,e){this.fun=r,this.array=e}wO.prototype.run=function(){this.fun.apply(null,this.array)};ui.title="browser";ui.browser=!0;ui.env={};ui.argv=[];ui.version="";ui.versions={};function Lc(){}ui.on=Lc;ui.addListener=Lc;ui.once=Lc;ui.off=Lc;ui.removeListener=Lc;ui.removeAllListeners=Lc;ui.emit=Lc;ui.prependListener=Lc;ui.prependOnceListener=Lc;ui.listeners=function(r){return[]};ui.binding=function(r){throw new Error("process.binding is not supported")};ui.cwd=function(){return"/"};ui.chdir=function(r){throw new Error("process.chdir is not supported")};ui.umask=function(){return 0}});var Buffer,process,f=Ue(()=>{({Buffer}=ci()),process=vO()});var SO=m((TJe,EO)=>{f();"use strict";EO.exports=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;let e=Object.getPrototypeOf(r);return e===null||e===Object.prototype}});var Uu=m((IO,TO)=>{f();"use strict";var f3=SO(),{hasOwnProperty:RO}=Object.prototype,{propertyIsEnumerable:T6e}=Object,Mh=(r,e,t)=>Object.defineProperty(r,e,{value:t,writable:!0,enumerable:!0,configurable:!0}),P6e=IO,AO={concatArrays:!1,ignoreUndefined:!1},d3=r=>{let e=[];for(let t in r)RO.call(r,t)&&e.push(t);if(Object.getOwnPropertySymbols){let t=Object.getOwnPropertySymbols(r);for(let i of t)T6e.call(r,i)&&e.push(i)}return e};function jh(r){return Array.isArray(r)?C6e(r):f3(r)?O6e(r):r}function C6e(r){let e=r.slice(0,0);return d3(r).forEach(t=>{Mh(e,t,jh(r[t]))}),e}function O6e(r){let e=Object.getPrototypeOf(r)===null?Object.create(null):{};return d3(r).forEach(t=>{Mh(e,t,jh(r[t]))}),e}var xO=(r,e,t,i)=>(t.forEach(n=>{typeof e[n]=="undefined"&&i.ignoreUndefined||(n in r&&r[n]!==Object.getPrototypeOf(r)?Mh(r,n,K_(r[n],e[n],i)):Mh(r,n,jh(e[n])))}),r),k6e=(r,e,t)=>{let i=r.slice(0,0),n=0;return[r,e].forEach(s=>{let o=[];for(let a=0;a<s.length;a++)!RO.call(s,a)||(o.push(String(a)),s===r?Mh(i,n++,s[a]):Mh(i,n++,jh(s[a])));i=xO(i,s,d3(s).filter(a=>!o.includes(a)),t)}),i};function K_(r,e,t){return t.concatArrays&&Array.isArray(r)&&Array.isArray(e)?k6e(r,e,t):!f3(e)||!f3(r)?jh(e):xO(r,e,d3(e),t)}TO.exports=function(...r){let e=K_(jh(AO),this!==P6e&&this||{},AO),t={_:{}};for(let i of r)if(i!==void 0){if(!f3(i))throw new TypeError("`"+i+"` is not an Option Object");t=K_(t,{_:i},e)}return t._}});var V_=m((CJe,CO)=>{f();function D6e(){return typeof window!="undefined"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process!="undefined"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}CO.exports=D6e});var cy=m((OJe,OO)=>{f();"use strict";var N6e=V_(),h3=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,ay=N6e(),B6e=h3&&!ay,L6e=ay&&!h3,M6e=ay&&h3,j6e=typeof va=="function"&&typeof globalThis.process!="undefined"&&typeof globalThis.process.release!="undefined"&&globalThis.process.release.name==="node"&&!ay,q6e=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,U6e=typeof globalThis.process!="undefined"&&typeof globalThis.process.env!="undefined"&&globalThis.process.env.NODE_ENV==="test",F6e=typeof navigator!="undefined"&&navigator.product==="ReactNative";OO.exports={isTest:U6e,isElectron:ay,isElectronMain:L6e,isElectronRenderer:M6e,isNode:j6e,isBrowser:B6e,isWebWorker:q6e,isEnvWithDom:h3,isReactNative:F6e}});var z_=m((kJe,kO)=>{f();var qh=1e3,Uh=qh*60,Fh=Uh*60,Nf=Fh*24,K6e=Nf*7,V6e=Nf*365.25;kO.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return z6e(r);if(t==="number"&&isFinite(r))return e.long?$6e(r):H6e(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function z6e(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!e){var t=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return t*V6e;case"weeks":case"week":case"w":return t*K6e;case"days":case"day":case"d":return t*Nf;case"hours":case"hour":case"hrs":case"hr":case"h":return t*Fh;case"minutes":case"minute":case"mins":case"min":case"m":return t*Uh;case"seconds":case"second":case"secs":case"sec":case"s":return t*qh;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function H6e(r){var e=Math.abs(r);return e>=Nf?Math.round(r/Nf)+"d":e>=Fh?Math.round(r/Fh)+"h":e>=Uh?Math.round(r/Uh)+"m":e>=qh?Math.round(r/qh)+"s":r+"ms"}function $6e(r){var e=Math.abs(r);return e>=Nf?p3(r,e,Nf,"day"):e>=Fh?p3(r,e,Fh,"hour"):e>=Uh?p3(r,e,Uh,"minute"):e>=qh?p3(r,e,qh,"second"):r+" ms"}function p3(r,e,t,i){var n=e>=t*1.5;return Math.round(r/t)+" "+i+(n?"s":"")}});var NO=m((DJe,DO)=>{f();function G6e(r){t.debug=t,t.default=t,t.coerce=c,t.disable=s,t.enable=n,t.enabled=o,t.humanize=z_(),t.destroy=u,Object.keys(r).forEach(l=>{t[l]=r[l]}),t.names=[],t.skips=[],t.formatters={};function e(l){let d=0;for(let h=0;h<l.length;h++)d=(d<<5)-d+l.charCodeAt(h),d|=0;return t.colors[Math.abs(d)%t.colors.length]}t.selectColor=e;function t(l){let d,h=null,p,y;function g(...w){if(!g.enabled)return;let b=g,v=Number(new Date),A=v-(d||v);b.diff=A,b.prev=d,b.curr=v,d=v,w[0]=t.coerce(w[0]),typeof w[0]!="string"&&w.unshift("%O");let k=0;w[0]=w[0].replace(/%([a-zA-Z%])/g,(T,D)=>{if(T==="%%")return"%";k++;let j=t.formatters[D];if(typeof j=="function"){let M=w[k];T=j.call(b,M),w.splice(k,1),k--}return T}),t.formatArgs.call(b,w),(b.log||t.log).apply(b,w)}return g.namespace=l,g.useColors=t.useColors(),g.color=t.selectColor(l),g.extend=i,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(p!==t.namespaces&&(p=t.namespaces,y=t.enabled(l)),y),set:w=>{h=w}}),typeof t.init=="function"&&t.init(g),g}function i(l,d){let h=t(this.namespace+(typeof d=="undefined"?":":d)+l);return h.log=this.log,h}function n(l){t.save(l),t.namespaces=l,t.names=[],t.skips=[];let d,h=(typeof l=="string"?l:"").split(/[\s,]+/),p=h.length;for(d=0;d<p;d++)!h[d]||(l=h[d].replace(/\*/g,".*?"),l[0]==="-"?t.skips.push(new RegExp("^"+l.slice(1)+"$")):t.names.push(new RegExp("^"+l+"$")))}function s(){let l=[...t.names.map(a),...t.skips.map(a).map(d=>"-"+d)].join(",");return t.enable(""),l}function o(l){if(l[l.length-1]==="*")return!0;let d,h;for(d=0,h=t.skips.length;d<h;d++)if(t.skips[d].test(l))return!1;for(d=0,h=t.names.length;d<h;d++)if(t.names[d].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function c(l){return l instanceof Error?l.stack||l.message:l}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}DO.exports=G6e});var le=m((hs,y3)=>{f();hs.formatArgs=Y6e;hs.save=X6e;hs.load=Q6e;hs.useColors=W6e;hs.storage=Z6e();hs.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();hs.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function W6e(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Y6e(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+y3.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,i=0;r[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(t++,n==="%c"&&(i=t))}),r.splice(i,0,e)}hs.log=console.debug||console.log||(()=>{});function X6e(r){try{r?hs.storage.setItem("debug",r):hs.storage.removeItem("debug")}catch(e){}}function Q6e(){let r;try{r=hs.storage.getItem("debug")}catch(e){}return!r&&typeof process!="undefined"&&"env"in process&&(r=process.env.DEBUG),r}function Z6e(){try{return localStorage}catch(r){}}y3.exports=NO()(hs);var{formatters:J6e}=y3.exports;J6e.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var St=m((NJe,LO)=>{f();"use strict";function BO(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function ebe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return BO(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),BO(new n,t)}}LO.exports=ebe});var qO=m((BJe,jO)=>{f();"use strict";function MO(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function tbe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return MO(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),MO(new n,t)}}jO.exports=tbe});var FO=m((LJe,UO)=>{f();"use strict";UO.exports=rbe;function rbe(r,e){for(var t=new Array(arguments.length-1),i=0,n=2,s=!0;n<arguments.length;)t[i++]=arguments[n++];return new Promise(function(a,c){t[i]=function(l){if(s)if(s=!1,l)c(l);else{for(var d=new Array(arguments.length-1),h=0;h<d.length;)d[h++]=arguments[h];a.apply(null,d)}};try{r.apply(e||null,t)}catch(u){s&&(s=!1,c(u))}})}});var HO=m(zO=>{f();"use strict";var g3=zO;g3.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&e.charAt(t)==="=";)++i;return Math.ceil(e.length*3)/4-i};var Kh=new Array(64),KO=new Array(123);for(jo=0;jo<64;)KO[Kh[jo]=jo<26?jo+65:jo<52?jo+71:jo<62?jo-4:jo-59|43]=jo++;var jo;g3.encode=function(e,t,i){for(var n=null,s=[],o=0,a=0,c;t<i;){var u=e[t++];switch(a){case 0:s[o++]=Kh[u>>2],c=(u&3)<<4,a=1;break;case 1:s[o++]=Kh[c|u>>4],c=(u&15)<<2,a=2;break;case 2:s[o++]=Kh[c|u>>6],s[o++]=Kh[u&63],a=0;break}o>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=Kh[c],s[o++]=61,a===1&&(s[o++]=61)),n?(o&&n.push(String.fromCharCode.apply(String,s.slice(0,o))),n.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var VO="invalid encoding";g3.decode=function(e,t,i){for(var n=i,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=KO[c])===void 0)throw Error(VO);switch(s){case 0:o=c,s=1;break;case 1:t[i++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:t[i++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:t[i++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(VO);return i-n};g3.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var GO=m((jJe,$O)=>{f();"use strict";$O.exports=m3;function m3(){this._listeners={}}m3.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this};m3.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===t?i.splice(n,1):++n;return this};m3.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,i)}return this}});var ek=m((qJe,JO)=>{f();"use strict";JO.exports=WO(WO);function WO(r){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),i=t[3]===128;function n(c,u,l){e[0]=c,u[l]=t[0],u[l+1]=t[1],u[l+2]=t[2],u[l+3]=t[3]}function s(c,u,l){e[0]=c,u[l]=t[3],u[l+1]=t[2],u[l+2]=t[1],u[l+3]=t[0]}r.writeFloatLE=i?n:s,r.writeFloatBE=i?s:n;function o(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],e[0]}function a(c,u){return t[3]=c[u],t[2]=c[u+1],t[1]=c[u+2],t[0]=c[u+3],e[0]}r.readFloatLE=i?o:a,r.readFloatBE=i?a:o}():function(){function e(i,n,s,o){var a=n<0?1:0;if(a&&(n=-n),n===0)i(1/n>0?0:2147483648,s,o);else if(isNaN(n))i(2143289344,s,o);else if(n>34028234663852886e22)i((a<<31|2139095040)>>>0,s,o);else if(n<11754943508222875e-54)i((a<<31|Math.round(n/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(n)/Math.LN2),u=Math.round(n*Math.pow(2,-c)*8388608)&8388607;i((a<<31|c+127<<23|u)>>>0,s,o)}}r.writeFloatLE=e.bind(null,YO),r.writeFloatBE=e.bind(null,XO);function t(i,n,s){var o=i(n,s),a=(o>>31)*2+1,c=o>>>23&255,u=o&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}r.readFloatLE=t.bind(null,QO),r.readFloatBE=t.bind(null,ZO)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),i=t[7]===128;function n(c,u,l){e[0]=c,u[l]=t[0],u[l+1]=t[1],u[l+2]=t[2],u[l+3]=t[3],u[l+4]=t[4],u[l+5]=t[5],u[l+6]=t[6],u[l+7]=t[7]}function s(c,u,l){e[0]=c,u[l]=t[7],u[l+1]=t[6],u[l+2]=t[5],u[l+3]=t[4],u[l+4]=t[3],u[l+5]=t[2],u[l+6]=t[1],u[l+7]=t[0]}r.writeDoubleLE=i?n:s,r.writeDoubleBE=i?s:n;function o(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],t[4]=c[u+4],t[5]=c[u+5],t[6]=c[u+6],t[7]=c[u+7],e[0]}function a(c,u){return t[7]=c[u],t[6]=c[u+1],t[5]=c[u+2],t[4]=c[u+3],t[3]=c[u+4],t[2]=c[u+5],t[1]=c[u+6],t[0]=c[u+7],e[0]}r.readDoubleLE=i?o:a,r.readDoubleBE=i?a:o}():function(){function e(i,n,s,o,a,c){var u=o<0?1:0;if(u&&(o=-o),o===0)i(0,a,c+n),i(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))i(0,a,c+n),i(2146959360,a,c+s);else if(o>17976931348623157e292)i(0,a,c+n),i((u<<31|2146435072)>>>0,a,c+s);else{var l;if(o<22250738585072014e-324)l=o/5e-324,i(l>>>0,a,c+n),i((u<<31|l/4294967296)>>>0,a,c+s);else{var d=Math.floor(Math.log(o)/Math.LN2);d===1024&&(d=1023),l=o*Math.pow(2,-d),i(l*4503599627370496>>>0,a,c+n),i((u<<31|d+1023<<20|l*1048576&1048575)>>>0,a,c+s)}}}r.writeDoubleLE=e.bind(null,YO,0,4),r.writeDoubleBE=e.bind(null,XO,4,0);function t(i,n,s,o,a){var c=i(o,a+n),u=i(o,a+s),l=(u>>31)*2+1,d=u>>>20&2047,h=4294967296*(u&1048575)+c;return d===2047?h?NaN:l*(1/0):d===0?l*5e-324*h:l*Math.pow(2,d-1075)*(h+4503599627370496)}r.readDoubleLE=t.bind(null,QO,0,4),r.readDoubleBE=t.bind(null,ZO,4,0)}(),r}function YO(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}function XO(r,e,t){e[t]=r>>>24,e[t+1]=r>>>16&255,e[t+2]=r>>>8&255,e[t+3]=r&255}function QO(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0}function ZO(r,e){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}});var tk=m((exports,module)=>{f();"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var ik=m(rk=>{f();"use strict";var H_=rk;H_.length=function(e){for(var t=0,i=0,n=0;n<e.length;++n)i=e.charCodeAt(n),i<128?t+=1:i<2048?t+=2:(i&64512)==55296&&(e.charCodeAt(n+1)&64512)==56320?(++n,t+=4):t+=3;return t};H_.read=function(e,t,i){var n=i-t;if(n<1)return"";for(var s=null,o=[],a=0,c;t<i;)c=e[t++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[t++]&63:c>239&&c<365?(c=((c&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};H_.write=function(e,t,i){for(var n=i,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=s&63|128):(s&64512)==55296&&((o=e.charCodeAt(a+1))&64512)==56320?(s=65536+((s&1023)<<10)+(o&1023),++a,t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=s&63|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=s&63|128);return i-n}});var sk=m((FJe,nk)=>{f();"use strict";nk.exports=ibe;function ibe(r,e,t){var i=t||8192,n=i>>>1,s=null,o=i;return function(c){if(c<1||c>n)return r(c);o+c>i&&(s=r(i),o=0);var u=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),u}}});var ak=m((KJe,ok)=>{f();"use strict";ok.exports=Vi;var uy=Ku();function Vi(r,e){this.lo=r>>>0,this.hi=e>>>0}var Bf=Vi.zero=new Vi(0,0);Bf.toNumber=function(){return 0};Bf.zzEncode=Bf.zzDecode=function(){return this};Bf.length=function(){return 1};var nbe=Vi.zeroHash="\0\0\0\0\0\0\0\0";Vi.fromNumber=function(e){if(e===0)return Bf;var t=e<0;t&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return t&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new Vi(i,n)};Vi.from=function(e){if(typeof e=="number")return Vi.fromNumber(e);if(uy.isString(e))if(uy.Long)e=uy.Long.fromString(e);else return Vi.fromNumber(parseInt(e,10));return e.low||e.high?new Vi(e.low>>>0,e.high>>>0):Bf};Vi.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+i*4294967296)}return this.lo+this.hi*4294967296};Vi.prototype.toLong=function(e){return uy.Long?new uy.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Fu=String.prototype.charCodeAt;Vi.fromHash=function(e){return e===nbe?Bf:new Vi((Fu.call(e,0)|Fu.call(e,1)<<8|Fu.call(e,2)<<16|Fu.call(e,3)<<24)>>>0,(Fu.call(e,4)|Fu.call(e,5)<<8|Fu.call(e,6)<<16|Fu.call(e,7)<<24)>>>0)};Vi.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Vi.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Vi.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Vi.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}});var Ku=m($_=>{f();"use strict";var Ge=$_;Ge.asPromise=FO();Ge.base64=HO();Ge.EventEmitter=GO();Ge.float=ek();Ge.inquire=tk();Ge.utf8=ik();Ge.pool=sk();Ge.LongBits=ak();Ge.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);Ge.global=Ge.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||$_;Ge.emptyArray=Object.freeze?Object.freeze([]):[];Ge.emptyObject=Object.freeze?Object.freeze({}):{};Ge.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};Ge.isString=function(e){return typeof e=="string"||e instanceof String};Ge.isObject=function(e){return e&&typeof e=="object"};Ge.isset=Ge.isSet=function(e,t){var i=e[t];return i!=null&&e.hasOwnProperty(t)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1};Ge.Buffer=function(){try{var r=Ge.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch(e){return null}}();Ge._Buffer_from=null;Ge._Buffer_allocUnsafe=null;Ge.newBuffer=function(e){return typeof e=="number"?Ge.Buffer?Ge._Buffer_allocUnsafe(e):new Ge.Array(e):Ge.Buffer?Ge._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};Ge.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;Ge.Long=Ge.global.dcodeIO&&Ge.global.dcodeIO.Long||Ge.global.Long||Ge.inquire("long");Ge.key2Re=/^true|false|0|1$/;Ge.key32Re=/^-?(?:0|[1-9][0-9]*)$/;Ge.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;Ge.longToHash=function(e){return e?Ge.LongBits.from(e).toHash():Ge.LongBits.zeroHash};Ge.longFromHash=function(e,t){var i=Ge.LongBits.fromHash(e);return Ge.Long?Ge.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))};function ck(r,e,t){for(var i=Object.keys(e),n=0;n<i.length;++n)(r[i[n]]===void 0||!t)&&(r[i[n]]=e[i[n]]);return r}Ge.merge=ck;Ge.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function uk(r){function e(t,i){if(!(this instanceof e))return new e(t,i);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),i&&ck(this,i)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return r}}),e.prototype.toString=function(){return this.name+": "+this.message},e}Ge.newError=uk;Ge.ProtocolError=uk("ProtocolError");Ge.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var n=Object.keys(this),s=n.length-1;s>-1;--s)if(t[n[s]]===1&&this[n[s]]!==void 0&&this[n[s]]!==null)return n[s]}};Ge.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}};Ge.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};Ge._configure=function(){var r=Ge.Buffer;if(!r){Ge._Buffer_from=Ge._Buffer_allocUnsafe=null;return}Ge._Buffer_from=r.from!==Uint8Array.from&&r.from||function(t,i){return new r(t,i)},Ge._Buffer_allocUnsafe=r.allocUnsafe||function(t){return new r(t)}}});var J_=m((zJe,hk)=>{f();"use strict";hk.exports=Vt;var Ms=Ku(),G_,b3=Ms.LongBits,lk=Ms.base64,fk=Ms.utf8;function ly(r,e,t){this.fn=r,this.len=e,this.next=void 0,this.val=t}function W_(){}function sbe(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function Vt(){this.len=0,this.head=new ly(W_,0,0),this.tail=this.head,this.states=null}var dk=function(){return Ms.Buffer?function(){return(Vt.create=function(){return new G_})()}:function(){return new Vt}};Vt.create=dk();Vt.alloc=function(e){return new Ms.Array(e)};Ms.Array!==Array&&(Vt.alloc=Ms.pool(Vt.alloc,Ms.Array.prototype.subarray));Vt.prototype._push=function(e,t,i){return this.tail=this.tail.next=new ly(e,t,i),this.len+=t,this};function Y_(r,e,t){e[t]=r&255}function obe(r,e,t){for(;r>127;)e[t++]=r&127|128,r>>>=7;e[t]=r}function X_(r,e){this.len=r,this.next=void 0,this.val=e}X_.prototype=Object.create(ly.prototype);X_.prototype.fn=obe;Vt.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new X_((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Vt.prototype.int32=function(e){return e<0?this._push(Q_,10,b3.fromNumber(e)):this.uint32(e)};Vt.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Q_(r,e,t){for(;r.hi;)e[t++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)e[t++]=r.lo&127|128,r.lo=r.lo>>>7;e[t++]=r.lo}Vt.prototype.uint64=function(e){var t=b3.from(e);return this._push(Q_,t.length(),t)};Vt.prototype.int64=Vt.prototype.uint64;Vt.prototype.sint64=function(e){var t=b3.from(e).zzEncode();return this._push(Q_,t.length(),t)};Vt.prototype.bool=function(e){return this._push(Y_,1,e?1:0)};function Z_(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}Vt.prototype.fixed32=function(e){return this._push(Z_,4,e>>>0)};Vt.prototype.sfixed32=Vt.prototype.fixed32;Vt.prototype.fixed64=function(e){var t=b3.from(e);return this._push(Z_,4,t.lo)._push(Z_,4,t.hi)};Vt.prototype.sfixed64=Vt.prototype.fixed64;Vt.prototype.float=function(e){return this._push(Ms.float.writeFloatLE,4,e)};Vt.prototype.double=function(e){return this._push(Ms.float.writeDoubleLE,8,e)};var abe=Ms.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var n=0;n<e.length;++n)t[i+n]=e[n]};Vt.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(Y_,1,0);if(Ms.isString(e)){var i=Vt.alloc(t=lk.length(e));lk.decode(e,i,0),e=i}return this.uint32(t)._push(abe,t,e)};Vt.prototype.string=function(e){var t=fk.length(e);return t?this.uint32(t)._push(fk.write,t,e):this._push(Y_,1,0)};Vt.prototype.fork=function(){return this.states=new sbe(this),this.head=this.tail=new ly(W_,0,0),this.len=0,this};Vt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new ly(W_,0,0),this.len=0),this};Vt.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this};Vt.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t};Vt._configure=function(r){G_=r,Vt.create=dk(),G_._configure()}});var gk=m((HJe,yk)=>{f();"use strict";yk.exports=xa;var pk=J_();(xa.prototype=Object.create(pk.prototype)).constructor=xa;var Vu=Ku();function xa(){pk.call(this)}xa._configure=function(){xa.alloc=Vu._Buffer_allocUnsafe,xa.writeBytesBuffer=Vu.Buffer&&Vu.Buffer.prototype instanceof Uint8Array&&Vu.Buffer.prototype.set.name==="set"?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var n=0;n<e.length;)t[i++]=e[n++]}};xa.prototype.bytes=function(e){Vu.isString(e)&&(e=Vu._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(xa.writeBytesBuffer,t,e),this};function cbe(r,e,t){r.length<40?Vu.utf8.write(r,e,t):e.utf8Write?e.utf8Write(r,t):e.write(r,t)}xa.prototype.string=function(e){var t=Vu.Buffer.byteLength(e);return this.uint32(t),t&&this._push(cbe,t,e),this};xa._configure()});var rv=m(($Je,vk)=>{f();"use strict";vk.exports=li;var Ia=Ku(),ev,mk=Ia.LongBits,ube=Ia.utf8;function qo(r,e){return RangeError("index out of range: "+r.pos+" + "+(e||1)+" > "+r.len)}function li(r){this.buf=r,this.pos=0,this.len=r.length}var bk=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new li(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new li(e);throw Error("illegal buffer")},wk=function(){return Ia.Buffer?function(t){return(li.create=function(n){return Ia.Buffer.isBuffer(n)?new ev(n):bk(n)})(t)}:bk};li.create=wk();li.prototype._slice=Ia.Array.prototype.subarray||Ia.Array.prototype.slice;li.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,qo(this,10);return e}}();li.prototype.int32=function(){return this.uint32()|0};li.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function tv(){var r=new mk(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw qo(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,r}if(this.len-this.pos>4){for(;e<5;++e)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;e<5;++e){if(this.pos>=this.len)throw qo(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}li.prototype.bool=function(){return this.uint32()!==0};function w3(r,e){return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0}li.prototype.fixed32=function(){if(this.pos+4>this.len)throw qo(this,4);return w3(this.buf,this.pos+=4)};li.prototype.sfixed32=function(){if(this.pos+4>this.len)throw qo(this,4);return w3(this.buf,this.pos+=4)|0};function _k(){if(this.pos+8>this.len)throw qo(this,8);return new mk(w3(this.buf,this.pos+=4),w3(this.buf,this.pos+=4))}li.prototype.float=function(){if(this.pos+4>this.len)throw qo(this,4);var e=Ia.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};li.prototype.double=function(){if(this.pos+8>this.len)throw qo(this,4);var e=Ia.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};li.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw qo(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,i):t===i?new this.buf.constructor(0):this._slice.call(this.buf,t,i)};li.prototype.string=function(){var e=this.bytes();return ube.read(e,0,e.length)};li.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw qo(this,e);this.pos+=e}else do if(this.pos>=this.len)throw qo(this);while(this.buf[this.pos++]&128);return this};li.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!=4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};li._configure=function(r){ev=r,li.create=wk(),ev._configure();var e=Ia.Long?"toLong":"toNumber";Ia.merge(li.prototype,{int64:function(){return tv.call(this)[e](!1)},uint64:function(){return tv.call(this)[e](!0)},sint64:function(){return tv.call(this).zzDecode()[e](!1)},fixed64:function(){return _k.call(this)[e](!0)},sfixed64:function(){return _k.call(this)[e](!1)}})}});var Ak=m((GJe,Rk)=>{f();"use strict";Rk.exports=Lf;var Ek=rv();(Lf.prototype=Object.create(Ek.prototype)).constructor=Lf;var Sk=Ku();function Lf(r){Ek.call(this,r)}Lf._configure=function(){Sk.Buffer&&(Lf.prototype._slice=Sk.Buffer.prototype.slice)};Lf.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Lf._configure()});var Ik=m((WJe,xk)=>{f();"use strict";xk.exports=fy;var iv=Ku();(fy.prototype=Object.create(iv.EventEmitter.prototype)).constructor=fy;function fy(r,e,t){if(typeof r!="function")throw TypeError("rpcImpl must be a function");iv.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(t)}fy.prototype.rpcCall=function r(e,t,i,n,s){if(!n)throw TypeError("request must be specified");var o=this;if(!s)return iv.asPromise(r,o,e,t,i,n);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,t[o.requestDelimited?"encodeDelimited":"encode"](n).finish(),function(c,u){if(c)return o.emit("error",c,e),s(c);if(u===null){o.end(!0);return}if(!(u instanceof i))try{u=i[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(l){return o.emit("error",l,e),s(l)}return o.emit("data",u,e),s(null,u)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};fy.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Pk=m(Tk=>{f();"use strict";var lbe=Tk;lbe.Service=Ik()});var Ok=m((XJe,Ck)=>{f();"use strict";Ck.exports={}});var Nk=m(Dk=>{f();"use strict";var Hn=Dk;Hn.build="minimal";Hn.Writer=J_();Hn.BufferWriter=gk();Hn.Reader=rv();Hn.BufferReader=Ak();Hn.util=Ku();Hn.rpc=Pk();Hn.roots=Ok();Hn.configure=kk;function kk(){Hn.util._configure(),Hn.Writer._configure(Hn.BufferWriter),Hn.Reader._configure(Hn.BufferReader)}kk()});var Br=m((ZJe,Bk)=>{f();"use strict";Bk.exports=Nk()});function Fk(r,e,t){e=e||[],t=t||0;for(var i=t;r>=ybe;)e[t++]=r&255|Uk,r/=128;for(;r&pbe;)e[t++]=r&255|Uk,r>>>=7;return e[t]=r|0,Fk.bytes=t-i+1,e}function sv(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o)throw sv.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&Kk)<<i:(s&Kk)*Math.pow(2,i),i+=7}while(s>=mbe);return sv.bytes=n-e,t}var dbe,Uk,hbe,pbe,ybe,gbe,mbe,Kk,bbe,wbe,_be,vbe,Ebe,Sbe,Rbe,Abe,xbe,Ibe,Tbe,Pbe,dy,Vk=Ue(()=>{f();dbe=Fk,Uk=128,hbe=127,pbe=~hbe,ybe=Math.pow(2,31);gbe=sv,mbe=128,Kk=127;bbe=Math.pow(2,7),wbe=Math.pow(2,14),_be=Math.pow(2,21),vbe=Math.pow(2,28),Ebe=Math.pow(2,35),Sbe=Math.pow(2,42),Rbe=Math.pow(2,49),Abe=Math.pow(2,56),xbe=Math.pow(2,63),Ibe=function(r){return r<bbe?1:r<wbe?2:r<_be?3:r<vbe?4:r<Ebe?5:r<Sbe?6:r<Rbe?7:r<Abe?8:r<xbe?9:10},Tbe={encode:dbe,decode:gbe,encodingLength:Ibe},Pbe=Tbe,dy=Pbe});var hy,zh,Hh,v3=Ue(()=>{f();Vk();hy=r=>[dy.decode(r),dy.decode.bytes],zh=(r,e,t=0)=>(dy.encode(r,e,t),e),Hh=r=>dy.encodingLength(r)});var $h={};Tt($h,{coerce:()=>js,empty:()=>Hk,equals:()=>ov,fromHex:()=>Obe,fromString:()=>av,isBinary:()=>kbe,toHex:()=>Cbe,toString:()=>cv});var Hk,Cbe,Obe,ov,js,kbe,av,cv,Hu=Ue(()=>{f();Hk=new Uint8Array(0),Cbe=r=>r.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),""),Obe=r=>{let e=r.match(/../g);return e?new Uint8Array(e.map(t=>parseInt(t,16))):Hk},ov=(r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0},js=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},kbe=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),av=r=>new TextEncoder().encode(r),cv=r=>new TextDecoder().decode(r)});var Wh={};Tt(Wh,{Digest:()=>Gh,create:()=>$u,decode:()=>fi,equals:()=>uv});var $u,fi,uv,Gh,Ji=Ue(()=>{f();Hu();v3();$u=(r,e)=>{let t=e.byteLength,i=Hh(r),n=i+Hh(t),s=new Uint8Array(n+t);return zh(r,s,0),zh(t,s,i),s.set(e,n),new Gh(r,t,e,s)},fi=r=>{let e=js(r),[t,i]=hy(e),[n,s]=hy(e.subarray(i)),o=e.subarray(i+s);if(o.byteLength!==n)throw new Error("Incorrect length");return new Gh(t,n,o,e)},uv=(r,e)=>r===e?!0:r.code===e.code&&r.size===e.size&&ov(r.bytes,e.bytes),Gh=class{constructor(e,t,i,n){this.code=e,this.size=t,this.digest=i,this.bytes=n}}});function Dbe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var n=0;n<r.length;n++){var s=r.charAt(n),o=s.charCodeAt(0);if(t[o]!==255)throw new TypeError(s+" is ambiguous");t[o]=n}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(y){if(y instanceof Uint8Array||(ArrayBuffer.isView(y)?y=new Uint8Array(y.buffer,y.byteOffset,y.byteLength):Array.isArray(y)&&(y=Uint8Array.from(y))),!(y instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(y.length===0)return"";for(var g=0,w=0,b=0,v=y.length;b!==v&&y[b]===0;)b++,g++;for(var A=(v-b)*l+1>>>0,k=new Uint8Array(A);b!==v;){for(var C=y[b],T=0,D=A-1;(C!==0||T<w)&&D!==-1;D--,T++)C+=256*k[D]>>>0,k[D]=C%a>>>0,C=C/a>>>0;if(C!==0)throw new Error("Non-zero carry");w=T,b++}for(var j=A-w;j!==A&&k[j]===0;)j++;for(var M=c.repeat(g);j<A;++j)M+=r.charAt(k[j]);return M}function h(y){if(typeof y!="string")throw new TypeError("Expected String");if(y.length===0)return new Uint8Array;var g=0;if(y[g]!==" "){for(var w=0,b=0;y[g]===c;)w++,g++;for(var v=(y.length-g)*u+1>>>0,A=new Uint8Array(v);y[g];){var k=t[y.charCodeAt(g)];if(k===255)return;for(var C=0,T=v-1;(k!==0||C<b)&&T!==-1;T--,C++)k+=a*A[T]>>>0,A[T]=k%256>>>0,k=k/256>>>0;if(k!==0)throw new Error("Non-zero carry");b=C,g++}if(y[g]!==" "){for(var D=v-b;D!==v&&A[D]===0;)D++;for(var j=new Uint8Array(w+(v-D)),M=w;D!==v;)j[M++]=A[D++];return j}}}function p(y){var g=h(y);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var Nbe,Bbe,$k,Gk=Ue(()=>{f();Nbe=Dbe,Bbe=Nbe,$k=Bbe});var Wk,Yk,Xk,Qk,Zk,E3,Gu,Lbe,Mbe,Xr,Ta=Ue(()=>{f();Gk();Hu();Wk=class{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Yk=class{constructor(e,t,i){this.name=e,this.prefix=t,this.baseDecode=i}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){return Qk(this,e)}},Xk=class{constructor(e){this.decoders=e}or(e){return Qk(this,e)}decode(e){let t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Qk=(r,e)=>new Xk({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}}),Zk=class{constructor(e,t,i,n){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=n,this.encoder=new Wk(e,t,i),this.decoder=new Yk(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},E3=({name:r,prefix:e,encode:t,decode:i})=>new Zk(r,e,t,i),Gu=({prefix:r,name:e,alphabet:t})=>{let{encode:i,decode:n}=$k(t,e);return E3({prefix:r,name:e,encode:i,decode:s=>js(n(s))})},Lbe=(r,e,t,i)=>{let n={};for(let l=0;l<e.length;++l)n[e[l]]=l;let s=r.length;for(;r[s-1]==="=";)--s;let o=new Uint8Array(s*t/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let d=n[r[l]];if(d===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<t|d,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Mbe=(r,e,t)=>{let i=e[e.length-1]==="=",n=(1<<t)-1,s="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,s+=e[n&a>>o];if(o&&(s+=e[n&a<<t-o]),i)for(;s.length*t&7;)s+="=";return s},Xr=({name:r,prefix:e,bitsPerChar:t,alphabet:i})=>E3({prefix:e,name:r,encode(n){return Mbe(n,i,t)},decode(n){return Lbe(n,i,t,r)}})});var Uo={};Tt(Uo,{base58btc:()=>yt,base58flickr:()=>jbe});var yt,jbe,di=Ue(()=>{f();Ta();yt=Gu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),jbe=Gu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var Uc={};Tt(Uc,{base32:()=>ur,base32hex:()=>Ube,base32hexpad:()=>Kbe,base32hexpadupper:()=>Vbe,base32hexupper:()=>Fbe,base32pad:()=>fv,base32padupper:()=>qbe,base32upper:()=>lv,base32z:()=>zbe});var ur,lv,fv,qbe,Ube,Fbe,Kbe,Vbe,zbe,en=Ue(()=>{f();Ta();ur=Xr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),lv=Xr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),fv=Xr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),qbe=Xr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ube=Xr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Fbe=Xr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Kbe=Xr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Vbe=Xr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),zbe=Xr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var Fc={};Tt(Fc,{CID:()=>L});var L,Hbe,$be,Gbe,py,Wbe,Jk,eD,S3,R3,Ybe,Xbe,Qbe,we=Ue(()=>{f();v3();Ji();di();en();Hu();L=class{constructor(e,t,i,n){this.code=t,this.version=e,this.multihash=i,this.bytes=n,this.byteOffset=n.byteOffset,this.byteLength=n.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:R3,byteLength:R3,code:S3,version:S3,multihash:S3,bytes:S3,_baseCache:R3,asCID:R3})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:t}=this;if(e!==py)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Wbe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return L.createV0(t)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,i=$u(e,t);return L.createV1(this.code,i)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&uv(this.multihash,e.multihash)}toString(e){let{bytes:t,version:i,_baseCache:n}=this;switch(i){case 0:return $be(t,n,e||yt.encoder);default:return Gbe(t,n,e||ur.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return Xbe(/^0\.0/,Qbe),!!(e&&(e[eD]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof L)return e;if(e!=null&&e.asCID===e){let{version:t,code:i,multihash:n,bytes:s}=e;return new L(t,i,n,s||Jk(t,i,n.bytes))}else if(e!=null&&e[eD]===!0){let{version:t,multihash:i,code:n}=e,s=fi(i);return L.create(t,n,s)}else return null}static create(e,t,i){if(typeof t!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(t!==py)throw new Error(`Version 0 CID must use dag-pb (code: ${py}) block encoding`);return new L(e,t,i,i.bytes)}case 1:{let n=Jk(e,t,i.bytes);return new L(e,t,i,n)}default:throw new Error("Invalid version")}}static createV0(e){return L.create(0,py,e)}static createV1(e,t){return L.create(1,e,t)}static decode(e){let[t,i]=L.decodeFirst(e);if(i.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=L.inspectBytes(e),i=t.size-t.multihashSize,n=js(e.subarray(i,i+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");let s=n.subarray(t.multihashSize-t.digestSize),o=new Gh(t.multihashCode,t.digestSize,s,n);return[t.version===0?L.createV0(o):L.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0,i=()=>{let[d,h]=hy(e.subarray(t));return t+=h,d},n=i(),s=py;if(n===18?(n=0,t=0):n===1&&(s=i()),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);let o=t,a=i(),c=i(),u=t+c,l=u-o;return{version:n,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,t){let[i,n]=Hbe(e,t),s=L.decode(n);return s._baseCache.set(i,e),s}},Hbe=(r,e)=>{switch(r[0]){case"Q":{let t=e||yt;return[yt.prefix,t.decode(`${yt.prefix}${r}`)]}case yt.prefix:{let t=e||yt;return[yt.prefix,t.decode(r)]}case ur.prefix:{let t=e||ur;return[ur.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}},$be=(r,e,t)=>{let{prefix:i}=t;if(i!==yt.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let n=e.get(i);if(n==null){let s=t.encode(r).slice(1);return e.set(i,s),s}else return n},Gbe=(r,e,t)=>{let{prefix:i}=t,n=e.get(i);if(n==null){let s=t.encode(r);return e.set(i,s),s}else return n},py=112,Wbe=18,Jk=(r,e,t)=>{let i=Hh(r),n=i+Hh(e),s=new Uint8Array(n+t.byteLength);return zh(r,s,0),zh(e,s,i),s.set(t,n),s},eD=Symbol.for("@ipld/js-cid/CID"),S3={writable:!1,configurable:!1,enumerable:!0},R3={writable:!1,enumerable:!1,configurable:!1},Ybe="0.0.0-dev",Xbe=(r,e)=>{if(r.test(Ybe))console.warn(e);else throw new Error(e)},Qbe=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});function fD(r){if(r===null)return"null";if(r===void 0)return"undefined";if(r===!0||r===!1)return"boolean";let e=typeof r;if(u5e.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(r))return"Array";if(f5e(r))return"Buffer";let t=d5e(r);return t||"Object"}function f5e(r){return r&&r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer.call(null,r)}function d5e(r){let e=Object.prototype.toString.call(r).slice(8,-1);if(l5e.includes(e))return e}var u5e,l5e,dD=Ue(()=>{f();u5e=["string","number","bigint","symbol"],l5e=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"]});var $,ge,Tn=Ue(()=>{f();$=class{constructor(e,t,i){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=i}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};$.uint=new $(0,"uint",!0);$.negint=new $(1,"negint",!0);$.bytes=new $(2,"bytes",!0);$.string=new $(3,"string",!0);$.array=new $(4,"array",!1);$.map=new $(5,"map",!1);$.tag=new $(6,"tag",!1);$.float=new $(7,"float",!0);$.false=new $(7,"false",!0);$.true=new $(7,"true",!0);$.null=new $(7,"null",!0);$.undefined=new $(7,"undefined",!0);$.break=new $(7,"break",!0);ge=class{constructor(e,t,i){this.type=e,this.value=t,this.encodedLength=i,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}});function x3(r){return Xh&&globalThis.Buffer.isBuffer(r)}function gy(r){return r instanceof Uint8Array?x3(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r:Uint8Array.from(r)}function gD(r,e){if(x3(r)&&x3(e))return r.compare(e);for(let t=0;t<r.length;t++)if(r[t]!==e[t])return r[t]<e[t]?-1:1;return 0}function mD(r,e=1/0){let t,i=r.length,n=null,s=[];for(let o=0;o<i;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function bD(r,e,t){let i=[];for(;e<t;){let n=r[e],s=null,o=n>239?4:n>223?3:n>191?2:1;if(e+o<=t){let a,c,u,l;switch(o){case 1:n<128&&(s=n);break;case 2:a=r[e+1],(a&192)==128&&(l=(n&31)<<6|a&63,l>127&&(s=l));break;case 3:a=r[e+1],c=r[e+2],(a&192)==128&&(c&192)==128&&(l=(n&15)<<12|(a&63)<<6|c&63,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:a=r[e+1],c=r[e+2],u=r[e+3],(a&192)==128&&(c&192)==128&&(u&192)==128&&(l=(n&15)<<18|(a&63)<<12|(c&63)<<6|u&63,l>65535&&l<1114112&&(s=l))}}s===null?(s=65533,o=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|s&1023),i.push(s),e+=o}return yv(i)}function yv(r){let e=r.length;if(e<=wD)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=wD));return t}var Xh,h5e,p5e,hD,I3,Pa,Qh,pD,yD,wD,Wu=Ue(()=>{f();Xh=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",h5e=new TextDecoder,p5e=new TextEncoder;hD=Xh?(r,e,t)=>t-e>64?globalThis.Buffer.from(r.subarray(e,t)).toString("utf8"):bD(r,e,t):(r,e,t)=>t-e>64?h5e.decode(r.subarray(e,t)):bD(r,e,t),I3=Xh?r=>r.length>64?globalThis.Buffer.from(r):mD(r):r=>r.length>64?p5e.encode(r):mD(r),Pa=r=>Uint8Array.from(r),Qh=Xh?(r,e,t)=>x3(r)?new Uint8Array(r.subarray(e,t)):r.slice(e,t):(r,e,t)=>r.slice(e,t),pD=Xh?(r,e)=>(r=r.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),gy(globalThis.Buffer.concat(r,e))):(r,e)=>{let t=new Uint8Array(e),i=0;for(let n of r)i+n.length>t.length&&(n=n.subarray(0,t.length-i)),t.set(n,i),i+=n.length;return t},yD=Xh?r=>globalThis.Buffer.allocUnsafe(r):r=>new Uint8Array(r);wD=4096});var y5e,T3,_D=Ue(()=>{f();Wu();y5e=256,T3=class{constructor(e=y5e){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let n=t.length-(this.maxCursor-this.cursor)-1;t.set(e,n)}else{if(t){let n=t.length-(this.maxCursor-this.cursor)-1;n<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,n),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=yD(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){let i=this.chunks[0];e&&this.cursor>i.length/2?(t=this.cursor===i.length?i:i.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=Qh(i,0,this.cursor)}else t=pD(this.chunks,this.cursor);return e&&this.reset(),t}}});function Vc(r,e,t){if(r.length-e<t)throw new Error(`${Ve} not enough data for type`)}var Ve,Kc,my,ps=Ue(()=>{f();Ve="CBOR decode error:",Kc="CBOR encode error:",my=[];my[23]=1;my[24]=2;my[25]=3;my[26]=5;my[27]=9});function ys(r,e,t){Vc(r,e,1);let i=r[e];if(t.strict===!0&&i<Hi[0])throw new Error(`${Ve} integer encoded in more bytes than necessary (strict decode)`);return i}function gs(r,e,t){Vc(r,e,2);let i=r[e]<<8|r[e+1];if(t.strict===!0&&i<Hi[1])throw new Error(`${Ve} integer encoded in more bytes than necessary (strict decode)`);return i}function ms(r,e,t){Vc(r,e,4);let i=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];if(t.strict===!0&&i<Hi[2])throw new Error(`${Ve} integer encoded in more bytes than necessary (strict decode)`);return i}function bs(r,e,t){Vc(r,e,8);let i=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3],n=r[e+4]*16777216+(r[e+5]<<16)+(r[e+6]<<8)+r[e+7],s=(BigInt(i)<<BigInt(32))+BigInt(n);if(t.strict===!0&&s<Hi[3])throw new Error(`${Ve} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(t.allowBigInt===!0)return s;throw new Error(`${Ve} integers outside of the safe integer range are not supported`)}function vD(r,e,t,i){return new ge($.uint,ys(r,e+1,i),2)}function ED(r,e,t,i){return new ge($.uint,gs(r,e+1,i),3)}function SD(r,e,t,i){return new ge($.uint,ms(r,e+1,i),5)}function RD(r,e,t,i){return new ge($.uint,bs(r,e+1,i),9)}function qs(r,e){return tn(r,0,e.value)}function tn(r,e,t){if(t<Hi[0]){let i=Number(t);r.push([e|i])}else if(t<Hi[1]){let i=Number(t);r.push([e|24,i])}else if(t<Hi[2]){let i=Number(t);r.push([e|25,i>>>8,i&255])}else if(t<Hi[3]){let i=Number(t);r.push([e|26,i>>>24&255,i>>>16&255,i>>>8&255,i&255])}else{let i=BigInt(t);if(i<Hi[4]){let n=[e|27,0,0,0,0,0,0,0],s=Number(i&BigInt(4294967295)),o=Number(i>>BigInt(32)&BigInt(4294967295));n[8]=s&255,s=s>>8,n[7]=s&255,s=s>>8,n[6]=s&255,s=s>>8,n[5]=s&255,n[4]=o&255,o=o>>8,n[3]=o&255,o=o>>8,n[2]=o&255,o=o>>8,n[1]=o&255,r.push(n)}else throw new Error(`${Ve} encountered BigInt larger than allowable range`)}}var Hi,Ca=Ue(()=>{f();Tn();ps();Hi=[24,256,65536,4294967296,BigInt("18446744073709551616")];qs.encodedSize=function(e){return tn.encodedSize(e.value)};tn.encodedSize=function(e){return e<Hi[0]?1:e<Hi[1]?2:e<Hi[2]?3:e<Hi[3]?5:9};qs.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}});function AD(r,e,t,i){return new ge($.negint,-1-ys(r,e+1,i),2)}function xD(r,e,t,i){return new ge($.negint,-1-gs(r,e+1,i),3)}function ID(r,e,t,i){return new ge($.negint,-1-ms(r,e+1,i),5)}function PD(r,e,t,i){let n=bs(r,e+1,i);if(typeof n!="bigint"){let s=-1-n;if(s>=Number.MIN_SAFE_INTEGER)return new ge($.negint,s,9)}if(i.allowBigInt!==!0)throw new Error(`${Ve} integers outside of the safe integer range are not supported`);return new ge($.negint,gv-BigInt(n),9)}function P3(r,e){let t=e.value,i=typeof t=="bigint"?t*gv-TD:t*-1-1;tn(r,e.type.majorEncoded,i)}var gv,TD,mv=Ue(()=>{f();Tn();Ca();ps();gv=BigInt(-1),TD=BigInt(1);P3.encodedSize=function(e){let t=e.value,i=typeof t=="bigint"?t*gv-TD:t*-1-1;return i<Hi[0]?1:i<Hi[1]?2:i<Hi[2]?3:i<Hi[3]?5:9};P3.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0}});function by(r,e,t,i){Vc(r,e,t+i);let n=Qh(r,e+t,e+t+i);return new ge($.bytes,n,t+i)}function CD(r,e,t,i){return by(r,e,1,t)}function OD(r,e,t,i){return by(r,e,2,ys(r,e+1,i))}function kD(r,e,t,i){return by(r,e,3,gs(r,e+1,i))}function DD(r,e,t,i){return by(r,e,5,ms(r,e+1,i))}function ND(r,e,t,i){let n=bs(r,e+1,i);if(typeof n=="bigint")throw new Error(`${Ve} 64-bit integer bytes lengths not supported`);return by(r,e,9,n)}function C3(r){return r.encodedBytes===void 0&&(r.encodedBytes=r.type===$.string?I3(r.value):r.value),r.encodedBytes}function Zh(r,e){let t=C3(e);tn(r,e.type.majorEncoded,t.length),r.push(t)}function g5e(r,e){return r.length<e.length?-1:r.length>e.length?1:gD(r,e)}var O3=Ue(()=>{f();Tn();ps();Ca();Wu();Zh.encodedSize=function(e){let t=C3(e);return tn.encodedSize(t.length)+t.length};Zh.compareTokens=function(e,t){return g5e(C3(e),C3(t))}});function wy(r,e,t,i,n){let s=t+i;Vc(r,e,s);let o=new ge($.string,hD(r,e+t,e+s),s);return n.retainStringBytes===!0&&(o.byteValue=Qh(r,e+t,e+s)),o}function BD(r,e,t,i){return wy(r,e,1,t,i)}function LD(r,e,t,i){return wy(r,e,2,ys(r,e+1,i),i)}function MD(r,e,t,i){return wy(r,e,3,gs(r,e+1,i),i)}function jD(r,e,t,i){return wy(r,e,5,ms(r,e+1,i),i)}function qD(r,e,t,i){let n=bs(r,e+1,i);if(typeof n=="bigint")throw new Error(`${Ve} 64-bit integer string lengths not supported`);return wy(r,e,9,n,i)}var UD,bv=Ue(()=>{f();Tn();ps();Ca();O3();Wu();UD=Zh});function Jh(r,e,t,i){return new ge($.array,i,t)}function FD(r,e,t,i){return Jh(r,e,1,t)}function KD(r,e,t,i){return Jh(r,e,2,ys(r,e+1,i))}function VD(r,e,t,i){return Jh(r,e,3,gs(r,e+1,i))}function zD(r,e,t,i){return Jh(r,e,5,ms(r,e+1,i))}function HD(r,e,t,i){let n=bs(r,e+1,i);if(typeof n=="bigint")throw new Error(`${Ve} 64-bit integer array lengths not supported`);return Jh(r,e,9,n)}function $D(r,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${Ve} indefinite length items not allowed`);return Jh(r,e,1,1/0)}function k3(r,e){tn(r,$.array.majorEncoded,e.value)}var wv=Ue(()=>{f();Tn();Ca();ps();k3.compareTokens=qs.compareTokens;k3.encodedSize=function(e){return tn.encodedSize(e.value)}});function ep(r,e,t,i){return new ge($.map,i,t)}function GD(r,e,t,i){return ep(r,e,1,t)}function WD(r,e,t,i){return ep(r,e,2,ys(r,e+1,i))}function YD(r,e,t,i){return ep(r,e,3,gs(r,e+1,i))}function XD(r,e,t,i){return ep(r,e,5,ms(r,e+1,i))}function QD(r,e,t,i){let n=bs(r,e+1,i);if(typeof n=="bigint")throw new Error(`${Ve} 64-bit integer map lengths not supported`);return ep(r,e,9,n)}function ZD(r,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${Ve} indefinite length items not allowed`);return ep(r,e,1,1/0)}function D3(r,e){tn(r,$.map.majorEncoded,e.value)}var _v=Ue(()=>{f();Tn();Ca();ps();D3.compareTokens=qs.compareTokens;D3.encodedSize=function(e){return tn.encodedSize(e.value)}});function JD(r,e,t,i){return new ge($.tag,t,1)}function eN(r,e,t,i){return new ge($.tag,ys(r,e+1,i),2)}function tN(r,e,t,i){return new ge($.tag,gs(r,e+1,i),3)}function rN(r,e,t,i){return new ge($.tag,ms(r,e+1,i),5)}function iN(r,e,t,i){return new ge($.tag,bs(r,e+1,i),9)}function N3(r,e){tn(r,$.tag.majorEncoded,e.value)}var vv=Ue(()=>{f();Tn();Ca();N3.compareTokens=qs.compareTokens;N3.encodedSize=function(e){return tn.encodedSize(e.value)}});function nN(r,e,t,i){if(i.allowUndefined===!1)throw new Error(`${Ve} undefined values are not supported`);return i.coerceUndefinedToNull===!0?new ge($.null,null,1):new ge($.undefined,void 0,1)}function sN(r,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${Ve} indefinite length items not allowed`);return new ge($.break,void 0,1)}function Ev(r,e,t){if(t){if(t.allowNaN===!1&&Number.isNaN(r))throw new Error(`${Ve} NaN values are not supported`);if(t.allowInfinity===!1&&(r===1/0||r===-1/0))throw new Error(`${Ve} Infinity values are not supported`)}return new ge($.float,r,e)}function oN(r,e,t,i){return Ev(Sv(r,e+1),3,i)}function aN(r,e,t,i){return Ev(Rv(r,e+1),5,i)}function cN(r,e,t,i){return Ev(dN(r,e+1),9,i)}function B3(r,e,t){let i=e.value;if(i===!1)r.push([$.float.majorEncoded|m5e]);else if(i===!0)r.push([$.float.majorEncoded|b5e]);else if(i===null)r.push([$.float.majorEncoded|w5e]);else if(i===void 0)r.push([$.float.majorEncoded|_5e]);else{let n,s=!1;(!t||t.float64!==!0)&&(lN(i),n=Sv(Fo,1),i===n||Number.isNaN(i)?(Fo[0]=249,r.push(Fo.slice(0,3)),s=!0):(fN(i),n=Rv(Fo,1),i===n&&(Fo[0]=250,r.push(Fo.slice(0,5)),s=!0))),s||(v5e(i),n=dN(Fo,1),Fo[0]=251,r.push(Fo.slice(0,9)))}}function lN(r){if(r===1/0)Us.setUint16(0,31744,!1);else if(r===-1/0)Us.setUint16(0,64512,!1);else if(Number.isNaN(r))Us.setUint16(0,32256,!1);else{Us.setFloat32(0,r);let e=Us.getUint32(0),t=(e&2139095040)>>23,i=e&8388607;if(t===255)Us.setUint16(0,31744,!1);else if(t===0)Us.setUint16(0,(r&2147483648)>>16|i>>13,!1);else{let n=t-127;n<-24?Us.setUint16(0,0):n<-14?Us.setUint16(0,(e&2147483648)>>16|1<<24+n,!1):Us.setUint16(0,(e&2147483648)>>16|n+15<<10|i>>13,!1)}}}function Sv(r,e){if(r.length-e<2)throw new Error(`${Ve} not enough data for float16`);let t=(r[e]<<8)+r[e+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;let i=t>>10&31,n=t&1023,s;return i===0?s=n*2**-24:i!==31?s=(n+1024)*2**(i-25):s=n===0?1/0:NaN,t&32768?-s:s}function fN(r){Us.setFloat32(0,r,!1)}function Rv(r,e){if(r.length-e<4)throw new Error(`${Ve} not enough data for float32`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,4).getFloat32(0,!1)}function v5e(r){Us.setFloat64(0,r,!1)}function dN(r,e){if(r.length-e<8)throw new Error(`${Ve} not enough data for float64`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,8).getFloat64(0,!1)}var m5e,b5e,w5e,_5e,uN,Us,Fo,Av=Ue(()=>{f();Tn();ps();Ca();m5e=20,b5e=21,w5e=22,_5e=23;B3.encodedSize=function(e,t){let i=e.value;if(i===!1||i===!0||i===null||i===void 0)return 1;if(!t||t.float64!==!0){lN(i);let n=Sv(Fo,1);if(i===n||Number.isNaN(i))return 3;if(fN(i),n=Rv(Fo,1),i===n)return 5}return 9};uN=new ArrayBuffer(9),Us=new DataView(uN,1),Fo=new Uint8Array(uN,0);B3.compareTokens=qs.compareTokens});function Gt(r,e,t){throw new Error(`${Ve} encountered invalid minor (${t}) for major ${r[e]>>>5}`)}function L3(r){return()=>{throw new Error(`${Ve} ${r}`)}}function hN(r){switch(r.type){case $.false:return Pa([244]);case $.true:return Pa([245]);case $.null:return Pa([246]);case $.bytes:return r.value.length?void 0:Pa([64]);case $.string:return r.value===""?Pa([96]):void 0;case $.array:return r.value===0?Pa([128]):void 0;case $.map:return r.value===0?Pa([160]):void 0;case $.uint:return r.value<24?Pa([Number(r.value)]):void 0;case $.negint:if(r.value>=-24)return Pa([31-Number(r.value)])}}var Ae,Ko,xv=Ue(()=>{f();Tn();Ca();mv();O3();bv();wv();_v();vv();Av();ps();Wu();Ae=[];for(let r=0;r<=23;r++)Ae[r]=Gt;Ae[24]=vD;Ae[25]=ED;Ae[26]=SD;Ae[27]=RD;Ae[28]=Gt;Ae[29]=Gt;Ae[30]=Gt;Ae[31]=Gt;for(let r=32;r<=55;r++)Ae[r]=Gt;Ae[56]=AD;Ae[57]=xD;Ae[58]=ID;Ae[59]=PD;Ae[60]=Gt;Ae[61]=Gt;Ae[62]=Gt;Ae[63]=Gt;for(let r=64;r<=87;r++)Ae[r]=CD;Ae[88]=OD;Ae[89]=kD;Ae[90]=DD;Ae[91]=ND;Ae[92]=Gt;Ae[93]=Gt;Ae[94]=Gt;Ae[95]=L3("indefinite length bytes/strings are not supported");for(let r=96;r<=119;r++)Ae[r]=BD;Ae[120]=LD;Ae[121]=MD;Ae[122]=jD;Ae[123]=qD;Ae[124]=Gt;Ae[125]=Gt;Ae[126]=Gt;Ae[127]=L3("indefinite length bytes/strings are not supported");for(let r=128;r<=151;r++)Ae[r]=FD;Ae[152]=KD;Ae[153]=VD;Ae[154]=zD;Ae[155]=HD;Ae[156]=Gt;Ae[157]=Gt;Ae[158]=Gt;Ae[159]=$D;for(let r=160;r<=183;r++)Ae[r]=GD;Ae[184]=WD;Ae[185]=YD;Ae[186]=XD;Ae[187]=QD;Ae[188]=Gt;Ae[189]=Gt;Ae[190]=Gt;Ae[191]=ZD;for(let r=192;r<=215;r++)Ae[r]=JD;Ae[216]=eN;Ae[217]=tN;Ae[218]=rN;Ae[219]=iN;Ae[220]=Gt;Ae[221]=Gt;Ae[222]=Gt;Ae[223]=Gt;for(let r=224;r<=243;r++)Ae[r]=L3("simple values are not supported");Ae[244]=Gt;Ae[245]=Gt;Ae[246]=Gt;Ae[247]=nN;Ae[248]=L3("simple values are not supported");Ae[249]=oN;Ae[250]=aN;Ae[251]=cN;Ae[252]=Gt;Ae[253]=Gt;Ae[254]=Gt;Ae[255]=sN;Ko=[];for(let r=0;r<24;r++)Ko[r]=new ge($.uint,r,1);for(let r=-1;r>=-24;r--)Ko[31-r]=new ge($.negint,r,1);Ko[64]=new ge($.bytes,new Uint8Array(0),1);Ko[96]=new ge($.string,"",1);Ko[128]=new ge($.array,0,1);Ko[160]=new ge($.map,0,1);Ko[244]=new ge($.false,!1,1);Ko[245]=new ge($.true,!0,1);Ko[246]=new ge($.null,null,1)});function S5e(){let r=[];return r[$.uint.major]=qs,r[$.negint.major]=P3,r[$.bytes.major]=Zh,r[$.string.major]=UD,r[$.array.major]=k3,r[$.map.major]=D3,r[$.tag.major]=N3,r[$.float.major]=B3,r}function M3(r,e={},t){let i=fD(r),n=e&&e.typeEncoders&&e.typeEncoders[i]||Xu[i];if(typeof n=="function"){let o=n(r,i,e,t);if(o!=null)return o}let s=Xu[i];if(!s)throw new Error(`${Kc} unsupported type: ${i}`);return s(r,i,e,t)}function R5e(r,e){e.mapSorter&&r.sort(e.mapSorter)}function A5e(r,e){let t=Array.isArray(r[0])?r[0][0]:r[0],i=Array.isArray(e[0])?e[0][0]:e[0];if(t.type!==i.type)return t.type.compare(i.type);let n=t.type.major,s=pN[n].compareTokens(t,i);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function yN(r,e,t,i){if(Array.isArray(e))for(let n of e)yN(r,n,t,i);else t[e.type.major](r,e,i)}function Tv(r,e,t){let i=M3(r,t);if(!Array.isArray(i)&&t.quickEncodeToken){let n=t.quickEncodeToken(i);if(n)return n;let s=e[i.type.major];if(s.encodedSize){let o=s.encodedSize(i,t),a=new T3(o);if(s(a,i,t),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${i} was wrong`);return gy(a.chunks[0])}}return Iv.reset(),yN(Iv,i,e,t),Iv.toBytes(!0)}function $n(r,e){return e=Object.assign({},E5e,e),Tv(r,pN,e)}var E5e,pN,Iv,_y,Yu,Xu,Pv=Ue(()=>{f();dD();Tn();_D();ps();xv();Wu();Ca();mv();O3();bv();wv();_v();vv();Av();E5e={float64:!1,mapSorter:A5e,quickEncodeToken:hN};pN=S5e(),Iv=new T3,_y=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${Kc} object contains circular references`);return new _y(t,e)}},Yu={null:new ge($.null,null),undefined:new ge($.undefined,void 0),true:new ge($.true,!0),false:new ge($.false,!1),emptyArray:new ge($.array,0),emptyMap:new ge($.map,0)},Xu={number(r,e,t,i){return!Number.isInteger(r)||!Number.isSafeInteger(r)?new ge($.float,r):r>=0?new ge($.uint,r):new ge($.negint,r)},bigint(r,e,t,i){return r>=BigInt(0)?new ge($.uint,r):new ge($.negint,r)},Uint8Array(r,e,t,i){return new ge($.bytes,r)},string(r,e,t,i){return new ge($.string,r)},boolean(r,e,t,i){return r?Yu.true:Yu.false},null(r,e,t,i){return Yu.null},undefined(r,e,t,i){return Yu.undefined},ArrayBuffer(r,e,t,i){return new ge($.bytes,new Uint8Array(r))},DataView(r,e,t,i){return new ge($.bytes,new Uint8Array(r.buffer,r.byteOffset,r.byteLength))},Array(r,e,t,i){if(!r.length)return t.addBreakTokens===!0?[Yu.emptyArray,new ge($.break)]:Yu.emptyArray;i=_y.createCheck(i,r);let n=[],s=0;for(let o of r)n[s++]=M3(o,t,i);return t.addBreakTokens?[new ge($.array,r.length),n,new ge($.break)]:[new ge($.array,r.length),n]},Object(r,e,t,i){let n=e!=="Object",s=n?r.keys():Object.keys(r),o=n?r.size:s.length;if(!o)return t.addBreakTokens===!0?[Yu.emptyMap,new ge($.break)]:Yu.emptyMap;i=_y.createCheck(i,r);let a=[],c=0;for(let u of s)a[c++]=[M3(u,t,i),M3(n?r.get(u):r[u],t,i)];return R5e(a,t),t.addBreakTokens?[new ge($.map,o),a,new ge($.break)]:[new ge($.map,o),a]}};Xu.Map=Xu.Object;Xu.Buffer=Xu.Uint8Array;for(let r of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Xu[`${r}Array`]=Xu.DataView});function I5e(r,e,t){let i=[];for(let n=0;n<r.value;n++){let s=Ey(e,t);if(s===j3){if(r.value===1/0)break;throw new Error(`${Ve} got unexpected break to lengthed array`)}if(s===vy)throw new Error(`${Ve} found array but not enough entries (got ${n}, expected ${r.value})`);i[n]=s}return i}function T5e(r,e,t){let i=t.useMaps===!0,n=i?void 0:{},s=i?new Map:void 0;for(let o=0;o<r.value;o++){let a=Ey(e,t);if(a===j3){if(r.value===1/0)break;throw new Error(`${Ve} got unexpected break to lengthed map`)}if(a===vy)throw new Error(`${Ve} found map but not enough entries (got ${o} [no key], expected ${r.value})`);if(i!==!0&&typeof a!="string")throw new Error(`${Ve} non-string keys not supported (got ${typeof a})`);let c=Ey(e,t);if(c===vy)throw new Error(`${Ve} found map but not enough entries (got ${o} [no value], expected ${r.value})`);i?s.set(a,c):n[a]=c}return i?s:n}function Ey(r,e){if(r.done())return vy;let t=r.next();if(t.type===$.break)return j3;if(t.type.terminal)return t.value;if(t.type===$.array)return I5e(t,r,e);if(t.type===$.map)return T5e(t,r,e);if(t.type===$.tag){if(e.tags&&typeof e.tags[t.value]=="function"){let i=Ey(r,e);return e.tags[t.value](i)}throw new Error(`${Ve} tag not supported (${t.value})`)}throw new Error("unsupported")}function wi(r,e){if(!(r instanceof Uint8Array))throw new Error(`${Ve} data to decode must be a Uint8Array`);e=Object.assign({},x5e,e);let t=e.tokenizer||new gN(r,e),i=Ey(t,e);if(i===vy)throw new Error(`${Ve} did not find any content to decode`);if(i===j3)throw new Error(`${Ve} got unexpected break`);if(!t.done())throw new Error(`${Ve} too many terminals, data makes no sense`);return i}var x5e,gN,vy,j3,Cv=Ue(()=>{f();ps();Tn();xv();x5e={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},gN=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=Ko[e];if(t===void 0){let i=Ae[e];if(!i)throw new Error(`${Ve} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let n=e&31;t=i(this.data,this.pos,n,this.options)}return this.pos+=t.encodedLength,t}},vy=Symbol.for("DONE"),j3=Symbol.for("BREAK")});var Qu=Ue(()=>{f();Pv();Cv();Tn()});var tp,wN,q3=Ue(()=>{f();Ji();tp=({name:r,code:e,encode:t})=>new wN(r,e,t),wN=class{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?$u(this.code,t):t.then(i=>$u(this.code,i))}else throw Error("Unknown type, must be binary type")}}});var rp=Ue(()=>{f();we();v3();Hu();q3();Ji()});var Mf={};Tt(Mf,{base64:()=>U3,base64pad:()=>B5e,base64url:()=>F3,base64urlpad:()=>L5e});var U3,B5e,F3,L5e,Zu=Ue(()=>{f();Ta();U3=Xr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),B5e=Xr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),F3=Xr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),L5e=Xr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var jv=m(ip=>{f();"use strict";Object.defineProperty(ip,"__esModule",{value:!0});ip.fromBase64url=ip.toBase64url=void 0;var RN=(Zu(),Mf);function $5e(r){return RN.base64url.encode(r).slice(1)}ip.toBase64url=$5e;function G5e(r){return RN.base64url.decode(`u${r}`)}ip.fromBase64url=G5e});var AN=m(Uv=>{f();"use strict";Object.defineProperty(Uv,"__esModule",{value:!0});var jf=jv(),qv=(we(),Fc);function W5e(r){let[e,t,i]=r;return{payload:t,signatures:[{protected:e,signature:i}],link:qv.CID.decode(jf.fromBase64url(t))}}function Y5e(r){let e={signature:jf.fromBase64url(r.signature)};return r.header&&(e.header=r.header),r.protected&&(e.protected=jf.fromBase64url(r.protected)),e}function X5e(r){let e=jf.fromBase64url(r.payload);try{qv.CID.decode(e)}catch(i){throw new Error("Not a valid DagJWS")}return{payload:e,signatures:r.signatures.map(Y5e)}}function Q5e(r){let e={signature:jf.toBase64url(r.signature)};return r.header&&(e.header=r.header),r.protected&&(e.protected=jf.toBase64url(r.protected)),e}function Z5e(r){let e={payload:jf.toBase64url(r.payload),signatures:r.signatures.map(Q5e)};return e.link=qv.CID.decode(new Uint8Array(r.payload)),e}Uv.default={fromSplit:W5e,encode:X5e,decode:Z5e}});var xN=m(Fv=>{f();"use strict";Object.defineProperty(Fv,"__esModule",{value:!0});var Fs=jv();function J5e(r){let[e,t,i,n,s]=r,o={ciphertext:n,iv:i,protected:e,tag:s};return t&&(o.recipients=[{encrypted_key:t}]),o}function ewe(r){let e={};return r.encrypted_key&&(e.encrypted_key=Fs.fromBase64url(r.encrypted_key)),r.header&&(e.header=r.header),e}function twe(r){let e={ciphertext:Fs.fromBase64url(r.ciphertext),protected:Fs.fromBase64url(r.protected),iv:Fs.fromBase64url(r.iv),tag:Fs.fromBase64url(r.tag)};return r.aad&&(e.aad=Fs.fromBase64url(r.aad)),r.recipients&&(e.recipients=r.recipients.map(ewe)),r.unprotected&&(e.unprotected=r.unprotected),e}function rwe(r){let e={};return r.encrypted_key&&(e.encrypted_key=Fs.toBase64url(r.encrypted_key)),r.header&&(e.header=r.header),e}function iwe(r){let e={ciphertext:Fs.toBase64url(r.ciphertext),protected:Fs.toBase64url(r.protected),iv:Fs.toBase64url(r.iv),tag:Fs.toBase64url(r.tag)};return r.aad&&(e.aad=Fs.toBase64url(r.aad)),r.recipients&&(e.recipients=r.recipients.map(rwe)),r.unprotected&&(e.unprotected=r.unprotected),e}Fv.default={fromSplit:J5e,decode:iwe,encode:twe}});var PN={};Tt(PN,{code:()=>lwe,decode:()=>dwe,encode:()=>fwe,name:()=>uwe});function nwe(r){if(r.asCID!==r)return null;let e=L.asCID(r);if(!e)return null;let t=new Uint8Array(e.bytes.byteLength+1);return t.set(e.bytes,1),[new ge($.tag,IN),new ge($.bytes,t)]}function swe(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function owe(r){if(Number.isNaN(r))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(r===1/0||r===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}function cwe(r){if(r[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return L.decode(r.subarray(1))}var IN,awe,TN,uwe,lwe,fwe,dwe,CN=Ue(()=>{f();Qu();we();IN=42;awe={float64:!0,typeEncoders:{Object:nwe,undefined:swe,number:owe}};TN={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};TN.tags[IN]=cwe;uwe="dag-cbor",lwe=113,fwe=r=>$n(r,awe),dwe=r=>wi(r,TN)});var zv=m(_i=>{f();"use strict";var hwe=_i&&_i.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),pwe=_i&&_i.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),ywe=_i&&_i.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&hwe(e,r,t);return pwe(e,r),e},ON=_i&&_i.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(_i,"__esModule",{value:!0});_i.decode=_i.encode=_i.toGeneral=_i.code=_i.name=void 0;var Kv=ON(AN()),Vv=ON(xN()),kN=ywe((CN(),PN));_i.name="dag-jose";_i.code=133;function DN(r){return"payload"in r&&typeof r.payload=="string"&&"signatures"in r&&Array.isArray(r.signatures)}function gwe(r){return"payload"in r&&r.payload instanceof Uint8Array&&"signatures"in r&&Array.isArray(r.signatures)}function mwe(r){return"ciphertext"in r&&r.ciphertext instanceof Uint8Array&&"iv"in r&&r.iv instanceof Uint8Array&&"protected"in r&&r.protected instanceof Uint8Array&&"tag"in r&&r.tag instanceof Uint8Array}function NN(r){return"ciphertext"in r&&typeof r.ciphertext=="string"&&"iv"in r&&typeof r.iv=="string"&&"protected"in r&&typeof r.protected=="string"&&"tag"in r&&typeof r.tag=="string"}function BN(r){if(typeof r=="string"){let e=r.split(".");if(e.length===3)return Kv.default.fromSplit(e);if(e.length===5)return Vv.default.fromSplit(e);throw new Error("Not a valid JOSE string")}if(DN(r)||NN(r))return r;throw new Error("Not a valid unencoded JOSE object")}_i.toGeneral=BN;function bwe(r){typeof r=="string"&&(r=BN(r));let e;if(DN(r))e=Kv.default.encode(r);else if(NN(r))e=Vv.default.encode(r);else throw new Error("Not a valid JOSE object");return new Uint8Array(kN.encode(e))}_i.encode=bwe;function wwe(r){let e;try{e=kN.decode(r)}catch(t){throw new Error("Not a valid DAG-JOSE object")}if(gwe(e))return Kv.default.decode(e);if(mwe(e))return Vv.default.decode(e);throw new Error("Not a valid DAG-JOSE object")}_i.decode=wwe});var xy={};Tt(xy,{identity:()=>ws});var LN,_we,MN,vwe,ws,zc=Ue(()=>{f();Hu();Ji();LN=0,_we="identity",MN=js,vwe=r=>$u(LN,MN(r)),ws={code:LN,name:_we,encode:MN,digest:vwe}});var Hv={};Tt(Hv,{identity:()=>Ewe});var Ewe,jN=Ue(()=>{f();Ta();Hu();Ewe=E3({prefix:"\0",name:"identity",encode:r=>cv(r),decode:r=>av(r)})});var $v={};Tt($v,{base2:()=>Swe});var Swe,qN=Ue(()=>{f();Ta();Swe=Xr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var Gv={};Tt(Gv,{base8:()=>Rwe});var Rwe,UN=Ue(()=>{f();Ta();Rwe=Xr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var Wv={};Tt(Wv,{base10:()=>Awe});var Awe,FN=Ue(()=>{f();Ta();Awe=Gu({prefix:"9",name:"base10",alphabet:"0123456789"})});var K3={};Tt(K3,{base16:()=>xwe,base16upper:()=>Iwe});var xwe,Iwe,Yv=Ue(()=>{f();Ta();xwe=Xr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Iwe=Xr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var V3={};Tt(V3,{base36:()=>np,base36upper:()=>Twe});var np,Twe,Iy=Ue(()=>{f();Ta();np=Gu({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Twe=Gu({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var Ks={};Tt(Ks,{sha256:()=>Lr,sha512:()=>Pwe});var KN,Lr,Pwe,vi=Ue(()=>{f();q3();KN=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),Lr=tp({name:"sha2-256",code:18,encode:KN("SHA-256")}),Pwe=tp({name:"sha2-512",code:19,encode:KN("SHA-512")})});var Ty={};Tt(Ty,{code:()=>Di,decode:()=>kwe,encode:()=>Owe,name:()=>Cwe});var Cwe,Di,Owe,kwe,Vs=Ue(()=>{f();Hu();Cwe="raw",Di=85,Owe=r=>js(r),kwe=r=>js(r)});var Qv={};Tt(Qv,{code:()=>Xv,decode:()=>Mwe,encode:()=>Lwe,name:()=>Bwe});var Dwe,Nwe,Bwe,Xv,Lwe,Mwe,Zv=Ue(()=>{f();Dwe=new TextEncoder,Nwe=new TextDecoder,Bwe="json",Xv=512,Lwe=r=>Dwe.encode(JSON.stringify(r)),Mwe=r=>JSON.parse(Nwe.decode(r))});var qf,z3,H3,$3=Ue(()=>{f();jN();qN();UN();FN();Yv();en();Iy();di();Zu();vi();zc();Vs();Zv();rp();qf={...Hv,...$v,...Gv,...Wv,...K3,...Uc,...V3,...Uo,...Mf},z3={...Ks,...xy},H3={raw:Ty,json:Qv}});function HN(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}var $N,Jv,jwe,G3,e7=Ue(()=>{f();$3();$N=HN("utf8","u",r=>{let e=new TextDecoder("utf8");return"u"+e.decode(r)},r=>new TextEncoder().encode(r.substring(1))),Jv=HN("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);let e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),jwe={utf8:$N,"utf-8":$N,hex:qf.base16,latin1:Jv,ascii:Jv,binary:Jv,...qf},G3=jwe});var Qr={};Tt(Qr,{fromString:()=>Qe});function Qe(r,e="utf8"){let t=G3[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return t.decoder.decode(`${t.prefix}${r}`)}var ct=Ue(()=>{f();e7()});var r7=m((Krt,WN)=>{f();"use strict";var GN="[a-fA-F\\d:]",tl=r=>r&&r.includeBoundaries?`(?:(?<=\\s|^)(?=${GN})|(?<=${GN})(?=\\s|$))`:"",Vo="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",Ei="[a-fA-F\\d]{1,4}",W3=`
(?:
(?:${Ei}:){7}(?:${Ei}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${Ei}:){6}(?:${Vo}|:${Ei}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${Ei}:){5}(?::${Vo}|(?::${Ei}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${Ei}:){4}(?:(?::${Ei}){0,1}:${Vo}|(?::${Ei}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${Ei}:){3}(?:(?::${Ei}){0,2}:${Vo}|(?::${Ei}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${Ei}:){2}(?:(?::${Ei}){0,3}:${Vo}|(?::${Ei}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${Ei}:){1}(?:(?::${Ei}){0,4}:${Vo}|(?::${Ei}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${Ei}){0,5}:${Vo}|(?::${Ei}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),qwe=new RegExp(`(?:^${Vo}$)|(?:^${W3}$)`),Uwe=new RegExp(`^${Vo}$`),Fwe=new RegExp(`^${W3}$`),t7=r=>r&&r.exact?qwe:new RegExp(`(?:${tl(r)}${Vo}${tl(r)})|(?:${tl(r)}${W3}${tl(r)})`,"g");t7.v4=r=>r&&r.exact?Uwe:new RegExp(`${tl(r)}${Vo}${tl(r)}`,"g");t7.v6=r=>r&&r.exact?Fwe:new RegExp(`${tl(r)}${W3}${tl(r)}`,"g");WN.exports=t7});var n7=m((Vrt,YN)=>{f();"use strict";var i7=r7(),ap=r=>i7({exact:!0}).test(r);ap.v4=r=>i7.v4({exact:!0}).test(r);ap.v6=r=>i7.v6({exact:!0}).test(r);ap.version=r=>ap(r)?ap.v4(r)?4:6:void 0;YN.exports=ap});var sr={};Tt(sr,{toString:()=>$e});function $e(r,e="utf8"){let t=G3[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return t.encoder.encode(r).substring(1)}var tt=Ue(()=>{f();e7()});var eB=m((Hrt,JN)=>{f();"use strict";var s7=n7(),{toString:XN}=(tt(),sr),Kwe=s7,o7=s7.v4,QN=s7.v6,ZN=function(r,e,t){t=~~t;let i;if(o7(r))i=e||new Uint8Array(t+4),r.split(/\./g).map(function(n){i[t++]=parseInt(n,10)&255});else if(QN(r)){let n=r.split(":",8),s;for(s=0;s<n.length;s++){let o=o7(n[s]),a;o&&(a=ZN(n[s]),n[s]=XN(a.slice(0,2),"base16")),a&&++s<8&&n.splice(s,0,XN(a.slice(2,4),"base16"))}if(n[0]==="")for(;n.length<8;)n.unshift("0");else if(n[n.length-1]==="")for(;n.length<8;)n.push("0");else if(n.length<8){for(s=0;s<n.length&&n[s]!=="";s++);let o=[s,"1"];for(s=9-n.length;s>0;s--)o.push("0");n.splice.apply(n,o)}for(i=e||new Uint8Array(t+16),s=0;s<n.length;s++){let o=parseInt(n[s],16);i[t++]=o>>8&255,i[t++]=o&255}}if(!i)throw Error("Invalid ip address: "+r);return i},Vwe=function(r,e,t){e=~~e,t=t||r.length-e;let i=[],n,s=new DataView(r.buffer);if(t===4){for(let o=0;o<t;o++)i.push(r[e+o]);n=i.join(".")}else if(t===16){for(let o=0;o<t;o+=2)i.push(s.getUint16(e+o).toString(16));n=i.join(":"),n=n.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),n=n.replace(/:{3,4}/,"::")}return n};JN.exports={isIP:Kwe,isV4:o7,isV6:QN,toBytes:ZN,toString:Vwe}});var Py=m(($rt,rB)=>{f();"use strict";function Gn(r){if(typeof r=="number"){if(Gn.codes[r])return Gn.codes[r];throw new Error("no protocol with code: "+r)}else if(typeof r=="string"){if(Gn.names[r])return Gn.names[r];throw new Error("no protocol with name: "+r)}throw new Error("invalid protocol id type: "+r)}var zs=-1;Gn.lengthPrefixedVarSize=zs;Gn.V=zs;Gn.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,zs,"ip6zone"],[53,zs,"dns","resolvable"],[54,zs,"dns4","resolvable"],[55,zs,"dns6","resolvable"],[56,zs,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,zs,"unix",!1,"path"],[421,zs,"ipfs"],[421,zs,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,zs,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,zs,"memory"]];Gn.names={};Gn.codes={};Gn.table.map(r=>{let e=tB.apply(null,r);return Gn.codes[e.code]=e,Gn.names[e.name]=e,null});Gn.object=tB;function tB(r,e,t,i,n){return{code:r,size:e,name:t,resolvable:Boolean(i),path:Boolean(n)}}rB.exports=Gn});var sB=m((Grt,nB)=>{f();nB.exports=a7;var iB=128,zwe=127,Hwe=~zwe,$we=Math.pow(2,31);function a7(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw a7.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var i=t;r>=$we;)e[t++]=r&255|iB,r/=128;for(;r&Hwe;)e[t++]=r&255|iB,r>>>=7;return e[t]=r|0,a7.bytes=t-i+1,e}});var cB=m((Wrt,aB)=>{f();aB.exports=c7;var Gwe=128,oB=127;function c7(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o||i>49)throw c7.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&oB)<<i:(s&oB)*Math.pow(2,i),i+=7}while(s>=Gwe);return c7.bytes=n-e,t}});var lB=m((Yrt,uB)=>{f();var Wwe=Math.pow(2,7),Ywe=Math.pow(2,14),Xwe=Math.pow(2,21),Qwe=Math.pow(2,28),Zwe=Math.pow(2,35),Jwe=Math.pow(2,42),e8e=Math.pow(2,49),t8e=Math.pow(2,56),r8e=Math.pow(2,63);uB.exports=function(r){return r<Wwe?1:r<Ywe?2:r<Xwe?3:r<Qwe?4:r<Zwe?5:r<Jwe?6:r<e8e?7:r<t8e?8:r<r8e?9:10}});var Wn=m((Xrt,fB)=>{f();fB.exports={encode:sB(),decode:cB(),encodingLength:lB()}});var Pn={};Tt(Pn,{concat:()=>Ni});function Ni(r,e){e||(e=r.reduce((n,s)=>n+s.length,0));let t=new Uint8Array(e),i=0;for(let n of r)t.set(n,i),i+=n.length;return t}var Si=Ue(()=>{f()});var wB=m((Qrt,bB)=>{f();"use strict";var Y3=eB(),dB=Py(),{CID:i8e}=(we(),Fc),{base32:hB}=(en(),Uc),{base58btc:n8e}=(di(),Uo),s8e=(Ji(),Wh),cp=Wn(),{toString:X3}=(tt(),sr),{fromString:pB}=(ct(),Qr),{concat:Q3}=(Si(),Pn);bB.exports=Cy;function Cy(r,e){return e instanceof Uint8Array?Cy.toString(r,e):Cy.toBytes(r,e)}Cy.toString=function(e,t){switch(dB(e).code){case 4:case 41:return o8e(t);case 6:case 273:case 33:case 132:return gB(t).toString();case 53:case 54:case 55:case 56:case 400:case 777:return c8e(t);case 421:return l8e(t);case 444:return mB(t);case 445:return mB(t);default:return X3(t,"base16")}};Cy.toBytes=function(e,t){switch(dB(e).code){case 4:return yB(t);case 41:return yB(t);case 6:case 273:case 33:case 132:return u7(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return a8e(t);case 421:return u8e(t);case 444:return f8e(t);case 445:return d8e(t);default:return pB(t,"base16")}};function yB(r){if(!Y3.isIP(r))throw new Error("invalid ip address");return Y3.toBytes(r)}function o8e(r){let e=Y3.toString(r);if(!e||!Y3.isIP(e))throw new Error("invalid ip address");return e}function u7(r){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,r),new Uint8Array(e)}function gB(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function a8e(r){let e=pB(r),t=Uint8Array.from(cp.encode(e.length));return Q3([t,e],t.length+e.length)}function c8e(r){let e=cp.decode(r);if(r=r.slice(cp.decode.bytes),r.length!==e)throw new Error("inconsistent lengths");return X3(r)}function u8e(r){let e;r[0]==="Q"||r[0]==="1"?e=s8e.decode(n8e.decode(`z${r}`)).bytes:e=i8e.parse(r).multihash.bytes;let t=Uint8Array.from(cp.encode(e.length));return Q3([t,e],t.length+e.length)}function l8e(r){let e=cp.decode(r),t=r.slice(cp.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return X3(t,"base58btc")}function f8e(r){let e=r.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let t=hB.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=u7(i);return Q3([t,n],t.length+n.length)}function d8e(r){let e=r.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let t=hB.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=u7(i);return Q3([t,n],t.length+n.length)}function mB(r){let e=r.slice(0,r.length-2),t=r.slice(r.length-2),i=X3(e,"base32"),n=gB(t);return i+":"+n}});var OB=m((Zrt,CB)=>{f();"use strict";var _B=wB(),l7=Py(),Oy=Wn(),{concat:vB}=(Si(),Pn),{toString:h8e}=(tt(),sr);CB.exports={stringToStringTuples:EB,stringTuplesToString:SB,tuplesToStringTuples:AB,stringTuplesToTuples:RB,bytesToTuples:f7,tuplesToBytes:xB,bytesToString:p8e,stringToBytes:TB,fromString:y8e,fromBytes:PB,validateBytes:d7,isValidBytes:g8e,cleanPath:Z3,ParseError:h7,protoFromTuple:ky,sizeForAddr:IB};function EB(r){let e=[],t=r.split("/").slice(1);if(t.length===1&&t[0]==="")return[];for(let i=0;i<t.length;i++){let n=t[i],s=l7(n);if(s.size===0){e.push([n]);continue}if(i++,i>=t.length)throw h7("invalid address: "+r);if(s.path){e.push([n,Z3(t.slice(i).join("/"))]);break}e.push([n,t[i]])}return e}function SB(r){let e=[];return r.map(t=>{let i=ky(t);return e.push(i.name),t.length>1&&e.push(t[1]),null}),Z3(e.join("/"))}function RB(r){return r.map(e=>{Array.isArray(e)||(e=[e]);let t=ky(e);return e.length>1?[t.code,_B.toBytes(t.code,e[1])]:[t.code]})}function AB(r){return r.map(e=>{let t=ky(e);return e[1]?[t.code,_B.toString(t.code,e[1])]:[t.code]})}function xB(r){return PB(vB(r.map(e=>{let t=ky(e),i=Uint8Array.from(Oy.encode(t.code));return e.length>1&&(i=vB([i,e[1]])),i})))}function IB(r,e){return r.size>0?r.size/8:r.size===0?0:Oy.decode(e)+Oy.decode.bytes}function f7(r){let e=[],t=0;for(;t<r.length;){let i=Oy.decode(r,t),n=Oy.decode.bytes,s=l7(i),o=IB(s,r.slice(t+n));if(o===0){e.push([i]),t+=n;continue}let a=r.slice(t+n,t+n+o);if(t+=o+n,t>r.length)throw h7("Invalid address Uint8Array: "+h8e(r,"base16"));e.push([i,a])}return e}function p8e(r){let e=f7(r),t=AB(e);return SB(t)}function TB(r){r=Z3(r);let e=EB(r),t=RB(e);return xB(t)}function y8e(r){return TB(r)}function PB(r){let e=d7(r);if(e)throw e;return Uint8Array.from(r)}function d7(r){try{f7(r)}catch(e){return e}}function g8e(r){return d7(r)===void 0}function Z3(r){return"/"+r.trim().split("/").filter(e=>e).join("/")}function h7(r){return new Error("Error parsing address: "+r)}function ky(r){return l7(r[0])}});var NB=m((Jrt,DB)=>{f();"use strict";function kB(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function m8e(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return kB(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),kB(new n,t)}}DB.exports=m8e});var dn={};Tt(dn,{equals:()=>Hs});function Hs(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}var hi=Ue(()=>{f()});var ft=m((eit,MB)=>{f();"use strict";var zo=OB(),up=Py(),BB=Wn(),{CID:b8e}=(we(),Fc),{base58btc:w8e}=(di(),Uo),_8e=NB(),v8e=Symbol.for("nodejs.util.inspect.custom"),{toString:J3}=(tt(),sr),{equals:E8e}=(hi(),dn),p7=new Map,LB=Symbol.for("@multiformats/js-multiaddr/multiaddr"),Cn=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,LB,{value:!0}),e instanceof Uint8Array)this.bytes=zo.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=zo.fromString(e)}else if(Cn.isMultiaddr(e))this.bytes=zo.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return zo.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},t=this.toString().split("/");return e.family=t[1]==="ip4"?4:6,e.host=t[2],e.transport=t[3],e.port=parseInt(t[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},up(e)))}protoCodes(){let e=[],t=this.bytes,i=0;for(;i<t.length;){let n=BB.decode(t,i),s=BB.decode.bytes,o=up(n);i+=zo.sizeForAddr(o,t.slice(i+s))+s,e.push(n)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return zo.bytesToTuples(this.bytes)}stringTuples(){let e=zo.bytesToTuples(this.bytes);return zo.tuplesToStringTuples(e)}encapsulate(e){return e=new Cn(e),new Cn(this.toString()+e.toString())}decapsulate(e){let t=e.toString(),i=this.toString(),n=i.lastIndexOf(t);if(n<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new Cn(i.slice(0,n))}decapsulateCode(e){let t=this.tuples();for(let i=t.length-1;i>=0;i--)if(t[i][0]===e)return new Cn(zo.tuplesToBytes(t.slice(0,i)));return this}getPeerId(){try{let t=this.stringTuples().filter(i=>i[0]===up.names.ipfs.code).pop();if(t&&t[1]){let i=t[1];return i[0]==="Q"||i[0]==="1"?J3(w8e.decode(`z${i}`),"base58btc"):J3(b8e.parse(i).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter(t=>!!up(t[0]).path)[0][1],e||(e=null)}catch(t){e=null}return e}equals(e){return E8e(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(n=>n.resolvable);if(!e)return[this];let t=p7.get(e.name);if(!t)throw _8e(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await t(this)).map(n=>new Cn(n))}nodeAddress(){let e=this.protoCodes(),t=this.protoNames(),i=this.toString().split("/").slice(1);if(i.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${t[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(i[2]!=="tcp"&&i[2]!=="udp")throw new Error(`no protocol with name: "'${t[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:i[1],port:parseInt(i[3])}}isThinWaistAddress(e){let t=(e||this).protos();return!(t.length!==2||t[0].code!==4&&t[0].code!==41||t[1].code!==6&&t[1].code!==273)}static fromNodeAddress(e,t){if(!e)throw new Error("requires node address object");if(!t)throw new Error("requires transport protocol");let i;switch(e.family){case 4:i="ip4";break;case 6:i="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new Cn("/"+[i,e.address,t,e.port].join("/"))}static isName(e){return Cn.isMultiaddr(e)?e.protos().some(t=>t.resolvable):!1}static isMultiaddr(e){return e instanceof Cn||Boolean(e&&e[LB])}[v8e](){return"<Multiaddr "+J3(this.bytes,"base16")+" - "+zo.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+J3(this.bytes,"base16")+" - "+zo.bytesToString(this.bytes)+">"}};Cn.protocols=up;Cn.resolvers=p7;function S8e(r){return new Cn(r)}MB.exports={Multiaddr:Cn,multiaddr:S8e,protocols:up,resolvers:p7}});var Ff=m((tit,GB)=>{f();"use strict";var{Multiaddr:y7}=ft(),jB=it("dns4"),qB=it("dns6"),UB=it("dnsaddr"),Uf=hn(it("dns"),UB,jB,qB),Dy=hn(it("ip4"),it("ip6")),lp=hn(bt(Dy,it("tcp")),bt(Uf,it("tcp"))),g7=bt(Dy,it("udp")),FB=bt(g7,it("utp")),KB=bt(g7,it("quic")),fp=hn(bt(lp,it("ws")),bt(Uf,it("ws"))),dp=hn(bt(lp,it("wss")),bt(Uf,it("wss"))),e4=hn(bt(lp,it("http")),bt(Dy,it("http")),bt(Uf,it("http"))),t4=hn(bt(lp,it("https")),bt(Dy,it("https")),bt(Uf,it("https"))),m7=hn(bt(fp,it("p2p-webrtc-star"),it("p2p")),bt(dp,it("p2p-webrtc-star"),it("p2p")),bt(fp,it("p2p-webrtc-star")),bt(dp,it("p2p-webrtc-star"))),R8e=hn(bt(fp,it("p2p-websocket-star"),it("p2p")),bt(dp,it("p2p-websocket-star"),it("p2p")),bt(fp,it("p2p-websocket-star")),bt(dp,it("p2p-websocket-star"))),b7=hn(bt(e4,it("p2p-webrtc-direct"),it("p2p")),bt(t4,it("p2p-webrtc-direct"),it("p2p")),bt(e4,it("p2p-webrtc-direct")),bt(t4,it("p2p-webrtc-direct"))),hp=hn(fp,dp,e4,t4,m7,b7,lp,FB,KB,Uf),A8e=hn(bt(hp,it("p2p-stardust"),it("p2p")),bt(hp,it("p2p-stardust"))),rl=hn(bt(hp,it("p2p")),m7,b7,it("p2p")),VB=hn(bt(rl,it("p2p-circuit"),rl),bt(rl,it("p2p-circuit")),bt(it("p2p-circuit"),rl),bt(hp,it("p2p-circuit")),bt(it("p2p-circuit"),hp),it("p2p-circuit")),zB=()=>hn(bt(VB,zB),VB),pp=zB(),HB=hn(bt(pp,rl,pp),bt(rl,pp),bt(pp,rl),pp,rl);GB.exports={DNS:Uf,DNS4:jB,DNS6:qB,DNSADDR:UB,IP:Dy,TCP:lp,UDP:g7,QUIC:KB,UTP:FB,HTTP:e4,HTTPS:t4,WebSockets:fp,WebSocketsSecure:dp,WebSocketStar:R8e,WebRTCStar:m7,WebRTCDirect:b7,Reliable:hp,Stardust:A8e,Circuit:pp,P2P:HB,IPFS:HB};function $B(r){function e(t){if(!y7.isMultiaddr(t))try{t=new y7(t)}catch(n){return!1}let i=r(t.protoNames());return i===null?!1:i===!0||i===!1?i:i.length===0}return e}function bt(...r){function e(t){if(t.length<r.length)return null;let i=t;return r.some(n=>(i=typeof n=="function"?n().partialMatch(t):n.partialMatch(t),Array.isArray(i)&&(t=i),i===null)),i}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:$B(e),partialMatch:e}}function hn(...r){function e(i){let n=null;return r.some(s=>{let o=typeof s=="function"?s().partialMatch(i):s.partialMatch(i);return o?(n=o,!0):!1}),n}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:$B(e),partialMatch:e}}function it(r){let e=r;function t(n){let s;if(typeof n=="string"||n instanceof Uint8Array)try{s=new y7(n)}catch(a){return!1}else s=n;let o=s.protoNames();return o.length===1&&o[0]===e}function i(n){return n.length===0?null:n[0]===e?n.slice(1):null}return{toString:function(){return e},matches:t,partialMatch:i}}});var w7=m((rit,XB)=>{f();"use strict";var x8e=typeof navigator!="undefined"&&navigator.product==="ReactNative";function I8e(){return x8e?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}var Ny=self.URL,WB=I8e(),YB=class{constructor(e="",t=WB){this.super=new Ny(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return Ny.createObjectURL(e)}static revokeObjectURL(e){Ny.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function T8e(r){if(typeof r=="string")return new Ny(r).toString();if(!(r instanceof Ny)){let e=r.username&&r.password?`${r.username}:${r.password}@`:"",t=r.auth?r.auth+"@":"",i=r.port?":"+r.port:"",n=r.protocol?r.protocol+"//":"",s=r.host||"",o=r.hostname||"",a=r.search||(r.query?"?"+r.query:""),c=r.hash||"",u=r.pathname||"",l=r.path||u+a;return`${n}${e||t}${s||o+i}${l}${c}`}}XB.exports={URLWithLegacySupport:YB,URLSearchParams:self.URLSearchParams,defaultBase:WB,format:T8e}});var JB=m((iit,ZB)=>{f();"use strict";var{URLWithLegacySupport:QB,format:P8e}=w7();ZB.exports=(r,e={},t={},i)=>{let n=e.protocol?e.protocol.replace(":",""):"http";n=(t[n]||i||n)+":";let s;try{s=new QB(r)}catch(a){s={}}let o=Object.assign({},e,{protocol:n||s.protocol,host:e.host||s.host});return new QB(r,P8e(o)).toString()}});var r4=m((nit,eL)=>{f();"use strict";var{URLWithLegacySupport:C8e,format:O8e,URLSearchParams:k8e,defaultBase:D8e}=w7(),N8e=JB();eL.exports={URL:C8e,URLSearchParams:k8e,format:O8e,relative:N8e,defaultBase:D8e}});var gp=m((sit,hL)=>{f();"use strict";var{base58btc:B8e}=(di(),Uo),{base32:L8e}=(en(),Uc),M8e=(Ji(),Wh),{Multiaddr:tL}=ft(),j8e=Ff(),{CID:_7}=(we(),Fc),{URL:q8e}=r4(),{toString:U8e}=(tt(),sr),v7=/^https?:\/\/[^/]+\/(ip[fn]s)\/([^/?#]+)/,yp=/^\/(ip[fn]s)\/([^/?#]+)/,rL=1,iL=2,By=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,nL=1,sL=2,F8e=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function K8e(r){let e=E7(r);try{M8e.decode(B8e.decode("z"+e))}catch{return!1}return!0}function V8e(r){try{L8e.decode(r)}catch{return!1}return!0}function Ly(r){try{return typeof r=="string"?Boolean(_7.parse(r)):r instanceof Uint8Array?Boolean(_7.decode(r)):Boolean(_7.asCID(r))}catch(e){return!1}}function oL(r){if(!r)return!1;if(tL.isMultiaddr(r))return!0;try{return new tL(r),!0}catch(e){return!1}}function z8e(r){return oL(r)&&j8e.P2P.matches(r)}function My(r,e,t=rL,i=iL){let n=E7(r);if(!n)return!1;let s=n.match(e);if(!s||s[t]!=="ipfs")return!1;let o=s[i];return o&&e===By&&(o=o.toLowerCase()),Ly(o)}function i4(r,e,t=rL,i=iL){let n=E7(r);if(!n)return!1;let s=n.match(e);if(!s||s[t]!=="ipns")return!1;let o=s[i];if(o&&e===By){if(o=o.toLowerCase(),Ly(o))return!0;try{!o.includes(".")&&o.includes("-")&&(o=o.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));let{hostname:a}=new q8e(`http://${o}`);return F8e.test(a)}catch(a){return!1}}return!0}function aL(r){return typeof r=="string"}function E7(r){return r instanceof Uint8Array?U8e(r,"base58btc"):aL(r)?r:!1}var S7=r=>My(r,By,sL,nL),R7=r=>i4(r,By,sL,nL),cL=r=>S7(r)||R7(r),uL=r=>My(r,v7)||S7(r),lL=r=>i4(r,v7)||R7(r),fL=r=>uL(r)||lL(r)||cL(r),dL=r=>My(r,yp)||i4(r,yp);hL.exports={multihash:K8e,multiaddr:oL,peerMultiaddr:z8e,cid:Ly,base32cid:r=>V8e(r)&&Ly(r),ipfsSubdomain:S7,ipnsSubdomain:R7,subdomain:cL,subdomainGatewayPattern:By,ipfsUrl:uL,ipnsUrl:lL,url:fL,pathGatewayPattern:v7,ipfsPath:r=>My(r,yp),ipnsPath:r=>i4(r,yp),path:dL,pathPattern:yp,urlOrPath:r=>fL(r)||dL(r),cidPath:r=>aL(r)&&!Ly(r)&&My(`/ipfs/${r}`,yp)}});var pL,yL=Ue(()=>{f();pL="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"});var x7={};Tt(x7,{customAlphabet:()=>H8e,customRandom:()=>mL,nanoid:()=>A7,random:()=>gL,urlAlphabet:()=>pL});var gL,mL,H8e,A7,n4=Ue(()=>{f();yL();gL=r=>crypto.getRandomValues(new Uint8Array(r)),mL=(r,e,t)=>{let i=(2<<Math.log(r.length-1)/Math.LN2)-1,n=-~(1.6*i*e/r.length);return(s=e)=>{let o="";for(;;){let a=t(n),c=n;for(;c--;)if(o+=r[a[c]&i]||"",o.length===s)return o}}},H8e=(r,e=21)=>mL(r,e,gL),A7=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"")});var mp={};Tt(mp,{Key:()=>xe});function $8e(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function G8e(r){let e=r.split(":");return e[e.length-1]}function W8e(r){return[].concat(...r)}var Hc,bL,s4,xe,Mr=Ue(()=>{f();n4();tt();ct();Hc="/",bL=new TextEncoder().encode(Hc),s4=bL[0],xe=class{constructor(e,t){if(typeof e=="string")this._buf=Qe(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==s4)throw new Error("Invalid key")}toString(e="utf8"){return $e(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new xe(e.join(Hc))}static random(){return new xe(A7().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new xe(e):e.uint8Array?new xe(e.uint8Array()):null}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=bL),this._buf[0]!==s4){let e=new Uint8Array(this._buf.byteLength+1);e.fill(s4,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===s4;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),i=e.list();for(let n=0;n<t.length;n++){if(i.length<n+1)return!1;let s=t[n],o=i[n];if(s<o)return!0;if(s>o)return!1}return t.length<i.length}reverse(){return xe.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Hc).slice(1)}type(){return $8e(this.baseNamespace())}name(){return G8e(this.baseNamespace())}instance(e){return new xe(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Hc)||(e+=Hc),e+=this.type(),new xe(e)}parent(){let e=this.list();return e.length===1?new xe(Hc):new xe(e.slice(0,-1).join(Hc))}child(e){return this.toString()===Hc?e:e.toString()===Hc?this:new xe(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return xe.withNamespaces([...this.namespaces(),...W8e(e.map(t=>t.namespaces()))])}}});var _L=m((fit,wL)=>{f();"use strict";wL.exports=function(){return Date.now()}});var jy=m((dit,EL)=>{f();"use strict";var o4=_L(),vL=class{constructor(e,t,i){let n=this;this._started=o4(),this._rescheduled=0,this._scheduled=t,this._args=i,this._triggered=!1,this._timerWrapper=()=>{n._rescheduled>0?(n._scheduled=n._rescheduled-(o4()-n._started),n._schedule(n._scheduled)):(n._triggered=!0,e.apply(null,n._args))},this._timer=setTimeout(this._timerWrapper,t)}reschedule(e){e||(e=this._scheduled);let t=o4();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=o4(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function Y8e(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let r;if(arguments.length>0){r=new Array(arguments.length-2);for(var e=0;e<r.length;e++)r[e]=arguments[e+2]}return new vL(arguments[0],arguments[1],r)}EL.exports=Y8e});var Da=m((hit,RL)=>{f();"use strict";var{AbortController:X8e}=globalThis,SL=jy(),a4=class extends X8e{constructor(e){super();this._ms=e,this._timer=SL(()=>this.abort(),e),Object.setPrototypeOf(this,a4.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=SL(()=>this.abort(),this._ms)}};RL.exports={TimeoutController:a4}});var Ho=m((pit,I7)=>{f();function AL(r){let e=new globalThis.AbortController;function t(){e.abort();for(let i of r)!i||!i.removeEventListener||i.removeEventListener("abort",t)}for(let i of r)if(!(!i||!i.addEventListener)){if(i.aborted){t();break}i.addEventListener("abort",t)}return e.signal}I7.exports=AL;I7.exports.anySignal=AL});var Kf=m((_it,CL)=>{f();"use strict";function PL(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function Z8e(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return PL(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),PL(new n,t)}}CL.exports=Z8e});var wp=m((Lit,ML)=>{f();ML.exports=function(r){if(!r)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,t=Object.create(null),i=Object.create(null);function n(s,o){t[s]=o,e++,e>=r&&(e=0,i=t,t=Object.create(null))}return{has:function(s){return t[s]!==void 0||i[s]!==void 0},remove:function(s){t[s]!==void 0&&(t[s]=void 0),i[s]!==void 0&&(i[s]=void 0)},get:function(s){var o=t[s];if(o!==void 0)return o;if((o=i[s])!==void 0)return n(s,o),o},set:function(s,o){t[s]!==void 0?t[s]=o:n(s,o)},clear:function(){t=Object.create(null),i=Object.create(null)}}}});var UL=m((jit,O7)=>{f();"use strict";var e_e=Object.prototype.hasOwnProperty,kn="~";function Fy(){}Object.create&&(Fy.prototype=Object.create(null),new Fy().__proto__||(kn=!1));function t_e(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function qL(r,e,t,i,n){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new t_e(t,i||r,n),o=kn?kn+e:e;return r._events[o]?r._events[o].fn?r._events[o]=[r._events[o],s]:r._events[o].push(s):(r._events[o]=s,r._eventsCount++),r}function l4(r,e){--r._eventsCount==0?r._events=new Fy:delete r._events[e]}function pn(){this._events=new Fy,this._eventsCount=0}pn.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)e_e.call(t,i)&&e.push(kn?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};pn.prototype.listeners=function(e){var t=kn?kn+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};pn.prototype.listenerCount=function(e){var t=kn?kn+e:e,i=this._events[t];return i?i.fn?1:i.length:0};pn.prototype.emit=function(e,t,i,n,s,o){var a=kn?kn+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,l,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,n),!0;case 5:return c.fn.call(c.context,t,i,n,s),!0;case 6:return c.fn.call(c.context,t,i,n,s,o),!0}for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];c.fn.apply(c.context,l)}else{var h=c.length,p;for(d=0;d<h;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),u){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,i);break;case 4:c[d].fn.call(c[d].context,t,i,n);break;default:if(!l)for(p=1,l=new Array(u-1);p<u;p++)l[p-1]=arguments[p];c[d].fn.apply(c[d].context,l)}}return!0};pn.prototype.on=function(e,t,i){return qL(this,e,t,i,!1)};pn.prototype.once=function(e,t,i){return qL(this,e,t,i,!0)};pn.prototype.removeListener=function(e,t,i,n){var s=kn?kn+e:e;if(!this._events[s])return this;if(!t)return l4(this,s),this;var o=this._events[s];if(o.fn)o.fn===t&&(!n||o.once)&&(!i||o.context===i)&&l4(this,s);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==t||n&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:l4(this,s)}return this};pn.prototype.removeAllListeners=function(e){var t;return e?(t=kn?kn+e:e,this._events[t]&&l4(this,t)):(this._events=new Fy,this._eventsCount=0),this};pn.prototype.off=pn.prototype.removeListener;pn.prototype.addListener=pn.prototype.on;pn.prefixed=kn;pn.EventEmitter=pn;typeof O7!="undefined"&&(O7.exports=pn)});var KL=m((qit,FL)=>{f();"use strict";FL.exports=(r,e)=>(e=e||(()=>{}),r.then(t=>new Promise(i=>{i(e())}).then(()=>t),t=>new Promise(i=>{i(e())}).then(()=>{throw t})))});var zL=m((Uit,f4)=>{f();"use strict";var r_e=KL(),k7=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},VL=(r,e,t)=>new Promise((i,n)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){i(r);return}let s=setTimeout(()=>{if(typeof t=="function"){try{i(t())}catch(c){n(c)}return}let o=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,a=t instanceof Error?t:new k7(o);typeof r.cancel=="function"&&r.cancel(),n(a)},e);r_e(r.then(i,n),()=>{clearTimeout(s)})});f4.exports=VL;f4.exports.default=VL;f4.exports.TimeoutError=k7});var HL=m(D7=>{f();"use strict";Object.defineProperty(D7,"__esModule",{value:!0});function i_e(r,e,t){let i=0,n=r.length;for(;n>0;){let s=n/2|0,o=i+s;t(r[o],e)<=0?(i=++o,n-=s+1):n=s}return i}D7.default=i_e});var GL=m(N7=>{f();"use strict";Object.defineProperty(N7,"__esModule",{value:!0});var n_e=HL(),$L=class{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);let i={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(i);return}let n=n_e.default(this._queue,i,(s,o)=>o.priority-s.priority);this._queue.splice(n,0,i)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}};N7.default=$L});var $o=m(B7=>{f();"use strict";Object.defineProperty(B7,"__esModule",{value:!0});var s_e=UL(),WL=zL(),o_e=GL(),d4=()=>{},a_e=new WL.TimeoutError,YL=class extends s_e{constructor(e){var t,i,n,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=d4,this._resolveIdle=d4,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:o_e.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=d4,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=d4,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((i,n)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&t.timeout===void 0?e():WL.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&n(a_e)});i(await o)}catch(o){n(o)}this._next()};this._queue.enqueue(s,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async i=>this.add(i,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};B7.default=YL});var L7=m(h4=>{f();"use strict";var XL=class extends Error{constructor(e="Request timed out"){super(e);this.name="TimeoutError"}};h4.TimeoutError=XL;var QL=class extends Error{constructor(e="The operation was aborted."){super(e);this.name="AbortError"}};h4.AbortError=QL;var ZL=class extends Error{constructor(e){super(e.statusText);this.name="HTTPError",this.response=e}};h4.HTTPError=ZL});var JL=m(()=>{f()});var Ky=m((_p,eM)=>{f();"use strict";var c_e=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof Gc!="undefined")return Gc;throw new Error("unable to locate global object")},Gc=c_e();eM.exports=_p=Gc.fetch;Gc.fetch&&(_p.default=Gc.fetch.bind(Gc));_p.Headers=Gc.Headers;_p.Request=Gc.Request;_p.Response=Gc.Response});var j7=m((Git,M7)=>{f();"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?M7.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:M7.exports={default:Ky().default,Headers:Ky().Headers,Request:Ky().Request,Response:Ky().Response}});var tM=m((Wit,q7)=>{f();"use strict";var{isElectronMain:u_e}=cy();u_e?q7.exports=JL():q7.exports=j7()});var sM=m((Yit,nM)=>{f();"use strict";var{TimeoutError:l_e,AbortError:f_e}=L7(),{Response:rM,Request:d_e,Headers:U7,default:h_e}=tM(),p_e=(r,e={})=>{let t=new XMLHttpRequest;t.open(e.method||"GET",r.toString(),!0);let{timeout:i,headers:n}=e;if(i&&i>0&&i<1/0&&(t.timeout=i),e.overrideMimeType!=null&&t.overrideMimeType(e.overrideMimeType),n)for(let[s,o]of new U7(n))t.setRequestHeader(s,o);return e.signal&&(e.signal.onabort=()=>t.abort()),e.onUploadProgress&&(t.upload.onprogress=e.onUploadProgress),t.responseType="arraybuffer",new Promise((s,o)=>{let a=c=>{switch(c.type){case"error":{s(rM.error());break}case"load":{s(new iM(t.responseURL,t.response,{status:t.status,statusText:t.statusText,headers:m_e(t.getAllResponseHeaders())}));break}case"timeout":{o(new l_e);break}case"abort":{o(new f_e);break}default:break}};t.onerror=a,t.onload=a,t.ontimeout=a,t.onabort=a,t.send(e.body)})},y_e=h_e,g_e=(r,e={})=>e.onUploadProgress!=null?p_e(r,e):y_e(r,e),m_e=r=>{let e=new U7;for(let t of r.trim().split(/[\r\n]+/)){let i=t.indexOf(": ");i>0&&e.set(t.slice(0,i),t.slice(i+1))}return e},iM=class extends rM{constructor(e,t,i){super(t,i);Object.defineProperty(this,"url",{value:e})}};nM.exports={fetch:g_e,Request:d_e,Headers:U7}});var vp=m((Xit,fM)=>{f();"use strict";var{fetch:b_e,Request:w_e,Headers:__e}=sM(),{TimeoutError:F7,HTTPError:oM}=L7(),aM=Uu().bind({ignoreUndefined:!0}),{URL:cM,URLSearchParams:uM}=r4(),v_e=Ho(),E_e=(r,e,t)=>{if(e===void 0)return r;let i=Date.now(),n=()=>Date.now()-i>=e;return new Promise((s,o)=>{let a=setTimeout(()=>{n()&&(o(new F7),t.abort())},e),c=u=>d=>{if(clearTimeout(a),n()){o(new F7);return}u(d)};r.then(c(s),c(o))})},S_e={throwHttpErrors:!0,credentials:"same-origin"},Dn=class{constructor(e={}){this.opts=aM(S_e,e)}async fetch(e,t={}){let i=aM(this.opts,t),n=new __e(i.headers);if(typeof e!="string"&&!(e instanceof cM||e instanceof w_e))throw new TypeError("`resource` must be a string, URL, or Request");let s=new cM(e.toString(),i.base),{searchParams:o,transformSearchParams:a,json:c}=i;o&&(typeof a=="function"?s.search=a(new uM(i.searchParams)):s.search=new uM(i.searchParams)),c&&(i.body=JSON.stringify(i.json),n.set("content-type","application/json"));let u=new AbortController,l=v_e([u.signal,i.signal]),d=await E_e(b_e(s.toString(),{...i,signal:l,timeout:void 0,headers:n}),i.timeout,u);if(!d.ok&&i.throwHttpErrors)throw i.handleError&&await i.handleError(d),new oM(d);return d.iterator=function(){return lM(d.body)},d.ndjson=async function*(){for await(let h of R_e(d.iterator()))t.transform?yield t.transform(h):yield h},d}post(e,t={}){return this.fetch(e,{...t,method:"POST"})}get(e,t={}){return this.fetch(e,{...t,method:"GET"})}put(e,t={}){return this.fetch(e,{...t,method:"PUT"})}delete(e,t={}){return this.fetch(e,{...t,method:"DELETE"})}options(e,t={}){return this.fetch(e,{...t,method:"OPTIONS"})}},R_e=async function*(r){let e=new TextDecoder,t="";for await(let i of r){t+=e.decode(i,{stream:!0});let n=t.split(/\r?\n/);for(let s=0;s<n.length-1;s++){let o=n[s].trim();o.length>0&&(yield JSON.parse(o))}t=n[n.length-1]}t+=e.decode(),t=t.trim(),t.length!==0&&(yield JSON.parse(t))},lM=r=>{if(I_e(r)){let e=r[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:e.next.bind(e),return(t){return r.destroy(),typeof e.return=="function"?e.return():Promise.resolve({done:!0,value:t})}}}}}if(x_e(r)){let e=r.getReader();return async function*(){try{for(;;){let{done:t,value:i}=await e.read();if(t)return;i&&(yield i)}}finally{e.releaseLock()}}()}if(A_e(r))return r;throw new TypeError("Body can't be converted to AsyncIterable")},A_e=r=>typeof r=="object"&&r!==null&&typeof r[Symbol.asyncIterator]=="function",x_e=r=>r&&typeof r.getReader=="function",I_e=r=>Object.prototype.hasOwnProperty.call(r,"readable")&&Object.prototype.hasOwnProperty.call(r,"writable");Dn.HTTPError=oM;Dn.TimeoutError=F7;Dn.streamToAsyncIterator=lM;Dn.post=(r,e)=>new Dn(e).post(r,e);Dn.get=(r,e)=>new Dn(e).get(r,e);Dn.put=(r,e)=>new Dn(e).put(r,e);Dn.delete=(r,e)=>new Dn(e).delete(r,e);Dn.options=(r,e)=>new Dn(e).options(r,e);fM.exports=Dn});var g4=m((int,bM)=>{f();"use strict";var Vf=Br(),y4=Vf.Reader,mM=Vf.Writer,yn=Vf.util,$s=Vf.roots["libp2p-crypto-keys"]||(Vf.roots["libp2p-crypto-keys"]={});$s.KeyType=function(){var r={},e=Object.create(r);return e[r[0]="RSA"]=0,e[r[1]="Ed25519"]=1,e[r[2]="Secp256k1"]=2,e}();$s.PublicKey=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Type=0,r.prototype.Data=yn.newBuffer([]),r.encode=function(t,i){return i||(i=mM.create()),i.uint32(8).int32(t.Type),i.uint32(18).bytes(t.Data),i},r.decode=function(t,i){t instanceof y4||(t=y4.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new $s.PublicKey;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw yn.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw yn.ProtocolError("missing required 'Data'",{instance:s});return s},r.fromObject=function(t){if(t instanceof $s.PublicKey)return t;var i=new $s.PublicKey;switch(t.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return t.Data!=null&&(typeof t.Data=="string"?yn.base64.decode(t.Data,i.Data=yn.newBuffer(yn.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=yn.newBuffer(n.Data)))),t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=i.enums===String?$s.KeyType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?yn.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Vf.util.toJSONOptions)},r}();$s.PrivateKey=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Type=0,r.prototype.Data=yn.newBuffer([]),r.encode=function(t,i){return i||(i=mM.create()),i.uint32(8).int32(t.Type),i.uint32(18).bytes(t.Data),i},r.decode=function(t,i){t instanceof y4||(t=y4.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new $s.PrivateKey;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw yn.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw yn.ProtocolError("missing required 'Data'",{instance:s});return s},r.fromObject=function(t){if(t instanceof $s.PrivateKey)return t;var i=new $s.PrivateKey;switch(t.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return t.Data!=null&&(typeof t.Data=="string"?yn.base64.decode(t.Data,i.Data=yn.newBuffer(yn.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=yn.newBuffer(n.Data)))),t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=i.enums===String?$s.KeyType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?yn.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Vf.util.toJSONOptions)},r}();bM.exports=$s});var Rt=m((nnt,wM)=>{f();wM.exports={options:{usePureJavaScript:!1}}});var EM=m((snt,vM)=>{f();var V7={};vM.exports=V7;var _M={};V7.encode=function(r,e,t){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(t!==void 0&&typeof t!="number")throw new TypeError('"maxline" must be a number.');var i="";if(!(r instanceof Uint8Array))i=k_e(r,e);else{var n=0,s=e.length,o=e.charAt(0),a=[0];for(n=0;n<r.length;++n){for(var c=0,u=r[n];c<a.length;++c)u+=a[c]<<8,a[c]=u%s,u=u/s|0;for(;u>0;)a.push(u%s),u=u/s|0}for(n=0;r[n]===0&&n<r.length-1;++n)i+=o;for(n=a.length-1;n>=0;--n)i+=e[a[n]]}if(t){var l=new RegExp(".{1,"+t+"}","g");i=i.match(l).join(`\r
`)}return i};V7.decode=function(r,e){if(typeof r!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var t=_M[e];if(!t){t=_M[e]=[];for(var i=0;i<e.length;++i)t[e.charCodeAt(i)]=i}r=r.replace(/\s/g,"");for(var n=e.length,s=e.charAt(0),o=[0],i=0;i<r.length;i++){var a=t[r.charCodeAt(i)];if(a===void 0)return;for(var c=0,u=a;c<o.length;++c)u+=o[c]*n,o[c]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var l=0;r[l]===s&&l<r.length-1;++l)o.push(0);return typeof Buffer!="undefined"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function k_e(r,e){var t=0,i=e.length,n=e.charAt(0),s=[0];for(t=0;t<r.length();++t){for(var o=0,a=r.at(t);o<s.length;++o)a+=s[o]<<8,s[o]=a%i,a=a/i|0;for(;a>0;)s.push(a%i),a=a/i|0}var c="";for(t=0;r.at(t)===0&&t<r.length()-1;++t)c+=n;for(t=s.length-1;t>=0;--t)c+=e[s[t]];return c}});var vr=m((ont,xM)=>{f();var SM=Rt(),RM=EM(),z=xM.exports=SM.util=SM.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){z.nextTick=process.nextTick,typeof setImmediate=="function"?z.setImmediate=setImmediate:z.setImmediate=z.nextTick;return}if(typeof setImmediate=="function"){z.setImmediate=function(){return setImmediate.apply(void 0,arguments)},z.nextTick=function(a){return setImmediate(a)};return}if(z.setImmediate=function(a){setTimeout(a,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===r){c.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(l){l()})}};var o=a,r="forge.setImmediate",e=[];z.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(r,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver!="undefined"){var t=Date.now(),i=!0,n=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(u){u()})}).observe(n,{attributes:!0});var s=z.setImmediate;z.setImmediate=function(c){Date.now()-t>15?(t=Date.now(),s(c)):(e.push(c),e.length===1&&n.setAttribute("a",i=!i))}}z.nextTick=z.setImmediate})();z.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;z.globalScope=function(){return z.isNodejs?globalThis:typeof self=="undefined"?window:self}();z.isArray=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};z.isArrayBuffer=function(r){return typeof ArrayBuffer!="undefined"&&r instanceof ArrayBuffer};z.isArrayBufferView=function(r){return r&&z.isArrayBuffer(r.buffer)&&r.byteLength!==void 0};function Vy(r){if(!(r===8||r===16||r===24||r===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+r)}z.ByteBuffer=z7;function z7(r){if(this.data="",this.read=0,typeof r=="string")this.data=r;else if(z.isArrayBuffer(r)||z.isArrayBufferView(r))if(typeof Buffer!="undefined"&&r instanceof Buffer)this.data=r.toString("binary");else{var e=new Uint8Array(r);try{this.data=String.fromCharCode.apply(null,e)}catch(i){for(var t=0;t<e.length;++t)this.putByte(e[t])}}else(r instanceof z7||typeof r=="object"&&typeof r.data=="string"&&typeof r.read=="number")&&(this.data=r.data,this.read=r.read);this._constructedStringLength=0}z.ByteStringBuffer=z7;var D_e=4096;z.ByteStringBuffer.prototype._optimizeConstructedString=function(r){this._constructedStringLength+=r,this._constructedStringLength>D_e&&(this.data.substr(0,1),this._constructedStringLength=0)};z.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};z.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};z.ByteStringBuffer.prototype.putByte=function(r){return this.putBytes(String.fromCharCode(r))};z.ByteStringBuffer.prototype.fillWithByte=function(r,e){r=String.fromCharCode(r);for(var t=this.data;e>0;)e&1&&(t+=r),e>>>=1,e>0&&(r+=r);return this.data=t,this._optimizeConstructedString(e),this};z.ByteStringBuffer.prototype.putBytes=function(r){return this.data+=r,this._optimizeConstructedString(r.length),this};z.ByteStringBuffer.prototype.putString=function(r){return this.putBytes(z.encodeUtf8(r))};z.ByteStringBuffer.prototype.putInt16=function(r){return this.putBytes(String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};z.ByteStringBuffer.prototype.putInt24=function(r){return this.putBytes(String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};z.ByteStringBuffer.prototype.putInt32=function(r){return this.putBytes(String.fromCharCode(r>>24&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};z.ByteStringBuffer.prototype.putInt16Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255))};z.ByteStringBuffer.prototype.putInt24Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r>>16&255))};z.ByteStringBuffer.prototype.putInt32Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>24&255))};z.ByteStringBuffer.prototype.putInt=function(r,e){Vy(e);var t="";do e-=8,t+=String.fromCharCode(r>>e&255);while(e>0);return this.putBytes(t)};z.ByteStringBuffer.prototype.putSignedInt=function(r,e){return r<0&&(r+=2<<e-1),this.putInt(r,e)};z.ByteStringBuffer.prototype.putBuffer=function(r){return this.putBytes(r.getBytes())};z.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};z.ByteStringBuffer.prototype.getInt16=function(){var r=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,r};z.ByteStringBuffer.prototype.getInt24=function(){var r=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,r};z.ByteStringBuffer.prototype.getInt32=function(){var r=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,r};z.ByteStringBuffer.prototype.getInt16Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,r};z.ByteStringBuffer.prototype.getInt24Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,r};z.ByteStringBuffer.prototype.getInt32Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,r};z.ByteStringBuffer.prototype.getInt=function(r){Vy(r);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),r-=8;while(r>0);return e};z.ByteStringBuffer.prototype.getSignedInt=function(r){var e=this.getInt(r),t=2<<r-2;return e>=t&&(e-=t<<1),e};z.ByteStringBuffer.prototype.getBytes=function(r){var e;return r?(r=Math.min(this.length(),r),e=this.data.slice(this.read,this.read+r),this.read+=r):r===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};z.ByteStringBuffer.prototype.bytes=function(r){return typeof r=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+r)};z.ByteStringBuffer.prototype.at=function(r){return this.data.charCodeAt(this.read+r)};z.ByteStringBuffer.prototype.setAt=function(r,e){return this.data=this.data.substr(0,this.read+r)+String.fromCharCode(e)+this.data.substr(this.read+r+1),this};z.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};z.ByteStringBuffer.prototype.copy=function(){var r=z.createBuffer(this.data);return r.read=this.read,r};z.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};z.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};z.ByteStringBuffer.prototype.truncate=function(r){var e=Math.max(0,this.length()-r);return this.data=this.data.substr(this.read,e),this.read=0,this};z.ByteStringBuffer.prototype.toHex=function(){for(var r="",e=this.read;e<this.data.length;++e){var t=this.data.charCodeAt(e);t<16&&(r+="0"),r+=t.toString(16)}return r};z.ByteStringBuffer.prototype.toString=function(){return z.decodeUtf8(this.bytes())};function N_e(r,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var t=z.isArrayBuffer(r),i=z.isArrayBufferView(r);if(t||i){t?this.data=new DataView(r):this.data=new DataView(r.buffer,r.byteOffset,r.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,r!=null&&this.putBytes(r),"writeOffset"in e&&(this.write=e.writeOffset)}z.DataBuffer=N_e;z.DataBuffer.prototype.length=function(){return this.write-this.read};z.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};z.DataBuffer.prototype.accommodate=function(r,e){if(this.length()>=r)return this;e=Math.max(e||this.growSize,r);var t=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),i=new Uint8Array(this.length()+e);return i.set(t),this.data=new DataView(i.buffer),this};z.DataBuffer.prototype.putByte=function(r){return this.accommodate(1),this.data.setUint8(this.write++,r),this};z.DataBuffer.prototype.fillWithByte=function(r,e){this.accommodate(e);for(var t=0;t<e;++t)this.data.setUint8(r);return this};z.DataBuffer.prototype.putBytes=function(r,e){if(z.isArrayBufferView(r)){var t=new Uint8Array(r.buffer,r.byteOffset,r.byteLength),i=t.byteLength-t.byteOffset;this.accommodate(i);var n=new Uint8Array(this.data.buffer,this.write);return n.set(t),this.write+=i,this}if(z.isArrayBuffer(r)){var t=new Uint8Array(r);this.accommodate(t.byteLength);var n=new Uint8Array(this.data.buffer);return n.set(t,this.write),this.write+=t.byteLength,this}if(r instanceof z.DataBuffer||typeof r=="object"&&typeof r.read=="number"&&typeof r.write=="number"&&z.isArrayBufferView(r.data)){var t=new Uint8Array(r.data.byteLength,r.read,r.length());this.accommodate(t.byteLength);var n=new Uint8Array(r.data.byteLength,this.write);return n.set(t),this.write+=t.byteLength,this}if(r instanceof z.ByteStringBuffer&&(r=r.data,e="binary"),e=e||"binary",typeof r=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(r.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=z.binary.hex.decode(r,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(r.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=z.binary.base64.decode(r,s,this.write),this;if(e==="utf8"&&(r=z.encodeUtf8(r),e="binary"),e==="binary"||e==="raw")return this.accommodate(r.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=z.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(r.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=z.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+r)};z.DataBuffer.prototype.putBuffer=function(r){return this.putBytes(r),r.clear(),this};z.DataBuffer.prototype.putString=function(r){return this.putBytes(r,"utf16")};z.DataBuffer.prototype.putInt16=function(r){return this.accommodate(2),this.data.setInt16(this.write,r),this.write+=2,this};z.DataBuffer.prototype.putInt24=function(r){return this.accommodate(3),this.data.setInt16(this.write,r>>8&65535),this.data.setInt8(this.write,r>>16&255),this.write+=3,this};z.DataBuffer.prototype.putInt32=function(r){return this.accommodate(4),this.data.setInt32(this.write,r),this.write+=4,this};z.DataBuffer.prototype.putInt16Le=function(r){return this.accommodate(2),this.data.setInt16(this.write,r,!0),this.write+=2,this};z.DataBuffer.prototype.putInt24Le=function(r){return this.accommodate(3),this.data.setInt8(this.write,r>>16&255),this.data.setInt16(this.write,r>>8&65535,!0),this.write+=3,this};z.DataBuffer.prototype.putInt32Le=function(r){return this.accommodate(4),this.data.setInt32(this.write,r,!0),this.write+=4,this};z.DataBuffer.prototype.putInt=function(r,e){Vy(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,r>>e&255);while(e>0);return this};z.DataBuffer.prototype.putSignedInt=function(r,e){return Vy(e),this.accommodate(e/8),r<0&&(r+=2<<e-1),this.putInt(r,e)};z.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};z.DataBuffer.prototype.getInt16=function(){var r=this.data.getInt16(this.read);return this.read+=2,r};z.DataBuffer.prototype.getInt24=function(){var r=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,r};z.DataBuffer.prototype.getInt32=function(){var r=this.data.getInt32(this.read);return this.read+=4,r};z.DataBuffer.prototype.getInt16Le=function(){var r=this.data.getInt16(this.read,!0);return this.read+=2,r};z.DataBuffer.prototype.getInt24Le=function(){var r=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,r};z.DataBuffer.prototype.getInt32Le=function(){var r=this.data.getInt32(this.read,!0);return this.read+=4,r};z.DataBuffer.prototype.getInt=function(r){Vy(r);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),r-=8;while(r>0);return e};z.DataBuffer.prototype.getSignedInt=function(r){var e=this.getInt(r),t=2<<r-2;return e>=t&&(e-=t<<1),e};z.DataBuffer.prototype.getBytes=function(r){var e;return r?(r=Math.min(this.length(),r),e=this.data.slice(this.read,this.read+r),this.read+=r):r===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};z.DataBuffer.prototype.bytes=function(r){return typeof r=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+r)};z.DataBuffer.prototype.at=function(r){return this.data.getUint8(this.read+r)};z.DataBuffer.prototype.setAt=function(r,e){return this.data.setUint8(r,e),this};z.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};z.DataBuffer.prototype.copy=function(){return new z.DataBuffer(this)};z.DataBuffer.prototype.compact=function(){if(this.read>0){var r=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(r.byteLength);e.set(r),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};z.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};z.DataBuffer.prototype.truncate=function(r){return this.write=Math.max(0,this.length()-r),this.read=Math.min(this.read,this.write),this};z.DataBuffer.prototype.toHex=function(){for(var r="",e=this.read;e<this.data.byteLength;++e){var t=this.data.getUint8(e);t<16&&(r+="0"),r+=t.toString(16)}return r};z.DataBuffer.prototype.toString=function(r){var e=new Uint8Array(this.data,this.read,this.length());if(r=r||"utf8",r==="binary"||r==="raw")return z.binary.raw.encode(e);if(r==="hex")return z.binary.hex.encode(e);if(r==="base64")return z.binary.base64.encode(e);if(r==="utf8")return z.text.utf8.decode(e);if(r==="utf16")return z.text.utf16.decode(e);throw new Error("Invalid encoding: "+r)};z.createBuffer=function(r,e){return e=e||"raw",r!==void 0&&e==="utf8"&&(r=z.encodeUtf8(r)),new z.ByteBuffer(r)};z.fillString=function(r,e){for(var t="";e>0;)e&1&&(t+=r),e>>>=1,e>0&&(r+=r);return t};z.xorBytes=function(r,e,t){for(var i="",n="",s="",o=0,a=0;t>0;--t,++o)n=r.charCodeAt(o)^e.charCodeAt(o),a>=10&&(i+=s,s="",a=0),s+=String.fromCharCode(n),++a;return i+=s,i};z.hexToBytes=function(r){var e="",t=0;for(r.length&!0&&(t=1,e+=String.fromCharCode(parseInt(r[0],16)));t<r.length;t+=2)e+=String.fromCharCode(parseInt(r.substr(t,2),16));return e};z.bytesToHex=function(r){return z.createBuffer(r).toHex()};z.int32ToBytes=function(r){return String.fromCharCode(r>>24&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255)};var al="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",cl=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],AM="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";z.encode64=function(r,e){for(var t="",i="",n,s,o,a=0;a<r.length;)n=r.charCodeAt(a++),s=r.charCodeAt(a++),o=r.charCodeAt(a++),t+=al.charAt(n>>2),t+=al.charAt((n&3)<<4|s>>4),isNaN(s)?t+="==":(t+=al.charAt((s&15)<<2|o>>6),t+=isNaN(o)?"=":al.charAt(o&63)),e&&t.length>e&&(i+=t.substr(0,e)+`\r
`,t=t.substr(e));return i+=t,i};z.decode64=function(r){r=r.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",t,i,n,s,o=0;o<r.length;)t=cl[r.charCodeAt(o++)-43],i=cl[r.charCodeAt(o++)-43],n=cl[r.charCodeAt(o++)-43],s=cl[r.charCodeAt(o++)-43],e+=String.fromCharCode(t<<2|i>>4),n!==64&&(e+=String.fromCharCode((i&15)<<4|n>>2),s!==64&&(e+=String.fromCharCode((n&3)<<6|s)));return e};z.encodeUtf8=function(r){return unescape(encodeURIComponent(r))};z.decodeUtf8=function(r){return decodeURIComponent(escape(r))};z.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:RM.encode,decode:RM.decode}};z.binary.raw.encode=function(r){return String.fromCharCode.apply(null,r)};z.binary.raw.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(r.length)),t=t||0;for(var n=t,s=0;s<r.length;++s)i[n++]=r.charCodeAt(s);return e?n-t:i};z.binary.hex.encode=z.bytesToHex;z.binary.hex.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(Math.ceil(r.length/2))),t=t||0;var n=0,s=t;for(r.length&1&&(n=1,i[s++]=parseInt(r[0],16));n<r.length;n+=2)i[s++]=parseInt(r.substr(n,2),16);return e?s-t:i};z.binary.base64.encode=function(r,e){for(var t="",i="",n,s,o,a=0;a<r.byteLength;)n=r[a++],s=r[a++],o=r[a++],t+=al.charAt(n>>2),t+=al.charAt((n&3)<<4|s>>4),isNaN(s)?t+="==":(t+=al.charAt((s&15)<<2|o>>6),t+=isNaN(o)?"=":al.charAt(o&63)),e&&t.length>e&&(i+=t.substr(0,e)+`\r
`,t=t.substr(e));return i+=t,i};z.binary.base64.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(Math.ceil(r.length/4)*3)),r=r.replace(/[^A-Za-z0-9\+\/\=]/g,""),t=t||0;for(var n,s,o,a,c=0,u=t;c<r.length;)n=cl[r.charCodeAt(c++)-43],s=cl[r.charCodeAt(c++)-43],o=cl[r.charCodeAt(c++)-43],a=cl[r.charCodeAt(c++)-43],i[u++]=n<<2|s>>4,o!==64&&(i[u++]=(s&15)<<4|o>>2,a!==64&&(i[u++]=(o&3)<<6|a));return e?u-t:i.subarray(0,u)};z.binary.base58.encode=function(r,e){return z.binary.baseN.encode(r,AM,e)};z.binary.base58.decode=function(r,e){return z.binary.baseN.decode(r,AM,e)};z.text={utf8:{},utf16:{}};z.text.utf8.encode=function(r,e,t){r=z.encodeUtf8(r);var i=e;i||(i=new Uint8Array(r.length)),t=t||0;for(var n=t,s=0;s<r.length;++s)i[n++]=r.charCodeAt(s);return e?n-t:i};z.text.utf8.decode=function(r){return z.decodeUtf8(String.fromCharCode.apply(null,r))};z.text.utf16.encode=function(r,e,t){var i=e;i||(i=new Uint8Array(r.length*2));var n=new Uint16Array(i.buffer);t=t||0;for(var s=t,o=t,a=0;a<r.length;++a)n[o++]=r.charCodeAt(a),s+=2;return e?s-t:i};z.text.utf16.decode=function(r){return String.fromCharCode.apply(null,new Uint16Array(r.buffer))};z.deflate=function(r,e,t){if(e=z.decode64(r.deflate(z.encode64(e)).rval),t){var i=2,n=e.charCodeAt(1);n&32&&(i=6),e=e.substring(i,e.length-4)}return e};z.inflate=function(r,e,t){var i=r.inflate(z.encode64(e)).rval;return i===null?null:z.decode64(i)};var H7=function(r,e,t){if(!r)throw new Error("WebStorage not available.");var i;if(t===null?i=r.removeItem(e):(t=z.encode64(JSON.stringify(t)),i=r.setItem(e,t)),typeof i!="undefined"&&i.rval!==!0){var n=new Error(i.error.message);throw n.id=i.error.id,n.name=i.error.name,n}},$7=function(r,e){if(!r)throw new Error("WebStorage not available.");var t=r.getItem(e);if(r.init)if(t.rval===null){if(t.error){var i=new Error(t.error.message);throw i.id=t.error.id,i.name=t.error.name,i}t=null}else t=t.rval;return t!==null&&(t=JSON.parse(z.decode64(t))),t},B_e=function(r,e,t,i){var n=$7(r,e);n===null&&(n={}),n[t]=i,H7(r,e,n)},L_e=function(r,e,t){var i=$7(r,e);return i!==null&&(i=t in i?i[t]:null),i},M_e=function(r,e,t){var i=$7(r,e);if(i!==null&&t in i){delete i[t];var n=!0;for(var s in i){n=!1;break}n&&(i=null),H7(r,e,i)}},j_e=function(r,e){H7(r,e,null)},m4=function(r,e,t){var i=null;typeof t=="undefined"&&(t=["web","flash"]);var n,s=!1,o=null;for(var a in t){n=t[a];try{if(n==="flash"||n==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");i=r.apply(this,e),s=n==="flash"}(n==="web"||n==="both")&&(e[0]=localStorage,i=r.apply(this,e),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return i};z.setItem=function(r,e,t,i,n){m4(B_e,arguments,n)};z.getItem=function(r,e,t,i){return m4(L_e,arguments,i)};z.removeItem=function(r,e,t,i){m4(M_e,arguments,i)};z.clearItems=function(r,e,t){m4(j_e,arguments,t)};z.isEmpty=function(r){for(var e in r)if(r.hasOwnProperty(e))return!1;return!0};z.format=function(r){for(var e=/%./g,t,i,n=0,s=[],o=0;t=e.exec(r);){i=r.substring(o,e.lastIndex-2),i.length>0&&s.push(i),o=e.lastIndex;var a=t[0][1];switch(a){case"s":case"o":n<arguments.length?s.push(arguments[n+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(r.substring(o)),s.join("")};z.formatNumber=function(r,e,t,i){var n=r,s=isNaN(e=Math.abs(e))?2:e,o=t===void 0?",":t,a=i===void 0?".":i,c=n<0?"-":"",u=parseInt(n=Math.abs(+n||0).toFixed(s),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+a:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(n-u).toFixed(s).slice(2):"")};z.formatSize=function(r){return r>=1073741824?r=z.formatNumber(r/1073741824,2,".","")+" GiB":r>=1048576?r=z.formatNumber(r/1048576,2,".","")+" MiB":r>=1024?r=z.formatNumber(r/1024,0)+" KiB":r=z.formatNumber(r,0)+" bytes",r};z.bytesFromIP=function(r){return r.indexOf(".")!==-1?z.bytesFromIPv4(r):r.indexOf(":")!==-1?z.bytesFromIPv6(r):null};z.bytesFromIPv4=function(r){if(r=r.split("."),r.length!==4)return null;for(var e=z.createBuffer(),t=0;t<r.length;++t){var i=parseInt(r[t],10);if(isNaN(i))return null;e.putByte(i)}return e.getBytes()};z.bytesFromIPv6=function(r){var e=0;r=r.split(":").filter(function(o){return o.length===0&&++e,!0});for(var t=(8-r.length+e)*2,i=z.createBuffer(),n=0;n<8;++n){if(!r[n]||r[n].length===0){i.fillWithByte(0,t),t=0;continue}var s=z.hexToBytes(r[n]);s.length<2&&i.putByte(0),i.putBytes(s)}return i.getBytes()};z.bytesToIP=function(r){return r.length===4?z.bytesToIPv4(r):r.length===16?z.bytesToIPv6(r):null};z.bytesToIPv4=function(r){if(r.length!==4)return null;for(var e=[],t=0;t<r.length;++t)e.push(r.charCodeAt(t));return e.join(".")};z.bytesToIPv6=function(r){if(r.length!==16)return null;for(var e=[],t=[],i=0,n=0;n<r.length;n+=2){for(var s=z.bytesToHex(r[n]+r[n+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=t[t.length-1],a=e.length;!o||a!==o.end+1?t.push({start:a,end:a}):(o.end=a,o.end-o.start>t[i].end-t[i].start&&(i=t.length-1))}e.push(s)}if(t.length>0){var c=t[i];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};z.estimateCores=function(r,e){if(typeof r=="function"&&(e=r,r={}),r=r||{},"cores"in z&&!r.update)return e(null,z.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return z.cores=navigator.hardwareConcurrency,e(null,z.cores);if(typeof Worker=="undefined")return z.cores=1,e(null,z.cores);if(typeof Blob=="undefined")return z.cores=2,e(null,z.cores);var t=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));i([],5,16);function i(o,a,c){if(a===0){var u=Math.floor(o.reduce(function(l,d){return l+d},0)/o.length);return z.cores=Math.max(1,u),URL.revokeObjectURL(t),e(null,z.cores)}n(c,function(l,d){o.push(s(c,d)),i(o,a-1,c)})}function n(o,a){for(var c=[],u=[],l=0;l<o;++l){var d=new Worker(t);d.addEventListener("message",function(h){if(u.push(h.data),u.length===o){for(var p=0;p<o;++p)c[p].terminate();a(null,u)}}),c.push(d)}for(var l=0;l<o;++l)c[l].postMessage(l)}function s(o,a){for(var c=[],u=0;u<o;++u)for(var l=a[u],d=c[u]=[],h=0;h<o;++h)if(u!==h){var p=a[h];(l.st>p.st&&l.st<p.et||p.st>l.st&&p.st<l.et)&&d.push(h)}return c.reduce(function(y,g){return Math.max(y,g.length)},0)}}});var Ep=m((ant,IM)=>{f();var zy=Rt();zy.pki=zy.pki||{};var G7=IM.exports=zy.pki.oids=zy.oids=zy.oids||{};function be(r,e){G7[r]=e,G7[e]=r}function Jt(r,e){G7[r]=e}be("1.2.840.113549.1.1.1","rsaEncryption");be("1.2.840.113549.1.1.4","md5WithRSAEncryption");be("1.2.840.113549.1.1.5","sha1WithRSAEncryption");be("1.2.840.113549.1.1.7","RSAES-OAEP");be("1.2.840.113549.1.1.8","mgf1");be("1.2.840.113549.1.1.9","pSpecified");be("1.2.840.113549.1.1.10","RSASSA-PSS");be("1.2.840.113549.1.1.11","sha256WithRSAEncryption");be("1.2.840.113549.1.1.12","sha384WithRSAEncryption");be("1.2.840.113549.1.1.13","sha512WithRSAEncryption");be("1.3.101.112","EdDSA25519");be("1.2.840.10040.4.3","dsa-with-sha1");be("1.3.14.3.2.7","desCBC");be("1.3.14.3.2.26","sha1");be("1.3.14.3.2.29","sha1WithRSASignature");be("2.16.840.1.101.3.4.2.1","sha256");be("2.16.840.1.101.3.4.2.2","sha384");be("2.16.840.1.101.3.4.2.3","sha512");be("2.16.840.1.101.3.4.2.4","sha224");be("2.16.840.1.101.3.4.2.5","sha512-224");be("2.16.840.1.101.3.4.2.6","sha512-256");be("1.2.840.113549.2.2","md2");be("1.2.840.113549.2.5","md5");be("1.2.840.113549.1.7.1","data");be("1.2.840.113549.1.7.2","signedData");be("1.2.840.113549.1.7.3","envelopedData");be("1.2.840.113549.1.7.4","signedAndEnvelopedData");be("1.2.840.113549.1.7.5","digestedData");be("1.2.840.113549.1.7.6","encryptedData");be("1.2.840.113549.1.9.1","emailAddress");be("1.2.840.113549.1.9.2","unstructuredName");be("1.2.840.113549.1.9.3","contentType");be("1.2.840.113549.1.9.4","messageDigest");be("1.2.840.113549.1.9.5","signingTime");be("1.2.840.113549.1.9.6","counterSignature");be("1.2.840.113549.1.9.7","challengePassword");be("1.2.840.113549.1.9.8","unstructuredAddress");be("1.2.840.113549.1.9.14","extensionRequest");be("1.2.840.113549.1.9.20","friendlyName");be("1.2.840.113549.1.9.21","localKeyId");be("1.2.840.113549.1.9.22.1","x509Certificate");be("1.2.840.113549.1.12.10.1.1","keyBag");be("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");be("1.2.840.113549.1.12.10.1.3","certBag");be("1.2.840.113549.1.12.10.1.4","crlBag");be("1.2.840.113549.1.12.10.1.5","secretBag");be("1.2.840.113549.1.12.10.1.6","safeContentsBag");be("1.2.840.113549.1.5.13","pkcs5PBES2");be("1.2.840.113549.1.5.12","pkcs5PBKDF2");be("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");be("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");be("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");be("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");be("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");be("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");be("1.2.840.113549.2.7","hmacWithSHA1");be("1.2.840.113549.2.8","hmacWithSHA224");be("1.2.840.113549.2.9","hmacWithSHA256");be("1.2.840.113549.2.10","hmacWithSHA384");be("1.2.840.113549.2.11","hmacWithSHA512");be("1.2.840.113549.3.7","des-EDE3-CBC");be("2.16.840.1.101.3.4.1.2","aes128-CBC");be("2.16.840.1.101.3.4.1.22","aes192-CBC");be("2.16.840.1.101.3.4.1.42","aes256-CBC");be("2.5.4.3","commonName");be("2.5.4.4","surname");be("2.5.4.5","serialNumber");be("2.5.4.6","countryName");be("2.5.4.7","localityName");be("2.5.4.8","stateOrProvinceName");be("2.5.4.9","streetAddress");be("2.5.4.10","organizationName");be("2.5.4.11","organizationalUnitName");be("2.5.4.12","title");be("2.5.4.13","description");be("2.5.4.15","businessCategory");be("2.5.4.17","postalCode");be("2.5.4.42","givenName");be("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");be("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");be("2.16.840.1.113730.1.1","nsCertType");be("2.16.840.1.113730.1.13","nsComment");Jt("2.5.29.1","authorityKeyIdentifier");Jt("2.5.29.2","keyAttributes");Jt("2.5.29.3","certificatePolicies");Jt("2.5.29.4","keyUsageRestriction");Jt("2.5.29.5","policyMapping");Jt("2.5.29.6","subtreesConstraint");Jt("2.5.29.7","subjectAltName");Jt("2.5.29.8","issuerAltName");Jt("2.5.29.9","subjectDirectoryAttributes");Jt("2.5.29.10","basicConstraints");Jt("2.5.29.11","nameConstraints");Jt("2.5.29.12","policyConstraints");Jt("2.5.29.13","basicConstraints");be("2.5.29.14","subjectKeyIdentifier");be("2.5.29.15","keyUsage");Jt("2.5.29.16","privateKeyUsagePeriod");be("2.5.29.17","subjectAltName");be("2.5.29.18","issuerAltName");be("2.5.29.19","basicConstraints");Jt("2.5.29.20","cRLNumber");Jt("2.5.29.21","cRLReason");Jt("2.5.29.22","expirationDate");Jt("2.5.29.23","instructionCode");Jt("2.5.29.24","invalidityDate");Jt("2.5.29.25","cRLDistributionPoints");Jt("2.5.29.26","issuingDistributionPoint");Jt("2.5.29.27","deltaCRLIndicator");Jt("2.5.29.28","issuingDistributionPoint");Jt("2.5.29.29","certificateIssuer");Jt("2.5.29.30","nameConstraints");be("2.5.29.31","cRLDistributionPoints");be("2.5.29.32","certificatePolicies");Jt("2.5.29.33","policyMappings");Jt("2.5.29.34","policyConstraints");be("2.5.29.35","authorityKeyIdentifier");Jt("2.5.29.36","policyConstraints");be("2.5.29.37","extKeyUsage");Jt("2.5.29.46","freshestCRL");Jt("2.5.29.54","inhibitAnyPolicy");be("1.3.6.1.4.1.11129.2.4.2","timestampList");be("1.3.6.1.5.5.7.1.1","authorityInfoAccess");be("1.3.6.1.5.5.7.3.1","serverAuth");be("1.3.6.1.5.5.7.3.2","clientAuth");be("1.3.6.1.5.5.7.3.3","codeSigning");be("1.3.6.1.5.5.7.3.4","emailProtection");be("1.3.6.1.5.5.7.3.8","timeStamping")});var ul=m((cnt,PM)=>{f();var Cr=Rt();vr();Ep();var Ce=PM.exports=Cr.asn1=Cr.asn1||{};Ce.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};Ce.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};Ce.create=function(r,e,t,i,n){if(Cr.util.isArray(i)){for(var s=[],o=0;o<i.length;++o)i[o]!==void 0&&s.push(i[o]);i=s}var a={tagClass:r,type:e,constructed:t,composed:t||Cr.util.isArray(i),value:i};return n&&"bitStringContents"in n&&(a.bitStringContents=n.bitStringContents,a.original=Ce.copy(a)),a};Ce.copy=function(r,e){var t;if(Cr.util.isArray(r)){t=[];for(var i=0;i<r.length;++i)t.push(Ce.copy(r[i],e));return t}return typeof r=="string"?r:(t={tagClass:r.tagClass,type:r.type,constructed:r.constructed,composed:r.composed,value:Ce.copy(r.value,e)},e&&!e.excludeBitStringContents&&(t.bitStringContents=r.bitStringContents),t)};Ce.equals=function(r,e,t){if(Cr.util.isArray(r)){if(!Cr.util.isArray(e)||r.length!==e.length)return!1;for(var i=0;i<r.length;++i)if(!Ce.equals(r[i],e[i]))return!1;return!0}if(typeof r!=typeof e)return!1;if(typeof r=="string")return r===e;var n=r.tagClass===e.tagClass&&r.type===e.type&&r.constructed===e.constructed&&r.composed===e.composed&&Ce.equals(r.value,e.value);return t&&t.includeBitStringContents&&(n=n&&r.bitStringContents===e.bitStringContents),n};Ce.getBerValueLength=function(r){var e=r.getByte();if(e!==128){var t,i=e&128;return i?t=r.getInt((e&127)<<3):t=e,t}};function Hy(r,e,t){if(t>e){var i=new Error("Too few bytes to parse DER.");throw i.available=r.length(),i.remaining=e,i.requested=t,i}}var q_e=function(r,e){var t=r.getByte();if(e--,t!==128){var i,n=t&128;if(!n)i=t;else{var s=t&127;Hy(r,e,s),i=r.getInt(s<<3)}if(i<0)throw new Error("Negative length: "+i);return i}};Ce.fromDer=function(r,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof r=="string"&&(r=Cr.util.createBuffer(r));var t=r.length(),i=b4(r,r.length(),0,e);if(e.parseAllBytes&&r.length()!==0){var n=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw n.byteCount=t,n.remaining=r.length(),n}return i};function b4(r,e,t,i){var n;Hy(r,e,2);var s=r.getByte();e--;var o=s&192,a=s&31;n=r.length();var c=q_e(r,e);if(e-=n-r.length(),c!==void 0&&c>e){if(i.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=r.length(),u.remaining=e,u.requested=c,u}c=e}var l,d,h=(s&32)==32;if(h)if(l=[],c===void 0)for(;;){if(Hy(r,e,2),r.bytes(2)===String.fromCharCode(0,0)){r.getBytes(2),e-=2;break}n=r.length(),l.push(b4(r,e,t+1,i)),e-=n-r.length()}else for(;c>0;)n=r.length(),l.push(b4(r,c,t+1,i)),e-=n-r.length(),c-=n-r.length();if(l===void 0&&o===Ce.Class.UNIVERSAL&&a===Ce.Type.BITSTRING&&(d=r.bytes(c)),l===void 0&&i.decodeBitStrings&&o===Ce.Class.UNIVERSAL&&a===Ce.Type.BITSTRING&&c>1){var p=r.read,y=e,g=0;if(a===Ce.Type.BITSTRING&&(Hy(r,e,1),g=r.getByte(),e--),g===0)try{n=r.length();var w={strict:!0,decodeBitStrings:!0},b=b4(r,e,t+1,w),v=n-r.length();e-=v,a==Ce.Type.BITSTRING&&v++;var A=b.tagClass;v===c&&(A===Ce.Class.UNIVERSAL||A===Ce.Class.CONTEXT_SPECIFIC)&&(l=[b])}catch(C){}l===void 0&&(r.read=p,e=y)}if(l===void 0){if(c===void 0){if(i.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===Ce.Type.BMPSTRING)for(l="";c>0;c-=2)Hy(r,e,2),l+=String.fromCharCode(r.getInt16()),e-=2;else l=r.getBytes(c),e-=c}var k=d===void 0?null:{bitStringContents:d};return Ce.create(o,a,h,l,k)}Ce.toDer=function(r){var e=Cr.util.createBuffer(),t=r.tagClass|r.type,i=Cr.util.createBuffer(),n=!1;if("bitStringContents"in r&&(n=!0,r.original&&(n=Ce.equals(r,r.original))),n)i.putBytes(r.bitStringContents);else if(r.composed){r.constructed?t|=32:i.putByte(0);for(var s=0;s<r.value.length;++s)r.value[s]!==void 0&&i.putBuffer(Ce.toDer(r.value[s]))}else if(r.type===Ce.Type.BMPSTRING)for(var s=0;s<r.value.length;++s)i.putInt16(r.value.charCodeAt(s));else r.type===Ce.Type.INTEGER&&r.value.length>1&&(r.value.charCodeAt(0)===0&&(r.value.charCodeAt(1)&128)==0||r.value.charCodeAt(0)===255&&(r.value.charCodeAt(1)&128)==128)?i.putBytes(r.value.substr(1)):i.putBytes(r.value);if(e.putByte(t),i.length()<=127)e.putByte(i.length()&127);else{var o=i.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(i),e};Ce.oidToDer=function(r){var e=r.split("."),t=Cr.util.createBuffer();t.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var i,n,s,o,a=2;a<e.length;++a){i=!0,n=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,i||(o|=128),n.push(o),i=!1;while(s>0);for(var c=n.length-1;c>=0;--c)t.putByte(n[c])}return t};Ce.derToOid=function(r){var e;typeof r=="string"&&(r=Cr.util.createBuffer(r));var t=r.getByte();e=Math.floor(t/40)+"."+t%40;for(var i=0;r.length()>0;)t=r.getByte(),i=i<<7,t&128?i+=t&127:(e+="."+(i+t),i=0);return e};Ce.utcTimeToDate=function(r){var e=new Date,t=parseInt(r.substr(0,2),10);t=t>=50?1900+t:2e3+t;var i=parseInt(r.substr(2,2),10)-1,n=parseInt(r.substr(4,2),10),s=parseInt(r.substr(6,2),10),o=parseInt(r.substr(8,2),10),a=0;if(r.length>11){var c=r.charAt(10),u=10;c!=="+"&&c!=="-"&&(a=parseInt(r.substr(10,2),10),u+=2)}if(e.setUTCFullYear(t,i,n),e.setUTCHours(s,o,a,0),u&&(c=r.charAt(u),c==="+"||c==="-")){var l=parseInt(r.substr(u+1,2),10),d=parseInt(r.substr(u+4,2),10),h=l*60+d;h*=6e4,c==="+"?e.setTime(+e-h):e.setTime(+e+h)}return e};Ce.generalizedTimeToDate=function(r){var e=new Date,t=parseInt(r.substr(0,4),10),i=parseInt(r.substr(4,2),10)-1,n=parseInt(r.substr(6,2),10),s=parseInt(r.substr(8,2),10),o=parseInt(r.substr(10,2),10),a=parseInt(r.substr(12,2),10),c=0,u=0,l=!1;r.charAt(r.length-1)==="Z"&&(l=!0);var d=r.length-5,h=r.charAt(d);if(h==="+"||h==="-"){var p=parseInt(r.substr(d+1,2),10),y=parseInt(r.substr(d+4,2),10);u=p*60+y,u*=6e4,h==="+"&&(u*=-1),l=!0}return r.charAt(14)==="."&&(c=parseFloat(r.substr(14),10)*1e3),l?(e.setUTCFullYear(t,i,n),e.setUTCHours(s,o,a,c),e.setTime(+e+u)):(e.setFullYear(t,i,n),e.setHours(s,o,a,c)),e};Ce.dateToUtcTime=function(r){if(typeof r=="string")return r;var e="",t=[];t.push((""+r.getUTCFullYear()).substr(2)),t.push(""+(r.getUTCMonth()+1)),t.push(""+r.getUTCDate()),t.push(""+r.getUTCHours()),t.push(""+r.getUTCMinutes()),t.push(""+r.getUTCSeconds());for(var i=0;i<t.length;++i)t[i].length<2&&(e+="0"),e+=t[i];return e+="Z",e};Ce.dateToGeneralizedTime=function(r){if(typeof r=="string")return r;var e="",t=[];t.push(""+r.getUTCFullYear()),t.push(""+(r.getUTCMonth()+1)),t.push(""+r.getUTCDate()),t.push(""+r.getUTCHours()),t.push(""+r.getUTCMinutes()),t.push(""+r.getUTCSeconds());for(var i=0;i<t.length;++i)t[i].length<2&&(e+="0"),e+=t[i];return e+="Z",e};Ce.integerToDer=function(r){var e=Cr.util.createBuffer();if(r>=-128&&r<128)return e.putSignedInt(r,8);if(r>=-32768&&r<32768)return e.putSignedInt(r,16);if(r>=-8388608&&r<8388608)return e.putSignedInt(r,24);if(r>=-2147483648&&r<2147483648)return e.putSignedInt(r,32);var t=new Error("Integer too large; max is 32-bits.");throw t.integer=r,t};Ce.derToInteger=function(r){typeof r=="string"&&(r=Cr.util.createBuffer(r));var e=r.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return r.getSignedInt(e)};Ce.validate=function(r,e,t,i){var n=!1;if((r.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(r.type===e.type||typeof e.type=="undefined"))if(r.constructed===e.constructed||typeof e.constructed=="undefined"){if(n=!0,e.value&&Cr.util.isArray(e.value))for(var s=0,o=0;n&&o<e.value.length;++o)n=e.value[o].optional||!1,r.value[s]&&(n=Ce.validate(r.value[s],e.value[o],t,i),n?++s:e.value[o].optional&&(n=!0)),!n&&i&&i.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+r.value.length+'"');if(n&&t&&(e.capture&&(t[e.capture]=r.value),e.captureAsn1&&(t[e.captureAsn1]=r),e.captureBitStringContents&&"bitStringContents"in r&&(t[e.captureBitStringContents]=r.bitStringContents),e.captureBitStringValue&&"bitStringContents"in r)){var a;if(r.bitStringContents.length<2)t[e.captureBitStringValue]="";else{var c=r.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");t[e.captureBitStringValue]=r.bitStringContents.slice(1)}}}else i&&i.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+r.constructed+'"');else i&&(r.tagClass!==e.tagClass&&i.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+r.tagClass+'"'),r.type!==e.type&&i.push("["+e.name+'] Expected type "'+e.type+'", got "'+r.type+'"'));return n};var TM=/[^\\u0000-\\u00ff]/;Ce.prettyPrint=function(r,e,t){var i="";e=e||0,t=t||2,e>0&&(i+=`
`);for(var n="",s=0;s<e*t;++s)n+=" ";switch(i+=n+"Tag: ",r.tagClass){case Ce.Class.UNIVERSAL:i+="Universal:";break;case Ce.Class.APPLICATION:i+="Application:";break;case Ce.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case Ce.Class.PRIVATE:i+="Private:";break}if(r.tagClass===Ce.Class.UNIVERSAL)switch(i+=r.type,r.type){case Ce.Type.NONE:i+=" (None)";break;case Ce.Type.BOOLEAN:i+=" (Boolean)";break;case Ce.Type.INTEGER:i+=" (Integer)";break;case Ce.Type.BITSTRING:i+=" (Bit string)";break;case Ce.Type.OCTETSTRING:i+=" (Octet string)";break;case Ce.Type.NULL:i+=" (Null)";break;case Ce.Type.OID:i+=" (Object Identifier)";break;case Ce.Type.ODESC:i+=" (Object Descriptor)";break;case Ce.Type.EXTERNAL:i+=" (External or Instance of)";break;case Ce.Type.REAL:i+=" (Real)";break;case Ce.Type.ENUMERATED:i+=" (Enumerated)";break;case Ce.Type.EMBEDDED:i+=" (Embedded PDV)";break;case Ce.Type.UTF8:i+=" (UTF8)";break;case Ce.Type.ROID:i+=" (Relative Object Identifier)";break;case Ce.Type.SEQUENCE:i+=" (Sequence)";break;case Ce.Type.SET:i+=" (Set)";break;case Ce.Type.PRINTABLESTRING:i+=" (Printable String)";break;case Ce.Type.IA5String:i+=" (IA5String (ASCII))";break;case Ce.Type.UTCTIME:i+=" (UTC time)";break;case Ce.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case Ce.Type.BMPSTRING:i+=" (BMP String)";break}else i+=r.type;if(i+=`
`,i+=n+"Constructed: "+r.constructed+`
`,r.composed){for(var o=0,a="",s=0;s<r.value.length;++s)r.value[s]!==void 0&&(o+=1,a+=Ce.prettyPrint(r.value[s],e+1,t),s+1<r.value.length&&(a+=","));i+=n+"Sub values: "+o+a}else{if(i+=n+"Value: ",r.type===Ce.Type.OID){var c=Ce.derToOid(r.value);i+=c,Cr.pki&&Cr.pki.oids&&c in Cr.pki.oids&&(i+=" ("+Cr.pki.oids[c]+") ")}if(r.type===Ce.Type.INTEGER)try{i+=Ce.derToInteger(r.value)}catch(l){i+="0x"+Cr.util.bytesToHex(r.value)}else if(r.type===Ce.Type.BITSTRING){if(r.value.length>1?i+="0x"+Cr.util.bytesToHex(r.value.slice(1)):i+="(none)",r.value.length>0){var u=r.value.charCodeAt(0);u==1?i+=" (1 unused bit shown)":u>1&&(i+=" ("+u+" unused bits shown)")}}else if(r.type===Ce.Type.OCTETSTRING)TM.test(r.value)||(i+="("+r.value+") "),i+="0x"+Cr.util.bytesToHex(r.value);else if(r.type===Ce.Type.UTF8)try{i+=Cr.util.decodeUtf8(r.value)}catch(l){if(l.message==="URI malformed")i+="0x"+Cr.util.bytesToHex(r.value)+" (malformed UTF8)";else throw l}else r.type===Ce.Type.PRINTABLESTRING||r.type===Ce.Type.IA5String?i+=r.value:TM.test(r.value)?i+="0x"+Cr.util.bytesToHex(r.value):r.value.length===0?i+="[null]":i+=r.value}return i}});var Y7=m((unt,CM)=>{f();var $i=Rt();vr();CM.exports=$i.cipher=$i.cipher||{};$i.cipher.algorithms=$i.cipher.algorithms||{};$i.cipher.createCipher=function(r,e){var t=r;if(typeof t=="string"&&(t=$i.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+r);return new $i.cipher.BlockCipher({algorithm:t,key:e,decrypt:!1})};$i.cipher.createDecipher=function(r,e){var t=r;if(typeof t=="string"&&(t=$i.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+r);return new $i.cipher.BlockCipher({algorithm:t,key:e,decrypt:!0})};$i.cipher.registerAlgorithm=function(r,e){r=r.toUpperCase(),$i.cipher.algorithms[r]=e};$i.cipher.getAlgorithm=function(r){return r=r.toUpperCase(),r in $i.cipher.algorithms?$i.cipher.algorithms[r]:null};var W7=$i.cipher.BlockCipher=function(r){this.algorithm=r.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=r.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=r.decrypt,this.algorithm.initialize(r)};W7.prototype.start=function(r){r=r||{};var e={};for(var t in r)e[t]=r[t];e.decrypt=this._decrypt,this._finish=!1,this._input=$i.util.createBuffer(),this.output=r.output||$i.util.createBuffer(),this.mode.start(e)};W7.prototype.update=function(r){for(r&&this._input.putBuffer(r);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};W7.prototype.finish=function(r){r&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(t){return r(this.blockSize,t,!1)},this.mode.unpad=function(t){return r(this.blockSize,t,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Q7=m((lnt,OM)=>{f();var Gi=Rt();vr();Gi.cipher=Gi.cipher||{};var At=OM.exports=Gi.cipher.modes=Gi.cipher.modes||{};At.ecb=function(r){r=r||{},this.name="ECB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};At.ecb.prototype.start=function(r){};At.ecb.prototype.encrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};At.ecb.prototype.decrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};At.ecb.prototype.pad=function(r,e){var t=r.length()===this.blockSize?this.blockSize:this.blockSize-r.length();return r.fillWithByte(t,t),!0};At.ecb.prototype.unpad=function(r,e){if(e.overflow>0)return!1;var t=r.length(),i=r.at(t-1);return i>this.blockSize<<2?!1:(r.truncate(i),!0)};At.cbc=function(r){r=r||{},this.name="CBC",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};At.cbc.prototype.start=function(r){if(r.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in r)this._iv=w4(r.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};At.cbc.prototype.encrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=this._prev[i]^r.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]);this._prev=this._outBlock};At.cbc.prototype.decrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._prev[i]^this._outBlock[i]);this._prev=this._inBlock.slice(0)};At.cbc.prototype.pad=function(r,e){var t=r.length()===this.blockSize?this.blockSize:this.blockSize-r.length();return r.fillWithByte(t,t),!0};At.cbc.prototype.unpad=function(r,e){if(e.overflow>0)return!1;var t=r.length(),i=r.at(t-1);return i>this.blockSize<<2?!1:(r.truncate(i),!0)};At.cfb=function(r){r=r||{},this.name="CFB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Gi.util.createBuffer(),this._partialBytes=0};At.cfb.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=w4(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};At.cfb.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=r.getInt32()^this._outBlock[n],e.putInt32(this._inBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=r.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};At.cfb.prototype.decrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=r.getInt32(),e.putInt32(this._inBlock[n]^this._outBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=r.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};At.ofb=function(r){r=r||{},this.name="OFB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Gi.util.createBuffer(),this._partialBytes=0};At.ofb.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=w4(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};At.ofb.prototype.encrypt=function(r,e,t){var i=r.length();if(r.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(r.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};At.ofb.prototype.decrypt=At.ofb.prototype.encrypt;At.ctr=function(r){r=r||{},this.name="CTR",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Gi.util.createBuffer(),this._partialBytes=0};At.ctr.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=w4(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};At.ctr.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize)for(var n=0;n<this._ints;++n)e.putInt32(r.getInt32()^this._outBlock[n]);else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s>0&&(r.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}_4(this._inBlock)};At.ctr.prototype.decrypt=At.ctr.prototype.encrypt;At.gcm=function(r){r=r||{},this.name="GCM",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Gi.util.createBuffer(),this._partialBytes=0,this._R=3774873600};At.gcm.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");var e=Gi.util.createBuffer(r.iv);this._cipherLength=0;var t;if("additionalData"in r?t=Gi.util.createBuffer(r.additionalData):t=Gi.util.createBuffer(),"tagLength"in r?this._tagLength=r.tagLength:this._tagLength=128,this._tag=null,r.decrypt&&(this._tag=Gi.util.createBuffer(r.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=e.length();if(i===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(X7(i*8)))}this._inBlock=this._j0.slice(0),_4(this._inBlock),this._partialBytes=0,t=Gi.util.createBuffer(t),this._aDataLength=X7(t.length()*8);var n=t.length()%this.blockSize;for(n&&t.fillWithByte(0,this.blockSize-n),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])};At.gcm.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^=r.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s<=0||t){if(t){var o=i%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var n=0;n<this._ints;++n)this._outBlock[n]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return r.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),_4(this._inBlock)};At.gcm.prototype.decrypt=function(r,e,t){var i=r.length();if(i<this.blockSize&&!(t&&i>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),_4(this._inBlock),this._hashBlock[0]=r.getInt32(),this._hashBlock[1]=r.getInt32(),this._hashBlock[2]=r.getInt32(),this._hashBlock[3]=r.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^this._hashBlock[n]);i<this.blockSize?this._cipherLength+=i%this.blockSize:this._cipherLength+=this.blockSize};At.gcm.prototype.afterFinish=function(r,e){var t=!0;e.decrypt&&e.overflow&&r.truncate(this.blockSize-e.overflow),this.tag=Gi.util.createBuffer();var i=this._aDataLength.concat(X7(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,i);var n=[];this.cipher.encrypt(this._j0,n);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^n[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(t=!1),t};At.gcm.prototype.multiply=function(r,e){for(var t=[0,0,0,0],i=e.slice(0),n=0;n<128;++n){var s=r[n/32|0]&1<<31-n%32;s&&(t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]),this.pow(i,i)}return t};At.gcm.prototype.pow=function(r,e){for(var t=r[3]&1,i=3;i>0;--i)e[i]=r[i]>>>1|(r[i-1]&1)<<31;e[0]=r[0]>>>1,t&&(e[0]^=this._R)};At.gcm.prototype.tableMultiply=function(r){for(var e=[0,0,0,0],t=0;t<32;++t){var i=t/8|0,n=r[i]>>>(7-t%8)*4&15,s=this._m[t][n];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};At.gcm.prototype.ghash=function(r,e,t){return e[0]^=t[0],e[1]^=t[1],e[2]^=t[2],e[3]^=t[3],this.tableMultiply(e)};At.gcm.prototype.generateHashTable=function(r,e){for(var t=8/e,i=4*t,n=16*t,s=new Array(n),o=0;o<n;++o){var a=[0,0,0,0],c=o/i|0,u=(i-1-o%i)*e;a[c]=1<<e-1<<u,s[o]=this.generateSubHashTable(this.multiply(a,r),e)}return s};At.gcm.prototype.generateSubHashTable=function(r,e){var t=1<<e,i=t>>>1,n=new Array(t);n[i]=r.slice(0);for(var s=i>>>1;s>0;)this.pow(n[2*s],n[s]=[]),s>>=1;for(s=2;s<i;){for(var o=1;o<s;++o){var a=n[s],c=n[o];n[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(n[0]=[0,0,0,0],s=i+1;s<t;++s){var u=n[s^i];n[s]=[r[0]^u[0],r[1]^u[1],r[2]^u[2],r[3]^u[3]]}return n};function w4(r,e){if(typeof r=="string"&&(r=Gi.util.createBuffer(r)),Gi.util.isArray(r)&&r.length>4){var t=r;r=Gi.util.createBuffer();for(var i=0;i<t.length;++i)r.putByte(t[i])}if(r.length()<e)throw new Error("Invalid IV length; got "+r.length()+" bytes and expected "+e+" bytes.");if(!Gi.util.isArray(r)){for(var n=[],s=e/4,i=0;i<s;++i)n.push(r.getInt32());r=n}return r}function _4(r){r[r.length-1]=r[r.length-1]+1&4294967295}function X7(r){return[r/4294967296|0,r&4294967295]}});var Ap=m((fnt,BM)=>{f();var Er=Rt();Y7();Q7();vr();BM.exports=Er.aes=Er.aes||{};Er.aes.startEncrypting=function(r,e,t,i){var n=v4({key:r,output:t,decrypt:!1,mode:i});return n.start(e),n};Er.aes.createEncryptionCipher=function(r,e){return v4({key:r,output:null,decrypt:!1,mode:e})};Er.aes.startDecrypting=function(r,e,t,i){var n=v4({key:r,output:t,decrypt:!0,mode:i});return n.start(e),n};Er.aes.createDecryptionCipher=function(r,e){return v4({key:r,output:null,decrypt:!0,mode:e})};Er.aes.Algorithm=function(r,e){Z7||DM();var t=this;t.name=r,t.mode=new e({blockSize:16,cipher:{encrypt:function(i,n){return eE(t._w,i,n,!1)},decrypt:function(i,n){return eE(t._w,i,n,!0)}}}),t._init=!1};Er.aes.Algorithm.prototype.initialize=function(r){if(!this._init){var e=r.key,t;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=Er.util.createBuffer(e);else if(Er.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){t=e,e=Er.util.createBuffer();for(var i=0;i<t.length;++i)e.putByte(t[i])}if(!Er.util.isArray(e)){t=e,e=[];var n=t.length();if(n===16||n===24||n===32){n=n>>>2;for(var i=0;i<n;++i)e.push(t.getInt32())}}if(!Er.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=NM(e,r.decrypt&&!o),this._init=!0}};Er.aes._expandKey=function(r,e){return Z7||DM(),NM(r,e)};Er.aes._updateBlock=eE;Sp("AES-ECB",Er.cipher.modes.ecb);Sp("AES-CBC",Er.cipher.modes.cbc);Sp("AES-CFB",Er.cipher.modes.cfb);Sp("AES-OFB",Er.cipher.modes.ofb);Sp("AES-CTR",Er.cipher.modes.ctr);Sp("AES-GCM",Er.cipher.modes.gcm);function Sp(r,e){var t=function(){return new Er.aes.Algorithm(r,e)};Er.cipher.registerAlgorithm(r,t)}var Z7=!1,Rp=4,Nn,J7,kM,zf,Go;function DM(){Z7=!0,kM=[0,1,2,4,8,16,32,64,128,27,54];for(var r=new Array(256),e=0;e<128;++e)r[e]=e<<1,r[e+128]=e+128<<1^283;Nn=new Array(256),J7=new Array(256),zf=new Array(4),Go=new Array(4);for(var e=0;e<4;++e)zf[e]=new Array(256),Go[e]=new Array(256);for(var t=0,i=0,n,s,o,a,c,u,l,e=0;e<256;++e){a=i^i<<1^i<<2^i<<3^i<<4,a=a>>8^a&255^99,Nn[t]=a,J7[a]=t,c=r[a],n=r[t],s=r[n],o=r[s],u=c<<24^a<<16^a<<8^(a^c),l=(n^s^o)<<24^(t^o)<<16^(t^s^o)<<8^(t^n^o);for(var d=0;d<4;++d)zf[d][t]=u,Go[d][a]=l,u=u<<24|u>>>8,l=l<<24|l>>>8;t===0?t=i=1:(t=n^r[r[r[n^o]]],i^=r[r[i]])}}function NM(r,e){for(var t=r.slice(0),i,n=1,s=t.length,o=s+6+1,a=Rp*o,c=s;c<a;++c)i=t[c-1],c%s==0?(i=Nn[i>>>16&255]<<24^Nn[i>>>8&255]<<16^Nn[i&255]<<8^Nn[i>>>24]^kM[n]<<24,n++):s>6&&c%s==4&&(i=Nn[i>>>24]<<24^Nn[i>>>16&255]<<16^Nn[i>>>8&255]<<8^Nn[i&255]),t[c]=t[c-s]^i;if(e){var u,l=Go[0],d=Go[1],h=Go[2],p=Go[3],y=t.slice(0);a=t.length;for(var c=0,g=a-Rp;c<a;c+=Rp,g-=Rp)if(c===0||c===a-Rp)y[c]=t[g],y[c+1]=t[g+3],y[c+2]=t[g+2],y[c+3]=t[g+1];else for(var w=0;w<Rp;++w)u=t[g+w],y[c+(3&-w)]=l[Nn[u>>>24]]^d[Nn[u>>>16&255]]^h[Nn[u>>>8&255]]^p[Nn[u&255]];t=y}return t}function eE(r,e,t,i){var n=r.length/4-1,s,o,a,c,u;i?(s=Go[0],o=Go[1],a=Go[2],c=Go[3],u=J7):(s=zf[0],o=zf[1],a=zf[2],c=zf[3],u=Nn);var l,d,h,p,y,g,w;l=e[0]^r[0],d=e[i?3:1]^r[1],h=e[2]^r[2],p=e[i?1:3]^r[3];for(var b=3,v=1;v<n;++v)y=s[l>>>24]^o[d>>>16&255]^a[h>>>8&255]^c[p&255]^r[++b],g=s[d>>>24]^o[h>>>16&255]^a[p>>>8&255]^c[l&255]^r[++b],w=s[h>>>24]^o[p>>>16&255]^a[l>>>8&255]^c[d&255]^r[++b],p=s[p>>>24]^o[l>>>16&255]^a[d>>>8&255]^c[h&255]^r[++b],l=y,d=g,h=w;t[0]=u[l>>>24]<<24^u[d>>>16&255]<<16^u[h>>>8&255]<<8^u[p&255]^r[++b],t[i?3:1]=u[d>>>24]<<24^u[h>>>16&255]<<16^u[p>>>8&255]<<8^u[l&255]^r[++b],t[2]=u[h>>>24]<<24^u[p>>>16&255]<<16^u[l>>>8&255]<<8^u[d&255]^r[++b],t[i?1:3]=u[p>>>24]<<24^u[l>>>16&255]<<16^u[d>>>8&255]<<8^u[h&255]^r[++b]}function v4(r){r=r||{};var e=(r.mode||"CBC").toUpperCase(),t="AES-"+e,i;r.decrypt?i=Er.cipher.createDecipher(t,r.key):i=Er.cipher.createCipher(t,r.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof Er.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var S4=m((dnt,MM)=>{f();var jr=Rt();Y7();Q7();vr();MM.exports=jr.des=jr.des||{};jr.des.startEncrypting=function(r,e,t,i){var n=E4({key:r,output:t,decrypt:!1,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};jr.des.createEncryptionCipher=function(r,e){return E4({key:r,output:null,decrypt:!1,mode:e})};jr.des.startDecrypting=function(r,e,t,i){var n=E4({key:r,output:t,decrypt:!0,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};jr.des.createDecryptionCipher=function(r,e){return E4({key:r,output:null,decrypt:!0,mode:e})};jr.des.Algorithm=function(r,e){var t=this;t.name=r,t.mode=new e({blockSize:8,cipher:{encrypt:function(i,n){return LM(t._keys,i,n,!1)},decrypt:function(i,n){return LM(t._keys,i,n,!0)}}}),t._init=!1};jr.des.Algorithm.prototype.initialize=function(r){if(!this._init){var e=jr.util.createBuffer(r.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=W_e(e),this._init=!0}};Na("DES-ECB",jr.cipher.modes.ecb);Na("DES-CBC",jr.cipher.modes.cbc);Na("DES-CFB",jr.cipher.modes.cfb);Na("DES-OFB",jr.cipher.modes.ofb);Na("DES-CTR",jr.cipher.modes.ctr);Na("3DES-ECB",jr.cipher.modes.ecb);Na("3DES-CBC",jr.cipher.modes.cbc);Na("3DES-CFB",jr.cipher.modes.cfb);Na("3DES-OFB",jr.cipher.modes.ofb);Na("3DES-CTR",jr.cipher.modes.ctr);function Na(r,e){var t=function(){return new jr.des.Algorithm(r,e)};jr.cipher.registerAlgorithm(r,t)}var U_e=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],F_e=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],K_e=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],V_e=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],z_e=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],H_e=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],$_e=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],G_e=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function W_e(r){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],t=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],d=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],y=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=r.length()>8?3:1,w=[],b=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],v=0,A,k=0;k<g;k++){var C=r.getInt32(),T=r.getInt32();A=(C>>>4^T)&252645135,T^=A,C^=A<<4,A=(T>>>-16^C)&65535,C^=A,T^=A<<-16,A=(C>>>2^T)&858993459,T^=A,C^=A<<2,A=(T>>>-16^C)&65535,C^=A,T^=A<<-16,A=(C>>>1^T)&1431655765,T^=A,C^=A<<1,A=(T>>>8^C)&16711935,C^=A,T^=A<<8,A=(C>>>1^T)&1431655765,T^=A,C^=A<<1,A=C<<8|T>>>20&240,C=T<<24|T<<8&16711680|T>>>8&65280|T>>>24&240,T=A;for(var D=0;D<b.length;++D){b[D]?(C=C<<2|C>>>26,T=T<<2|T>>>26):(C=C<<1|C>>>27,T=T<<1|T>>>27),C&=-15,T&=-15;var j=e[C>>>28]|t[C>>>24&15]|i[C>>>20&15]|n[C>>>16&15]|s[C>>>12&15]|o[C>>>8&15]|a[C>>>4&15],M=c[T>>>28]|u[T>>>24&15]|l[T>>>20&15]|d[T>>>16&15]|h[T>>>12&15]|p[T>>>8&15]|y[T>>>4&15];A=(M>>>16^j)&65535,w[v++]=j^A,w[v++]=M^A<<16}}return w}function LM(r,e,t,i){var n=r.length===32?3:9,s;n===3?s=i?[30,-2,-2]:[0,32,2]:s=i?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var u=0;u<n;u+=3){for(var l=s[u+1],d=s[u+2],h=s[u];h!=l;h+=d){var p=c^r[h],y=(c>>>4|c<<28)^r[h+1];o=a,a=c,c=o^(F_e[p>>>24&63]|V_e[p>>>16&63]|H_e[p>>>8&63]|G_e[p&63]|U_e[y>>>24&63]|K_e[y>>>16&63]|z_e[y>>>8&63]|$_e[y&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,t[0]=a,t[1]=c}function E4(r){r=r||{};var e=(r.mode||"CBC").toUpperCase(),t="DES-"+e,i;r.decrypt?i=jr.cipher.createDecipher(t,r.key):i=jr.cipher.createCipher(t,r.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof jr.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var ll=m((hnt,jM)=>{f();var R4=Rt();jM.exports=R4.md=R4.md||{};R4.md.algorithms=R4.md.algorithms||{}});var UM=m((pnt,qM)=>{f();var Wc=Rt();ll();vr();var Y_e=qM.exports=Wc.hmac=Wc.hmac||{};Y_e.create=function(){var r=null,e=null,t=null,i=null,n={};return n.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Wc.md.algorithms)e=Wc.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=r;else{if(typeof o=="string")o=Wc.util.createBuffer(o);else if(Wc.util.isArray(o)){var a=o;o=Wc.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var u=o.length();u>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),t=Wc.util.createBuffer(),i=Wc.util.createBuffer(),u=o.length();for(var c=0;c<u;++c){var a=o.at(c);t.putByte(54^a),i.putByte(92^a)}if(u<e.blockLength)for(var a=e.blockLength-u,c=0;c<a;++c)t.putByte(54),i.putByte(92);r=o,t=t.bytes(),i=i.bytes()}e.start(),e.update(t)},n.update=function(s){e.update(s)},n.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(i),e.update(s),e.digest()},n.digest=n.getMac,n}});var Hf=m(()=>{f()});var tE=m((mnt,FM)=>{f();var Bn=Rt();UM();ll();vr();var X_e=Bn.pkcs5=Bn.pkcs5||{},Yc;Bn.util.isNodejs&&!Bn.options.usePureJavaScript&&(Yc=Hf());FM.exports=Bn.pbkdf2=X_e.pbkdf2=function(r,e,t,i,n,s){if(typeof n=="function"&&(s=n,n=null),Bn.util.isNodejs&&!Bn.options.usePureJavaScript&&Yc.pbkdf2&&(n===null||typeof n!="object")&&(Yc.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),r=Buffer.from(r,"binary"),e=Buffer.from(e,"binary"),s?Yc.pbkdf2Sync.length===4?Yc.pbkdf2(r,e,t,i,function(A,k){if(A)return s(A);s(null,k.toString("binary"))}):Yc.pbkdf2(r,e,t,i,n,function(A,k){if(A)return s(A);s(null,k.toString("binary"))}):Yc.pbkdf2Sync.length===4?Yc.pbkdf2Sync(r,e,t,i).toString("binary"):Yc.pbkdf2Sync(r,e,t,i,n).toString("binary");if((typeof n=="undefined"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in Bn.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=Bn.md[n].create()}var o=n.digestLength;if(i>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(i/o),u=i-(c-1)*o,l=Bn.hmac.create();l.start(n,r);var d="",h,p,y;if(!s){for(var g=1;g<=c;++g){l.start(null,null),l.update(e),l.update(Bn.util.int32ToBytes(g)),h=y=l.digest().getBytes();for(var w=2;w<=t;++w)l.start(null,null),l.update(y),p=l.digest().getBytes(),h=Bn.util.xorBytes(h,p,o),y=p;d+=g<c?h:h.substr(0,u)}return d}var g=1,w;function b(){if(g>c)return s(null,d);l.start(null,null),l.update(e),l.update(Bn.util.int32ToBytes(g)),h=y=l.digest().getBytes(),w=2,v()}function v(){if(w<=t)return l.start(null,null),l.update(y),p=l.digest().getBytes(),h=Bn.util.xorBytes(h,p,o),y=p,++w,Bn.util.setImmediate(v);d+=g<c?h:h.substr(0,u),++g,b()}b()}});var I4=m((bnt,VM)=>{f();var A4=Rt();vr();var KM=VM.exports=A4.pem=A4.pem||{};KM.encode=function(r,e){e=e||{};var t="-----BEGIN "+r.type+`-----\r
`,i;if(r.procType&&(i={name:"Proc-Type",values:[String(r.procType.version),r.procType.type]},t+=x4(i)),r.contentDomain&&(i={name:"Content-Domain",values:[r.contentDomain]},t+=x4(i)),r.dekInfo&&(i={name:"DEK-Info",values:[r.dekInfo.algorithm]},r.dekInfo.parameters&&i.values.push(r.dekInfo.parameters),t+=x4(i)),r.headers)for(var n=0;n<r.headers.length;++n)t+=x4(r.headers[n]);return r.procType&&(t+=`\r
`),t+=A4.util.encode64(r.body,e.maxline||64)+`\r
`,t+="-----END "+r.type+`-----\r
`,t};KM.decode=function(r){for(var e=[],t=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,n=/\r?\n/,s;s=t.exec(r),!!s;){var o=s[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:A4.util.decode64(s[3])};if(e.push(a),!!s[2]){for(var c=s[2].split(n),u=0;s&&u<c.length;){for(var l=c[u].replace(/\s+$/,""),d=u+1;d<c.length;++d){var h=c[d];if(!/\s/.test(h[0]))break;l+=h,u=d}if(s=l.match(i),s){for(var p={name:s[1],values:[]},y=s[2].split(","),g=0;g<y.length;++g)p.values.push(Q_e(y[g]));if(a.procType)if(!a.contentDomain&&p.name==="Content-Domain")a.contentDomain=y[0]||"";else if(!a.dekInfo&&p.name==="DEK-Info"){if(p.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:y[0],parameters:y[1]||null}}else a.headers.push(p);else{if(p.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(p.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:y[0],type:y[1]}}}++u}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function x4(r){for(var e=r.name+": ",t=[],i=function(c,u){return" "+u},n=0;n<r.values.length;++n)t.push(r.values[n].replace(/^(\S+\r\n)/,i));e+=t.join(",")+`\r
`;for(var s=0,o=-1,n=0;n<e.length;++n,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=n-o-1,o=-1,++n}else(e[n]===" "||e[n]==="	"||e[n]===",")&&(o=n);return e}function Q_e(r){return r.replace(/^\s+/,"")}});var YM=m((wnt,WM)=>{f();var Ba=Rt();ll();vr();var zM=WM.exports=Ba.sha256=Ba.sha256||{};Ba.md.sha256=Ba.md.algorithms.sha256=zM;zM.create=function(){HM||Z_e();var r=null,e=Ba.util.createBuffer(),t=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=Ba.util.createBuffer(),r={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=Ba.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),GM(r,t,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=Ba.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(rE.substr(0,i.blockLength-o));for(var a,c,u=i.fullMessageLength[0]*8,l=0;l<i.fullMessageLength.length-1;++l)a=i.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=a>>>0;n.putInt32(u);var d={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3,h4:r.h4,h5:r.h5,h6:r.h6,h7:r.h7};GM(d,t,n);var h=Ba.util.createBuffer();return h.putInt32(d.h0),h.putInt32(d.h1),h.putInt32(d.h2),h.putInt32(d.h3),h.putInt32(d.h4),h.putInt32(d.h5),h.putInt32(d.h6),h.putInt32(d.h7),h},i};var rE=null,HM=!1,$M=null;function Z_e(){rE=String.fromCharCode(128),rE+=Ba.util.fillString(String.fromCharCode(0),64),$M=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],HM=!0}function GM(r,e,t){for(var i,n,s,o,a,c,u,l,d,h,p,y,g,w,b,v=t.length();v>=64;){for(u=0;u<16;++u)e[u]=t.getInt32();for(;u<64;++u)i=e[u-2],i=(i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,n=e[u-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,e[u]=i+e[u-7]+n+e[u-16]|0;for(l=r.h0,d=r.h1,h=r.h2,p=r.h3,y=r.h4,g=r.h5,w=r.h6,b=r.h7,u=0;u<64;++u)o=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),a=w^y&(g^w),s=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),c=l&d|h&(l^d),i=b+o+a+$M[u]+e[u],n=s+c,b=w,w=g,g=y,y=p+i>>>0,p=h,h=d,d=l,l=i+n>>>0;r.h0=r.h0+l|0,r.h1=r.h1+d|0,r.h2=r.h2+h|0,r.h3=r.h3+p|0,r.h4=r.h4+y|0,r.h5=r.h5+g|0,r.h6=r.h6+w|0,r.h7=r.h7+b|0,v-=64}}});var QM=m((_nt,XM)=>{f();var La=Rt();vr();var T4=null;La.util.isNodejs&&!La.options.usePureJavaScript&&!process.versions["node-webkit"]&&(T4=Hf());var J_e=XM.exports=La.prng=La.prng||{};J_e.create=function(r){for(var e={plugin:r,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},t=r.md,i=new Array(32),n=0;n<32;++n)i[n]=t.create();e.pools=i,e.pool=0,e.generate=function(u,l){if(!l)return e.generateSync(u);var d=e.plugin.cipher,h=e.plugin.increment,p=e.plugin.formatKey,y=e.plugin.formatSeed,g=La.util.createBuffer();e.key=null,w();function w(b){if(b)return l(b);if(g.length()>=u)return l(null,g.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return La.util.nextTick(function(){s(w)});var v=d(e.key,e.seed);e.generated+=v.length,g.putBytes(v),e.key=p(d(e.key,h(e.seed))),e.seed=y(d(e.key,e.seed)),La.util.setImmediate(w)}},e.generateSync=function(u){var l=e.plugin.cipher,d=e.plugin.increment,h=e.plugin.formatKey,p=e.plugin.formatSeed;e.key=null;for(var y=La.util.createBuffer();y.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&o();var g=l(e.key,e.seed);e.generated+=g.length,y.putBytes(g),e.key=h(l(e.key,d(e.seed))),e.seed=p(l(e.key,e.seed))}return y.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return a(),u();var l=32-e.pools[0].messageLength<<5;e.seedFile(l,function(d,h){if(d)return u(d);e.collect(h),a(),u()})}function o(){if(e.pools[0].messageLength>=32)return a();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var l=1,d=0;d<32;++d)e.reseeds%l==0&&(u.update(e.pools[d].digest().getBytes()),e.pools[d].start()),l=l<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var h=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(h),e.generated=0}function c(u){var l=null,d=La.util.globalScope,h=d.crypto||d.msCrypto;h&&h.getRandomValues&&(l=function(C){return h.getRandomValues(C)});var p=La.util.createBuffer();if(l)for(;p.length()<u;){var y=Math.max(1,Math.min(u-p.length(),65536)/4),g=new Uint32Array(Math.floor(y));try{l(g);for(var w=0;w<g.length;++w)p.putInt32(g[w])}catch(C){if(!(typeof QuotaExceededError!="undefined"&&C instanceof QuotaExceededError))throw C}}if(p.length()<u)for(var b,v,A,k=Math.floor(Math.random()*65536);p.length()<u;){v=16807*(k&65535),b=16807*(k>>16),v+=(b&32767)<<16,v+=b>>15,v=(v&2147483647)+(v>>31),k=v&4294967295;for(var w=0;w<3;++w)A=k>>>(w<<3),A^=Math.floor(Math.random()*256),p.putByte(A&255)}return p.getBytes(u)}return T4?(e.seedFile=function(u,l){T4.randomBytes(u,function(d,h){if(d)return l(d);l(null,h.toString())})},e.seedFileSync=function(u){return T4.randomBytes(u).toString()}):(e.seedFile=function(u,l){try{l(null,c(u))}catch(d){l(d)}},e.seedFileSync=c),e.collect=function(u){for(var l=u.length,d=0;d<l;++d)e.pools[e.pool].update(u.substr(d,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,l){for(var d="",h=0;h<l;h+=8)d+=String.fromCharCode(u>>h&255);e.collect(d)},e.registerWorker=function(u){if(u===self)e.seedFile=function(d,h){function p(y){var g=y.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",p),h(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",p),self.postMessage({forge:{prng:{needed:d}}})};else{var l=function(d){var h=d.data;h.forge&&h.forge.prng&&e.seedFile(h.forge.prng.needed,function(p,y){u.postMessage({forge:{prng:{err:p,bytes:y}}})})};u.addEventListener("message",l)}},e}});var $f=m((vnt,iE)=>{f();var Wi=Rt();Ap();YM();QM();vr();(function(){if(Wi.random&&Wi.random.getBytes){iE.exports=Wi.random;return}(function(r){var e={},t=new Array(4),i=Wi.util.createBuffer();e.formatKey=function(d){var h=Wi.util.createBuffer(d);return d=new Array(4),d[0]=h.getInt32(),d[1]=h.getInt32(),d[2]=h.getInt32(),d[3]=h.getInt32(),Wi.aes._expandKey(d,!1)},e.formatSeed=function(d){var h=Wi.util.createBuffer(d);return d=new Array(4),d[0]=h.getInt32(),d[1]=h.getInt32(),d[2]=h.getInt32(),d[3]=h.getInt32(),d},e.cipher=function(d,h){return Wi.aes._updateBlock(d,h,t,!1),i.putInt32(t[0]),i.putInt32(t[1]),i.putInt32(t[2]),i.putInt32(t[3]),i.getBytes()},e.increment=function(d){return++d[3],d},e.md=Wi.md.sha256;function n(){var d=Wi.prng.create(e);return d.getBytes=function(h,p){return d.generate(h,p)},d.getBytesSync=function(h){return d.generate(h)},d}var s=n(),o=null,a=Wi.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(d){return c.getRandomValues(d)}),Wi.options.usePureJavaScript||!Wi.util.isNodejs&&!o){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var u="";for(var l in navigator)try{typeof navigator[l]=="string"&&(u+=navigator[l])}catch(d){}s.collect(u),u=null}r&&(r().mousemove(function(d){s.collectInt(d.clientX,16),s.collectInt(d.clientY,16)}),r().keypress(function(d){s.collectInt(d.charCode,8)}))}if(!Wi.random)Wi.random=s;else for(var l in s)Wi.random[l]=s[l];Wi.random.createInstance=n,iE.exports=Wi.random})(typeof jQuery!="undefined"?jQuery:null)})()});var tj=m((Ent,ej)=>{f();var Yn=Rt();vr();var nE=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],ZM=[1,2,3,5],eve=function(r,e){return r<<e&65535|(r&65535)>>16-e},tve=function(r,e){return(r&65535)>>e|r<<16-e&65535};ej.exports=Yn.rc2=Yn.rc2||{};Yn.rc2.expandKey=function(r,e){typeof r=="string"&&(r=Yn.util.createBuffer(r)),e=e||128;var t=r,i=r.length(),n=e,s=Math.ceil(n/8),o=255>>(n&7),a;for(a=i;a<128;a++)t.putByte(nE[t.at(a-1)+t.at(a-i)&255]);for(t.setAt(128-s,nE[t.at(128-s)&o]),a=127-s;a>=0;a--)t.setAt(a,nE[t.at(a+1)^t.at(a+s)]);return t};var JM=function(r,e,t){var i=!1,n=null,s=null,o=null,a,c,u,l,d=[];for(r=Yn.rc2.expandKey(r,e),u=0;u<64;u++)d.push(r.getInt16Le());t?(a=function(y){for(u=0;u<4;u++)y[u]+=d[l]+(y[(u+3)%4]&y[(u+2)%4])+(~y[(u+3)%4]&y[(u+1)%4]),y[u]=eve(y[u],ZM[u]),l++},c=function(y){for(u=0;u<4;u++)y[u]+=d[y[(u+3)%4]&63]}):(a=function(y){for(u=3;u>=0;u--)y[u]=tve(y[u],ZM[u]),y[u]-=d[l]+(y[(u+3)%4]&y[(u+2)%4])+(~y[(u+3)%4]&y[(u+1)%4]),l--},c=function(y){for(u=3;u>=0;u--)y[u]-=d[y[(u+3)%4]&63]});var h=function(y){var g=[];for(u=0;u<4;u++){var w=n.getInt16Le();o!==null&&(t?w^=o.getInt16Le():o.putInt16Le(w)),g.push(w&65535)}l=t?0:63;for(var b=0;b<y.length;b++)for(var v=0;v<y[b][0];v++)y[b][1](g);for(u=0;u<4;u++)o!==null&&(t?o.putInt16Le(g[u]):g[u]^=o.getInt16Le()),s.putInt16Le(g[u])},p=null;return p={start:function(y,g){y&&typeof y=="string"&&(y=Yn.util.createBuffer(y)),i=!1,n=Yn.util.createBuffer(),s=g||new Yn.util.createBuffer,o=y,p.output=s},update:function(y){for(i||n.putBuffer(y);n.length()>=8;)h([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(y){var g=!0;if(t)if(y)g=y(8,n,!t);else{var w=n.length()===8?8:8-n.length();n.fillWithByte(w,w)}if(g&&(i=!0,p.update()),!t&&(g=n.length()===0,g))if(y)g=y(8,s,!t);else{var b=s.length(),v=s.at(b-1);v>b?g=!1:s.truncate(v)}return g}},p};Yn.rc2.startEncrypting=function(r,e,t){var i=Yn.rc2.createEncryptionCipher(r,128);return i.start(e,t),i};Yn.rc2.createEncryptionCipher=function(r,e){return JM(r,e,!0)};Yn.rc2.startDecrypting=function(r,e,t){var i=Yn.rc2.createDecryptionCipher(r,128);return i.start(e,t),i};Yn.rc2.createDecryptionCipher=function(r,e){return JM(r,e,!1)}});var O4=m((Snt,uj)=>{f();var sE=Rt();uj.exports=sE.jsbn=sE.jsbn||{};var Xc,rve=244837814094590,rj=(rve&16777215)==15715070;function ye(r,e,t){this.data=[],r!=null&&(typeof r=="number"?this.fromNumber(r,e,t):e==null&&typeof r!="string"?this.fromString(r,256):this.fromString(r,e))}sE.jsbn.BigInteger=ye;function zt(){return new ye(null)}function ive(r,e,t,i,n,s){for(;--s>=0;){var o=e*this.data[r++]+t.data[i]+n;n=Math.floor(o/67108864),t.data[i++]=o&67108863}return n}function nve(r,e,t,i,n,s){for(var o=e&32767,a=e>>15;--s>=0;){var c=this.data[r]&32767,u=this.data[r++]>>15,l=a*c+u*o;c=o*c+((l&32767)<<15)+t.data[i]+(n&1073741823),n=(c>>>30)+(l>>>15)+a*u+(n>>>30),t.data[i++]=c&1073741823}return n}function ij(r,e,t,i,n,s){for(var o=e&16383,a=e>>14;--s>=0;){var c=this.data[r]&16383,u=this.data[r++]>>14,l=a*c+u*o;c=o*c+((l&16383)<<14)+t.data[i]+n,n=(c>>28)+(l>>14)+a*u,t.data[i++]=c&268435455}return n}typeof navigator=="undefined"?(ye.prototype.am=ij,Xc=28):rj&&navigator.appName=="Microsoft Internet Explorer"?(ye.prototype.am=nve,Xc=30):rj&&navigator.appName!="Netscape"?(ye.prototype.am=ive,Xc=26):(ye.prototype.am=ij,Xc=28);ye.prototype.DB=Xc;ye.prototype.DM=(1<<Xc)-1;ye.prototype.DV=1<<Xc;var oE=52;ye.prototype.FV=Math.pow(2,oE);ye.prototype.F1=oE-Xc;ye.prototype.F2=2*Xc-oE;var sve="0123456789abcdefghijklmnopqrstuvwxyz",P4=new Array,xp,Gs;xp="0".charCodeAt(0);for(Gs=0;Gs<=9;++Gs)P4[xp++]=Gs;xp="a".charCodeAt(0);for(Gs=10;Gs<36;++Gs)P4[xp++]=Gs;xp="A".charCodeAt(0);for(Gs=10;Gs<36;++Gs)P4[xp++]=Gs;function nj(r){return sve.charAt(r)}function sj(r,e){var t=P4[r.charCodeAt(e)];return t??-1}function ove(r){for(var e=this.t-1;e>=0;--e)r.data[e]=this.data[e];r.t=this.t,r.s=this.s}function ave(r){this.t=1,this.s=r<0?-1:0,r>0?this.data[0]=r:r<-1?this.data[0]=r+this.DV:this.t=0}function fl(r){var e=zt();return e.fromInt(r),e}function cve(r,e){var t;if(e==16)t=4;else if(e==8)t=3;else if(e==256)t=8;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else{this.fromRadix(r,e);return}this.t=0,this.s=0;for(var i=r.length,n=!1,s=0;--i>=0;){var o=t==8?r[i]&255:sj(r,i);if(o<0){r.charAt(i)=="-"&&(n=!0);continue}n=!1,s==0?this.data[this.t++]=o:s+t>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=t,s>=this.DB&&(s-=this.DB)}t==8&&(r[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&ye.ZERO.subTo(this,this)}function uve(){for(var r=this.s&this.DM;this.t>0&&this.data[this.t-1]==r;)--this.t}function lve(r){if(this.s<0)return"-"+this.negate().toString(r);var e;if(r==16)e=4;else if(r==8)e=3;else if(r==2)e=1;else if(r==32)e=5;else if(r==4)e=2;else return this.toRadix(r);var t=(1<<e)-1,i,n=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(i=this.data[o]>>a)>0&&(n=!0,s=nj(i));o>=0;)a<e?(i=(this.data[o]&(1<<a)-1)<<e-a,i|=this.data[--o]>>(a+=this.DB-e)):(i=this.data[o]>>(a-=e)&t,a<=0&&(a+=this.DB,--o)),i>0&&(n=!0),n&&(s+=nj(i));return n?s:"0"}function fve(){var r=zt();return ye.ZERO.subTo(this,r),r}function dve(){return this.s<0?this.negate():this}function hve(r){var e=this.s-r.s;if(e!=0)return e;var t=this.t;if(e=t-r.t,e!=0)return this.s<0?-e:e;for(;--t>=0;)if((e=this.data[t]-r.data[t])!=0)return e;return 0}function C4(r){var e=1,t;return(t=r>>>16)!=0&&(r=t,e+=16),(t=r>>8)!=0&&(r=t,e+=8),(t=r>>4)!=0&&(r=t,e+=4),(t=r>>2)!=0&&(r=t,e+=2),(t=r>>1)!=0&&(r=t,e+=1),e}function pve(){return this.t<=0?0:this.DB*(this.t-1)+C4(this.data[this.t-1]^this.s&this.DM)}function yve(r,e){var t;for(t=this.t-1;t>=0;--t)e.data[t+r]=this.data[t];for(t=r-1;t>=0;--t)e.data[t]=0;e.t=this.t+r,e.s=this.s}function gve(r,e){for(var t=r;t<this.t;++t)e.data[t-r]=this.data[t];e.t=Math.max(this.t-r,0),e.s=this.s}function mve(r,e){var t=r%this.DB,i=this.DB-t,n=(1<<i)-1,s=Math.floor(r/this.DB),o=this.s<<t&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>i|o,o=(this.data[a]&n)<<t;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function bve(r,e){e.s=this.s;var t=Math.floor(r/this.DB);if(t>=this.t){e.t=0;return}var i=r%this.DB,n=this.DB-i,s=(1<<i)-1;e.data[0]=this.data[t]>>i;for(var o=t+1;o<this.t;++o)e.data[o-t-1]|=(this.data[o]&s)<<n,e.data[o-t]=this.data[o]>>i;i>0&&(e.data[this.t-t-1]|=(this.s&s)<<n),e.t=this.t-t,e.clamp()}function wve(r,e){for(var t=0,i=0,n=Math.min(r.t,this.t);t<n;)i+=this.data[t]-r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;if(r.t<this.t){for(i-=r.s;t<this.t;)i+=this.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<r.t;)i-=r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i-=r.s}e.s=i<0?-1:0,i<-1?e.data[t++]=this.DV+i:i>0&&(e.data[t++]=i),e.t=t,e.clamp()}function _ve(r,e){var t=this.abs(),i=r.abs(),n=t.t;for(e.t=n+i.t;--n>=0;)e.data[n]=0;for(n=0;n<i.t;++n)e.data[n+t.t]=t.am(0,i.data[n],e,n,0,t.t);e.s=0,e.clamp(),this.s!=r.s&&ye.ZERO.subTo(e,e)}function vve(r){for(var e=this.abs(),t=r.t=2*e.t;--t>=0;)r.data[t]=0;for(t=0;t<e.t-1;++t){var i=e.am(t,e.data[t],r,2*t,0,1);(r.data[t+e.t]+=e.am(t+1,2*e.data[t],r,2*t+1,i,e.t-t-1))>=e.DV&&(r.data[t+e.t]-=e.DV,r.data[t+e.t+1]=1)}r.t>0&&(r.data[r.t-1]+=e.am(t,e.data[t],r,2*t,0,1)),r.s=0,r.clamp()}function Eve(r,e,t){var i=r.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t){e!=null&&e.fromInt(0),t!=null&&this.copyTo(t);return}t==null&&(t=zt());var s=zt(),o=this.s,a=r.s,c=this.DB-C4(i.data[i.t-1]);c>0?(i.lShiftTo(c,s),n.lShiftTo(c,t)):(i.copyTo(s),n.copyTo(t));var u=s.t,l=s.data[u-1];if(l!=0){var d=l*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),h=this.FV/d,p=(1<<this.F1)/d,y=1<<this.F2,g=t.t,w=g-u,b=e??zt();for(s.dlShiftTo(w,b),t.compareTo(b)>=0&&(t.data[t.t++]=1,t.subTo(b,t)),ye.ONE.dlShiftTo(u,b),b.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--w>=0;){var v=t.data[--g]==l?this.DM:Math.floor(t.data[g]*h+(t.data[g-1]+y)*p);if((t.data[g]+=s.am(0,v,t,w,0,u))<v)for(s.dlShiftTo(w,b),t.subTo(b,t);t.data[g]<--v;)t.subTo(b,t)}e!=null&&(t.drShiftTo(u,e),o!=a&&ye.ZERO.subTo(e,e)),t.t=u,t.clamp(),c>0&&t.rShiftTo(c,t),o<0&&ye.ZERO.subTo(t,t)}}}function Sve(r){var e=zt();return this.abs().divRemTo(r,null,e),this.s<0&&e.compareTo(ye.ZERO)>0&&r.subTo(e,e),e}function Gf(r){this.m=r}function Rve(r){return r.s<0||r.compareTo(this.m)>=0?r.mod(this.m):r}function Ave(r){return r}function xve(r){r.divRemTo(this.m,null,r)}function Ive(r,e,t){r.multiplyTo(e,t),this.reduce(t)}function Tve(r,e){r.squareTo(e),this.reduce(e)}Gf.prototype.convert=Rve;Gf.prototype.revert=Ave;Gf.prototype.reduce=xve;Gf.prototype.mulTo=Ive;Gf.prototype.sqrTo=Tve;function Pve(){if(this.t<1)return 0;var r=this.data[0];if((r&1)==0)return 0;var e=r&3;return e=e*(2-(r&15)*e)&15,e=e*(2-(r&255)*e)&255,e=e*(2-((r&65535)*e&65535))&65535,e=e*(2-r*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Wf(r){this.m=r,this.mp=r.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<r.DB-15)-1,this.mt2=2*r.t}function Cve(r){var e=zt();return r.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),r.s<0&&e.compareTo(ye.ZERO)>0&&this.m.subTo(e,e),e}function Ove(r){var e=zt();return r.copyTo(e),this.reduce(e),e}function kve(r){for(;r.t<=this.mt2;)r.data[r.t++]=0;for(var e=0;e<this.m.t;++e){var t=r.data[e]&32767,i=t*this.mpl+((t*this.mph+(r.data[e]>>15)*this.mpl&this.um)<<15)&r.DM;for(t=e+this.m.t,r.data[t]+=this.m.am(0,i,r,e,0,this.m.t);r.data[t]>=r.DV;)r.data[t]-=r.DV,r.data[++t]++}r.clamp(),r.drShiftTo(this.m.t,r),r.compareTo(this.m)>=0&&r.subTo(this.m,r)}function Dve(r,e){r.squareTo(e),this.reduce(e)}function Nve(r,e,t){r.multiplyTo(e,t),this.reduce(t)}Wf.prototype.convert=Cve;Wf.prototype.revert=Ove;Wf.prototype.reduce=kve;Wf.prototype.mulTo=Nve;Wf.prototype.sqrTo=Dve;function Bve(){return(this.t>0?this.data[0]&1:this.s)==0}function Lve(r,e){if(r>4294967295||r<1)return ye.ONE;var t=zt(),i=zt(),n=e.convert(this),s=C4(r)-1;for(n.copyTo(t);--s>=0;)if(e.sqrTo(t,i),(r&1<<s)>0)e.mulTo(i,n,t);else{var o=t;t=i,i=o}return e.revert(t)}function Mve(r,e){var t;return r<256||e.isEven()?t=new Gf(e):t=new Wf(e),this.exp(r,t)}ye.prototype.copyTo=ove;ye.prototype.fromInt=ave;ye.prototype.fromString=cve;ye.prototype.clamp=uve;ye.prototype.dlShiftTo=yve;ye.prototype.drShiftTo=gve;ye.prototype.lShiftTo=mve;ye.prototype.rShiftTo=bve;ye.prototype.subTo=wve;ye.prototype.multiplyTo=_ve;ye.prototype.squareTo=vve;ye.prototype.divRemTo=Eve;ye.prototype.invDigit=Pve;ye.prototype.isEven=Bve;ye.prototype.exp=Lve;ye.prototype.toString=lve;ye.prototype.negate=fve;ye.prototype.abs=dve;ye.prototype.compareTo=hve;ye.prototype.bitLength=pve;ye.prototype.mod=Sve;ye.prototype.modPowInt=Mve;ye.ZERO=fl(0);ye.ONE=fl(1);function jve(){var r=zt();return this.copyTo(r),r}function qve(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Uve(){return this.t==0?this.s:this.data[0]<<24>>24}function Fve(){return this.t==0?this.s:this.data[0]<<16>>16}function Kve(r){return Math.floor(Math.LN2*this.DB/Math.log(r))}function Vve(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function zve(r){if(r==null&&(r=10),this.signum()==0||r<2||r>36)return"0";var e=this.chunkSize(r),t=Math.pow(r,e),i=fl(t),n=zt(),s=zt(),o="";for(this.divRemTo(i,n,s);n.signum()>0;)o=(t+s.intValue()).toString(r).substr(1)+o,n.divRemTo(i,n,s);return s.intValue().toString(r)+o}function Hve(r,e){this.fromInt(0),e==null&&(e=10);for(var t=this.chunkSize(e),i=Math.pow(e,t),n=!1,s=0,o=0,a=0;a<r.length;++a){var c=sj(r,a);if(c<0){r.charAt(a)=="-"&&this.signum()==0&&(n=!0);continue}o=e*o+c,++s>=t&&(this.dMultiply(i),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),n&&ye.ZERO.subTo(this,this)}function $ve(r,e,t){if(typeof e=="number")if(r<2)this.fromInt(1);else for(this.fromNumber(r,t),this.testBit(r-1)||this.bitwiseTo(ye.ONE.shiftLeft(r-1),aE,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>r&&this.subTo(ye.ONE.shiftLeft(r-1),this);else{var i=new Array,n=r&7;i.length=(r>>3)+1,e.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}}function Gve(){var r=this.t,e=new Array;e[0]=this.s;var t=this.DB-r*this.DB%8,i,n=0;if(r-- >0)for(t<this.DB&&(i=this.data[r]>>t)!=(this.s&this.DM)>>t&&(e[n++]=i|this.s<<this.DB-t);r>=0;)t<8?(i=(this.data[r]&(1<<t)-1)<<8-t,i|=this.data[--r]>>(t+=this.DB-8)):(i=this.data[r]>>(t-=8)&255,t<=0&&(t+=this.DB,--r)),(i&128)!=0&&(i|=-256),n==0&&(this.s&128)!=(i&128)&&++n,(n>0||i!=this.s)&&(e[n++]=i);return e}function Wve(r){return this.compareTo(r)==0}function Yve(r){return this.compareTo(r)<0?this:r}function Xve(r){return this.compareTo(r)>0?this:r}function Qve(r,e,t){var i,n,s=Math.min(r.t,this.t);for(i=0;i<s;++i)t.data[i]=e(this.data[i],r.data[i]);if(r.t<this.t){for(n=r.s&this.DM,i=s;i<this.t;++i)t.data[i]=e(this.data[i],n);t.t=this.t}else{for(n=this.s&this.DM,i=s;i<r.t;++i)t.data[i]=e(n,r.data[i]);t.t=r.t}t.s=e(this.s,r.s),t.clamp()}function Zve(r,e){return r&e}function Jve(r){var e=zt();return this.bitwiseTo(r,Zve,e),e}function aE(r,e){return r|e}function e7e(r){var e=zt();return this.bitwiseTo(r,aE,e),e}function oj(r,e){return r^e}function t7e(r){var e=zt();return this.bitwiseTo(r,oj,e),e}function aj(r,e){return r&~e}function r7e(r){var e=zt();return this.bitwiseTo(r,aj,e),e}function i7e(){for(var r=zt(),e=0;e<this.t;++e)r.data[e]=this.DM&~this.data[e];return r.t=this.t,r.s=~this.s,r}function n7e(r){var e=zt();return r<0?this.rShiftTo(-r,e):this.lShiftTo(r,e),e}function s7e(r){var e=zt();return r<0?this.lShiftTo(-r,e):this.rShiftTo(r,e),e}function o7e(r){if(r==0)return-1;var e=0;return(r&65535)==0&&(r>>=16,e+=16),(r&255)==0&&(r>>=8,e+=8),(r&15)==0&&(r>>=4,e+=4),(r&3)==0&&(r>>=2,e+=2),(r&1)==0&&++e,e}function a7e(){for(var r=0;r<this.t;++r)if(this.data[r]!=0)return r*this.DB+o7e(this.data[r]);return this.s<0?this.t*this.DB:-1}function c7e(r){for(var e=0;r!=0;)r&=r-1,++e;return e}function u7e(){for(var r=0,e=this.s&this.DM,t=0;t<this.t;++t)r+=c7e(this.data[t]^e);return r}function l7e(r){var e=Math.floor(r/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<r%this.DB)!=0}function f7e(r,e){var t=ye.ONE.shiftLeft(r);return this.bitwiseTo(t,e,t),t}function d7e(r){return this.changeBit(r,aE)}function h7e(r){return this.changeBit(r,aj)}function p7e(r){return this.changeBit(r,oj)}function y7e(r,e){for(var t=0,i=0,n=Math.min(r.t,this.t);t<n;)i+=this.data[t]+r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;if(r.t<this.t){for(i+=r.s;t<this.t;)i+=this.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<r.t;)i+=r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=r.s}e.s=i<0?-1:0,i>0?e.data[t++]=i:i<-1&&(e.data[t++]=this.DV+i),e.t=t,e.clamp()}function g7e(r){var e=zt();return this.addTo(r,e),e}function m7e(r){var e=zt();return this.subTo(r,e),e}function b7e(r){var e=zt();return this.multiplyTo(r,e),e}function w7e(r){var e=zt();return this.divRemTo(r,e,null),e}function _7e(r){var e=zt();return this.divRemTo(r,null,e),e}function v7e(r){var e=zt(),t=zt();return this.divRemTo(r,e,t),new Array(e,t)}function E7e(r){this.data[this.t]=this.am(0,r-1,this,0,0,this.t),++this.t,this.clamp()}function S7e(r,e){if(r!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=r;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function $y(){}function cj(r){return r}function R7e(r,e,t){r.multiplyTo(e,t)}function A7e(r,e){r.squareTo(e)}$y.prototype.convert=cj;$y.prototype.revert=cj;$y.prototype.mulTo=R7e;$y.prototype.sqrTo=A7e;function x7e(r){return this.exp(r,new $y)}function I7e(r,e,t){var i=Math.min(this.t+r.t,e);for(t.s=0,t.t=i;i>0;)t.data[--i]=0;var n;for(n=t.t-this.t;i<n;++i)t.data[i+this.t]=this.am(0,r.data[i],t,i,0,this.t);for(n=Math.min(r.t,e);i<n;++i)this.am(0,r.data[i],t,i,0,e-i);t.clamp()}function T7e(r,e,t){--e;var i=t.t=this.t+r.t-e;for(t.s=0;--i>=0;)t.data[i]=0;for(i=Math.max(e-this.t,0);i<r.t;++i)t.data[this.t+i-e]=this.am(e-i,r.data[i],t,0,0,this.t+i-e);t.clamp(),t.drShiftTo(1,t)}function Ip(r){this.r2=zt(),this.q3=zt(),ye.ONE.dlShiftTo(2*r.t,this.r2),this.mu=this.r2.divide(r),this.m=r}function P7e(r){if(r.s<0||r.t>2*this.m.t)return r.mod(this.m);if(r.compareTo(this.m)<0)return r;var e=zt();return r.copyTo(e),this.reduce(e),e}function C7e(r){return r}function O7e(r){for(r.drShiftTo(this.m.t-1,this.r2),r.t>this.m.t+1&&(r.t=this.m.t+1,r.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);r.compareTo(this.r2)<0;)r.dAddOffset(1,this.m.t+1);for(r.subTo(this.r2,r);r.compareTo(this.m)>=0;)r.subTo(this.m,r)}function k7e(r,e){r.squareTo(e),this.reduce(e)}function D7e(r,e,t){r.multiplyTo(e,t),this.reduce(t)}Ip.prototype.convert=P7e;Ip.prototype.revert=C7e;Ip.prototype.reduce=O7e;Ip.prototype.mulTo=D7e;Ip.prototype.sqrTo=k7e;function N7e(r,e){var t=r.bitLength(),i,n=fl(1),s;if(t<=0)return n;t<18?i=1:t<48?i=3:t<144?i=4:t<768?i=5:i=6,t<8?s=new Gf(e):e.isEven()?s=new Ip(e):s=new Wf(e);var o=new Array,a=3,c=i-1,u=(1<<i)-1;if(o[1]=s.convert(this),i>1){var l=zt();for(s.sqrTo(o[1],l);a<=u;)o[a]=zt(),s.mulTo(l,o[a-2],o[a]),a+=2}var d=r.t-1,h,p=!0,y=zt(),g;for(t=C4(r.data[d])-1;d>=0;){for(t>=c?h=r.data[d]>>t-c&u:(h=(r.data[d]&(1<<t+1)-1)<<c-t,d>0&&(h|=r.data[d-1]>>this.DB+t-c)),a=i;(h&1)==0;)h>>=1,--a;if((t-=a)<0&&(t+=this.DB,--d),p)o[h].copyTo(n),p=!1;else{for(;a>1;)s.sqrTo(n,y),s.sqrTo(y,n),a-=2;a>0?s.sqrTo(n,y):(g=n,n=y,y=g),s.mulTo(y,o[h],n)}for(;d>=0&&(r.data[d]&1<<t)==0;)s.sqrTo(n,y),g=n,n=y,y=g,--t<0&&(t=this.DB-1,--d)}return s.revert(n)}function B7e(r){var e=this.s<0?this.negate():this.clone(),t=r.s<0?r.negate():r.clone();if(e.compareTo(t)<0){var i=e;e=t,t=i}var n=e.getLowestSetBit(),s=t.getLowestSetBit();if(s<0)return e;for(n<s&&(s=n),s>0&&(e.rShiftTo(s,e),t.rShiftTo(s,t));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=t.getLowestSetBit())>0&&t.rShiftTo(n,t),e.compareTo(t)>=0?(e.subTo(t,e),e.rShiftTo(1,e)):(t.subTo(e,t),t.rShiftTo(1,t));return s>0&&t.lShiftTo(s,t),t}function L7e(r){if(r<=0)return 0;var e=this.DV%r,t=this.s<0?r-1:0;if(this.t>0)if(e==0)t=this.data[0]%r;else for(var i=this.t-1;i>=0;--i)t=(e*t+this.data[i])%r;return t}function M7e(r){var e=r.isEven();if(this.isEven()&&e||r.signum()==0)return ye.ZERO;for(var t=r.clone(),i=this.clone(),n=fl(1),s=fl(0),o=fl(0),a=fl(1);t.signum()!=0;){for(;t.isEven();)t.rShiftTo(1,t),e?((!n.isEven()||!s.isEven())&&(n.addTo(this,n),s.subTo(r,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(r,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(r,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(r,a),a.rShiftTo(1,a);t.compareTo(i)>=0?(t.subTo(i,t),e&&n.subTo(o,n),s.subTo(a,s)):(i.subTo(t,i),e&&o.subTo(n,o),a.subTo(s,a))}if(i.compareTo(ye.ONE)!=0)return ye.ZERO;if(a.compareTo(r)>=0)return a.subtract(r);if(a.signum()<0)a.addTo(r,a);else return a;return a.signum()<0?a.add(r):a}var Wo=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],j7e=(1<<26)/Wo[Wo.length-1];function q7e(r){var e,t=this.abs();if(t.t==1&&t.data[0]<=Wo[Wo.length-1]){for(e=0;e<Wo.length;++e)if(t.data[0]==Wo[e])return!0;return!1}if(t.isEven())return!1;for(e=1;e<Wo.length;){for(var i=Wo[e],n=e+1;n<Wo.length&&i<j7e;)i*=Wo[n++];for(i=t.modInt(i);e<n;)if(i%Wo[e++]==0)return!1}return t.millerRabin(r)}function U7e(r){var e=this.subtract(ye.ONE),t=e.getLowestSetBit();if(t<=0)return!1;for(var i=e.shiftRight(t),n=F7e(),s,o=0;o<r;++o){do s=new ye(this.bitLength(),n);while(s.compareTo(ye.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(i,this);if(a.compareTo(ye.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<t&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(ye.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function F7e(){return{nextBytes:function(r){for(var e=0;e<r.length;++e)r[e]=Math.floor(Math.random()*256)}}}ye.prototype.chunkSize=Kve;ye.prototype.toRadix=zve;ye.prototype.fromRadix=Hve;ye.prototype.fromNumber=$ve;ye.prototype.bitwiseTo=Qve;ye.prototype.changeBit=f7e;ye.prototype.addTo=y7e;ye.prototype.dMultiply=E7e;ye.prototype.dAddOffset=S7e;ye.prototype.multiplyLowerTo=I7e;ye.prototype.multiplyUpperTo=T7e;ye.prototype.modInt=L7e;ye.prototype.millerRabin=U7e;ye.prototype.clone=jve;ye.prototype.intValue=qve;ye.prototype.byteValue=Uve;ye.prototype.shortValue=Fve;ye.prototype.signum=Vve;ye.prototype.toByteArray=Gve;ye.prototype.equals=Wve;ye.prototype.min=Yve;ye.prototype.max=Xve;ye.prototype.and=Jve;ye.prototype.or=e7e;ye.prototype.xor=t7e;ye.prototype.andNot=r7e;ye.prototype.not=i7e;ye.prototype.shiftLeft=n7e;ye.prototype.shiftRight=s7e;ye.prototype.getLowestSetBit=a7e;ye.prototype.bitCount=u7e;ye.prototype.testBit=l7e;ye.prototype.setBit=d7e;ye.prototype.clearBit=h7e;ye.prototype.flipBit=p7e;ye.prototype.add=g7e;ye.prototype.subtract=m7e;ye.prototype.multiply=b7e;ye.prototype.divide=w7e;ye.prototype.remainder=_7e;ye.prototype.divideAndRemainder=v7e;ye.prototype.modPow=N7e;ye.prototype.modInverse=M7e;ye.prototype.pow=x7e;ye.prototype.gcd=B7e;ye.prototype.isProbablePrime=q7e});var pj=m((Rnt,hj)=>{f();var Ma=Rt();ll();vr();var lj=hj.exports=Ma.sha1=Ma.sha1||{};Ma.md.sha1=Ma.md.algorithms.sha1=lj;lj.create=function(){fj||K7e();var r=null,e=Ma.util.createBuffer(),t=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=Ma.util.createBuffer(),r={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=Ma.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),dj(r,t,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=Ma.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(cE.substr(0,i.blockLength-o));for(var a,c,u=i.fullMessageLength[0]*8,l=0;l<i.fullMessageLength.length-1;++l)a=i.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=a>>>0;n.putInt32(u);var d={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3,h4:r.h4};dj(d,t,n);var h=Ma.util.createBuffer();return h.putInt32(d.h0),h.putInt32(d.h1),h.putInt32(d.h2),h.putInt32(d.h3),h.putInt32(d.h4),h},i};var cE=null,fj=!1;function K7e(){cE=String.fromCharCode(128),cE+=Ma.util.fillString(String.fromCharCode(0),64),fj=!0}function dj(r,e,t){for(var i,n,s,o,a,c,u,l,d=t.length();d>=64;){for(n=r.h0,s=r.h1,o=r.h2,a=r.h3,c=r.h4,l=0;l<16;++l)i=t.getInt32(),e[l]=i,u=a^s&(o^a),i=(n<<5|n>>>27)+u+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<20;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,u=a^s&(o^a),i=(n<<5|n>>>27)+u+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<32;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<40;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<60;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s&o|a&(s^o),i=(n<<5|n>>>27)+u+c+2400959708+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<80;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+3395469782+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;r.h0=r.h0+n|0,r.h1=r.h1+s|0,r.h2=r.h2+o|0,r.h3=r.h3+a|0,r.h4=r.h4+c|0,d-=64}}});var mj=m((Ant,gj)=>{f();var ja=Rt();vr();$f();pj();var yj=gj.exports=ja.pkcs1=ja.pkcs1||{};yj.encode_rsa_oaep=function(r,e,t){var i,n,s,o;typeof t=="string"?(i=t,n=arguments[3]||void 0,s=arguments[4]||void 0):t&&(i=t.label||void 0,n=t.seed||void 0,s=t.md||void 0,t.mgf1&&t.mgf1.md&&(o=t.mgf1.md)),s?s.start():s=ja.md.sha1.create(),o||(o=s);var a=Math.ceil(r.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=c,u}i||(i=""),s.update(i,"raw");for(var l=s.digest(),d="",h=c-e.length,p=0;p<h;p++)d+="\0";var y=l.getBytes()+d+""+e;if(!n)n=ja.random.getBytes(s.digestLength);else if(n.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=n.length,u.digestLength=s.digestLength,u}var g=k4(n,a-s.digestLength-1,o),w=ja.util.xorBytes(y,g,y.length),b=k4(w,s.digestLength,o),v=ja.util.xorBytes(n,b,n.length);return"\0"+v+w};yj.decode_rsa_oaep=function(r,e,t){var i,n,s;typeof t=="string"?(i=t,n=arguments[3]||void 0):t&&(i=t.label||void 0,n=t.md||void 0,t.mgf1&&t.mgf1.md&&(s=t.mgf1.md));var o=Math.ceil(r.n.bitLength()/8);if(e.length!==o){var w=new Error("RSAES-OAEP encoded message length is invalid.");throw w.length=e.length,w.expectedLength=o,w}if(n===void 0?n=ja.md.sha1.create():n.start(),s||(s=n),o<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),n.update(i,"raw");for(var a=n.digest().getBytes(),c=e.charAt(0),u=e.substring(1,n.digestLength+1),l=e.substring(1+n.digestLength),d=k4(l,n.digestLength,s),h=ja.util.xorBytes(u,d,u.length),p=k4(h,o-n.digestLength-1,s),y=ja.util.xorBytes(l,p,l.length),g=y.substring(0,n.digestLength),w=c!=="\0",b=0;b<n.digestLength;++b)w|=a.charAt(b)!==g.charAt(b);for(var v=1,A=n.digestLength,k=n.digestLength;k<y.length;k++){var C=y.charCodeAt(k),T=C&1^1,D=v?65534:0;w|=C&D,v=v&T,A+=v}if(w||y.charCodeAt(A)!==1)throw new Error("Invalid RSAES-OAEP padding.");return y.substring(A+1)};function k4(r,e,t){t||(t=ja.md.sha1.create());for(var i="",n=Math.ceil(e/t.digestLength),s=0;s<n;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);t.start(),t.update(r+o),i+=t.digest().getBytes()}return i.substring(0,e)}});var bj=m((xnt,uE)=>{f();var dl=Rt();vr();O4();$f();(function(){if(dl.prime){uE.exports=dl.prime;return}var r=uE.exports=dl.prime=dl.prime||{},e=dl.jsbn.BigInteger,t=[6,4,2,4,2,4,6,2],i=new e(null);i.fromInt(30);var n=function(d,h){return d|h};r.generateProbablePrime=function(d,h,p){typeof h=="function"&&(p=h,h={}),h=h||{};var y=h.algorithm||"PRIMEINC";typeof y=="string"&&(y={name:y}),y.options=y.options||{};var g=h.prng||dl.random,w={nextBytes:function(b){for(var v=g.getBytesSync(b.length),A=0;A<b.length;++A)b[A]=v.charCodeAt(A)}};if(y.name==="PRIMEINC")return s(d,w,y.options,p);throw new Error("Invalid prime generation algorithm: "+y.name)};function s(d,h,p,y){return"workers"in p?c(d,h,p,y):o(d,h,p,y)}function o(d,h,p,y){var g=u(d,h),w=0,b=l(g.bitLength());"millerRabinTests"in p&&(b=p.millerRabinTests);var v=10;"maxBlockTime"in p&&(v=p.maxBlockTime),a(g,d,h,w,b,v,y)}function a(d,h,p,y,g,w,b){var v=+new Date;do{if(d.bitLength()>h&&(d=u(h,p)),d.isProbablePrime(g))return b(null,d);d.dAddOffset(t[y++%8],0)}while(w<0||+new Date-v<w);dl.util.setImmediate(function(){a(d,h,p,y,g,w,b)})}function c(d,h,p,y){if(typeof Worker=="undefined")return o(d,h,p,y);var g=u(d,h),w=p.workers,b=p.workLoad||100,v=b*30/8,A=p.workerScript||"forge/prime.worker.js";if(w===-1)return dl.util.estimateCores(function(C,T){C&&(T=2),w=T-1,k()});k();function k(){w=Math.max(1,w);for(var C=[],T=0;T<w;++T)C[T]=new Worker(A);for(var D=w,T=0;T<w;++T)C[T].addEventListener("message",M);var j=!1;function M(se){if(!j){--D;var ie=se.data;if(ie.found){for(var fe=0;fe<C.length;++fe)C[fe].terminate();return j=!0,y(null,new e(ie.prime,16))}g.bitLength()>d&&(g=u(d,h));var pe=g.toString(16);se.target.postMessage({hex:pe,workLoad:b}),g.dAddOffset(v,0)}}}}function u(d,h){var p=new e(d,h),y=d-1;return p.testBit(y)||p.bitwiseTo(e.ONE.shiftLeft(y),n,p),p.dAddOffset(31-p.mod(i).byteValue(),0),p}function l(d){return d<=100?27:d<=150?18:d<=200?15:d<=250?12:d<=300?9:d<=350?8:d<=400?7:d<=500?6:d<=600?5:d<=800?4:d<=1250?3:2}})()});var Gy=m((Int,Aj)=>{f();var Ze=Rt();ul();O4();Ep();mj();bj();$f();vr();typeof jt=="undefined"&&(jt=Ze.jsbn.BigInteger);var jt,lE=Ze.util.isNodejs?Hf():null,te=Ze.asn1,Ws=Ze.util;Ze.pki=Ze.pki||{};Aj.exports=Ze.pki.rsa=Ze.rsa=Ze.rsa||{};var pt=Ze.pki,V7e=[6,4,2,4,2,4,6,2],z7e={name:"PrivateKeyInfo",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:te.Class.UNIVERSAL,type:te.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:te.Class.UNIVERSAL,type:te.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},H7e={name:"RSAPrivateKey",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},$7e={name:"RSAPublicKey",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:te.Class.UNIVERSAL,type:te.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},G7e=Ze.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:te.Class.UNIVERSAL,type:te.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:te.Class.UNIVERSAL,type:te.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},W7e={name:"DigestInfo",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:te.Class.UNIVERSAL,type:te.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:te.Class.UNIVERSAL,type:te.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:te.Class.UNIVERSAL,type:te.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:te.Class.UNIVERSAL,type:te.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Y7e=function(r){var e;if(r.algorithm in pt.oids)e=pt.oids[r.algorithm];else{var t=new Error("Unknown message digest algorithm.");throw t.algorithm=r.algorithm,t}var i=te.oidToDer(e).getBytes(),n=te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[]),s=te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[]);s.value.push(te.create(te.Class.UNIVERSAL,te.Type.OID,!1,i)),s.value.push(te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,""));var o=te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,r.digest().getBytes());return n.value.push(s),n.value.push(o),te.toDer(n).getBytes()},wj=function(r,e,t){if(t)return r.modPow(e.e,e.n);if(!e.p||!e.q)return r.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(jt.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(jt.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var i;do i=new jt(Ze.util.bytesToHex(Ze.random.getBytes(e.n.bitLength()/8)),16);while(i.compareTo(e.n)>=0||!i.gcd(e.n).equals(jt.ONE));r=r.multiply(i.modPow(e.e,e.n)).mod(e.n);for(var n=r.mod(e.p).modPow(e.dP,e.p),s=r.mod(e.q).modPow(e.dQ,e.q);n.compareTo(s)<0;)n=n.add(e.p);var o=n.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(i.modInverse(e.n)).mod(e.n),o};pt.rsa.encrypt=function(r,e,t){var i=t,n,s=Math.ceil(e.n.bitLength()/8);t!==!1&&t!==!0?(i=t===2,n=_j(r,e,t)):(n=Ze.util.createBuffer(),n.putBytes(r));for(var o=new jt(n.toHex(),16),a=wj(o,e,i),c=a.toString(16),u=Ze.util.createBuffer(),l=s-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(Ze.util.hexToBytes(c)),u.getBytes()};pt.rsa.decrypt=function(r,e,t,i){var n=Math.ceil(e.n.bitLength()/8);if(r.length!==n){var s=new Error("Encrypted message length is invalid.");throw s.length=r.length,s.expected=n,s}var o=new jt(Ze.util.createBuffer(r).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=wj(o,e,t),c=a.toString(16),u=Ze.util.createBuffer(),l=n-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(Ze.util.hexToBytes(c)),i!==!1?D4(u.getBytes(),e,t):u.getBytes()};pt.rsa.createKeyPairGenerationState=function(r,e,t){typeof r=="string"&&(r=parseInt(r,10)),r=r||2048,t=t||{};var i=t.prng||Ze.random,n={nextBytes:function(a){for(var c=i.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=c.charCodeAt(u)}},s=t.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:r,rng:n,eInt:e||65537,e:new jt(null),p:null,q:null,qBits:r>>1,pBits:r-(r>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};pt.rsa.stepKeyPairGenerationState=function(r,e){"algorithm"in r||(r.algorithm="PRIMEINC");var t=new jt(null);t.fromInt(30);for(var i=0,n=function(d,h){return d|h},s=+new Date,o,a=0;r.keys===null&&(e<=0||a<e);){if(r.state===0){var c=r.p===null?r.pBits:r.qBits,u=c-1;r.pqState===0?(r.num=new jt(c,r.rng),r.num.testBit(u)||r.num.bitwiseTo(jt.ONE.shiftLeft(u),n,r.num),r.num.dAddOffset(31-r.num.mod(t).byteValue(),0),i=0,++r.pqState):r.pqState===1?r.num.bitLength()>c?r.pqState=0:r.num.isProbablePrime(Q7e(r.num.bitLength()))?++r.pqState:r.num.dAddOffset(V7e[i++%8],0):r.pqState===2?r.pqState=r.num.subtract(jt.ONE).gcd(r.e).compareTo(jt.ONE)===0?3:0:r.pqState===3&&(r.pqState=0,r.p===null?r.p=r.num:r.q=r.num,r.p!==null&&r.q!==null&&++r.state,r.num=null)}else if(r.state===1)r.p.compareTo(r.q)<0&&(r.num=r.p,r.p=r.q,r.q=r.num),++r.state;else if(r.state===2)r.p1=r.p.subtract(jt.ONE),r.q1=r.q.subtract(jt.ONE),r.phi=r.p1.multiply(r.q1),++r.state;else if(r.state===3)r.phi.gcd(r.e).compareTo(jt.ONE)===0?++r.state:(r.p=null,r.q=null,r.state=0);else if(r.state===4)r.n=r.p.multiply(r.q),r.n.bitLength()===r.bits?++r.state:(r.q=null,r.state=0);else if(r.state===5){var l=r.e.modInverse(r.phi);r.keys={privateKey:pt.rsa.setPrivateKey(r.n,r.e,l,r.p,r.q,l.mod(r.p1),l.mod(r.q1),r.q.modInverse(r.p)),publicKey:pt.rsa.setPublicKey(r.n,r.e)}}o=+new Date,a+=o-s,s=o}return r.keys!==null};pt.rsa.generateKeyPair=function(r,e,t,i){if(arguments.length===1?typeof r=="object"?(t=r,r=void 0):typeof r=="function"&&(i=r,r=void 0):arguments.length===2?typeof r=="number"?typeof e=="function"?(i=e,e=void 0):typeof e!="number"&&(t=e,e=void 0):(t=r,i=e,r=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof t=="function"&&(i=t,t=void 0):(i=t,t=e,e=void 0)),t=t||{},r===void 0&&(r=t.bits||2048),e===void 0&&(e=t.e||65537),!Ze.options.usePureJavaScript&&!t.prng&&r>=256&&r<=16384&&(e===65537||e===3)){if(i){if(vj("generateKeyPair"))return lE.generateKeyPair("rsa",{modulusLength:r,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,u){if(a)return i(a);i(null,{privateKey:pt.privateKeyFromPem(u),publicKey:pt.publicKeyFromPem(c)})});if(Ej("generateKey")&&Ej("exportKey"))return Ws.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:Rj(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Ws.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){i(a)}).then(function(a){if(a){var c=pt.privateKeyFromAsn1(te.fromDer(Ze.util.createBuffer(a)));i(null,{privateKey:c,publicKey:pt.setRsaPublicKey(c.n,c.e)})}});if(Sj("generateKey")&&Sj("exportKey")){var n=Ws.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:Rj(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);n.oncomplete=function(a){var c=a.target.result,u=Ws.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(l){var d=l.target.result,h=pt.privateKeyFromAsn1(te.fromDer(Ze.util.createBuffer(d)));i(null,{privateKey:h,publicKey:pt.setRsaPublicKey(h.n,h.e)})},u.onerror=function(l){i(l)}},n.onerror=function(a){i(a)};return}}else if(vj("generateKeyPairSync")){var s=lE.generateKeyPairSync("rsa",{modulusLength:r,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:pt.privateKeyFromPem(s.privateKey),publicKey:pt.publicKeyFromPem(s.publicKey)}}}var o=pt.rsa.createKeyPairGenerationState(r,e,t);if(!i)return pt.rsa.stepKeyPairGenerationState(o,0),o.keys;X7e(o,t,i)};pt.setRsaPublicKey=pt.rsa.setPublicKey=function(r,e){var t={n:r,e};return t.encrypt=function(i,n,s){if(typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSAES-PKCS1-V1_5"),n==="RSAES-PKCS1-V1_5")n={encode:function(a,c,u){return _j(a,c,2).getBytes()}};else if(n==="RSA-OAEP"||n==="RSAES-OAEP")n={encode:function(a,c){return Ze.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(n)!==-1)n={encode:function(a){return a}};else if(typeof n=="string")throw new Error('Unsupported encryption scheme: "'+n+'".');var o=n.encode(i,t,!0);return pt.rsa.encrypt(o,t,!0)},t.verify=function(i,n,s,o){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,u){u=D4(u,t,!0);var l=te.fromDer(u,{parseAllBytes:o._parseAllDigestBytes}),d={},h=[];if(!te.validate(l,W7e,d,h)){var p=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw p.errors=h,p}var y=te.derToOid(d.algorithmIdentifier);if(!(y===Ze.oids.md2||y===Ze.oids.md5||y===Ze.oids.sha1||y===Ze.oids.sha224||y===Ze.oids.sha256||y===Ze.oids.sha384||y===Ze.oids.sha512||y===Ze.oids["sha512-224"]||y===Ze.oids["sha512-256"])){var p=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw p.oid=y,p}if((y===Ze.oids.md2||y===Ze.oids.md5)&&!("parameters"in d))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===d.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,u){return u=D4(u,t,!0),c===u}});var a=pt.rsa.decrypt(n,t,!0,!1);return s.verify(i,a,t.n.bitLength())},t};pt.setRsaPrivateKey=pt.rsa.setPrivateKey=function(r,e,t,i,n,s,o,a){var c={n:r,e,d:t,p:i,q:n,dP:s,dQ:o,qInv:a};return c.decrypt=function(u,l,d){typeof l=="string"?l=l.toUpperCase():l===void 0&&(l="RSAES-PKCS1-V1_5");var h=pt.rsa.decrypt(u,c,!1,!1);if(l==="RSAES-PKCS1-V1_5")l={decode:D4};else if(l==="RSA-OAEP"||l==="RSAES-OAEP")l={decode:function(p,y){return Ze.pkcs1.decode_rsa_oaep(y,p,d)}};else if(["RAW","NONE","NULL",null].indexOf(l)!==-1)l={decode:function(p){return p}};else throw new Error('Unsupported encryption scheme: "'+l+'".');return l.decode(h,c,!1)},c.sign=function(u,l){var d=!1;typeof l=="string"&&(l=l.toUpperCase()),l===void 0||l==="RSASSA-PKCS1-V1_5"?(l={encode:Y7e},d=1):(l==="NONE"||l==="NULL"||l===null)&&(l={encode:function(){return u}},d=1);var h=l.encode(u,c.n.bitLength());return pt.rsa.encrypt(h,c,d)},c};pt.wrapRsaPrivateKey=function(r){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(0).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(pt.oids.rsaEncryption).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")]),te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,te.toDer(r).getBytes())])};pt.privateKeyFromAsn1=function(r){var e={},t=[];if(te.validate(r,z7e,e,t)&&(r=te.fromDer(Ze.util.createBuffer(e.privateKey))),e={},t=[],!te.validate(r,H7e,e,t)){var i=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw i.errors=t,i}var n,s,o,a,c,u,l,d;return n=Ze.util.createBuffer(e.privateKeyModulus).toHex(),s=Ze.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=Ze.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=Ze.util.createBuffer(e.privateKeyPrime1).toHex(),c=Ze.util.createBuffer(e.privateKeyPrime2).toHex(),u=Ze.util.createBuffer(e.privateKeyExponent1).toHex(),l=Ze.util.createBuffer(e.privateKeyExponent2).toHex(),d=Ze.util.createBuffer(e.privateKeyCoefficient).toHex(),pt.setRsaPrivateKey(new jt(n,16),new jt(s,16),new jt(o,16),new jt(a,16),new jt(c,16),new jt(u,16),new jt(l,16),new jt(d,16))};pt.privateKeyToAsn1=pt.privateKeyToRSAPrivateKey=function(r){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(0).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,qa(r.n)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,qa(r.e)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,qa(r.d)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,qa(r.p)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,qa(r.q)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,qa(r.dP)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,qa(r.dQ)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,qa(r.qInv))])};pt.publicKeyFromAsn1=function(r){var e={},t=[];if(te.validate(r,G7e,e,t)){var i=te.derToOid(e.publicKeyOid);if(i!==pt.oids.rsaEncryption){var n=new Error("Cannot read public key. Unknown OID.");throw n.oid=i,n}r=e.rsaPublicKey}if(t=[],!te.validate(r,$7e,e,t)){var n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw n.errors=t,n}var s=Ze.util.createBuffer(e.publicKeyModulus).toHex(),o=Ze.util.createBuffer(e.publicKeyExponent).toHex();return pt.setRsaPublicKey(new jt(s,16),new jt(o,16))};pt.publicKeyToAsn1=pt.publicKeyToSubjectPublicKeyInfo=function(r){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(pt.oids.rsaEncryption).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")]),te.create(te.Class.UNIVERSAL,te.Type.BITSTRING,!1,[pt.publicKeyToRSAPublicKey(r)])])};pt.publicKeyToRSAPublicKey=function(r){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,qa(r.n)),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,qa(r.e))])};function _j(r,e,t){var i=Ze.util.createBuffer(),n=Math.ceil(e.n.bitLength()/8);if(r.length>n-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=r.length,s.max=n-11,s}i.putByte(0),i.putByte(t);var o=n-3-r.length,a;if(t===0||t===1){a=t===0?0:255;for(var c=0;c<o;++c)i.putByte(a)}else for(;o>0;){for(var u=0,l=Ze.random.getBytes(o),c=0;c<o;++c)a=l.charCodeAt(c),a===0?++u:i.putByte(a);o=u}return i.putByte(0),i.putBytes(r),i}function D4(r,e,t,i){var n=Math.ceil(e.n.bitLength()/8),s=Ze.util.createBuffer(r),o=s.getByte(),a=s.getByte();if(o!==0||t&&a!==0&&a!==1||!t&&a!=2||t&&a===0&&typeof i=="undefined")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=n-3-i;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var l=s.getByte();if(l!==0||c!==n-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function X7e(r,e,t){typeof e=="function"&&(t=e,e={}),e=e||{};var i={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(i.prng=e.prng),n();function n(){s(r.pBits,function(a,c){if(a)return t(a);if(r.p=c,r.q!==null)return o(a,r.q);s(r.qBits,o)})}function s(a,c){Ze.prime.generateProbablePrime(a,i,c)}function o(a,c){if(a)return t(a);if(r.q=c,r.p.compareTo(r.q)<0){var u=r.p;r.p=r.q,r.q=u}if(r.p.subtract(jt.ONE).gcd(r.e).compareTo(jt.ONE)!==0){r.p=null,n();return}if(r.q.subtract(jt.ONE).gcd(r.e).compareTo(jt.ONE)!==0){r.q=null,s(r.qBits,o);return}if(r.p1=r.p.subtract(jt.ONE),r.q1=r.q.subtract(jt.ONE),r.phi=r.p1.multiply(r.q1),r.phi.gcd(r.e).compareTo(jt.ONE)!==0){r.p=r.q=null,n();return}if(r.n=r.p.multiply(r.q),r.n.bitLength()!==r.bits){r.q=null,s(r.qBits,o);return}var l=r.e.modInverse(r.phi);r.keys={privateKey:pt.rsa.setPrivateKey(r.n,r.e,l,r.p,r.q,l.mod(r.p1),l.mod(r.q1),r.q.modInverse(r.p)),publicKey:pt.rsa.setPublicKey(r.n,r.e)},t(null,r.keys)}}function qa(r){var e=r.toString(16);e[0]>="8"&&(e="00"+e);var t=Ze.util.hexToBytes(e);return t.length>1&&(t.charCodeAt(0)===0&&(t.charCodeAt(1)&128)==0||t.charCodeAt(0)===255&&(t.charCodeAt(1)&128)==128)?t.substr(1):t}function Q7e(r){return r<=100?27:r<=150?18:r<=200?15:r<=250?12:r<=300?9:r<=350?8:r<=400?7:r<=500?6:r<=600?5:r<=800?4:r<=1250?3:2}function vj(r){return Ze.util.isNodejs&&typeof lE[r]=="function"}function Ej(r){return typeof Ws.globalScope!="undefined"&&typeof Ws.globalScope.crypto=="object"&&typeof Ws.globalScope.crypto.subtle=="object"&&typeof Ws.globalScope.crypto.subtle[r]=="function"}function Sj(r){return typeof Ws.globalScope!="undefined"&&typeof Ws.globalScope.msCrypto=="object"&&typeof Ws.globalScope.msCrypto.subtle=="object"&&typeof Ws.globalScope.msCrypto.subtle[r]=="function"}function Rj(r){for(var e=Ze.util.hexToBytes(r.toString(16)),t=new Uint8Array(e.length),i=0;i<e.length;++i)t[i]=e.charCodeAt(i);return t}});var fE=m((Tnt,Cj)=>{f();var Ne=Rt();Ap();ul();S4();ll();Ep();tE();I4();$f();tj();Gy();vr();typeof xj=="undefined"&&(xj=Ne.jsbn.BigInteger);var xj,ae=Ne.asn1,gt=Ne.pki=Ne.pki||{};Cj.exports=gt.pbe=Ne.pbe=Ne.pbe||{};var Yf=gt.oids,Z7e={name:"EncryptedPrivateKeyInfo",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},J7e={name:"PBES2Algorithms",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:ae.Class.UNIVERSAL,type:ae.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:ae.Class.UNIVERSAL,type:ae.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},eEe={name:"pkcs-12PbeParams",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:ae.Class.UNIVERSAL,type:ae.Type.INTEGER,constructed:!1,capture:"iterations"}]};gt.encryptPrivateKeyInfo=function(r,e,t){t=t||{},t.saltSize=t.saltSize||8,t.count=t.count||2048,t.algorithm=t.algorithm||"aes128",t.prfAlgorithm=t.prfAlgorithm||"sha1";var i=Ne.random.getBytesSync(t.saltSize),n=t.count,s=ae.integerToDer(n),o,a,c;if(t.algorithm.indexOf("aes")===0||t.algorithm==="des"){var u,l,d;switch(t.algorithm){case"aes128":o=16,u=16,l=Yf["aes128-CBC"],d=Ne.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,l=Yf["aes192-CBC"],d=Ne.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,l=Yf["aes256-CBC"],d=Ne.aes.createEncryptionCipher;break;case"des":o=8,u=8,l=Yf.desCBC,d=Ne.des.createEncryptionCipher;break;default:var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=t.algorithm,h}var p="hmacWith"+t.prfAlgorithm.toUpperCase(),y=Pj(p),g=Ne.pkcs5.pbkdf2(e,i,n,o,y),w=Ne.random.getBytesSync(u),b=d(g);b.start(w),b.update(ae.toDer(r)),b.finish(),c=b.output.getBytes();var v=tEe(i,s,o,p);a=ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.OID,!1,ae.oidToDer(Yf.pkcs5PBES2).getBytes()),ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.OID,!1,ae.oidToDer(Yf.pkcs5PBKDF2).getBytes()),v]),ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.OID,!1,ae.oidToDer(l).getBytes()),ae.create(ae.Class.UNIVERSAL,ae.Type.OCTETSTRING,!1,w)])])])}else if(t.algorithm==="3des"){o=24;var A=new Ne.util.ByteBuffer(i),g=gt.pbe.generatePkcs12Key(e,A,1,n,o),w=gt.pbe.generatePkcs12Key(e,A,2,n,o),b=Ne.des.createEncryptionCipher(g);b.start(w),b.update(ae.toDer(r)),b.finish(),c=b.output.getBytes(),a=ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.OID,!1,ae.oidToDer(Yf["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.OCTETSTRING,!1,i),ae.create(ae.Class.UNIVERSAL,ae.Type.INTEGER,!1,s.getBytes())])])}else{var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=t.algorithm,h}var k=ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[a,ae.create(ae.Class.UNIVERSAL,ae.Type.OCTETSTRING,!1,c)]);return k};gt.decryptPrivateKeyInfo=function(r,e){var t=null,i={},n=[];if(!ae.validate(r,Z7e,i,n)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=ae.derToOid(i.encryptionOid),a=gt.pbe.getCipher(o,i.encryptionParams,e),c=Ne.util.createBuffer(i.encryptedData);return a.update(c),a.finish()&&(t=ae.fromDer(a.output)),t};gt.encryptedPrivateKeyToPem=function(r,e){var t={type:"ENCRYPTED PRIVATE KEY",body:ae.toDer(r).getBytes()};return Ne.pem.encode(t,{maxline:e})};gt.encryptedPrivateKeyFromPem=function(r){var e=Ne.pem.decode(r)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var t=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return ae.fromDer(e.body)};gt.encryptRsaPrivateKey=function(r,e,t){if(t=t||{},!t.legacy){var i=gt.wrapRsaPrivateKey(gt.privateKeyToAsn1(r));return i=gt.encryptPrivateKeyInfo(i,e,t),gt.encryptedPrivateKeyToPem(i)}var n,s,o,a;switch(t.algorithm){case"aes128":n="AES-128-CBC",o=16,s=Ne.random.getBytesSync(16),a=Ne.aes.createEncryptionCipher;break;case"aes192":n="AES-192-CBC",o=24,s=Ne.random.getBytesSync(16),a=Ne.aes.createEncryptionCipher;break;case"aes256":n="AES-256-CBC",o=32,s=Ne.random.getBytesSync(16),a=Ne.aes.createEncryptionCipher;break;case"3des":n="DES-EDE3-CBC",o=24,s=Ne.random.getBytesSync(8),a=Ne.des.createEncryptionCipher;break;case"des":n="DES-CBC",o=8,s=Ne.random.getBytesSync(8),a=Ne.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+t.algorithm+'".');throw c.algorithm=t.algorithm,c}var u=Ne.pbe.opensslDeriveBytes(e,s.substr(0,8),o),l=a(u);l.start(s),l.update(ae.toDer(gt.privateKeyToAsn1(r))),l.finish();var d={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:n,parameters:Ne.util.bytesToHex(s).toUpperCase()},body:l.output.getBytes()};return Ne.pem.encode(d)};gt.decryptRsaPrivateKey=function(r,e){var t=null,i=Ne.pem.decode(r)[0];if(i.type!=="ENCRYPTED PRIVATE KEY"&&i.type!=="PRIVATE KEY"&&i.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw n.headerType=n,n}if(i.procType&&i.procType.type==="ENCRYPTED"){var s,o;switch(i.dekInfo.algorithm){case"DES-CBC":s=8,o=Ne.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=Ne.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=Ne.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=Ne.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=Ne.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(d){return Ne.rc2.createDecryptionCipher(d,40)};break;case"RC2-64-CBC":s=8,o=function(d){return Ne.rc2.createDecryptionCipher(d,64)};break;case"RC2-128-CBC":s=16,o=function(d){return Ne.rc2.createDecryptionCipher(d,128)};break;default:var n=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".');throw n.algorithm=i.dekInfo.algorithm,n}var a=Ne.util.hexToBytes(i.dekInfo.parameters),c=Ne.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);if(u.start(a),u.update(Ne.util.createBuffer(i.body)),u.finish())t=u.output.getBytes();else return t}else t=i.body;return i.type==="ENCRYPTED PRIVATE KEY"?t=gt.decryptPrivateKeyInfo(ae.fromDer(t),e):t=ae.fromDer(t),t!==null&&(t=gt.privateKeyFromAsn1(t)),t};gt.pbe.generatePkcs12Key=function(r,e,t,i,n,s){var o,a;if(typeof s=="undefined"||s===null){if(!("sha1"in Ne.md))throw new Error('"sha1" hash algorithm unavailable.');s=Ne.md.sha1.create()}var c=s.digestLength,u=s.blockLength,l=new Ne.util.ByteBuffer,d=new Ne.util.ByteBuffer;if(r!=null){for(a=0;a<r.length;a++)d.putInt16(r.charCodeAt(a));d.putInt16(0)}var h=d.length(),p=e.length(),y=new Ne.util.ByteBuffer;y.fillWithByte(t,u);var g=u*Math.ceil(p/u),w=new Ne.util.ByteBuffer;for(a=0;a<g;a++)w.putByte(e.at(a%p));var b=u*Math.ceil(h/u),v=new Ne.util.ByteBuffer;for(a=0;a<b;a++)v.putByte(d.at(a%h));var A=w;A.putBuffer(v);for(var k=Math.ceil(n/c),C=1;C<=k;C++){var T=new Ne.util.ByteBuffer;T.putBytes(y.bytes()),T.putBytes(A.bytes());for(var D=0;D<i;D++)s.start(),s.update(T.getBytes()),T=s.digest();var j=new Ne.util.ByteBuffer;for(a=0;a<u;a++)j.putByte(T.at(a%c));var M=Math.ceil(p/u)+Math.ceil(h/u),se=new Ne.util.ByteBuffer;for(o=0;o<M;o++){var ie=new Ne.util.ByteBuffer(A.getBytes(u)),fe=511;for(a=j.length()-1;a>=0;a--)fe=fe>>8,fe+=j.at(a)+ie.at(a),ie.setAt(a,fe&255);se.putBuffer(ie)}A=se,l.putBuffer(T)}return l.truncate(l.length()-n),l};gt.pbe.getCipher=function(r,e,t){switch(r){case gt.oids.pkcs5PBES2:return gt.pbe.getCipherForPBES2(r,e,t);case gt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case gt.oids["pbewithSHAAnd40BitRC2-CBC"]:return gt.pbe.getCipherForPKCS12PBE(r,e,t);default:var i=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw i.oid=r,i.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],i}};gt.pbe.getCipherForPBES2=function(r,e,t){var i={},n=[];if(!ae.validate(e,J7e,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}if(r=ae.derToOid(i.kdfOid),r!==gt.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=r,s.supportedOids=["pkcs5PBKDF2"],s}if(r=ae.derToOid(i.encOid),r!==gt.oids["aes128-CBC"]&&r!==gt.oids["aes192-CBC"]&&r!==gt.oids["aes256-CBC"]&&r!==gt.oids["des-EDE3-CBC"]&&r!==gt.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=r,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=i.kdfSalt,a=Ne.util.createBuffer(i.kdfIterationCount);a=a.getInt(a.length()<<3);var c,u;switch(gt.oids[r]){case"aes128-CBC":c=16,u=Ne.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=Ne.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=Ne.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=Ne.des.createDecryptionCipher;break;case"desCBC":c=8,u=Ne.des.createDecryptionCipher;break}var l=Tj(i.prfOid),d=Ne.pkcs5.pbkdf2(t,o,a,c,l),h=i.encIv,p=u(d);return p.start(h),p};gt.pbe.getCipherForPKCS12PBE=function(r,e,t){var i={},n=[];if(!ae.validate(e,eEe,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=Ne.util.createBuffer(i.salt),a=Ne.util.createBuffer(i.iterations);a=a.getInt(a.length()<<3);var c,u,l;switch(r){case gt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,l=Ne.des.startDecrypting;break;case gt.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,l=function(g,w){var b=Ne.rc2.createDecryptionCipher(g,40);return b.start(w,null),b};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=r,s}var d=Tj(i.prfOid),h=gt.pbe.generatePkcs12Key(t,o,1,a,c,d);d.start();var p=gt.pbe.generatePkcs12Key(t,o,2,a,u,d);return l(h,p)};gt.pbe.opensslDeriveBytes=function(r,e,t,i){if(typeof i=="undefined"||i===null){if(!("md5"in Ne.md))throw new Error('"md5" hash algorithm unavailable.');i=Ne.md.md5.create()}e===null&&(e="");for(var n=[Ij(i,r+e)],s=16,o=1;s<t;++o,s+=16)n.push(Ij(i,n[o-1]+r+e));return n.join("").substr(0,t)};function Ij(r,e){return r.start().update(e).digest().getBytes()}function Tj(r){var e;if(!r)e="hmacWithSHA1";else if(e=gt.oids[ae.derToOid(r)],!e){var t=new Error("Unsupported PRF OID.");throw t.oid=r,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}return Pj(e)}function Pj(r){var e=Ne.md;switch(r){case"hmacWithSHA224":e=Ne.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":r=r.substr(8).toLowerCase();break;default:var t=new Error("Unsupported PRF algorithm.");throw t.algorithm=r,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}if(!e||!(r in e))throw new Error("Unknown hash algorithm: "+r);return e[r].create()}function tEe(r,e,t,i){var n=ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.OCTETSTRING,!1,r),ae.create(ae.Class.UNIVERSAL,ae.Type.INTEGER,!1,e.getBytes())]);return i!=="hmacWithSHA1"&&n.value.push(ae.create(ae.Class.UNIVERSAL,ae.Type.INTEGER,!1,Ne.util.hexToBytes(t.toString(16))),ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.OID,!1,ae.oidToDer(gt.oids[i]).getBytes()),ae.create(ae.Class.UNIVERSAL,ae.Type.NULL,!1,"")])),n}});var Ys=m((Pnt,kj)=>{f();"use strict";function Oj(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function rEe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Oj(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Oj(new n,t)}}kj.exports=rEe});var Wy=m(Dj=>{f();"use strict";Dj.get=(r=globalThis)=>{let e=r.crypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var dE=m((Ont,Bj)=>{f();"use strict";var{concat:iEe}=(Si(),Pn),{fromString:Nj}=(ct(),Qr),nEe=Wy();function sEe({algorithm:r="AES-GCM",nonceLength:e=12,keyLength:t=16,digest:i="SHA-256",saltLength:n=16,iterations:s=32767}={}){let o=nEe.get();t*=8;async function a(u,l){let d=o.getRandomValues(new Uint8Array(n)),h=o.getRandomValues(new Uint8Array(e)),p={name:r,iv:h},y={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},g=await o.subtle.importKey("raw",Nj(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),w=await o.subtle.deriveKey(y,g,{name:r,length:t},!0,["encrypt"]),b=await o.subtle.encrypt(p,w,u);return iEe([d,p.iv,new Uint8Array(b)])}async function c(u,l){let d=u.slice(0,n),h=u.slice(n,n+e),p=u.slice(n+e),y={name:r,iv:h},g={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},w=await o.subtle.importKey("raw",Nj(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),b=await o.subtle.deriveKey(g,w,{name:r,length:t},!0,["decrypt"]),v=await o.subtle.decrypt(y,b,p);return new Uint8Array(v)}return{encrypt:a,decrypt:c}}Bj.exports={create:sEe}});var Mj=m((knt,Lj)=>{f();"use strict";var{base64:oEe}=(Zu(),Mf),aEe=dE();Lj.exports={import:async function(r,e){let t=oEe.decode(r);return await aEe.create().decrypt(t,e)}}});var yE=m((Dnt,Fj)=>{f();var Or=Rt();ll();vr();var Yy=Fj.exports=Or.sha512=Or.sha512||{};Or.md.sha512=Or.md.algorithms.sha512=Yy;var jj=Or.sha384=Or.sha512.sha384=Or.sha512.sha384||{};jj.create=function(){return Yy.create("SHA-384")};Or.md.sha384=Or.md.algorithms.sha384=jj;Or.sha512.sha256=Or.sha512.sha256||{create:function(){return Yy.create("SHA-512/256")}};Or.md["sha512/256"]=Or.md.algorithms["sha512/256"]=Or.sha512.sha256;Or.sha512.sha224=Or.sha512.sha224||{create:function(){return Yy.create("SHA-512/224")}};Or.md["sha512/224"]=Or.md.algorithms["sha512/224"]=Or.sha512.sha224;Yy.create=function(r){if(qj||cEe(),typeof r=="undefined"&&(r="SHA-512"),!(r in Xf))throw new Error("Invalid SHA-512 algorithm: "+r);for(var e=Xf[r],t=null,i=Or.util.createBuffer(),n=new Array(80),s=0;s<80;++s)n[s]=new Array(2);var o=64;switch(r){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:r.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,u=0;u<c;++u)a.fullMessageLength.push(0);i=Or.util.createBuffer(),t=new Array(e.length);for(var u=0;u<e.length;++u)t[u]=e[u].slice(0);return a},a.start(),a.update=function(c,u){u==="utf8"&&(c=Or.util.encodeUtf8(c));var l=c.length;a.messageLength+=l,l=[l/4294967296>>>0,l>>>0];for(var d=a.fullMessageLength.length-1;d>=0;--d)a.fullMessageLength[d]+=l[1],l[1]=l[0]+(a.fullMessageLength[d]/4294967296>>>0),a.fullMessageLength[d]=a.fullMessageLength[d]>>>0,l[0]=l[1]/4294967296>>>0;return i.putBytes(c),Uj(t,n,i),(i.read>2048||i.length()===0)&&i.compact(),a},a.digest=function(){var c=Or.util.createBuffer();c.putBytes(i.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,l=u&a.blockLength-1;c.putBytes(hE.substr(0,a.blockLength-l));for(var d,h,p=a.fullMessageLength[0]*8,y=0;y<a.fullMessageLength.length-1;++y)d=a.fullMessageLength[y+1]*8,h=d/4294967296>>>0,p+=h,c.putInt32(p>>>0),p=d>>>0;c.putInt32(p);for(var g=new Array(t.length),y=0;y<t.length;++y)g[y]=t[y].slice(0);Uj(g,n,c);var w=Or.util.createBuffer(),b;r==="SHA-512"?b=g.length:r==="SHA-384"?b=g.length-2:b=g.length-4;for(var y=0;y<b;++y)w.putInt32(g[y][0]),(y!==b-1||r!=="SHA-512/224")&&w.putInt32(g[y][1]);return w},a};var hE=null,qj=!1,pE=null,Xf=null;function cEe(){hE=String.fromCharCode(128),hE+=Or.util.fillString(String.fromCharCode(0),128),pE=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Xf={},Xf["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Xf["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Xf["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Xf["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],qj=!0}function Uj(r,e,t){for(var i,n,s,o,a,c,u,l,d,h,p,y,g,w,b,v,A,k,C,T,D,j,M,se,ie,fe,pe,Le,Re,De,ne,je,ut,Ye,Xe,de=t.length();de>=128;){for(Re=0;Re<16;++Re)e[Re][0]=t.getInt32()>>>0,e[Re][1]=t.getInt32()>>>0;for(;Re<80;++Re)je=e[Re-2],De=je[0],ne=je[1],i=((De>>>19|ne<<13)^(ne>>>29|De<<3)^De>>>6)>>>0,n=((De<<13|ne>>>19)^(ne<<3|De>>>29)^(De<<26|ne>>>6))>>>0,Ye=e[Re-15],De=Ye[0],ne=Ye[1],s=((De>>>1|ne<<31)^(De>>>8|ne<<24)^De>>>7)>>>0,o=((De<<31|ne>>>1)^(De<<24|ne>>>8)^(De<<25|ne>>>7))>>>0,ut=e[Re-7],Xe=e[Re-16],ne=n+ut[1]+o+Xe[1],e[Re][0]=i+ut[0]+s+Xe[0]+(ne/4294967296>>>0)>>>0,e[Re][1]=ne>>>0;for(g=r[0][0],w=r[0][1],b=r[1][0],v=r[1][1],A=r[2][0],k=r[2][1],C=r[3][0],T=r[3][1],D=r[4][0],j=r[4][1],M=r[5][0],se=r[5][1],ie=r[6][0],fe=r[6][1],pe=r[7][0],Le=r[7][1],Re=0;Re<80;++Re)u=((D>>>14|j<<18)^(D>>>18|j<<14)^(j>>>9|D<<23))>>>0,l=((D<<18|j>>>14)^(D<<14|j>>>18)^(j<<23|D>>>9))>>>0,d=(ie^D&(M^ie))>>>0,h=(fe^j&(se^fe))>>>0,a=((g>>>28|w<<4)^(w>>>2|g<<30)^(w>>>7|g<<25))>>>0,c=((g<<4|w>>>28)^(w<<30|g>>>2)^(w<<25|g>>>7))>>>0,p=(g&b|A&(g^b))>>>0,y=(w&v|k&(w^v))>>>0,ne=Le+l+h+pE[Re][1]+e[Re][1],i=pe+u+d+pE[Re][0]+e[Re][0]+(ne/4294967296>>>0)>>>0,n=ne>>>0,ne=c+y,s=a+p+(ne/4294967296>>>0)>>>0,o=ne>>>0,pe=ie,Le=fe,ie=M,fe=se,M=D,se=j,ne=T+n,D=C+i+(ne/4294967296>>>0)>>>0,j=ne>>>0,C=A,T=k,A=b,k=v,b=g,v=w,ne=n+o,g=i+s+(ne/4294967296>>>0)>>>0,w=ne>>>0;ne=r[0][1]+w,r[0][0]=r[0][0]+g+(ne/4294967296>>>0)>>>0,r[0][1]=ne>>>0,ne=r[1][1]+v,r[1][0]=r[1][0]+b+(ne/4294967296>>>0)>>>0,r[1][1]=ne>>>0,ne=r[2][1]+k,r[2][0]=r[2][0]+A+(ne/4294967296>>>0)>>>0,r[2][1]=ne>>>0,ne=r[3][1]+T,r[3][0]=r[3][0]+C+(ne/4294967296>>>0)>>>0,r[3][1]=ne>>>0,ne=r[4][1]+j,r[4][0]=r[4][0]+D+(ne/4294967296>>>0)>>>0,r[4][1]=ne>>>0,ne=r[5][1]+se,r[5][0]=r[5][0]+M+(ne/4294967296>>>0)>>>0,r[5][1]=ne>>>0,ne=r[6][1]+fe,r[6][0]=r[6][0]+ie+(ne/4294967296>>>0)>>>0,r[6][1]=ne>>>0,ne=r[7][1]+Le,r[7][0]=r[7][0]+pe+(ne/4294967296>>>0)>>>0,r[7][1]=ne>>>0,de-=128}}});var Vj=m((Nnt,Kj)=>{f();"use strict";var N4=65536;function uEe(r){let e=new Uint8Array(r),t=0;if(r>0)if(r>N4)for(;t<r;)t+N4>r?(crypto.getRandomValues(e.subarray(t,t+(r-t))),t+=r-t):(crypto.getRandomValues(e.subarray(t,t+N4)),t+=N4);else crypto.getRandomValues(e);return e}Kj.exports=uEe});var Xy=m((Bnt,zj)=>{f();"use strict";var lEe=Vj(),fEe=Ys();zj.exports=function(r){if(isNaN(r)||r<=0)throw fEe(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return lEe(r)}});var B4=m(Qy=>{f();"use strict";vr();O4();var dEe=Rt(),{fromString:hEe}=(ct(),Qr),{toString:Hj}=(tt(),sr),{concat:$j}=(Si(),Pn);Qy.bigIntegerToUintBase64url=(r,e)=>{let t=Uint8Array.from(r.abs().toByteArray());if(t=t[0]===0?t.slice(1):t,e!=null){if(t.length>e)throw new Error("byte array longer than desired length");t=$j([new Uint8Array(e-t.length),t])}return Hj(t,"base64url")};Qy.base64urlToBigInteger=r=>{let e=Qy.base64urlToBuffer(r);return new dEe.jsbn.BigInteger(Hj(e,"base16"),16)};Qy.base64urlToBuffer=(r,e)=>{let t=hEe(r,"base64urlpad");if(e!=null){if(t.length>e)throw new Error("byte array longer than desired length");t=$j([new Uint8Array(e-t.length),t])}return t}});var Yj=m(Zy=>{f();"use strict";ul();Gy();var hl=Rt(),{bigIntegerToUintBase64url:Ua,base64urlToBigInteger:Fa}=B4(),{fromString:Gj}=(ct(),Qr),{toString:Wj}=(tt(),sr);Zy.pkcs1ToJwk=function(r){let e=hl.asn1.fromDer(Wj(r,"ascii")),t=hl.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Ua(t.n),e:Ua(t.e),d:Ua(t.d),p:Ua(t.p),q:Ua(t.q),dp:Ua(t.dP),dq:Ua(t.dQ),qi:Ua(t.qInv),alg:"RS256",kid:"2011-04-29"}};Zy.jwkToPkcs1=function(r){let e=hl.pki.privateKeyToAsn1({n:Fa(r.n),e:Fa(r.e),d:Fa(r.d),p:Fa(r.p),q:Fa(r.q),dP:Fa(r.dp),dQ:Fa(r.dq),qInv:Fa(r.qi)});return Gj(hl.asn1.toDer(e).getBytes(),"ascii")};Zy.pkixToJwk=function(r){let e=hl.asn1.fromDer(Wj(r,"ascii")),t=hl.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Ua(t.n),e:Ua(t.e),alg:"RS256",kid:"2011-04-29"}};Zy.jwkToPkix=function(r){let e=hl.pki.publicKeyToAsn1({n:Fa(r.n),e:Fa(r.e)});return Gj(hl.asn1.toDer(e).getBytes(),"ascii")}});var Jj=m((jnt,Zj)=>{f();"use strict";Gy();var Xj=Rt(),{base64urlToBigInteger:pEe}=B4();function Qj(r,e){return e.map(t=>pEe(r[t]))}function yEe(r){return Xj.pki.setRsaPrivateKey(...Qj(r,["n","e","d","p","q","dp","dq","qi"]))}function gEe(r){return Xj.pki.setRsaPublicKey(...Qj(r,["n","e"]))}Zj.exports={jwk2pub:gEe,jwk2priv:yEe}});var rq=m(Zc=>{f();"use strict";var Qc=Wy(),mEe=Xy(),{toString:bEe}=(tt(),sr),{fromString:wEe}=(ct(),Qr);Zc.utils=Yj();Zc.generateKey=async function(r){let e=await Qc.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),t=await eq(e);return{privateKey:t[0],publicKey:t[1]}};Zc.unmarshalPrivateKey=async function(r){let t=[await Qc.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await _Ee(r)],i=await eq({privateKey:t[0],publicKey:t[1]});return{privateKey:i[0],publicKey:i[1]}};Zc.getRandomValues=mEe;Zc.hashAndSign=async function(r,e){let t=await Qc.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),i=await Qc.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},t,Uint8Array.from(e));return new Uint8Array(i,i.byteOffset,i.byteLength)};Zc.hashAndVerify=async function(r,e,t){let i=await Qc.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Qc.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},i,e,t)};function eq(r){return Promise.all([Qc.get().subtle.exportKey("jwk",r.privateKey),Qc.get().subtle.exportKey("jwk",r.publicKey)])}function _Ee(r){return Qc.get().subtle.importKey("jwk",{kty:r.kty,n:r.n,e:r.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:vEe,jwk2priv:EEe}=Jj();function tq(r,e,t,i){let n=e?vEe(r):EEe(r),s=bEe(Uint8Array.from(t),"ascii"),o=i(s,n);return wEe(o,"ascii")}Zc.encrypt=function(r,e){return tq(r,!0,e,(t,i)=>i.encrypt(t))};Zc.decrypt=function(r,e){return tq(r,!1,e,(t,i)=>i.decrypt(t))}});var L4=m((Unt,iq)=>{f();"use strict";var{base64:SEe}=(Zu(),Mf),REe=dE();iq.exports={export:async function(r,e){let i=await REe.create().encrypt(r,e);return SEe.encode(i)}}});var cq=m((Fnt,aq)=>{f();"use strict";var{sha256:nq}=(vi(),Ks),sq=Ys(),{equals:oq}=(hi(),dn),{toString:AEe}=(tt(),sr);yE();var M4=Rt(),Xs=rq(),j4=g4(),xEe=L4(),q4=class{constructor(e){this._key=e}async verify(e,t){return Xs.hashAndVerify(this._key,t,e)}marshal(){return Xs.utils.jwkToPkix(this._key)}get bytes(){return j4.PublicKey.encode({Type:j4.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return Xs.encrypt(this._key,e)}equals(e){return oq(this.bytes,e.bytes)}async hash(){let{bytes:e}=await nq.digest(this.bytes);return e}},Jy=class{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return Xs.getRandomValues(16)}async sign(e){return Xs.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw sq(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new q4(this._publicKey)}decrypt(e){return Xs.decrypt(this._key,e)}marshal(){return Xs.utils.jwkToPkcs1(this._key)}get bytes(){return j4.PrivateKey.encode({Type:j4.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return oq(this.bytes,e.bytes)}async hash(){let{bytes:e}=await nq.digest(this.bytes);return e}async id(){let e=await this.public.hash();return AEe(e,"base58btc")}async export(e,t="pkcs-8"){if(t==="pkcs-8"){let i=new M4.util.ByteBuffer(this.marshal()),n=M4.asn1.fromDer(i),s=M4.pki.privateKeyFromAsn1(n),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return M4.pki.encryptRsaPrivateKey(s,e,o)}else{if(t==="libp2p-key")return xEe.export(this.bytes,e);throw sq(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function IEe(r){let e=Xs.utils.pkcs1ToJwk(r),t=await Xs.unmarshalPrivateKey(e);return new Jy(t.privateKey,t.publicKey)}function TEe(r){let e=Xs.utils.pkixToJwk(r);return new q4(e)}async function PEe(r){let e=await Xs.unmarshalPrivateKey(r);return new Jy(e.privateKey,e.publicKey)}async function CEe(r){let e=await Xs.generateKey(r);return new Jy(e.privateKey,e.publicKey)}aq.exports={RsaPublicKey:q4,RsaPrivateKey:Jy,unmarshalRsaPublicKey:TEe,unmarshalRsaPrivateKey:IEe,generateKeyPair:CEe,fromJwk:PEe}});var bq=m(Wt=>{f();"use strict";var OEe=Wt&&Wt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Wt,"__esModule",{value:!0});Wt.utils=Wt.curve25519=Wt.getSharedSecret=Wt.verify=Wt.sign=Wt.getPublicKey=Wt.Signature=Wt.Point=Wt.RistrettoPoint=Wt.ExtendedPoint=Wt.CURVE=void 0;var kEe=OEe(Hf()),Gr=BigInt(0),xt=BigInt(1),rn=BigInt(2),uq=BigInt(255),lq=rn**BigInt(252)+BigInt("27742317777372353535851937790883648493"),lr={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:rn**uq-BigInt(19),l:lq,n:lq,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")};Wt.CURVE=lr;var fq=rn**BigInt(256),e2=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Knt=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),DEe=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),NEe=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),BEe=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),LEe=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),qt=class{constructor(e,t,i,n){this.x=e,this.y=t,this.z=i,this.t=n}static fromAffine(e){if(!(e instanceof qr))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(qr.ZERO)?qt.ZERO:new qt(e.x,e.y,xt,ce(e.x*e.y))}static toAffineBatch(e){let t=qEe(e.map(i=>i.z));return e.map((i,n)=>i.toAffine(t[n]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){dq(e);let{x:t,y:i,z:n}=this,{x:s,y:o,z:a}=e,c=ce(t*a),u=ce(s*n),l=ce(i*a),d=ce(o*n);return c===u&&l===d}negate(){return new qt(ce(-this.x),this.y,this.z,ce(-this.t))}double(){let{x:e,y:t,z:i}=this,{a:n}=lr,s=ce(e**rn),o=ce(t**rn),a=ce(rn*ce(i**rn)),c=ce(n*s),u=ce(ce((e+t)**rn)-s-o),l=c+o,d=l-a,h=c-o,p=ce(u*d),y=ce(l*h),g=ce(u*h),w=ce(d*l);return new qt(p,y,w,g)}add(e){dq(e);let{x:t,y:i,z:n,t:s}=this,{x:o,y:a,z:c,t:u}=e,l=ce((i-t)*(a+o)),d=ce((i+t)*(a-o)),h=ce(d-l);if(h===Gr)return this.double();let p=ce(n*rn*u),y=ce(s*rn*c),g=y+p,w=d+l,b=y-p,v=ce(g*h),A=ce(w*b),k=ce(g*b),C=ce(h*w);return new qt(v,A,C,k)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let t=1+256/e,i=[],n=this,s=n;for(let o=0;o<t;o++){s=n,i.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(n),i.push(s);n=s.double()}return i}wNAF(e,t){!t&&this.equals(qt.BASE)&&(t=qr.BASE);let i=t&&t._WINDOW_SIZE||1;if(256%i)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=t&&bE.get(t);n||(n=this.precomputeWindow(i),t&&i!==1&&(n=qt.normalizeZ(n),bE.set(t,n)));let s=qt.ZERO,o=qt.ZERO,a=1+256/i,c=2**(i-1),u=BigInt(2**i-1),l=2**i,d=BigInt(i);for(let h=0;h<a;h++){let p=h*c,y=Number(e&u);if(e>>=d,y>c&&(y-=l,e+=xt),y===0){let g=n[p];h%2&&(g=g.negate()),o=o.add(g)}else{let g=n[p+Math.abs(y)-1];y<0&&(g=g.negate()),s=s.add(g)}}return qt.normalizeZ([s,o])[0]}multiply(e,t){return this.wNAF(Pp(e,lr.l),t)}multiplyUnsafe(e){let t=Pp(e,lr.l,!1),i=qt.BASE,n=qt.ZERO;if(t===Gr)return n;if(this.equals(n)||t===xt)return this;if(this.equals(i))return this.wNAF(t);let s=n,o=this;for(;t>Gr;)t&xt&&(s=s.add(o)),o=o.double(),t>>=xt;return s}isSmallOrder(){return this.multiplyUnsafe(lr.h).equals(qt.ZERO)}isTorsionFree(){return this.multiplyUnsafe(lr.l).equals(qt.ZERO)}toAffine(e=U4(this.z)){let{x:t,y:i,z:n}=this,s=ce(t*e),o=ce(i*e);if(ce(n*e)!==xt)throw new Error("invZ was invalid");return new qr(s,o)}fromRistrettoBytes(){mE()}toRistrettoBytes(){mE()}fromRistrettoHash(){mE()}};Wt.ExtendedPoint=qt;qt.BASE=new qt(lr.Gx,lr.Gy,xt,ce(lr.Gx*lr.Gy));qt.ZERO=new qt(Gr,xt,xt,Gr);function dq(r){if(!(r instanceof qt))throw new TypeError("ExtendedPoint expected")}function gE(r){if(!(r instanceof Xn))throw new TypeError("RistrettoPoint expected")}function mE(){throw new Error("Legacy method: switch to RistrettoPoint")}var Xn=class{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:t}=lr,i=ce(e2*e*e),n=ce((i+xt)*BEe),s=BigInt(-1),o=ce((s-t*i)*ce(i+t)),{isValid:a,value:c}=_E(n,o),u=ce(c*e);pl(u)||(u=ce(-u)),a||(c=u),a||(s=i);let l=ce(s*(i-xt)*LEe-o),d=c*c,h=ce((c+c)*o),p=ce(l*DEe),y=ce(xt-d),g=ce(xt+d);return new qt(ce(h*g),ce(y*p),ce(p*g),ce(h*y))}static hashToCurve(e){e=Ka(e,64);let t=wE(e.slice(0,32)),i=this.calcElligatorRistrettoMap(t),n=wE(e.slice(32,64)),s=this.calcElligatorRistrettoMap(n);return new Xn(i.add(s))}static fromHex(e){e=Ka(e,32);let{a:t,d:i}=lr,n="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=wE(e);if(!UEe(Tp(s),e)||pl(s))throw new Error(n);let o=ce(s*s),a=ce(xt+t*o),c=ce(xt-t*o),u=ce(a*a),l=ce(c*c),d=ce(t*i*u-l),{isValid:h,value:p}=gq(ce(d*l)),y=ce(p*c),g=ce(p*y*d),w=ce((s+s)*y);pl(w)&&(w=ce(-w));let b=ce(a*g),v=ce(w*b);if(!h||pl(v)||b===Gr)throw new Error(n);return new Xn(new qt(w,b,xt,v))}toRawBytes(){let{x:e,y:t,z:i,t:n}=this.ep,s=ce(ce(i+t)*ce(i-t)),o=ce(e*t),{value:a}=gq(ce(s*o**rn)),c=ce(a*s),u=ce(a*o),l=ce(c*u*n),d;if(pl(n*l)){let p=ce(t*e2),y=ce(e*e2);e=p,t=y,d=ce(c*NEe)}else d=u;pl(e*l)&&(t=ce(-t));let h=ce((i-t)*d);return pl(h)&&(h=ce(-h)),Tp(h)}toHex(){return t2(this.toRawBytes())}toString(){return this.toHex()}equals(e){gE(e);let t=this.ep,i=e.ep,n=ce(t.x*i.y)===ce(t.y*i.x),s=ce(t.y*i.y)===ce(t.x*i.x);return n||s}add(e){return gE(e),new Xn(this.ep.add(e.ep))}subtract(e){return gE(e),new Xn(this.ep.subtract(e.ep))}multiply(e){return new Xn(this.ep.multiply(e))}multiplyUnsafe(e){return new Xn(this.ep.multiplyUnsafe(e))}};Wt.RistrettoPoint=Xn;Xn.BASE=new Xn(qt.BASE);Xn.ZERO=new Xn(qt.ZERO);var bE=new WeakMap,qr=class{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,bE.delete(this)}static fromHex(e,t=!0){let{d:i,P:n}=lr;e=Ka(e,32);let s=e.slice();s[31]=e[31]&~128;let o=yl(s);if(t&&o>=n)throw new Error("Expected 0 < hex < P");if(!t&&o>=fq)throw new Error("Expected 0 < hex < 2**256");let a=ce(o*o),c=ce(a-xt),u=ce(i*a+xt),{isValid:l,value:d}=_E(c,u);if(!l)throw new Error("Point.fromHex: invalid y coordinate");let h=(d&xt)===xt;return(e[31]&128)!=0!==h&&(d=ce(-d)),new qr(d,o)}static async fromPrivateKey(e){return(await r2(e)).point}toRawBytes(){let e=Tp(this.y);return e[31]|=this.x&xt?128:0,e}toHex(){return t2(this.toRawBytes())}toX25519(){let{y:e}=this,t=ce((xt+e)*U4(xt-e));return Tp(t)}isTorsionFree(){return qt.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new qr(ce(-this.x),this.y)}add(e){return qt.fromAffine(this).add(qt.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return qt.fromAffine(this).multiply(e,this).toAffine()}};Wt.Point=qr;qr.BASE=new qr(lr.Gx,lr.Gy);qr.ZERO=new qr(Gr,xt);var Qf=class{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromHex(e){let t=Ka(e,64),i=qr.fromHex(t.slice(0,32),!1),n=yl(t.slice(32,64));return new Qf(i,n)}assertValidity(){let{r:e,s:t}=this;if(!(e instanceof qr))throw new Error("Expected Point instance");return Pp(t,lr.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(Tp(this.s),32),e}toHex(){return t2(this.toRawBytes())}};Wt.Signature=Qf;function MEe(...r){if(!r.every(i=>i instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(r.length===1)return r[0];let e=r.reduce((i,n)=>i+n.length,0),t=new Uint8Array(e);for(let i=0,n=0;i<r.length;i++){let s=r[i];t.set(s,n),n+=s.length}return t}var jEe=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function t2(r){if(!(r instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let t=0;t<r.length;t++)e+=jEe[r[t]];return e}function hq(r){if(typeof r!="string")throw new TypeError("hexToBytes: expected string, got "+typeof r);if(r.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(r.length/2);for(let t=0;t<e.length;t++){let i=t*2,n=r.slice(i,i+2),s=Number.parseInt(n,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[t]=s}return e}function pq(r){let e=32,t=r.toString(16).padStart(e*2,"0");return hq(t)}function Tp(r){return pq(r).reverse()}function pl(r){return(ce(r)&xt)===xt}function yl(r){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+t2(Uint8Array.from(r).reverse()))}function wE(r){return ce(yl(r)&rn**uq-xt)}function ce(r,e=lr.P){let t=r%e;return t>=Gr?t:e+t}function U4(r,e=lr.P){if(r===Gr||e<=Gr)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=ce(r,e),i=e,n=Gr,s=xt,o=xt,a=Gr;for(;t!==Gr;){let u=i/t,l=i%t,d=n-o*u,h=s-a*u;i=t,t=l,n=o,s=a,o=d,a=h}if(i!==xt)throw new Error("invert: does not exist");return ce(n,e)}function qEe(r,e=lr.P){let t=new Array(r.length),i=r.reduce((s,o,a)=>o===Gr?s:(t[a]=s,ce(s*o,e)),xt),n=U4(i,e);return r.reduceRight((s,o,a)=>o===Gr?s:(t[a]=ce(s*t[a],e),ce(s*o,e)),n),t}function Yo(r,e){let{P:t}=lr,i=r;for(;e-- >Gr;)i*=i,i%=t;return i}function yq(r){let{P:e}=lr,t=BigInt(5),i=BigInt(10),n=BigInt(20),s=BigInt(40),o=BigInt(80),c=r*r%e*r%e,u=Yo(c,rn)*c%e,l=Yo(u,xt)*r%e,d=Yo(l,t)*l%e,h=Yo(d,i)*d%e,p=Yo(h,n)*h%e,y=Yo(p,s)*p%e,g=Yo(y,o)*y%e,w=Yo(g,o)*y%e,b=Yo(w,i)*d%e;return{pow_p_5_8:Yo(b,rn)*r%e,b2:c}}function _E(r,e){let t=ce(e*e*e),i=ce(t*t*e),n=yq(r*i).pow_p_5_8,s=ce(r*t*n),o=ce(e*s*s),a=s,c=ce(s*e2),u=o===r,l=o===ce(-r),d=o===ce(-r*e2);return u&&(s=a),(l||d)&&(s=c),pl(s)&&(s=ce(-s)),{isValid:u||l,value:s}}function gq(r){return _E(xt,r)}async function vE(...r){let e=await Wt.utils.sha512(MEe(...r)),t=yl(e);return ce(t,lr.l)}function UEe(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function Ka(r,e){let t=r instanceof Uint8Array?Uint8Array.from(r):hq(r);if(typeof e=="number"&&t.length!==e)throw new Error(`Expected ${e} bytes`);return t}function Pp(r,e,t=!0){if(!e)throw new TypeError("Specify max value");if(typeof r=="number"&&Number.isSafeInteger(r)&&(r=BigInt(r)),typeof r=="bigint"&&r<e){if(t){if(Gr<r)return r}else if(Gr<=r)return r}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function mq(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function FEe(r){return yl(mq(Ka(r,32)))}async function r2(r){if(r=typeof r=="bigint"||typeof r=="number"?pq(Pp(r,fq)):Ka(r),r.length!==32)throw new Error("Expected 32 bytes");let e=await Wt.utils.sha512(r),t=mq(e.slice(0,32)),i=e.slice(32,64),n=ce(yl(t),lr.l),s=qr.BASE.multiply(n),o=s.toRawBytes();return{head:t,prefix:i,scalar:n,point:s,pointBytes:o}}async function KEe(r){return(await r2(r)).pointBytes}Wt.getPublicKey=KEe;async function VEe(r,e){r=Ka(r);let{prefix:t,scalar:i,pointBytes:n}=await r2(e),s=await vE(t,r),o=qr.BASE.multiply(s),a=await vE(o.toRawBytes(),n,r),c=ce(s+a*i,lr.l);return new Qf(o,c).toRawBytes()}Wt.sign=VEe;async function zEe(r,e,t){e=Ka(e),t instanceof qr||(t=qr.fromHex(t,!1));let{r:i,s:n}=r instanceof Qf?r.assertValidity():Qf.fromHex(r),s=qt.BASE.multiplyUnsafe(n),o=await vE(i.toRawBytes(),t.toRawBytes(),e),a=qt.fromAffine(t).multiplyUnsafe(o);return qt.fromAffine(i).add(a).subtract(s).multiplyUnsafe(lr.h).equals(qt.ZERO)}Wt.verify=zEe;async function HEe(r,e){let{head:t}=await r2(r),i=qr.fromHex(e).toX25519();return Wt.curve25519.scalarMult(t,i)}Wt.getSharedSecret=HEe;qr.BASE._setWindowSize(8);function F4(r,e,t){let i=ce(r*(e-t));return e=ce(e-i),t=ce(t+i),[e,t]}function $Ee(r,e){let{P:t}=lr,i=Pp(r,t),n=Pp(e,t),s=BigInt(121665),o=i,a=xt,c=Gr,u=i,l=xt,d=Gr,h;for(let w=BigInt(255-1);w>=Gr;w--){let b=n>>w&xt;d^=b,h=F4(d,a,u),a=h[0],u=h[1],h=F4(d,c,l),c=h[0],l=h[1],d=b;let v=a+c,A=ce(v*v),k=a-c,C=ce(k*k),T=A-C,D=u+l,j=u-l,M=ce(j*v),se=ce(D*k);u=ce((M+se)**rn),l=ce(o*(M-se)**rn),a=ce(A*C),c=ce(T*(A+ce(s*T)))}h=F4(d,a,u),a=h[0],u=h[1],h=F4(d,c,l),c=h[0],l=h[1];let{pow_p_5_8:p,b2:y}=yq(c),g=ce(Yo(p,BigInt(3))*y);return ce(a*g)}function GEe(r){return Tp(ce(r,lr.P))}function WEe(r){let e=Ka(r,32);return e[31]&=127,yl(e)}Wt.curve25519={BASE_POINT_U:"0900000000000000000000000000000000000000000000000000000000000000",scalarMult(r,e){let t=WEe(e),i=FEe(r),n=$Ee(t,i);if(n===Gr)throw new Error("Invalid private or public key received");return GEe(n)},scalarMultBase(r){return Wt.curve25519.scalarMult(r,Wt.curve25519.BASE_POINT_U)}};var gl={node:kEe.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};Wt.utils={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],bytesToHex:t2,getExtendedPublicKey:r2,mod:ce,invert:U4,hashToPrivateScalar:r=>{if(r=Ka(r),r.length<40||r.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=ce(yl(r),lr.l);if(e===Gr||e===xt)throw new Error("Invalid private key");return e},randomBytes:(r=32)=>{if(gl.web)return gl.web.getRandomValues(new Uint8Array(r));if(gl.node){let{randomBytes:e}=gl.node;return new Uint8Array(e(r).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Wt.utils.randomBytes(32),sha512:async r=>{if(gl.web){let e=await gl.web.subtle.digest("SHA-512",r.buffer);return new Uint8Array(e)}else{if(gl.node)return Uint8Array.from(gl.node.createHash("sha512").update(r).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(r=8,e=qr.BASE){let t=e.equals(qr.BASE)?e:new qr(e.x,e.y);return t._setWindowSize(r),t.multiply(rn),t}}});var _q=m(ml=>{f();"use strict";var i2=bq(),YEe=32,XEe=64,K4=32;ml.publicKeyLength=YEe;ml.privateKeyLength=XEe;ml.generateKey=async function(){let r=i2.utils.randomPrivateKey(),e=await i2.getPublicKey(r);return{privateKey:wq(r,e),publicKey:e}};ml.generateKeyFromSeed=async function(r){if(r.length!==K4)throw new TypeError('"seed" must be 32 bytes in length.');if(!(r instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=r,t=await i2.getPublicKey(e);return{privateKey:wq(e,t),publicKey:t}};ml.hashAndSign=function(r,e){let t=r.slice(0,K4);return i2.sign(e,t)};ml.hashAndVerify=function(r,e,t){return i2.verify(e,t,r)};function wq(r,e){let t=new Uint8Array(ml.privateKeyLength);for(let i=0;i<K4;i++)t[i]=r[i],t[K4+i]=e[i];return t}});var Aq=m((Hnt,Rq)=>{f();"use strict";var vq=Ys(),{equals:Eq}=(hi(),dn),{sha256:Sq}=(vi(),Ks),{base58btc:QEe}=(di(),Uo),{identity:ZEe}=(zc(),xy),gn=_q(),V4=g4(),JEe=L4(),z4=class{constructor(e){this._key=Op(e,gn.publicKeyLength)}async verify(e,t){return gn.hashAndVerify(this._key,t,e)}marshal(){return this._key}get bytes(){return V4.PublicKey.encode({Type:V4.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return Eq(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Sq.digest(this.bytes);return e}},Cp=class{constructor(e,t){this._key=Op(e,gn.privateKeyLength),this._publicKey=Op(t,gn.publicKeyLength)}async sign(e){return gn.hashAndSign(this._key,e)}get public(){return new z4(this._publicKey)}marshal(){return this._key}get bytes(){return V4.PrivateKey.encode({Type:V4.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return Eq(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Sq.digest(this.bytes);return e}async id(){let e=await ZEe.digest(this.public.bytes);return QEe.encode(e.bytes).substring(1)}async export(e,t="libp2p-key"){if(t==="libp2p-key")return JEe.export(this.bytes,e);throw vq(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function e9e(r){if(r.length>gn.privateKeyLength){r=Op(r,gn.privateKeyLength+gn.publicKeyLength);let i=r.slice(0,gn.privateKeyLength),n=r.slice(gn.privateKeyLength,r.length);return new Cp(i,n)}r=Op(r,gn.privateKeyLength);let e=r.slice(0,gn.privateKeyLength),t=r.slice(gn.publicKeyLength);return new Cp(e,t)}function t9e(r){return r=Op(r,gn.publicKeyLength),new z4(r)}async function r9e(){let{privateKey:r,publicKey:e}=await gn.generateKey();return new Cp(r,e)}async function i9e(r){let{privateKey:e,publicKey:t}=await gn.generateKeyFromSeed(r);return new Cp(e,t)}function Op(r,e){if(r=Uint8Array.from(r||[]),r.length!==e)throw vq(new Error(`Key must be a Uint8Array of length ${e}, got ${r.length}`),"ERR_INVALID_KEY_TYPE");return r}Rq.exports={Ed25519PublicKey:z4,Ed25519PrivateKey:Cp,unmarshalEd25519PrivateKey:e9e,unmarshalEd25519PublicKey:t9e,generateKeyPair:r9e,generateKeyPairFromSeed:i9e}});var Kq=m(Bt=>{f();"use strict";var n9e=Bt&&Bt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Bt,"__esModule",{value:!0});Bt.utils=Bt.schnorr=Bt.verify=Bt.signSync=Bt.sign=Bt.getSharedSecret=Bt.recoverPublicKey=Bt.getPublicKey=Bt.Signature=Bt.Point=Bt.CURVE=void 0;var s9e=n9e(Hf()),Ct=BigInt(0),kr=BigInt(1),pi=BigInt(2),n2=BigInt(3),o9e=BigInt(8),EE=pi**BigInt(256),fr={a:Ct,b:BigInt(7),P:EE-pi**BigInt(32)-BigInt(977),n:EE-BigInt("432420386565659656852420866394968145599"),h:kr,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};Bt.CURVE=fr;function xq(r){let{a:e,b:t}=fr,i=ke(r*r),n=ke(i*r);return ke(n+e*r+t)}var H4=fr.a===Ct,Qt=class{constructor(e,t,i){this.x=e,this.y=t,this.z=i}static fromAffine(e){if(!(e instanceof Zt))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new Qt(e.x,e.y,kr)}static toAffineBatch(e){let t=l9e(e.map(i=>i.z));return e.map((i,n)=>i.toAffine(t[n]))}static normalizeZ(e){return Qt.toAffineBatch(e).map(Qt.fromAffine)}equals(e){if(!(e instanceof Qt))throw new TypeError("JacobianPoint expected");let{x:t,y:i,z:n}=this,{x:s,y:o,z:a}=e,c=ke(n**pi),u=ke(a**pi),l=ke(t*u),d=ke(s*c),h=ke(ke(i*a)*u),p=ke(ke(o*n)*c);return l===d&&h===p}negate(){return new Qt(this.x,ke(-this.y),this.z)}double(){let{x:e,y:t,z:i}=this,n=ke(e**pi),s=ke(t**pi),o=ke(s**pi),a=ke(pi*(ke((e+s)**pi)-n-o)),c=ke(n2*n),u=ke(c**pi),l=ke(u-pi*a),d=ke(c*(a-l)-o9e*o),h=ke(pi*t*i);return new Qt(l,d,h)}add(e){if(!(e instanceof Qt))throw new TypeError("JacobianPoint expected");let{x:t,y:i,z:n}=this,{x:s,y:o,z:a}=e;if(s===Ct||o===Ct)return this;if(t===Ct||i===Ct)return e;let c=ke(n**pi),u=ke(a**pi),l=ke(t*u),d=ke(s*c),h=ke(ke(i*a)*u),p=ke(ke(o*n)*c),y=ke(d-l),g=ke(p-h);if(y===Ct)return g===Ct?this.double():Qt.ZERO;let w=ke(y**pi),b=ke(y*w),v=ke(l*w),A=ke(g**pi-b-pi*v),k=ke(g*(v-A)-h*b),C=ke(n*a*y);return new Qt(A,k,C)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let t=Pq(e),i=Qt.BASE,n=Qt.ZERO;if(t===Ct)return n;if(t===kr)return this;if(!H4){let h=n,p=this;for(;t>Ct;)t&kr&&(h=h.add(p)),p=p.double(),t>>=kr;return h}let{k1neg:s,k1:o,k2neg:a,k2:c}=Oq(t),u=n,l=n,d=this;for(;o>Ct||c>Ct;)o&kr&&(u=u.add(d)),c&kr&&(l=l.add(d)),d=d.double(),o>>=kr,c>>=kr;return s&&(u=u.negate()),a&&(l=l.negate()),l=new Qt(ke(l.x*fr.beta),l.y,l.z),u.add(l)}precomputeWindow(e){let t=H4?128/e+1:256/e+1,i=[],n=this,s=n;for(let o=0;o<t;o++){s=n,i.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(n),i.push(s);n=s.double()}return i}wNAF(e,t){!t&&this.equals(Qt.BASE)&&(t=Zt.BASE);let i=t&&t._WINDOW_SIZE||1;if(256%i)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=t&&SE.get(t);n||(n=this.precomputeWindow(i),t&&i!==1&&(n=Qt.normalizeZ(n),SE.set(t,n)));let s=Qt.ZERO,o=Qt.ZERO,a=1+(H4?128/i:256/i),c=2**(i-1),u=BigInt(2**i-1),l=2**i,d=BigInt(i);for(let h=0;h<a;h++){let p=h*c,y=Number(e&u);if(e>>=d,y>c&&(y-=l,e+=kr),y===0){let g=n[p];h%2&&(g=g.negate()),o=o.add(g)}else{let g=n[p+Math.abs(y)-1];y<0&&(g=g.negate()),s=s.add(g)}}return{p:s,f:o}}multiply(e,t){let i=Pq(e),n,s;if(H4){let{k1neg:o,k1:a,k2neg:c,k2:u}=Oq(i),{p:l,f:d}=this.wNAF(a,t),{p:h,f:p}=this.wNAF(u,t);o&&(l=l.negate()),c&&(h=h.negate()),h=new Qt(ke(h.x*fr.beta),h.y,h.z),n=l.add(h),s=d.add(p)}else{let{p:o,f:a}=this.wNAF(i,t);n=o,s=a}return Qt.normalizeZ([n,s])[0]}toAffine(e=a2(this.z)){let{x:t,y:i,z:n}=this,s=e,o=ke(s*s),a=ke(o*s),c=ke(t*o),u=ke(i*a);if(ke(n*s)!==kr)throw new Error("invZ was invalid");return new Zt(c,u)}};Qt.BASE=new Qt(fr.Gx,fr.Gy,kr);Qt.ZERO=new Qt(Ct,kr,Ct);var SE=new WeakMap,Zt=class{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,SE.delete(this)}static fromCompressedHex(e){let t=e.length===32,i=Qs(t?e:e.subarray(1));if(!W4(i))throw new Error("Point is not on curve");let n=xq(i),s=u9e(n),o=(s&kr)===kr;t?o&&(s=ke(-s)):(e[0]&1)==1!==o&&(s=ke(-s));let a=new Zt(i,s);return a.assertValidity(),a}static fromUncompressedHex(e){let t=Qs(e.subarray(1,33)),i=Qs(e.subarray(33,65)),n=new Zt(t,i);return n.assertValidity(),n}static fromHex(e){let t=za(e),i=t.length,n=t[0];if(i===32||i===33&&(n===2||n===3))return this.fromCompressedHex(t);if(i===65&&n===4)return this.fromUncompressedHex(t);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${i}`)}static fromPrivateKey(e){return Zt.BASE.multiply(Np(e))}static fromSignature(e,t,i){e=za(e);let n=kq(e),{r:s,s:o}=Nq(t);if(i!==0&&i!==1)throw new Error("Cannot recover signature: invalid recovery bit");if(n===Ct)throw new Error("Cannot recover signature: msgHash cannot be 0");let a=i&1?"03":"02",c=Zt.fromHex(a+Jc(s)),{n:u}=fr,l=a2(s,u),d=ke(-n*l,u),h=ke(o*l,u),p=Zt.BASE.multiplyAndAddUnsafe(c,d,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(e=!1){return bl(this.toHex(e))}toHex(e=!1){let t=Jc(this.x);return e?`${this.y&kr?"03":"02"}${t}`:`04${t}${Jc(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:t,y:i}=this;if(!W4(t)||!W4(i))throw new Error(e);let n=ke(i*i),s=xq(t);if(ke(n-s)!==Ct)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Zt(this.x,ke(-this.y))}double(){return Qt.fromAffine(this).double().toAffine()}add(e){return Qt.fromAffine(this).add(Qt.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Qt.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,t,i){let s=Qt.fromAffine(this).multiply(t),o=Qt.fromAffine(e).multiplyUnsafe(i),a=s.add(o);return a.equals(Qt.ZERO)?void 0:a.toAffine()}};Bt.Point=Zt;Zt.BASE=new Zt(fr.Gx,fr.Gy);Zt.ZERO=new Zt(Ct,Ct);function Iq(r){return Number.parseInt(r[0],16)>=8?"00"+r:r}function Tq(r){if(r.length<2||r[0]!==2)throw new Error(`Invalid signature integer tag: ${kp(r)}`);let e=r[1],t=r.subarray(2,e+2);if(!e||t.length!==e)throw new Error("Invalid signature integer: wrong length");if(t[0]===0&&t[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Qs(t),left:r.subarray(e+2)}}function a9e(r){if(r.length<2||r[0]!=48)throw new Error(`Invalid signature tag: ${kp(r)}`);if(r[1]!==r.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:t}=Tq(r.subarray(2)),{data:i,left:n}=Tq(t);if(n.length)throw new Error(`Invalid signature: left bytes after parsing: ${kp(n)}`);return{r:e,s:i}}var Va=class{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromCompact(e){let t=s2(e),i="Signature.fromCompact";if(typeof e!="string"&&!t)throw new TypeError(`${i}: Expected string or Uint8Array`);let n=t?kp(e):e;if(n.length!==128)throw new Error(`${i}: Expected 64-byte hex`);return new Va($4(n.slice(0,64)),$4(n.slice(64,128)))}static fromDER(e){let t=s2(e);if(typeof e!="string"&&!t)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:i,s:n}=a9e(t?e:bl(e));return new Va(i,n)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:t}=this;if(!Dp(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Dp(t))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=fr.n>>kr;return this.s>e}normalizeS(){return this.hasHighS()?new Va(this.r,fr.n-this.s):this}toDERRawBytes(e=!1){return bl(this.toDERHex(e))}toDERHex(e=!1){let t=Iq(o2(this.s));if(e)return t;let i=Iq(o2(this.r)),n=o2(i.length/2),s=o2(t.length/2);return`30${o2(i.length/2+t.length/2+4)}02${n}${i}02${s}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return bl(this.toCompactHex())}toCompactHex(){return Jc(this.r)+Jc(this.s)}};Bt.Signature=Va;function RE(...r){if(!r.every(s2))throw new Error("Uint8Array list expected");if(r.length===1)return r[0];let e=r.reduce((i,n)=>i+n.length,0),t=new Uint8Array(e);for(let i=0,n=0;i<r.length;i++){let s=r[i];t.set(s,n),n+=s.length}return t}function s2(r){return r instanceof Uint8Array}var c9e=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function kp(r){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let t=0;t<r.length;t++)e+=c9e[r[t]];return e}function Jc(r){if(r>EE)throw new Error("Expected number < 2^256");return r.toString(16).padStart(64,"0")}function AE(r){return bl(Jc(r))}function o2(r){let e=r.toString(16);return e.length&1?`0${e}`:e}function $4(r){if(typeof r!="string")throw new TypeError("hexToNumber: expected string, got "+typeof r);return BigInt(`0x${r}`)}function bl(r){if(typeof r!="string")throw new TypeError("hexToBytes: expected string, got "+typeof r);if(r.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+r.length);let e=new Uint8Array(r.length/2);for(let t=0;t<e.length;t++){let i=t*2,n=r.slice(i,i+2),s=Number.parseInt(n,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[t]=s}return e}function Qs(r){return $4(kp(r))}function za(r){return r instanceof Uint8Array?Uint8Array.from(r):bl(r)}function Pq(r){if(typeof r=="number"&&Number.isSafeInteger(r)&&r>0)return BigInt(r);if(typeof r=="bigint"&&Dp(r))return r;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function ke(r,e=fr.P){let t=r%e;return t>=Ct?t:e+t}function Zs(r,e){let{P:t}=fr,i=r;for(;e-- >Ct;)i*=i,i%=t;return i}function u9e(r){let{P:e}=fr,t=BigInt(6),i=BigInt(11),n=BigInt(22),s=BigInt(23),o=BigInt(44),a=BigInt(88),c=r*r*r%e,u=c*c*r%e,l=Zs(u,n2)*u%e,d=Zs(l,n2)*u%e,h=Zs(d,pi)*c%e,p=Zs(h,i)*h%e,y=Zs(p,n)*p%e,g=Zs(y,o)*y%e,w=Zs(g,a)*g%e,b=Zs(w,o)*y%e,v=Zs(b,n2)*u%e,A=Zs(v,s)*p%e,k=Zs(A,t)*c%e;return Zs(k,pi)}function a2(r,e=fr.P){if(r===Ct||e<=Ct)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=ke(r,e),i=e,n=Ct,s=kr,o=kr,a=Ct;for(;t!==Ct;){let u=i/t,l=i%t,d=n-o*u,h=s-a*u;i=t,t=l,n=o,s=a,o=d,a=h}if(i!==kr)throw new Error("invert: does not exist");return ke(n,e)}function l9e(r,e=fr.P){let t=new Array(r.length),i=r.reduce((s,o,a)=>o===Ct?s:(t[a]=s,ke(s*o,e)),kr),n=a2(i,e);return r.reduceRight((s,o,a)=>o===Ct?s:(t[a]=ke(s*t[a],e),ke(s*o,e)),n),t}var Cq=(r,e)=>(r+e/pi)/e,G4=pi**BigInt(128);function Oq(r){let{n:e}=fr,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),i=-kr*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=t,o=Cq(s*r,e),a=Cq(-i*r,e),c=ke(r-o*t-a*n,e),u=ke(-o*i-a*s,e),l=c>G4,d=u>G4;if(l&&(c=e-c),d&&(u=e-u),c>G4||u>G4)throw new Error("splitScalarEndo: Endomorphism failed, k="+r);return{k1neg:l,k1:c,k2neg:d,k2:u}}function kq(r){let{n:e}=fr,i=r.length*8-256,n=Qs(r);return i>0&&(n=n>>BigInt(i)),n>=e&&(n-=e),n}var xE=class{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return Bt.utils.hmacSha256(this.k,...e)}hmacSync(...e){if(typeof Bt.utils.hmacSha256Sync!="function")throw new Error("utils.hmacSha256Sync is undefined, you need to set it");let t=Bt.utils.hmacSha256Sync(this.k,...e);if(t instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");return t}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.incr(),this.v=this.hmacSync(this.v),this.v}};function Dp(r){return Ct<r&&r<fr.n}function W4(r){return Ct<r&&r<fr.P}function Dq(r,e,t){let i=Qs(r);if(!Dp(i))return;let{n}=fr,s=Zt.BASE.multiply(i),o=ke(s.x,n);if(o===Ct)return;let a=ke(a2(i,n)*ke(e+t*o,n),n);if(a===Ct)return;let c=new Va(o,a),u=(s.x===c.r?0:2)|Number(s.y&kr);return{sig:c,recovery:u}}function Np(r){let e;if(typeof r=="bigint")e=r;else if(typeof r=="number"&&Number.isSafeInteger(r)&&r>0)e=BigInt(r);else if(typeof r=="string"){if(r.length!==64)throw new Error("Expected 32 bytes of private key");e=$4(r)}else if(s2(r)){if(r.length!==32)throw new Error("Expected 32 bytes of private key");e=Qs(r)}else throw new TypeError("Expected valid private key");if(!Dp(e))throw new Error("Expected private key: 0 < key < n");return e}function IE(r){return r instanceof Zt?(r.assertValidity(),r):Zt.fromHex(r)}function Nq(r){if(r instanceof Va)return r.assertValidity(),r;try{return Va.fromDER(r)}catch(e){return Va.fromCompact(r)}}function f9e(r,e=!1){return Zt.fromPrivateKey(r).toRawBytes(e)}Bt.getPublicKey=f9e;function d9e(r,e,t,i=!1){return Zt.fromSignature(r,e,t).toRawBytes(i)}Bt.recoverPublicKey=d9e;function Bq(r){let e=s2(r),t=typeof r=="string",i=(e||t)&&r.length;return e?i===33||i===65:t?i===66||i===130:r instanceof Zt}function h9e(r,e,t=!1){if(Bq(r))throw new TypeError("getSharedSecret: first arg must be private key");if(!Bq(e))throw new TypeError("getSharedSecret: second arg must be public key");let i=IE(e);return i.assertValidity(),i.multiply(Np(r)).toRawBytes(t)}Bt.getSharedSecret=h9e;function Lq(r){let e=r.length>32?r.slice(0,32):r;return Qs(e)}function p9e(r){let e=Lq(r),t=ke(e,fr.n);return Mq(t<Ct?e:t)}function Mq(r){if(typeof r!="bigint")throw new Error("Expected bigint");let e=Jc(r);return bl(e)}function jq(r,e,t){if(r==null)throw new Error(`sign: expected valid message hash, not "${r}"`);let i=za(r),n=Np(e),s=[Mq(n),p9e(i)];if(t!=null){t===!0&&(t=Bt.utils.randomBytes(32));let c=za(t);if(c.length!==32)throw new Error("sign: Expected 32 bytes of extra data");s.push(c)}let o=RE(...s),a=Lq(i);return{seed:o,m:a,d:n}}function qq(r,e){let{sig:t,recovery:i}=r,{canonical:n,der:s,recovered:o}=Object.assign({canonical:!0,der:!0},e);n&&t.hasHighS()&&(t=t.normalizeS(),i^=1);let a=s?t.toDERRawBytes():t.toCompactRawBytes();return o?[a,i]:a}async function y9e(r,e,t={}){let{seed:i,m:n,d:s}=jq(r,e,t.extraEntropy),o,a=new xE;for(await a.reseed(i);!(o=Dq(await a.generate(),n,s));)await a.reseed();return qq(o,t)}Bt.sign=y9e;function g9e(r,e,t={}){let{seed:i,m:n,d:s}=jq(r,e,t.extraEntropy),o,a=new xE;for(a.reseedSync(i);!(o=Dq(a.generateSync(),n,s));)a.reseedSync();return qq(o,t)}Bt.signSync=g9e;var m9e={strict:!0};function b9e(r,e,t,i=m9e){let n;try{n=Nq(r),e=za(e)}catch(g){return!1}let{r:s,s:o}=n;if(i.strict&&n.hasHighS())return!1;let a=kq(e);if(a===Ct)return!1;let c;try{c=IE(t)}catch(g){return!1}let{n:u}=fr,l=a2(o,u),d=ke(a*l,u),h=ke(s*l,u),p=Zt.BASE.multiplyAndAddUnsafe(c,d,h);return p?ke(p.x,u)===s:!1}Bt.verify=b9e;async function TE(r,...e){let t=new Uint8Array(r.split("").map(s=>s.charCodeAt(0))),i=await Bt.utils.sha256(t),n=await Bt.utils.sha256(RE(i,i,...e));return Qs(n)}async function Uq(r,e,t){let i=AE(r),n=await TE("BIP0340/challenge",i,e.toRawX(),t);return ke(n,fr.n)}function PE(r){return(r.y&kr)===Ct}var Zf=class{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromHex(e){let t=za(e);if(t.length!==64)throw new TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${t.length}`);let i=Qs(t.subarray(0,32)),n=Qs(t.subarray(32,64));return new Zf(i,n)}assertValidity(){let{r:e,s:t}=this;if(!W4(e)||!Dp(t))throw new Error("Invalid signature")}toHex(){return Jc(this.r)+Jc(this.s)}toRawBytes(){return bl(this.toHex())}};function w9e(r){return Zt.fromPrivateKey(r).toRawX()}async function _9e(r,e,t=Bt.utils.randomBytes()){if(r==null)throw new TypeError(`sign: Expected valid message, not "${r}"`);let{n:i}=fr,n=za(r),s=Np(e),o=za(t);if(o.length!==32)throw new TypeError("sign: Expected 32 bytes of aux randomness");let a=Zt.fromPrivateKey(s),c=PE(a)?s:i-s,u=await TE("BIP0340/aux",o),l=c^u,d=await TE("BIP0340/nonce",AE(l),a.toRawX(),n),h=ke(d,i);if(h===Ct)throw new Error("sign: Creation of signature failed. k is zero");let p=Zt.fromPrivateKey(h),y=PE(p)?h:i-h,g=await Uq(p.x,a,n),w=new Zf(p.x,ke(y+g*c,i)).toRawBytes();if(!await Fq(w,n,a.toRawX()))throw new Error("sign: Invalid signature produced");return w}async function Fq(r,e,t){let i=r instanceof Zf,n;try{n=i?r:Zf.fromHex(r),i&&n.assertValidity()}catch(d){return!1}let{r:s,s:o}=n,a=za(e),c;try{c=IE(t)}catch(d){return!1}let u=await Uq(s,c,a),l=Zt.BASE.multiplyAndAddUnsafe(c,Np(o),ke(-u,fr.n));return!(!l||!PE(l)||l.x!==s)}Bt.schnorr={Signature:Zf,getPublicKey:w9e,sign:_9e,verify:Fq};Zt.BASE._setWindowSize(8);var _s={node:s9e.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};Bt.utils={isValidPrivateKey(r){try{return Np(r),!0}catch(e){return!1}},hashToPrivateKey:r=>{if(r=za(r),r.length<40||r.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=ke(Qs(r),fr.n);if(e===Ct||e===kr)throw new Error("Invalid private key");return AE(e)},randomBytes:(r=32)=>{if(_s.web)return _s.web.getRandomValues(new Uint8Array(r));if(_s.node){let{randomBytes:e}=_s.node;return Uint8Array.from(e(r))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Bt.utils.hashToPrivateKey(Bt.utils.randomBytes(40)),bytesToHex:kp,mod:ke,sha256:async r=>{if(_s.web){let e=await _s.web.subtle.digest("SHA-256",r.buffer);return new Uint8Array(e)}else if(_s.node){let{createHash:e}=_s.node;return Uint8Array.from(e("sha256").update(r).digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(r,...e)=>{if(_s.web){let t=await _s.web.subtle.importKey("raw",r,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),i=RE(...e),n=await _s.web.subtle.sign("HMAC",t,i);return new Uint8Array(n)}else if(_s.node){let{createHmac:t}=_s.node,i=t("sha256",r);return e.forEach(n=>i.update(n)),Uint8Array.from(i.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,precompute(r=8,e=Zt.BASE){let t=e===Zt.BASE?e:new Zt(e.x,e.y);return t._setWindowSize(r),t.multiply(n2),t}}});var Hq=m((Gnt,zq)=>{f();"use strict";var c2=Ys(),wl=Kq(),{sha256:Vq}=(vi(),Ks);zq.exports=()=>{let r=32;function e(){return wl.utils.randomPrivateKey()}async function t(u,l){let{digest:d}=await Vq.digest(l);try{return await wl.sign(d,u)}catch(h){throw c2(h,"ERR_INVALID_INPUT")}}async function i(u,l,d){try{let{digest:h}=await Vq.digest(d);return wl.verify(l,h,u)}catch(h){throw c2(h,"ERR_INVALID_INPUT")}}function n(u){return wl.Point.fromHex(u).toRawBytes(!0)}function s(u){return wl.Point.fromHex(u).toRawBytes(!1)}function o(u){try{wl.getPublicKey(u,!0)}catch(l){throw c2(l,"ERR_INVALID_PRIVATE_KEY")}}function a(u){try{wl.Point.fromHex(u)}catch(l){throw c2(l,"ERR_INVALID_PUBLIC_KEY")}}function c(u){try{return wl.getPublicKey(u,!0)}catch(l){throw c2(l,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:e,privateKeyLength:r,hashAndSign:t,hashAndVerify:i,compressPublicKey:n,decompressPublicKey:s,validatePrivateKey:o,validatePublicKey:a,computePublicKey:c}}});var Yq=m((Wnt,Wq)=>{f();"use strict";var{sha256:$q}=(vi(),Ks),v9e=Ys(),{equals:Gq}=(hi(),dn),{toString:E9e}=(tt(),sr),S9e=L4();Wq.exports=(r,e,t)=>{t=t||Hq()();class i{constructor(u){t.validatePublicKey(u),this._key=u}verify(u,l){return t.hashAndVerify(this._key,l,u)}marshal(){return t.compressPublicKey(this._key)}get bytes(){return r.PublicKey.encode({Type:r.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return Gq(this.bytes,u.bytes)}async hash(){let{bytes:u}=await $q.digest(this.bytes);return u}}class n{constructor(u,l){this._key=u,this._publicKey=l||t.computePublicKey(u),t.validatePrivateKey(this._key),t.validatePublicKey(this._publicKey)}sign(u){return t.hashAndSign(this._key,u)}get public(){return new i(this._publicKey)}marshal(){return this._key}get bytes(){return r.PrivateKey.encode({Type:r.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return Gq(this.bytes,u.bytes)}async hash(){let{bytes:u}=await $q.digest(this.bytes);return u}async id(){let u=await this.public.hash();return E9e(u,"base58btc")}async export(u,l="libp2p-key"){if(l==="libp2p-key")return S9e.export(this.bytes,u);throw v9e(new Error(`export format '${l}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(c){return new n(c)}function o(c){return new i(c)}async function a(){let c=await t.generateKey();return new n(c)}return{Secp256k1PublicKey:i,Secp256k1PrivateKey:n,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:a}}});var Qq=m((Ynt,Xq)=>{f();"use strict";Xq.exports={SHA1:20,SHA256:32,SHA512:64}});var CE=m(Jq=>{f();"use strict";var Zq=Wy(),R9e=Qq(),A9e={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},x9e=async(r,e)=>{let t=await Zq.get().subtle.sign({name:"HMAC"},r,e);return new Uint8Array(t,t.byteOffset,t.byteLength)};Jq.create=async function(r,e){let t=A9e[r],i=await Zq.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:t}},!1,["sign"]);return{async digest(n){return x9e(i,n)},length:R9e[r]}}});var nU=m((Qnt,iU)=>{f();"use strict";var eU=Ys(),{concat:tU}=(Si(),Pn),{fromString:I9e}=(ct(),Qr),T9e=CE(),rU={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};iU.exports=async(r,e,t)=>{let i=rU[r];if(!i){let v=Object.keys(rU).join(" / ");throw eU(new Error(`unknown cipher type '${r}'. Must be ${v}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw eU(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let n=i.keySize,s=i.ivSize,o=20,a=I9e("key expansion"),c=2*(s+n+o),u=await T9e.create(e,t),l=await u.digest(a),d=[],h=0;for(;h<c;){let v=await u.digest(tU([l,a])),A=v.length;h+A>c&&(A=c-h),d.push(v),h+=A,l=await u.digest(l)}let p=c/2,y=tU(d),g=y.slice(0,p),w=y.slice(p,c),b=v=>({iv:v.slice(0,s),cipherKey:v.slice(s,s+n),macKey:v.slice(s+n)});return{k1:b(g),k2:b(w)}}});var oU=m((Znt,sU)=>{f();"use strict";var P9e=Ys();sU.exports=function(r,e){if(!r.includes(e)){let t=r.join(" / ");throw P9e(new Error(`Unknown curve: ${e}. Must be ${t}`),"ERR_INVALID_CURVE")}}});var dU=m(fU=>{f();"use strict";var C9e=Ys(),u2=Wy(),{base64urlToBuffer:aU}=B4(),O9e=oU(),{toString:OE}=(tt(),sr),{concat:k9e}=(Si(),Pn),{equals:D9e}=(hi(),dn),cU={"P-256":256,"P-384":384,"P-521":521};fU.generateEphmeralKeyPair=async function(r){O9e(Object.keys(cU),r);let e=await u2.get().subtle.generateKey({name:"ECDH",namedCurve:r},!0,["deriveBits"]),t=async(n,s)=>{let o;s?o=await u2.get().subtle.importKey("jwk",B9e(r,s),{name:"ECDH",namedCurve:r},!1,["deriveBits"]):o=e.privateKey;let a=[await u2.get().subtle.importKey("jwk",lU(r,n),{name:"ECDH",namedCurve:r},!1,[]),o],c=await u2.get().subtle.deriveBits({name:"ECDH",namedCurve:r,public:a[0]},a[1],cU[r]);return new Uint8Array(c,c.byteOffset,c.byteLength)},i=await u2.get().subtle.exportKey("jwk",e.publicKey);return{key:N9e(i),genSharedKey:t}};var uU={"P-256":32,"P-384":48,"P-521":66};function N9e(r){let e=uU[r.crv];return k9e([Uint8Array.from([4]),aU(r.x,e),aU(r.y,e)],1+e*2)}function lU(r,e){let t=uU[r];if(D9e(!e.slice(0,1),Uint8Array.from([4])))throw C9e(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:r,x:OE(e.slice(1,t+1),"base64url"),y:OE(e.slice(1+t),"base64url"),ext:!0}}var B9e=(r,e)=>({...lU(r,e.public),d:OE(e.private,"base64url")})});var pU=m((est,hU)=>{f();"use strict";var L9e=dU();hU.exports=async r=>L9e.generateEphmeralKeyPair(r)});var X4=m((tst,gU)=>{f();"use strict";var Ha=g4();ul();fE();var kE=Rt(),l2=Ys(),{fromString:M9e}=(ct(),Qr),j9e=Mj(),Js={rsa:cq(),ed25519:Aq(),secp256k1:Yq()(Ha,Xy())},Y4={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function Bp(r){let e=Js[r.toLowerCase()];if(!e){let t=Object.keys(Js).join(" / ");throw l2(new Error(`invalid or unsupported key type ${r}. Must be ${t}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var q9e=async(r,e)=>Bp(r).generateKeyPair(e),U9e=async(r,e,t)=>{let i=Bp(r);if(r.toLowerCase()!=="ed25519")throw l2(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return i.generateKeyPairFromSeed(e,t)},F9e=r=>{let e=Ha.PublicKey.decode(r),t=e.Data;switch(e.Type){case Ha.KeyType.RSA:return Js.rsa.unmarshalRsaPublicKey(t);case Ha.KeyType.Ed25519:return Js.ed25519.unmarshalEd25519PublicKey(t);case Ha.KeyType.Secp256k1:if(Js.secp256k1)return Js.secp256k1.unmarshalSecp256k1PublicKey(t);throw l2(new Error(Y4.message),Y4.code);default:Bp(e.Type)}},K9e=(r,e)=>(e=(e||"rsa").toLowerCase(),Bp(e),r.bytes),yU=async r=>{let e=Ha.PrivateKey.decode(r),t=e.Data;switch(e.Type){case Ha.KeyType.RSA:return Js.rsa.unmarshalRsaPrivateKey(t);case Ha.KeyType.Ed25519:return Js.ed25519.unmarshalEd25519PrivateKey(t);case Ha.KeyType.Secp256k1:if(Js.secp256k1)return Js.secp256k1.unmarshalSecp256k1PrivateKey(t);throw l2(new Error(Y4.message),Y4.code);default:Bp(e.Type)}},V9e=(r,e)=>(e=(e||"rsa").toLowerCase(),Bp(e),r.bytes),z9e=async(r,e)=>{try{let n=await j9e.import(r,e);return yU(n)}catch(n){}let t=kE.pki.decryptRsaPrivateKey(r,e);if(t===null)throw l2(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let i=kE.asn1.toDer(kE.pki.privateKeyToAsn1(t));return i=M9e(i.getBytes(),"ascii"),Js.rsa.unmarshalRsaPrivateKey(i)};gU.exports={supportedKeys:Js,keysPBM:Ha,keyStretcher:nU(),generateEphemeralKeyPair:pU(),generateKeyPair:q9e,generateKeyPairFromSeed:U9e,unmarshalPublicKey:F9e,marshalPublicKey:K9e,unmarshalPrivateKey:yU,marshalPrivateKey:V9e,import:z9e}});var Q4=m((rst,DE)=>{f();"use strict";function H9e(r,{className:e,symbolName:t}){let i=Symbol.for(t),n={[e]:class extends r{constructor(...s){super(...s);Object.defineProperty(this,i,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return n[`is${e}`]=s=>!!(s&&s[i]),n}function $9e(r,{className:e,symbolName:t,withoutNew:i}){let n=Symbol.for(t),s={[e]:function(...o){if(i&&!(this instanceof s))return new s(...o);let a=r.call(this,...o)||this;return a&&!a[n]&&Object.defineProperty(a,n,{value:!0}),a}}[e];return s.prototype=Object.create(r.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=o=>!!(o&&o[n]),s}DE.exports=H9e;DE.exports.proto=$9e});var wU=m((ist,bU)=>{f();"use strict";var Lp=Br(),mU=Lp.Reader,G9e=Lp.Writer,Bi=Lp.util,f2=Lp.roots["libp2p-peer-id"]||(Lp.roots["libp2p-peer-id"]={});f2.PeerIdProto=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.id=Bi.newBuffer([]),r.prototype.pubKey=Bi.newBuffer([]),r.prototype.privKey=Bi.newBuffer([]),r.encode=function(t,i){return i||(i=G9e.create()),i.uint32(10).bytes(t.id),t.pubKey!=null&&Object.hasOwnProperty.call(t,"pubKey")&&i.uint32(18).bytes(t.pubKey),t.privKey!=null&&Object.hasOwnProperty.call(t,"privKey")&&i.uint32(26).bytes(t.privKey),i},r.decode=function(t,i){t instanceof mU||(t=mU.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new f2.PeerIdProto;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.id=t.bytes();break;case 2:s.pubKey=t.bytes();break;case 3:s.privKey=t.bytes();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("id"))throw Bi.ProtocolError("missing required 'id'",{instance:s});return s},r.fromObject=function(t){if(t instanceof f2.PeerIdProto)return t;var i=new f2.PeerIdProto;return t.id!=null&&(typeof t.id=="string"?Bi.base64.decode(t.id,i.id=Bi.newBuffer(Bi.base64.length(t.id)),0):t.id.length&&(i.id=t.id)),t.pubKey!=null&&(typeof t.pubKey=="string"?Bi.base64.decode(t.pubKey,i.pubKey=Bi.newBuffer(Bi.base64.length(t.pubKey)),0):t.pubKey.length&&(i.pubKey=t.pubKey)),t.privKey!=null&&(typeof t.privKey=="string"?Bi.base64.decode(t.privKey,i.privKey=Bi.newBuffer(Bi.base64.length(t.privKey)),0):t.privKey.length&&(i.privKey=t.privKey)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.id="":(n.id=[],i.bytes!==Array&&(n.id=Bi.newBuffer(n.id))),i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=Bi.newBuffer(n.pubKey))),i.bytes===String?n.privKey="":(n.privKey=[],i.bytes!==Array&&(n.privKey=Bi.newBuffer(n.privKey)))),t.id!=null&&t.hasOwnProperty("id")&&(n.id=i.bytes===String?Bi.base64.encode(t.id,0,t.id.length):i.bytes===Array?Array.prototype.slice.call(t.id):t.id),t.pubKey!=null&&t.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?Bi.base64.encode(t.pubKey,0,t.pubKey.length):i.bytes===Array?Array.prototype.slice.call(t.pubKey):t.pubKey),t.privKey!=null&&t.hasOwnProperty("privKey")&&(n.privKey=i.bytes===String?Bi.base64.encode(t.privKey,0,t.privKey.length):i.bytes===Array?Array.prototype.slice.call(t.privKey):t.privKey),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Lp.util.toJSONOptions)},r}();bU.exports=f2});var ot=m((mn,IU)=>{f();"use strict";var{CID:NE}=(we(),Fc),W9e=(en(),Uc),Y9e=(Iy(),V3),X9e=(di(),Uo),Q9e=(Zu(),Mf),{base58btc:BE}=(di(),Uo),{base32:Z9e}=(en(),Uc),{base16:_U}=(Yv(),K3),d2=(Ji(),Wh),$a=X4(),J9e=Q4(),{PeerIdProto:vU}=wU(),{equals:Jf}=(hi(),dn),{fromString:h2}=(ct(),Qr),{toString:eSe}=(tt(),sr),{identity:Z4}=(zc(),xy),EU={...W9e,...Y9e,...X9e,...Q9e},tSe=Object.keys(EU).reduce((r,e)=>r.or(EU[e]),Z9e.decoder),rSe=112,SU=114,RU=class{constructor(e,t,i){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(t&&i&&!Jf(t.public.bytes,i.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=BE.encode(this.id).substring(1),this._privKey=t,this._pubKey=i}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=d2.decode(this.id);e.code===Z4.code&&(this._pubKey=$a.unmarshalPublicKey(e.digest))}catch(e){}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return $a.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return $a.marshalPrivateKey(this.privKey)}marshal(e){return vU.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()}).finish()}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let t=6;return e.length<t&&(t=e.length),"<peer.ID "+e.substr(0,t)+">"}toJSON(){return{id:this.toB58String(),privKey:xU(this.marshalPrivKey()),pubKey:xU(this.marshalPubKey())}}toHexString(){return _U.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=NE.createV1(SU,d2.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:e.toString(),enumerable:!1})}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return Jf(this.id,e);if(e.id)return Jf(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&Jf(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(d2.decode(this.id).code===Z4.code)return!0}catch(e){}return!1}},Ga=J9e(RU,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});mn=IU.exports=Ga;var p2=r=>r.bytes.length<=42?d2.create(Z4.code,r.bytes).bytes:r.hash(),LE=async(r,e)=>{let t=await p2(e);return new Ga(t,r,e)};mn.create=async r=>{r=r||{},r.bits=r.bits||2048,r.keyType=r.keyType||"RSA";let e=await $a.generateKeyPair(r.keyType,r.bits);return LE(e,e.public)};mn.createFromHexString=r=>new Ga(_U.decode("f"+r));mn.createFromBytes=r=>{try{let e=NE.decode(r);if(!AU(e))throw new Error("Supplied PeerID CID is invalid");return mn.createFromCID(e)}catch{if(d2.decode(r).code!==Z4.code)throw new Error("Supplied PeerID CID is invalid");return new Ga(r)}};mn.createFromB58String=r=>mn.createFromBytes(BE.decode("z"+r));var AU=r=>r.code===SU||r.code===rSe;mn.createFromCID=r=>{if(r=NE.asCID(r),!r||!AU(r))throw new Error("Supplied PeerID CID is invalid");return new Ga(r.multihash.bytes)};mn.createFromPubKey=async r=>{let e=r;if(typeof e=="string"&&(e=h2(r,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let t=await $a.unmarshalPublicKey(e);return LE(void 0,t)};mn.createFromPrivKey=async r=>{if(typeof r=="string"&&(r=h2(r,"base64pad")),!(r instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await $a.unmarshalPrivateKey(r);return LE(e,e.public)};mn.createFromJSON=async r=>{let e=BE.decode("z"+r.id),t=r.privKey&&h2(r.privKey,"base64pad"),i=r.pubKey&&h2(r.pubKey,"base64pad"),n=i&&await $a.unmarshalPublicKey(i);if(!t)return new Ga(e,void 0,n);let s=await $a.unmarshalPrivateKey(t),o=await p2(s.public),a;if(n&&(a=await p2(n)),n&&!Jf(o,a))throw new Error("Public and private key do not match");if(e&&!Jf(o,e))throw new Error("Id and private key do not match");return new Ga(e,s,n)};mn.createFromProtobuf=async r=>{typeof r=="string"&&(r=h2(r,"base16"));let{id:e,privKey:t,pubKey:i}=vU.decode(r);t=t?await $a.unmarshalPrivateKey(t):!1,i=i?await $a.unmarshalPublicKey(i):!1;let n,s;if(t&&(s=await p2(t.public)),i&&(n=await p2(i)),t){if(i&&!Jf(s,n))throw new Error("Public and private key do not match");return new Ga(s,t,t.public)}if(i)return new Ga(n,void 0,i);if(e)return new Ga(e);throw new Error("Protobuf did not contain any usable key material")};mn.parse=r=>((r.charAt(0)==="1"||r.charAt(0)==="Q")&&(r=`z${r}`),mn.createFromBytes(tSe.decode(r)));mn.isPeerId=r=>Boolean(typeof r=="object"&&r._id&&r._idB58String);function xU(r){if(r)return eSe(r,"base64pad")}});var Qn=m((cst,CU)=>{f();"use strict";var nSe=async r=>{let e;for await(let t of r)e=t;return e};CU.exports=nSe});var UU=m((Lst,qU)=>{f();"use strict";function jU(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function sSe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return jU(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),jU(new n,t)}}qU.exports=sSe});var UE={};Tt(UE,{abortedError:()=>oSe,dbDeleteFailedError:()=>m2,dbOpenFailedError:()=>g2,dbWriteFailedError:()=>b2,notFoundError:()=>Ri});function g2(r){return r=r||new Error("Cannot open database"),(0,jp.default)(r,"ERR_DB_OPEN_FAILED")}function m2(r){return r=r||new Error("Delete failed"),(0,jp.default)(r,"ERR_DB_DELETE_FAILED")}function b2(r){return r=r||new Error("Write failed"),(0,jp.default)(r,"ERR_DB_WRITE_FAILED")}function Ri(r){return r=r||new Error("Not Found"),(0,jp.default)(r,"ERR_NOT_FOUND")}function oSe(r){return r=r||new Error("Aborted"),(0,jp.default)(r,"ERR_ABORTED")}var jp,eo=Ue(()=>{f();jp=R(UU())});var FU=m((jst,FE)=>{f();var Mst=function(){typeof FE!="undefined"&&(FE.exports=b);var r=24*3600,e=3200,t=(365*400+97)*e/400,i=r*t,n=i*1e3,s=1e3*1e4*1e4*r,o=16777216,a=65536*65536,c=1e3*1e3,u=1e3*1e3*1e3,l="000000000",d=Math.trunc||je,h=b.prototype;b.fromDate=M,b.fromInt64BE=De(0,1,2,3,0,4),b.fromInt64LE=De(3,2,1,0,4,0),b.fromString=j,b.fromTimeT=se,h.year=0,h.time=0,h.nano=0,h.addNano=T,h.getNano=D,h.getTimeT=fe,h.getYear=v,h.toDate=k,h.toJSON=pe,h.toString=Le,h.writeInt64BE=Re(0,1,2,3,0,4),h.writeInt64LE=Re(3,2,1,0,4,0);var p="%Y-%m-%dT%H:%M:%S.%NZ",y=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],w={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return b;function b(de,J,Ee){var qe=this;if(!(qe instanceof b))return new b(de,J,Ee);qe.time=+de||0,qe.nano=+J||0,qe.year=+Ee||0,A(qe)}function v(){var de=this.toDate().getUTCFullYear();return de+this.year}function A(de){var J=de.year,Ee=de.time,qe=de.nano,ze,Te;if(qe<0||c<=qe){var at=Math.floor(qe/c);qe-=at*c,Ee+=at,ze=1}var I=J%e;if(Ee<-s||s<Ee||I){Te=d(Ee/n),Te&&(J+=Te*e,Ee-=Te*n);var O=C(Ee);O.setUTCFullYear(I+O.getUTCFullYear()),J-=I,Ee=+O,Te=d(J/e);var N=Ee+Te*n;Te&&-s<=N&&N<=s&&(J-=Te*e,Ee=N),ze=1}return ze&&(de.year=J,de.time=Ee,de.nano=qe),de}function k(){var de=A(this);return C(de.time)}function C(de){var J=new Date(0);return J.setTime(de),J}function T(de){return this.nano+=+de||0,this}function D(){var de=A(this);return(de.time%1e3*c+ +de.nano+u)%u}function j(de){var J,Ee=new b;de+="";var qe=de.replace(/^\s*[+\-]?\d+/,function(ze){var Te=+ze,at=1970+(Te-1970)%400;return Ee.year=Te-at,at}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(ze,Te,at){return Te<0&&(at*=-1),J=(+Te*60+ +at)*6e4,""}).replace(/\.\d+$/,function(ze){return Ee.nano=+(ze+l).substr(1,9),""}).split(/\D+/);if(qe.length>1?qe[1]--:qe[1]=0,Ee.time=J=Date.UTC.apply(Date,qe)-(J||0),isNaN(J))throw new TypeError("Invalid Date");return A(Ee)}function M(de){return new b(+de)}function se(de){return ie(de,0)}function ie(de,J){J|=0,J*=a,de=+de||0;var Ee=d(J/i)+d(de/i),qe=J%i+de%i,ze=d(qe/i);return ze&&(Ee+=ze,qe-=ze*i),new b(qe*1e3,0,Ee*e)}function fe(){var de=A(this),J=Math.floor(de.time/1e3),Ee=de.year;return Ee&&(J+=Ee*t*r/e),J}function pe(){return this.toString().replace(/0{1,6}Z$/,"Z")}function Le(de){var J=this,Ee=J.toDate(),qe={H:N,L:W,M:Y,N:ee,S:F,Y:Te,a:V,b:X,d:I,e:O,m:at};return ze(de||p);function ze(re){return re.replace(/%./g,function(x){var B=x[1],G=w[B],Z=qe[B];return G?ze(G):Z?Z():x})}function Te(){var re=J.getYear();return re>999999?"+"+re:re>9999?"+"+Xe(re,6):re>=0?Xe(re,4):re>=-999999?"-"+Xe(-re,6):re}function at(){return Ye(Ee.getUTCMonth()+1)}function I(){return Ye(Ee.getUTCDate())}function O(){return ut(Ee.getUTCDate())}function N(){return Ye(Ee.getUTCHours())}function Y(){return Ye(Ee.getUTCMinutes())}function F(){return Ye(Ee.getUTCSeconds())}function W(){return Xe(Ee.getUTCMilliseconds(),3)}function ee(){return Xe(J.getNano(),9)}function V(){return g[Ee.getUTCDay()]}function X(){return y[Ee.getUTCMonth()]}}function Re(de,J,Ee,qe,ze,Te){return at;function at(O,N){var Y=A(this);O||(O=new Array(8)),ne(O,N|=0);var F=Math.floor(Y.time/1e3),W=Y.year*(t*r/e),ee=d(W/a)+d(F/a),V=W%a+F%a,X=Math.floor(V/a);return X&&(ee+=X,V-=X*a),I(O,N+ze,ee),I(O,N+Te,V),O}function I(O,N,Y){O[N+de]=Y>>24&255,O[N+J]=Y>>16&255,O[N+Ee]=Y>>8&255,O[N+qe]=Y&255}}function De(de,J,Ee,qe,ze,Te){return at;function at(O,N){ne(O,N|=0);var Y=I(O,N+ze),F=I(O,N+Te);return ie(F,Y)}function I(O,N){return O[N+de]*o+(O[N+J]<<16|O[N+Ee]<<8|O[N+qe])}}function ne(de,J){var Ee=de&&de.length;if(Ee==null)throw new TypeError("Invalid Buffer");if(Ee<J+8)throw new RangeError("Out of range")}function je(de){var J=de-de%1;return J===0&&(de<0||de===0&&1/de!=1/0)?-0:J}function ut(de){return(de>9?"":" ")+(de|0)}function Ye(de){return(de>9?"":"0")+(de|0)}function Xe(de,J){return(l+(de|0)).substr(-J)}}()});var zU=m((qst,VU)=>{f();"use strict";Ap();var J4=Rt(),{toString:qp}=(tt(),sr),{fromString:KU}=(ct(),Qr);VU.exports={createCipheriv:(r,e,t)=>{let i=J4.cipher.createCipher("AES-CTR",qp(e,"ascii"));return i.start({iv:qp(t,"ascii")}),{update:n=>(i.update(J4.util.createBuffer(qp(n,"ascii"))),KU(i.output.getBytes(),"ascii"))}},createDecipheriv:(r,e,t)=>{let i=J4.cipher.createDecipher("AES-CTR",qp(e,"ascii"));return i.start({iv:qp(t,"ascii")}),{update:n=>(i.update(J4.util.createBuffer(qp(n,"ascii"))),KU(i.output.getBytes(),"ascii"))}}}});var GU=m((Ust,$U)=>{f();"use strict";var aSe=Ys(),HU={16:"aes-128-ctr",32:"aes-256-ctr"};$U.exports=function(r){let e=HU[r.length];if(!e){let t=Object.entries(HU).map(([i,n])=>`${i} (${n})`).join(" / ");throw aSe(new Error(`Invalid key length ${r.length} bytes. Must be ${t}`),"ERR_INVALID_KEY_LENGTH")}return e}});var XU=m(YU=>{f();"use strict";var WU=zU(),cSe=GU();YU.create=async function(r,e){let t=cSe(r),i=WU.createCipheriv(t,r,e),n=WU.createDecipheriv(t,r,e);return{async encrypt(o){return i.update(o)},async decrypt(o){return n.update(o)}}}});var JU=m((Kst,ZU)=>{f();"use strict";var uSe=tE(),lSe=vr(),fSe=Ys(),QU={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function dSe(r,e,t,i,n){let s=QU[n];if(!s){let a=Object.keys(QU).join(" / ");throw fSe(new Error(`Hash '${n}' is unknown or not supported. Must be ${a}`),"ERR_UNSUPPORTED_HASH_TYPE")}let o=uSe(r,e,t,i,s);return lSe.encode64(o)}ZU.exports=dSe});var Ya=m(Up=>{f();"use strict";var hSe=CE(),pSe=XU(),ySe=X4();Up.aes=pSe;Up.hmac=hSe;Up.keys=ySe;Up.randomBytes=Xy();Up.pbkdf2=JU()});var rF=m((zst,tF)=>{f();"use strict";function eF(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function gSe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return eF(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),eF(new n,t)}}tF.exports=gSe});var hF=m((Hst,dF)=>{f();dF.exports=Sr;var to=null;try{to=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(r){}function Sr(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}Sr.prototype.__isLong__;Object.defineProperty(Sr.prototype,"__isLong__",{value:!0});function Zn(r){return(r&&r.__isLong__)===!0}Sr.isLong=Zn;var iF={},nF={};function ed(r,e){var t,i,n;return e?(r>>>=0,(n=0<=r&&r<256)&&(i=nF[r],i)?i:(t=Rr(r,(r|0)<0?-1:0,!0),n&&(nF[r]=t),t)):(r|=0,(n=-128<=r&&r<128)&&(i=iF[r],i)?i:(t=Rr(r,r<0?-1:0,!1),n&&(iF[r]=t),t))}Sr.fromInt=ed;function ro(r,e){if(isNaN(r))return e?td:io;if(e){if(r<0)return td;if(r>=oF)return fF}else{if(r<=-aF)return Jn;if(r+1>=aF)return lF}return r<0?ro(-r,e).neg():Rr(r%Fp|0,r/Fp|0,e)}Sr.fromNumber=ro;function Rr(r,e,t){return new Sr(r,e,t)}Sr.fromBits=Rr;var e6=Math.pow;function KE(r,e,t){if(r.length===0)throw Error("empty string");if(r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return io;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var i;if((i=r.indexOf("-"))>0)throw Error("interior hyphen");if(i===0)return KE(r.substring(1),e,t).neg();for(var n=ro(e6(t,8)),s=io,o=0;o<r.length;o+=8){var a=Math.min(8,r.length-o),c=parseInt(r.substring(o,o+a),t);if(a<8){var u=ro(e6(t,a));s=s.mul(u).add(ro(c))}else s=s.mul(n),s=s.add(ro(c))}return s.unsigned=e,s}Sr.fromString=KE;function Qo(r,e){return typeof r=="number"?ro(r,e):typeof r=="string"?KE(r,e):Rr(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}Sr.fromValue=Qo;var sF=1<<16,mSe=1<<24,Fp=sF*sF,oF=Fp*Fp,aF=oF/2,cF=ed(mSe),io=ed(0);Sr.ZERO=io;var td=ed(0,!0);Sr.UZERO=td;var Kp=ed(1);Sr.ONE=Kp;var uF=ed(1,!0);Sr.UONE=uF;var VE=ed(-1);Sr.NEG_ONE=VE;var lF=Rr(4294967295|0,2147483647|0,!1);Sr.MAX_VALUE=lF;var fF=Rr(4294967295|0,4294967295|0,!0);Sr.MAX_UNSIGNED_VALUE=fF;var Jn=Rr(0,2147483648|0,!1);Sr.MIN_VALUE=Jn;var Se=Sr.prototype;Se.toInt=function(){return this.unsigned?this.low>>>0:this.low};Se.toNumber=function(){return this.unsigned?(this.high>>>0)*Fp+(this.low>>>0):this.high*Fp+(this.low>>>0)};Se.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Jn)){var t=ro(e),i=this.div(t),n=i.mul(t).sub(this);return i.toString(e)+n.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=ro(e6(e,6),this.unsigned),o=this,a="";;){var c=o.div(s),u=o.sub(c.mul(s)).toInt()>>>0,l=u.toString(e);if(o=c,o.isZero())return l+a;for(;l.length<6;)l="0"+l;a=""+l+a}};Se.getHighBits=function(){return this.high};Se.getHighBitsUnsigned=function(){return this.high>>>0};Se.getLowBits=function(){return this.low};Se.getLowBitsUnsigned=function(){return this.low>>>0};Se.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Jn)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return this.high!=0?t+33:t+1};Se.isZero=function(){return this.high===0&&this.low===0};Se.eqz=Se.isZero;Se.isNegative=function(){return!this.unsigned&&this.high<0};Se.isPositive=function(){return this.unsigned||this.high>=0};Se.isOdd=function(){return(this.low&1)==1};Se.isEven=function(){return(this.low&1)==0};Se.equals=function(e){return Zn(e)||(e=Qo(e)),this.unsigned!==e.unsigned&&this.high>>>31==1&&e.high>>>31==1?!1:this.high===e.high&&this.low===e.low};Se.eq=Se.equals;Se.notEquals=function(e){return!this.eq(e)};Se.neq=Se.notEquals;Se.ne=Se.notEquals;Se.lessThan=function(e){return this.comp(e)<0};Se.lt=Se.lessThan;Se.lessThanOrEqual=function(e){return this.comp(e)<=0};Se.lte=Se.lessThanOrEqual;Se.le=Se.lessThanOrEqual;Se.greaterThan=function(e){return this.comp(e)>0};Se.gt=Se.greaterThan;Se.greaterThanOrEqual=function(e){return this.comp(e)>=0};Se.gte=Se.greaterThanOrEqual;Se.ge=Se.greaterThanOrEqual;Se.compare=function(e){if(Zn(e)||(e=Qo(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Se.comp=Se.compare;Se.negate=function(){return!this.unsigned&&this.eq(Jn)?Jn:this.not().add(Kp)};Se.neg=Se.negate;Se.add=function(e){Zn(e)||(e=Qo(e));var t=this.high>>>16,i=this.high&65535,n=this.low>>>16,s=this.low&65535,o=e.high>>>16,a=e.high&65535,c=e.low>>>16,u=e.low&65535,l=0,d=0,h=0,p=0;return p+=s+u,h+=p>>>16,p&=65535,h+=n+c,d+=h>>>16,h&=65535,d+=i+a,l+=d>>>16,d&=65535,l+=t+o,l&=65535,Rr(h<<16|p,l<<16|d,this.unsigned)};Se.subtract=function(e){return Zn(e)||(e=Qo(e)),this.add(e.neg())};Se.sub=Se.subtract;Se.multiply=function(e){if(this.isZero())return io;if(Zn(e)||(e=Qo(e)),to){var t=to.mul(this.low,this.high,e.low,e.high);return Rr(t,to.get_high(),this.unsigned)}if(e.isZero())return io;if(this.eq(Jn))return e.isOdd()?Jn:io;if(e.eq(Jn))return this.isOdd()?Jn:io;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(cF)&&e.lt(cF))return ro(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,n=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,c=e.high&65535,u=e.low>>>16,l=e.low&65535,d=0,h=0,p=0,y=0;return y+=o*l,p+=y>>>16,y&=65535,p+=s*l,h+=p>>>16,p&=65535,p+=o*u,h+=p>>>16,p&=65535,h+=n*l,d+=h>>>16,h&=65535,h+=s*u,d+=h>>>16,h&=65535,h+=o*c,d+=h>>>16,h&=65535,d+=i*l+n*u+s*c+o*a,d&=65535,Rr(p<<16|y,d<<16|h,this.unsigned)};Se.mul=Se.multiply;Se.divide=function(e){if(Zn(e)||(e=Qo(e)),e.isZero())throw Error("division by zero");if(to){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?to.div_u:to.div_s)(this.low,this.high,e.low,e.high);return Rr(t,to.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?td:io;var i,n,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return td;if(e.gt(this.shru(1)))return uF;s=td}else{if(this.eq(Jn)){if(e.eq(Kp)||e.eq(VE))return Jn;if(e.eq(Jn))return Kp;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(io)?e.isNegative()?Kp:VE:(n=this.sub(e.mul(i)),s=i.add(n.div(e)),s)}else if(e.eq(Jn))return this.unsigned?td:io;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=io}for(n=this;n.gte(e);){i=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),c=a<=48?1:e6(2,a-48),u=ro(i),l=u.mul(e);l.isNegative()||l.gt(n);)i-=c,u=ro(i,this.unsigned),l=u.mul(e);u.isZero()&&(u=Kp),s=s.add(u),n=n.sub(l)}return s};Se.div=Se.divide;Se.modulo=function(e){if(Zn(e)||(e=Qo(e)),to){var t=(this.unsigned?to.rem_u:to.rem_s)(this.low,this.high,e.low,e.high);return Rr(t,to.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Se.mod=Se.modulo;Se.rem=Se.modulo;Se.not=function(){return Rr(~this.low,~this.high,this.unsigned)};Se.and=function(e){return Zn(e)||(e=Qo(e)),Rr(this.low&e.low,this.high&e.high,this.unsigned)};Se.or=function(e){return Zn(e)||(e=Qo(e)),Rr(this.low|e.low,this.high|e.high,this.unsigned)};Se.xor=function(e){return Zn(e)||(e=Qo(e)),Rr(this.low^e.low,this.high^e.high,this.unsigned)};Se.shiftLeft=function(e){return Zn(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?Rr(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Rr(0,this.low<<e-32,this.unsigned)};Se.shl=Se.shiftLeft;Se.shiftRight=function(e){return Zn(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?Rr(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Rr(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Se.shr=Se.shiftRight;Se.shiftRightUnsigned=function(e){if(Zn(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var i=this.low;return Rr(i>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?Rr(t,0,this.unsigned):Rr(t>>>e-32,0,this.unsigned)};Se.shru=Se.shiftRightUnsigned;Se.shr_u=Se.shiftRightUnsigned;Se.toSigned=function(){return this.unsigned?Rr(this.low,this.high,!1):this};Se.toUnsigned=function(){return this.unsigned?this:Rr(this.low,this.high,!0)};Se.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Se.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Se.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Sr.fromBytes=function(e,t,i){return i?Sr.fromBytesLE(e,t):Sr.fromBytesBE(e,t)};Sr.fromBytesLE=function(e,t){return new Sr(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Sr.fromBytesBE=function(e,t){return new Sr(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}});var Zo=m((Iot,jF)=>{f();"use strict";var CSe=async r=>{let e=[];for await(let t of r)e.push(t);return e};jF.exports=CSe});var qF,Hp,s9=Ue(()=>{f();qF=R(Zo()),Hp=(r,e)=>async function*(){yield*(await(0,qF.default)(r)).sort(e)}()});var ts=m((Pot,UF)=>{f();"use strict";var OSe=async r=>{for await(let e of r);};UF.exports=OSe});var rs=m((Cot,FF)=>{f();"use strict";var kSe=async function*(r,e){for await(let t of r)await e(t)&&(yield t)};FF.exports=kSe});var ad=m((Oot,KF)=>{f();"use strict";var DSe=async function*(r,e){let t=0;if(!(e<1)){for await(let i of r)if(yield i,t++,t===e)return}};KF.exports=DSe});var o9,cd,a9,nn,ud=Ue(()=>{f();s9();o9=R(ts()),cd=R(rs()),a9=R(ad()),nn=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,i){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:i,value:n}of e)await this.put(i,n,t),yield{key:i,value:n}}async*getMany(e,t={}){for await(let i of e)yield this.get(i,t)}async*deleteMany(e,t={}){for await(let i of e)await this.delete(i,t),yield i}batch(){let e=[],t=[];return{put(i,n){e.push({key:i,value:n})},delete(i){t.push(i)},commit:async i=>{await(0,o9.default)(this.putMany(e,i)),e=[],await(0,o9.default)(this.deleteMany(t,i)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let i=this._all(e,t);if(e.prefix!=null&&(i=(0,cd.default)(i,n=>n.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>(0,cd.default)(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>Hp(n,s),i)),e.offset!=null){let n=0;i=(0,cd.default)(i,()=>n++>=e.offset)}return e.limit!=null&&(i=(0,a9.default)(i,e.limit)),i}queryKeys(e,t){let i=this._allKeys(e,t);if(e.prefix!=null&&(i=(0,cd.default)(i,n=>n.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>(0,cd.default)(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>Hp(n,s),i)),e.offset!=null){let n=0;i=(0,cd.default)(i,()=>n++>=e.offset)}return e.limit!=null&&(i=(0,a9.default)(i,e.limit)),i}}});var zF=m((Bot,VF)=>{f();VF.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}});var c9=m((Mot,$F)=>{f();var HF=zF();$F.exports=class{constructor(e){this.hwm=e||16,this.head=new HF(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let t=this.head;this.head=t.next=new HF(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let t=this.tail.next;return this.tail.next=null,this.tail=t,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}});var Xa=m((jot,GF)=>{f();var u9=c9();GF.exports=r=>{r=r||{};let e;typeof r=="function"?(e=r,r={}):e=r.onEnd;let t=new u9,i,n,s,o=()=>{if(!t.isEmpty()){if(r.writev){let g,w=[];for(;!t.isEmpty();){if(g=t.shift(),g.error)throw g.error;w.push(g.value)}return{done:g.done,value:w}}let y=t.shift();if(y.error)throw y.error;return y}return s?{done:!0}:new Promise((y,g)=>{n=w=>(n=null,w.error?g(w.error):r.writev&&!w.done?y({done:w.done,value:[w.value]}):y(w),i)})},a=y=>n?n(y):(t.push(y),i),c=y=>(t=new u9,n?n({error:y}):(t.push({error:y}),i)),u=y=>s?i:a({done:!1,value:y}),l=y=>s?i:(s=!0,y?c(y):a({done:!0})),d=()=>(t=new u9,l(),{done:!0}),h=y=>(l(y),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:o,return:d,throw:h,push:u,end:l},!e)return i;let p=i;return i={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(y){return p.throw(y),e&&(e(y),e=null),{done:!0}},return(){return p.return(),e&&(e(),e=null),{done:!0}},push:u,end(y){return p.end(y),e&&(e(y),e=null),i}},i}});var WF,l9,f9,NSe,R2,d9=Ue(()=>{f();ud();eo();WF=R(le()),l9=R(Xa()),f9=R(ts()),NSe=(0,WF.default)("datastore:core:tiered"),R2=class extends nn{constructor(e){super();this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map(e=>e.open()))}catch(e){throw g2()}}async put(e,t){try{await Promise.all(this.stores.map(i=>i.put(e,t)))}catch(i){throw b2()}}async get(e,t){for(let i of this.stores)try{let n=await i.get(e,t);if(n)return n}catch(n){NSe(n)}throw Ri()}async has(e,t){for(let i of this.stores)if(await i.has(e,t))return!0;return!1}async delete(e,t){try{await Promise.all(this.stores.map(i=>i.delete(e,t)))}catch(i){throw m2()}}async*putMany(e,t={}){let i,n=this.stores.map(s=>{let o=(0,l9.default)();return(0,f9.default)(s.putMany(o,t)).catch(a=>{i=a}),o});try{for await(let s of e){if(i)throw i;n.forEach(o=>o.push(s)),yield s}}finally{n.forEach(s=>s.end())}}async*deleteMany(e,t={}){let i,n=this.stores.map(s=>{let o=(0,l9.default)();return(0,f9.default)(s.deleteMany(o,t)).catch(a=>{i=a}),o});try{for await(let s of e){if(i)throw i;n.forEach(o=>o.push(s)),yield s}}finally{n.forEach(s=>s.end())}}async close(){await Promise.all(this.stores.map(e=>e.close()))}batch(){let e=this.stores.map(t=>t.batch());return{put:(t,i)=>{e.forEach(n=>n.put(t,i))},delete:t=>{e.forEach(i=>i.delete(t))},commit:async t=>{for(let i of e)await i.commit(t)}}}query(e,t){return this.stores[this.stores.length-1].query(e,t)}queryKeys(e,t){return this.stores[this.stores.length-1].queryKeys(e,t)}}});var A2=m((h9,p9)=>{f();(function(r,e){typeof h9=="object"&&typeof p9!="undefined"?p9.exports=function(t,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)t=t?t[i[s]]:o;return t===o?n:t}:typeof define=="function"&&define.amd?define(function(){return function(t,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)t=t?t[i[s]]:o;return t===o?n:t}}):r.dlv=function(t,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)t=t?t[i[s]]:o;return t===o?n:t}})(h9)});var $p=Ue(()=>{f();Mr()});var u6,y9=Ue(()=>{f();u6=`This is a repository of IPLD objects. Each IPLD object is in a single file,
named <base32 encoding of cid>.data. Where <base32 encoding of cid> is the
"base32" encoding of the CID (as specified in
https://github.com/multiformats/multibase) without the 'B' prefix.
All the object files are placed in a tree of directories, based on a
function of the CID. This is a form of sharding similar to
the objects directory in git repositories. Previously, we used
prefixes, we now use the next-to-last two charters.
    func NextToLast(base32cid string) {
      nextToLastLen := 2
      offset := len(base32cid) - nextToLastLen - 1
      return str[offset : offset+nextToLastLen]
    }
For example, an object with a base58 CIDv1 of
    zb2rhYSxw4ZjuzgCnWSt19Q94ERaeFhu9uSqRgjSdx9bsgM6f
has a base32 CIDv1 of
    BAFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA
and will be placed at
    SC/AFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA.data
with 'SC' being the last-to-next two characters and the 'B' at the
beginning of the CIDv1 string is the multibase prefix that is not
stored in the filename.
`});var _9={};Tt(_9,{NextToLast:()=>w9,PREFIX:()=>l6,Prefix:()=>m9,README_FN:()=>g9,SHARDING_FN:()=>f6,ShardBase:()=>x2,Suffix:()=>b9,parseShardFun:()=>YF,readShardFun:()=>d6,readme:()=>u6});function YF(r){if(r=r.trim(),r.length===0)throw new Error("empty shard string");if(!r.startsWith(l6))throw new Error(`invalid or no path prefix: ${r}`);let e=r.slice(l6.length).split("/"),t=e[0];if(t!=="v1")throw new Error(`expect 'v1' version, got '${t}'`);let i=e[1];if(!e[2])throw new Error("missing param");let n=parseInt(e[2],10);switch(i){case"prefix":return new m9(n);case"suffix":return new b9(n);case"next-to-last":return new w9(n);default:throw new Error(`unkown sharding function: ${i}`)}}var l6,f6,g9,x2,m9,b9,w9,d6,v9=Ue(()=>{f();Mr();y9();y9();l6="/repo/flatfs/shard/",f6="SHARDING",g9="_README",x2=class{constructor(e){this.param=e,this.name="base",this._padding=""}fun(e){return"implement me"}toString(){return`${l6}v1/${this.name}/${this.param}`}},m9=class extends x2{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="prefix"}fun(e){return(e+this._padding).slice(0,this.param)}},b9=class extends x2{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="suffix"}fun(e){let t=this._padding+e;return t.slice(t.length-this.param)}},w9=class extends x2{constructor(e){super(e);this._padding="".padStart(e+1,"_"),this.name="next-to-last"}fun(e){let t=this._padding+e,i=t.length-this.param-1;return t.slice(i,i+this.param)}};d6=async(r,e)=>{let t=new xe(r).child(new xe(f6)),n=await(typeof e.getRaw=="function"?e.getRaw.bind(e):e.get.bind(e))(t);return YF(new TextDecoder().decode(n||"").trim())}});var E9={};Tt(E9,{MemoryDatastore:()=>h6});var h6,p6=Ue(()=>{f();ud();Mr();eo();h6=class extends nn{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[e.toString()]=t}async get(e){if(!await this.has(e))throw Ri();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,t])=>({key:new xe(e),value:t}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new xe(e))}}});var bn=m((Zot,XF)=>{f();"use strict";var BSe=async function*(r,e){for await(let t of r)yield e(t)};XF.exports=BSe});var dr=m((Jot,Gp)=>{f();var QF=(...r)=>{let e;for(;r.length;)e=r.shift()(e);return e},S9=r=>r&&(typeof r[Symbol.asyncIterator]=="function"||typeof r[Symbol.iterator]=="function"||typeof r.next=="function"),y6=r=>r&&typeof r.sink=="function"&&S9(r.source),LSe=r=>e=>(r.sink(e),r.source),ZF=(...r)=>{if(y6(r[0])){let e=r[0];r[0]=()=>e.source}else if(S9(r[0])){let e=r[0];r[0]=()=>e}if(r.length>1&&y6(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let e=1;e<r.length-1;e++)y6(r[e])&&(r[e]=LSe(r[e]));return QF(...r)};Gp.exports=ZF;Gp.exports.pipe=ZF;Gp.exports.rawPipe=QF;Gp.exports.isIterable=S9;Gp.exports.isDuplex=y6});var vl,g6,ld,m6=Ue(()=>{f();ud();vl=R(bn()),g6=R(dr()),ld=class extends nn{constructor(e,t){super();this.child=e,this.transform=t}open(){return this.child.open()}put(e,t,i){return this.child.put(this.transform.convert(e),t,i)}get(e,t){return this.child.get(this.transform.convert(e),t)}has(e,t){return this.child.has(this.transform.convert(e),t)}delete(e,t){return this.child.delete(this.transform.convert(e),t)}async*putMany(e,t={}){let i=this.transform,n=this.child;yield*(0,g6.pipe)(e,async function*(s){yield*(0,vl.default)(s,({key:o,value:a})=>({key:i.convert(o),value:a}))},async function*(s){yield*n.putMany(s,t)},async function*(s){yield*(0,vl.default)(s,({key:o,value:a})=>({key:i.invert(o),value:a}))})}async*getMany(e,t={}){let i=this.transform,n=this.child;yield*(0,g6.pipe)(e,async function*(s){yield*(0,vl.default)(s,o=>i.convert(o))},async function*(s){yield*n.getMany(s,t)})}async*deleteMany(e,t={}){let i=this.transform,n=this.child;yield*(0,g6.pipe)(e,async function*(s){yield*(0,vl.default)(s,o=>i.convert(o))},async function*(s){yield*n.deleteMany(s,t)},async function*(s){yield*(0,vl.default)(s,o=>i.invert(o))})}batch(){let e=this.child.batch();return{put:(t,i)=>{e.put(this.transform.convert(t),i)},delete:t=>{e.delete(this.transform.convert(t))},commit:t=>e.commit(t)}}query(e,t){let i={...e};i.filters=(i.filters||[]).map(s=>({key:o,value:a})=>s({key:this.transform.convert(o),value:a}));let{prefix:n}=e;return n!=null&&n!=="/"&&(delete i.prefix,i.filters.push(({key:s})=>this.transform.invert(s).toString().startsWith(n))),i.orders&&(i.orders=i.orders.map(s=>(o,a)=>s({key:this.transform.invert(o.key),value:o.value},{key:this.transform.invert(a.key),value:a.value}))),(0,vl.default)(this.child.query(i,t),({key:s,value:o})=>({key:this.transform.invert(s),value:o}))}queryKeys(e,t){let i={...e};i.filters=(i.filters||[]).map(s=>o=>s(this.transform.convert(o)));let{prefix:n}=e;return n!=null&&n!=="/"&&(delete i.prefix,i.filters.push(s=>this.transform.invert(s).toString().startsWith(n))),i.orders&&(i.orders=i.orders.map(s=>(o,a)=>s(this.transform.invert(o),this.transform.invert(a)))),(0,vl.default)(this.child.queryKeys(i,t),s=>this.transform.invert(s))}close(){return this.child.close()}}});var Wp,I2,El,JF=Ue(()=>{f();$p();v9();ud();m6();eo();Wp=new xe(f6),I2=new xe(g9),El=class extends nn{constructor(e,t){super();this.child=new ld(e,{convert:this._convertKey.bind(this),invert:this._invertKey.bind(this)}),this.shard=t}async open(){await this.child.open(),this.shard=await El.create(this.child,this.shard)}_convertKey(e){let t=e.toString();return t===Wp.toString()||t===I2.toString()?e:new xe(this.shard.fun(t)).child(e)}_invertKey(e){let t=e.toString();return t===Wp.toString()||t===I2.toString()?e:xe.withNamespaces(e.list().slice(1))}static async createOrOpen(e,t){try{await El.create(e,t)}catch(i){if(i&&i.message!=="datastore exists")throw i}return El.open(e)}static async open(e){let t=await d6("/",e);return new El(e,t)}static async create(e,t){let i=await e.has(Wp);if(!i&&!t)throw g2(Error("Shard is required when datastore doesn't have a shard key already."));if(!i){let a=typeof e.putRaw=="function"?e.putRaw.bind(e):e.put.bind(e);return await Promise.all([a(Wp,new TextEncoder().encode(t.toString()+`
`)),a(I2,new TextEncoder().encode(u6))]),t}let n=await d6("/",e),s=(n||"").toString(),o=t.toString();if(s!==o)throw new Error(`specified fun ${o} does not match repo shard fun ${s}`);return n}put(e,t,i){return this.child.put(e,t,i)}get(e,t){return this.child.get(e,t)}has(e,t){return this.child.has(e,t)}delete(e,t){return this.child.delete(e,t)}async*putMany(e,t={}){yield*this.child.putMany(e,t)}async*getMany(e,t={}){yield*this.child.getMany(e,t)}async*deleteMany(e,t={}){yield*this.child.deleteMany(e,t)}batch(){return this.child.batch()}query(e,t){let i={...e,filters:[({key:n})=>n.toString()!==Wp.toString(),({key:n})=>n.toString()!==I2.toString()].concat(e.filters||[])};return this.child.query(i,t)}queryKeys(e,t){let i={...e,filters:[n=>n.toString()!==Wp.toString(),n=>n.toString()!==I2.toString()].concat(e.filters||[])};return this.child.queryKeys(i,t)}close(){return this.child.close()}}});var Sl=m((cat,eK)=>{f();"use strict";var MSe=Xa(),jSe=async function*(...r){let e=MSe();setTimeout(async()=>{try{await Promise.all(r.map(async t=>{for await(let i of t)e.push(i)})),e.end()}catch(t){e.end(t)}},0),yield*e};eK.exports=jSe});var T2,R9,A9,x9,tK=Ue(()=>{f();T2=R(rs()),R9=R(ad()),A9=R(Sl());ud();eo();s9();x9=class extends nn{constructor(e){super();this.mounts=e.slice()}async open(){await Promise.all(this.mounts.map(e=>e.datastore.open()))}_lookup(e){for(let t of this.mounts)if(t.prefix.toString()===e.toString()||t.prefix.isAncestorOf(e))return{datastore:t.datastore,mountpoint:t.prefix}}put(e,t,i){let n=this._lookup(e);if(n==null)throw b2(new Error("No datastore mounted for this key"));return n.datastore.put(e,t,i)}get(e,t){let i=this._lookup(e);if(i==null)throw Ri(new Error("No datastore mounted for this key"));return i.datastore.get(e,t)}has(e,t){let i=this._lookup(e);return i==null?Promise.resolve(!1):i.datastore.has(e,t)}delete(e,t){let i=this._lookup(e);if(i==null)throw m2(new Error("No datastore mounted for this key"));return i.datastore.delete(e,t)}async close(){await Promise.all(this.mounts.map(e=>e.datastore.close()))}batch(){let e={},t=i=>{let n=this._lookup(i);if(n==null)throw new Error("No datastore mounted for this key");let s=n.mountpoint.toString();return e[s]==null&&(e[s]=n.datastore.batch()),{batch:e[s]}};return{put:(i,n)=>{t(i).batch.put(i,n)},delete:i=>{t(i).batch.delete(i)},commit:async i=>{await Promise.all(Object.keys(e).map(n=>e[n].commit(i)))}}}query(e,t){let i=this.mounts.map(s=>s.datastore.query({prefix:e.prefix,filters:e.filters},t)),n=(0,A9.default)(...i);if(e.filters&&e.filters.forEach(s=>{n=(0,T2.default)(n,s)}),e.orders&&e.orders.forEach(s=>{n=Hp(n,s)}),e.offset!=null){let s=0;n=(0,T2.default)(n,()=>s++>=e.offset)}return e.limit!=null&&(n=(0,R9.default)(n,e.limit)),n}queryKeys(e,t){let i=this.mounts.map(s=>s.datastore.queryKeys({prefix:e.prefix,filters:e.filters},t)),n=(0,A9.default)(...i);if(e.filters&&e.filters.forEach(s=>{n=(0,T2.default)(n,s)}),e.orders&&e.orders.forEach(s=>{n=Hp(n,s)}),e.offset!=null){let s=0;n=(0,T2.default)(n,()=>s++>=e.offset)}return e.limit!=null&&(n=(0,R9.default)(n,e.limit)),n}}});var I9,rK=Ue(()=>{f();$p();m6();I9=class extends ld{constructor(e,t){super(e,{convert(i){return t.child(i)},invert(i){if(t.toString()==="/")return i;if(!t.isAncestorOf(i))throw new Error(`Expected prefix: (${t.toString()}) in key: ${i.toString()}`);return new xe(i.toString().slice(t.toString().length),!1)}})}}});var iK={};Tt(iK,{BaseDatastore:()=>nn,Errors:()=>fd,KeyTransformDatastore:()=>ld,MemoryDatastore:()=>h6,MountDatastore:()=>x9,NamespaceDatastore:()=>I9,ShardingDatastore:()=>El,TieredDatastore:()=>R2,shard:()=>qSe});var fd,qSe,b6=Ue(()=>{f();eo();v9();ud();p6();m6();JF();tK();d9();rK();fd=UE,qSe=_9});var T9=m((Sat,sK)=>{f();"use strict";function nK(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function USe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return nK(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),nK(new n,t)}}sK.exports=USe});var lK=m((jat,uK)=>{f();"use strict";var Xp=Br(),cK=Xp.Reader,FSe=Xp.Writer,no=Xp.util,C2=Xp.roots["libp2p-record"]||(Xp.roots["libp2p-record"]={});C2.Record=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.key=no.newBuffer([]),r.prototype.value=no.newBuffer([]),r.prototype.timeReceived="",r.encode=function(t,i){return i||(i=FSe.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&i.uint32(10).bytes(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(18).bytes(t.value),t.timeReceived!=null&&Object.hasOwnProperty.call(t,"timeReceived")&&i.uint32(42).string(t.timeReceived),i},r.decode=function(t,i){t instanceof cK||(t=cK.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new C2.Record;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.key=t.bytes();break;case 2:s.value=t.bytes();break;case 5:s.timeReceived=t.string();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof C2.Record)return t;var i=new C2.Record;return t.key!=null&&(typeof t.key=="string"?no.base64.decode(t.key,i.key=no.newBuffer(no.base64.length(t.key)),0):t.key.length&&(i.key=t.key)),t.value!=null&&(typeof t.value=="string"?no.base64.decode(t.value,i.value=no.newBuffer(no.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),t.timeReceived!=null&&(i.timeReceived=String(t.timeReceived)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.key="":(n.key=[],i.bytes!==Array&&(n.key=no.newBuffer(n.key))),i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=no.newBuffer(n.value))),n.timeReceived=""),t.key!=null&&t.hasOwnProperty("key")&&(n.key=i.bytes===String?no.base64.encode(t.key,0,t.key.length):i.bytes===Array?Array.prototype.slice.call(t.key):t.key),t.value!=null&&t.hasOwnProperty("value")&&(n.value=i.bytes===String?no.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),t.timeReceived!=null&&t.hasOwnProperty("timeReceived")&&(n.timeReceived=t.timeReceived),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Xp.util.toJSONOptions)},r}();uK.exports=C2});var fK=m((qat,N9)=>{f();"use strict";N9.exports.toRFC3339=r=>{let e=r.getUTCFullYear(),t=String(r.getUTCMonth()+1).padStart(2,"0"),i=String(r.getUTCDate()).padStart(2,"0"),n=String(r.getUTCHours()).padStart(2,"0"),s=String(r.getUTCMinutes()).padStart(2,"0"),o=String(r.getUTCSeconds()).padStart(2,"0"),c=r.getUTCMilliseconds()*1e3*1e3;return`${e}-${t}-${i}T${n}:${s}:${o}.${c}Z`};N9.exports.parseRFC3339=r=>{let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),t=String(r).trim().match(e);if(!t)throw new Error("Invalid format");let i=parseInt(t[1],10),n=parseInt(t[2],10)-1,s=parseInt(t[3],10),o=parseInt(t[4],10),a=parseInt(t[5],10),c=parseInt(t[6],10),u=parseInt(t[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,u))}});var pK=m((Uat,hK)=>{f();"use strict";var{Record:B9}=lK(),dK=fK(),O2=class{constructor(e,t,i){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=i}serialize(){return B9.encode(this.prepareSerialize()).finish()}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:this.timeReceived&&dK.toRFC3339(this.timeReceived)}}static deserialize(e){let t=B9.decode(e);return O2.fromDeserialized(B9.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}))}static fromDeserialized(e){let t;return e.timeReceived&&(t=dK.parseRFC3339(e.timeReceived)),new O2(e.key,e.value,t)}};hK.exports=O2});var v6=m((Fat,gK)=>{f();"use strict";function yK(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function KSe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return yK(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),yK(new n,t)}}gK.exports=KSe});var bK=m((Kat,mK)=>{f();"use strict";var{sha256:VSe}=(vi(),Ks),E6=v6(),{toString:zSe}=(tt(),sr),{equals:HSe}=(hi(),dn),$Se=async(r,e)=>{if(!(r instanceof Uint8Array))throw E6(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(r.byteLength<5)throw E6(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if(zSe(r.subarray(0,4))!=="/pk/")throw E6(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");let i=r.slice(4),n=await VSe.digest(e);if(!HSe(i,n.bytes))throw E6(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")};mK.exports={func:$Se,sign:!1}});var _K=m((Vat,wK)=>{f();"use strict";wK.exports={pk:bK()}});var EK=m((zat,vK)=>{f();"use strict";var GSe=v6(),{toString:WSe}=(tt(),sr),YSe=(r,e)=>{let t=e.key,n=WSe(t).split("/");if(n.length<3)return;let s=r[n[1].toString()];if(!s){let o="Invalid record keytype";throw GSe(new Error(o),"ERR_INVALID_RECORD_KEY_TYPE")}return s.func(t,e.value)};vK.exports={verifyRecord:YSe,validators:_K()}});var RK=m((Hat,SK)=>{f();"use strict";var XSe=(r,e)=>0;SK.exports=XSe});var xK=m(($at,AK)=>{f();"use strict";AK.exports={pk:RK()}});var TK=m((Gat,IK)=>{f();"use strict";var L9=v6(),{toString:QSe}=(tt(),sr),ZSe=(r,e,t)=>{if(t.length===0){let o="No records given";throw L9(new Error(o),"ERR_NO_RECORDS_RECEIVED")}let n=QSe(e).split("/");if(n.length<3){let o="Record key does not have a selector function";throw L9(new Error(o),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}let s=r[n[1].toString()];if(!s){let o=`Unrecognized key prefix: ${n[1]}`;throw L9(new Error(o),"ERR_UNRECOGNIZED_KEY_PREFIX")}return t.length===1?0:s(e,t)};IK.exports={bestRecord:ZSe,selectors:xK()}});var Qa=m((Wat,PK)=>{f();"use strict";PK.exports={Record:pK(),validator:EK(),selection:TK()}});var qK=m((_ct,jK)=>{f();"use strict";var tRe=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;jK.exports=function(e,t){if(t==null&&(t=!1),e.length<2||e.length>255)return!1;var i=e[e.length-1];if(t){if(i!==".")return!1}else if(i===".")return!1;return tRe.test(e)}});var Za=m((Uut,dV)=>{f();"use strict";var lRe=()=>{let r={};return r.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),r};dV.exports=lRe});var Ut=m((Fut,eS)=>{f();"use strict";var Jp=typeof Reflect=="object"?Reflect:null,hV=Jp&&typeof Jp.apply=="function"?Jp.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},I6;Jp&&typeof Jp.ownKeys=="function"?I6=Jp.ownKeys:Object.getOwnPropertySymbols?I6=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:I6=function(e){return Object.getOwnPropertyNames(e)};function fRe(r){console&&console.warn&&console.warn(r)}var pV=Number.isNaN||function(e){return e!==e};function hr(){hr.init.call(this)}eS.exports=hr;eS.exports.once=yRe;hr.EventEmitter=hr;hr.prototype._events=void 0;hr.prototype._eventsCount=0;hr.prototype._maxListeners=void 0;var yV=10;function T6(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(hr,"defaultMaxListeners",{enumerable:!0,get:function(){return yV},set:function(r){if(typeof r!="number"||r<0||pV(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");yV=r}});hr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};hr.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||pV(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function gV(r){return r._maxListeners===void 0?hr.defaultMaxListeners:r._maxListeners}hr.prototype.getMaxListeners=function(){return gV(this)};hr.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")hV(c,this,t);else for(var u=c.length,l=vV(c,u),i=0;i<u;++i)hV(l[i],this,t);return!0};function mV(r,e,t,i){var n,s,o;if(T6(t),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),s=r._events),o=s[e]),o===void 0)o=s[e]=t,++r._eventsCount;else if(typeof o=="function"?o=s[e]=i?[t,o]:[o,t]:i?o.unshift(t):o.push(t),n=gV(r),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=o.length,fRe(a)}return r}hr.prototype.addListener=function(e,t){return mV(this,e,t,!1)};hr.prototype.on=hr.prototype.addListener;hr.prototype.prependListener=function(e,t){return mV(this,e,t,!0)};function dRe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function bV(r,e,t){var i={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},n=dRe.bind(i);return n.listener=t,i.wrapFn=n,n}hr.prototype.once=function(e,t){return T6(t),this.on(e,bV(this,e,t)),this};hr.prototype.prependOnceListener=function(e,t){return T6(t),this.prependListener(e,bV(this,e,t)),this};hr.prototype.removeListener=function(e,t){var i,n,s,o,a;if(T6(t),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount==0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===t||i[o].listener===t){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():hRe(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};hr.prototype.off=hr.prototype.removeListener;hr.prototype.removeAllListeners=function(e){var t,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this};function wV(r,e,t){var i=r._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?t?[n.listener||n]:[n]:t?pRe(n):vV(n,n.length)}hr.prototype.listeners=function(e){return wV(this,e,!0)};hr.prototype.rawListeners=function(e){return wV(this,e,!1)};hr.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):_V.call(r,e)};hr.prototype.listenerCount=_V;function _V(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}hr.prototype.eventNames=function(){return this._eventsCount>0?I6(this._events):[]};function vV(r,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=r[i];return t}function hRe(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function pRe(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function yRe(r,e){return new Promise(function(t,i){function n(o){r.removeListener(e,s),i(o)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",n),t([].slice.call(arguments))}EV(r,e,s,{once:!0}),e!=="error"&&gRe(r,n,{once:!0})})}function gRe(r,e,t){typeof r.on=="function"&&EV(r,"error",e,t)}function EV(r,e,t,i){if(typeof r.on=="function")i.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function n(s){i.once&&r.removeEventListener(e,n),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var C6=m((Kut,SV)=>{f();"use strict";var P6=Za(),mRe=Ut().EventEmitter;async function*bRe(r,e={}){let t=e.concurrency||1/0;t<1&&(t=1/0);let i=e.ordered==null?!1:e.ordered,n=new mRe,s=[],o=P6(),a=P6(),c=!1,u,l=!1;n.on("task-complete",()=>{a.resolve()}),Promise.resolve().then(async()=>{try{for await(let y of r){if(s.length===t&&(o=P6(),await o.promise),l)break;let g={done:!1};s.push(g),y().then(w=>{g.done=!0,g.ok=!0,g.value=w,n.emit("task-complete")},w=>{g.done=!0,g.err=w,n.emit("task-complete")})}c=!0,n.emit("task-complete")}catch(y){u=y,n.emit("task-complete")}});function d(){return Boolean(i?s[0]&&s[0].done:s.find(y=>y.done))}function*h(){for(;s.length&&s[0].done;){let y=s[0];if(s.shift(),y.ok)yield y.value;else throw l=!0,o.resolve(),y.err;o.resolve()}}function*p(){for(;d();)for(let y=0;y<s.length;y++)if(s[y].done){let g=s[y];if(s.splice(y,1),y--,g.ok)yield g.value;else throw l=!0,o.resolve(),g.err;o.resolve()}}for(;;){if(d()||(a=P6(),await a.promise),u)throw u;if(i?yield*h():yield*p(),c&&s.length===0)break}}SV.exports=bRe});var e0=m((rlt,OV)=>{f();"use strict";async function*_Re(r,e={}){let t=r.getReader();try{for(;;){let i=await t.read();if(i.done)return;yield i.value}}finally{e.preventCancel!==!0&&t.cancel(),t.releaseLock()}}OV.exports=_Re});var NV=m((ilt,DV)=>{f();"use strict";var kV=e0();function vRe(r){return typeof r.stream=="function"?kV(r.stream()):kV(new Response(r).body)}DV.exports=vRe});var t0=m((nlt,BV)=>{f();"use strict";function ERe(r){let[e,t]=r[Symbol.asyncIterator]?[r[Symbol.asyncIterator](),Symbol.asyncIterator]:[r[Symbol.iterator](),Symbol.iterator],i=[];return{peek:()=>e.next(),push:n=>{i.push(n)},next:()=>i.length?{done:!1,value:i.shift()}:e.next(),[t](){return this}}}BV.exports=ERe});var M6=m((mlt,GV)=>{f();"use strict";async function*SRe(r,e=1){let t=[];e<1&&(e=1);for await(let i of r)for(t.push(i);t.length>=e;)yield t.slice(0,e),t=t.slice(e);for(;t.length;)yield t.slice(0,e),t=t.slice(e)}GV.exports=SRe});var j6=m((blt,WV)=>{f();"use strict";var RRe=M6();async function*ARe(r,e=1){for await(let t of RRe(r,e)){let i=t.map(n=>n().then(s=>({ok:!0,value:s}),s=>({ok:!1,err:s})));for(let n=0;n<i.length;n++){let s=await i[n];if(s.ok)yield s.value;else throw s.err}}}WV.exports=ARe});var YV=m((N2,q6)=>{f();(function(r,e){"use strict";var t={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function i(p){if(!Array.isArray(p)&&!ArrayBuffer.isView(p))return!1;for(var y=0;y<p.length;y++)if(!Number.isInteger(p[y])||p[y]<0||p[y]>255)return!1;return!0}function n(p,y){return(p&65535)*y+(((p>>>16)*y&65535)<<16)}function s(p,y){return p<<y|p>>>32-y}function o(p){return p^=p>>>16,p=n(p,2246822507),p^=p>>>13,p=n(p,3266489909),p^=p>>>16,p}function a(p,y){p=[p[0]>>>16,p[0]&65535,p[1]>>>16,p[1]&65535],y=[y[0]>>>16,y[0]&65535,y[1]>>>16,y[1]&65535];var g=[0,0,0,0];return g[3]+=p[3]+y[3],g[2]+=g[3]>>>16,g[3]&=65535,g[2]+=p[2]+y[2],g[1]+=g[2]>>>16,g[2]&=65535,g[1]+=p[1]+y[1],g[0]+=g[1]>>>16,g[1]&=65535,g[0]+=p[0]+y[0],g[0]&=65535,[g[0]<<16|g[1],g[2]<<16|g[3]]}function c(p,y){p=[p[0]>>>16,p[0]&65535,p[1]>>>16,p[1]&65535],y=[y[0]>>>16,y[0]&65535,y[1]>>>16,y[1]&65535];var g=[0,0,0,0];return g[3]+=p[3]*y[3],g[2]+=g[3]>>>16,g[3]&=65535,g[2]+=p[2]*y[3],g[1]+=g[2]>>>16,g[2]&=65535,g[2]+=p[3]*y[2],g[1]+=g[2]>>>16,g[2]&=65535,g[1]+=p[1]*y[3],g[0]+=g[1]>>>16,g[1]&=65535,g[1]+=p[2]*y[2],g[0]+=g[1]>>>16,g[1]&=65535,g[1]+=p[3]*y[1],g[0]+=g[1]>>>16,g[1]&=65535,g[0]+=p[0]*y[3]+p[1]*y[2]+p[2]*y[1]+p[3]*y[0],g[0]&=65535,[g[0]<<16|g[1],g[2]<<16|g[3]]}function u(p,y){return y%=64,y===32?[p[1],p[0]]:y<32?[p[0]<<y|p[1]>>>32-y,p[1]<<y|p[0]>>>32-y]:(y-=32,[p[1]<<y|p[0]>>>32-y,p[0]<<y|p[1]>>>32-y])}function l(p,y){return y%=64,y===0?p:y<32?[p[0]<<y|p[1]>>>32-y,p[1]<<y]:[p[1]<<y-32,0]}function d(p,y){return[p[0]^y[0],p[1]^y[1]]}function h(p){return p=d(p,[0,p[0]>>>1]),p=c(p,[4283543511,3981806797]),p=d(p,[0,p[0]>>>1]),p=c(p,[3301882366,444984403]),p=d(p,[0,p[0]>>>1]),p}t.x86.hash32=function(p,y){if(t.inputValidation&&!i(p))return e;y=y||0;for(var g=p.length%4,w=p.length-g,b=y,v=0,A=3432918353,k=461845907,C=0;C<w;C=C+4)v=p[C]|p[C+1]<<8|p[C+2]<<16|p[C+3]<<24,v=n(v,A),v=s(v,15),v=n(v,k),b^=v,b=s(b,13),b=n(b,5)+3864292196;switch(v=0,g){case 3:v^=p[C+2]<<16;case 2:v^=p[C+1]<<8;case 1:v^=p[C],v=n(v,A),v=s(v,15),v=n(v,k),b^=v}return b^=p.length,b=o(b),b>>>0},t.x86.hash128=function(p,y){if(t.inputValidation&&!i(p))return e;y=y||0;for(var g=p.length%16,w=p.length-g,b=y,v=y,A=y,k=y,C=0,T=0,D=0,j=0,M=597399067,se=2869860233,ie=951274213,fe=2716044179,pe=0;pe<w;pe=pe+16)C=p[pe]|p[pe+1]<<8|p[pe+2]<<16|p[pe+3]<<24,T=p[pe+4]|p[pe+5]<<8|p[pe+6]<<16|p[pe+7]<<24,D=p[pe+8]|p[pe+9]<<8|p[pe+10]<<16|p[pe+11]<<24,j=p[pe+12]|p[pe+13]<<8|p[pe+14]<<16|p[pe+15]<<24,C=n(C,M),C=s(C,15),C=n(C,se),b^=C,b=s(b,19),b+=v,b=n(b,5)+1444728091,T=n(T,se),T=s(T,16),T=n(T,ie),v^=T,v=s(v,17),v+=A,v=n(v,5)+197830471,D=n(D,ie),D=s(D,17),D=n(D,fe),A^=D,A=s(A,15),A+=k,A=n(A,5)+2530024501,j=n(j,fe),j=s(j,18),j=n(j,M),k^=j,k=s(k,13),k+=b,k=n(k,5)+850148119;switch(C=0,T=0,D=0,j=0,g){case 15:j^=p[pe+14]<<16;case 14:j^=p[pe+13]<<8;case 13:j^=p[pe+12],j=n(j,fe),j=s(j,18),j=n(j,M),k^=j;case 12:D^=p[pe+11]<<24;case 11:D^=p[pe+10]<<16;case 10:D^=p[pe+9]<<8;case 9:D^=p[pe+8],D=n(D,ie),D=s(D,17),D=n(D,fe),A^=D;case 8:T^=p[pe+7]<<24;case 7:T^=p[pe+6]<<16;case 6:T^=p[pe+5]<<8;case 5:T^=p[pe+4],T=n(T,se),T=s(T,16),T=n(T,ie),v^=T;case 4:C^=p[pe+3]<<24;case 3:C^=p[pe+2]<<16;case 2:C^=p[pe+1]<<8;case 1:C^=p[pe],C=n(C,M),C=s(C,15),C=n(C,se),b^=C}return b^=p.length,v^=p.length,A^=p.length,k^=p.length,b+=v,b+=A,b+=k,v+=b,A+=b,k+=b,b=o(b),v=o(v),A=o(A),k=o(k),b+=v,b+=A,b+=k,v+=b,A+=b,k+=b,("00000000"+(b>>>0).toString(16)).slice(-8)+("00000000"+(v>>>0).toString(16)).slice(-8)+("00000000"+(A>>>0).toString(16)).slice(-8)+("00000000"+(k>>>0).toString(16)).slice(-8)},t.x64.hash128=function(p,y){if(t.inputValidation&&!i(p))return e;y=y||0;for(var g=p.length%16,w=p.length-g,b=[0,y],v=[0,y],A=[0,0],k=[0,0],C=[2277735313,289559509],T=[1291169091,658871167],D=0;D<w;D=D+16)A=[p[D+4]|p[D+5]<<8|p[D+6]<<16|p[D+7]<<24,p[D]|p[D+1]<<8|p[D+2]<<16|p[D+3]<<24],k=[p[D+12]|p[D+13]<<8|p[D+14]<<16|p[D+15]<<24,p[D+8]|p[D+9]<<8|p[D+10]<<16|p[D+11]<<24],A=c(A,C),A=u(A,31),A=c(A,T),b=d(b,A),b=u(b,27),b=a(b,v),b=a(c(b,[0,5]),[0,1390208809]),k=c(k,T),k=u(k,33),k=c(k,C),v=d(v,k),v=u(v,31),v=a(v,b),v=a(c(v,[0,5]),[0,944331445]);switch(A=[0,0],k=[0,0],g){case 15:k=d(k,l([0,p[D+14]],48));case 14:k=d(k,l([0,p[D+13]],40));case 13:k=d(k,l([0,p[D+12]],32));case 12:k=d(k,l([0,p[D+11]],24));case 11:k=d(k,l([0,p[D+10]],16));case 10:k=d(k,l([0,p[D+9]],8));case 9:k=d(k,[0,p[D+8]]),k=c(k,T),k=u(k,33),k=c(k,C),v=d(v,k);case 8:A=d(A,l([0,p[D+7]],56));case 7:A=d(A,l([0,p[D+6]],48));case 6:A=d(A,l([0,p[D+5]],40));case 5:A=d(A,l([0,p[D+4]],32));case 4:A=d(A,l([0,p[D+3]],24));case 3:A=d(A,l([0,p[D+2]],16));case 2:A=d(A,l([0,p[D+1]],8));case 1:A=d(A,[0,p[D]]),A=c(A,C),A=u(A,31),A=c(A,T),b=d(b,A)}return b=d(b,[0,p.length]),v=d(v,[0,p.length]),b=a(b,v),v=a(v,b),b=h(b),v=h(v),b=a(b,v),v=a(v,b),("00000000"+(b[0]>>>0).toString(16)).slice(-8)+("00000000"+(b[1]>>>0).toString(16)).slice(-8)+("00000000"+(v[0]>>>0).toString(16)).slice(-8)+("00000000"+(v[1]>>>0).toString(16)).slice(-8)},typeof N2!="undefined"?(typeof q6!="undefined"&&q6.exports&&(N2=q6.exports=t),N2.murmurHash3=t):typeof define=="function"&&define.amd?define([],function(){return t}):(t._murmurHash3=r.murmurHash3,t.noConflict=function(){return r.murmurHash3=t._murmurHash3,t._murmurHash3=e,t.noConflict=e,t},r.murmurHash3=t)})(N2)});var QV=m((wlt,XV)=>{f();XV.exports=YV()});var B2=m((Blt,tz)=>{f();"use strict";function ez(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function ORe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return ez(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),ez(new n,t)}}tz.exports=ORe});var sn=m((Qlt,yz)=>{f();"use strict";var{Buffer:ea}=ci(),pz=Symbol.for("BufferList");function Ar(r){if(!(this instanceof Ar))return new Ar(r);Ar._init.call(this,r)}Ar._init=function(e){Object.defineProperty(this,pz,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};Ar.prototype._new=function(e){return new Ar(e)};Ar.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};Ar.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};Ar.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};Ar.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};Ar.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||ea.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,u=s&&t||0,l=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:ea.concat(this._bufs,this.length);for(let d=0;d<this._bufs.length;d++)this._bufs[d].copy(e,u),u+=this._bufs[d].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,t,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=ea.allocUnsafe(a));for(let d=o[0];d<this._bufs.length;d++){let h=this._bufs[d].length-l;if(c>h)this._bufs[d].copy(e,u,l),u+=h;else{this._bufs[d].copy(e,u,l,l+c),u+=h;break}c-=h,l&&(l=0)}return e.length>u?e.slice(0,u):e};Ar.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};Ar.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};Ar.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};Ar.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};Ar.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(ea.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(ea.from(e));return this};Ar.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};Ar.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=ea.from([r]):typeof r=="string"?r=ea.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=ea.from(r.buffer,r.byteOffset,r.byteLength):ea.isBuffer(r)||(r=ea.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};Ar.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?Ar.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:Ar.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();Ar.prototype._isBufferList=function(e){return e instanceof Ar||Ar.isBufferList(e)};Ar.isBufferList=function(e){return e!=null&&e[pz]};yz.exports=Ar});var bz=m((Zlt,mz)=>{f();var gz=class{constructor(e,t=12,i=8*1024,n=32*1024,s=64,o){this.bits=t,this.min=i,this.max=n,this.asModule=e,this.rabin=new e.Rabin(t,i,n,s,o),this.polynomial=o}fingerprint(e){let{__retain:t,__release:i,__allocArray:n,__getInt32Array:s,Int32Array_ID:o,Uint8Array_ID:a}=this.asModule,c=new Int32Array(Math.ceil(e.length/this.min)),u=t(n(o,c)),l=t(n(a,e)),d=this.rabin.fingerprint(l,u),h=s(d);i(l),i(u);let p=h.indexOf(0);return p>=0?h.subarray(0,p):h}};mz.exports=gz});var Oz=m(j2=>{f();"use strict";var sS=-8,U6=-4,URe=0,wz=1,_z=1<<0,F6=1<<1,Jlt=1<<2,eft=1<<3,vz=5,tft=1<<vz,Ez=1<<10,Sz=1<<11,rft=1<<12,FRe=1<<13,Rz=14,ift=1<<Rz,nft=1<<19,sft=1<<20,oft=1<<21,aft=1<<22,KRe=0,oS=4,VRe=8,zRe=12,Az=12,HRe=16,$Re=typeof BigUint64Array!="undefined",L2=Symbol(),M2=1024;function xz(r,e){let t=new Uint32Array(r),i=new Uint16Array(r);var n=t[e+U6>>>2]>>>1,s=e>>>1;if(n<=M2)return String.fromCharCode.apply(String,i.subarray(s,s+n));let o=[];do{let a=i[s+M2-1],c=a>=55296&&a<56320?M2-1:M2;o.push(String.fromCharCode.apply(String,i.subarray(s,s+=c))),n-=c}while(n>M2);return o.join("")+String.fromCharCode.apply(String,i.subarray(s,s+n))}function aS(r){let e={};function t(n,s){return n?xz(n.buffer,s):"<yet unknown>"}let i=r.env=r.env||{};return i.abort=i.abort||function(s,o,a,c){let u=e.memory||i.memory;throw Error("abort: "+t(u,s)+" at "+t(u,o)+":"+a+":"+c)},i.trace=i.trace||function(s,o){let a=e.memory||i.memory;console.log("trace: "+t(a,s)+(o?" ":"")+Array.prototype.slice.call(arguments,2,2+o).join(", "))},r.Math=r.Math||Math,r.Date=r.Date||Date,e}function cS(r,e){let t=e.exports,i=t.memory,n=t.table,s=t.__alloc,o=t.__retain,a=t.__rtti_base||~0;function c(T){let D=new Uint32Array(i.buffer),j=D[a>>>2];if((T>>>=0)>=j)throw Error("invalid id: "+T);return D[(a+4>>>2)+T*2]}function u(T){let D=new Uint32Array(i.buffer),j=D[a>>>2];if((T>>>=0)>=j)throw Error("invalid id: "+T);return D[(a+4>>>2)+T*2+1]}function l(T){return 31-Math.clz32(T>>>vz&31)}function d(T){return 31-Math.clz32(T>>>Rz&31)}function h(T){let D=T.length,j=s(D<<1,wz),M=new Uint16Array(i.buffer);for(var se=0,ie=j>>>1;se<D;++se)M[ie+se]=T.charCodeAt(se);return j}r.__allocString=h;function p(T){let D=i.buffer;if(new Uint32Array(D)[T+sS>>>2]!==wz)throw Error("not a string: "+T);return xz(D,T)}r.__getString=p;function y(T,D,j){let M=i.buffer;if(j)switch(T){case 2:return new Float32Array(M);case 3:return new Float64Array(M)}else switch(T){case 0:return new(D?Int8Array:Uint8Array)(M);case 1:return new(D?Int16Array:Uint16Array)(M);case 2:return new(D?Int32Array:Uint32Array)(M);case 3:return new(D?BigInt64Array:BigUint64Array)(M)}throw Error("unsupported align: "+T)}function g(T,D){let j=c(T);if(!(j&(_z|F6)))throw Error("not an array: "+T+" @ "+j);let M=l(j),se=D.length,ie=s(se<<M,URe),fe=s(j&F6?HRe:zRe,T),pe=new Uint32Array(i.buffer);pe[fe+KRe>>>2]=o(ie),pe[fe+oS>>>2]=ie,pe[fe+VRe>>>2]=se<<M,j&F6&&(pe[fe+Az>>>2]=se);let Le=y(M,j&Ez,j&Sz);if(j&FRe)for(let Re=0;Re<se;++Re)Le[(ie>>>M)+Re]=o(D[Re]);else Le.set(D,ie>>>M);return fe}r.__allocArray=g;function w(T){let D=new Uint32Array(i.buffer),j=D[T+sS>>>2],M=c(j);if(!(M&_z))throw Error("not an array: "+j);let se=l(M);var ie=D[T+oS>>>2];let fe=M&F6?D[T+Az>>>2]:D[ie+U6>>>2]>>>se;return y(se,M&Ez,M&Sz).subarray(ie>>>=se,ie+fe)}r.__getArrayView=w;function b(T){let D=w(T),j=D.length,M=new Array(j);for(let se=0;se<j;se++)M[se]=D[se];return M}r.__getArray=b;function v(T){let D=i.buffer,j=new Uint32Array(D)[T+U6>>>2];return D.slice(T,T+j)}r.__getArrayBuffer=v;function A(T,D,j){return new T(k(T,D,j))}function k(T,D,j){let M=i.buffer,se=new Uint32Array(M),ie=se[j+oS>>>2];return new T(M,ie,se[ie+U6>>>2]>>>D)}r.__getInt8Array=A.bind(null,Int8Array,0),r.__getInt8ArrayView=k.bind(null,Int8Array,0),r.__getUint8Array=A.bind(null,Uint8Array,0),r.__getUint8ArrayView=k.bind(null,Uint8Array,0),r.__getUint8ClampedArray=A.bind(null,Uint8ClampedArray,0),r.__getUint8ClampedArrayView=k.bind(null,Uint8ClampedArray,0),r.__getInt16Array=A.bind(null,Int16Array,1),r.__getInt16ArrayView=k.bind(null,Int16Array,1),r.__getUint16Array=A.bind(null,Uint16Array,1),r.__getUint16ArrayView=k.bind(null,Uint16Array,1),r.__getInt32Array=A.bind(null,Int32Array,2),r.__getInt32ArrayView=k.bind(null,Int32Array,2),r.__getUint32Array=A.bind(null,Uint32Array,2),r.__getUint32ArrayView=k.bind(null,Uint32Array,2),$Re&&(r.__getInt64Array=A.bind(null,BigInt64Array,3),r.__getInt64ArrayView=k.bind(null,BigInt64Array,3),r.__getUint64Array=A.bind(null,BigUint64Array,3),r.__getUint64ArrayView=k.bind(null,BigUint64Array,3)),r.__getFloat32Array=A.bind(null,Float32Array,2),r.__getFloat32ArrayView=k.bind(null,Float32Array,2),r.__getFloat64Array=A.bind(null,Float64Array,3),r.__getFloat64ArrayView=k.bind(null,Float64Array,3);function C(T,D){let j=new Uint32Array(i.buffer);var M=j[T+sS>>>2];if(M<=j[a>>>2])do if(M==D)return!0;while(M=u(M));return!1}return r.__instanceof=C,r.memory=r.memory||i,r.table=r.table||n,Cz(t,r)}function Iz(r){return typeof Response!="undefined"&&r instanceof Response}async function Tz(r,e){return Iz(r=await r)?Pz(r,e):cS(aS(e||(e={})),await WebAssembly.instantiate(r instanceof WebAssembly.Module?r:await WebAssembly.compile(r),e))}j2.instantiate=Tz;function GRe(r,e){return cS(aS(e||(e={})),new WebAssembly.Instance(r instanceof WebAssembly.Module?r:new WebAssembly.Module(r),e))}j2.instantiateSync=GRe;async function Pz(r,e){return WebAssembly.instantiateStreaming?cS(aS(e||(e={})),(await WebAssembly.instantiateStreaming(r,e)).instance):Tz(Iz(r=await r)?r.arrayBuffer():r,e)}j2.instantiateStreaming=Pz;function Cz(r,e){var t=e?Object.create(e):{},i=r.__argumentsLength?function(n){r.__argumentsLength.value=n}:r.__setArgumentsLength||r.__setargc||function(){};for(let n in r){if(!Object.prototype.hasOwnProperty.call(r,n))continue;let s=r[n],o=n.split("."),a=t;for(;o.length>1;){let l=o.shift();Object.prototype.hasOwnProperty.call(a,l)||(a[l]={}),a=a[l]}let c=o[0],u=c.indexOf("#");if(u>=0){let l=c.substring(0,u),d=a[l];if(typeof d=="undefined"||!d.prototype){let h=function(...p){return h.wrap(h.prototype.constructor(0,...p))};h.prototype={valueOf:function(){return this[L2]}},h.wrap=function(p){return Object.create(h.prototype,{[L2]:{value:p,writable:!1}})},d&&Object.getOwnPropertyNames(d).forEach(p=>Object.defineProperty(h,p,Object.getOwnPropertyDescriptor(d,p))),a[l]=h}if(c=c.substring(u+1),a=a[l].prototype,/^(get|set):/.test(c)){if(!Object.prototype.hasOwnProperty.call(a,c=c.substring(4))){let h=r[n.replace("set:","get:")],p=r[n.replace("get:","set:")];Object.defineProperty(a,c,{get:function(){return h(this[L2])},set:function(y){p(this[L2],y)},enumerable:!0})}}else c==="constructor"?(a[c]=(...h)=>(i(h.length),s(...h))).original=s:(a[c]=function(...h){return i(h.length),s(this[L2],...h)}).original=s}else/^(get|set):/.test(c)?Object.prototype.hasOwnProperty.call(a,c=c.substring(4))||Object.defineProperty(a,c,{get:r[n.replace("set:","get:")],set:r[n.replace("get:","set:")],enumerable:!0}):typeof s=="function"&&s!==i?(a[c]=(...l)=>(i(l.length),s(...l))).original=s:a[c]=s}return t}j2.demangle=Cz});var Dz=m((uft,kz)=>{f();var{instantiate:WRe}=Oz();uS.supported=typeof WebAssembly!="undefined";function uS(r={}){if(!uS.supported)return null;var e=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return WRe(new Response(new Blob([e],{type:"application/wasm"})),r)}kz.exports=uS});var Lz=m((lft,Bz)=>{f();var Nz=bz(),YRe=Dz(),XRe=async(r,e,t,i,n)=>{let s=await YRe();return new Nz(s,r,e,t,i,n)};Bz.exports={Rabin:Nz,create:XRe}});var Gz=m((Tft,$z)=>{f();"use strict";var V6=7;$z.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,t){let i=this._internalPositionFor(e,!1);if(t===void 0)i!==-1&&(this._unsetInternalPos(i),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let n=!1;i===-1?(i=this._data.length,this._setBit(e),this._changedData=!0):n=!0,this._setInternalPos(i,e,t,n),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();let t=this._internalPositionFor(e,!0);if(t!==-1)return this._data[t][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){let e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let t=0;for(;t<this.length;)e(this.get(t),t,this),t++}map(e){let t=0,i=new Array(this.length);for(;t<this.length;)i[t]=e(this.get(t),t,this),t++;return i}reduce(e,t){let i=0,n=t;for(;i<this.length;){let s=this.get(i);n=e(n,s,i),i++}return n}find(e){let t=0,i,n;for(;t<this.length&&!i;)n=this.get(t),i=e(n),t++;return i?n:void 0}_internalPositionFor(e,t){let i=this._bytePosFor(e,t);if(i>=this._bitArrays.length)return-1;let n=this._bitArrays[i],s=e-i*V6;if(!((n&1<<s)>0))return-1;let a=this._bitArrays.slice(0,i).reduce(sAe,0),c=~(4294967295<<s+1),u=Hz(n&c);return a+u-1}_bytePosFor(e,t){let i=Math.floor(e/V6),n=i+1;for(;!t&&this._bitArrays.length<n;)this._bitArrays.push(0);return i}_setBit(e){let t=this._bytePosFor(e,!1);this._bitArrays[t]|=1<<e-t*V6}_unsetBit(e){let t=this._bytePosFor(e,!1);this._bitArrays[t]&=~(1<<e-t*V6)}_setInternalPos(e,t,i,n){let s=this._data,o=[t,i];if(n)this._sortData(),s[e]=o;else{if(s.length)if(s[s.length-1][0]>=t)s.push(o);else if(s[0][0]<=t)s.unshift(o);else{let a=Math.round(s.length/2);this._data=s.slice(0,a).concat(o).concat(s.slice(a))}else this._data.push(o);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(oAe),this._changedData=!1}bitField(){let e=[],t=8,i=0,n=0,s,o=this._bitArrays.slice();for(;o.length||i;){i===0&&(s=o.shift(),i=7);let c=Math.min(i,t),u=~(255<<c);n|=(s&u)<<8-t,s=s>>>c,i-=c,t-=c,(!t||!i&&!o.length)&&(e.push(n),n=0,t=8)}for(var a=e.length-1;a>0&&e[a]===0;a--)e.pop();return e}compactArray(){return this._sortData(),this._data.map(aAe)}};function sAe(r,e){return r+Hz(e)}function Hz(r){let e=r;return e=e-(e>>1&1431655765),e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>24}function oAe(r,e){return r[0]-e[0]}function aAe(r){return r[1]}});var Xz=m((Pft,Yz)=>{f();"use strict";var cAe=Gz(),{fromString:uAe}=(ct(),Qr),ta=class{constructor(e,t,i=0){this._options=e,this._popCount=0,this._parent=t,this._posAtParent=i,this._children=new cAe,this.key=null}async put(e,t){let i=await this._findNewBucketAndPos(e);await i.bucket._putAt(i,e,t)}async get(e){let t=await this._findChild(e);if(t)return t.value}async del(e){let t=await this._findPlace(e),i=t.bucket._at(t.pos);i&&i.key===e&&t.bucket._delAt(t.pos)}leafCount(){return this._children.compactArray().reduce((t,i)=>i instanceof ta?t+i.leafCount():t+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let e=this._children.compactArray();for(let t of e)t instanceof ta?yield*t.eachLeafSeries():yield t;return[]}serialize(e,t){let i=[];return t(this._children.reduce((n,s,o)=>(s&&(s instanceof ta?n.push(s.serialize(e,t)):n.push(e(s,o))),n),i))}asyncTransform(e,t){return Wz(this,e,t)}toJSON(){return this.serialize(fAe,dAe)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){let t=await this._findPlace(e),i=t.bucket._at(t.pos);if(!(i instanceof ta)&&i&&i.key===e)return i}async _findPlace(e){let t=this._options.hash(typeof e=="string"?uAe(e):e),i=await t.take(this._options.bits),n=this._children.get(i);return n instanceof ta?n._findPlace(t):{bucket:this,pos:i,hash:t,existingChild:n}}async _findNewBucketAndPos(e){let t=await this._findPlace(e);if(t.existingChild&&t.existingChild.key!==e){let i=new ta(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,i);let n=await i._findPlace(t.existingChild.hash);return n.bucket._putAt(n,t.existingChild.key,t.existingChild.value),i._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,i){this._putObjectAt(e.pos,{key:t,value:i,hash:e.hash})}_putObjectAt(e,t){this._children.get(e)||this._popCount++,this._children.set(e,t)}_delAt(e){if(e===-1)throw new Error("Invalid position");this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(this._parent&&this._popCount<=1)if(this._popCount===1){let e=this._children.find(lAe);if(e&&!(e instanceof ta)){let t=e.hash;t.untake(this._options.bits);let i={pos:this._posAtParent,hash:t,bucket:this._parent};this._parent._putAt(i,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}};function lAe(r){return Boolean(r)}function fAe(r,e){return r.key}function dAe(r){return r}async function Wz(r,e,t){let i=[];for(let n of r._children.compactArray())if(n instanceof ta)await Wz(n,e,t);else{let s=await e(n);i.push({bitField:r._children.bitField(),children:s})}return t(i)}Yz.exports=ta});var Zz=m((Oft,Qz)=>{f();"use strict";var hAe=[255,254,252,248,240,224,192,128],pAe=[1,3,7,15,31,63,127,255];Qz.exports=class{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(e){let t=e,i=0;for(;t&&this._haveBits();){let n=this._value[this._currentBytePos],s=this._currentBitPos+1,o=Math.min(s,t),a=yAe(n,s-o,o);i=(i<<o)+a,t-=o,this._currentBitPos-=o,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return i}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function yAe(r,e,t){let i=gAe(e,t);return(r&i)>>>e}function gAe(r,e){return hAe[r]&pAe[Math.min(e+r-1,7)]}});var Jz=m((kft,hS)=>{f();"use strict";var mAe=Zz(),{concat:bAe}=(Si(),Pn);function wAe(r){function e(t){return t instanceof z6?t:new z6(t,r)}return e}var z6=class{constructor(e,t){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let i=0;for(;t>0;){let n=this._buffers[this._currentBufferIndex],s=Math.min(n.availableBits(),t),o=n.take(s);i=(i<<s)+o,t-=s,this._availableBits-=s,n.availableBits()===0&&this._currentBufferIndex++}return i}untake(e){let t=e;for(;t>0;){let i=this._buffers[this._currentBufferIndex],n=Math.min(i.totalBits()-i.availableBits(),t);i.untake(n),t-=n,this._availableBits+=n,this._currentBufferIndex>0&&i.totalBits()===i.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let e=this._depth?bAe([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),i=new mAe(t);this._buffers.push(i),this._availableBits+=i.availableBits()}};hS.exports=wAe;hS.exports.InfiniteHash=z6});var U2=m((Dft,tH)=>{f();"use strict";var eH=Xz(),_Ae=Jz();function vAe(r){if(!r||!r.hashFn)throw new Error("please define an options.hashFn");let e={bits:r.bits||8,hash:_Ae(r.hashFn)};return new eH(e)}tH.exports={createHAMT:vAe,Bucket:eH}});var nu=m((fdt,bH)=>{f();"use strict";function mH(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function OAe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return mH(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),mH(new n,t)}}bH.exports=OAe});var FH=m(rb=>{f();var{Buffer:wS}=ci(),n0=sn(),JAe="0".charCodeAt(0),exe=wS.from("ustar\0","binary"),txe=wS.from("ustar ","binary"),rxe=wS.from(" \0","binary"),tb=257,qH=263,ixe=function(r,e,t){return typeof r!="number"?t:(r=~~r,r>=e?e:r>=0||(r+=e,r>=0)?r:0)},nxe=function(r){switch(r){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null},UH=function(r,e,t,i){for(;t<i;t++)if(r.get(t)===e)return t;return i},sxe=function(r){let e=8*32;for(let t=0;t<148;t++)e+=r.get(t);for(let t=156;t<512;t++)e+=r.get(t);return e};function oxe(r){let e;if(r.get(0)===128)e=!0;else if(r.get(0)===255)e=!1;else return null;let t=!1,i=[];for(let o=r.length-1;o>0;o--){let a=r.get(o);e?i.push(a):t&&a===0?i.push(0):t?(t=!1,i.push(256-a)):i.push(255-a)}let n=0,s=i.length;for(let o=0;o<s;o++)n+=i[o]*Math.pow(256,o);return e?n:-1*n}var Al=function(r,e,t){if(r=r.shallowSlice(e,e+t),e=0,r.get(e)&128)return oxe(r);{for(;e<r.length&&r.get(e)===32;)e++;let i=ixe(UH(r,32,e,r.length),r.length,r.length);for(;e<i&&r.get(e)===0;)e++;return i===e?0:parseInt(r.shallowSlice(e,i).toString(),8)}},s0=function(r,e,t,i){return r.shallowSlice(e,UH(r,0,e,e+t)).toString(i)};rb.decodeLongPath=function(r,e){return r=n0.isBufferList(r)?r:new n0(r),s0(r,0,r.length,e)};rb.decodePax=function(r){r=n0.isBufferList(r)?r:new n0(r);let e={};for(;r.length;){let t=0;for(;t<r.length&&r.get(t)!==32;)t++;let i=parseInt(r.shallowSlice(0,t).toString(),10);if(!i)return e;let n=r.shallowSlice(t+1,i-1).toString(),s=n.indexOf("=");if(s===-1)return e;e[n.slice(0,s)]=n.slice(s+1),r=r.shallowSlice(i)}return e};rb.decode=function(r,e){r=n0.isBufferList(r)?r:new n0(r);let t=r.get(156)===0?0:r.get(156)-JAe,i=s0(r,0,100,e),n=Al(r,100,8),s=Al(r,108,8),o=Al(r,116,8),a=Al(r,124,12),c=Al(r,136,12),u=nxe(t),l=r.get(157)===0?null:s0(r,157,100,e),d=s0(r,265,32),h=s0(r,297,32),p=Al(r,329,8),y=Al(r,337,8),g=sxe(r);if(g===8*32)return null;if(g!==Al(r,148,8))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if(exe.compare(r.slice(tb,tb+6))===0)r.get(345)&&(i=s0(r,345,155,e)+"/"+i);else if(!(txe.compare(r.slice(tb,tb+6))===0&&rxe.compare(r.slice(qH,qH+2))===0))throw new Error("Invalid tar header: unknown format.");return t===0&&i&&i[i.length-1]==="/"&&(t=5),{name:i,mode:n,uid:s,gid:o,size:a,mtime:new Date(1e3*c),type:u,linkname:l,uname:d,gname:h,devmajor:p,devminor:y}}});var ib=m((fht,KH)=>{f();var _S=sn();KH.exports=r=>{let e=async function*(){let t=yield,i=new _S;for await(let n of r){if(!t){t=yield i.append(n),i=new _S;continue}for(i.append(n);i.length>=t;){let s=i.shallowSlice(0,t);if(i.consume(t),t=yield s,!t){i.length&&(t=yield i,i=new _S);break}}}if(t)throw Object.assign(new Error(`stream ended before ${t} bytes became available`),{code:"ERR_UNDER_READ",buffer:i})}();return e.next(),e}});var zH=m((dht,VH)=>{f();var vS=sn(),axe=ib();VH.exports=function(e){let t=axe(e),i,n={[Symbol.asyncIterator]:()=>n,async next(s){if(i){let o;if(s==null||i.length===s)o=i,i=null;else if(i.length>s)o=i.shallowSlice(0,s),i=i.shallowSlice(s);else if(i.length<s){let{value:a,done:c}=await t.next(s-i.length);if(c)throw Object.assign(new Error(`stream ended before ${s-i.length} bytes became available`),{code:"ERR_UNDER_READ"});o=new vS([i,a]),i=null}return{value:o}}return t.next(s)},async nextLte(s){let{done:o,value:a}=await n.next();return o?{done:o}:a.length<=s?{value:a}:(a=vS.isBufferList(a)?a:new vS(a),i?i.append(a.shallowSlice(s)):i=a.shallowSlice(s),{value:a.shallowSlice(0,s)})},return(){return t.return()}};return n}});var $H=m((hht,HH)=>{f();var cxe=Za(),K2=FH(),uxe=zH();function lxe(r){return r&=511,r&&512-r}async function V2(r,e){let t=lxe(e);t&&await r.next(t)}HH.exports=r=>(r=r||{},r.highWaterMark=r.highWaterMark||1024*16,e=>async function*(){let t=uxe(e),i,n,s,o;try{for(;;){let a;try{let{done:p,value:y}=await t.next(512);if(p)return;a=y}catch(p){if(p.code==="ERR_UNDER_READ")return;throw p}let c=K2.decode(a,r.filenameEncoding);if(!c)continue;if(c.type==="gnu-long-path"){let{done:p,value:y}=await t.next(c.size);if(p)return;i=K2.decodeLongPath(y,r.filenameEncoding),await V2(t,c.size);continue}if(c.type==="gnu-long-link-path"){let{done:p,value:y}=await t.next(c.size);if(p)return;n=K2.decodeLongPath(y,r.filenameEncoding),await V2(t,c.size);continue}if(c.type==="pax-global-header"){let{done:p,value:y}=await t.next(c.size);if(p)return;s=K2.decodePax(y,r.filenameEncoding),await V2(t,c.size);continue}if(c.type==="pax-header"){let{done:p,value:y}=await t.next(c.size);if(p)return;o=K2.decodePax(y,r.filenameEncoding),s&&(o={...s,...o}),await V2(t,c.size);continue}if(i&&(c.name=i,i=null),n&&(c.linkname=n,n=null),o&&(o.path&&(c.name=o.path),o.linkpath&&(c.linkname=o.linkpath),o.size&&(c.size=parseInt(o.size,10)),c.pax=o,o=null),!c.size||c.type==="directory"){yield{header:c,body:async function*(){}()};continue}let u=c.size,l=cxe(),d=await t.nextLte(Math.min(u,r.highWaterMark));u-=d.value.length,u||l.resolve();let h=async function*(){try{for(yield d.value;u;){let{done:p,value:y}=await t.nextLte(u);if(p){u=0;return}u-=y.length,yield y}}finally{l.resolve()}}();if(yield{header:c,body:h},await l.promise,u)for await(let p of h);await V2(t,c.size)}}finally{await t.return()}}())});var WH=m((pht,GH)=>{f();"use strict";GH.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:256,RTLD_LOCAL:0,RTLD_DEEPBIND:8,E2BIG:7,EACCES:13,EADDRINUSE:98,EADDRNOTAVAIL:99,EAFNOSUPPORT:97,EAGAIN:11,EALREADY:114,EBADF:9,EBADMSG:74,EBUSY:16,ECANCELED:125,ECHILD:10,ECONNABORTED:103,ECONNREFUSED:111,ECONNRESET:104,EDEADLK:35,EDESTADDRREQ:89,EDOM:33,EDQUOT:122,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:113,EIDRM:43,EILSEQ:84,EINPROGRESS:115,EINTR:4,EINVAL:22,EIO:5,EISCONN:106,EISDIR:21,ELOOP:40,EMFILE:24,EMLINK:31,EMSGSIZE:90,EMULTIHOP:72,ENAMETOOLONG:36,ENETDOWN:100,ENETRESET:102,ENETUNREACH:101,ENFILE:23,ENOBUFS:105,ENODATA:61,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:37,ENOLINK:67,ENOMEM:12,ENOMSG:42,ENOPROTOOPT:92,ENOSPC:28,ENOSR:63,ENOSTR:60,ENOSYS:38,ENOTCONN:107,ENOTDIR:20,ENOTEMPTY:39,ENOTSOCK:88,ENOTSUP:95,ENOTTY:25,ENXIO:6,EOPNOTSUPP:95,EOVERFLOW:75,EPERM:1,EPIPE:32,EPROTO:71,EPROTONOSUPPORT:93,EPROTOTYPE:91,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:116,ETIME:62,ETIMEDOUT:110,ETXTBSY:26,EWOULDBLOCK:11,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:7,SIGFPE:8,SIGKILL:9,SIGUSR1:10,SIGSEGV:11,SIGUSR2:12,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:17,SIGSTKFLT:16,SIGCONT:18,SIGSTOP:19,SIGTSTP:20,SIGTTIN:21,SIGTTOU:22,SIGURG:23,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:29,SIGPOLL:29,SIGPWR:30,SIGSYS:31,SIGUNUSED:31,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,UV_FS_O_FILEMAP:0,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DSYNC:4096,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488367,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}});var XH=m((yht,YH)=>{f();var fxe=sn(),ES={string:()=>"",buffer:()=>fxe()};YH.exports=async(r,e)=>{if(e=e||{},e.type&&!ES[e.type])throw new Error(`invalid type "${e.type}"`);let t,i;for await(let n of r)t||(i=e.type||(typeof n=="string"?"string":"buffer"),t=ES[i]()),i==="string"?t+=n:t.append(n);return t||ES[e.type||"buffer"]()}});var QH=m(RS=>{f();var{Buffer:Ja}=ci(),dxe=Ja.alloc,hxe="0000000000000000000",pxe="7777777777777777777",yxe="0".charCodeAt(0),gxe=Ja.from("ustar\0","binary"),mxe=Ja.from("00","binary"),bxe=parseInt("7777",8),wxe=257,_xe=263,vxe=function(r){switch(r){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0},Exe=function(r){let e=8*32;for(let t=0;t<148;t++)e+=r[t];for(let t=156;t<512;t++)e+=r[t];return e},xl=function(r,e){return r=r.toString(8),r.length>e?pxe.slice(0,e)+" ":hxe.slice(0,e-r.length)+r+" "},SS=function(r){let e=Ja.byteLength(r),t=Math.floor(Math.log(e)/Math.log(10))+1;return e+t>=Math.pow(10,t)&&t++,e+t+r};RS.encodePax=function(r){let e="";r.name&&(e+=SS(" path="+r.name+`
`)),r.linkname&&(e+=SS(" linkpath="+r.linkname+`
`));let t=r.pax;if(t)for(let i in t)e+=SS(" "+i+"="+t[i]+`
`);return Ja.from(e)};RS.encode=function(r){let e=dxe(512),t=r.name,i="";if(r.typeflag===5&&t[t.length-1]!=="/"&&(t+="/"),Ja.byteLength(t)!==t.length)return null;for(;Ja.byteLength(t)>100;){let n=t.indexOf("/");if(n===-1)return null;i+=i?"/"+t.slice(0,n):t.slice(0,n),t=t.slice(n+1)}return Ja.byteLength(t)>100||Ja.byteLength(i)>155||r.linkname&&Ja.byteLength(r.linkname)>100?null:(e.write(t),e.write(xl(r.mode&bxe,6),100),e.write(xl(r.uid,6),108),e.write(xl(r.gid,6),116),e.write(xl(r.size,11),124),e.write(xl(r.mtime.getTime()/1e3|0,11),136),e[156]=yxe+vxe(r.type),r.linkname&&e.write(r.linkname,157),gxe.copy(e,wxe),mxe.copy(e,_xe),r.uname&&e.write(r.uname,265),r.gname&&e.write(r.gname,297),e.write(xl(r.devmajor||0,6),329),e.write(xl(r.devminor||0,6),337),i&&e.write(i,345),e.write(xl(Exe(e),6),148),e)}});var e$=m((mht,JH)=>{f();var{Buffer:AS}=ci(),pd=sn(),{S_IFMT:Sxe,S_IFBLK:Rxe,S_IFCHR:Axe,S_IFDIR:xxe,S_IFIFO:Ixe,S_IFLNK:Txe}=WH(),Pxe=XH(),nb=QH(),Cxe=parseInt("755",8),Oxe=parseInt("644",8),ZH=AS.alloc(1024);function kxe(r){switch(r&Sxe){case Rxe:return"block-device";case Axe:return"character-device";case xxe:return"directory";case Ixe:return"fifo";case Txe:return"symlink"}return"file"}function xS(r){if(r&=511,r)return new pd(ZH.slice(0,512-r))}function IS(r){if(!r.pax){let e=nb.encode(r);if(e)return e}return Dxe(r)}function Dxe(r){let e=nb.encodePax({name:r.name,linkname:r.linkname,pax:r.pax}),t={name:"PaxHeader",mode:r.mode,uid:r.uid,gid:r.gid,size:e.length,mtime:r.mtime,type:"pax-header",linkname:r.linkname&&"PaxHeader",uname:r.uname,gname:r.gname,devmajor:r.devmajor,devminor:r.devminor};return new pd([nb.encode(t),e,xS(e.length),nb.encode({...t,size:r.size,type:r.type})])}JH.exports=()=>async function*(r){for await(let{header:e,body:t}of r){if((!e.size||e.type==="symlink")&&(e.size=0),e.type||(e.type=kxe(e.mode)),e.mode||(e.mode=e.type==="directory"?Cxe:Oxe),e.uid||(e.uid=0),e.gid||(e.gid=0),e.mtime||(e.mtime=new Date),typeof t=="string"&&(t=AS.from(t)),AS.isBuffer(t)||pd.isBufferList(t)){e.size=t.length,yield new pd([IS(e),t,xS(e.size)]);continue}if(e.type==="symlink"&&!e.linkname){e.linkname=(await Pxe(t)).toString(),yield IS(e);continue}if(yield IS(e),e.type!=="file"&&e.type!=="contiguous-file")continue;let i=0;for await(let s of t)i+=s.length,yield pd.isBufferList(s)?s:new pd(s);if(i!==e.size)throw new Error("size mismatch");let n=xS(e.size);n&&(yield n)}yield new pd(ZH)}});var t$=m(TS=>{f();TS.extract=$H();TS.pack=e$()});var su=m(Ln=>{f();"use strict";var Nxe=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function Bxe(r,e){return Object.prototype.hasOwnProperty.call(r,e)}Ln.assign=function(r){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var t=e.shift();if(!!t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(var i in t)Bxe(t,i)&&(r[i]=t[i])}}return r};Ln.shrinkBuf=function(r,e){return r.length===e?r:r.subarray?r.subarray(0,e):(r.length=e,r)};var Lxe={arraySet:function(r,e,t,i,n){if(e.subarray&&r.subarray){r.set(e.subarray(t,t+i),n);return}for(var s=0;s<i;s++)r[n+s]=e[t+s]},flattenChunks:function(r){var e,t,i,n,s,o;for(i=0,e=0,t=r.length;e<t;e++)i+=r[e].length;for(o=new Uint8Array(i),n=0,e=0,t=r.length;e<t;e++)s=r[e],o.set(s,n),n+=s.length;return o}},Mxe={arraySet:function(r,e,t,i,n){for(var s=0;s<i;s++)r[n+s]=e[t+s]},flattenChunks:function(r){return[].concat.apply([],r)}};Ln.setTyped=function(r){r?(Ln.Buf8=Uint8Array,Ln.Buf16=Uint16Array,Ln.Buf32=Int32Array,Ln.assign(Ln,Lxe)):(Ln.Buf8=Array,Ln.Buf16=Array,Ln.Buf32=Array,Ln.assign(Ln,Mxe))};Ln.setTyped(Nxe)});var R$=m(c0=>{f();"use strict";var jxe=su(),qxe=4,r$=0,i$=1,Uxe=2;function o0(r){for(var e=r.length;--e>=0;)r[e]=0}var Fxe=0,n$=1,Kxe=2,Vxe=3,zxe=258,PS=29,z2=256,H2=z2+1+PS,a0=30,CS=19,s$=2*H2+1,yd=15,OS=16,Hxe=7,kS=256,o$=16,a$=17,c$=18,DS=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],sb=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],$xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],u$=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Gxe=512,ou=new Array((H2+2)*2);o0(ou);var $2=new Array(a0*2);o0($2);var G2=new Array(Gxe);o0(G2);var W2=new Array(zxe-Vxe+1);o0(W2);var NS=new Array(PS);o0(NS);var ob=new Array(a0);o0(ob);function BS(r,e,t,i,n){this.static_tree=r,this.extra_bits=e,this.extra_base=t,this.elems=i,this.max_length=n,this.has_stree=r&&r.length}var l$,f$,d$;function LS(r,e){this.dyn_tree=r,this.max_code=0,this.stat_desc=e}function h$(r){return r<256?G2[r]:G2[256+(r>>>7)]}function Y2(r,e){r.pending_buf[r.pending++]=e&255,r.pending_buf[r.pending++]=e>>>8&255}function is(r,e,t){r.bi_valid>OS-t?(r.bi_buf|=e<<r.bi_valid&65535,Y2(r,r.bi_buf),r.bi_buf=e>>OS-r.bi_valid,r.bi_valid+=t-OS):(r.bi_buf|=e<<r.bi_valid&65535,r.bi_valid+=t)}function ec(r,e,t){is(r,t[e*2],t[e*2+1])}function p$(r,e){var t=0;do t|=r&1,r>>>=1,t<<=1;while(--e>0);return t>>>1}function Wxe(r){r.bi_valid===16?(Y2(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):r.bi_valid>=8&&(r.pending_buf[r.pending++]=r.bi_buf&255,r.bi_buf>>=8,r.bi_valid-=8)}function Yxe(r,e){var t=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,c=e.stat_desc.max_length,u,l,d,h,p,y,g=0;for(h=0;h<=yd;h++)r.bl_count[h]=0;for(t[r.heap[r.heap_max]*2+1]=0,u=r.heap_max+1;u<s$;u++)l=r.heap[u],h=t[t[l*2+1]*2+1]+1,h>c&&(h=c,g++),t[l*2+1]=h,!(l>i)&&(r.bl_count[h]++,p=0,l>=a&&(p=o[l-a]),y=t[l*2],r.opt_len+=y*(h+p),s&&(r.static_len+=y*(n[l*2+1]+p)));if(g!==0){do{for(h=c-1;r.bl_count[h]===0;)h--;r.bl_count[h]--,r.bl_count[h+1]+=2,r.bl_count[c]--,g-=2}while(g>0);for(h=c;h!==0;h--)for(l=r.bl_count[h];l!==0;)d=r.heap[--u],!(d>i)&&(t[d*2+1]!==h&&(r.opt_len+=(h-t[d*2+1])*t[d*2],t[d*2+1]=h),l--)}}function y$(r,e,t){var i=new Array(yd+1),n=0,s,o;for(s=1;s<=yd;s++)i[s]=n=n+t[s-1]<<1;for(o=0;o<=e;o++){var a=r[o*2+1];a!==0&&(r[o*2]=p$(i[a]++,a))}}function Xxe(){var r,e,t,i,n,s=new Array(yd+1);for(t=0,i=0;i<PS-1;i++)for(NS[i]=t,r=0;r<1<<DS[i];r++)W2[t++]=i;for(W2[t-1]=i,n=0,i=0;i<16;i++)for(ob[i]=n,r=0;r<1<<sb[i];r++)G2[n++]=i;for(n>>=7;i<a0;i++)for(ob[i]=n<<7,r=0;r<1<<sb[i]-7;r++)G2[256+n++]=i;for(e=0;e<=yd;e++)s[e]=0;for(r=0;r<=143;)ou[r*2+1]=8,r++,s[8]++;for(;r<=255;)ou[r*2+1]=9,r++,s[9]++;for(;r<=279;)ou[r*2+1]=7,r++,s[7]++;for(;r<=287;)ou[r*2+1]=8,r++,s[8]++;for(y$(ou,H2+1,s),r=0;r<a0;r++)$2[r*2+1]=5,$2[r*2]=p$(r,5);l$=new BS(ou,DS,z2+1,H2,yd),f$=new BS($2,sb,0,a0,yd),d$=new BS(new Array(0),$xe,0,CS,Hxe)}function g$(r){var e;for(e=0;e<H2;e++)r.dyn_ltree[e*2]=0;for(e=0;e<a0;e++)r.dyn_dtree[e*2]=0;for(e=0;e<CS;e++)r.bl_tree[e*2]=0;r.dyn_ltree[kS*2]=1,r.opt_len=r.static_len=0,r.last_lit=r.matches=0}function m$(r){r.bi_valid>8?Y2(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0}function Qxe(r,e,t,i){m$(r),i&&(Y2(r,t),Y2(r,~t)),jxe.arraySet(r.pending_buf,r.window,e,t,r.pending),r.pending+=t}function b$(r,e,t,i){var n=e*2,s=t*2;return r[n]<r[s]||r[n]===r[s]&&i[e]<=i[t]}function MS(r,e,t){for(var i=r.heap[t],n=t<<1;n<=r.heap_len&&(n<r.heap_len&&b$(e,r.heap[n+1],r.heap[n],r.depth)&&n++,!b$(e,i,r.heap[n],r.depth));)r.heap[t]=r.heap[n],t=n,n<<=1;r.heap[t]=i}function w$(r,e,t){var i,n,s=0,o,a;if(r.last_lit!==0)do i=r.pending_buf[r.d_buf+s*2]<<8|r.pending_buf[r.d_buf+s*2+1],n=r.pending_buf[r.l_buf+s],s++,i===0?ec(r,n,e):(o=W2[n],ec(r,o+z2+1,e),a=DS[o],a!==0&&(n-=NS[o],is(r,n,a)),i--,o=h$(i),ec(r,o,t),a=sb[o],a!==0&&(i-=ob[o],is(r,i,a)));while(s<r.last_lit);ec(r,kS,e)}function jS(r,e){var t=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems,o,a,c=-1,u;for(r.heap_len=0,r.heap_max=s$,o=0;o<s;o++)t[o*2]!==0?(r.heap[++r.heap_len]=c=o,r.depth[o]=0):t[o*2+1]=0;for(;r.heap_len<2;)u=r.heap[++r.heap_len]=c<2?++c:0,t[u*2]=1,r.depth[u]=0,r.opt_len--,n&&(r.static_len-=i[u*2+1]);for(e.max_code=c,o=r.heap_len>>1;o>=1;o--)MS(r,t,o);u=s;do o=r.heap[1],r.heap[1]=r.heap[r.heap_len--],MS(r,t,1),a=r.heap[1],r.heap[--r.heap_max]=o,r.heap[--r.heap_max]=a,t[u*2]=t[o*2]+t[a*2],r.depth[u]=(r.depth[o]>=r.depth[a]?r.depth[o]:r.depth[a])+1,t[o*2+1]=t[a*2+1]=u,r.heap[1]=u++,MS(r,t,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],Yxe(r,e),y$(t,c,r.bl_count)}function _$(r,e,t){var i,n=-1,s,o=e[0*2+1],a=0,c=7,u=4;for(o===0&&(c=138,u=3),e[(t+1)*2+1]=65535,i=0;i<=t;i++)s=o,o=e[(i+1)*2+1],!(++a<c&&s===o)&&(a<u?r.bl_tree[s*2]+=a:s!==0?(s!==n&&r.bl_tree[s*2]++,r.bl_tree[o$*2]++):a<=10?r.bl_tree[a$*2]++:r.bl_tree[c$*2]++,a=0,n=s,o===0?(c=138,u=3):s===o?(c=6,u=3):(c=7,u=4))}function v$(r,e,t){var i,n=-1,s,o=e[0*2+1],a=0,c=7,u=4;for(o===0&&(c=138,u=3),i=0;i<=t;i++)if(s=o,o=e[(i+1)*2+1],!(++a<c&&s===o)){if(a<u)do ec(r,s,r.bl_tree);while(--a!=0);else s!==0?(s!==n&&(ec(r,s,r.bl_tree),a--),ec(r,o$,r.bl_tree),is(r,a-3,2)):a<=10?(ec(r,a$,r.bl_tree),is(r,a-3,3)):(ec(r,c$,r.bl_tree),is(r,a-11,7));a=0,n=s,o===0?(c=138,u=3):s===o?(c=6,u=3):(c=7,u=4)}}function Zxe(r){var e;for(_$(r,r.dyn_ltree,r.l_desc.max_code),_$(r,r.dyn_dtree,r.d_desc.max_code),jS(r,r.bl_desc),e=CS-1;e>=3&&r.bl_tree[u$[e]*2+1]===0;e--);return r.opt_len+=3*(e+1)+5+5+4,e}function Jxe(r,e,t,i){var n;for(is(r,e-257,5),is(r,t-1,5),is(r,i-4,4),n=0;n<i;n++)is(r,r.bl_tree[u$[n]*2+1],3);v$(r,r.dyn_ltree,e-1),v$(r,r.dyn_dtree,t-1)}function eIe(r){var e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&r.dyn_ltree[t*2]!==0)return r$;if(r.dyn_ltree[9*2]!==0||r.dyn_ltree[10*2]!==0||r.dyn_ltree[13*2]!==0)return i$;for(t=32;t<z2;t++)if(r.dyn_ltree[t*2]!==0)return i$;return r$}var E$=!1;function tIe(r){E$||(Xxe(),E$=!0),r.l_desc=new LS(r.dyn_ltree,l$),r.d_desc=new LS(r.dyn_dtree,f$),r.bl_desc=new LS(r.bl_tree,d$),r.bi_buf=0,r.bi_valid=0,g$(r)}function S$(r,e,t,i){is(r,(Fxe<<1)+(i?1:0),3),Qxe(r,e,t,!0)}function rIe(r){is(r,n$<<1,3),ec(r,kS,ou),Wxe(r)}function iIe(r,e,t,i){var n,s,o=0;r.level>0?(r.strm.data_type===Uxe&&(r.strm.data_type=eIe(r)),jS(r,r.l_desc),jS(r,r.d_desc),o=Zxe(r),n=r.opt_len+3+7>>>3,s=r.static_len+3+7>>>3,s<=n&&(n=s)):n=s=t+5,t+4<=n&&e!==-1?S$(r,e,t,i):r.strategy===qxe||s===n?(is(r,(n$<<1)+(i?1:0),3),w$(r,ou,$2)):(is(r,(Kxe<<1)+(i?1:0),3),Jxe(r,r.l_desc.max_code+1,r.d_desc.max_code+1,o+1),w$(r,r.dyn_ltree,r.dyn_dtree)),g$(r),i&&m$(r)}function nIe(r,e,t){return r.pending_buf[r.d_buf+r.last_lit*2]=e>>>8&255,r.pending_buf[r.d_buf+r.last_lit*2+1]=e&255,r.pending_buf[r.l_buf+r.last_lit]=t&255,r.last_lit++,e===0?r.dyn_ltree[t*2]++:(r.matches++,e--,r.dyn_ltree[(W2[t]+z2+1)*2]++,r.dyn_dtree[h$(e)*2]++),r.last_lit===r.lit_bufsize-1}c0._tr_init=tIe;c0._tr_stored_block=S$;c0._tr_flush_block=iIe;c0._tr_tally=nIe;c0._tr_align=rIe});var qS=m((vht,A$)=>{f();"use strict";function sIe(r,e,t,i){for(var n=r&65535|0,s=r>>>16&65535|0,o=0;t!==0;){o=t>2e3?2e3:t,t-=o;do n=n+e[i++]|0,s=s+n|0;while(--o);n%=65521,s%=65521}return n|s<<16|0}A$.exports=sIe});var US=m((Eht,x$)=>{f();"use strict";function oIe(){for(var r,e=[],t=0;t<256;t++){r=t;for(var i=0;i<8;i++)r=r&1?3988292384^r>>>1:r>>>1;e[t]=r}return e}var aIe=oIe();function cIe(r,e,t,i){var n=aIe,s=i+t;r^=-1;for(var o=i;o<s;o++)r=r>>>8^n[(r^e[o])&255];return r^-1}x$.exports=cIe});var ab=m((Sht,I$)=>{f();"use strict";I$.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var L$=m(ic=>{f();"use strict";var Mn=su(),oo=R$(),T$=qS(),Il=US(),uIe=ab(),gd=0,lIe=1,fIe=3,Tl=4,P$=5,tc=0,C$=1,ao=-2,dIe=-3,FS=-5,hIe=-1,pIe=1,cb=2,yIe=3,gIe=4,mIe=0,bIe=2,ub=8,wIe=9,_Ie=15,vIe=8,EIe=29,SIe=256,KS=SIe+1+EIe,RIe=30,AIe=19,xIe=2*KS+1,IIe=15,Lt=3,Pl=258,ra=Pl+Lt+1,TIe=32,lb=42,VS=69,fb=73,db=91,hb=103,md=113,X2=666,Mi=1,Q2=2,bd=3,u0=4,PIe=3;function Cl(r,e){return r.msg=uIe[e],e}function O$(r){return(r<<1)-(r>4?9:0)}function Ol(r){for(var e=r.length;--e>=0;)r[e]=0}function kl(r){var e=r.state,t=e.pending;t>r.avail_out&&(t=r.avail_out),t!==0&&(Mn.arraySet(r.output,e.pending_buf,e.pending_out,t,r.next_out),r.next_out+=t,e.pending_out+=t,r.total_out+=t,r.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))}function an(r,e){oo._tr_flush_block(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,e),r.block_start=r.strstart,kl(r.strm)}function Yt(r,e){r.pending_buf[r.pending++]=e}function Z2(r,e){r.pending_buf[r.pending++]=e>>>8&255,r.pending_buf[r.pending++]=e&255}function CIe(r,e,t,i){var n=r.avail_in;return n>i&&(n=i),n===0?0:(r.avail_in-=n,Mn.arraySet(e,r.input,r.next_in,n,t),r.state.wrap===1?r.adler=T$(r.adler,e,n,t):r.state.wrap===2&&(r.adler=Il(r.adler,e,n,t)),r.next_in+=n,r.total_in+=n,n)}function k$(r,e){var t=r.max_chain_length,i=r.strstart,n,s,o=r.prev_length,a=r.nice_match,c=r.strstart>r.w_size-ra?r.strstart-(r.w_size-ra):0,u=r.window,l=r.w_mask,d=r.prev,h=r.strstart+Pl,p=u[i+o-1],y=u[i+o];r.prev_length>=r.good_match&&(t>>=2),a>r.lookahead&&(a=r.lookahead);do if(n=e,!(u[n+o]!==y||u[n+o-1]!==p||u[n]!==u[i]||u[++n]!==u[i+1])){i+=2,n++;do;while(u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&i<h);if(s=Pl-(h-i),i=h-Pl,s>o){if(r.match_start=e,o=s,s>=a)break;p=u[i+o-1],y=u[i+o]}}while((e=d[e&l])>c&&--t!=0);return o<=r.lookahead?o:r.lookahead}function wd(r){var e=r.w_size,t,i,n,s,o;do{if(s=r.window_size-r.lookahead-r.strstart,r.strstart>=e+(e-ra)){Mn.arraySet(r.window,r.window,e,e,0),r.match_start-=e,r.strstart-=e,r.block_start-=e,i=r.hash_size,t=i;do n=r.head[--t],r.head[t]=n>=e?n-e:0;while(--i);i=e,t=i;do n=r.prev[--t],r.prev[t]=n>=e?n-e:0;while(--i);s+=e}if(r.strm.avail_in===0)break;if(i=CIe(r.strm,r.window,r.strstart+r.lookahead,s),r.lookahead+=i,r.lookahead+r.insert>=Lt)for(o=r.strstart-r.insert,r.ins_h=r.window[o],r.ins_h=(r.ins_h<<r.hash_shift^r.window[o+1])&r.hash_mask;r.insert&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[o+Lt-1])&r.hash_mask,r.prev[o&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=o,o++,r.insert--,!(r.lookahead+r.insert<Lt)););}while(r.lookahead<ra&&r.strm.avail_in!==0)}function OIe(r,e){var t=65535;for(t>r.pending_buf_size-5&&(t=r.pending_buf_size-5);;){if(r.lookahead<=1){if(wd(r),r.lookahead===0&&e===gd)return Mi;if(r.lookahead===0)break}r.strstart+=r.lookahead,r.lookahead=0;var i=r.block_start+t;if((r.strstart===0||r.strstart>=i)&&(r.lookahead=r.strstart-i,r.strstart=i,an(r,!1),r.strm.avail_out===0)||r.strstart-r.block_start>=r.w_size-ra&&(an(r,!1),r.strm.avail_out===0))return Mi}return r.insert=0,e===Tl?(an(r,!0),r.strm.avail_out===0?bd:u0):(r.strstart>r.block_start&&(an(r,!1),r.strm.avail_out===0),Mi)}function zS(r,e){for(var t,i;;){if(r.lookahead<ra){if(wd(r),r.lookahead<ra&&e===gd)return Mi;if(r.lookahead===0)break}if(t=0,r.lookahead>=Lt&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Lt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),t!==0&&r.strstart-t<=r.w_size-ra&&(r.match_length=k$(r,t)),r.match_length>=Lt)if(i=oo._tr_tally(r,r.strstart-r.match_start,r.match_length-Lt),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=Lt){r.match_length--;do r.strstart++,r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Lt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!=0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+1])&r.hash_mask;else i=oo._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(i&&(an(r,!1),r.strm.avail_out===0))return Mi}return r.insert=r.strstart<Lt-1?r.strstart:Lt-1,e===Tl?(an(r,!0),r.strm.avail_out===0?bd:u0):r.last_lit&&(an(r,!1),r.strm.avail_out===0)?Mi:Q2}function l0(r,e){for(var t,i,n;;){if(r.lookahead<ra){if(wd(r),r.lookahead<ra&&e===gd)return Mi;if(r.lookahead===0)break}if(t=0,r.lookahead>=Lt&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Lt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=Lt-1,t!==0&&r.prev_length<r.max_lazy_match&&r.strstart-t<=r.w_size-ra&&(r.match_length=k$(r,t),r.match_length<=5&&(r.strategy===pIe||r.match_length===Lt&&r.strstart-r.match_start>4096)&&(r.match_length=Lt-1)),r.prev_length>=Lt&&r.match_length<=r.prev_length){n=r.strstart+r.lookahead-Lt,i=oo._tr_tally(r,r.strstart-1-r.prev_match,r.prev_length-Lt),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=n&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Lt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!=0);if(r.match_available=0,r.match_length=Lt-1,r.strstart++,i&&(an(r,!1),r.strm.avail_out===0))return Mi}else if(r.match_available){if(i=oo._tr_tally(r,0,r.window[r.strstart-1]),i&&an(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return Mi}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(i=oo._tr_tally(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<Lt-1?r.strstart:Lt-1,e===Tl?(an(r,!0),r.strm.avail_out===0?bd:u0):r.last_lit&&(an(r,!1),r.strm.avail_out===0)?Mi:Q2}function kIe(r,e){for(var t,i,n,s,o=r.window;;){if(r.lookahead<=Pl){if(wd(r),r.lookahead<=Pl&&e===gd)return Mi;if(r.lookahead===0)break}if(r.match_length=0,r.lookahead>=Lt&&r.strstart>0&&(n=r.strstart-1,i=o[n],i===o[++n]&&i===o[++n]&&i===o[++n])){s=r.strstart+Pl;do;while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<s);r.match_length=Pl-(s-n),r.match_length>r.lookahead&&(r.match_length=r.lookahead)}if(r.match_length>=Lt?(t=oo._tr_tally(r,1,r.match_length-Lt),r.lookahead-=r.match_length,r.strstart+=r.match_length,r.match_length=0):(t=oo._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++),t&&(an(r,!1),r.strm.avail_out===0))return Mi}return r.insert=0,e===Tl?(an(r,!0),r.strm.avail_out===0?bd:u0):r.last_lit&&(an(r,!1),r.strm.avail_out===0)?Mi:Q2}function DIe(r,e){for(var t;;){if(r.lookahead===0&&(wd(r),r.lookahead===0)){if(e===gd)return Mi;break}if(r.match_length=0,t=oo._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++,t&&(an(r,!1),r.strm.avail_out===0))return Mi}return r.insert=0,e===Tl?(an(r,!0),r.strm.avail_out===0?bd:u0):r.last_lit&&(an(r,!1),r.strm.avail_out===0)?Mi:Q2}function rc(r,e,t,i,n){this.good_length=r,this.max_lazy=e,this.nice_length=t,this.max_chain=i,this.func=n}var f0;f0=[new rc(0,0,0,0,OIe),new rc(4,4,8,4,zS),new rc(4,5,16,8,zS),new rc(4,6,32,32,zS),new rc(4,4,16,16,l0),new rc(8,16,32,32,l0),new rc(8,16,128,128,l0),new rc(8,32,128,256,l0),new rc(32,128,258,1024,l0),new rc(32,258,258,4096,l0)];function NIe(r){r.window_size=2*r.w_size,Ol(r.head),r.max_lazy_match=f0[r.level].max_lazy,r.good_match=f0[r.level].good_length,r.nice_match=f0[r.level].nice_length,r.max_chain_length=f0[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=Lt-1,r.match_available=0,r.ins_h=0}function BIe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ub,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Mn.Buf16(xIe*2),this.dyn_dtree=new Mn.Buf16((2*RIe+1)*2),this.bl_tree=new Mn.Buf16((2*AIe+1)*2),Ol(this.dyn_ltree),Ol(this.dyn_dtree),Ol(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Mn.Buf16(IIe+1),this.heap=new Mn.Buf16(2*KS+1),Ol(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Mn.Buf16(2*KS+1),Ol(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function D$(r){var e;return!r||!r.state?Cl(r,ao):(r.total_in=r.total_out=0,r.data_type=bIe,e=r.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?lb:md,r.adler=e.wrap===2?0:1,e.last_flush=gd,oo._tr_init(e),tc)}function N$(r){var e=D$(r);return e===tc&&NIe(r.state),e}function LIe(r,e){return!r||!r.state||r.state.wrap!==2?ao:(r.state.gzhead=e,tc)}function B$(r,e,t,i,n,s){if(!r)return ao;var o=1;if(e===hIe&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),n<1||n>wIe||t!==ub||i<8||i>15||e<0||e>9||s<0||s>gIe)return Cl(r,ao);i===8&&(i=9);var a=new BIe;return r.state=a,a.strm=r,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=n+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+Lt-1)/Lt),a.window=new Mn.Buf8(a.w_size*2),a.head=new Mn.Buf16(a.hash_size),a.prev=new Mn.Buf16(a.w_size),a.lit_bufsize=1<<n+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Mn.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=(1+2)*a.lit_bufsize,a.level=e,a.strategy=s,a.method=t,N$(r)}function MIe(r,e){return B$(r,e,ub,_Ie,vIe,mIe)}function jIe(r,e){var t,i,n,s;if(!r||!r.state||e>P$||e<0)return r?Cl(r,ao):ao;if(i=r.state,!r.output||!r.input&&r.avail_in!==0||i.status===X2&&e!==Tl)return Cl(r,r.avail_out===0?FS:ao);if(i.strm=r,t=i.last_flush,i.last_flush=e,i.status===lb)if(i.wrap===2)r.adler=0,Yt(i,31),Yt(i,139),Yt(i,8),i.gzhead?(Yt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Yt(i,i.gzhead.time&255),Yt(i,i.gzhead.time>>8&255),Yt(i,i.gzhead.time>>16&255),Yt(i,i.gzhead.time>>24&255),Yt(i,i.level===9?2:i.strategy>=cb||i.level<2?4:0),Yt(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(Yt(i,i.gzhead.extra.length&255),Yt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(r.adler=Il(r.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=VS):(Yt(i,0),Yt(i,0),Yt(i,0),Yt(i,0),Yt(i,0),Yt(i,i.level===9?2:i.strategy>=cb||i.level<2?4:0),Yt(i,PIe),i.status=md);else{var o=ub+(i.w_bits-8<<4)<<8,a=-1;i.strategy>=cb||i.level<2?a=0:i.level<6?a=1:i.level===6?a=2:a=3,o|=a<<6,i.strstart!==0&&(o|=TIe),o+=31-o%31,i.status=md,Z2(i,o),i.strstart!==0&&(Z2(i,r.adler>>>16),Z2(i,r.adler&65535)),r.adler=1}if(i.status===VS)if(i.gzhead.extra){for(n=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(r.adler=Il(r.adler,i.pending_buf,i.pending-n,n)),kl(r),n=i.pending,i.pending===i.pending_buf_size));)Yt(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>n&&(r.adler=Il(r.adler,i.pending_buf,i.pending-n,n)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=fb)}else i.status=fb;if(i.status===fb)if(i.gzhead.name){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(r.adler=Il(r.adler,i.pending_buf,i.pending-n,n)),kl(r),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.name.length?s=i.gzhead.name.charCodeAt(i.gzindex++)&255:s=0,Yt(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(r.adler=Il(r.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.gzindex=0,i.status=db)}else i.status=db;if(i.status===db)if(i.gzhead.comment){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(r.adler=Il(r.adler,i.pending_buf,i.pending-n,n)),kl(r),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.comment.length?s=i.gzhead.comment.charCodeAt(i.gzindex++)&255:s=0,Yt(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(r.adler=Il(r.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.status=hb)}else i.status=hb;if(i.status===hb&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&kl(r),i.pending+2<=i.pending_buf_size&&(Yt(i,r.adler&255),Yt(i,r.adler>>8&255),r.adler=0,i.status=md)):i.status=md),i.pending!==0){if(kl(r),r.avail_out===0)return i.last_flush=-1,tc}else if(r.avail_in===0&&O$(e)<=O$(t)&&e!==Tl)return Cl(r,FS);if(i.status===X2&&r.avail_in!==0)return Cl(r,FS);if(r.avail_in!==0||i.lookahead!==0||e!==gd&&i.status!==X2){var c=i.strategy===cb?DIe(i,e):i.strategy===yIe?kIe(i,e):f0[i.level].func(i,e);if((c===bd||c===u0)&&(i.status=X2),c===Mi||c===bd)return r.avail_out===0&&(i.last_flush=-1),tc;if(c===Q2&&(e===lIe?oo._tr_align(i):e!==P$&&(oo._tr_stored_block(i,0,0,!1),e===fIe&&(Ol(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),kl(r),r.avail_out===0))return i.last_flush=-1,tc}return e!==Tl?tc:i.wrap<=0?C$:(i.wrap===2?(Yt(i,r.adler&255),Yt(i,r.adler>>8&255),Yt(i,r.adler>>16&255),Yt(i,r.adler>>24&255),Yt(i,r.total_in&255),Yt(i,r.total_in>>8&255),Yt(i,r.total_in>>16&255),Yt(i,r.total_in>>24&255)):(Z2(i,r.adler>>>16),Z2(i,r.adler&65535)),kl(r),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?tc:C$)}function qIe(r){var e;return!r||!r.state?ao:(e=r.state.status,e!==lb&&e!==VS&&e!==fb&&e!==db&&e!==hb&&e!==md&&e!==X2?Cl(r,ao):(r.state=null,e===md?Cl(r,dIe):tc))}function UIe(r,e){var t=e.length,i,n,s,o,a,c,u,l;if(!r||!r.state||(i=r.state,o=i.wrap,o===2||o===1&&i.status!==lb||i.lookahead))return ao;for(o===1&&(r.adler=T$(r.adler,e,t,0)),i.wrap=0,t>=i.w_size&&(o===0&&(Ol(i.head),i.strstart=0,i.block_start=0,i.insert=0),l=new Mn.Buf8(i.w_size),Mn.arraySet(l,e,t-i.w_size,i.w_size,0),e=l,t=i.w_size),a=r.avail_in,c=r.next_in,u=r.input,r.avail_in=t,r.next_in=0,r.input=e,wd(i);i.lookahead>=Lt;){n=i.strstart,s=i.lookahead-(Lt-1);do i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+Lt-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++;while(--s);i.strstart=n,i.lookahead=Lt-1,wd(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=Lt-1,i.match_available=0,r.next_in=c,r.input=u,r.avail_in=a,i.wrap=o,tc}ic.deflateInit=MIe;ic.deflateInit2=B$;ic.deflateReset=N$;ic.deflateResetKeep=D$;ic.deflateSetHeader=LIe;ic.deflate=jIe;ic.deflateEnd=qIe;ic.deflateSetDictionary=UIe;ic.deflateInfo="pako deflate (from Nodeca project)"});var HS=m(d0=>{f();"use strict";var pb=su(),M$=!0,j$=!0;try{String.fromCharCode.apply(null,[0])}catch(r){M$=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(r){j$=!1}var J2=new pb.Buf8(256);for(au=0;au<256;au++)J2[au]=au>=252?6:au>=248?5:au>=240?4:au>=224?3:au>=192?2:1;var au;J2[254]=J2[254]=1;d0.string2buf=function(r){var e,t,i,n,s,o=r.length,a=0;for(n=0;n<o;n++)t=r.charCodeAt(n),(t&64512)==55296&&n+1<o&&(i=r.charCodeAt(n+1),(i&64512)==56320&&(t=65536+(t-55296<<10)+(i-56320),n++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new pb.Buf8(a),s=0,n=0;s<a;n++)t=r.charCodeAt(n),(t&64512)==55296&&n+1<o&&(i=r.charCodeAt(n+1),(i&64512)==56320&&(t=65536+(t-55296<<10)+(i-56320),n++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e};function q$(r,e){if(e<65534&&(r.subarray&&j$||!r.subarray&&M$))return String.fromCharCode.apply(null,pb.shrinkBuf(r,e));for(var t="",i=0;i<e;i++)t+=String.fromCharCode(r[i]);return t}d0.buf2binstring=function(r){return q$(r,r.length)};d0.binstring2buf=function(r){for(var e=new pb.Buf8(r.length),t=0,i=e.length;t<i;t++)e[t]=r.charCodeAt(t);return e};d0.buf2string=function(r,e){var t,i,n,s,o=e||r.length,a=new Array(o*2);for(i=0,t=0;t<o;){if(n=r[t++],n<128){a[i++]=n;continue}if(s=J2[n],s>4){a[i++]=65533,t+=s-1;continue}for(n&=s===2?31:s===3?15:7;s>1&&t<o;)n=n<<6|r[t++]&63,s--;if(s>1){a[i++]=65533;continue}n<65536?a[i++]=n:(n-=65536,a[i++]=55296|n>>10&1023,a[i++]=56320|n&1023)}return q$(a,i)};d0.utf8border=function(r,e){var t;for(e=e||r.length,e>r.length&&(e=r.length),t=e-1;t>=0&&(r[t]&192)==128;)t--;return t<0||t===0?e:t+J2[r[t]]>e?t:e}});var $S=m((xht,U$)=>{f();"use strict";function FIe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}U$.exports=FIe});var z$=m(rg=>{f();"use strict";var eg=L$(),tg=su(),GS=HS(),WS=ab(),KIe=$S(),F$=Object.prototype.toString,VIe=0,YS=4,h0=0,K$=1,V$=2,zIe=-1,HIe=0,$Ie=8;function _d(r){if(!(this instanceof _d))return new _d(r);this.options=tg.assign({level:zIe,method:$Ie,chunkSize:16384,windowBits:15,memLevel:8,strategy:HIe,to:""},r||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new KIe,this.strm.avail_out=0;var t=eg.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==h0)throw new Error(WS[t]);if(e.header&&eg.deflateSetHeader(this.strm,e.header),e.dictionary){var i;if(typeof e.dictionary=="string"?i=GS.string2buf(e.dictionary):F$.call(e.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(e.dictionary):i=e.dictionary,t=eg.deflateSetDictionary(this.strm,i),t!==h0)throw new Error(WS[t]);this._dict_set=!0}}_d.prototype.push=function(r,e){var t=this.strm,i=this.options.chunkSize,n,s;if(this.ended)return!1;s=e===~~e?e:e===!0?YS:VIe,typeof r=="string"?t.input=GS.string2buf(r):F$.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new tg.Buf8(i),t.next_out=0,t.avail_out=i),n=eg.deflate(t,s),n!==K$&&n!==h0)return this.onEnd(n),this.ended=!0,!1;(t.avail_out===0||t.avail_in===0&&(s===YS||s===V$))&&(this.options.to==="string"?this.onData(GS.buf2binstring(tg.shrinkBuf(t.output,t.next_out))):this.onData(tg.shrinkBuf(t.output,t.next_out)))}while((t.avail_in>0||t.avail_out===0)&&n!==K$);return s===YS?(n=eg.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===h0):(s===V$&&(this.onEnd(h0),t.avail_out=0),!0)};_d.prototype.onData=function(r){this.chunks.push(r)};_d.prototype.onEnd=function(r){r===h0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=tg.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function XS(r,e){var t=new _d(e);if(t.push(r,!0),t.err)throw t.msg||WS[t.err];return t.result}function GIe(r,e){return e=e||{},e.raw=!0,XS(r,e)}function WIe(r,e){return e=e||{},e.gzip=!0,XS(r,e)}rg.Deflate=_d;rg.deflate=XS;rg.deflateRaw=GIe;rg.gzip=WIe});var $$=m((Tht,H$)=>{f();"use strict";var yb=30,YIe=12;H$.exports=function(e,t){var i,n,s,o,a,c,u,l,d,h,p,y,g,w,b,v,A,k,C,T,D,j,M,se,ie;i=e.state,n=e.next_in,se=e.input,s=n+(e.avail_in-5),o=e.next_out,ie=e.output,a=o-(t-e.avail_out),c=o+(e.avail_out-257),u=i.dmax,l=i.wsize,d=i.whave,h=i.wnext,p=i.window,y=i.hold,g=i.bits,w=i.lencode,b=i.distcode,v=(1<<i.lenbits)-1,A=(1<<i.distbits)-1;e:do{g<15&&(y+=se[n++]<<g,g+=8,y+=se[n++]<<g,g+=8),k=w[y&v];t:for(;;){if(C=k>>>24,y>>>=C,g-=C,C=k>>>16&255,C===0)ie[o++]=k&65535;else if(C&16){T=k&65535,C&=15,C&&(g<C&&(y+=se[n++]<<g,g+=8),T+=y&(1<<C)-1,y>>>=C,g-=C),g<15&&(y+=se[n++]<<g,g+=8,y+=se[n++]<<g,g+=8),k=b[y&A];r:for(;;){if(C=k>>>24,y>>>=C,g-=C,C=k>>>16&255,C&16){if(D=k&65535,C&=15,g<C&&(y+=se[n++]<<g,g+=8,g<C&&(y+=se[n++]<<g,g+=8)),D+=y&(1<<C)-1,D>u){e.msg="invalid distance too far back",i.mode=yb;break e}if(y>>>=C,g-=C,C=o-a,D>C){if(C=D-C,C>d&&i.sane){e.msg="invalid distance too far back",i.mode=yb;break e}if(j=0,M=p,h===0){if(j+=l-C,C<T){T-=C;do ie[o++]=p[j++];while(--C);j=o-D,M=ie}}else if(h<C){if(j+=l+h-C,C-=h,C<T){T-=C;do ie[o++]=p[j++];while(--C);if(j=0,h<T){C=h,T-=C;do ie[o++]=p[j++];while(--C);j=o-D,M=ie}}}else if(j+=h-C,C<T){T-=C;do ie[o++]=p[j++];while(--C);j=o-D,M=ie}for(;T>2;)ie[o++]=M[j++],ie[o++]=M[j++],ie[o++]=M[j++],T-=3;T&&(ie[o++]=M[j++],T>1&&(ie[o++]=M[j++]))}else{j=o-D;do ie[o++]=ie[j++],ie[o++]=ie[j++],ie[o++]=ie[j++],T-=3;while(T>2);T&&(ie[o++]=ie[j++],T>1&&(ie[o++]=ie[j++]))}}else if((C&64)==0){k=b[(k&65535)+(y&(1<<C)-1)];continue r}else{e.msg="invalid distance code",i.mode=yb;break e}break}}else if((C&64)==0){k=w[(k&65535)+(y&(1<<C)-1)];continue t}else if(C&32){i.mode=YIe;break e}else{e.msg="invalid literal/length code",i.mode=yb;break e}break}}while(n<s&&o<c);T=g>>3,n-=T,g-=T<<3,y&=(1<<g)-1,e.next_in=n,e.next_out=o,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=o<c?257+(c-o):257-(o-c),i.hold=y,i.bits=g}});var J$=m((Pht,Z$)=>{f();"use strict";var G$=su(),p0=15,W$=852,Y$=592,X$=0,QS=1,Q$=2,XIe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],QIe=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],ZIe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],JIe=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];Z$.exports=function(e,t,i,n,s,o,a,c){var u=c.bits,l=0,d=0,h=0,p=0,y=0,g=0,w=0,b=0,v=0,A=0,k,C,T,D,j,M=null,se=0,ie,fe=new G$.Buf16(p0+1),pe=new G$.Buf16(p0+1),Le=null,Re=0,De,ne,je;for(l=0;l<=p0;l++)fe[l]=0;for(d=0;d<n;d++)fe[t[i+d]]++;for(y=u,p=p0;p>=1&&fe[p]===0;p--);if(y>p&&(y=p),p===0)return s[o++]=1<<24|64<<16|0,s[o++]=1<<24|64<<16|0,c.bits=1,0;for(h=1;h<p&&fe[h]===0;h++);for(y<h&&(y=h),b=1,l=1;l<=p0;l++)if(b<<=1,b-=fe[l],b<0)return-1;if(b>0&&(e===X$||p!==1))return-1;for(pe[1]=0,l=1;l<p0;l++)pe[l+1]=pe[l]+fe[l];for(d=0;d<n;d++)t[i+d]!==0&&(a[pe[t[i+d]]++]=d);if(e===X$?(M=Le=a,ie=19):e===QS?(M=XIe,se-=257,Le=QIe,Re-=257,ie=256):(M=ZIe,Le=JIe,ie=-1),A=0,d=0,l=h,j=o,g=y,w=0,T=-1,v=1<<y,D=v-1,e===QS&&v>W$||e===Q$&&v>Y$)return 1;for(;;){De=l-w,a[d]<ie?(ne=0,je=a[d]):a[d]>ie?(ne=Le[Re+a[d]],je=M[se+a[d]]):(ne=32+64,je=0),k=1<<l-w,C=1<<g,h=C;do C-=k,s[j+(A>>w)+C]=De<<24|ne<<16|je|0;while(C!==0);for(k=1<<l-1;A&k;)k>>=1;if(k!==0?(A&=k-1,A+=k):A=0,d++,--fe[l]==0){if(l===p)break;l=t[i+a[d]]}if(l>y&&(A&D)!==T){for(w===0&&(w=y),j+=h,g=l-w,b=1<<g;g+w<p&&(b-=fe[g+w],!(b<=0));)g++,b<<=1;if(v+=1<<g,e===QS&&v>W$||e===Q$&&v>Y$)return 1;T=A&D,s[T]=y<<24|g<<16|j-o|0}}return A!==0&&(s[j+A]=l-w<<24|64<<16|0),c.bits=y,0}});var NG=m(ia=>{f();"use strict";var Rs=su(),ZS=qS(),nc=US(),eTe=$$(),ig=J$(),tTe=0,eG=1,tG=2,rG=4,rTe=5,gb=6,vd=0,iTe=1,nTe=2,co=-2,iG=-3,JS=-4,sTe=-5,nG=8,sG=1,oG=2,aG=3,cG=4,uG=5,lG=6,fG=7,dG=8,hG=9,pG=10,mb=11,cu=12,eR=13,yG=14,tR=15,gG=16,mG=17,bG=18,wG=19,bb=20,wb=21,_G=22,vG=23,EG=24,SG=25,RG=26,rR=27,AG=28,xG=29,Ur=30,iR=31,oTe=32,aTe=852,cTe=592,uTe=15,lTe=uTe;function IG(r){return(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24)}function fTe(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Rs.Buf16(320),this.work=new Rs.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function TG(r){var e;return!r||!r.state?co:(e=r.state,r.total_in=r.total_out=e.total=0,r.msg="",e.wrap&&(r.adler=e.wrap&1),e.mode=sG,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Rs.Buf32(aTe),e.distcode=e.distdyn=new Rs.Buf32(cTe),e.sane=1,e.back=-1,vd)}function PG(r){var e;return!r||!r.state?co:(e=r.state,e.wsize=0,e.whave=0,e.wnext=0,TG(r))}function CG(r,e){var t,i;return!r||!r.state||(i=r.state,e<0?(t=0,e=-e):(t=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15))?co:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=t,i.wbits=e,PG(r))}function OG(r,e){var t,i;return r?(i=new fTe,r.state=i,i.window=null,t=CG(r,e),t!==vd&&(r.state=null),t):co}function dTe(r){return OG(r,lTe)}var kG=!0,nR,sR;function hTe(r){if(kG){var e;for(nR=new Rs.Buf32(512),sR=new Rs.Buf32(32),e=0;e<144;)r.lens[e++]=8;for(;e<256;)r.lens[e++]=9;for(;e<280;)r.lens[e++]=7;for(;e<288;)r.lens[e++]=8;for(ig(eG,r.lens,0,288,nR,0,r.work,{bits:9}),e=0;e<32;)r.lens[e++]=5;ig(tG,r.lens,0,32,sR,0,r.work,{bits:5}),kG=!1}r.lencode=nR,r.lenbits=9,r.distcode=sR,r.distbits=5}function DG(r,e,t,i){var n,s=r.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Rs.Buf8(s.wsize)),i>=s.wsize?(Rs.arraySet(s.window,e,t-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),Rs.arraySet(s.window,e,t-i,n,s.wnext),i-=n,i?(Rs.arraySet(s.window,e,t-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0}function pTe(r,e){var t,i,n,s,o,a,c,u,l,d,h,p,y,g,w=0,b,v,A,k,C,T,D,j,M=new Rs.Buf8(4),se,ie,fe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!r||!r.state||!r.output||!r.input&&r.avail_in!==0)return co;t=r.state,t.mode===cu&&(t.mode=eR),o=r.next_out,n=r.output,c=r.avail_out,s=r.next_in,i=r.input,a=r.avail_in,u=t.hold,l=t.bits,d=a,h=c,j=vd;e:for(;;)switch(t.mode){case sG:if(t.wrap===0){t.mode=eR;break}for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(t.wrap&2&&u===35615){t.check=0,M[0]=u&255,M[1]=u>>>8&255,t.check=nc(t.check,M,2,0),u=0,l=0,t.mode=oG;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((u&255)<<8)+(u>>8))%31){r.msg="incorrect header check",t.mode=Ur;break}if((u&15)!==nG){r.msg="unknown compression method",t.mode=Ur;break}if(u>>>=4,l-=4,D=(u&15)+8,t.wbits===0)t.wbits=D;else if(D>t.wbits){r.msg="invalid window size",t.mode=Ur;break}t.dmax=1<<D,r.adler=t.check=1,t.mode=u&512?pG:cu,u=0,l=0;break;case oG:for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(t.flags=u,(t.flags&255)!==nG){r.msg="unknown compression method",t.mode=Ur;break}if(t.flags&57344){r.msg="unknown header flags set",t.mode=Ur;break}t.head&&(t.head.text=u>>8&1),t.flags&512&&(M[0]=u&255,M[1]=u>>>8&255,t.check=nc(t.check,M,2,0)),u=0,l=0,t.mode=aG;case aG:for(;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}t.head&&(t.head.time=u),t.flags&512&&(M[0]=u&255,M[1]=u>>>8&255,M[2]=u>>>16&255,M[3]=u>>>24&255,t.check=nc(t.check,M,4,0)),u=0,l=0,t.mode=cG;case cG:for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}t.head&&(t.head.xflags=u&255,t.head.os=u>>8),t.flags&512&&(M[0]=u&255,M[1]=u>>>8&255,t.check=nc(t.check,M,2,0)),u=0,l=0,t.mode=uG;case uG:if(t.flags&1024){for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}t.length=u,t.head&&(t.head.extra_len=u),t.flags&512&&(M[0]=u&255,M[1]=u>>>8&255,t.check=nc(t.check,M,2,0)),u=0,l=0}else t.head&&(t.head.extra=null);t.mode=lG;case lG:if(t.flags&1024&&(p=t.length,p>a&&(p=a),p&&(t.head&&(D=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),Rs.arraySet(t.head.extra,i,s,p,D)),t.flags&512&&(t.check=nc(t.check,i,p,s)),a-=p,s+=p,t.length-=p),t.length))break e;t.length=0,t.mode=fG;case fG:if(t.flags&2048){if(a===0)break e;p=0;do D=i[s+p++],t.head&&D&&t.length<65536&&(t.head.name+=String.fromCharCode(D));while(D&&p<a);if(t.flags&512&&(t.check=nc(t.check,i,p,s)),a-=p,s+=p,D)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=dG;case dG:if(t.flags&4096){if(a===0)break e;p=0;do D=i[s+p++],t.head&&D&&t.length<65536&&(t.head.comment+=String.fromCharCode(D));while(D&&p<a);if(t.flags&512&&(t.check=nc(t.check,i,p,s)),a-=p,s+=p,D)break e}else t.head&&(t.head.comment=null);t.mode=hG;case hG:if(t.flags&512){for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(u!==(t.check&65535)){r.msg="header crc mismatch",t.mode=Ur;break}u=0,l=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),r.adler=t.check=0,t.mode=cu;break;case pG:for(;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}r.adler=t.check=IG(u),u=0,l=0,t.mode=mb;case mb:if(t.havedict===0)return r.next_out=o,r.avail_out=c,r.next_in=s,r.avail_in=a,t.hold=u,t.bits=l,nTe;r.adler=t.check=1,t.mode=cu;case cu:if(e===rTe||e===gb)break e;case eR:if(t.last){u>>>=l&7,l-=l&7,t.mode=rR;break}for(;l<3;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}switch(t.last=u&1,u>>>=1,l-=1,u&3){case 0:t.mode=yG;break;case 1:if(hTe(t),t.mode=bb,e===gb){u>>>=2,l-=2;break e}break;case 2:t.mode=mG;break;case 3:r.msg="invalid block type",t.mode=Ur}u>>>=2,l-=2;break;case yG:for(u>>>=l&7,l-=l&7;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if((u&65535)!=(u>>>16^65535)){r.msg="invalid stored block lengths",t.mode=Ur;break}if(t.length=u&65535,u=0,l=0,t.mode=tR,e===gb)break e;case tR:t.mode=gG;case gG:if(p=t.length,p){if(p>a&&(p=a),p>c&&(p=c),p===0)break e;Rs.arraySet(n,i,s,p,o),a-=p,s+=p,c-=p,o+=p,t.length-=p;break}t.mode=cu;break;case mG:for(;l<14;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(t.nlen=(u&31)+257,u>>>=5,l-=5,t.ndist=(u&31)+1,u>>>=5,l-=5,t.ncode=(u&15)+4,u>>>=4,l-=4,t.nlen>286||t.ndist>30){r.msg="too many length or distance symbols",t.mode=Ur;break}t.have=0,t.mode=bG;case bG:for(;t.have<t.ncode;){for(;l<3;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}t.lens[fe[t.have++]]=u&7,u>>>=3,l-=3}for(;t.have<19;)t.lens[fe[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,se={bits:t.lenbits},j=ig(tTe,t.lens,0,19,t.lencode,0,t.work,se),t.lenbits=se.bits,j){r.msg="invalid code lengths set",t.mode=Ur;break}t.have=0,t.mode=wG;case wG:for(;t.have<t.nlen+t.ndist;){for(;w=t.lencode[u&(1<<t.lenbits)-1],b=w>>>24,v=w>>>16&255,A=w&65535,!(b<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(A<16)u>>>=b,l-=b,t.lens[t.have++]=A;else{if(A===16){for(ie=b+2;l<ie;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(u>>>=b,l-=b,t.have===0){r.msg="invalid bit length repeat",t.mode=Ur;break}D=t.lens[t.have-1],p=3+(u&3),u>>>=2,l-=2}else if(A===17){for(ie=b+3;l<ie;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=b,l-=b,D=0,p=3+(u&7),u>>>=3,l-=3}else{for(ie=b+7;l<ie;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=b,l-=b,D=0,p=11+(u&127),u>>>=7,l-=7}if(t.have+p>t.nlen+t.ndist){r.msg="invalid bit length repeat",t.mode=Ur;break}for(;p--;)t.lens[t.have++]=D}}if(t.mode===Ur)break;if(t.lens[256]===0){r.msg="invalid code -- missing end-of-block",t.mode=Ur;break}if(t.lenbits=9,se={bits:t.lenbits},j=ig(eG,t.lens,0,t.nlen,t.lencode,0,t.work,se),t.lenbits=se.bits,j){r.msg="invalid literal/lengths set",t.mode=Ur;break}if(t.distbits=6,t.distcode=t.distdyn,se={bits:t.distbits},j=ig(tG,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,se),t.distbits=se.bits,j){r.msg="invalid distances set",t.mode=Ur;break}if(t.mode=bb,e===gb)break e;case bb:t.mode=wb;case wb:if(a>=6&&c>=258){r.next_out=o,r.avail_out=c,r.next_in=s,r.avail_in=a,t.hold=u,t.bits=l,eTe(r,h),o=r.next_out,n=r.output,c=r.avail_out,s=r.next_in,i=r.input,a=r.avail_in,u=t.hold,l=t.bits,t.mode===cu&&(t.back=-1);break}for(t.back=0;w=t.lencode[u&(1<<t.lenbits)-1],b=w>>>24,v=w>>>16&255,A=w&65535,!(b<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(v&&(v&240)==0){for(k=b,C=v,T=A;w=t.lencode[T+((u&(1<<k+C)-1)>>k)],b=w>>>24,v=w>>>16&255,A=w&65535,!(k+b<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=k,l-=k,t.back+=k}if(u>>>=b,l-=b,t.back+=b,t.length=A,v===0){t.mode=RG;break}if(v&32){t.back=-1,t.mode=cu;break}if(v&64){r.msg="invalid literal/length code",t.mode=Ur;break}t.extra=v&15,t.mode=_G;case _G:if(t.extra){for(ie=t.extra;l<ie;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}t.length+=u&(1<<t.extra)-1,u>>>=t.extra,l-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=vG;case vG:for(;w=t.distcode[u&(1<<t.distbits)-1],b=w>>>24,v=w>>>16&255,A=w&65535,!(b<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if((v&240)==0){for(k=b,C=v,T=A;w=t.distcode[T+((u&(1<<k+C)-1)>>k)],b=w>>>24,v=w>>>16&255,A=w&65535,!(k+b<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=k,l-=k,t.back+=k}if(u>>>=b,l-=b,t.back+=b,v&64){r.msg="invalid distance code",t.mode=Ur;break}t.offset=A,t.extra=v&15,t.mode=EG;case EG:if(t.extra){for(ie=t.extra;l<ie;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}t.offset+=u&(1<<t.extra)-1,u>>>=t.extra,l-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){r.msg="invalid distance too far back",t.mode=Ur;break}t.mode=SG;case SG:if(c===0)break e;if(p=h-c,t.offset>p){if(p=t.offset-p,p>t.whave&&t.sane){r.msg="invalid distance too far back",t.mode=Ur;break}p>t.wnext?(p-=t.wnext,y=t.wsize-p):y=t.wnext-p,p>t.length&&(p=t.length),g=t.window}else g=n,y=o-t.offset,p=t.length;p>c&&(p=c),c-=p,t.length-=p;do n[o++]=g[y++];while(--p);t.length===0&&(t.mode=wb);break;case RG:if(c===0)break e;n[o++]=t.length,c--,t.mode=wb;break;case rR:if(t.wrap){for(;l<32;){if(a===0)break e;a--,u|=i[s++]<<l,l+=8}if(h-=c,r.total_out+=h,t.total+=h,h&&(r.adler=t.check=t.flags?nc(t.check,n,h,o-h):ZS(t.check,n,h,o-h)),h=c,(t.flags?u:IG(u))!==t.check){r.msg="incorrect data check",t.mode=Ur;break}u=0,l=0}t.mode=AG;case AG:if(t.wrap&&t.flags){for(;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(u!==(t.total&4294967295)){r.msg="incorrect length check",t.mode=Ur;break}u=0,l=0}t.mode=xG;case xG:j=iTe;break e;case Ur:j=iG;break e;case iR:return JS;case oTe:default:return co}return r.next_out=o,r.avail_out=c,r.next_in=s,r.avail_in=a,t.hold=u,t.bits=l,(t.wsize||h!==r.avail_out&&t.mode<Ur&&(t.mode<rR||e!==rG))&&DG(r,r.output,r.next_out,h-r.avail_out)?(t.mode=iR,JS):(d-=r.avail_in,h-=r.avail_out,r.total_in+=d,r.total_out+=h,t.total+=h,t.wrap&&h&&(r.adler=t.check=t.flags?nc(t.check,n,h,r.next_out-h):ZS(t.check,n,h,r.next_out-h)),r.data_type=t.bits+(t.last?64:0)+(t.mode===cu?128:0)+(t.mode===bb||t.mode===tR?256:0),(d===0&&h===0||e===rG)&&j===vd&&(j=sTe),j)}function yTe(r){if(!r||!r.state)return co;var e=r.state;return e.window&&(e.window=null),r.state=null,vd}function gTe(r,e){var t;return!r||!r.state||(t=r.state,(t.wrap&2)==0)?co:(t.head=e,e.done=!1,vd)}function mTe(r,e){var t=e.length,i,n,s;return!r||!r.state||(i=r.state,i.wrap!==0&&i.mode!==mb)?co:i.mode===mb&&(n=1,n=ZS(n,e,t,0),n!==i.check)?iG:(s=DG(r,e,t,t),s?(i.mode=iR,JS):(i.havedict=1,vd))}ia.inflateReset=PG;ia.inflateReset2=CG;ia.inflateResetKeep=TG;ia.inflateInit=dTe;ia.inflateInit2=OG;ia.inflate=pTe;ia.inflateEnd=yTe;ia.inflateGetHeader=gTe;ia.inflateSetDictionary=mTe;ia.inflateInfo="pako inflate (from Nodeca project)"});var oR=m((Oht,BG)=>{f();"use strict";BG.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var MG=m((kht,LG)=>{f();"use strict";function bTe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}LG.exports=bTe});var qG=m(sg=>{f();"use strict";var y0=NG(),ng=su(),_b=HS(),yi=oR(),aR=ab(),wTe=$S(),_Te=MG(),jG=Object.prototype.toString;function Ed(r){if(!(this instanceof Ed))return new Ed(r);this.options=ng.assign({chunkSize:16384,windowBits:0,to:""},r||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(r&&r.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)==0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new wTe,this.strm.avail_out=0;var t=y0.inflateInit2(this.strm,e.windowBits);if(t!==yi.Z_OK)throw new Error(aR[t]);if(this.header=new _Te,y0.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=_b.string2buf(e.dictionary):jG.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=y0.inflateSetDictionary(this.strm,e.dictionary),t!==yi.Z_OK)))throw new Error(aR[t])}Ed.prototype.push=function(r,e){var t=this.strm,i=this.options.chunkSize,n=this.options.dictionary,s,o,a,c,u,l=!1;if(this.ended)return!1;o=e===~~e?e:e===!0?yi.Z_FINISH:yi.Z_NO_FLUSH,typeof r=="string"?t.input=_b.binstring2buf(r):jG.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new ng.Buf8(i),t.next_out=0,t.avail_out=i),s=y0.inflate(t,yi.Z_NO_FLUSH),s===yi.Z_NEED_DICT&&n&&(s=y0.inflateSetDictionary(this.strm,n)),s===yi.Z_BUF_ERROR&&l===!0&&(s=yi.Z_OK,l=!1),s!==yi.Z_STREAM_END&&s!==yi.Z_OK)return this.onEnd(s),this.ended=!0,!1;t.next_out&&(t.avail_out===0||s===yi.Z_STREAM_END||t.avail_in===0&&(o===yi.Z_FINISH||o===yi.Z_SYNC_FLUSH))&&(this.options.to==="string"?(a=_b.utf8border(t.output,t.next_out),c=t.next_out-a,u=_b.buf2string(t.output,a),t.next_out=c,t.avail_out=i-c,c&&ng.arraySet(t.output,t.output,a,c,0),this.onData(u)):this.onData(ng.shrinkBuf(t.output,t.next_out))),t.avail_in===0&&t.avail_out===0&&(l=!0)}while((t.avail_in>0||t.avail_out===0)&&s!==yi.Z_STREAM_END);return s===yi.Z_STREAM_END&&(o=yi.Z_FINISH),o===yi.Z_FINISH?(s=y0.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===yi.Z_OK):(o===yi.Z_SYNC_FLUSH&&(this.onEnd(yi.Z_OK),t.avail_out=0),!0)};Ed.prototype.onData=function(r){this.chunks.push(r)};Ed.prototype.onEnd=function(r){r===yi.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ng.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function cR(r,e){var t=new Ed(e);if(t.push(r,!0),t.err)throw t.msg||aR[t.err];return t.result}function vTe(r,e){return e=e||{},e.raw=!0,cR(r,e)}sg.Inflate=Ed;sg.inflate=cR;sg.inflateRaw=vTe;sg.ungzip=cR});var KG=m((Nht,FG)=>{f();"use strict";var ETe=su().assign,STe=z$(),RTe=qG(),ATe=oR(),UG={};ETe(UG,STe,RTe,ATe);FG.exports=UG});var zG=m((Bht,VG)=>{f();"use strict";var{concat:xTe}=(Si(),Pn);async function ITe(r){let e=new Uint8Array(0);for await(let t of r)e=xTe([e,t],e.length+t.length);return e}VG.exports=ITe});var gR=m((apt,iW)=>{f();iW.exports=OTe;function OTe(r,e,t){var i,n;if(Array.isArray(e)&&(i=e.slice(0)),typeof e=="string"&&(i=e.split(".")),typeof e=="symbol"&&(i=[e]),!Array.isArray(i))throw new Error("props arg must be an array, a string or a symbol");if(n=i.pop(),!n)return!1;rW(n);for(var s;s=i.shift();)if(rW(s),typeof r[s]=="undefined"&&(r[s]={}),r=r[s],!r||typeof r!="object")return!1;return r[n]=t,!0}function rW(r){if(r==="__proto__"||r==="constructor"||r==="prototype")throw new Error("setting of prototype values not supported")}});var Rd=m((qpt,bW)=>{f();"use strict";var HTe=async r=>{for await(let e of r)return e};bW.exports=HTe});var Tb=m((a0t,NW)=>{f();var{Multiaddr:GTe}=ft(),Ib=(r,e)=>e,WTe=(r,e,t,i)=>{if(i&&i.assumeHttp===!1)return`tcp://${r}:${e}`;let n="tcp",s=`:${e}`;return t[t.length-1].protocol==="tcp"&&(n=e==="443"?"https":"http",s=e==="443"||e==="80"?"":s),`${n}://${r}${s}`},YTe={ip4:Ib,ip6:(r,e,t,i)=>i.length===1&&i[0].protocol==="ip6"?e:`[${e}]`,tcp:(r,e,t,i,n)=>i.some(s=>["http","https","ws","wss"].includes(s.protocol))?`${r}:${e}`:WTe(r,e,i,n),udp:(r,e)=>`udp://${r}:${e}`,dnsaddr:Ib,dns4:Ib,dns6:Ib,ipfs:(r,e)=>`${r}/ipfs/${e}`,p2p:(r,e)=>`${r}/p2p/${e}`,http:r=>`http://${r}`,https:r=>`https://${r}`,ws:r=>`ws://${r}`,wss:r=>`wss://${r}`,"p2p-websocket-star":r=>`${r}/p2p-websocket-star`,"p2p-webrtc-star":r=>`${r}/p2p-webrtc-star`,"p2p-webrtc-direct":r=>`${r}/p2p-webrtc-direct`};NW.exports=(r,e)=>{let t=new GTe(r),i=r.toString().split("/").slice(1);return t.tuples().map(n=>({protocol:i.shift(),content:n[1]?i.shift():null})).reduce((n,s,o,a)=>{let c=YTe[s.protocol];if(!c)throw new Error(`Unsupported protocol ${s.protocol}`);return c(n,s.content,o,a,e)},"")}});var LW=m((c0t,BW)=>{f();"use strict";BW.exports=r=>{if(!Array.isArray(r))throw new TypeError(`Expected an array, got ${typeof r}`);r=[...r];for(let e=r.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[r[e],r[t]]=[r[t],r[e]]}return r}});var PR=m((h0t,zW)=>{f();zW.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}});var HW=m(()=>{f()});var tY=m((g0t,eY)=>{f();var JTe=Ut().EventEmitter,{nanoid:ePe}=(n4(),x7),{WORKER_REQUEST_READ_LOCK:$W,WORKER_RELEASE_READ_LOCK:GW,MASTER_GRANT_READ_LOCK:WW,WORKER_REQUEST_WRITE_LOCK:YW,WORKER_RELEASE_WRITE_LOCK:XW,MASTER_GRANT_WRITE_LOCK:QW}=PR(),ag,ZW=(r,e,t,i,n)=>(s,o)=>{o&&o.type===t&&r.emit(e,o.name,()=>(s.send({type:n,name:o.name,identifier:o.identifier}),new Promise(a=>{let c=u=>{u&&u.type===i&&u.identifier===o.identifier&&(s.removeListener("message",c),a())};s.on("message",c)})))},JW=(r,e,t,i)=>()=>{let n=ePe();return process.send({type:e,identifier:n,name:r}),new Promise(s=>{let o=a=>{a&&a.type===t&&a.identifier===n&&(process.removeListener("message",o),s(()=>{process.send({type:i,identifier:n,name:r})}))};process.on("message",o)})};eY.exports=r=>{try{if(ag=HW(),!Object.keys(ag).length)return}catch(e){return}if(ag.isMaster||r.singleProcess){let e=new JTe;return ag.on("message",ZW(e,"requestReadLock",$W,GW,WW)),ag.on("message",ZW(e,"requestWriteLock",YW,XW,QW)),e}return{isWorker:!0,readLock:e=>JW(e,$W,WW,GW),writeLock:e=>JW(e,YW,QW,XW)}}});var CR=m((m0t,rY)=>{f();var Bl={},E0=r=>{r.addEventListener("message",e=>{E0.dispatchEvent("message",r,e)}),r.port&&r.port.addEventListener("message",e=>{E0.dispatchEvent("message",r,e)})};E0.addEventListener=(r,e)=>{Bl[r]||(Bl[r]=[]),Bl[r].push(e)};E0.removeEventListener=(r,e)=>{!Bl[r]||(Bl[r]=Bl[r].filter(t=>t===e))};E0.dispatchEvent=function(){let r=Array.prototype.slice.call(arguments),e=r.shift();!Bl[e]||Bl[e].forEach(t=>t.apply(null,r))};rY.exports=E0});var hY=m((b0t,dY)=>{f();var tPe=Ut().EventEmitter,{nanoid:rPe}=(n4(),x7),{WORKER_REQUEST_READ_LOCK:iY,WORKER_RELEASE_READ_LOCK:nY,MASTER_GRANT_READ_LOCK:sY,WORKER_REQUEST_WRITE_LOCK:oY,WORKER_RELEASE_WRITE_LOCK:aY,MASTER_GRANT_WRITE_LOCK:cY}=PR(),uY=CR(),lY=(r,e,t,i,n)=>(s,o)=>{if(!o||!o.data||o.data.type!==t)return;let a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};r.emit(e,a.name,()=>(s.postMessage({type:n,name:a.name,identifier:a.identifier}),new Promise(c=>{let u=l=>{if(!l||!l.data)return;let d={type:l.data.type,name:l.data.name,identifier:l.data.identifier};d&&d.type===i&&d.identifier===a.identifier&&(s.removeEventListener("message",u),c())};s.addEventListener("message",u)})))},fY=(r,e,t,i)=>()=>{let n=rPe();return globalThis.postMessage({type:e,identifier:n,name:r}),new Promise(s=>{let o=a=>{if(!a||!a.data)return;let c={type:a.data.type,identifier:a.data.identifier};c&&c.type===t&&c.identifier===n&&(globalThis.removeEventListener("message",o),s(()=>{globalThis.postMessage({type:i,identifier:n,name:r})}))};globalThis.addEventListener("message",o)})},iPe={singleProcess:!1};dY.exports=r=>{if(r=Object.assign({},iPe,r),!!globalThis.document||r.singleProcess){let t=new tPe;return uY.addEventListener("message",lY(t,"requestReadLock",iY,nY,sY)),uY.addEventListener("message",lY(t,"requestWriteLock",oY,aY,cY)),t}return{isWorker:!0,readLock:t=>fY(t,iY,sY,nY),writeLock:t=>fY(t,oY,cY,aY)}}});var pY=m((_0t,OR)=>{f();"use strict";var Ob,w0t=OR.exports.timeout=function(r,e){var t=new Ob,i;return Promise.race([r,new Promise(function(n,s){i=setTimeout(function(){s(t)},e)})]).then(function(n){return clearTimeout(i),n},function(n){throw clearTimeout(i),n})};Ob=OR.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"};Ob.prototype=Object.create(Error.prototype);Ob.prototype.name="TimeoutError"});var kb=m((v0t,DR)=>{f();var nPe=tY(),sPe=hY(),{default:yY}=$o(),{timeout:oPe}=pY(),aPe=CR(),Ad={},Ll;function kR(r,e){let t,i=new Promise(n=>{t=n});return r.add(()=>oPe((()=>new Promise(n=>{t(()=>{n()})}))(),e.timeout)),i}var cPe=(r,e)=>{if(Ll.isWorker)return{readLock:Ll.readLock(r,e),writeLock:Ll.writeLock(r,e)};let t=new yY({concurrency:1}),i=null;return{readLock:()=>{if(i)return kR(i,e);i=new yY({concurrency:e.concurrency,autoStart:!1});let n=i,s=kR(i,e);return t.add(()=>(n.start(),n.onIdle().then(()=>{i===n&&(i=null)}))),s},writeLock:()=>(i=null,kR(t,e))}},uPe={concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};DR.exports=(r,e)=>(e||(e={}),typeof r=="object"&&(e=r,r="lock"),r||(r="lock"),e=Object.assign({},uPe,e),Ll||(Ll=nPe(e)||sPe(e),Ll.isWorker||(Ll.on("requestReadLock",(t,i)=>{!Ad[t]||Ad[t].readLock().then(n=>i().finally(()=>n()))}),Ll.on("requestWriteLock",async(t,i)=>{!Ad[t]||Ad[t].writeLock().then(n=>i().finally(()=>n()))}))),Ad[r]||(Ad[r]=cPe(r,e)),Ad[r]);DR.exports.Worker=function(r,e){e=e||globalThis.Worker;let t;try{t=new e(r)}catch(i){i.message.includes("not a constructor")&&(t=e(r))}if(!t)throw new Error("Could not create Worker from",e);return aPe(t),t}});var YR=m((ymt,qX)=>{f();qX.exports=sCe;function sCe(r,e,t){if(!r)return t;var i,n;if(Array.isArray(e)&&(i=e.slice(0)),typeof e=="string"&&(i=e.split(".")),typeof e=="symbol"&&(i=[e]),!Array.isArray(i))throw new Error("props arg must be an array, a string or a symbol");for(;i.length;)if(n=i.shift(),!r||(r=r[n],r===void 0))return t;return r}});var Pd=m((gmt,FX)=>{f();"use strict";function UX(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function oCe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return UX(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),UX(new n,t)}}FX.exports=oCe});var pg=m((mmt,KX)=>{f();"use strict";var aCe=async r=>{let e=0;for await(let t of r)e++;return e};KX.exports=aCe});var QX=m((XR,XX)=>{f();"use strict";Object.defineProperty(XR,"__esModule",{value:!0});Kb.BASE=2166136261;function Kb(r,e=Kb.BASE){let t=r.length;for(let i=0;i<t;i++)e^=r.charCodeAt(i),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0}XR.default=Kb;XX.exports=Kb});var JX={};Tt(JX,{compare:()=>gg});function gg(r,e){for(let t=0;t<r.byteLength;t++){if(r[t]<e[t])return-1;if(r[t]>e[t])return 1}return r.byteLength>e.byteLength?1:r.byteLength<e.byteLength?-1:0}var zb=Ue(()=>{f()});var RQ=m((M3t,Zb)=>{f();"use strict";Zb.exports=kCe;Zb.exports.format=EQ;Zb.exports.parse=SQ;var PCe=/\B(?=(\d{3})+(?!\d))/g,CCe=/(?:\.0*|(\.[^0]+)0+)$/,Vl={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},OCe=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function kCe(r,e){return typeof r=="string"?SQ(r):typeof r=="number"?EQ(r,e):null}function EQ(r,e){if(!Number.isFinite(r))return null;var t=Math.abs(r),i=e&&e.thousandsSeparator||"",n=e&&e.unitSeparator||"",s=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,o=Boolean(e&&e.fixedDecimals),a=e&&e.unit||"";(!a||!Vl[a.toLowerCase()])&&(t>=Vl.pb?a="PB":t>=Vl.tb?a="TB":t>=Vl.gb?a="GB":t>=Vl.mb?a="MB":t>=Vl.kb?a="KB":a="B");var c=r/Vl[a.toLowerCase()],u=c.toFixed(s);return o||(u=u.replace(CCe,"$1")),i&&(u=u.split(".").map(function(l,d){return d===0?l.replace(PCe,i):l}).join(".")),u+n+a}function SQ(r){if(typeof r=="number"&&!isNaN(r))return r;if(typeof r!="string")return null;var e=OCe.exec(r),t,i="b";return e?(t=parseFloat(e[1]),i=e[4].toLowerCase()):(t=parseInt(r,10),i="b"),isNaN(t)?null:Math.floor(Vl[i]*t)}});var NQ=m((Z3t,DQ)=>{f();"use strict";DQ.exports=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;let e=Object.getPrototypeOf(r);return e===null||e===Object.prototype}});var LQ=m((J3t,BQ)=>{f();"use strict";var pA=NQ();BQ.exports=(r,e={})=>{if(!pA(r)&&!Array.isArray(r))throw new TypeError("Expected a plain object or array");let{deep:t}=e,i=[],n=[],s=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let u=[];return i.push(a),n.push(u),u.push(...a.map(l=>Array.isArray(l)?s(l):pA(l)?o(l):l)),u},o=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let u={},l=Object.keys(a).sort(e.compare);i.push(a),n.push(u);for(let d of l){let h=a[d],p;t&&Array.isArray(h)?p=s(h):p=t&&pA(h)?o(h):h,Object.defineProperty(u,d,{...Object.getOwnPropertyDescriptor(a,d),value:p})}return u};return Array.isArray(r)?t?s(r):r.slice():o(r)}});var SA=m((e6t,pZ)=>{f();"use strict";var WCe=Zo(),YCe=async function*(r,e){yield*(await WCe(r)).sort(e)};pZ.exports=YCe});var gZ=m((t6t,yZ)=>{f();yZ.exports=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}});var mZ=m((r6t,RA)=>{f();typeof Object.create=="function"?RA.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:RA.exports=function(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}});var vZ=m(er=>{f();var XCe=/%[sdj%]/g;er.format=function(r){if(!c5(r)){for(var e=[],t=0;t<arguments.length;t++)e.push(Hl(arguments[t]));return e.join(" ")}for(var t=1,i=arguments,n=i.length,s=String(r).replace(XCe,function(a){if(a==="%%")return"%";if(t>=n)return a;switch(a){case"%s":return String(i[t++]);case"%d":return Number(i[t++]);case"%j":try{return JSON.stringify(i[t++])}catch(c){return"[Circular]"}default:return a}}),o=i[t];t<n;o=i[++t])a5(o)||!L0(o)?s+=" "+o:s+=" "+Hl(o);return s};er.deprecate=function(r,e){if(du(globalThis.process))return function(){return er.deprecate(r,e).apply(this,arguments)};if(process.noDeprecation===!0)return r;var t=!1;function i(){if(!t){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),t=!0}return r.apply(this,arguments)}return i};var s5={},AA;er.debuglog=function(r){if(du(AA)&&(AA=process.env.NODE_DEBUG||""),r=r.toUpperCase(),!s5[r])if(new RegExp("\\b"+r+"\\b","i").test(AA)){var e=process.pid;s5[r]=function(){var t=er.format.apply(er,arguments);console.error("%s %d: %s",r,e,t)}}else s5[r]=function(){};return s5[r]};function Hl(r,e){var t={seen:[],stylize:ZCe};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),TA(e)?t.showHidden=e:e&&er._extend(t,e),du(t.showHidden)&&(t.showHidden=!1),du(t.depth)&&(t.depth=2),du(t.colors)&&(t.colors=!1),du(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=QCe),o5(t,r,t.depth)}er.inspect=Hl;Hl.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Hl.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function QCe(r,e){var t=Hl.styles[e];return t?"["+Hl.colors[t][0]+"m"+r+"["+Hl.colors[t][1]+"m":r}function ZCe(r,e){return r}function JCe(r){var e={};return r.forEach(function(t,i){e[t]=!0}),e}function o5(r,e,t){if(r.customInspect&&e&&f5(e.inspect)&&e.inspect!==er.inspect&&!(e.constructor&&e.constructor.prototype===e)){var i=e.inspect(t,r);return c5(i)||(i=o5(r,i,t)),i}var n=eOe(r,e);if(n)return n;var s=Object.keys(e),o=JCe(s);if(r.showHidden&&(s=Object.getOwnPropertyNames(e)),l5(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return xA(e);if(s.length===0){if(f5(e)){var a=e.name?": "+e.name:"";return r.stylize("[Function"+a+"]","special")}if(u5(e))return r.stylize(RegExp.prototype.toString.call(e),"regexp");if(PA(e))return r.stylize(Date.prototype.toString.call(e),"date");if(l5(e))return xA(e)}var c="",u=!1,l=["{","}"];if(bZ(e)&&(u=!0,l=["[","]"]),f5(e)){var d=e.name?": "+e.name:"";c=" [Function"+d+"]"}if(u5(e)&&(c=" "+RegExp.prototype.toString.call(e)),PA(e)&&(c=" "+Date.prototype.toUTCString.call(e)),l5(e)&&(c=" "+xA(e)),s.length===0&&(!u||e.length==0))return l[0]+c+l[1];if(t<0)return u5(e)?r.stylize(RegExp.prototype.toString.call(e),"regexp"):r.stylize("[Object]","special");r.seen.push(e);var h;return u?h=tOe(r,e,t,o,s):h=s.map(function(p){return IA(r,e,t,o,p,u)}),r.seen.pop(),rOe(h,c,l)}function eOe(r,e){if(du(e))return r.stylize("undefined","undefined");if(c5(e)){var t="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(t,"string")}if(wZ(e))return r.stylize(""+e,"number");if(TA(e))return r.stylize(""+e,"boolean");if(a5(e))return r.stylize("null","null")}function xA(r){return"["+Error.prototype.toString.call(r)+"]"}function tOe(r,e,t,i,n){for(var s=[],o=0,a=e.length;o<a;++o)_Z(e,String(o))?s.push(IA(r,e,t,i,String(o),!0)):s.push("");return n.forEach(function(c){c.match(/^\d+$/)||s.push(IA(r,e,t,i,c,!0))}),s}function IA(r,e,t,i,n,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]},c.get?c.set?a=r.stylize("[Getter/Setter]","special"):a=r.stylize("[Getter]","special"):c.set&&(a=r.stylize("[Setter]","special")),_Z(i,n)||(o="["+n+"]"),a||(r.seen.indexOf(c.value)<0?(a5(t)?a=o5(r,c.value,null):a=o5(r,c.value,t-1),a.indexOf(`
`)>-1&&(s?a=a.split(`
`).map(function(u){return"  "+u}).join(`
`).substr(2):a=`
`+a.split(`
`).map(function(u){return"   "+u}).join(`
`))):a=r.stylize("[Circular]","special")),du(o)){if(s&&n.match(/^\d+$/))return a;o=JSON.stringify(""+n),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=r.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=r.stylize(o,"string"))}return o+": "+a}function rOe(r,e,t){var i=0,n=r.reduce(function(s,o){return i++,o.indexOf(`
`)>=0&&i++,s+o.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?t[0]+(e===""?"":e+`
 `)+" "+r.join(`,
  `)+" "+t[1]:t[0]+e+" "+r.join(", ")+" "+t[1]}function bZ(r){return Array.isArray(r)}er.isArray=bZ;function TA(r){return typeof r=="boolean"}er.isBoolean=TA;function a5(r){return r===null}er.isNull=a5;function iOe(r){return r==null}er.isNullOrUndefined=iOe;function wZ(r){return typeof r=="number"}er.isNumber=wZ;function c5(r){return typeof r=="string"}er.isString=c5;function nOe(r){return typeof r=="symbol"}er.isSymbol=nOe;function du(r){return r===void 0}er.isUndefined=du;function u5(r){return L0(r)&&CA(r)==="[object RegExp]"}er.isRegExp=u5;function L0(r){return typeof r=="object"&&r!==null}er.isObject=L0;function PA(r){return L0(r)&&CA(r)==="[object Date]"}er.isDate=PA;function l5(r){return L0(r)&&(CA(r)==="[object Error]"||r instanceof Error)}er.isError=l5;function f5(r){return typeof r=="function"}er.isFunction=f5;function sOe(r){return r===null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||typeof r=="symbol"||typeof r=="undefined"}er.isPrimitive=sOe;er.isBuffer=gZ();function CA(r){return Object.prototype.toString.call(r)}function OA(r){return r<10?"0"+r.toString(10):r.toString(10)}var oOe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function aOe(){var r=new Date,e=[OA(r.getHours()),OA(r.getMinutes()),OA(r.getSeconds())].join(":");return[r.getDate(),oOe[r.getMonth()],e].join(" ")}er.log=function(){console.log("%s - %s",aOe(),er.format.apply(er,arguments))};er.inherits=mZ();er._extend=function(r,e){if(!e||!L0(e))return r;for(var t=Object.keys(e),i=t.length;i--;)r[t[i]]=e[t[i]];return r};function _Z(r,e){return Object.prototype.hasOwnProperty.call(r,e)}});var kA=m((n6t,SZ)=>{f();"use strict";SZ.exports=function(...e){let t=e.reduce((i,n)=>Object.assign(i,n),{});return Object.assign(t,{bufferKeys:t.bufferKeys||!1,snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,getMany:t.getMany||!1,keyIterator:t.keyIterator||!1,valueIterator:t.valueIterator||!1,iteratorNextv:t.iteratorNextv||!1,iteratorAll:t.iteratorAll||!1,status:t.status||!1,idempotentOpen:t.idempotentOpen||!1,passiveOpen:t.passiveOpen||!1,serialize:t.serialize||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,openCallback:t.openCallback||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:EZ(t.encodings),events:EZ(t.events),additionalMethods:Object.assign({},t.additionalMethods)})};function EZ(r){return r?Object.assign({},r):!1}});var AZ=m((s6t,RZ)=>{f();RZ.exports=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}});var IZ=m((o6t,xZ)=>{f();xZ.exports=typeof queueMicrotask=="function"?queueMicrotask:r=>Promise.resolve().then(r)});var d5=m(DA=>{f();"use strict";var TZ=IZ();DA.fromCallback=function(r,e){if(r===void 0){var t=new Promise(function(i,n){r=function(s,o){s?n(s):i(o)}});r[e!==void 0?e:"promise"]=t}else if(typeof r!="function")throw new TypeError("Callback must be a function");return r};DA.fromPromise=function(r,e){if(e===void 0)return r;r.then(function(t){TZ(()=>e(null,t))}).catch(function(t){TZ(()=>e(t))})}});var Ig=m((c6t,CZ)=>{f();var PZ;CZ.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window!="undefined"?window:globalThis):r=>(PZ||(PZ=Promise.resolve())).then(r).catch(e=>setTimeout(()=>{throw e},0))});var h5=m((u6t,kZ)=>{f();"use strict";var OZ=Ig();kZ.exports=function(r,...e){e.length===0?OZ(r):OZ(()=>r(...e))}});var NA=m((l6t,DZ)=>{f();"use strict";function hu(r){if(typeof r!="object"||r===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=r,this._ended=!1,this._nexting=!1}hu.prototype.next=function(r){let e=this;if(r===void 0)e=new Promise(function(t,i){r=function(n,s,o){n?i(n):s===void 0&&o===void 0?t():t([s,o])}});else if(typeof r!="function")throw new Error("next() requires a callback argument");return this._ended?(this._nextTick(r,new Error("cannot call next() after end()")),e):this._nexting?(this._nextTick(r,new Error("cannot call next() before previous next() has completed")),e):(this._nexting=!0,this._next((t,...i)=>{this._nexting=!1,r(t,...i)}),e)};hu.prototype._next=function(r){this._nextTick(r)};hu.prototype.seek=function(r){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");r=this.db._serializeKey(r),this._seek(r)};hu.prototype._seek=function(r){};hu.prototype.end=function(r){let e;if(r===void 0)e=new Promise(function(t,i){r=function(n){n?i(n):t()}});else if(typeof r!="function")throw new Error("end() requires a callback argument");return this._ended?(this._nextTick(r,new Error("end() already called on iterator")),e):(this._ended=!0,this._end(r),e)};hu.prototype._end=function(r){this._nextTick(r)};hu.prototype[Symbol.asyncIterator]=async function*(){try{let r;for(;(r=await this.next())!==void 0;)yield r}finally{this._ended||await this.end()}};hu.prototype._nextTick=h5();DZ.exports=hu});var BA=m((f6t,BZ)=>{f();"use strict";var NZ=Object.freeze({});function oa(r){if(typeof r!="object"||r===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=r,this._operations=[],this._written=!1}oa.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")};oa.prototype.put=function(r,e,t){this._checkWritten();let i=this.db._checkKey(r)||this.db._checkValue(e);if(i)throw i;return r=this.db._serializeKey(r),e=this.db._serializeValue(e),this._put(r,e,t??NZ),this};oa.prototype._put=function(r,e,t){this._operations.push({...t,type:"put",key:r,value:e})};oa.prototype.del=function(r,e){this._checkWritten();let t=this.db._checkKey(r);if(t)throw t;return r=this.db._serializeKey(r),this._del(r,e??NZ),this};oa.prototype._del=function(r,e){this._operations.push({...e,type:"del",key:r})};oa.prototype.clear=function(){return this._checkWritten(),this._clear(),this};oa.prototype._clear=function(){this._operations=[]};oa.prototype.write=function(r,e){if(this._checkWritten(),typeof r=="function"&&(e=r),typeof e!="function")throw new Error("write() requires a callback argument");(typeof r!="object"||r===null)&&(r={}),this._written=!0,this._write(r,e)};oa.prototype._write=function(r,e){this.db._batch(this._operations,r,e)};oa.prototype._nextTick=h5();BZ.exports=oa});var MA=m(LA=>{f();"use strict";LA.getCallback=function(r,e){return typeof r=="function"?r:e};LA.getOptions=function(r){return typeof r=="object"&&r!==null?r:{}}});var jZ=m((h6t,MZ)=>{f();"use strict";var cOe=kA(),uOe=AZ(),lOe=d5(),fOe=NA(),dOe=BA(),hOe=MA().getCallback,pOe=MA().getOptions,yOe=Object.prototype.hasOwnProperty,gOe=["lt","lte","gt","gte"];function pr(r){this.status="new",this.supports=cOe(r,{status:!0})}pr.prototype.open=function(r,e){let t=this.status;if(typeof r=="function"&&(e=r),typeof e!="function")throw new Error("open() requires a callback argument");(typeof r!="object"||r===null)&&(r={}),r.createIfMissing=r.createIfMissing!==!1,r.errorIfExists=!!r.errorIfExists,this.status="opening",this._open(r,i=>{if(i)return this.status=t,e(i);this.status="open",e()})};pr.prototype._open=function(r,e){this._nextTick(e)};pr.prototype.close=function(r){let e=this.status;if(typeof r!="function")throw new Error("close() requires a callback argument");this.status="closing",this._close(t=>{if(t)return this.status=e,r(t);this.status="closed",r()})};pr.prototype._close=function(r){this._nextTick(r)};pr.prototype.get=function(r,e,t){if(typeof e=="function"&&(t=e),typeof t!="function")throw new Error("get() requires a callback argument");let i=this._checkKey(r);if(i)return this._nextTick(t,i);r=this._serializeKey(r),(typeof e!="object"||e===null)&&(e={}),e.asBuffer=e.asBuffer!==!1,this._get(r,e,t)};pr.prototype._get=function(r,e,t){this._nextTick(function(){t(new Error("NotFound"))})};pr.prototype.getMany=function(r,e,t){if(t=hOe(e,t),t=lOe.fromCallback(t),e=pOe(e),bOe(this,t))return t.promise;if(!Array.isArray(r))return this._nextTick(t,new Error("getMany() requires an array argument")),t.promise;if(r.length===0)return this._nextTick(t,null,[]),t.promise;typeof e.asBuffer!="boolean"&&(e={...e,asBuffer:!0});let i=new Array(r.length);for(let n=0;n<r.length;n++){let s=r[n],o=this._checkKey(s);if(o)return this._nextTick(t,o),t.promise;i[n]=this._serializeKey(s)}return this._getMany(i,e,t),t.promise};pr.prototype._getMany=function(r,e,t){this._nextTick(t,null,new Array(r.length).fill(void 0))};pr.prototype.put=function(r,e,t,i){if(typeof t=="function"&&(i=t),typeof i!="function")throw new Error("put() requires a callback argument");let n=this._checkKey(r)||this._checkValue(e);if(n)return this._nextTick(i,n);r=this._serializeKey(r),e=this._serializeValue(e),(typeof t!="object"||t===null)&&(t={}),this._put(r,e,t,i)};pr.prototype._put=function(r,e,t,i){this._nextTick(i)};pr.prototype.del=function(r,e,t){if(typeof e=="function"&&(t=e),typeof t!="function")throw new Error("del() requires a callback argument");let i=this._checkKey(r);if(i)return this._nextTick(t,i);r=this._serializeKey(r),(typeof e!="object"||e===null)&&(e={}),this._del(r,e,t)};pr.prototype._del=function(r,e,t){this._nextTick(t)};pr.prototype.batch=function(r,e,t){if(!arguments.length)return this._chainedBatch();if(typeof e=="function"&&(t=e),typeof r=="function"&&(t=r),typeof t!="function")throw new Error("batch(array) requires a callback argument");if(!Array.isArray(r))return this._nextTick(t,new Error("batch(array) requires an array argument"));if(r.length===0)return this._nextTick(t);(typeof e!="object"||e===null)&&(e={});let i=new Array(r.length);for(let n=0;n<r.length;n++){if(typeof r[n]!="object"||r[n]===null)return this._nextTick(t,new Error("batch(array) element must be an object and not `null`"));let s=Object.assign({},r[n]);if(s.type!=="put"&&s.type!=="del")return this._nextTick(t,new Error("`type` must be 'put' or 'del'"));let o=this._checkKey(s.key);if(o)return this._nextTick(t,o);if(s.key=this._serializeKey(s.key),s.type==="put"){let a=this._checkValue(s.value);if(a)return this._nextTick(t,a);s.value=this._serializeValue(s.value)}i[n]=s}this._batch(i,e,t)};pr.prototype._batch=function(r,e,t){this._nextTick(t)};pr.prototype.clear=function(r,e){if(typeof r=="function")e=r;else if(typeof e!="function")throw new Error("clear() requires a callback argument");r=LZ(this,r),r.reverse=!!r.reverse,r.limit="limit"in r?r.limit:-1,this._clear(r,e)};pr.prototype._clear=function(r,e){r.keys=!0,r.values=!1,r.keyAsBuffer=!0,r.valueAsBuffer=!0;let t=this._iterator(r),i={},n=s=>{if(s)return t.end(function(){e(s)});t.next((o,a)=>{if(o)return n(o);if(a===void 0)return t.end(e);this._del(a,i,n)})};n()};pr.prototype._setupIteratorOptions=function(r){return r=LZ(this,r),r.reverse=!!r.reverse,r.keys=r.keys!==!1,r.values=r.values!==!1,r.limit="limit"in r?r.limit:-1,r.keyAsBuffer=r.keyAsBuffer!==!1,r.valueAsBuffer=r.valueAsBuffer!==!1,r};function LZ(r,e){let t={};for(let i in e){if(!yOe.call(e,i))continue;if(i==="start"||i==="end")throw new Error('Legacy range options ("start" and "end") have been removed');let n=e[i];mOe(i)&&(n=r._serializeKey(n)),t[i]=n}return t}function mOe(r){return gOe.indexOf(r)!==-1}pr.prototype.iterator=function(r){return(typeof r!="object"||r===null)&&(r={}),r=this._setupIteratorOptions(r),this._iterator(r)};pr.prototype._iterator=function(r){return new fOe(this)};pr.prototype._chainedBatch=function(){return new dOe(this)};pr.prototype._serializeKey=function(r){return r};pr.prototype._serializeValue=function(r){return r};pr.prototype._checkKey=function(r){if(r==null)return new Error("key cannot be `null` or `undefined`");if(uOe(r)&&r.length===0)return new Error("key cannot be an empty Buffer");if(r==="")return new Error("key cannot be an empty String");if(Array.isArray(r)&&r.length===0)return new Error("key cannot be an empty Array")};pr.prototype._checkValue=function(r){if(r==null)return new Error("value cannot be `null` or `undefined`")};pr.prototype.isOperational=function(){return this.status==="open"||this._isOperational()};pr.prototype._isOperational=function(){return!1};pr.prototype._nextTick=h5();MZ.exports=pr;function bOe(r,e){return r.isOperational()?!1:(r._nextTick(e,new Error("Database is not open")),!0)}});var pu=m(p5=>{f();"use strict";p5.AbstractLevelDOWN=jZ();p5.AbstractIterator=NA();p5.AbstractChainedBatch=BA()});var ho=m((y6t,jA)=>{f();typeof Object.create=="function"?jA.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:jA.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}});var qA=m(qZ=>{f();"use strict";qZ.getCallback=function(r,e,t){let i=r[r.length-1];if(typeof i!="function"){let n=new Promise((s,o)=>{r.push(i=function(a,...c){a?o(a):s(t?t(...c):c[0])})});i[e]=n}return i}});var zZ=m((m6t,VZ)=>{f();"use strict";var{AbstractIterator:UZ}=pu(),wOe=ho(),FZ=qA().getCallback,KZ=Symbol("options"),M0=Symbol("iterator"),j0=Symbol("operations"),y5=Symbol("promise");function jd(r,e){UZ.call(this,r),this[KZ]=e,this[M0]=null,this[j0]=[]}wOe(jd,UZ);jd.prototype.setDb=function(r){this[M0]=r.iterator(this[KZ]);for(let e of this[j0].splice(0,this[j0].length))this[M0][e.method](...e.args)};jd.prototype.next=function(...r){if(this.db.status==="open")return this[M0].next(...r);let e=FZ(r,y5,function(i,n){if(!(i===void 0&&n===void 0))return[i,n]});return this.db.status==="opening"?this[j0].push({method:"next",args:r}):this._nextTick(e,new Error("Database is not open")),e[y5]||this};jd.prototype.seek=function(...r){if(this.db.status==="open")this[M0].seek(...r);else if(this.db.status==="opening")this[j0].push({method:"seek",args:r});else throw new Error("Database is not open")};jd.prototype.end=function(...r){if(this.db.status==="open")return this[M0].end(...r);let e=FZ(r,y5);return this.db.status==="opening"?this[j0].push({method:"end",args:r}):this._nextTick(e,new Error("Database is not open")),e[y5]||this};for(let r of["next","seek","end"])jd.prototype["_"+r]=function(){throw new Error("Did not expect private method to be called: "+r)};VZ.exports=jd});var $Z=m((w6t,HZ)=>{f();"use strict";var{AbstractChainedBatch:_Oe}=pu(),Tg=Symbol("operations");HZ.exports=class extends _Oe{constructor(e){super(e);this[Tg]=[]}_put(e,t,i){this[Tg].push({...i,type:"put",key:e,value:t})}_del(e,t){this[Tg].push({...t,type:"del",key:e})}_clear(){this[Tg]=[]}_write(e,t){this.db.batch(this[Tg],e,t)}}});var QZ=m((_6t,UA)=>{f();"use strict";var{AbstractLevelDOWN:GZ}=pu(),vOe=ho(),WZ=zZ(),EOe=$Z(),SOe=qA().getCallback,YZ=["put","get","getMany","del","batch","clear"],ROe=["approximateSize","compactRange"],aa=Symbol("innerDb"),q0=Symbol("operations"),XZ=Symbol("promise");function qd(r){GZ.call(this,r.supports||{});for(let e of ROe)typeof r[e]=="function"&&!this.supports.additionalMethods[e]&&(this.supports.additionalMethods[e]=!0);this[aa]=r,this[q0]=[],AOe(this)}vOe(qd,GZ);qd.prototype.type="deferred-leveldown";Object.defineProperty(qd.prototype,"_db",{enumerable:!0,get(){return this[aa]}});qd.prototype._open=function(r,e){let t=i=>{if(i||this[aa].status!=="open")return e(i||new Error("Database is not open"));let n=this[q0];this[q0]=[];for(let s of n)s.iterator?s.iterator.setDb(this[aa]):this[aa][s.method](...s.args);if(this[q0].length>0)throw new Error("Did not expect further operations");e()};this[aa].status==="new"||this[aa].status==="closed"?this[aa].open(r,t):this._nextTick(t)};qd.prototype._close=function(r){this[aa].close(r)};qd.prototype._isOperational=function(){return this.status==="opening"};function AOe(r){let e=Object.keys(r.supports.additionalMethods);for(let t of YZ.concat(e))r[t]=function(...i){if(t==="batch"&&i.length===0)return new EOe(this);if(this.status==="open")return this[aa][t](...i);let n=SOe(i,XZ);return this.status==="opening"?this[q0].push({method:t,args:i}):this._nextTick(n,new Error("Database is not open")),n[XZ]};r.iterator=function(t){if(this.status==="open")return this[aa].iterator(t);if(this.status==="opening"){let i=new WZ(this,t);return this[q0].push({iterator:i}),i}else throw new Error("Database is not open")};for(let t of YZ.concat(["iterator"]))r["_"+t]=function(){throw new Error("Did not expect private method to be called: "+t)}}UA.exports=qd;UA.exports.DeferredIterator=WZ});var FA=m((v6t,ZZ)=>{f();ZZ.exports=Ut().EventEmitter});var KA=m(()=>{f()});var rJ=m((R6t,tJ)=>{f();"use strict";function JZ(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,i)}return t}function xOe(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?JZ(Object(t),!0).forEach(function(i){IOe(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):JZ(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}function IOe(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function TOe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function eJ(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function POe(r,e,t){return e&&eJ(r.prototype,e),t&&eJ(r,t),r}var COe=ci(),g5=COe.Buffer,OOe=KA(),VA=OOe.inspect,kOe=VA&&VA.custom||"inspect";function DOe(r,e,t){g5.prototype.copy.call(r,e,t)}tJ.exports=function(){function r(){TOe(this,r),this.head=null,this.tail=null,this.length=0}return POe(r,[{key:"push",value:function(t){var i={data:t,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length}},{key:"unshift",value:function(t){var i={data:t,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length}},{key:"shift",value:function(){if(this.length!==0){var t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(this.length===0)return"";for(var i=this.head,n=""+i.data;i=i.next;)n+=t+i.data;return n}},{key:"concat",value:function(t){if(this.length===0)return g5.alloc(0);for(var i=g5.allocUnsafe(t>>>0),n=this.head,s=0;n;)DOe(n.data,i,s),s+=n.data.length,n=n.next;return i}},{key:"consume",value:function(t,i){var n;return t<this.head.data.length?(n=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):t===this.head.data.length?n=this.shift():n=i?this._getString(t):this._getBuffer(t),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var i=this.head,n=1,s=i.data;for(t-=s.length;i=i.next;){var o=i.data,a=t>o.length?o.length:t;if(a===o.length?s+=o:s+=o.slice(0,t),t-=a,t===0){a===o.length?(++n,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=o.slice(a));break}++n}return this.length-=n,s}},{key:"_getBuffer",value:function(t){var i=g5.allocUnsafe(t),n=this.head,s=1;for(n.data.copy(i),t-=n.data.length;n=n.next;){var o=n.data,a=t>o.length?o.length:t;if(o.copy(i,i.length-t,0,a),t-=a,t===0){a===o.length?(++s,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=o.slice(a));break}++s}return this.length-=s,i}},{key:kOe,value:function(t,i){return VA(this,xOe({},i,{depth:0,customInspect:!1}))}}]),r}()});var HA=m((A6t,nJ)=>{f();"use strict";function NOe(r,e){var t=this,i=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return i||n?(e?e(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(zA,this,r)):process.nextTick(zA,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(s){!e&&s?t._writableState?t._writableState.errorEmitted?process.nextTick(m5,t):(t._writableState.errorEmitted=!0,process.nextTick(iJ,t,s)):process.nextTick(iJ,t,s):e?(process.nextTick(m5,t),e(s)):process.nextTick(m5,t)}),this)}function iJ(r,e){zA(r,e),m5(r)}function m5(r){r._writableState&&!r._writableState.emitClose||r._readableState&&!r._readableState.emitClose||r.emit("close")}function BOe(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function zA(r,e){r.emit("error",e)}function LOe(r,e){var t=r._readableState,i=r._writableState;t&&t.autoDestroy||i&&i.autoDestroy?r.destroy(e):r.emit("error",e)}nJ.exports={destroy:NOe,undestroy:BOe,errorOrDestroy:LOe}});var Ud=m((x6t,aJ)=>{f();"use strict";function MOe(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}var sJ={};function po(r,e,t){t||(t=Error);function i(s,o,a){return typeof e=="string"?e:e(s,o,a)}var n=function(s){MOe(o,s);function o(a,c,u){return s.call(this,i(a,c,u))||this}return o}(t);n.prototype.name=t.name,n.prototype.code=r,sJ[r]=n}function oJ(r,e){if(Array.isArray(r)){var t=r.length;return r=r.map(function(i){return String(i)}),t>2?"one of ".concat(e," ").concat(r.slice(0,t-1).join(", "),", or ")+r[t-1]:t===2?"one of ".concat(e," ").concat(r[0]," or ").concat(r[1]):"of ".concat(e," ").concat(r[0])}else return"of ".concat(e," ").concat(String(r))}function jOe(r,e,t){return r.substr(!t||t<0?0:+t,e.length)===e}function qOe(r,e,t){return(t===void 0||t>r.length)&&(t=r.length),r.substring(t-e.length,t)===e}function UOe(r,e,t){return typeof t!="number"&&(t=0),t+e.length>r.length?!1:r.indexOf(e,t)!==-1}po("ERR_INVALID_OPT_VALUE",function(r,e){return'The value "'+e+'" is invalid for option "'+r+'"'},TypeError);po("ERR_INVALID_ARG_TYPE",function(r,e,t){var i;typeof e=="string"&&jOe(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";var n;if(qOe(r," argument"))n="The ".concat(r," ").concat(i," ").concat(oJ(e,"type"));else{var s=UOe(r,".")?"property":"argument";n='The "'.concat(r,'" ').concat(s," ").concat(i," ").concat(oJ(e,"type"))}return n+=". Received type ".concat(typeof t),n},TypeError);po("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");po("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"});po("ERR_STREAM_PREMATURE_CLOSE","Premature close");po("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"});po("ERR_MULTIPLE_CALLBACK","Callback called multiple times");po("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");po("ERR_STREAM_WRITE_AFTER_END","write after end");po("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);po("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError);po("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");aJ.exports.codes=sJ});var $A=m((I6t,cJ)=>{f();"use strict";var FOe=Ud().codes.ERR_INVALID_OPT_VALUE;function KOe(r,e,t){return r.highWaterMark!=null?r.highWaterMark:e?r[t]:null}function VOe(r,e,t,i){var n=KOe(e,i,t);if(n!=null){if(!(isFinite(n)&&Math.floor(n)===n)||n<0){var s=i?t:"highWaterMark";throw new FOe(s,n)}return Math.floor(n)}return r.objectMode?16:16*1024}cJ.exports={getHighWaterMark:VOe}});var lJ=m((T6t,uJ)=>{f();uJ.exports=zOe;function zOe(r,e){if(GA("noDeprecation"))return r;var t=!1;function i(){if(!t){if(GA("throwDeprecation"))throw new Error(e);GA("traceDeprecation")?console.trace(e):console.warn(e),t=!0}return r.apply(this,arguments)}return i}function GA(r){try{if(!globalThis.localStorage)return!1}catch(t){return!1}var e=globalThis.localStorage[r];return e==null?!1:String(e).toLowerCase()==="true"}});var XA=m((P6t,gJ)=>{f();"use strict";gJ.exports=ti;function fJ(r){var e=this;this.next=null,this.entry=null,this.finish=function(){mke(e,r)}}var U0;ti.WritableState=Pg;var HOe={deprecate:lJ()},dJ=FA(),b5=ci().Buffer,$Oe=globalThis.Uint8Array||function(){};function GOe(r){return b5.from(r)}function WOe(r){return b5.isBuffer(r)||r instanceof $Oe}var WA=HA(),YOe=$A(),XOe=YOe.getHighWaterMark,$l=Ud().codes,QOe=$l.ERR_INVALID_ARG_TYPE,ZOe=$l.ERR_METHOD_NOT_IMPLEMENTED,JOe=$l.ERR_MULTIPLE_CALLBACK,eke=$l.ERR_STREAM_CANNOT_PIPE,tke=$l.ERR_STREAM_DESTROYED,rke=$l.ERR_STREAM_NULL_VALUES,ike=$l.ERR_STREAM_WRITE_AFTER_END,nke=$l.ERR_UNKNOWN_ENCODING,F0=WA.errorOrDestroy;ho()(ti,dJ);function ske(){}function Pg(r,e,t){U0=U0||Fd(),r=r||{},typeof t!="boolean"&&(t=e instanceof U0),this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.writableObjectMode),this.highWaterMark=XOe(this,r,"writableHighWaterMark",t),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=r.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=r.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(n){dke(e,n)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=r.emitClose!==!1,this.autoDestroy=!!r.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new fJ(this)}Pg.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};(function(){try{Object.defineProperty(Pg.prototype,"buffer",{get:HOe.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(r){}})();var w5;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(w5=Function.prototype[Symbol.hasInstance],Object.defineProperty(ti,Symbol.hasInstance,{value:function(e){return w5.call(this,e)?!0:this!==ti?!1:e&&e._writableState instanceof Pg}})):w5=function(e){return e instanceof this};function ti(r){U0=U0||Fd();var e=this instanceof U0;if(!e&&!w5.call(ti,this))return new ti(r);this._writableState=new Pg(r,this,e),this.writable=!0,r&&(typeof r.write=="function"&&(this._write=r.write),typeof r.writev=="function"&&(this._writev=r.writev),typeof r.destroy=="function"&&(this._destroy=r.destroy),typeof r.final=="function"&&(this._final=r.final)),dJ.call(this)}ti.prototype.pipe=function(){F0(this,new eke)};function oke(r,e){var t=new ike;F0(r,t),process.nextTick(e,t)}function ake(r,e,t,i){var n;return t===null?n=new rke:typeof t!="string"&&!e.objectMode&&(n=new QOe("chunk",["string","Buffer"],t)),n?(F0(r,n),process.nextTick(i,n),!1):!0}ti.prototype.write=function(r,e,t){var i=this._writableState,n=!1,s=!i.objectMode&&WOe(r);return s&&!b5.isBuffer(r)&&(r=GOe(r)),typeof e=="function"&&(t=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),typeof t!="function"&&(t=ske),i.ending?oke(this,t):(s||ake(this,i,r,t))&&(i.pendingcb++,n=uke(this,i,s,r,e,t)),n};ti.prototype.cork=function(){this._writableState.corked++};ti.prototype.uncork=function(){var r=this._writableState;r.corked&&(r.corked--,!r.writing&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&pJ(this,r))};ti.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new nke(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(ti.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function cke(r,e,t){return!r.objectMode&&r.decodeStrings!==!1&&typeof e=="string"&&(e=b5.from(e,t)),e}Object.defineProperty(ti.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function uke(r,e,t,i,n,s){if(!t){var o=cke(e,i,n);i!==o&&(t=!0,n="buffer",i=o)}var a=e.objectMode?1:i.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:t,callback:s,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else YA(r,e,!1,a,i,n,s);return c}function YA(r,e,t,i,n,s,o){e.writelen=i,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new tke("write")):t?r._writev(n,e.onwrite):r._write(n,s,e.onwrite),e.sync=!1}function lke(r,e,t,i,n){--e.pendingcb,t?(process.nextTick(n,i),process.nextTick(Cg,r,e),r._writableState.errorEmitted=!0,F0(r,i)):(n(i),r._writableState.errorEmitted=!0,F0(r,i),Cg(r,e))}function fke(r){r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0}function dke(r,e){var t=r._writableState,i=t.sync,n=t.writecb;if(typeof n!="function")throw new JOe;if(fke(t),e)lke(r,t,i,e,n);else{var s=yJ(t)||r.destroyed;!s&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&pJ(r,t),i?process.nextTick(hJ,r,t,s,n):hJ(r,t,s,n)}}function hJ(r,e,t,i){t||hke(r,e),e.pendingcb--,i(),Cg(r,e)}function hke(r,e){e.length===0&&e.needDrain&&(e.needDrain=!1,r.emit("drain"))}function pJ(r,e){e.bufferProcessing=!0;var t=e.bufferedRequest;if(r._writev&&t&&t.next){var i=e.bufferedRequestCount,n=new Array(i),s=e.corkedRequestsFree;s.entry=t;for(var o=0,a=!0;t;)n[o]=t,t.isBuf||(a=!1),t=t.next,o+=1;n.allBuffers=a,YA(r,e,!0,e.length,n,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new fJ(e),e.bufferedRequestCount=0}else{for(;t;){var c=t.chunk,u=t.encoding,l=t.callback,d=e.objectMode?1:c.length;if(YA(r,e,!1,d,c,u,l),t=t.next,e.bufferedRequestCount--,e.writing)break}t===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=t,e.bufferProcessing=!1}ti.prototype._write=function(r,e,t){t(new ZOe("_write()"))};ti.prototype._writev=null;ti.prototype.end=function(r,e,t){var i=this._writableState;return typeof r=="function"?(t=r,r=null,e=null):typeof e=="function"&&(t=e,e=null),r!=null&&this.write(r,e),i.corked&&(i.corked=1,this.uncork()),i.ending||gke(this,i,t),this};Object.defineProperty(ti.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function yJ(r){return r.ending&&r.length===0&&r.bufferedRequest===null&&!r.finished&&!r.writing}function pke(r,e){r._final(function(t){e.pendingcb--,t&&F0(r,t),e.prefinished=!0,r.emit("prefinish"),Cg(r,e)})}function yke(r,e){!e.prefinished&&!e.finalCalled&&(typeof r._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(pke,r,e)):(e.prefinished=!0,r.emit("prefinish")))}function Cg(r,e){var t=yJ(e);if(t&&(yke(r,e),e.pendingcb===0&&(e.finished=!0,r.emit("finish"),e.autoDestroy))){var i=r._readableState;(!i||i.autoDestroy&&i.endEmitted)&&r.destroy()}return t}function gke(r,e,t){e.ending=!0,Cg(r,e),t&&(e.finished?process.nextTick(t):r.once("finish",t)),e.ended=!0,r.writable=!1}function mke(r,e,t){var i=r.entry;for(r.entry=null;i;){var n=i.callback;e.pendingcb--,n(t),i=i.next}e.corkedRequestsFree.next=r}Object.defineProperty(ti.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});ti.prototype.destroy=WA.destroy;ti.prototype._undestroy=WA.undestroy;ti.prototype._destroy=function(r,e){e(r)}});var Fd=m((C6t,bJ)=>{f();"use strict";var bke=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};bJ.exports=fc;var mJ=JA(),QA=XA();ho()(fc,mJ);for(ZA=bke(QA.prototype),_5=0;_5<ZA.length;_5++)v5=ZA[_5],fc.prototype[v5]||(fc.prototype[v5]=QA.prototype[v5]);var ZA,v5,_5;function fc(r){if(!(this instanceof fc))return new fc(r);mJ.call(this,r),QA.call(this,r),this.allowHalfOpen=!0,r&&(r.readable===!1&&(this.readable=!1),r.writable===!1&&(this.writable=!1),r.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",wke)))}Object.defineProperty(fc.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(fc.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(fc.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function wke(){this._writableState.ended||process.nextTick(_ke,this)}function _ke(r){r.end()}Object.defineProperty(fc.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var tx=m((ex,_J)=>{f();var E5=ci(),dc=E5.Buffer;function wJ(r,e){for(var t in r)e[t]=r[t]}dc.from&&dc.alloc&&dc.allocUnsafe&&dc.allocUnsafeSlow?_J.exports=E5:(wJ(E5,ex),ex.Buffer=Kd);function Kd(r,e,t){return dc(r,e,t)}Kd.prototype=Object.create(dc.prototype);wJ(dc,Kd);Kd.from=function(r,e,t){if(typeof r=="number")throw new TypeError("Argument must not be a number");return dc(r,e,t)};Kd.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError("Argument must be a number");var i=dc(r);return e!==void 0?typeof t=="string"?i.fill(e,t):i.fill(e):i.fill(0),i};Kd.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return dc(r)};Kd.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return E5.SlowBuffer(r)}});var nx=m(EJ=>{f();"use strict";var rx=tx().Buffer,vJ=rx.isEncoding||function(r){switch(r=""+r,r&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function vke(r){if(!r)return"utf8";for(var e;;)switch(r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:if(e)return;r=(""+r).toLowerCase(),e=!0}}function Eke(r){var e=vke(r);if(typeof e!="string"&&(rx.isEncoding===vJ||!vJ(r)))throw new Error("Unknown encoding: "+r);return e||r}EJ.StringDecoder=Og;function Og(r){this.encoding=Eke(r);var e;switch(this.encoding){case"utf16le":this.text=Tke,this.end=Pke,e=4;break;case"utf8":this.fillLast=Ake,e=4;break;case"base64":this.text=Cke,this.end=Oke,e=3;break;default:this.write=kke,this.end=Dke;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=rx.allocUnsafe(e)}Og.prototype.write=function(r){if(r.length===0)return"";var e,t;if(this.lastNeed){if(e=this.fillLast(r),e===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<r.length?e?e+this.text(r,t):this.text(r,t):e||""};Og.prototype.end=Ike;Og.prototype.text=xke;Og.prototype.fillLast=function(r){if(this.lastNeed<=r.length)return r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,r.length),this.lastNeed-=r.length};function ix(r){return r<=127?0:r>>5==6?2:r>>4==14?3:r>>3==30?4:r>>6==2?-1:-2}function Ske(r,e,t){var i=e.length-1;if(i<t)return 0;var n=ix(e[i]);return n>=0?(n>0&&(r.lastNeed=n-1),n):--i<t||n===-2?0:(n=ix(e[i]),n>=0?(n>0&&(r.lastNeed=n-2),n):--i<t||n===-2?0:(n=ix(e[i]),n>=0?(n>0&&(n===2?n=0:r.lastNeed=n-3),n):0))}function Rke(r,e,t){if((e[0]&192)!=128)return r.lastNeed=0,"\uFFFD";if(r.lastNeed>1&&e.length>1){if((e[1]&192)!=128)return r.lastNeed=1,"\uFFFD";if(r.lastNeed>2&&e.length>2&&(e[2]&192)!=128)return r.lastNeed=2,"\uFFFD"}}function Ake(r){var e=this.lastTotal-this.lastNeed,t=Rke(this,r,e);if(t!==void 0)return t;if(this.lastNeed<=r.length)return r.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,e,0,r.length),this.lastNeed-=r.length}function xke(r,e){var t=Ske(this,r,e);if(!this.lastNeed)return r.toString("utf8",e);this.lastTotal=t;var i=r.length-(t-this.lastNeed);return r.copy(this.lastChar,0,i),r.toString("utf8",e,i)}function Ike(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+"\uFFFD":e}function Tke(r,e){if((r.length-e)%2==0){var t=r.toString("utf16le",e);if(t){var i=t.charCodeAt(t.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=r[r.length-1],r.toString("utf16le",e,r.length-1)}function Pke(r){var e=r&&r.length?this.write(r):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function Cke(r,e){var t=(r.length-e)%3;return t===0?r.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",e,r.length-t))}function Oke(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function kke(r){return r.toString(this.encoding)}function Dke(r){return r&&r.length?this.write(r):""}});var S5=m((k6t,AJ)=>{f();"use strict";var SJ=Ud().codes.ERR_STREAM_PREMATURE_CLOSE;function Nke(r){var e=!1;return function(){if(!e){e=!0;for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];r.apply(this,i)}}}function Bke(){}function Lke(r){return r.setHeader&&typeof r.abort=="function"}function RJ(r,e,t){if(typeof e=="function")return RJ(r,null,e);e||(e={}),t=Nke(t||Bke);var i=e.readable||e.readable!==!1&&r.readable,n=e.writable||e.writable!==!1&&r.writable,s=function(){r.writable||a()},o=r._writableState&&r._writableState.finished,a=function(){n=!1,o=!0,i||t.call(r)},c=r._readableState&&r._readableState.endEmitted,u=function(){i=!1,c=!0,n||t.call(r)},l=function(y){t.call(r,y)},d=function(){var y;if(i&&!c)return(!r._readableState||!r._readableState.ended)&&(y=new SJ),t.call(r,y);if(n&&!o)return(!r._writableState||!r._writableState.ended)&&(y=new SJ),t.call(r,y)},h=function(){r.req.on("finish",a)};return Lke(r)?(r.on("complete",a),r.on("abort",d),r.req?h():r.on("request",h)):n&&!r._writableState&&(r.on("end",s),r.on("close",s)),r.on("end",u),r.on("finish",a),e.error!==!1&&r.on("error",l),r.on("close",d),function(){r.removeListener("complete",a),r.removeListener("abort",d),r.removeListener("request",h),r.req&&r.req.removeListener("finish",a),r.removeListener("end",s),r.removeListener("close",s),r.removeListener("finish",a),r.removeListener("end",u),r.removeListener("error",l),r.removeListener("close",d)}}AJ.exports=RJ});var IJ=m((D6t,xJ)=>{f();"use strict";var R5;function Gl(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var Mke=S5(),Wl=Symbol("lastResolve"),Vd=Symbol("lastReject"),kg=Symbol("error"),A5=Symbol("ended"),zd=Symbol("lastPromise"),sx=Symbol("handlePromise"),Hd=Symbol("stream");function Yl(r,e){return{value:r,done:e}}function jke(r){var e=r[Wl];if(e!==null){var t=r[Hd].read();t!==null&&(r[zd]=null,r[Wl]=null,r[Vd]=null,e(Yl(t,!1)))}}function qke(r){process.nextTick(jke,r)}function Uke(r,e){return function(t,i){r.then(function(){if(e[A5]){t(Yl(void 0,!0));return}e[sx](t,i)},i)}}var Fke=Object.getPrototypeOf(function(){}),Kke=Object.setPrototypeOf((R5={get stream(){return this[Hd]},next:function(){var e=this,t=this[kg];if(t!==null)return Promise.reject(t);if(this[A5])return Promise.resolve(Yl(void 0,!0));if(this[Hd].destroyed)return new Promise(function(o,a){process.nextTick(function(){e[kg]?a(e[kg]):o(Yl(void 0,!0))})});var i=this[zd],n;if(i)n=new Promise(Uke(i,this));else{var s=this[Hd].read();if(s!==null)return Promise.resolve(Yl(s,!1));n=new Promise(this[sx])}return this[zd]=n,n}},Gl(R5,Symbol.asyncIterator,function(){return this}),Gl(R5,"return",function(){var e=this;return new Promise(function(t,i){e[Hd].destroy(null,function(n){if(n){i(n);return}t(Yl(void 0,!0))})})}),R5),Fke),Vke=function(e){var t,i=Object.create(Kke,(t={},Gl(t,Hd,{value:e,writable:!0}),Gl(t,Wl,{value:null,writable:!0}),Gl(t,Vd,{value:null,writable:!0}),Gl(t,kg,{value:null,writable:!0}),Gl(t,A5,{value:e._readableState.endEmitted,writable:!0}),Gl(t,sx,{value:function(s,o){var a=i[Hd].read();a?(i[zd]=null,i[Wl]=null,i[Vd]=null,s(Yl(a,!1))):(i[Wl]=s,i[Vd]=o)},writable:!0}),t));return i[zd]=null,Mke(e,function(n){if(n&&n.code!=="ERR_STREAM_PREMATURE_CLOSE"){var s=i[Vd];s!==null&&(i[zd]=null,i[Wl]=null,i[Vd]=null,s(n)),i[kg]=n;return}var o=i[Wl];o!==null&&(i[zd]=null,i[Wl]=null,i[Vd]=null,o(Yl(void 0,!0))),i[A5]=!0}),e.on("readable",qke.bind(null,i)),i};xJ.exports=Vke});var PJ=m((N6t,TJ)=>{f();TJ.exports=function(){throw new Error("Readable.from is not available in the browser")}});var JA=m((L6t,qJ)=>{f();"use strict";qJ.exports=Ht;var K0;Ht.ReadableState=OJ;var B6t=Ut().EventEmitter,CJ=function(e,t){return e.listeners(t).length},Dg=FA(),x5=ci().Buffer,zke=globalThis.Uint8Array||function(){};function Hke(r){return x5.from(r)}function $ke(r){return x5.isBuffer(r)||r instanceof zke}var ox=KA(),vt;ox&&ox.debuglog?vt=ox.debuglog("stream"):vt=function(){};var Gke=rJ(),ax=HA(),Wke=$A(),Yke=Wke.getHighWaterMark,I5=Ud().codes,Xke=I5.ERR_INVALID_ARG_TYPE,Qke=I5.ERR_STREAM_PUSH_AFTER_EOF,Zke=I5.ERR_METHOD_NOT_IMPLEMENTED,Jke=I5.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,V0,cx,ux;ho()(Ht,Dg);var Ng=ax.errorOrDestroy,lx=["error","close","destroy","pause","resume"];function eDe(r,e,t){if(typeof r.prependListener=="function")return r.prependListener(e,t);!r._events||!r._events[e]?r.on(e,t):Array.isArray(r._events[e])?r._events[e].unshift(t):r._events[e]=[t,r._events[e]]}function OJ(r,e,t){K0=K0||Fd(),r=r||{},typeof t!="boolean"&&(t=e instanceof K0),this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.readableObjectMode),this.highWaterMark=Yke(this,r,"readableHighWaterMark",t),this.buffer=new Gke,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=r.emitClose!==!1,this.autoDestroy=!!r.autoDestroy,this.destroyed=!1,this.defaultEncoding=r.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,r.encoding&&(V0||(V0=nx().StringDecoder),this.decoder=new V0(r.encoding),this.encoding=r.encoding)}function Ht(r){if(K0=K0||Fd(),!(this instanceof Ht))return new Ht(r);var e=this instanceof K0;this._readableState=new OJ(r,this,e),this.readable=!0,r&&(typeof r.read=="function"&&(this._read=r.read),typeof r.destroy=="function"&&(this._destroy=r.destroy)),Dg.call(this)}Object.defineProperty(Ht.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});Ht.prototype.destroy=ax.destroy;Ht.prototype._undestroy=ax.undestroy;Ht.prototype._destroy=function(r,e){e(r)};Ht.prototype.push=function(r,e){var t=this._readableState,i;return t.objectMode?i=!0:typeof r=="string"&&(e=e||t.defaultEncoding,e!==t.encoding&&(r=x5.from(r,e),e=""),i=!0),kJ(this,r,e,!1,i)};Ht.prototype.unshift=function(r){return kJ(this,r,null,!0,!1)};function kJ(r,e,t,i,n){vt("readableAddChunk",e);var s=r._readableState;if(e===null)s.reading=!1,iDe(r,s);else{var o;if(n||(o=tDe(s,e)),o)Ng(r,o);else if(s.objectMode||e&&e.length>0)if(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==x5.prototype&&(e=Hke(e)),i)s.endEmitted?Ng(r,new Jke):fx(r,s,e,!0);else if(s.ended)Ng(r,new Qke);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!t?(e=s.decoder.write(e),s.objectMode||e.length!==0?fx(r,s,e,!1):dx(r,s)):fx(r,s,e,!1)}else i||(s.reading=!1,dx(r,s))}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function fx(r,e,t,i){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,r.emit("data",t)):(e.length+=e.objectMode?1:t.length,i?e.buffer.unshift(t):e.buffer.push(t),e.needReadable&&T5(r)),dx(r,e)}function tDe(r,e){var t;return!$ke(e)&&typeof e!="string"&&e!==void 0&&!r.objectMode&&(t=new Xke("chunk",["string","Buffer","Uint8Array"],e)),t}Ht.prototype.isPaused=function(){return this._readableState.flowing===!1};Ht.prototype.setEncoding=function(r){V0||(V0=nx().StringDecoder);var e=new V0(r);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var t=this._readableState.buffer.head,i="";t!==null;)i+=e.write(t.data),t=t.next;return this._readableState.buffer.clear(),i!==""&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var DJ=1073741824;function rDe(r){return r>=DJ?r=DJ:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r}function NJ(r,e){return r<=0||e.length===0&&e.ended?0:e.objectMode?1:r!==r?e.flowing&&e.length?e.buffer.head.data.length:e.length:(r>e.highWaterMark&&(e.highWaterMark=rDe(r)),r<=e.length?r:e.ended?e.length:(e.needReadable=!0,0))}Ht.prototype.read=function(r){vt("read",r),r=parseInt(r,10);var e=this._readableState,t=r;if(r!==0&&(e.emittedReadable=!1),r===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return vt("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?px(this):T5(this),null;if(r=NJ(r,e),r===0&&e.ended)return e.length===0&&px(this),null;var i=e.needReadable;vt("need readable",i),(e.length===0||e.length-r<e.highWaterMark)&&(i=!0,vt("length less than watermark",i)),e.ended||e.reading?(i=!1,vt("reading or ended",i)):i&&(vt("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(r=NJ(t,e)));var n;return r>0?n=MJ(r,e):n=null,n===null?(e.needReadable=e.length<=e.highWaterMark,r=0):(e.length-=r,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),t!==r&&e.ended&&px(this)),n!==null&&this.emit("data",n),n};function iDe(r,e){if(vt("onEofChunk"),!e.ended){if(e.decoder){var t=e.decoder.end();t&&t.length&&(e.buffer.push(t),e.length+=e.objectMode?1:t.length)}e.ended=!0,e.sync?T5(r):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,BJ(r)))}}function T5(r){var e=r._readableState;vt("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(vt("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(BJ,r))}function BJ(r){var e=r._readableState;vt("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(r.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,hx(r)}function dx(r,e){e.readingMore||(e.readingMore=!0,process.nextTick(nDe,r,e))}function nDe(r,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var t=e.length;if(vt("maybeReadMore read 0"),r.read(0),t===e.length)break}e.readingMore=!1}Ht.prototype._read=function(r){Ng(this,new Zke("_read()"))};Ht.prototype.pipe=function(r,e){var t=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=r;break;case 1:i.pipes=[i.pipes,r];break;default:i.pipes.push(r);break}i.pipesCount+=1,vt("pipe count=%d opts=%j",i.pipesCount,e);var n=(!e||e.end!==!1)&&r!==process.stdout&&r!==process.stderr,s=n?a:g;i.endEmitted?process.nextTick(s):t.once("end",s),r.on("unpipe",o);function o(w,b){vt("onunpipe"),w===t&&b&&b.hasUnpiped===!1&&(b.hasUnpiped=!0,l())}function a(){vt("onend"),r.end()}var c=sDe(t);r.on("drain",c);var u=!1;function l(){vt("cleanup"),r.removeListener("close",p),r.removeListener("finish",y),r.removeListener("drain",c),r.removeListener("error",h),r.removeListener("unpipe",o),t.removeListener("end",a),t.removeListener("end",g),t.removeListener("data",d),u=!0,i.awaitDrain&&(!r._writableState||r._writableState.needDrain)&&c()}t.on("data",d);function d(w){vt("ondata");var b=r.write(w);vt("dest.write",b),b===!1&&((i.pipesCount===1&&i.pipes===r||i.pipesCount>1&&jJ(i.pipes,r)!==-1)&&!u&&(vt("false write response, pause",i.awaitDrain),i.awaitDrain++),t.pause())}function h(w){vt("onerror",w),g(),r.removeListener("error",h),CJ(r,"error")===0&&Ng(r,w)}eDe(r,"error",h);function p(){r.removeListener("finish",y),g()}r.once("close",p);function y(){vt("onfinish"),r.removeListener("close",p),g()}r.once("finish",y);function g(){vt("unpipe"),t.unpipe(r)}return r.emit("pipe",t),i.flowing||(vt("pipe resume"),t.resume()),r};function sDe(r){return function(){var t=r._readableState;vt("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,t.awaitDrain===0&&CJ(r,"data")&&(t.flowing=!0,hx(r))}}Ht.prototype.unpipe=function(r){var e=this._readableState,t={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return r&&r!==e.pipes?this:(r||(r=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,r&&r.emit("unpipe",this,t),this);if(!r){var i=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=jJ(e.pipes,r);return o===-1?this:(e.pipes.splice(o,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),r.emit("unpipe",this,t),this)};Ht.prototype.on=function(r,e){var t=Dg.prototype.on.call(this,r,e),i=this._readableState;return r==="data"?(i.readableListening=this.listenerCount("readable")>0,i.flowing!==!1&&this.resume()):r==="readable"&&!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,vt("on readable",i.length,i.reading),i.length?T5(this):i.reading||process.nextTick(oDe,this)),t};Ht.prototype.addListener=Ht.prototype.on;Ht.prototype.removeListener=function(r,e){var t=Dg.prototype.removeListener.call(this,r,e);return r==="readable"&&process.nextTick(LJ,this),t};Ht.prototype.removeAllListeners=function(r){var e=Dg.prototype.removeAllListeners.apply(this,arguments);return(r==="readable"||r===void 0)&&process.nextTick(LJ,this),e};function LJ(r){var e=r._readableState;e.readableListening=r.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:r.listenerCount("data")>0&&r.resume()}function oDe(r){vt("readable nexttick read 0"),r.read(0)}Ht.prototype.resume=function(){var r=this._readableState;return r.flowing||(vt("resume"),r.flowing=!r.readableListening,aDe(this,r)),r.paused=!1,this};function aDe(r,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(cDe,r,e))}function cDe(r,e){vt("resume",e.reading),e.reading||r.read(0),e.resumeScheduled=!1,r.emit("resume"),hx(r),e.flowing&&!e.reading&&r.read(0)}Ht.prototype.pause=function(){return vt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(vt("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function hx(r){var e=r._readableState;for(vt("flow",e.flowing);e.flowing&&r.read()!==null;);}Ht.prototype.wrap=function(r){var e=this,t=this._readableState,i=!1;r.on("end",function(){if(vt("wrapped end"),t.decoder&&!t.ended){var o=t.decoder.end();o&&o.length&&e.push(o)}e.push(null)}),r.on("data",function(o){if(vt("wrapped data"),t.decoder&&(o=t.decoder.write(o)),!(t.objectMode&&o==null)&&!(!t.objectMode&&(!o||!o.length))){var a=e.push(o);a||(i=!0,r.pause())}});for(var n in r)this[n]===void 0&&typeof r[n]=="function"&&(this[n]=function(a){return function(){return r[a].apply(r,arguments)}}(n));for(var s=0;s<lx.length;s++)r.on(lx[s],this.emit.bind(this,lx[s]));return this._read=function(o){vt("wrapped _read",o),i&&(i=!1,r.resume())},this};typeof Symbol=="function"&&(Ht.prototype[Symbol.asyncIterator]=function(){return cx===void 0&&(cx=IJ()),cx(this)});Object.defineProperty(Ht.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(Ht.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Ht.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});Ht._fromList=MJ;Object.defineProperty(Ht.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function MJ(r,e){if(e.length===0)return null;var t;return e.objectMode?t=e.buffer.shift():!r||r>=e.length?(e.decoder?t=e.buffer.join(""):e.buffer.length===1?t=e.buffer.first():t=e.buffer.concat(e.length),e.buffer.clear()):t=e.buffer.consume(r,e.decoder),t}function px(r){var e=r._readableState;vt("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(uDe,e,r))}function uDe(r,e){if(vt("endReadableNT",r.endEmitted,r.length),!r.endEmitted&&r.length===0&&(r.endEmitted=!0,e.readable=!1,e.emit("end"),r.autoDestroy)){var t=e._writableState;(!t||t.autoDestroy&&t.finished)&&e.destroy()}}typeof Symbol=="function"&&(Ht.from=function(r,e){return ux===void 0&&(ux=PJ()),ux(Ht,r,e)});function jJ(r,e){for(var t=0,i=r.length;t<i;t++)if(r[t]===e)return t;return-1}});var yx=m((M6t,FJ)=>{f();"use strict";FJ.exports=yu;var P5=Ud().codes,lDe=P5.ERR_METHOD_NOT_IMPLEMENTED,fDe=P5.ERR_MULTIPLE_CALLBACK,dDe=P5.ERR_TRANSFORM_ALREADY_TRANSFORMING,hDe=P5.ERR_TRANSFORM_WITH_LENGTH_0,C5=Fd();ho()(yu,C5);function pDe(r,e){var t=this._transformState;t.transforming=!1;var i=t.writecb;if(i===null)return this.emit("error",new fDe);t.writechunk=null,t.writecb=null,e!=null&&this.push(e),i(r);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function yu(r){if(!(this instanceof yu))return new yu(r);C5.call(this,r),this._transformState={afterTransform:pDe.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&(typeof r.transform=="function"&&(this._transform=r.transform),typeof r.flush=="function"&&(this._flush=r.flush)),this.on("prefinish",yDe)}function yDe(){var r=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,t){UJ(r,e,t)}):UJ(this,null,null)}yu.prototype.push=function(r,e){return this._transformState.needTransform=!1,C5.prototype.push.call(this,r,e)};yu.prototype._transform=function(r,e,t){t(new lDe("_transform()"))};yu.prototype._write=function(r,e,t){var i=this._transformState;if(i.writecb=t,i.writechunk=r,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};yu.prototype._read=function(r){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};yu.prototype._destroy=function(r,e){C5.prototype._destroy.call(this,r,function(t){e(t)})};function UJ(r,e,t){if(e)return r.emit("error",e);if(t!=null&&r.push(t),r._writableState.length)throw new hDe;if(r._transformState.transforming)throw new dDe;return r.push(null)}});var zJ=m((j6t,VJ)=>{f();"use strict";VJ.exports=Bg;var KJ=yx();ho()(Bg,KJ);function Bg(r){if(!(this instanceof Bg))return new Bg(r);KJ.call(this,r)}Bg.prototype._transform=function(r,e,t){t(null,r)}});var YJ=m((q6t,WJ)=>{f();"use strict";var gx;function gDe(r){var e=!1;return function(){e||(e=!0,r.apply(void 0,arguments))}}var HJ=Ud().codes,mDe=HJ.ERR_MISSING_ARGS,bDe=HJ.ERR_STREAM_DESTROYED;function $J(r){if(r)throw r}function wDe(r){return r.setHeader&&typeof r.abort=="function"}function _De(r,e,t,i){i=gDe(i);var n=!1;r.on("close",function(){n=!0}),gx===void 0&&(gx=S5()),gx(r,{readable:e,writable:t},function(o){if(o)return i(o);n=!0,i()});var s=!1;return function(o){if(!n&&!s){if(s=!0,wDe(r))return r.abort();if(typeof r.destroy=="function")return r.destroy();i(o||new bDe("pipe"))}}}function GJ(r){r()}function vDe(r,e){return r.pipe(e)}function EDe(r){return!r.length||typeof r[r.length-1]!="function"?$J:r.pop()}function SDe(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var i=EDe(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new mDe("streams");var n,s=e.map(function(o,a){var c=a<e.length-1,u=a>0;return _De(o,c,u,function(l){n||(n=l),l&&s.forEach(GJ),!c&&(s.forEach(GJ),i(n))})});return e.reduce(vDe)}WJ.exports=SDe});var mx=m((yo,XJ)=>{f();yo=XJ.exports=JA();yo.Stream=yo;yo.Readable=yo;yo.Writable=XA();yo.Duplex=Fd();yo.Transform=yx();yo.PassThrough=zJ();yo.finished=S5();yo.pipeline=YJ()});var JJ=m((U6t,ZJ)=>{f();"use strict";var RDe=ho(),{Readable:QJ}=mx();ZJ.exports=z0;RDe(z0,QJ);function z0(r,e){if(!(this instanceof z0))return new z0(r,e);e=e||{},QJ.call(this,Object.assign({},e,{objectMode:!0})),this._iterator=r,this._options=e,this.on("end",this.destroy.bind(this,null,null))}z0.prototype._read=function(){this.destroyed||this._iterator.next((r,e,t)=>{if(!this.destroyed){if(r)return this.destroy(r);e===void 0&&t===void 0?this.push(null):this._options.keys!==!1&&this._options.values===!1?this.push(e):this._options.keys===!1&&this._options.values!==!1?this.push(t):this.push({key:e,value:t})}})};z0.prototype._destroy=function(r,e){this._iterator.end(function(t){e(r||t)})}});var k5=m((F6t,O5)=>{f();"use strict";function $d(r,e){let t=function(i,n){if(typeof i=="object"&&i!==null&&(n=n||i,i=i.message||i.name),i=i||"",n=n||void 0,typeof n=="object"&&n.type===r&&n.message===i)return n;Object.defineProperty(this,"type",{value:r,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"name",{value:r,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"cause",{value:n,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"message",{value:i,enumerable:!1,writable:!0,configurable:!0}),Error.call(this),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,t)};return t.prototype=new e,t}var Gd=$d("LevelUPError",Error);O5.exports={LevelUPError:Gd,InitializationError:$d("InitializationError",Gd),OpenError:$d("OpenError",Gd),ReadError:$d("ReadError",Gd),WriteError:$d("WriteError",Gd),NotFoundError:$d("NotFoundError",Gd),EncodingError:$d("EncodingError",Gd)};O5.exports.NotFoundError.prototype.notFound=!0;O5.exports.NotFoundError.prototype.status=404});var Lg=m(bx=>{f();"use strict";bx.getCallback=function(r,e){return typeof r=="function"?r:e};bx.getOptions=function(r){return typeof r=="object"&&r!==null?r:{}}});var tee=m((V6t,eee)=>{f();"use strict";var Mg=k5().WriteError,ADe=d5(),xDe=Lg().getCallback,IDe=Lg().getOptions;function jg(r){this.db=r,this.batch=r.db.batch(),this.ops=[],this.length=0}jg.prototype.put=function(r,e,t){try{this.batch.put(r,e,t)}catch(i){throw new Mg(i)}return this.ops.push({...t,type:"put",key:r,value:e}),this.length++,this};jg.prototype.del=function(r,e){try{this.batch.del(r,e)}catch(t){throw new Mg(t)}return this.ops.push({...e,type:"del",key:r}),this.length++,this};jg.prototype.clear=function(){try{this.batch.clear()}catch(r){throw new Mg(r)}return this.ops=[],this.length=0,this};jg.prototype.write=function(r,e){let t=this.db,i=this.ops;e=xDe(r,e),e=ADe.fromCallback(e),r=IDe(r);try{this.batch.write(r,function(n){if(n)return e(new Mg(n));t.emit("batch",i),e()})}catch(n){throw new Mg(n)}return e.promise};eee.exports=jg});var nee=m((z6t,iee)=>{f();"use strict";var ree=Ig();iee.exports=function(r,...e){e.length===0?ree(r):ree(()=>r(...e))}});var aee=m((H6t,oee)=>{f();"use strict";var D5=Ut().EventEmitter,TDe=vZ().inherits,PDe=QZ(),CDe=JJ(),ODe=tee(),H0=k5(),kDe=kA(),Wd=d5(),qg=Lg().getCallback,$0=Lg().getOptions,Ug=nee(),N5=H0.WriteError,see=H0.ReadError,DDe=H0.NotFoundError,NDe=H0.OpenError,BDe=H0.InitializationError;function tr(r,e,t){if(!(this instanceof tr))return new tr(r,e,t);let i;if(D5.call(this),this.setMaxListeners(1/0),typeof e=="function"&&(t=e,e={}),e=e||{},!r||typeof r!="object"){if(i=new BDe("First argument must be an abstract-leveldown compliant store"),typeof t=="function")return Ug(t,i);throw i}if(typeof r.status!="string")throw new Error(".status required, old abstract-leveldown");this.options=$0(e),this._db=r,this.db=null,this.open(t||(n=>{n&&this.emit("error",n)})),this.supports=kDe(this.db.supports,{status:!0,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0});for(let n of Object.keys(this.supports.additionalMethods))this[n]==null&&(this[n]=function(...s){return this.db[n](...s)})}tr.prototype.emit=D5.prototype.emit;tr.prototype.once=D5.prototype.once;TDe(tr,D5);Object.defineProperty(tr.prototype,"status",{enumerable:!0,get(){return this.db.status}});tr.prototype.isOperational=function(){return this.db.status==="open"||this.db.status==="opening"};tr.prototype.open=function(r,e){return typeof r=="function"&&(e=r,r=null),e=Wd.fromCallback(e),r||(r=this.options),this.db&&this.isOpen()?(Ug(e,null,this),e.promise):this.db&&this._isOpening()?(this.once("open",()=>{e(null,this)}),e.promise):(this.db=new PDe(this._db),this.emit("opening"),this.db.open(r,t=>{if(t)return e(new NDe(t));this.db=this._db,e(null,this),this.emit("open"),this.emit("ready")}),e.promise)};tr.prototype.close=function(r){return r=Wd.fromCallback(r),this.isOpen()?(this.db.close((e,...t)=>{this.emit("closed"),r(e,...t)}),this.emit("closing")):this.isClosed()?Ug(r):this.db.status==="closing"?this.once("closed",r):this._isOpening()&&this.once("open",()=>{this.close(r)}),r.promise};tr.prototype.isOpen=function(){return this.db.status==="open"};tr.prototype._isOpening=function(){return this.db.status==="opening"};tr.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)};tr.prototype.get=function(r,e,t){return t=qg(e,t),t=Wd.fromCallback(t),Fg(this,t)||(e=$0(e),this.db.get(r,e,function(i,n){if(i)return/notfound/i.test(i)||i.notFound?i=new DDe("Key not found in database ["+r+"]",i):i=new see(i),t(i);t(null,n)})),t.promise};tr.prototype.getMany=function(r,e,t){return this.db.getMany(r,e,t)};tr.prototype.put=function(r,e,t,i){return i=qg(t,i),i=Wd.fromCallback(i),Fg(this,i)||(t=$0(t),this.db.put(r,e,t,n=>{if(n)return i(new N5(n));this.emit("put",r,e),i()})),i.promise};tr.prototype.del=function(r,e,t){return t=qg(e,t),t=Wd.fromCallback(t),Fg(this,t)||(e=$0(e),this.db.del(r,e,i=>{if(i)return t(new N5(i));this.emit("del",r),t()})),t.promise};tr.prototype.batch=function(r,e,t){return arguments.length?(typeof r=="function"?t=r:t=qg(e,t),t=Wd.fromCallback(t),Fg(this,t)||(e=$0(e),this.db.batch(r,e,i=>{if(i)return t(new N5(i));this.emit("batch",r),t()})),t.promise):new ODe(this)};tr.prototype.iterator=function(r){return this.db.iterator(r)};tr.prototype.clear=function(r,e){return e=qg(r,e),r=$0(r),e=Wd.fromCallback(e),Fg(this,e)||this.db.clear(r,t=>{if(t)return e(new N5(t));this.emit("clear",r),e()}),e.promise};tr.prototype.readStream=tr.prototype.createReadStream=function(r){return r=Object.assign({keys:!0,values:!0},r),typeof r.limit!="number"&&(r.limit=-1),new CDe(this.db.iterator(r),r)};tr.prototype.keyStream=tr.prototype.createKeyStream=function(r){return this.createReadStream(Object.assign({},r,{keys:!0,values:!1}))};tr.prototype.valueStream=tr.prototype.createValueStream=function(r){return this.createReadStream(Object.assign({},r,{keys:!1,values:!0}))};tr.prototype.toString=function(){return"LevelUP"};tr.prototype.type="levelup";tr.prototype._nextTick=Ug;function Fg(r,e){return r.isOperational()?!1:(Ug(e,new see("Database is not open")),!0)}tr.errors=H0;oee.exports=tr});var cee=m(gu=>{f();"use strict";var{Buffer:wx}=ci();gu.utf8=gu["utf-8"]={encode:function(r){return _x(r)?r:String(r)},decode:B5,buffer:!1,type:"utf8"};gu.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"};gu.binary={encode:function(r){return _x(r)?r:wx.from(r)},decode:B5,buffer:!0,type:"binary"};gu.none={encode:B5,decode:B5,buffer:!1,type:"id"};gu.id=gu.none;var LDe=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];for(let r of LDe)gu[r]={encode:function(e){return _x(e)?e:wx.from(e,r)},decode:function(e){return e.toString(r)},buffer:!0,type:r};function B5(r){return r}function _x(r){return r==null||wx.isBuffer(r)}});var lee=m((G6t,uee)=>{f();"use strict";var vx=cee(),MDe=new Set(["lt","gt","lte","gte"]);uee.exports=jn;function jn(r){if(!(this instanceof jn))return new jn(r);this.opts=r||{},this.encodings=vx}jn.prototype._encoding=function(r){return typeof r=="string"&&(r=vx[r]),r||(r=vx.id),r};jn.prototype._keyEncoding=function(r,e){return this._encoding(e&&e.keyEncoding||r&&r.keyEncoding||this.opts.keyEncoding)};jn.prototype._valueEncoding=function(r,e){return this._encoding(e&&(e.valueEncoding||e.encoding)||r&&(r.valueEncoding||r.encoding)||this.opts.valueEncoding||this.opts.encoding)};jn.prototype.encodeKey=function(r,e,t){return this._keyEncoding(e,t).encode(r)};jn.prototype.encodeValue=function(r,e,t){return this._valueEncoding(e,t).encode(r)};jn.prototype.decodeKey=function(r,e){return this._keyEncoding(e).decode(r)};jn.prototype.decodeValue=function(r,e){return this._valueEncoding(e).decode(r)};jn.prototype.encodeBatch=function(r,e){return r.map(t=>{let i={type:t.type,key:this.encodeKey(t.key,e,t)};return this.keyAsBuffer(e,t)&&(i.keyEncoding="binary"),t.prefix&&(i.prefix=t.prefix),"value"in t&&(i.value=this.encodeValue(t.value,e,t),this.valueAsBuffer(e,t)&&(i.valueEncoding="binary")),i})};jn.prototype.encodeLtgt=function(r){let e={};for(let t of Object.keys(r)){if(t==="start"||t==="end")throw new Error('Legacy range options ("start" and "end") have been removed');e[t]=MDe.has(t)?this.encodeKey(r[t],r):r[t]}return e};jn.prototype.createStreamDecoder=function(r){return r.keys&&r.values?(e,t)=>({key:this.decodeKey(e,r),value:this.decodeValue(t,r)}):r.keys?e=>this.decodeKey(e,r):r.values?(e,t)=>this.decodeValue(t,r):function(){}};jn.prototype.keyAsBuffer=function(r){return this._keyEncoding(r).buffer};jn.prototype.valueAsBuffer=function(r){return this._valueEncoding(r).buffer}});var yee=m((W6t,pee)=>{f();"use strict";var fee=pu().AbstractLevelDOWN,dee=pu().AbstractChainedBatch,hee=pu().AbstractIterator,Ex=ho(),jDe=lee(),Sx=k5().EncodingError,qDe=["approximateSize","compactRange"];pee.exports=cn;function cn(r,e){if(!(this instanceof cn))return new cn(r,e);let t=r.supports||{},i=t.additionalMethods||{};fee.call(this,t),this.supports.encodings=!0,this.supports.additionalMethods={},qDe.forEach(function(n){let s=typeof r[n]=="function";(i[n]||s)&&(this.supports.additionalMethods[n]=!0,this[n]=function(o,a,c,u){return o=this.codec.encodeKey(o,c),a=this.codec.encodeKey(a,c),this.db[n](o,a,c,u)})},this),e=e||{},typeof e.keyEncoding=="undefined"&&(e.keyEncoding="utf8"),typeof e.valueEncoding=="undefined"&&(e.valueEncoding="utf8"),this.db=r,this.codec=new jDe(e)}Ex(cn,fee);cn.prototype.type="encoding-down";cn.prototype._serializeKey=cn.prototype._serializeValue=function(r){return r};cn.prototype._open=function(r,e){this.db.open(r,e)};cn.prototype._close=function(r){this.db.close(r)};cn.prototype._put=function(r,e,t,i){r=this.codec.encodeKey(r,t),e=this.codec.encodeValue(e,t),this.db.put(r,e,t,i)};cn.prototype._get=function(r,e,t){r=this.codec.encodeKey(r,e),e.asBuffer=this.codec.valueAsBuffer(e),this.db.get(r,e,(i,n)=>{if(i)return t(i);try{n=this.codec.decodeValue(n,e)}catch(s){return t(new Sx(s))}t(null,n)})};cn.prototype._getMany=function(r,e,t){r=r.map(i=>this.codec.encodeKey(i,e)),e.asBuffer=this.codec.valueAsBuffer(e),this.db.getMany(r,e,(i,n)=>{if(i)return t(i);let s=new Array(n.length);for(let o=0;o<n.length;o++){if(n[o]===void 0){s[o]=void 0;continue}try{s[o]=this.codec.decodeValue(n[o],e)}catch(a){return t(new Sx(a))}}t(null,s)})};cn.prototype._del=function(r,e,t){r=this.codec.encodeKey(r,e),this.db.del(r,e,t)};cn.prototype._chainedBatch=function(){return new G0(this)};cn.prototype._batch=function(r,e,t){r=this.codec.encodeBatch(r,e),this.db.batch(r,e,t)};cn.prototype._iterator=function(r){return r.keyAsBuffer=this.codec.keyAsBuffer(r),r.valueAsBuffer=this.codec.valueAsBuffer(r),new Kg(this,r)};cn.prototype._clear=function(r,e){r=this.codec.encodeLtgt(r),this.db.clear(r,e)};function Kg(r,e){hee.call(this,r),this.codec=r.codec,this.keys=e.keys,this.values=e.values,this.opts=this.codec.encodeLtgt(e),this.it=r.db.iterator(this.opts)}Ex(Kg,hee);Kg.prototype._next=function(r){this.it.next((e,t,i)=>{if(e)return r(e);try{this.keys&&typeof t!="undefined"?t=this.codec.decodeKey(t,this.opts):t=void 0,this.values&&typeof i!="undefined"?i=this.codec.decodeValue(i,this.opts):i=void 0}catch(n){return r(new Sx(n))}r(null,t,i)})};Kg.prototype._seek=function(r){r=this.codec.encodeKey(r,this.opts),this.it.seek(r)};Kg.prototype._end=function(r){this.it.end(r)};function G0(r,e){dee.call(this,r),this.codec=r.codec,this.batch=r.db.batch()}Ex(G0,dee);G0.prototype._put=function(r,e,t){r=this.codec.encodeKey(r,t),e=this.codec.encodeValue(e,t),this.batch.put(r,e)};G0.prototype._del=function(r,e){r=this.codec.encodeKey(r,e),this.batch.del(r)};G0.prototype._clear=function(){this.batch.clear()};G0.prototype._write=function(r,e){this.batch.write(r,e)}});var bee=m((Y6t,mee)=>{f();"use strict";var gee=aee(),UDe=yee();function FDe(r){function e(i,n,s){return typeof i=="function"?s=i:typeof n=="function"&&(s=n),t(n)||(n=t(i)?i:{}),gee(UDe(r(i,n),n),n,s)}function t(i){return typeof i=="object"&&i!==null}for(let i of["destroy","repair"])typeof r[i]=="function"&&(e[i]=function(...n){r[i](...n)});return e.errors=gee.errors,e}mee.exports=FDe});var _ee=m((X6t,wee)=>{f();wee.exports=VDe;var KDe=Ig();function VDe(r,e,t){if(typeof e!="number")throw new Error("second argument must be a Number");let i,n,s,o,a,c=!0,u;Array.isArray(r)?(i=[],s=n=r.length):(o=Object.keys(r),i={},s=n=o.length);function l(h){function p(){t&&t(h,i),t=null}c?KDe(p):p()}function d(h,p,y){if(i[h]=y,p&&(a=!0),--s==0||p)l(p);else if(!a&&u<n){let g;o?(g=o[u],u+=1,r[g](function(w,b){d(g,w,b)})):(g=u,u+=1,r[g](function(w,b){d(g,w,b)}))}}u=e,s?o?o.some(function(h,p){return r[h](function(y,g){d(h,y,g)}),p===e-1}):r.some(function(h,p){return h(function(y,g){d(p,y,g)}),p===e-1}):l(null),c=!1}});var Eee=m(gi=>{f();gi.compare=function(r,e){if(Buffer.isBuffer(r)){for(var t=Math.min(r.length,e.length),i=0;i<t;i++){var n=r[i]-e[i];if(n)return n}return r.length-e.length}return r<e?-1:r>e?1:0};function vee(r){return r!==void 0&&r!==""}function W0(r,e){return Object.hasOwnProperty.call(r,e)}function hc(r,e){return Object.hasOwnProperty.call(r,e)&&e}var zDe=gi.lowerBoundKey=function(r){return hc(r,"gt")||hc(r,"gte")||hc(r,"min")||(r.reverse?hc(r,"end"):hc(r,"start"))||void 0},Rx=gi.lowerBound=function(r,e){var t=zDe(r);return t?r[t]:e},Ax=gi.lowerBoundInclusive=function(r){return!W0(r,"gt")},xx=gi.upperBoundInclusive=function(r){return!W0(r,"lt")},HDe=gi.lowerBoundExclusive=function(r){return!Ax(r)},$De=gi.upperBoundExclusive=function(r){return!xx(r)},GDe=gi.upperBoundKey=function(r){return hc(r,"lt")||hc(r,"lte")||hc(r,"max")||(r.reverse?hc(r,"start"):hc(r,"end"))||void 0},Ix=gi.upperBound=function(r,e){var t=GDe(r);return t?r[t]:e};gi.start=function(r,e){return r.reverse?Ix(r,e):Rx(r,e)};gi.end=function(r,e){return r.reverse?Rx(r,e):Ix(r,e)};gi.startInclusive=function(r){return r.reverse?xx(r):Ax(r)};gi.endInclusive=function(r){return r.reverse?Ax(r):xx(r)};function WDe(r){return r}gi.toLtgt=function(r,e,t,i,n){e=e||{},t=t||WDe;var s=arguments.length>3,o=gi.lowerBoundKey(r),a=gi.upperBoundKey(r);return o?o==="gt"?e.gt=t(r.gt,!1):e.gte=t(r[o],!1):s&&(e.gte=t(i,!1)),a?a==="lt"?e.lt=t(r.lt,!0):e.lte=t(r[a],!0):s&&(e.lte=t(n,!0)),r.reverse!=null&&(e.reverse=!!r.reverse),W0(e,"max")&&delete e.max,W0(e,"min")&&delete e.min,W0(e,"start")&&delete e.start,W0(e,"end")&&delete e.end,e};gi.contains=function(r,e,t){t=t||gi.compare;var i=Rx(r);if(vee(i)){var n=t(e,i);if(n<0||n===0&&HDe(r))return!1}var s=Ix(r);if(vee(s)){var n=t(e,s);if(n>0||n===0&&$De(r))return!1}return!0};gi.filter=function(r,e){return function(t){return gi.contains(r,t,e)}}});var Tx=m((Z6t,See)=>{f();"use strict";var L5=Eee(),Xl=Symbol("none");See.exports=function(e){let t=L5.lowerBound(e,Xl),i=L5.upperBound(e,Xl),n=L5.lowerBoundExclusive(e,Xl),s=L5.upperBoundExclusive(e,Xl);return t!==Xl&&i!==Xl?IDBKeyRange.bound(t,i,n,s):t!==Xl?IDBKeyRange.lowerBound(t,n):i!==Xl?IDBKeyRange.upperBound(i,s):null}});var Px=m((J6t,Aee)=>{f();"use strict";var M5=ci().Buffer,YDe=function(){if(globalThis.TextDecoder){let r=new TextDecoder("utf-8");return r.decode.bind(r)}else return function(e){return Ree(e).toString()}}(),XDe=function(){if(globalThis.TextDecoder){let r=new TextDecoder("utf-8");return r.decode.bind(r)}else return function(e){return M5.from(e).toString()}}();function Ree(r){let e=M5.from(r.buffer);return r.byteLength===r.buffer.byteLength?e:e.slice(r.byteOffset,r.byteOffset+r.byteLength)}Aee.exports=function(r,e){return r instanceof Uint8Array?e?Ree(r):YDe(r):r instanceof ArrayBuffer?e?M5.from(r):XDe(r):e?M5.from(String(r)):String(r)}});var Pee=m((ebt,Tee)=>{f();"use strict";var QDe=ho(),xee=pu().AbstractIterator,ZDe=Tx(),Iee=Px(),JDe=function(){};Tee.exports=ca;function ca(r,e,t){if(xee.call(this,r),this._limit=t.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keys=t.keys,this._values=t.values,this._keyAsBuffer=t.keyAsBuffer,this._valueAsBuffer=t.valueAsBuffer,this._limit===0){this._completed=!0;return}let i;try{i=ZDe(t)}catch(n){this._completed=!0;return}this.createIterator(e,i,t.reverse)}QDe(ca,xee);ca.prototype.createIterator=function(r,e,t){let i=this.db.db.transaction([r],"readonly"),s=i.objectStore(r).openCursor(e,t?"prev":"next");s.onsuccess=o=>{let a=o.target.result;a&&this.onItem(a)},this._transaction=i,i.onabort=()=>{this.onAbort(this._transaction.error||new Error("aborted by user"))},i.oncomplete=()=>{this.onComplete()}};ca.prototype.onItem=function(r){this._cache.push(r.key,r.value),(this._limit<=0||++this._count<this._limit)&&r.continue(),this.maybeNext()};ca.prototype.onAbort=function(r){this._aborted=!0,this._error=r,this.maybeNext()};ca.prototype.onComplete=function(){this._completed=!0,this.maybeNext()};ca.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)};ca.prototype._next=function(r){if(this._aborted){let e=this._error;this._error=null,this._nextTick(r,e)}else if(this._cache.length>0){let e=this._cache.shift(),t=this._cache.shift();this._keys&&e!==void 0?e=this._deserializeKey(e,this._keyAsBuffer):e=void 0,this._values&&t!==void 0?t=this._deserializeValue(t,this._valueAsBuffer):t=void 0,this._nextTick(r,null,e,t)}else this._completed?this._nextTick(r):this._callback=r};ca.prototype._deserializeKey=Iee;ca.prototype._deserializeValue=Iee;ca.prototype._end=function(r){if(this._aborted||this._completed)return this._nextTick(r,this._error);this.onItem=JDe,this.onAbort=r,this.onComplete=r}});var kee=m((tbt,Oee)=>{f();"use strict";var Cee=ci().Buffer,eNe=function(){if(globalThis.TextEncoder){let r=new TextEncoder("utf-8");return r.encode.bind(r)}else return Cee.from}();Oee.exports=function(r,e){return e?Cee.isBuffer(r)?r:eNe(String(r)):String(r)}});var Dee=m(j5=>{f();"use strict";var tNe=ci().Buffer;j5.test=function(r){return function(t){try{return t.cmp(r,0),!0}catch(i){return!1}}};j5.bufferKeys=j5.test(tNe.alloc(0))});var Bee=m((ibt,Nee)=>{f();"use strict";Nee.exports=function(e,t,i,n,s){if(n.limit===0)return e._nextTick(s);let o=e.db.transaction([t],"readwrite"),a=o.objectStore(t),c=0;o.oncomplete=function(){s()},o.onabort=function(){s(o.error||new Error("aborted by user"))};let u=a.openKeyCursor?"openKeyCursor":"openCursor",l=n.reverse?"prev":"next";a[u](i,l).onsuccess=function(d){let h=d.target.result;h&&(a.delete(h.key).onsuccess=function(){(n.limit<=0||++c<n.limit)&&h.continue()})}}});var Uee=m((nbt,qee)=>{f();"use strict";qee.exports=xi;var Lee=pu().AbstractLevelDOWN,rNe=ho(),iNe=_ee(),nNe=Pee(),Mee=kee(),q5=Px(),sNe=Dee(),oNe=Bee(),aNe=Tx(),jee="level-js-";function xi(r,e){if(!(this instanceof xi))return new xi(r,e);if(Lee.call(this,{bufferKeys:sNe.bufferKeys(indexedDB),snapshots:!0,permanence:!0,clear:!0,getMany:!0}),e=e||{},typeof r!="string")throw new Error("constructor requires a location string argument");this.location=r,this.prefix=e.prefix==null?jee:e.prefix,this.version=parseInt(e.version||1,10)}rNe(xi,Lee);xi.prototype.type="level-js";xi.prototype._open=function(r,e){let t=indexedDB.open(this.prefix+this.location,this.version);t.onerror=function(){e(t.error||new Error("unknown error"))},t.onsuccess=()=>{this.db=t.result,e()},t.onupgradeneeded=i=>{let n=i.target.result;n.objectStoreNames.contains(this.location)||n.createObjectStore(this.location)}};xi.prototype.store=function(r){return this.db.transaction([this.location],r).objectStore(this.location)};xi.prototype.await=function(r,e){let t=r.transaction;t.onabort=function(){e(t.error||new Error("aborted by user"))},t.oncomplete=function(){e(null,r.result)}};xi.prototype._get=function(r,e,t){let i=this.store("readonly"),n;try{n=i.get(r)}catch(s){return this._nextTick(t,s)}this.await(n,function(s,o){if(s)return t(s);if(o===void 0)return t(new Error("NotFound"));t(null,q5(o,e.asBuffer))})};xi.prototype._getMany=function(r,e,t){let i=e.asBuffer,n=this.store("readonly"),s=r.map(o=>a=>{let c;try{c=n.get(o)}catch(u){return a(u)}c.onsuccess=()=>{let u=c.result;a(null,u===void 0?u:q5(u,i))},c.onerror=u=>{u.stopPropagation(),a(c.error)}});iNe(s,16,t)};xi.prototype._del=function(r,e,t){let i=this.store("readwrite"),n;try{n=i.delete(r)}catch(s){return this._nextTick(t,s)}this.await(n,t)};xi.prototype._put=function(r,e,t,i){let n=this.store("readwrite"),s;try{s=n.put(e,r)}catch(o){return this._nextTick(i,o)}this.await(s,i)};xi.prototype._serializeKey=function(r){return Mee(r,this.supports.bufferKeys)};xi.prototype._serializeValue=function(r){return Mee(r,!0)};xi.prototype._iterator=function(r){return new nNe(this,this.location,r)};xi.prototype._batch=function(r,e,t){if(r.length===0)return this._nextTick(t);let i=this.store("readwrite"),n=i.transaction,s=0,o;n.onabort=function(){t(o||n.error||new Error("aborted by user"))},n.oncomplete=function(){t()};function a(){let c=r[s++],u=c.key,l;try{l=c.type==="del"?i.delete(u):i.put(c.value,u)}catch(d){o=d,n.abort();return}s<r.length&&(l.onsuccess=a)}a()};xi.prototype._clear=function(r,e){let t,i;try{t=aNe(r)}catch(n){return this._nextTick(e)}if(r.limit>=0)return oNe(this,this.location,t,r,e);try{let n=this.store("readwrite");i=t?n.delete(t):n.clear()}catch(n){return this._nextTick(e,n)}this.await(i,e)};xi.prototype._close=function(r){this.db.close(),this._nextTick(r)};xi.prototype.upgrade=function(r){if(this.status!=="open")return this._nextTick(r,new Error("cannot upgrade() before open()"));let e=this.iterator(),t={},i=this;e._deserializeKey=e._deserializeValue=a,n();function n(c){if(c)return o(c);e.next(s)}function s(c,u,l){if(c||u===void 0)return o(c);let d=i._serializeKey(q5(u,!0)),h=i._serializeValue(q5(l,!0));i._batch([{type:"del",key:u},{type:"put",key:d,value:h}],t,n)}function o(c){e.end(function(u){r(c||u)})}function a(c){return c}};xi.destroy=function(r,e,t){typeof e=="function"&&(t=e,e=jee);let i=indexedDB.deleteDatabase(e+r);i.onsuccess=function(){t()},i.onerror=function(n){t(n)}}});var Kee=m((sbt,Fee)=>{f();Fee.exports=bee()(Uee())});var Gee=m((ubt,$ee)=>{f();"use strict";function Hee(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function uNe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Hee(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Hee(new n,t)}}$ee.exports=uNe});var jx=m((Rbt,Jee)=>{f();"use strict";function Zee(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function dNe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Zee(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Zee(new n,t)}}Jee.exports=dNe});var qx=m((Abt,ite)=>{f();"use strict";var ete=()=>{},tte=Symbol.for("@libp2p/js-interfaces/topology"),rte=class{constructor({min:e=0,max:t=1/0,handlers:i={}}){this.min=e,this.max=t,this._onConnect=i.onConnect||ete,this._onDisconnect=i.onDisconnect||ete,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[tte](){return!0}static isTopology(e){return Boolean(e&&e[tte])}async setRegistrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};ite.exports=rte});var U5=m((xbt,cte)=>{f();"use strict";var hNe=qx(),nte=Symbol.for("@libp2p/js-interfaces/topology/multicodec-topology"),ste=le(),ote=Object.assign(ste("libp2p:topology:multicodec-topology"),{error:ste("libp2p:topology:multicodec-topology:error")}),ate=class extends hNe{constructor({min:e,max:t,multicodecs:i,handlers:n}){super({min:e,max:t,handlers:n});if(!i)throw new Error("one or more multicodec should be provided");if(!n)throw new Error("the handlers should be provided");if(typeof n.onConnect!="function")throw new Error("the 'onConnect' handler must be provided");if(typeof n.onDisconnect!="function")throw new Error("the 'onDisconnect' handler must be provided");this.multicodecs=Array.isArray(i)?i:[i],this._registrar=void 0,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerConnect=this._onPeerConnect.bind(this)}get[Symbol.toStringTag](){return"Topology"}get[nte](){return!0}static isMulticodecTopology(e){return Boolean(e&&e[nte])}async setRegistrar(e){this._registrar=e,this._registrar.peerStore.on("change:protocols",this._onProtocolChange),this._registrar.connectionManager.on("peer:connect",this._onPeerConnect),await this._updatePeers(this._registrar.peerStore.getPeers())}async _updatePeers(e){for await(let{id:t,protocols:i}of e)if(this.multicodecs.filter(n=>i.includes(n)).length){this.peers.add(t.toB58String());let n=this._registrar.getConnection(t);n&&this._onConnect(t,n)}else this.peers.delete(t.toB58String())}async _onProtocolChange({peerId:e,protocols:t}){try{let i=this.peers.has(e.toB58String()),n=t.filter(s=>this.multicodecs.includes(s));i&&n.length===0&&this._onDisconnect(e);for(let s of t)if(this.multicodecs.includes(s)){let o=await this._registrar.peerStore.get(e);await this._updatePeers([o]);return}}catch(i){ote.error(i)}}async _onPeerConnect(e){try{let t=e.remotePeer,i=await this._registrar.peerStore.protoBook.get(t);if(!i)return;this.multicodecs.find(n=>i.includes(n))&&(this.peers.add(t.toB58String()),this._onConnect(t,e))}catch(t){ote.error(t)}}};cte.exports=ate});var F5=m(ute=>{f();"use strict";ute.codes={ERR_INVALID_SIGNATURE_POLICY:"ERR_INVALID_SIGNATURE_POLICY",ERR_UNHANDLED_SIGNATURE_POLICY:"ERR_UNHANDLED_SIGNATURE_POLICY",ERR_MISSING_SIGNATURE:"ERR_MISSING_SIGNATURE",ERR_MISSING_SEQNO:"ERR_MISSING_SEQNO",ERR_INVALID_SIGNATURE:"ERR_INVALID_SIGNATURE",ERR_UNEXPECTED_FROM:"ERR_UNEXPECTED_FROM",ERR_UNEXPECTED_SIGNATURE:"ERR_UNEXPECTED_SIGNATURE",ERR_UNEXPECTED_KEY:"ERR_UNEXPECTED_KEY",ERR_UNEXPECTED_SEQNO:"ERR_UNEXPECTED_SEQNO"}});var Fx=m((Tbt,lte)=>{f();"use strict";var Zl=Br(),X0=Zl.Reader,Ux=Zl.Writer,It=Zl.util,ji=Zl.roots["libp2p-pubsub-rpc"]||(Zl.roots["libp2p-pubsub-rpc"]={});ji.RPC=function(){function r(e){if(this.subscriptions=[],this.msgs=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.subscriptions=It.emptyArray,r.prototype.msgs=It.emptyArray,r.encode=function(t,i){if(i||(i=Ux.create()),t.subscriptions!=null&&t.subscriptions.length)for(var n=0;n<t.subscriptions.length;++n)ji.RPC.SubOpts.encode(t.subscriptions[n],i.uint32(10).fork()).ldelim();if(t.msgs!=null&&t.msgs.length)for(var n=0;n<t.msgs.length;++n)ji.RPC.Message.encode(t.msgs[n],i.uint32(18).fork()).ldelim();return i},r.decode=function(t,i){t instanceof X0||(t=X0.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new ji.RPC;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.subscriptions&&s.subscriptions.length||(s.subscriptions=[]),s.subscriptions.push(ji.RPC.SubOpts.decode(t,t.uint32()));break;case 2:s.msgs&&s.msgs.length||(s.msgs=[]),s.msgs.push(ji.RPC.Message.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof ji.RPC)return t;var i=new ji.RPC;if(t.subscriptions){if(!Array.isArray(t.subscriptions))throw TypeError(".RPC.subscriptions: array expected");i.subscriptions=[];for(var n=0;n<t.subscriptions.length;++n){if(typeof t.subscriptions[n]!="object")throw TypeError(".RPC.subscriptions: object expected");i.subscriptions[n]=ji.RPC.SubOpts.fromObject(t.subscriptions[n])}}if(t.msgs){if(!Array.isArray(t.msgs))throw TypeError(".RPC.msgs: array expected");i.msgs=[];for(var n=0;n<t.msgs.length;++n){if(typeof t.msgs[n]!="object")throw TypeError(".RPC.msgs: object expected");i.msgs[n]=ji.RPC.Message.fromObject(t.msgs[n])}}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.subscriptions=[],n.msgs=[]),t.subscriptions&&t.subscriptions.length){n.subscriptions=[];for(var s=0;s<t.subscriptions.length;++s)n.subscriptions[s]=ji.RPC.SubOpts.toObject(t.subscriptions[s],i)}if(t.msgs&&t.msgs.length){n.msgs=[];for(var s=0;s<t.msgs.length;++s)n.msgs[s]=ji.RPC.Message.toObject(t.msgs[s],i)}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Zl.util.toJSONOptions)},r.SubOpts=function(){function e(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.subscribe=null,e.prototype.topicID=null;var t;return Object.defineProperty(e.prototype,"_subscribe",{get:It.oneOfGetter(t=["subscribe"]),set:It.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_topicID",{get:It.oneOfGetter(t=["topicID"]),set:It.oneOfSetter(t)}),e.encode=function(n,s){return s||(s=Ux.create()),n.subscribe!=null&&Object.hasOwnProperty.call(n,"subscribe")&&s.uint32(8).bool(n.subscribe),n.topicID!=null&&Object.hasOwnProperty.call(n,"topicID")&&s.uint32(18).string(n.topicID),s},e.decode=function(n,s){n instanceof X0||(n=X0.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new ji.RPC.SubOpts;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.subscribe=n.bool();break;case 2:a.topicID=n.string();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof ji.RPC.SubOpts)return n;var s=new ji.RPC.SubOpts;return n.subscribe!=null&&(s.subscribe=Boolean(n.subscribe)),n.topicID!=null&&(s.topicID=String(n.topicID)),s},e.toObject=function(n,s){s||(s={});var o={};return n.subscribe!=null&&n.hasOwnProperty("subscribe")&&(o.subscribe=n.subscribe,s.oneofs&&(o._subscribe="subscribe")),n.topicID!=null&&n.hasOwnProperty("topicID")&&(o.topicID=n.topicID,s.oneofs&&(o._topicID="topicID")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,Zl.util.toJSONOptions)},e}(),r.Message=function(){function e(i){if(this.topicIDs=[],i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.from=null,e.prototype.data=null,e.prototype.seqno=null,e.prototype.topicIDs=It.emptyArray,e.prototype.signature=null,e.prototype.key=null;var t;return Object.defineProperty(e.prototype,"_from",{get:It.oneOfGetter(t=["from"]),set:It.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_data",{get:It.oneOfGetter(t=["data"]),set:It.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_seqno",{get:It.oneOfGetter(t=["seqno"]),set:It.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_signature",{get:It.oneOfGetter(t=["signature"]),set:It.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_key",{get:It.oneOfGetter(t=["key"]),set:It.oneOfSetter(t)}),e.encode=function(n,s){if(s||(s=Ux.create()),n.from!=null&&Object.hasOwnProperty.call(n,"from")&&s.uint32(10).bytes(n.from),n.data!=null&&Object.hasOwnProperty.call(n,"data")&&s.uint32(18).bytes(n.data),n.seqno!=null&&Object.hasOwnProperty.call(n,"seqno")&&s.uint32(26).bytes(n.seqno),n.topicIDs!=null&&n.topicIDs.length)for(var o=0;o<n.topicIDs.length;++o)s.uint32(34).string(n.topicIDs[o]);return n.signature!=null&&Object.hasOwnProperty.call(n,"signature")&&s.uint32(42).bytes(n.signature),n.key!=null&&Object.hasOwnProperty.call(n,"key")&&s.uint32(50).bytes(n.key),s},e.decode=function(n,s){n instanceof X0||(n=X0.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new ji.RPC.Message;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.from=n.bytes();break;case 2:a.data=n.bytes();break;case 3:a.seqno=n.bytes();break;case 4:a.topicIDs&&a.topicIDs.length||(a.topicIDs=[]),a.topicIDs.push(n.string());break;case 5:a.signature=n.bytes();break;case 6:a.key=n.bytes();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof ji.RPC.Message)return n;var s=new ji.RPC.Message;if(n.from!=null&&(typeof n.from=="string"?It.base64.decode(n.from,s.from=It.newBuffer(It.base64.length(n.from)),0):n.from.length&&(s.from=n.from)),n.data!=null&&(typeof n.data=="string"?It.base64.decode(n.data,s.data=It.newBuffer(It.base64.length(n.data)),0):n.data.length&&(s.data=n.data)),n.seqno!=null&&(typeof n.seqno=="string"?It.base64.decode(n.seqno,s.seqno=It.newBuffer(It.base64.length(n.seqno)),0):n.seqno.length&&(s.seqno=n.seqno)),n.topicIDs){if(!Array.isArray(n.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");s.topicIDs=[];for(var o=0;o<n.topicIDs.length;++o)s.topicIDs[o]=String(n.topicIDs[o])}return n.signature!=null&&(typeof n.signature=="string"?It.base64.decode(n.signature,s.signature=It.newBuffer(It.base64.length(n.signature)),0):n.signature.length&&(s.signature=n.signature)),n.key!=null&&(typeof n.key=="string"?It.base64.decode(n.key,s.key=It.newBuffer(It.base64.length(n.key)),0):n.key.length&&(s.key=n.key)),s},e.toObject=function(n,s){s||(s={});var o={};if((s.arrays||s.defaults)&&(o.topicIDs=[]),n.from!=null&&n.hasOwnProperty("from")&&(o.from=s.bytes===String?It.base64.encode(n.from,0,n.from.length):s.bytes===Array?Array.prototype.slice.call(n.from):n.from,s.oneofs&&(o._from="from")),n.data!=null&&n.hasOwnProperty("data")&&(o.data=s.bytes===String?It.base64.encode(n.data,0,n.data.length):s.bytes===Array?Array.prototype.slice.call(n.data):n.data,s.oneofs&&(o._data="data")),n.seqno!=null&&n.hasOwnProperty("seqno")&&(o.seqno=s.bytes===String?It.base64.encode(n.seqno,0,n.seqno.length):s.bytes===Array?Array.prototype.slice.call(n.seqno):n.seqno,s.oneofs&&(o._seqno="seqno")),n.topicIDs&&n.topicIDs.length){o.topicIDs=[];for(var a=0;a<n.topicIDs.length;++a)o.topicIDs[a]=n.topicIDs[a]}return n.signature!=null&&n.hasOwnProperty("signature")&&(o.signature=s.bytes===String?It.base64.encode(n.signature,0,n.signature.length):s.bytes===Array?Array.prototype.slice.call(n.signature):n.signature,s.oneofs&&(o._signature="signature")),n.key!=null&&n.hasOwnProperty("key")&&(o.key=s.bytes===String?It.base64.encode(n.key,0,n.key.length):s.bytes===Array?Array.prototype.slice.call(n.key):n.key,s.oneofs&&(o._key="key")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,Zl.util.toJSONOptions)},e}(),r}();lte.exports=ji});var Kx=m((Pbt,hte)=>{f();"use strict";var fte=Wn(),{Buffer:pNe}=ci(),dte=(r,e,t)=>{let i=fte.encode(r,e,t);return dte.bytes=fte.encode.bytes,e||pNe.from(i)};hte.exports=dte});var wte=m((Cbt,K5)=>{f();"use strict";var{Buffer:pte}=ci(),yte=sn(),gte=Kx(),Vx=8,mte=10*1024;function bte(r){r=r||{};let e=Math.max(r.poolSize||mte,r.minPoolSize||Vx),t=r.lengthEncoder||gte;return async function*(n){let s=pte.alloc(e),o=0;for await(let a of n){t(a.length,s,o);let c=s.slice(o,o+t.bytes);o+=t.bytes,s.length-o<Vx&&(s=pte.alloc(e),o=0),yield new yte().append(c).append(a)}}}bte.single=(r,e)=>{e=e||{};let t=e.lengthEncoder||gte;return new yte([t(r.length),r.slice()])};K5.exports=bte;K5.exports.MIN_POOL_SIZE=Vx;K5.exports.DEFAULT_POOL_SIZE=mte});var zx=m((Obt,Ete)=>{f();"use strict";var _te=Wn(),{Buffer:yNe}=ci(),gNe=r=>new Proxy({},{get:(e,t)=>t[0]==="l"?r[t]:r.get(parseInt(t))}),vte=r=>{let e=_te.decode(yNe.isBuffer(r)?r:gNe(r));return vte.bytes=_te.decode.bytes,e};Ete.exports=vte});var xte=m((kbt,V5)=>{f();"use strict";var{Buffer:mNe}=ci(),Hx=sn(),bNe=zx(),Ste=8,Rte=1024*1024*4,Ate=mNe.alloc(0),Jl={LENGTH:"readLength",DATA:"readData"},wNe={[Jl.LENGTH]:(r,e,t,i)=>{e=e.append(r);let n;try{n=i.lengthDecoder(e)}catch(s){if(e.length>i.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:Jl.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw s}if(n>i.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return r=e.shallowSlice(i.lengthDecoder.bytes),e=new Hx,i.onLength&&i.onLength(n),n<=0?(i.onData&&i.onData(Ate),{mode:Jl.LENGTH,chunk:r,buffer:e,data:Ate}):{mode:Jl.DATA,chunk:r,buffer:e,state:{dataLength:n},data:void 0}},[Jl.DATA]:(r,e,t,i)=>{if(e=e.append(r),!t)throw new Error("state is required");if(e.length<t.dataLength)return{mode:Jl.DATA,buffer:e,state:t,chunk:void 0,data:void 0};let{dataLength:n}=t,s=e.shallowSlice(0,n),o=e.length>n?e.shallowSlice(n):void 0;return e=new Hx,i.onData&&i.onData(s),{mode:Jl.LENGTH,chunk:o,buffer:e,state:void 0,data:s}}};function $x(r){r=r||{};let e={lengthDecoder:r.lengthDecoder||bNe,maxLengthLength:r.maxLengthLength||Ste,maxDataLength:r.maxDataLength||Rte,onLength:r.onLength,onData:r.onData};return async function*(i){let n=new Hx,s=Jl.LENGTH,o;for await(let a of i){let c=a;for(;c;){let u=wNe[s](c,n,o,e);s=u.mode,c=u.chunk,n=u.buffer,o=u.state,u.data&&(yield u.data)}}if(n.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}$x.fromReader=(r,e)=>{let t=1,i={[Symbol.asyncIterator](){return this},next:async()=>{try{return await r.next(t)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{t=1}}};return $x({...e||{},onLength:s=>{t=s}})(i)};V5.exports=$x;V5.exports.MAX_LENGTH_LENGTH=Ste;V5.exports.MAX_DATA_LENGTH=Rte});var Pte=m((Dbt,Tte)=>{f();"use strict";var{Buffer:_Ne}=ci(),Ite=(r,e,t)=>(e=e||_Ne.allocUnsafe(4),e.writeInt32BE(r,t),e);Ite.bytes=4;Tte.exports=Ite});var kte=m((Nbt,Ote)=>{f();"use strict";var Cte=r=>{if(r.length<4)throw RangeError("Could not decode int32BE");return r.readInt32BE(0)};Cte.bytes=4;Ote.exports=Cte});var go=m(Qd=>{f();"use strict";Qd.encode=wte();Qd.decode=xte();Qd.varintEncode=Kx();Qd.varintDecode=zx();Qd.int32BEEncode=Pte();Qd.int32BEDecode=kte()});var z5=m((Lbt,Dte)=>{f();Dte.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var Bte=m((jbt,Nte)=>{f();Nte.exports=class extends Error{constructor(e,t){super(e||"The operation was aborted");this.type="aborted",this.code=t||"ABORT_ERR"}}});var ua=m((qbt,Zd)=>{f();var vNe=z5(),Gx=Bte(),Lte=(r,e,t)=>Wx(r,Array.isArray(e)?e:[{signal:e,options:t}]),Wx=(r,e)=>{r=vNe(r),e=e.map(({signal:i,options:n})=>({signal:i,options:n||{}}));async function*t(){let i,n=()=>{i&&i()};for(let{signal:s}of e)s.addEventListener("abort",n);for(;;){let s;try{for(let{signal:a,options:c}of e)if(a.aborted){let{abortMessage:u,abortCode:l}=c;throw new Gx(u,l)}let o=new Promise((a,c)=>{i=()=>{let{options:u}=e.find(({signal:h})=>h.aborted),{abortMessage:l,abortCode:d}=u;c(new Gx(l,d))}});s=await Promise.race([o,r.next()]),i=null}catch(o){for(let{signal:u}of e)u.removeEventListener("abort",n);let a=e.find(({signal:u})=>u.aborted),c=o.type==="aborted"&&a;if(c&&a.options.onAbort&&await a.options.onAbort(r),typeof r.return=="function")try{let u=r.return();u instanceof Promise&&u.catch(l=>{a.options.onReturnError!=null&&a.options.onReturnError(l)})}catch(u){a.options.onReturnError!=null&&a.options.onReturnError(u)}if(c&&a.options.returnOnAbort)return;throw o}if(s.done)break;yield s.value}for(let{signal:s}of e)s.removeEventListener("abort",n)}return t()},Mte=(r,e,t)=>jte(r,Array.isArray(e)?e:[{signal:e,options:t}]),jte=(r,e)=>t=>r(Wx(t,e)),ENe=(r,e,t)=>SNe(r,Array.isArray(e)?e:[{signal:e,options:t}]),SNe=(r,e)=>({sink:jte(r.sink,e),source:Wx(r.source,e)});Zd.exports=Lte;Zd.exports.AbortError=Gx;Zd.exports.source=Lte;Zd.exports.sink=Mte;Zd.exports.transform=Mte;Zd.exports.duplex=ENe});var zte=m((Ubt,Vte)=>{f();"use strict";var qte=le(),RNe=Object.assign(qte("libp2p-pubsub:peer-streams"),{error:qte("libp2p-pubsub:peer-streams:err")}),{EventEmitter:ANe}=Ut(),Ute=go(),xNe=Xa(),{pipe:Fte}=dr(),{source:INe}=ua(),Kte=class extends ANe{constructor({id:e,protocol:t}){super();this.id=e,this.protocol=t,this._rawOutboundStream=null,this._rawInboundStream=null,this._inboundAbortController=new AbortController,this.outboundStream=null,this.inboundStream=null}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(e){if(!this.outboundStream){let t=this.id.toB58String();throw new Error("No writable connection to "+t)}this.outboundStream.push(e)}attachInboundStream(e){return this._rawInboundStream=e,this.inboundStream=INe(Fte(this._rawInboundStream,Ute.decode()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.emit("stream:inbound"),this.inboundStream}async attachOutboundStream(e){let t=this.outboundStream;this.outboundStream&&await this.outboundStream.end(),this._rawOutboundStream=e,this.outboundStream=xNe({onEnd:i=>{this._rawOutboundStream&&this._rawOutboundStream.reset&&this._rawOutboundStream.reset(),this._rawOutboundStream=null,this.outboundStream=null,i&&this.emit("close")}}),Fte(this.outboundStream,Ute.encode(),this._rawOutboundStream).catch(i=>{RNe.error(i)}),t||this.emit("stream:outbound")}close(){this.outboundStream&&this.outboundStream.end(),this.inboundStream&&this._inboundAbortController.abort(),this._rawOutboundStream=null,this.outboundStream=null,this._rawInboundStream=null,this.inboundStream=null,this.emit("close")}};Vte.exports=Kte});var $te=m(Hte=>{f();"use strict";var TNe={StrictSign:"StrictSign",StrictNoSign:"StrictNoSign"};Hte.SignaturePolicy=TNe});var Yx=m((Kbt,Yte)=>{f();"use strict";var PNe=Xy(),{toString:CNe}=(tt(),sr),{fromString:Gte}=(ct(),Qr),Wte=ot(),{sha256:ONe}=(vi(),Ks),kNe=()=>PNe(8),DNe=(r,e)=>{let t;r instanceof Uint8Array?t=Wte.createFromBytes(r).id:t=Wte.parse(r).id;let i=new Uint8Array(t.length+e.length);return i.set(t,0),i.set(e,t.length),i},NNe=r=>ONe.encode(r),BNe=(r,e)=>{let t;Array.isArray(e)?t=i=>e.indexOf(i)>-1:t=i=>e.has(i);for(let i of r)if(t(i))return!0;return!1},LNe=r=>Array.isArray(r)?r:[r],MNe=(r,e)=>{let t=Object.assign({},r);return r.from instanceof Uint8Array&&(t.from=CNe(r.from,"base58btc")),e&&(t.receivedFrom=e),t},jNe=r=>{let e=Object.assign({},r);return typeof r.from=="string"&&(e.from=Gte(r.from,"base58btc")),typeof r.data=="string"&&(e.data=Gte(r.data)),e};Yte.exports={randomSeqno:kNe,msgId:DNe,noSignMsgId:NNe,anyMatch:BNe,ensureArray:LNe,normalizeInRpcMessage:MNe,normalizeOutRpcMessage:jNe}});var ere=m((Vbt,Jte)=>{f();"use strict";var Xx=ot(),{RPC:Xte}=Fx(),{concat:Qte}=(Si(),Pn),{fromString:qNe}=(ct(),Qr),Qx=qNe("libp2p-pubsub:"),{normalizeOutRpcMessage:UNe}=Yx();async function FNe(r,e){let t=Qte([Qx,Xte.Message.encode(UNe(e)).finish()]),i=await r.privKey.sign(t);return{...e,signature:i,key:r.pubKey.bytes}}async function KNe(r){if(!r.signature)throw new Error("Message must contain a signature to be verified");if(!r.from)throw new Error("Message must contain a from property to be verified");let e=Qte([Qx,Xte.Message.encode({...r,from:Xx.createFromB58String(r.from).toBytes(),signature:void 0,key:void 0}).finish()]);return(await Zte(r)).verify(e,r.signature)}async function Zte(r){if(!r.from)throw new Error("Could not get the public key from the originator id");let e=Xx.createFromB58String(r.from);if(r.key){let t=await Xx.createFromPubKey(r.key);if(t.equals(e))return t.pubKey;throw new Error("Public Key does not match the originator")}else{if(e.pubKey)return e.pubKey;throw new Error("Could not get the public key from the originator id")}}Jte.exports={messagePublicKey:Zte,signMessage:FNe,SignPrefix:Qx,verifySignature:KNe}});var nre=m((zbt,ire)=>{f();"use strict";var tre=le(),{EventEmitter:VNe}=Ut(),os=jx(),{pipe:zNe}=dr(),{default:HNe}=$o(),$Ne=U5(),{codes:la}=F5(),{RPC:rre}=Fx(),GNe=zte(),{SignaturePolicy:bu}=$te(),ef=Yx(),{signMessage:WNe,verifySignature:YNe}=ere(),H5=class extends VNe{constructor({debugName:e,multicodecs:t,libp2p:i,globalSignaturePolicy:n=bu.StrictSign,canRelayMessage:s=!1,emitSelf:o=!1,messageProcessingConcurrency:a=10}){if(typeof e!="string")throw new Error("a debugname `string` is required");if(!t)throw new Error("multicodecs are required");if(!i)throw new Error("libp2p is required");super();if(this.log=Object.assign(tre(e),{err:tre(`${e}:error`)}),this.multicodecs=ef.ensureArray(t),this._libp2p=i,this.registrar=i.registrar,this.peerId=i.peerId,this.started=!1,this.topics=new Map,this.subscriptions=new Set,this.peers=new Map,!bu[n])throw os(new Error("Invalid global signature policy"),la.ERR_INVALID_SIGNATURE_POLICY);this.globalSignaturePolicy=n,this.canRelayMessage=s,this.emitSelf=o,this.topicValidators=new Map,this.queue=new HNe({concurrency:a}),this._registrarId=void 0,this._onIncomingStream=this._onIncomingStream.bind(this),this._onPeerConnected=this._onPeerConnected.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this)}async start(){if(this.started)return;this.log("starting"),this.registrar.handle(this.multicodecs,this._onIncomingStream);let e=new $Ne({multicodecs:this.multicodecs,handlers:{onConnect:this._onPeerConnected,onDisconnect:this._onPeerDisconnected}});this._registrarId=await this.registrar.register(e),this.log("started"),this.started=!0}async stop(){!this.started||(this.registrar.unregister(this._registrarId),this.log("stopping"),this.peers.forEach(e=>e.close()),this.peers=new Map,this.subscriptions=new Set,this.started=!1,this.log("stopped"))}_onIncomingStream({protocol:e,stream:t,connection:i}){let n=i.remotePeer,s=n.toB58String(),o=this._addPeer(n,e),a=o.attachInboundStream(t);this._processMessages(s,a,o)}async _onPeerConnected(e,t){let i=e.toB58String();this.log("connected",i);try{let{stream:n,protocol:s}=await t.newStream(this.multicodecs);await this._addPeer(e,s).attachOutboundStream(n)}catch(n){this.log.err(n)}this._sendSubscriptions(i,Array.from(this.subscriptions),!0)}_onPeerDisconnected(e,t){let i=e.toB58String();this.log("connection ended",i,t?t.message:""),this._removePeer(e)}_addPeer(e,t){let i=e.toB58String(),n=this.peers.get(i);if(n)return n;this.log("new peer",i);let s=new GNe({id:e,protocol:t});return this.peers.set(i,s),s.once("close",()=>this._removePeer(e)),s}_removePeer(e){if(!e)return;let t=e.toB58String(),i=this.peers.get(t);if(!!i){i.removeAllListeners(),i.close(),this.log("delete peer",t),this.peers.delete(t);for(let n of this.topics.values())n.delete(t);return i}}async _processMessages(e,t,i){try{await zNe(t,async n=>{for await(let s of n){let o=s instanceof Uint8Array?s:s.slice(),a=this._decodeRpc(o);(async()=>{try{await this._processRpc(e,i,a)}catch(c){this.log.err(c)}})()}})}catch(n){this._onPeerDisconnected(i.id,n)}}async _processRpc(e,t,i){this.log("rpc from",e);let n=i.subscriptions,s=i.msgs;return n.length&&(n.forEach(o=>{this._processRpcSubOpt(e,o)}),this.emit("pubsub:subscription-change",t.id,n)),this._acceptFrom(e)?(s.length&&this.queue.addAll(s.map(o=>async()=>{if(!(this.canRelayMessage||o.topicIDs&&o.topicIDs.some(a=>this.subscriptions.has(a)))){this.log("received message we didn't subscribe to. Dropping.");return}try{let a=ef.normalizeInRpcMessage(o,e);await this._processRpcMessage(a)}catch(a){this.log.err(a)}})),!0):(this.log("received message from unacceptable peer %s",e),!1)}_processRpcSubOpt(e,t){let i=t.topicID;if(!i)return;let n=this.topics.get(i);n||(n=new Set,this.topics.set(i,n)),t.subscribe?n.add(e):n.delete(e)}async _processRpcMessage(e){if(!(this.peerId.toB58String()===e.from&&!this.emitSelf)){try{await this.validate(e)}catch(t){this.log("Message is invalid, dropping it. %O",t);return}return this._emitMessage(e),this._publish(ef.normalizeOutRpcMessage(e))}}_emitMessage(e){e.topicIDs.forEach(t=>{this.subscriptions.has(t)&&this.emit(t,e)})}getMsgId(e){let t=this.globalSignaturePolicy;switch(t){case bu.StrictSign:return ef.msgId(e.from,e.seqno);case bu.StrictNoSign:return ef.noSignMsgId(e.data);default:throw os(new Error("Cannot get message id: unhandled signature policy: "+t),la.ERR_UNHANDLED_SIGNATURE_POLICY)}}_acceptFrom(e){return!0}_decodeRpc(e){return rre.decode(e)}_encodeRpc(e){return rre.encode(e).finish()}_sendRpc(e,t){let i=this.peers.get(e);if(!i||!i.isWritable){let n=`Cannot send RPC to ${e} as there is no open stream to it available`;this.log.err(n);return}i.write(this._encodeRpc(t))}_sendSubscriptions(e,t,i){return this._sendRpc(e,{subscriptions:t.map(n=>({topicID:n,subscribe:i}))})}async validate(e){let t=this.globalSignaturePolicy;switch(t){case bu.StrictNoSign:if(e.from)throw os(new Error("StrictNoSigning: from should not be present"),la.ERR_UNEXPECTED_FROM);if(e.signature)throw os(new Error("StrictNoSigning: signature should not be present"),la.ERR_UNEXPECTED_SIGNATURE);if(e.key)throw os(new Error("StrictNoSigning: key should not be present"),la.ERR_UNEXPECTED_KEY);if(e.seqno)throw os(new Error("StrictNoSigning: seqno should not be present"),la.ERR_UNEXPECTED_SEQNO);break;case bu.StrictSign:if(!e.signature)throw os(new Error("StrictSigning: Signing required and no signature was present"),la.ERR_MISSING_SIGNATURE);if(!e.seqno)throw os(new Error("StrictSigning: Signing required and no seqno was present"),la.ERR_MISSING_SEQNO);if(!await YNe(e))throw os(new Error("StrictSigning: Invalid message signature"),la.ERR_INVALID_SIGNATURE);break;default:throw os(new Error("Cannot validate message: unhandled signature policy: "+t),la.ERR_UNHANDLED_SIGNATURE_POLICY)}for(let i of e.topicIDs){let n=this.topicValidators.get(i);n&&await n(i,e)}}_buildMessage(e){let t=this.globalSignaturePolicy;switch(t){case bu.StrictSign:return e.from=this.peerId.toB58String(),e.seqno=ef.randomSeqno(),WNe(this.peerId,e);case bu.StrictNoSign:return Promise.resolve(e);default:throw os(new Error("Cannot build message: unhandled signature policy: "+t),la.ERR_UNHANDLED_SIGNATURE_POLICY)}}getSubscribers(e){if(!this.started)throw os(new Error("not started yet"),"ERR_NOT_STARTED_YET");if(!e||typeof e!="string")throw os(new Error("a string topic must be provided"),"ERR_NOT_VALID_TOPIC");let t=this.topics.get(e);return t?Array.from(t):[]}async publish(e,t){if(!this.started)throw new Error("Pubsub has not started");this.log("publish",e,t);let n={receivedFrom:this.peerId.toB58String(),data:t,topicIDs:[e]},s=await this._buildMessage(n),o=ef.normalizeInRpcMessage(s);this.emitSelf&&this._emitMessage(o),await this._publish(o)}_publish(e){throw os(new Error("publish must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}subscribe(e){if(!this.started)throw new Error("Pubsub has not started");this.subscriptions.has(e)||(this.subscriptions.add(e),this.peers.forEach((t,i)=>this._sendSubscriptions(i,[e],!0)))}unsubscribe(e){if(!this.started)throw new Error("Pubsub is not started");this.subscriptions.has(e)&&this.listenerCount(e)===0&&(this.subscriptions.delete(e),this.peers.forEach((t,i)=>this._sendSubscriptions(i,[e],!1)))}getTopics(){if(!this.started)throw new Error("Pubsub is not started");return Array.from(this.subscriptions)}};H5.utils=ef;H5.SignaturePolicy=bu;ire.exports=H5});var sre=m($5=>{f();"use strict";Object.defineProperty($5,"__esModule",{value:!0});$5.createGossipRpc=void 0;function XNe(r=[],e={}){return{subscriptions:[],msgs:r,control:Object.assign({ihave:[],iwant:[],graft:[],prune:[]},e)}}$5.createGossipRpc=XNe});var ore=m(G5=>{f();"use strict";Object.defineProperty(G5,"__esModule",{value:!0});G5.shuffle=void 0;function QNe(r){if(r.length<=1)return r;let e=()=>Math.floor(Math.random()*Math.floor(r.length));for(let t=0;t<r.length;t++){let i=e(),n=r[t];r[t]=r[i],r[i]=n}return r}G5.shuffle=QNe});var tf=m(_e=>{f();"use strict";Object.defineProperty(_e,"__esModule",{value:!0});_e.ACCEPT_FROM_WHITELIST_DURATION_MS=_e.ACCEPT_FROM_WHITELIST_MAX_MESSAGES=_e.ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE=_e.ERR_TOPIC_VALIDATOR_IGNORE=_e.ERR_TOPIC_VALIDATOR_REJECT=_e.TimeCacheDuration=_e.GossipsubSeenTTL=_e.GossipsubIWantFollowupTime=_e.GossipsubMaxIHaveMessages=_e.GossipsubMaxIHaveLength=_e.GossipsubGraftFloodThreshold=_e.GossipsubOpportunisticGraftPeers=_e.GossipsubOpportunisticGraftTicks=_e.GossipsubDirectConnectInitialDelay=_e.GossipsubDirectConnectTicks=_e.GossipsubConnectionTimeout=_e.GossipsubMaxPendingConnections=_e.GossipsubConnectors=_e.GossipsubPruneBackoffTicks=_e.GossipsubPruneBackoff=_e.GossipsubPrunePeers=_e.GossipsubFanoutTTL=_e.GossipsubHeartbeatInterval=_e.GossipsubHeartbeatInitialDelay=_e.GossipsubGossipRetransmission=_e.GossipsubGossipFactor=_e.GossipsubDlazy=_e.GossipsubHistoryGossip=_e.GossipsubHistoryLength=_e.GossipsubDout=_e.GossipsubDscore=_e.GossipsubDhi=_e.GossipsubDlo=_e.GossipsubD=_e.GossipsubIDv11=_e.GossipsubIDv10=_e.FloodsubID=_e.minute=_e.second=void 0;_e.second=1e3;_e.minute=60*_e.second;_e.FloodsubID="/floodsub/1.0.0";_e.GossipsubIDv10="/meshsub/1.0.0";_e.GossipsubIDv11="/meshsub/1.1.0";_e.GossipsubD=6;_e.GossipsubDlo=4;_e.GossipsubDhi=12;_e.GossipsubDscore=4;_e.GossipsubDout=2;_e.GossipsubHistoryLength=5;_e.GossipsubHistoryGossip=3;_e.GossipsubDlazy=6;_e.GossipsubGossipFactor=.25;_e.GossipsubGossipRetransmission=3;_e.GossipsubHeartbeatInitialDelay=100;_e.GossipsubHeartbeatInterval=_e.second;_e.GossipsubFanoutTTL=_e.minute;_e.GossipsubPrunePeers=16;_e.GossipsubPruneBackoff=_e.minute;_e.GossipsubPruneBackoffTicks=15;_e.GossipsubConnectors=8;_e.GossipsubMaxPendingConnections=128;_e.GossipsubConnectionTimeout=30*_e.second;_e.GossipsubDirectConnectTicks=300;_e.GossipsubDirectConnectInitialDelay=_e.second;_e.GossipsubOpportunisticGraftTicks=60;_e.GossipsubOpportunisticGraftPeers=2;_e.GossipsubGraftFloodThreshold=10*_e.second;_e.GossipsubMaxIHaveLength=5e3;_e.GossipsubMaxIHaveMessages=10;_e.GossipsubIWantFollowupTime=3*_e.second;_e.GossipsubSeenTTL=30*_e.second;_e.TimeCacheDuration=120*1e3;_e.ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT";_e.ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE";_e.ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE=0;_e.ACCEPT_FROM_WHITELIST_MAX_MESSAGES=128;_e.ACCEPT_FROM_WHITELIST_DURATION_MS=1e3});var cre=m(W5=>{f();"use strict";Object.defineProperty(W5,"__esModule",{value:!0});W5.hasGossipProtocol=void 0;var are=tf();function ZNe(r){return r===are.GossipsubIDv10||r===are.GossipsubIDv11}W5.hasGossipProtocol=ZNe});var ure=m(Q0=>{f();"use strict";Object.defineProperty(Q0,"__esModule",{value:!0});Q0.messageIdFromString=Q0.messageIdToString=void 0;var JNe=(ct(),Qr),eBe=(tt(),sr);function tBe(r){return eBe.toString(r,"base64")}Q0.messageIdToString=tBe;function rBe(r){return JNe.fromString(r,"base64")}Q0.messageIdFromString=rBe});var Z0=m(pc=>{f();"use strict";var iBe=pc&&pc.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Y5=pc&&pc.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&iBe(e,r,t)};Object.defineProperty(pc,"__esModule",{value:!0});Y5(sre(),pc);Y5(ore(),pc);Y5(cre(),pc);Y5(ure(),pc)});var fre=m(J0=>{f();"use strict";var nBe=J0&&J0.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(l){try{u(i.next(l))}catch(d){o(d)}}function c(l){try{u(i.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):n(l.value).then(a,c)}u((i=i.apply(r,e||[])).next())})};Object.defineProperty(J0,"__esModule",{value:!0});J0.MessageCache=void 0;var Zx=Z0(),lre=class{constructor(e,t){this.msgs=new Map,this.peertx=new Map,this.history=[];for(let i=0;i<t;i++)this.history[i]=[];this.gossip=e}put(e,t){return nBe(this,void 0,void 0,function*(){this.msgs.set(t,e);let i=Zx.messageIdFromString(t);this.history[0].push({msgId:i,topics:e.topicIDs})})}get(e){return this.msgs.get(Zx.messageIdToString(e))}getForPeer(e,t){let i=this.msgs.get(e);if(!i)return[void 0,0];let n=this.peertx.get(e);n||(n=new Map,this.peertx.set(e,n));let s=(n.get(t)||0)+1;return n.set(t,s),[i,s]}getGossipIDs(e){let t=[];for(let i=0;i<this.gossip;i++)this.history[i].forEach(n=>{for(let s of n.topics)if(s===e){t.push(n.msgId);break}});return t}shift(){this.history[this.history.length-1].forEach(t=>{let i=Zx.messageIdToString(t.msgId);this.msgs.delete(i),this.peertx.delete(i)}),this.history.pop(),this.history.unshift([])}};J0.MessageCache=lre});var hre=m((dre,zg)=>{f();(function(r,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof va=="function"&&typeof zg=="object"&&zg&&zg.exports&&(zg.exports=e(Br()))})(dre,function(r){"use strict";var e=r.Reader,t=r.Writer,i=r.util,n=r.roots.default||(r.roots.default={});return n.RPC=function(){function s(a){if(this.subscriptions=[],this.msgs=[],a)for(var c=Object.keys(a),u=0;u<c.length;++u)a[c[u]]!=null&&(this[c[u]]=a[c[u]])}s.prototype.subscriptions=i.emptyArray,s.prototype.msgs=i.emptyArray,s.prototype.control=null;var o;return Object.defineProperty(s.prototype,"_control",{get:i.oneOfGetter(o=["control"]),set:i.oneOfSetter(o)}),s.encode=function(c,u){if(u||(u=t.create()),c.subscriptions!=null&&c.subscriptions.length)for(var l=0;l<c.subscriptions.length;++l)n.RPC.SubOpts.encode(c.subscriptions[l],u.uint32(10).fork()).ldelim();if(c.msgs!=null&&c.msgs.length)for(var l=0;l<c.msgs.length;++l)n.RPC.Message.encode(c.msgs[l],u.uint32(18).fork()).ldelim();return c.control!=null&&Object.hasOwnProperty.call(c,"control")&&n.RPC.ControlMessage.encode(c.control,u.uint32(26).fork()).ldelim(),u},s.decode=function(c,u){c instanceof e||(c=e.create(c));for(var l=u===void 0?c.len:c.pos+u,d=new n.RPC;c.pos<l;){var h=c.uint32();switch(h>>>3){case 1:d.subscriptions&&d.subscriptions.length||(d.subscriptions=[]),d.subscriptions.push(n.RPC.SubOpts.decode(c,c.uint32()));break;case 2:d.msgs&&d.msgs.length||(d.msgs=[]),d.msgs.push(n.RPC.Message.decode(c,c.uint32()));break;case 3:d.control=n.RPC.ControlMessage.decode(c,c.uint32());break;default:c.skipType(h&7);break}}return d},s.fromObject=function(c){if(c instanceof n.RPC)return c;var u=new n.RPC;if(c.subscriptions){if(!Array.isArray(c.subscriptions))throw TypeError(".RPC.subscriptions: array expected");u.subscriptions=[];for(var l=0;l<c.subscriptions.length;++l){if(typeof c.subscriptions[l]!="object")throw TypeError(".RPC.subscriptions: object expected");u.subscriptions[l]=n.RPC.SubOpts.fromObject(c.subscriptions[l])}}if(c.msgs){if(!Array.isArray(c.msgs))throw TypeError(".RPC.msgs: array expected");u.msgs=[];for(var l=0;l<c.msgs.length;++l){if(typeof c.msgs[l]!="object")throw TypeError(".RPC.msgs: object expected");u.msgs[l]=n.RPC.Message.fromObject(c.msgs[l])}}if(c.control!=null){if(typeof c.control!="object")throw TypeError(".RPC.control: object expected");u.control=n.RPC.ControlMessage.fromObject(c.control)}return u},s.toObject=function(c,u){u||(u={});var l={};if((u.arrays||u.defaults)&&(l.subscriptions=[],l.msgs=[]),c.subscriptions&&c.subscriptions.length){l.subscriptions=[];for(var d=0;d<c.subscriptions.length;++d)l.subscriptions[d]=n.RPC.SubOpts.toObject(c.subscriptions[d],u)}if(c.msgs&&c.msgs.length){l.msgs=[];for(var d=0;d<c.msgs.length;++d)l.msgs[d]=n.RPC.Message.toObject(c.msgs[d],u)}return c.control!=null&&c.hasOwnProperty("control")&&(l.control=n.RPC.ControlMessage.toObject(c.control,u),u.oneofs&&(l._control="control")),l},s.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},s.SubOpts=function(){function a(u){if(u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.subscribe=null,a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_subscribe",{get:i.oneOfGetter(c=["subscribe"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){return d||(d=t.create()),l.subscribe!=null&&Object.hasOwnProperty.call(l,"subscribe")&&d.uint32(8).bool(l.subscribe),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(18).string(l.topicID),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.SubOpts;l.pos<h;){var y=l.uint32();switch(y>>>3){case 1:p.subscribe=l.bool();break;case 2:p.topicID=l.string();break;default:l.skipType(y&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.SubOpts)return l;var d=new n.RPC.SubOpts;return l.subscribe!=null&&(d.subscribe=Boolean(l.subscribe)),l.topicID!=null&&(d.topicID=String(l.topicID)),d},a.toObject=function(l,d){d||(d={});var h={};return l.subscribe!=null&&l.hasOwnProperty("subscribe")&&(h.subscribe=l.subscribe,d.oneofs&&(h._subscribe="subscribe")),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.Message=function(){function a(u){if(this.topicIDs=[],u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.from=null,a.prototype.data=null,a.prototype.seqno=null,a.prototype.topicIDs=i.emptyArray,a.prototype.signature=null,a.prototype.key=null;var c;return Object.defineProperty(a.prototype,"_from",{get:i.oneOfGetter(c=["from"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_data",{get:i.oneOfGetter(c=["data"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_seqno",{get:i.oneOfGetter(c=["seqno"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signature",{get:i.oneOfGetter(c=["signature"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_key",{get:i.oneOfGetter(c=["key"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){if(d||(d=t.create()),l.from!=null&&Object.hasOwnProperty.call(l,"from")&&d.uint32(10).bytes(l.from),l.data!=null&&Object.hasOwnProperty.call(l,"data")&&d.uint32(18).bytes(l.data),l.seqno!=null&&Object.hasOwnProperty.call(l,"seqno")&&d.uint32(26).bytes(l.seqno),l.topicIDs!=null&&l.topicIDs.length)for(var h=0;h<l.topicIDs.length;++h)d.uint32(34).string(l.topicIDs[h]);return l.signature!=null&&Object.hasOwnProperty.call(l,"signature")&&d.uint32(42).bytes(l.signature),l.key!=null&&Object.hasOwnProperty.call(l,"key")&&d.uint32(50).bytes(l.key),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.Message;l.pos<h;){var y=l.uint32();switch(y>>>3){case 1:p.from=l.bytes();break;case 2:p.data=l.bytes();break;case 3:p.seqno=l.bytes();break;case 4:p.topicIDs&&p.topicIDs.length||(p.topicIDs=[]),p.topicIDs.push(l.string());break;case 5:p.signature=l.bytes();break;case 6:p.key=l.bytes();break;default:l.skipType(y&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.Message)return l;var d=new n.RPC.Message;if(l.from!=null&&(typeof l.from=="string"?i.base64.decode(l.from,d.from=i.newBuffer(i.base64.length(l.from)),0):l.from.length&&(d.from=l.from)),l.data!=null&&(typeof l.data=="string"?i.base64.decode(l.data,d.data=i.newBuffer(i.base64.length(l.data)),0):l.data.length&&(d.data=l.data)),l.seqno!=null&&(typeof l.seqno=="string"?i.base64.decode(l.seqno,d.seqno=i.newBuffer(i.base64.length(l.seqno)),0):l.seqno.length&&(d.seqno=l.seqno)),l.topicIDs){if(!Array.isArray(l.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");d.topicIDs=[];for(var h=0;h<l.topicIDs.length;++h)d.topicIDs[h]=String(l.topicIDs[h])}return l.signature!=null&&(typeof l.signature=="string"?i.base64.decode(l.signature,d.signature=i.newBuffer(i.base64.length(l.signature)),0):l.signature.length&&(d.signature=l.signature)),l.key!=null&&(typeof l.key=="string"?i.base64.decode(l.key,d.key=i.newBuffer(i.base64.length(l.key)),0):l.key.length&&(d.key=l.key)),d},a.toObject=function(l,d){d||(d={});var h={};if((d.arrays||d.defaults)&&(h.topicIDs=[]),l.from!=null&&l.hasOwnProperty("from")&&(h.from=d.bytes===String?i.base64.encode(l.from,0,l.from.length):d.bytes===Array?Array.prototype.slice.call(l.from):l.from,d.oneofs&&(h._from="from")),l.data!=null&&l.hasOwnProperty("data")&&(h.data=d.bytes===String?i.base64.encode(l.data,0,l.data.length):d.bytes===Array?Array.prototype.slice.call(l.data):l.data,d.oneofs&&(h._data="data")),l.seqno!=null&&l.hasOwnProperty("seqno")&&(h.seqno=d.bytes===String?i.base64.encode(l.seqno,0,l.seqno.length):d.bytes===Array?Array.prototype.slice.call(l.seqno):l.seqno,d.oneofs&&(h._seqno="seqno")),l.topicIDs&&l.topicIDs.length){h.topicIDs=[];for(var p=0;p<l.topicIDs.length;++p)h.topicIDs[p]=l.topicIDs[p]}return l.signature!=null&&l.hasOwnProperty("signature")&&(h.signature=d.bytes===String?i.base64.encode(l.signature,0,l.signature.length):d.bytes===Array?Array.prototype.slice.call(l.signature):l.signature,d.oneofs&&(h._signature="signature")),l.key!=null&&l.hasOwnProperty("key")&&(h.key=d.bytes===String?i.base64.encode(l.key,0,l.key.length):d.bytes===Array?Array.prototype.slice.call(l.key):l.key,d.oneofs&&(h._key="key")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlMessage=function(){function a(c){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],c)for(var u=Object.keys(c),l=0;l<u.length;++l)c[u[l]]!=null&&(this[u[l]]=c[u[l]])}return a.prototype.ihave=i.emptyArray,a.prototype.iwant=i.emptyArray,a.prototype.graft=i.emptyArray,a.prototype.prune=i.emptyArray,a.encode=function(u,l){if(l||(l=t.create()),u.ihave!=null&&u.ihave.length)for(var d=0;d<u.ihave.length;++d)n.RPC.ControlIHave.encode(u.ihave[d],l.uint32(10).fork()).ldelim();if(u.iwant!=null&&u.iwant.length)for(var d=0;d<u.iwant.length;++d)n.RPC.ControlIWant.encode(u.iwant[d],l.uint32(18).fork()).ldelim();if(u.graft!=null&&u.graft.length)for(var d=0;d<u.graft.length;++d)n.RPC.ControlGraft.encode(u.graft[d],l.uint32(26).fork()).ldelim();if(u.prune!=null&&u.prune.length)for(var d=0;d<u.prune.length;++d)n.RPC.ControlPrune.encode(u.prune[d],l.uint32(34).fork()).ldelim();return l},a.decode=function(u,l){u instanceof e||(u=e.create(u));for(var d=l===void 0?u.len:u.pos+l,h=new n.RPC.ControlMessage;u.pos<d;){var p=u.uint32();switch(p>>>3){case 1:h.ihave&&h.ihave.length||(h.ihave=[]),h.ihave.push(n.RPC.ControlIHave.decode(u,u.uint32()));break;case 2:h.iwant&&h.iwant.length||(h.iwant=[]),h.iwant.push(n.RPC.ControlIWant.decode(u,u.uint32()));break;case 3:h.graft&&h.graft.length||(h.graft=[]),h.graft.push(n.RPC.ControlGraft.decode(u,u.uint32()));break;case 4:h.prune&&h.prune.length||(h.prune=[]),h.prune.push(n.RPC.ControlPrune.decode(u,u.uint32()));break;default:u.skipType(p&7);break}}return h},a.fromObject=function(u){if(u instanceof n.RPC.ControlMessage)return u;var l=new n.RPC.ControlMessage;if(u.ihave){if(!Array.isArray(u.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");l.ihave=[];for(var d=0;d<u.ihave.length;++d){if(typeof u.ihave[d]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");l.ihave[d]=n.RPC.ControlIHave.fromObject(u.ihave[d])}}if(u.iwant){if(!Array.isArray(u.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");l.iwant=[];for(var d=0;d<u.iwant.length;++d){if(typeof u.iwant[d]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");l.iwant[d]=n.RPC.ControlIWant.fromObject(u.iwant[d])}}if(u.graft){if(!Array.isArray(u.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");l.graft=[];for(var d=0;d<u.graft.length;++d){if(typeof u.graft[d]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");l.graft[d]=n.RPC.ControlGraft.fromObject(u.graft[d])}}if(u.prune){if(!Array.isArray(u.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");l.prune=[];for(var d=0;d<u.prune.length;++d){if(typeof u.prune[d]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");l.prune[d]=n.RPC.ControlPrune.fromObject(u.prune[d])}}return l},a.toObject=function(u,l){l||(l={});var d={};if((l.arrays||l.defaults)&&(d.ihave=[],d.iwant=[],d.graft=[],d.prune=[]),u.ihave&&u.ihave.length){d.ihave=[];for(var h=0;h<u.ihave.length;++h)d.ihave[h]=n.RPC.ControlIHave.toObject(u.ihave[h],l)}if(u.iwant&&u.iwant.length){d.iwant=[];for(var h=0;h<u.iwant.length;++h)d.iwant[h]=n.RPC.ControlIWant.toObject(u.iwant[h],l)}if(u.graft&&u.graft.length){d.graft=[];for(var h=0;h<u.graft.length;++h)d.graft[h]=n.RPC.ControlGraft.toObject(u.graft[h],l)}if(u.prune&&u.prune.length){d.prune=[];for(var h=0;h<u.prune.length;++h)d.prune[h]=n.RPC.ControlPrune.toObject(u.prune[h],l)}return d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlIHave=function(){function a(u){if(this.messageIDs=[],u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.topicID=null,a.prototype.messageIDs=i.emptyArray;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){if(d||(d=t.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(10).string(l.topicID),l.messageIDs!=null&&l.messageIDs.length)for(var h=0;h<l.messageIDs.length;++h)d.uint32(18).bytes(l.messageIDs[h]);return d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.ControlIHave;l.pos<h;){var y=l.uint32();switch(y>>>3){case 1:p.topicID=l.string();break;case 2:p.messageIDs&&p.messageIDs.length||(p.messageIDs=[]),p.messageIDs.push(l.bytes());break;default:l.skipType(y&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.ControlIHave)return l;var d=new n.RPC.ControlIHave;if(l.topicID!=null&&(d.topicID=String(l.topicID)),l.messageIDs){if(!Array.isArray(l.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");d.messageIDs=[];for(var h=0;h<l.messageIDs.length;++h)typeof l.messageIDs[h]=="string"?i.base64.decode(l.messageIDs[h],d.messageIDs[h]=i.newBuffer(i.base64.length(l.messageIDs[h])),0):l.messageIDs[h].length&&(d.messageIDs[h]=l.messageIDs[h])}return d},a.toObject=function(l,d){d||(d={});var h={};if((d.arrays||d.defaults)&&(h.messageIDs=[]),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),l.messageIDs&&l.messageIDs.length){h.messageIDs=[];for(var p=0;p<l.messageIDs.length;++p)h.messageIDs[p]=d.bytes===String?i.base64.encode(l.messageIDs[p],0,l.messageIDs[p].length):d.bytes===Array?Array.prototype.slice.call(l.messageIDs[p]):l.messageIDs[p]}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlIWant=function(){function a(c){if(this.messageIDs=[],c)for(var u=Object.keys(c),l=0;l<u.length;++l)c[u[l]]!=null&&(this[u[l]]=c[u[l]])}return a.prototype.messageIDs=i.emptyArray,a.encode=function(u,l){if(l||(l=t.create()),u.messageIDs!=null&&u.messageIDs.length)for(var d=0;d<u.messageIDs.length;++d)l.uint32(10).bytes(u.messageIDs[d]);return l},a.decode=function(u,l){u instanceof e||(u=e.create(u));for(var d=l===void 0?u.len:u.pos+l,h=new n.RPC.ControlIWant;u.pos<d;){var p=u.uint32();switch(p>>>3){case 1:h.messageIDs&&h.messageIDs.length||(h.messageIDs=[]),h.messageIDs.push(u.bytes());break;default:u.skipType(p&7);break}}return h},a.fromObject=function(u){if(u instanceof n.RPC.ControlIWant)return u;var l=new n.RPC.ControlIWant;if(u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");l.messageIDs=[];for(var d=0;d<u.messageIDs.length;++d)typeof u.messageIDs[d]=="string"?i.base64.decode(u.messageIDs[d],l.messageIDs[d]=i.newBuffer(i.base64.length(u.messageIDs[d])),0):u.messageIDs[d].length&&(l.messageIDs[d]=u.messageIDs[d])}return l},a.toObject=function(u,l){l||(l={});var d={};if((l.arrays||l.defaults)&&(d.messageIDs=[]),u.messageIDs&&u.messageIDs.length){d.messageIDs=[];for(var h=0;h<u.messageIDs.length;++h)d.messageIDs[h]=l.bytes===String?i.base64.encode(u.messageIDs[h],0,u.messageIDs[h].length):l.bytes===Array?Array.prototype.slice.call(u.messageIDs[h]):u.messageIDs[h]}return d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlGraft=function(){function a(u){if(u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){return d||(d=t.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(10).string(l.topicID),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.ControlGraft;l.pos<h;){var y=l.uint32();switch(y>>>3){case 1:p.topicID=l.string();break;default:l.skipType(y&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.ControlGraft)return l;var d=new n.RPC.ControlGraft;return l.topicID!=null&&(d.topicID=String(l.topicID)),d},a.toObject=function(l,d){d||(d={});var h={};return l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlPrune=function(){function a(u){if(this.peers=[],u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.topicID=null,a.prototype.peers=i.emptyArray,a.prototype.backoff=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_backoff",{get:i.oneOfGetter(c=["backoff"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){if(d||(d=t.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(10).string(l.topicID),l.peers!=null&&l.peers.length)for(var h=0;h<l.peers.length;++h)n.RPC.PeerInfo.encode(l.peers[h],d.uint32(18).fork()).ldelim();return l.backoff!=null&&Object.hasOwnProperty.call(l,"backoff")&&d.uint32(24).uint64(l.backoff),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.ControlPrune;l.pos<h;){var y=l.uint32();switch(y>>>3){case 1:p.topicID=l.string();break;case 2:p.peers&&p.peers.length||(p.peers=[]),p.peers.push(n.RPC.PeerInfo.decode(l,l.uint32()));break;case 3:p.backoff=l.uint64();break;default:l.skipType(y&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.ControlPrune)return l;var d=new n.RPC.ControlPrune;if(l.topicID!=null&&(d.topicID=String(l.topicID)),l.peers){if(!Array.isArray(l.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");d.peers=[];for(var h=0;h<l.peers.length;++h){if(typeof l.peers[h]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");d.peers[h]=n.RPC.PeerInfo.fromObject(l.peers[h])}}return l.backoff!=null&&(i.Long?(d.backoff=i.Long.fromValue(l.backoff)).unsigned=!0:typeof l.backoff=="string"?d.backoff=parseInt(l.backoff,10):typeof l.backoff=="number"?d.backoff=l.backoff:typeof l.backoff=="object"&&(d.backoff=new i.LongBits(l.backoff.low>>>0,l.backoff.high>>>0).toNumber(!0))),d},a.toObject=function(l,d){d||(d={});var h={};if((d.arrays||d.defaults)&&(h.peers=[]),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),l.peers&&l.peers.length){h.peers=[];for(var p=0;p<l.peers.length;++p)h.peers[p]=n.RPC.PeerInfo.toObject(l.peers[p],d)}return l.backoff!=null&&l.hasOwnProperty("backoff")&&(typeof l.backoff=="number"?h.backoff=d.longs===String?String(l.backoff):l.backoff:h.backoff=d.longs===String?i.Long.prototype.toString.call(l.backoff):d.longs===Number?new i.LongBits(l.backoff.low>>>0,l.backoff.high>>>0).toNumber(!0):l.backoff,d.oneofs&&(h._backoff="backoff")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.PeerInfo=function(){function a(u){if(u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.peerID=null,a.prototype.signedPeerRecord=null;var c;return Object.defineProperty(a.prototype,"_peerID",{get:i.oneOfGetter(c=["peerID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signedPeerRecord",{get:i.oneOfGetter(c=["signedPeerRecord"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){return d||(d=t.create()),l.peerID!=null&&Object.hasOwnProperty.call(l,"peerID")&&d.uint32(10).bytes(l.peerID),l.signedPeerRecord!=null&&Object.hasOwnProperty.call(l,"signedPeerRecord")&&d.uint32(18).bytes(l.signedPeerRecord),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.PeerInfo;l.pos<h;){var y=l.uint32();switch(y>>>3){case 1:p.peerID=l.bytes();break;case 2:p.signedPeerRecord=l.bytes();break;default:l.skipType(y&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.PeerInfo)return l;var d=new n.RPC.PeerInfo;return l.peerID!=null&&(typeof l.peerID=="string"?i.base64.decode(l.peerID,d.peerID=i.newBuffer(i.base64.length(l.peerID)),0):l.peerID.length&&(d.peerID=l.peerID)),l.signedPeerRecord!=null&&(typeof l.signedPeerRecord=="string"?i.base64.decode(l.signedPeerRecord,d.signedPeerRecord=i.newBuffer(i.base64.length(l.signedPeerRecord)),0):l.signedPeerRecord.length&&(d.signedPeerRecord=l.signedPeerRecord)),d},a.toObject=function(l,d){d||(d={});var h={};return l.peerID!=null&&l.hasOwnProperty("peerID")&&(h.peerID=d.bytes===String?i.base64.encode(l.peerID,0,l.peerID.length):d.bytes===Array?Array.prototype.slice.call(l.peerID):l.peerID,d.oneofs&&(h._peerID="peerID")),l.signedPeerRecord!=null&&l.hasOwnProperty("signedPeerRecord")&&(h.signedPeerRecord=d.bytes===String?i.base64.encode(l.signedPeerRecord,0,l.signedPeerRecord.length):d.bytes===Array?Array.prototype.slice.call(l.signedPeerRecord):l.signedPeerRecord,d.oneofs&&(h._signedPeerRecord="signedPeerRecord")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s}(),n})});var Jx=m(X5=>{f();"use strict";Object.defineProperty(X5,"__esModule",{value:!0});X5.getGossipPeers=void 0;var pre=Z0();function sBe(r,e,t,i=()=>!0){let n=r.topics.get(e);if(!n)return new Set;let s=[];return n.forEach(o=>{let a=r.peers.get(o);!a||pre.hasGossipProtocol(a.protocol)&&i(o)&&s.push(o)}),s=pre.shuffle(s),t>0&&s.length>t&&(s=s.slice(0,t)),new Set(s)}X5.getGossipPeers=sBe});var gre=m(yc=>{f();"use strict";var oBe=yc&&yc.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),aBe=yc&&yc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),cBe=yc&&yc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&oBe(e,r,t);return aBe(e,r),e};Object.defineProperty(yc,"__esModule",{value:!0});yc.Heartbeat=void 0;var eI=cBe(tf()),Q5=Jx(),uBe=Z0(),yre=class{constructor(e){this.gossipsub=e}start(){if(this._heartbeatTimer)return;let e=this._heartbeat.bind(this),t=setTimeout(()=>{e(),this._heartbeatTimer.runPeriodically(e,this.gossipsub._options.heartbeatInterval)},eI.GossipsubHeartbeatInitialDelay);this._heartbeatTimer={_intervalId:void 0,runPeriodically:(i,n)=>{this._heartbeatTimer._intervalId=setInterval(i,n)},cancel:()=>{clearTimeout(t),clearInterval(this._heartbeatTimer._intervalId)}}}stop(){!this._heartbeatTimer||(this._heartbeatTimer.cancel(),this._heartbeatTimer=null)}_heartbeat(){let{D:e,Dlo:t,Dhi:i,Dscore:n,Dout:s,fanoutTTL:o}=this.gossipsub._options;this.gossipsub.heartbeatTicks++;let a=new Map,c=p=>{let y=a.get(p);return y===void 0&&(y=this.gossipsub.score.score(p),a.set(p,y)),y},u=new Map,l=new Map,d=new Map;this.gossipsub._clearBackoff(),this.gossipsub.peerhave.clear(),this.gossipsub.iasked.clear(),this.gossipsub._applyIwantPenalties(),this.gossipsub._directConnect(),this.gossipsub.mesh.forEach((p,y)=>{let g=b=>{this.gossipsub.log("HEARTBEAT: Remove mesh link to %s in %s",b,y),this.gossipsub.score.prune(b,y),this.gossipsub._addBackoff(b,y),p.delete(b);let v=l.get(b);v?v.push(y):l.set(b,[y])},w=b=>{this.gossipsub.log("HEARTBEAT: Add mesh link to %s in %s",b,y),this.gossipsub.score.graft(b,y),p.add(b);let v=u.get(b);v?v.push(y):u.set(b,[y])};if(p.forEach(b=>{let v=c(b);v<0&&(this.gossipsub.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",b,v,y),g(b),d.set(b,!0))}),p.size<t){let b=this.gossipsub.backoff.get(y),v=e-p.size;Q5.getGossipPeers(this.gossipsub,y,v,k=>!p.has(k)&&!this.gossipsub.direct.has(k)&&(!b||!b.has(k))&&c(k)>=0).forEach(w)}if(p.size>i){let b=Array.from(p);b.sort((A,k)=>c(k)-c(A)),b=b.slice(0,n).concat(uBe.shuffle(b.slice(n)));let v=0;if(b.slice(0,e).forEach(A=>{this.gossipsub.outbound.get(A)&&v++}),v<s){let A=C=>{let T=b[C];for(let D=C;D>0;D--)b[D]=b[D-1];b[0]=T};if(v>0){let C=v;for(let T=1;T<e&&C>0;T++)this.gossipsub.outbound.get(b[T])&&(A(T),C--)}let k=e-v;for(let C=e;C<b.length&&k>0;C++)this.gossipsub.outbound.get(b[C])&&(A(C),k--)}b.slice(e).forEach(g)}if(p.size>=t){let b=0;if(p.forEach(v=>{this.gossipsub.outbound.get(v)&&b++}),b<s){let v=s-b,A=this.gossipsub.backoff.get(y);Q5.getGossipPeers(this.gossipsub,y,v,k=>!p.has(k)&&!this.gossipsub.direct.has(k)&&(!A||!A.has(k))&&c(k)>=0).forEach(w)}}if(this.gossipsub.heartbeatTicks%eI.GossipsubOpportunisticGraftTicks==0&&p.size>1){let b=Array.from(p).sort((k,C)=>c(k)-c(C)),v=Math.floor(p.size/2),A=c(b[v]);if(A<this.gossipsub._options.scoreThresholds.opportunisticGraftThreshold){let k=this.gossipsub.backoff.get(y);Q5.getGossipPeers(this.gossipsub,y,eI.GossipsubOpportunisticGraftPeers,T=>p.has(T)&&!this.gossipsub.direct.has(T)&&(!k||!k.has(T))&&c(T)>A).forEach(T=>{this.gossipsub.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",T,y),w(T)})}}this.gossipsub._emitGossip(y,p)});let h=this.gossipsub._now();this.gossipsub.lastpub.forEach((p,y)=>{p+o<h&&(this.gossipsub.fanout.delete(y),this.gossipsub.lastpub.delete(y))}),this.gossipsub.fanout.forEach((p,y)=>{let g=this.gossipsub.topics.get(y);if(p.forEach(w=>{(!g.has(w)||c(w)<this.gossipsub._options.scoreThresholds.publishThreshold)&&p.delete(w)}),p.size<e){let w=e-p.size;Q5.getGossipPeers(this.gossipsub,y,w,v=>!p.has(v)&&!this.gossipsub.direct.has(v)&&c(v)>=this.gossipsub._options.scoreThresholds.publishThreshold).forEach(v=>{p.add(v)})}this.gossipsub._emitGossip(y,p)}),this.gossipsub._sendGraftPrune(u,l,d),this.gossipsub._flush(),this.gossipsub.messageCache.shift(),this.gossipsub.emit("gossipsub:heartbeat")}};yc.Heartbeat=yre});var tI=m(e1=>{f();"use strict";Object.defineProperty(e1,"__esModule",{value:!0});e1.ERR_INVALID_PEER_SCORE_THRESHOLDS=e1.ERR_INVALID_PEER_SCORE_PARAMS=void 0;e1.ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS";e1.ERR_INVALID_PEER_SCORE_THRESHOLDS="ERR_INVALID_PEER_SCORE_THRESHOLDS"});var rI=m((t5t,bre)=>{f();"use strict";function mre(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function lBe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return mre(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),mre(new n,t)}}bre.exports=lBe});var iI=m(_n=>{f();"use strict";Object.defineProperty(_n,"__esModule",{value:!0});_n.validateTopicScoreParams=_n.validatePeerScoreParams=_n.createTopicScoreParams=_n.createPeerScoreParams=_n.defaultTopicScoreParams=_n.defaultPeerScoreParams=void 0;var gr=tI(),mr=rI();_n.defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3};_n.defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function fBe(r={}){return Object.assign(Object.assign(Object.assign({},_n.defaultPeerScoreParams),r),{topics:r.topics?Object.entries(r.topics).reduce((e,[t,i])=>(e[t]=wre(i),e),{}):{}})}_n.createPeerScoreParams=fBe;function wre(r={}){return Object.assign(Object.assign({},_n.defaultTopicScoreParams),r)}_n.createTopicScoreParams=wre;function dBe(r){for(let[e,t]of Object.entries(r.topics))try{_re(t)}catch(i){throw mr(new Error(`invalid score parameters for topic ${e}: ${i.message}`),gr.ERR_INVALID_PEER_SCORE_PARAMS)}if(r.topicScoreCap<0)throw mr(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.appSpecificScore===null||r.appSpecificScore===void 0)throw mr(new Error("missing application specific score function"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.IPColocationFactorWeight>0)throw mr(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.IPColocationFactorWeight!==0&&r.IPColocationFactorThreshold<1)throw mr(new Error("invalid IPColocationFactorThreshold; must be at least 1"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.behaviourPenaltyWeight>0)throw mr(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.behaviourPenaltyWeight!==0&&(r.behaviourPenaltyDecay<=0||r.behaviourPenaltyDecay>=1))throw mr(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.decayInterval<1e3)throw mr(new Error("invalid DecayInterval; must be at least 1s"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.decayToZero<=0||r.decayToZero>=1)throw mr(new Error("invalid DecayToZero; must be between 0 and 1"),gr.ERR_INVALID_PEER_SCORE_PARAMS)}_n.validatePeerScoreParams=dBe;function _re(r){if(r.topicWeight<0)throw mr(new Error("invalid topic weight; must be >= 0"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshQuantum===0)throw mr(new Error("invalid TimeInMeshQuantum; must be non zero"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshWeight<0)throw mr(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshWeight!==0&&r.timeInMeshQuantum<=0)throw mr(new Error("invalid TimeInMeshQuantum; must be positive"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshWeight!==0&&r.timeInMeshCap<=0)throw mr(new Error("invalid TimeInMeshCap; must be positive"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.firstMessageDeliveriesWeight<0)throw mr(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.firstMessageDeliveriesWeight!==0&&(r.firstMessageDeliveriesDecay<=0||r.firstMessageDeliveriesDecay>=1))throw mr(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.firstMessageDeliveriesWeight!==0&&r.firstMessageDeliveriesCap<=0)throw mr(new Error("invalid FirstMessageDeliveriesCap; must be positive"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight>0)throw mr(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&(r.meshMessageDeliveriesDecay<=0||r.meshMessageDeliveriesDecay>=1))throw mr(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&r.meshMessageDeliveriesCap<=0)throw mr(new Error("invalid MeshMessageDeliveriesCap; must be positive"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&r.meshMessageDeliveriesThreshold<=0)throw mr(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWindow<0)throw mr(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&r.meshMessageDeliveriesActivation<1e3)throw mr(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshFailurePenaltyWeight>0)throw mr(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshFailurePenaltyWeight!==0&&(r.meshFailurePenaltyDecay<=0||r.meshFailurePenaltyDecay>=1))throw mr(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.invalidMessageDeliveriesWeight>0)throw mr(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.invalidMessageDeliveriesDecay<=0||r.invalidMessageDeliveriesDecay>=1)throw mr(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),gr.ERR_INVALID_PEER_SCORE_PARAMS)}_n.validateTopicScoreParams=_re});var vre=m(wu=>{f();"use strict";Object.defineProperty(wu,"__esModule",{value:!0});wu.validatePeerScoreThresholds=wu.createPeerScoreThresholds=wu.defaultPeerScoreThresholds=void 0;var Hg=tI(),$g=rI();wu.defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function hBe(r={}){return Object.assign(Object.assign({},wu.defaultPeerScoreThresholds),r)}wu.createPeerScoreThresholds=hBe;function pBe(r){if(r.gossipThreshold>0)throw $g(new Error("invalid gossip threshold; it must be <= 0"),Hg.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.publishThreshold>0||r.publishThreshold>r.gossipThreshold)throw $g(new Error("invalid publish threshold; it must be <= 0 and <= gossip threshold"),Hg.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.graylistThreshold>0||r.graylistThreshold>r.publishThreshold)throw $g(new Error("invalid graylist threshold; it must be <= 0 and <= publish threshold"),Hg.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.acceptPXThreshold<0)throw $g(new Error("invalid accept PX threshold; it must be >= 0"),Hg.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.opportunisticGraftThreshold<0)throw $g(new Error("invalid opportunistic grafting threshold; it must be >= 0"),Hg.ERR_INVALID_PEER_SCORE_THRESHOLDS)}wu.validatePeerScoreThresholds=pBe});var Ere=m(rf=>{f();"use strict";Object.defineProperty(rf,"__esModule",{value:!0});rf.ensureTopicStats=rf.createTopicStats=rf.createPeerStats=void 0;function yBe(r={}){return Object.assign(Object.assign({connected:!1,expire:0,ips:[],behaviourPenalty:0},r),{topics:r.topics?Object.entries(r.topics).reduce((e,[t,i])=>(e[t]=nI(i),e),{}):{}})}rf.createPeerStats=yBe;function nI(r={}){return Object.assign({inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},r)}rf.createTopicStats=nI;function gBe(r,e,t){let i=e.topics[r];if(i)return i;if(!!t.topics[r])return e.topics[r]=i=nI(),i}rf.ensureTopicStats=gBe});var Sre=m(Z5=>{f();"use strict";Object.defineProperty(Z5,"__esModule",{value:!0});Z5.computeScore=void 0;function mBe(r,e,t,i){let n=0;return Object.entries(e.topics).forEach(([a,c])=>{let u=t.topics[a];if(!u)return;let l=0;if(c.inMesh){let y=c.meshTime/u.timeInMeshQuantum;y>u.timeInMeshCap&&(y=u.timeInMeshCap),l+=y*u.timeInMeshWeight}if(l+=c.firstMessageDeliveries*u.firstMessageDeliveriesWeight,c.meshMessageDeliveriesActive&&c.meshMessageDeliveries<u.meshMessageDeliveriesThreshold){let y=u.meshMessageDeliveriesThreshold-c.meshMessageDeliveries;l+=y*y*u.meshMessageDeliveriesWeight}l+=c.meshFailurePenalty*u.meshFailurePenaltyWeight,l+=c.invalidMessageDeliveries*c.invalidMessageDeliveries*u.invalidMessageDeliveriesWeight,n+=l*u.topicWeight}),t.topicScoreCap>0&&n>t.topicScoreCap&&(n=t.topicScoreCap),n+=t.appSpecificScore(r)*t.appSpecificWeight,e.ips.forEach(a=>{if(t.IPColocationFactorWhitelist.has(a))return;let c=i.get(a),u=c?c.size:0;if(u>t.IPColocationFactorThreshold){let l=u-t.IPColocationFactorThreshold;n+=l*l*t.IPColocationFactorWeight}}),n+=e.behaviourPenalty*e.behaviourPenalty*t.behaviourPenaltyWeight,n}Z5.computeScore=mBe});var Are=m((o5t,Rre)=>{f();"use strict";function ri(r,e){var e=e||{};this._head=0,this._tail=0,this._capacity=e.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(r)&&this._fromArray(r)}ri.prototype.peekAt=function(e){var t=e;if(t===(t|0)){var i=this.size();if(!(t>=i||t<-i))return t<0&&(t+=i),t=this._head+t&this._capacityMask,this._list[t]}};ri.prototype.get=function(e){return this.peekAt(e)};ri.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};ri.prototype.peekFront=function(){return this.peek()};ri.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(ri.prototype,"length",{get:function(){return this.size()}});ri.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};ri.prototype.unshift=function(e){if(e===void 0)return this.size();var t=this._list.length;return this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};ri.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}};ri.prototype.push=function(e){if(e===void 0)return this.size();var t=this._tail;return this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};ri.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var i=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),i}};ri.prototype.removeOne=function(e){var t=e;if(t===(t|0)&&this._head!==this._tail){var i=this.size(),n=this._list.length;if(!(t>=i||t<-i)){t<0&&(t+=i),t=this._head+t&this._capacityMask;var s=this._list[t],o;if(e<i/2){for(o=e;o>0;o--)this._list[t]=this._list[t=t-1+n&this._capacityMask];this._list[t]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(o=i-1-e;o>0;o--)this._list[t]=this._list[t=t+1+n&this._capacityMask];this._list[t]=void 0,this._tail=this._tail-1+n&this._capacityMask}return s}}};ri.prototype.remove=function(e,t){var i=e,n,s=t;if(i===(i|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(i>=o||i<-o||t<1)){if(i<0&&(i+=o),t===1||!t)return n=new Array(1),n[0]=this.removeOne(i),n;if(i===0&&i+t>=o)return n=this.toArray(),this.clear(),n;i+t>o&&(t=o-i);var c;for(n=new Array(t),c=0;c<t;c++)n[c]=this._list[this._head+i+c&this._capacityMask];if(i=this._head+i&this._capacityMask,e+t===o){for(this._tail=this._tail-t+a&this._capacityMask,c=t;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(e===0){for(this._head=this._head+t+a&this._capacityMask,c=t-1;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(i<o/2){for(this._head=this._head+e+t+a&this._capacityMask,c=e;c>0;c--)this.unshift(this._list[i=i-1+a&this._capacityMask]);for(i=this._head-1+a&this._capacityMask;s>0;)this._list[i=i-1+a&this._capacityMask]=void 0,s--;e<0&&(this._tail=i)}else{for(this._tail=i,i=i+t+a&this._capacityMask,c=o-(t+e);c>0;c--)this.push(this._list[i++]);for(i=this._tail;s>0;)this._list[i=i+1+a&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),n}}};ri.prototype.splice=function(e,t){var i=e;if(i===(i|0)){var n=this.size();if(i<0&&(i+=n),!(i>n))if(arguments.length>2){var s,o,a,c=arguments.length,u=this._list.length,l=2;if(!n||i<n/2){for(o=new Array(i),s=0;s<i;s++)o[s]=this._list[this._head+s&this._capacityMask];for(t===0?(a=[],i>0&&(this._head=this._head+i+u&this._capacityMask)):(a=this.remove(i,t),this._head=this._head+i+u&this._capacityMask);c>l;)this.unshift(arguments[--c]);for(s=i;s>0;s--)this.unshift(o[s-1])}else{o=new Array(n-(i+t));var d=o.length;for(s=0;s<d;s++)o[s]=this._list[this._head+i+t+s&this._capacityMask];for(t===0?(a=[],i!=n&&(this._tail=this._head+i+u&this._capacityMask)):(a=this.remove(i,t),this._tail=this._tail-d+u&this._capacityMask);l<c;)this.push(arguments[l++]);for(s=0;s<d;s++)this.push(o[s])}return a}else return this.remove(i,t)}};ri.prototype.clear=function(){this._head=0,this._tail=0};ri.prototype.isEmpty=function(){return this._head===this._tail};ri.prototype.toArray=function(){return this._copyArray(!1)};ri.prototype._fromArray=function(e){for(var t=0;t<e.length;t++)this.push(e[t])};ri.prototype._copyArray=function(e){var t=[],i=this._list,n=i.length,s;if(e||this._head>this._tail){for(s=this._head;s<n;s++)t.push(i[s]);for(s=0;s<this._tail;s++)t.push(i[s])}else for(s=this._head;s<this._tail;s++)t.push(i[s]);return t};ri.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1};ri.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};Rre.exports=ri});var Tre=m(_u=>{f();"use strict";var bBe=_u&&_u.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(_u,"__esModule",{value:!0});_u.MessageDeliveries=_u.DeliveryRecordStatus=void 0;var wBe=tf(),_Be=bBe(Are()),xre;(function(r){r[r.unknown=0]="unknown",r[r.valid=1]="valid",r[r.invalid=2]="invalid",r[r.ignored=3]="ignored"})(xre=_u.DeliveryRecordStatus||(_u.DeliveryRecordStatus={}));var Ire=class{constructor(){this.records=new Map,this.queue=new _Be.default}ensureRecord(e){let t=this.records.get(e);if(t)return t;t={status:xre.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(e,t);let i={msgId:e,expire:Date.now()+wBe.TimeCacheDuration};return this.queue.push(i),t}gc(){let e=Date.now(),t=this.queue.peekFront();for(;t&&t.expire<e;)this.records.delete(t.msgId),this.queue.shift(),t=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};_u.MessageDeliveries=Ire});var Cre=m(nf=>{f();"use strict";var J5=nf&&nf.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(l){try{u(i.next(l))}catch(d){o(d)}}function c(l){try{u(i.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):n(l.value).then(a,c)}u((i=i.apply(r,e||[])).next())})},vBe=nf&&nf.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(nf,"__esModule",{value:!0});nf.PeerScore=void 0;var EBe=iI(),t1=Ere(),SBe=Sre(),fa=Tre(),RBe=tf(),ABe=vBe(ot()),xBe=le(),IBe=F5(),{ERR_INVALID_SIGNATURE:TBe,ERR_MISSING_SIGNATURE:PBe}=IBe.codes,r1=xBe("libp2p:gossipsub:score"),Pre=class{constructor(e,t){EBe.validatePeerScoreParams(e),this.params=e,this._connectionManager=t,this.peerStats=new Map,this.peerIPs=new Map,this.scoreCache=new Map,this.deliveryRecords=new fa.MessageDeliveries}start(){if(this._backgroundInterval){r1("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),r1("started")}stop(){if(!this._backgroundInterval){r1("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),r1("stopped")}background(){this._refreshScores(),this._updateIPs(),this.deliveryRecords.gc()}_refreshScores(){let e=Date.now(),t=this.params.decayToZero;this.peerStats.forEach((i,n)=>{if(!i.connected){e>i.expire&&(this._removeIPs(n,i.ips),this.peerStats.delete(n));return}Object.entries(i.topics).forEach(([s,o])=>{let a=this.params.topics[s];!a||(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<t&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<t&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<t&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<t&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),i.behaviourPenalty*=this.params.behaviourPenaltyDecay,i.behaviourPenalty<t&&(i.behaviourPenalty=0),this.scoreCache.set(n,{score:null,cacheUntil:0})})}score(e){let t=this.peerStats.get(e);if(!t)return 0;let i=Date.now(),n=this.scoreCache.get(e);n===void 0&&(n={score:null,cacheUntil:0},this.scoreCache.set(e,n));let{score:s,cacheUntil:o}=n;return o>i&&s!==null?s:(n.score=SBe.computeScore(e,t,this.params,this.peerIPs),n.cacheUntil=i+this.params.decayInterval,n.score)}addPenalty(e,t){let i=this.peerStats.get(e);!i||(i.behaviourPenalty+=t,this.scoreCache.set(e,{score:null,cacheUntil:0}))}addPeer(e){let t=t1.createPeerStats({connected:!0});this.peerStats.set(e,t);let i=this._getIPs(e);this._setIPs(e,i,t.ips),t.ips=i}removePeer(e){let t=this.peerStats.get(e);if(!!t){if(this.score(e)>0){this._removeIPs(e,t.ips),this.peerStats.delete(e);return}this.scoreCache.delete(e),Object.entries(t.topics).forEach(([i,n])=>{n.firstMessageDeliveries=0;let s=this.params.topics[i].meshMessageDeliveriesThreshold;if(n.inMesh&&n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1}),t.connected=!1,t.expire=Date.now()+this.params.retainScore}}graft(e,t){let i=this.peerStats.get(e);if(!i)return;let n=t1.ensureTopicStats(t,i,this.params);!n||(n.inMesh=!0,n.graftTime=Date.now(),n.meshTime=0,n.meshMessageDeliveriesActive=!1,this.scoreCache.set(e,{score:null,cacheUntil:0}))}prune(e,t){let i=this.peerStats.get(e);if(!i)return;let n=t1.ensureTopicStats(t,i,this.params);if(!n)return;let s=this.params.topics[t].meshMessageDeliveriesThreshold;if(n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1,this.scoreCache.set(e,{score:null,cacheUntil:0})}validateMessage(e){return J5(this,void 0,void 0,function*(){this.deliveryRecords.ensureRecord(e)})}deliverMessage(e,t){return J5(this,void 0,void 0,function*(){let i=e.receivedFrom;this._markFirstMessageDelivery(i,e);let n=this.deliveryRecords.ensureRecord(t),s=Date.now();if(n.status!==fa.DeliveryRecordStatus.unknown){r1("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",i,s-n.firstSeen,fa.DeliveryRecordStatus[n.status]);return}n.status=fa.DeliveryRecordStatus.valid,n.validated=s,n.peers.forEach(o=>{o!==i&&this._markDuplicateMessageDelivery(o,e)})})}rejectMessage(e,t,i){return J5(this,void 0,void 0,function*(){let n=e.receivedFrom;switch(i){case PBe:case TBe:this._markInvalidMessageDelivery(n,e);return}let s=this.deliveryRecords.ensureRecord(t);if(s.status!==fa.DeliveryRecordStatus.unknown){r1("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",n,Date.now()-s.firstSeen,fa.DeliveryRecordStatus[s.status]);return}switch(i){case RBe.ERR_TOPIC_VALIDATOR_IGNORE:s.status=fa.DeliveryRecordStatus.ignored;return}s.status=fa.DeliveryRecordStatus.invalid,this._markInvalidMessageDelivery(n,e),s.peers.forEach(o=>{this._markInvalidMessageDelivery(o,e)})})}duplicateMessage(e,t){return J5(this,void 0,void 0,function*(){let i=e.receivedFrom,n=this.deliveryRecords.ensureRecord(t);if(!n.peers.has(i))switch(n.status){case fa.DeliveryRecordStatus.unknown:n.peers.add(i);break;case fa.DeliveryRecordStatus.valid:n.peers.add(i),this._markDuplicateMessageDelivery(i,e,n.validated);break;case fa.DeliveryRecordStatus.invalid:this._markInvalidMessageDelivery(i,e);break}})}_markInvalidMessageDelivery(e,t){let i=this.peerStats.get(e);!i||(t.topicIDs.forEach(n=>{let s=t1.ensureTopicStats(n,i,this.params);!s||(s.invalidMessageDeliveries+=1)}),this.scoreCache.set(e,{score:null,cacheUntil:0}))}_markFirstMessageDelivery(e,t){let i=this.peerStats.get(e);!i||(t.topicIDs.forEach(n=>{let s=t1.ensureTopicStats(n,i,this.params);if(!s)return;let o=this.params.topics[n].firstMessageDeliveriesCap;s.firstMessageDeliveries+=1,s.firstMessageDeliveries>o&&(s.firstMessageDeliveries=o),!!s.inMesh&&(o=this.params.topics[n].meshMessageDeliveriesCap,s.meshMessageDeliveries+=1,s.meshMessageDeliveries>o&&(s.meshMessageDeliveries=o))}),this.scoreCache.set(e,{score:null,cacheUntil:0}))}_markDuplicateMessageDelivery(e,t,i=0){let n=this.peerStats.get(e);if(!n)return;let s=i?Date.now():0;t.topicIDs.forEach(o=>{let a=t1.ensureTopicStats(o,n,this.params);if(!a||!a.inMesh)return;let c=this.params.topics[o];if(i&&s>i+c.meshMessageDeliveriesWindow)return;let u=c.meshMessageDeliveriesCap;a.meshMessageDeliveries+=1,a.meshMessageDeliveries>u&&(a.meshMessageDeliveries=u)}),this.scoreCache.set(e,{score:null,cacheUntil:0})}_getIPs(e){return this._connectionManager.getAll(ABe.default.createFromB58String(e)).map(t=>t.remoteAddr.toOptions().host)}_setIPs(e,t,i){e:for(let n of t){for(let o of i)if(n===o)continue e;let s=this.peerIPs.get(n);s||(s=new Set,this.peerIPs.set(n,s)),s.add(e)}e:for(let n of i){for(let o of t)if(n===o)continue e;let s=this.peerIPs.get(n);!s||(s.delete(e),s.size||this.peerIPs.delete(n))}this.scoreCache.set(e,{score:null,cacheUntil:0})}_removeIPs(e,t){t.forEach(i=>{let n=this.peerIPs.get(i);!n||(n.delete(e),n.size||this.peerIPs.delete(i))}),this.scoreCache.set(e,{score:null,cacheUntil:0})}_updateIPs(){this.peerStats.forEach((e,t)=>{let i=this._getIPs(t);this._setIPs(t,i,e.ips),e.ips=i,this.scoreCache.set(t,{score:null,cacheUntil:0})})}};nf.PeerScore=Pre});var Ore=m(vu=>{f();"use strict";var CBe=vu&&vu.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),sI=vu&&vu.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&CBe(e,r,t)};Object.defineProperty(vu,"__esModule",{value:!0});sI(iI(),vu);sI(vre(),vu);sI(Cre(),vu)});var Nre=m(i1=>{f();"use strict";var kre=i1&&i1.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(l){try{u(i.next(l))}catch(d){o(d)}}function c(l){try{u(i.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):n(l.value).then(a,c)}u((i=i.apply(r,e||[])).next())})};Object.defineProperty(i1,"__esModule",{value:!0});i1.IWantTracer=void 0;var OBe=tf(),kBe=Z0(),DBe=F5(),{ERR_INVALID_SIGNATURE:NBe,ERR_MISSING_SIGNATURE:BBe}=DBe.codes,Dre=class{constructor(){this.promises=new Map}addPromise(e,t){let i=Math.floor(Math.random()*t.length),n=t[i],s=kBe.messageIdToString(n),o=this.promises.get(s);o||(o=new Map,this.promises.set(s,o)),o.has(e)||o.set(e,Date.now()+OBe.GossipsubIWantFollowupTime)}getBrokenPromises(){let e=Date.now(),t=new Map;return this.promises.forEach((i,n)=>{i.forEach((s,o)=>{s<e&&(t.set(o,(t.get(o)||0)+1),i.delete(o))}),i.size||this.promises.delete(n)}),t}deliverMessage(e){return kre(this,void 0,void 0,function*(){this.promises.delete(e)})}rejectMessage(e,t){return kre(this,void 0,void 0,function*(){switch(t){case NBe:case BBe:return}this.promises.delete(e)})}clear(){this.promises.clear()}};i1.IWantTracer=Dre});var Lre=m(ew=>{f();"use strict";Object.defineProperty(ew,"__esModule",{value:!0});ew.SimpleTimeCache=void 0;var Bre=class{constructor(e){this.lastPruneTime=0,this.entries=new Map,this.validityMs=e.validityMs}put(e,t){this.entries.set(e,{value:t,validUntilMs:Date.now()+this.validityMs}),this.prune()}prune(){let e=Date.now();if(!(e-this.lastPruneTime<200)){this.lastPruneTime=e;for(let[t,i]of this.entries.entries())if(i.validUntilMs<e)this.entries.delete(t);else break}}has(e){return this.entries.has(e)}get(e){let t=this.entries.get(e);return t&&t.validUntilMs>=Date.now()?t.value:void 0}clear(){this.entries=new Map,this.lastPruneTime=0}};ew.SimpleTimeCache=Bre});var br=m((d5t,jre)=>{f();"use strict";function Mre(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function LBe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Mre(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Mre(new n,t)}}jre.exports=LBe});var wr=m(oI=>{f();"use strict";oI.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required",NOT_FOUND:"Not found"};oI.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_PEER_DIAL_INTERCEPTED:"ERR_PEER_DIAL_INTERCEPTED",ERR_CONNECTION_INTERCEPTED:"ERR_CONNECTION_INTERCEPTED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_TOO_MANY_ADDRESSES:"ERR_TOO_MANY_ADDRESSES",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_NOT_FOUND:"ERR_NOT_FOUND",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID",ERR_FIND_SELF:"ERR_FIND_SELF",ERR_NO_ROUTERS_AVAILABLE:"ERR_NO_ROUTERS_AVAILABLE",ERR_CONNECTION_NOT_MULTIPLEXED:"ERR_CONNECTION_NOT_MULTIPLEXED",ERR_NO_DIAL_TOKENS:"ERR_NO_DIAL_TOKENS",ERR_KEYCHAIN_REQUIRED:"ERR_KEYCHAIN_REQUIRED",ERR_INVALID_CMS:"ERR_INVALID_CMS",ERR_MISSING_KEYS:"ERR_MISSING_KEYS",ERR_NO_KEY:"ERR_NO_KEY",ERR_INVALID_KEY_NAME:"ERR_INVALID_KEY_NAME",ERR_INVALID_KEY_TYPE:"ERR_INVALID_KEY_TYPE",ERR_KEY_ALREADY_EXISTS:"ERR_KEY_ALREADY_EXISTS",ERR_INVALID_KEY_SIZE:"ERR_INVALID_KEY_SIZE",ERR_KEY_NOT_FOUND:"ERR_KEY_NOT_FOUND",ERR_OLD_KEY_NAME_INVALID:"ERR_OLD_KEY_NAME_INVALID",ERR_NEW_KEY_NAME_INVALID:"ERR_NEW_KEY_NAME_INVALID",ERR_PASSWORD_REQUIRED:"ERR_PASSWORD_REQUIRED",ERR_PEM_REQUIRED:"ERR_PEM_REQUIRED",ERR_CANNOT_READ_KEY:"ERR_CANNOT_READ_KEY",ERR_MISSING_PRIVATE_KEY:"ERR_MISSING_PRIVATE_KEY",ERR_INVALID_OLD_PASS_TYPE:"ERR_INVALID_OLD_PASS_TYPE",ERR_INVALID_NEW_PASS_TYPE:"ERR_INVALID_NEW_PASS_TYPE",ERR_INVALID_PASS_LENGTH:"ERR_INVALID_PASS_LENGTH",ERR_NOT_IMPLEMENTED:"ERR_NOT_IMPLEMENTED",ERR_WRONG_PING_ACK:"ERR_WRONG_PING_ACK"}});var Fre=m((p5t,Ure)=>{f();"use strict";var n1=Br(),qre=n1.Reader,MBe=n1.Writer,Vr=n1.util,Gg=n1.roots["libp2p-envelope"]||(n1.roots["libp2p-envelope"]={});Gg.Envelope=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.publicKey=Vr.newBuffer([]),r.prototype.payloadType=Vr.newBuffer([]),r.prototype.payload=Vr.newBuffer([]),r.prototype.signature=Vr.newBuffer([]),r.encode=function(t,i){return i||(i=MBe.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&i.uint32(10).bytes(t.publicKey),t.payloadType!=null&&Object.hasOwnProperty.call(t,"payloadType")&&i.uint32(18).bytes(t.payloadType),t.payload!=null&&Object.hasOwnProperty.call(t,"payload")&&i.uint32(26).bytes(t.payload),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&i.uint32(42).bytes(t.signature),i},r.decode=function(t,i){t instanceof qre||(t=qre.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Gg.Envelope;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.publicKey=t.bytes();break;case 2:s.payloadType=t.bytes();break;case 3:s.payload=t.bytes();break;case 5:s.signature=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Gg.Envelope)return t;var i=new Gg.Envelope;return t.publicKey!=null&&(typeof t.publicKey=="string"?Vr.base64.decode(t.publicKey,i.publicKey=Vr.newBuffer(Vr.base64.length(t.publicKey)),0):t.publicKey.length&&(i.publicKey=t.publicKey)),t.payloadType!=null&&(typeof t.payloadType=="string"?Vr.base64.decode(t.payloadType,i.payloadType=Vr.newBuffer(Vr.base64.length(t.payloadType)),0):t.payloadType.length&&(i.payloadType=t.payloadType)),t.payload!=null&&(typeof t.payload=="string"?Vr.base64.decode(t.payload,i.payload=Vr.newBuffer(Vr.base64.length(t.payload)),0):t.payload.length&&(i.payload=t.payload)),t.signature!=null&&(typeof t.signature=="string"?Vr.base64.decode(t.signature,i.signature=Vr.newBuffer(Vr.base64.length(t.signature)),0):t.signature.length&&(i.signature=t.signature)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=Vr.newBuffer(n.publicKey))),i.bytes===String?n.payloadType="":(n.payloadType=[],i.bytes!==Array&&(n.payloadType=Vr.newBuffer(n.payloadType))),i.bytes===String?n.payload="":(n.payload=[],i.bytes!==Array&&(n.payload=Vr.newBuffer(n.payload))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=Vr.newBuffer(n.signature)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?Vr.base64.encode(t.publicKey,0,t.publicKey.length):i.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.payloadType!=null&&t.hasOwnProperty("payloadType")&&(n.payloadType=i.bytes===String?Vr.base64.encode(t.payloadType,0,t.payloadType.length):i.bytes===Array?Array.prototype.slice.call(t.payloadType):t.payloadType),t.payload!=null&&t.hasOwnProperty("payload")&&(n.payload=i.bytes===String?Vr.base64.encode(t.payload,0,t.payload.length):i.bytes===Array?Array.prototype.slice.call(t.payload):t.payload),t.signature!=null&&t.hasOwnProperty("signature")&&(n.signature=i.bytes===String?Vr.base64.encode(t.signature,0,t.signature.length):i.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,n1.util.toJSONOptions)},r}();Ure.exports=Gg});var Wg=m((y5t,zre)=>{f();"use strict";var jBe=br(),{concat:qBe}=(Si(),Pn),{fromString:UBe}=(ct(),Qr),FBe=X4(),KBe=ot(),aI=Wn(),{equals:tw}=(hi(),dn),{codes:VBe}=wr(),{Envelope:Kre}=Fre(),sf=class{constructor({peerId:e,payloadType:t,payload:i,signature:n}){this.peerId=e,this.payloadType=t,this.payload=i,this.signature=n,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;let e=FBe.marshalPublicKey(this.peerId.pubKey);return this._marshal=Kre.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return tw(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&tw(this.payloadType,e.payloadType)&&tw(this.payload,e.payload)&&tw(this.signature,e.signature)}validate(e){let t=Vre(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(t,this.signature)}},Vre=(r,e,t)=>{let i=UBe(r),n=aI.encode(i.byteLength),s=aI.encode(e.length),o=aI.encode(t.length);return qBe([new Uint8Array(n),i,new Uint8Array(s),e,new Uint8Array(o),t])};sf.createFromProtobuf=async r=>{let e=Kre.decode(r),t=await KBe.createFromPubKey(e.publicKey);return new sf({peerId:t,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};sf.seal=async(r,e)=>{let t=r.domain,i=r.codec,n=r.marshal(),s=Vre(t,i,n),o=await e.privKey.sign(s);return new sf({peerId:e,payloadType:i,payload:n,signature:o})};sf.openAndCertify=async(r,e)=>{let t=await sf.createFromProtobuf(r);if(!await t.validate(e))throw jBe(new Error("envelope signature is not valid for the given domain"),VBe.ERR_SIGNATURE_NOT_VALID);return t};zre.exports=sf});var pI=m((Eu,Gre)=>{f();"use strict";var zBe=Eu&&Eu.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),HBe=Eu&&Eu.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Hre=Eu&&Eu.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&zBe(e,r,t);return HBe(e,r),e},qn=Eu&&Eu.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(l){try{u(i.next(l))}catch(d){o(d)}}function c(l){try{u(i.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):n(l.value).then(a,c)}u((i=i.apply(r,e||[])).next())})},cI=Hre(nre()),$Be=fre(),uI=hre(),kt=Hre(tf()),GBe=gre(),rw=Jx(),Ii=Z0(),lI=Ore(),WBe=Nre(),$re=Lre(),fI=ot(),YBe=Wg(),dI=tf(),hI=class extends cI.default{constructor(e,t={}){var i;let n=[kt.GossipsubIDv11,kt.GossipsubIDv10],s=Object.assign(Object.assign({gossipIncoming:!0,fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:kt.GossipsubD,Dlo:kt.GossipsubDlo,Dhi:kt.GossipsubDhi,Dscore:kt.GossipsubDscore,Dout:kt.GossipsubDout,Dlazy:kt.GossipsubDlazy,heartbeatInterval:kt.GossipsubHeartbeatInterval,fanoutTTL:kt.GossipsubFanoutTTL,mcacheLength:kt.GossipsubHistoryLength,mcacheGossip:kt.GossipsubHistoryGossip,seenTTL:kt.GossipsubSeenTTL},t),{scoreParams:lI.createPeerScoreParams(t.scoreParams),scoreThresholds:lI.createPeerScoreThresholds(t.scoreThresholds)});s.fallbackToFloodsub&&n.push(kt.FloodsubID);super(Object.assign({debugName:"libp2p:gossipsub",multicodecs:n,libp2p:e},s));this._options=s,this.direct=new Set(s.directPeers.map(o=>o.id.toB58String())),this.acceptFromWhitelist=new Map,s.directPeers.forEach(o=>{e.peerStore.addressBook.add(o.id,o.addrs)}),this.seenCache=new $re.SimpleTimeCache({validityMs:s.seenTTL}),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.messageCache=t.messageCache||new $Be.MessageCache(s.mcacheGossip,s.mcacheLength),this.getFastMsgIdStr=(i=t.fastMsgIdFn)!==null&&i!==void 0?i:void 0,this.fastMsgIdCache=t.fastMsgIdFn?new $re.SimpleTimeCache({validityMs:s.seenTTL}):void 0,this.heartbeat=new GBe.Heartbeat(this),this.heartbeatTicks=0,this.gossipTracer=new WBe.IWantTracer,this._libp2p=e,this.score=new lI.PeerScore(this._options.scoreParams,e.connectionManager)}_decodeRpc(e){return uI.RPC.decode(e)}_encodeRpc(e){return uI.RPC.encode(e).finish()}_addPeer(e,t){let i=super._addPeer(e,t);this.score.addPeer(e.toB58String());let n=!1;for(let s of this._libp2p.connectionManager.getAll(e))if(s.stat.direction==="outbound"&&Array.from(s.registry.values()).some(o=>t===o.protocol)){n=!0;break}return this.outbound.set(i.id.toB58String(),n),i}_removePeer(e){let t=super._removePeer(e),i=e.toB58String();for(let n of this.mesh.values())n.delete(i);for(let n of this.fanout.values())n.delete(i);return this.gossip.delete(i),this.control.delete(i),this.outbound.delete(i),this.score.removePeer(i),this.acceptFromWhitelist.delete(i),t}_processRpc(e,t,i){let n=Object.create(null,{_processRpc:{get:()=>super._processRpc}});return qn(this,void 0,void 0,function*(){return(yield n._processRpc.call(this,e,t,i))?(i.control&&(yield this._processRpcControlMessage(e,i.control)),!0):!1})}_processRpcControlMessage(e,t){return qn(this,void 0,void 0,function*(){if(!t)return;let i=t.ihave?this._handleIHave(e,t.ihave):[],n=t.iwant?this._handleIWant(e,t.iwant):[],s=t.graft?yield this._handleGraft(e,t.graft):[];if(t.prune&&this._handlePrune(e,t.prune),!i.length&&!n.length&&!s.length)return;let o=Ii.createGossipRpc(n,{iwant:i,prune:s});this._sendRpc(e,o)})}_processRpcMessage(e){let t=Object.create(null,{_processRpcMessage:{get:()=>super._processRpcMessage}});return qn(this,void 0,void 0,function*(){let i;if(this.getFastMsgIdStr&&this.fastMsgIdCache){let n=yield this.getFastMsgIdStr(e);if(i=this.fastMsgIdCache.get(n),i!==void 0){this.score.duplicateMessage(e,i);return}i=Ii.messageIdToString(yield this.getMsgId(e)),this.fastMsgIdCache.put(n,i)}else if(i=Ii.messageIdToString(yield this.getMsgId(e)),this.seenCache.has(i)){this.score.duplicateMessage(e,i);return}this.seenCache.put(i),yield this.score.validateMessage(i),yield t._processRpcMessage.call(this,e)})}_acceptFrom(e){if(this.direct.has(e))return!0;let t=Date.now(),i=this.acceptFromWhitelist.get(e);if(i&&i.messagesAccepted<dI.ACCEPT_FROM_WHITELIST_MAX_MESSAGES&&i.acceptUntil>=t)return i.messagesAccepted+=1,!0;let n=this.score.score(e);return n>=dI.ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:t+dI.ACCEPT_FROM_WHITELIST_DURATION_MS}):this.acceptFromWhitelist.delete(e),n>=this._options.scoreThresholds.graylistThreshold}validate(e){let t=Object.create(null,{validate:{get:()=>super.validate}});return qn(this,void 0,void 0,function*(){try{yield t.validate.call(this,e)}catch(i){let n=yield this.getCanonicalMsgIdStr(e);throw this.score.rejectMessage(e,n,i.code),this.gossipTracer.rejectMessage(n,i.code),i}})}_handleIHave(e,t){if(!t.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,i),[];let n=(this.peerhave.get(e)||0)+1;if(this.peerhave.set(e,n),n>kt.GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,n),[];let s=this.iasked.get(e)||0;if(s>=kt.GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),[];let o=new Map;if(t.forEach(({topicID:u,messageIDs:l})=>{!u||!l||!this.mesh.has(u)||l.forEach(d=>{let h=Ii.messageIdToString(d);this.seenCache.has(h)||o.set(h,d)})}),!o.size)return[];let a=o.size;a+s>kt.GossipsubMaxIHaveLength&&(a=kt.GossipsubMaxIHaveLength-s),this.log("IHAVE: Asking for %d out of %d messages from %s",a,o.size,e);let c=Array.from(o.values());return Ii.shuffle(c),c=c.slice(0,a),this.iasked.set(e,s+a),this.gossipTracer.addPromise(e,c),[{messageIDs:c}]}_handleIWant(e,t){if(!t.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,i),[];let n=new Map;return t.forEach(({messageIDs:s})=>{s&&s.forEach(o=>{let a=Ii.messageIdToString(o),[c,u]=this.messageCache.getForPeer(a,e);if(!!c){if(u>kt.GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,o);return}n.set(a,c)}})}),n.size?(this.log("IWANT: Sending %d messages to %s",n.size,e),Array.from(n.values()).map(cI.utils.normalizeOutRpcMessage)):[]}_handleGraft(e,t){return qn(this,void 0,void 0,function*(){let i=[],n=this.score.score(e),s=this._now(),o=this._options.doPX;return t.forEach(({topicID:a})=>{var c;if(!a)return;let u=this.mesh.get(a);if(!u){o=!1;return}if(u.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),i.push(a),o=!1;return}let l=(c=this.backoff.get(a))===null||c===void 0?void 0:c.get(e);if(typeof l=="number"&&s<l){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1),o=!1;let d=l+kt.GossipsubGraftFloodThreshold-kt.GossipsubPruneBackoff;s<d&&this.score.addPenalty(e,1),this._addBackoff(e,a),i.push(a);return}if(n<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,n,a),i.push(a),o=!1,this._addBackoff(e,a);return}if(u.size>=this._options.Dhi&&!this.outbound.get(e)){i.push(a),this._addBackoff(e,a);return}this.log("GRAFT: Add mesh link from %s in %s",e,a),this.score.graft(e,a),u.add(e)}),i.length?Promise.all(i.map(a=>this._makePrune(e,a,o))):[]})}_handlePrune(e,t){let i=this.score.score(e);t.forEach(({topicID:n,backoff:s,peers:o})=>{if(!n)return;let a=this.mesh.get(n);if(!!a&&(this.log("PRUNE: Remove mesh link to %s in %s",e,n),this.score.prune(e,n),a.delete(e),typeof s=="number"&&s>0?this._doAddBackoff(e,n,s*1e3):this._addBackoff(e,n),o&&o.length)){if(i<this._options.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,i,n);return}this._pxConnect(o)}})}_addBackoff(e,t){this._doAddBackoff(e,t,kt.GossipsubPruneBackoff)}_doAddBackoff(e,t,i){let n=this.backoff.get(t);n||(n=new Map,this.backoff.set(t,n));let s=this._now()+i;(n.get(e)||0)<s&&n.set(e,s)}_applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,t)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",t,e),this.score.addPenalty(t,e)})}_clearBackoff(){if(this.heartbeatTicks%kt.GossipsubPruneBackoffTicks!=0)return;let e=this._now();this.backoff.forEach((t,i)=>{t.forEach((n,s)=>{n<e&&t.delete(s)}),t.size===0&&this.backoff.delete(i)})}_directConnect(){if(this.heartbeatTicks%kt.GossipsubDirectConnectTicks!=0)return;let e=[];this.direct.forEach(t=>{let i=this.peers.get(t);(!i||!i.isWritable)&&e.push(t)}),e.length&&e.forEach(t=>{this._connect(t)})}_pxConnect(e){return qn(this,void 0,void 0,function*(){e.length>kt.GossipsubPrunePeers&&(Ii.shuffle(e),e=e.slice(0,kt.GossipsubPrunePeers));let t=[];yield Promise.all(e.map(i=>qn(this,void 0,void 0,function*(){if(!i.peerID)return;let s=fI.createFromBytes(i.peerID).toB58String();if(!this.peers.has(s)){if(!i.signedPeerRecord){t.push(s);return}try{let o=yield YBe.openAndCertify(i.signedPeerRecord,"libp2p-peer-record"),a=o.peerId.toB58String();if(s!==a){this.log("bogus peer record obtained through px: peer ID %s doesn't match expected peer %s",a,s);return}if(!this._libp2p.peerStore.addressBook.consumePeerRecord(o)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}t.push(s)}catch(o){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}}))),!!t.length&&t.forEach(i=>this._connect(i))})}start(){let e=Object.create(null,{start:{get:()=>super.start}});return qn(this,void 0,void 0,function*(){yield e.start.call(this),this.heartbeat.start(),this.score.start(),this._directPeerInitial=setTimeout(()=>{this.direct.forEach(t=>{this._connect(t)})},kt.GossipsubDirectConnectInitialDelay)})}stop(){let e=Object.create(null,{stop:{get:()=>super.stop}});return qn(this,void 0,void 0,function*(){yield e.stop.call(this),this.heartbeat.stop(),this.score.stop(),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),clearTimeout(this._directPeerInitial)})}_connect(e){this.log("Initiating connection with %s",e),this._libp2p.dialProtocol(fI.createFromB58String(e),this.multicodecs)}subscribe(e){super.subscribe(e),this.join(e)}unsubscribe(e){super.unsubscribe(e),this.leave(e)}join(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("JOIN %s",e);let t=this.fanout.get(e);if(t)t.forEach(i=>{this.score.score(i)<0&&t.delete(i)}),t.size<this._options.D&&rw.getGossipPeers(this,e,this._options.D-t.size,i=>!t.has(i)&&!this.direct.has(i)&&this.score.score(i)>=0).forEach(i=>t.add(i)),this.mesh.set(e,t),this.fanout.delete(e),this.lastpub.delete(e);else{let i=rw.getGossipPeers(this,e,this._options.D,n=>!this.direct.has(n)&&this.score.score(n)>=0);this.mesh.set(e,i)}this.mesh.get(e).forEach(i=>{this.log("JOIN: Add mesh link to %s in %s",i,e),this._sendGraft(i,e)})}leave(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e);let t=this.mesh.get(e);t&&(t.forEach(i=>{this.log("LEAVE: Remove mesh link to %s in %s",i,e),this._sendPrune(i,e)}),this.mesh.delete(e))}getCanonicalMsgIdStr(e){var t,i;return qn(this,void 0,void 0,function*(){return this.fastMsgIdCache&&this.getFastMsgIdStr?(i=(t=this.getCachedMsgIdStr(e))!==null&&t!==void 0?t:this.fastMsgIdCache.get(this.getFastMsgIdStr(e)))!==null&&i!==void 0?i:Ii.messageIdToString(yield this.getMsgId(e)):Ii.messageIdToString(yield this.getMsgId(e))})}getCachedMsgIdStr(e){}_publish(e){return qn(this,void 0,void 0,function*(){let t=yield this.getCanonicalMsgIdStr(e);e.receivedFrom!==this.peerId.toB58String()&&(this.score.deliverMessage(e,t),this.gossipTracer.deliverMessage(t)),this.seenCache.put(t),this.messageCache.put(e,t);let i=new Set;e.topicIDs.forEach(s=>{let o=this.topics.get(s);if(!!o)if(this._options.floodPublish&&e.from===this.peerId.toB58String())o.forEach(a=>{(this.direct.has(a)||this.score.score(a)>=this._options.scoreThresholds.publishThreshold)&&i.add(a)});else{this.direct.forEach(c=>{i.add(c)}),o.forEach(c=>{let u=this.score.score(c),l=this.peers.get(c);!l||l.protocol===kt.FloodsubID&&u>=this._options.scoreThresholds.publishThreshold&&i.add(c)});let a=this.mesh.get(s);if(!a||!a.size){if(a=this.fanout.get(s),!a){let c=rw.getGossipPeers(this,s,this._options.D,u=>this.score.score(u)>=this._options.scoreThresholds.publishThreshold);c.size>0?(a=c,this.fanout.set(s,c)):a=new Set}this.lastpub.set(s,this._now())}a.forEach(c=>{i.add(c)})}});let n=Ii.createGossipRpc([cI.utils.normalizeOutRpcMessage(e)]);i.forEach(s=>{s!==e.from&&this._sendRpc(s,n)})})}_sendGraft(e,t){let i=[{topicID:t}],n=Ii.createGossipRpc([],{graft:i});this._sendRpc(e,n)}_sendPrune(e,t){return qn(this,void 0,void 0,function*(){let i=[yield this._makePrune(e,t,this._options.doPX)],n=Ii.createGossipRpc([],{prune:i});this._sendRpc(e,n)})}_sendRpc(e,t){let i=this.peers.get(e);if(!i||!i.isWritable)return;let n=this.control.get(e);n&&(this._piggybackControl(e,t,n),this.control.delete(e));let s=this.gossip.get(e);s&&(this._piggybackGossip(e,t,s),this.gossip.delete(e)),i.write(uI.RPC.encode(t).finish())}_piggybackControl(e,t,i){let n=(i.graft||[]).filter(({topicID:o})=>(o&&this.mesh.get(o)||new Set).has(e)),s=(i.prune||[]).filter(({topicID:o})=>!(o&&this.mesh.get(o)||new Set).has(e));!n.length&&!s.length||(t.control?(t.control.graft=t.control.graft&&t.control.graft.concat(n),t.control.prune=t.control.prune&&t.control.prune.concat(s)):t.control={ihave:[],iwant:[],graft:n,prune:s})}_piggybackGossip(e,t,i){t.control||(t.control={ihave:[],iwant:[],graft:[],prune:[]}),t.control.ihave=i}_sendGraftPrune(e,t,i){return qn(this,void 0,void 0,function*(){let n=this._options.doPX;for(let[s,o]of e){let a=o.map(d=>({topicID:d})),c=[],u=t.get(s);u&&(c=yield Promise.all(u.map(d=>this._makePrune(s,d,n&&!i.get(s)))),t.delete(s));let l=Ii.createGossipRpc([],{graft:a,prune:c});this._sendRpc(s,l)}for(let[s,o]of t){let a=yield Promise.all(o.map(u=>this._makePrune(s,u,n&&!i.get(s)))),c=Ii.createGossipRpc([],{prune:a});this._sendRpc(s,c)}})}_emitGossip(e,t){let i=this.messageCache.getGossipIDs(e);if(!i.length)return;Ii.shuffle(i),i.length>kt.GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",i.length);let n=[],s=this.topics.get(e);if(!s)return;s.forEach(c=>{let u=this.peers.get(c);!u||!t.has(c)&&!this.direct.has(c)&&Ii.hasGossipProtocol(u.protocol)&&this.score.score(c)>=this._options.scoreThresholds.gossipThreshold&&n.push(c)});let o=this._options.Dlazy,a=kt.GossipsubGossipFactor*n.length;a>o&&(o=a),o>n.length?o=n.length:Ii.shuffle(n),n.slice(0,o).forEach(c=>{let u=i;i.length>kt.GossipsubMaxIHaveLength&&(u=Ii.shuffle(u.slice()).slice(0,kt.GossipsubMaxIHaveLength)),this._pushGossip(c,{topicID:e,messageIDs:u})})}_flush(){for(let[e,t]of this.gossip.entries()){this.gossip.delete(e);let i=Ii.createGossipRpc([],{ihave:t});this._sendRpc(e,i)}for(let[e,t]of this.control.entries()){this.control.delete(e);let i=Ii.createGossipRpc([],{graft:t.graft,prune:t.prune});this._sendRpc(e,i)}}_pushGossip(e,t){this.log("Add gossip to %s",e);let i=this.gossip.get(e)||[];this.gossip.set(e,i.concat(t))}_now(){return Date.now()}_makePrune(e,t,i){return qn(this,void 0,void 0,function*(){if(this.peers.get(e).protocol===kt.GossipsubIDv10)return{topicID:t,peers:[]};let n=kt.GossipsubPruneBackoff/1e3;if(!i)return{topicID:t,peers:[],backoff:n};let s=rw.getGossipPeers(this,t,kt.GossipsubPrunePeers,a=>a!==e&&this.score.score(a)>=0),o=yield Promise.all(Array.from(s).map(a=>qn(this,void 0,void 0,function*(){let c=fI.createFromB58String(a);return{peerID:c.toBytes(),signedPeerRecord:yield this._libp2p.peerStore.addressBook.getRawEnvelope(c)}})));return{topicID:t,peers:o,backoff:n}})}};hI.multicodec=kt.GossipsubIDv11;Gre.exports=hI});var tie=m((m5t,eie)=>{f();"use strict";var Yre=ot(),{base58btc:XBe}=(di(),Uo),{default:QBe}=$o(),Xre=Za(),Qre=le(),of=Qre("libp2p-delegated-peer-routing");of.error=Qre("libp2p-delegated-peer-routing:error");var Zre=3e4,ZBe=4,Jre=class{constructor(e){if(e==null)throw new Error("missing ipfs http client");this._client=e,this._httpQueue=new QBe({concurrency:ZBe});let{protocol:t,host:i,port:n}=e.getEndpointConfig();of(`enabled DelegatedPeerRouting via ${t}://${i}:${n}`)}async findPeer(e,t={}){let i=e;Yre.isPeerId(i)&&(i=e.toB58String()),of("findPeer starts: "+e),t.timeout=t.timeout||Zre;try{return await this._httpQueue.add(async()=>{let{addrs:n}=await this._client.dht.findPeer(i,{timeout:t.timeout});return{id:e,multiaddrs:n}})}catch(n){if(n.message.includes("not found"))return;throw n}finally{of("findPeer finished: "+e)}}async*getClosestPeers(e,t={}){let i=XBe.encode(e).substring(1);of("getClosestPeers starts:",i),t.timeout=t.timeout||Zre;let n=Xre(),s=Xre();this._httpQueue.add(()=>(n.resolve(),s.promise));try{await n.promise;for await(let o of this._client.dht.query(i,{timeout:t.timeout}))switch(o.type){case 1:for(let a of o.responses)yield{id:Yre.parse(a.id),multiaddrs:a.addrs};break;default:of("getClosestPeers unhandled response",o)}}catch(o){throw of.error("getClosestPeers errored:",o),o}finally{s.resolve(),of("getClosestPeers finished:",i)}}};eie.exports=Jre});var aie=m((b5t,oie)=>{f();"use strict";var rie=le(),JBe=ot(),eLe=ts(),{default:iie}=$o(),nie=Za(),Jd=rie("libp2p-delegated-content-routing");Jd.error=rie("libp2p-delegated-content-routing:error");var tLe=3e4,rLe=4,sie=class{constructor(e,t){if(e==null)throw new Error("missing self peerId");if(t==null)throw new Error("missing ipfs http client");this._client=t,this.peerId=e;let i={concurrency:rLe};this._httpQueue=new iie(i),this._httpQueueRefs=new iie(Object.assign({},i,{concurrency:2}));let{protocol:n,host:s,port:o}=t.getEndpointConfig();Jd(`enabled DelegatedContentRouting via ${n}://${s}:${o}`)}async*findProviders(e,t={}){Jd(`findProviders starts: ${e}`),t.timeout=t.timeout||tLe;let i=0,n=nie(),s=nie();this._httpQueue.add(()=>(n.resolve(),s.promise));try{await n.promise;for await(let{id:o,addrs:a}of this._client.dht.findProvs(e,{numProviders:t.numProviders,timeout:t.timeout}))yield{id:JBe.parse(o),multiaddrs:a},i++}catch(o){throw Jd.error("findProviders errored:",o),o}finally{s.resolve(),Jd(`findProviders finished: ${e} found ${i} providers`)}}async provide(e){Jd(`provide starts: ${e}`),await this._httpQueueRefs.add(async()=>{await this._client.block.stat(e),await eLe(this._client.dht.provide(e))}),Jd(`provide finished: ${e}`)}};oie.exports=sie});var rh=m((D5t,yie)=>{f();"use strict";function pie(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function pLe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return pie(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),pie(new n,t)}}yie.exports=pLe});var em=m((Nvt,Dne)=>{f();Dne.exports=r=>{if(r[Symbol.asyncIterator])return r;if(r.getReader)return async function*(){let e=r.getReader();try{for(;;){let{done:t,value:i}=await e.read();if(t)return;yield i}}finally{e.releaseLock()}}();throw new Error("unknown stream")}});var vI=m(()=>{f()});var EI=m((_xt,Ioe)=>{f();"use strict";var PLe=vp(),CLe=(r,e)=>({path:decodeURIComponent(new URL(r).pathname.split("/").pop()||""),content:OLe(r,e)});async function*OLe(r,e){yield*(await new PLe().get(r,e)).iterator()}Ioe.exports=CLe});var Poe=m(()=>{f()});var Ooe=m((lIt,Coe)=>{f();Coe.exports=typeof WebSocket=="undefined"?Poe():WebSocket});var Doe=m(mw=>{f();"use strict";Object.defineProperty(mw,"__esModule",{value:!0});var koe=class{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;let t={value:e,done:!1};if(this.pullQueue.length){let i=this.pullQueue.shift();i&&i.resolve(t)}else this.pushQueue.push(Promise.resolve(t)),this.highWaterMark!==void 0&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(let e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(let t of this.pullQueue)t.reject(e);this.pullQueue.length=0}else{let t=Promise.reject(e);t.catch(()=>{}),this.pushQueue.push(t)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:e=>{let t=this.pushQueue.shift();return t?(this.lowWaterMark!==void 0&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),t):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((i,n)=>{this.pullQueue.push({resolve:i,reject:n})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}},SI=class{constructor(e,{highWaterMark:t=100,lowWaterMark:i=1}={}){let n=new koe;n.highWaterMark=t,n.lowWaterMark=i,n.removeCallback=e({push:s=>n.push(s),stop:()=>n.stop(),fail:s=>n.fail(s),on:(s,o)=>{n.eventHandlers[s]=o}})||(()=>{}),this[Symbol.asyncIterator]=()=>n[Symbol.asyncIterator](),Object.freeze(this)}};mw.EventIterator=SI;mw.default=SI});var Noe=m(tm=>{f();"use strict";Object.defineProperty(tm,"__esModule",{value:!0});var RI=Doe();tm.EventIterator=RI.EventIterator;function LLe(r,e,t){return new RI.EventIterator(({push:i})=>(this.addEventListener(r,i,e),()=>this.removeEventListener(r,i,e)),t)}tm.subscribe=LLe;tm.default=RI.EventIterator});var Loe=m((hIt,Boe)=>{f();var{Buffer:MLe}=ci(),{EventIterator:jLe}=Noe();function qLe(r){return r instanceof ArrayBuffer||r!=null&&r.constructor!=null&&r.constructor.name==="ArrayBuffer"&&typeof r.byteLength=="number"}Boe.exports=r=>{let e=r.removeEventListener||r.removeListener,t=async function*(){let s=new jLe(({push:o,stop:a,fail:c})=>(r.addEventListener("message",o),r.addEventListener("error",c),r.addEventListener("close",a),()=>{e.call(r,"message",o),e.call(r,"error",c),e.call(r,"close",a)}),{highWaterMark:1/0});for await(let{data:o}of s)yield qLe(o)?MLe.from(o):o}(),i=r.readyState===1,n;return r.addEventListener("open",()=>{i=!0,n=null}),r.addEventListener("close",()=>{i=!1,n=null}),r.addEventListener("error",s=>{i||(n=s)}),t.connected=()=>new Promise((s,o)=>{if(i)return s();if(n)return o(n);let a=l=>{e.call(r,"open",c),e.call(r,"error",u),l()},c=()=>a(s),u=l=>a(()=>o(l));r.addEventListener("open",c),r.addEventListener("error",u)}),t}});var joe=m((pIt,Moe)=>{f();Moe.exports=async r=>{if(r.readyState>=2)throw new Error("socket closed");if(r.readyState!==1)return new Promise((e,t)=>{let i=r&&(r.removeEventListener||r.removeListener);function n(){typeof i=="function"&&(i.call(r,"open",s),i.call(r,"error",o))}function s(){n(),e()}function o(a){n(),t(a)}r.addEventListener("open",s),r.addEventListener("error",o)})}});var Uoe=m((yIt,qoe)=>{f();var ULe=joe();qoe.exports=(r,e)=>(e=e||{},e.closeOnEnd=e.closeOnEnd!==!1,async t=>{for await(let i of t){try{await ULe(r)}catch(n){if(n.message==="socket closed")break;throw n}r.send(i)}if(e.closeOnEnd&&r.readyState<=1)return new Promise((i,n)=>{r.addEventListener("close",s=>{if(s.wasClean||s.code===1006)i();else{let o=Object.assign(new Error("ws error"),{event:s});n(o)}}),setTimeout(()=>r.close())})})});var Koe=m((gIt,Foe)=>{f();var FLe=Loe(),KLe=Uoe();Foe.exports=(r,e)=>{e=e||{},e.binaryType?r.binaryType=e.binaryType:e.binary&&(r.binaryType="arraybuffer");let t={sink:KLe(r,e),source:FLe(r,e),connected:()=>t.source.connected()};return t}});var zoe=m((mIt,Voe)=>{f();var{relative:VLe}=r4(),zLe={http:"ws",https:"wss"},HLe="ws";Voe.exports=(r,e)=>VLe(r,e,zLe,HLe)});var Hoe=m((bIt,bw)=>{f();"use strict";var $Le=Ooe(),GLe=Koe(),WLe=zoe();bw.exports=function(r,e={}){let t=typeof window=="undefined"?{}:window.location,i=WLe(r,t),n=new $Le(i,e.websocket),s=GLe(n,e);return s.remoteAddress=i,s.close=()=>new Promise((o,a)=>{n.addEventListener("close",o),n.close()}),s.destroy=()=>{n.terminate?n.terminate():n.close()},s.socket=n,s};bw.exports.connect=bw.exports});var Goe=m((wIt,$oe)=>{f();"use strict";$oe.exports=function(){throw new Error("WebSocket Servers can not be created in the browser!")}});var AI=m(ih=>{f();"use strict";ih.CODE_P2P=421;ih.CODE_CIRCUIT=290;ih.CODE_TCP=6;ih.CODE_WS=477;ih.CODE_WSS=478;ih.CLOSE_TIMEOUT=2e3});var Xoe=m((vIt,Yoe)=>{f();"use strict";function Woe(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function YLe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Woe(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Woe(new n,t)}}Yoe.exports=YLe});var xI=m(a1=>{f();"use strict";Object.defineProperty(a1,"__esModule",{value:!0});a1.isCorrect=a1.isInSubnet=void 0;function XLe(r){return this.subnetMask<r.subnetMask?!1:this.mask(r.subnetMask)===r.mask()}a1.isInSubnet=XLe;function QLe(r){return function(){return this.addressMinusSuffix!==this.correctForm()?!1:this.subnetMask===r&&!this.parsedSubnet?!0:this.parsedSubnet===String(this.subnetMask)}}a1.isCorrect=QLe});var II=m(mc=>{f();"use strict";Object.defineProperty(mc,"__esModule",{value:!0});mc.RE_SUBNET_STRING=mc.RE_ADDRESS=mc.GROUPS=mc.BITS=void 0;mc.BITS=32;mc.GROUPS=4;mc.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g;mc.RE_SUBNET_STRING=/\/\d{1,2}$/});var ww=m(c1=>{f();"use strict";var ZLe=c1&&c1.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(c1,"__esModule",{value:!0});c1.AddressError=void 0;var JLe=function(r){ZLe(e,r);function e(t,i){var n=r.call(this,t)||this;return n.name="AddressError",i!==null&&(n.parseMessage=i),n}return e}(Error);c1.AddressError=JLe});var TI=m((_w,Qoe)=>{f();(function(){var r,e=244837814094590,t=(e&16777215)==15715070;function i(_,E,P){_!=null&&(typeof _=="number"?this.fromNumber(_,E,P):E==null&&typeof _!="string"?this.fromString(_,256):this.fromString(_,E))}function n(){return new i(null)}function s(_,E,P,H,ue,me){for(;--me>=0;){var Pe=E*this[_++]+P[H]+ue;ue=Math.floor(Pe/67108864),P[H++]=Pe&67108863}return ue}function o(_,E,P,H,ue,me){for(var Pe=E&32767,Me=E>>15;--me>=0;){var Pr=this[_]&32767,Fi=this[_++]>>15,Bs=Me*Pr+Fi*Pe;Pr=Pe*Pr+((Bs&32767)<<15)+P[H]+(ue&1073741823),ue=(Pr>>>30)+(Bs>>>15)+Me*Fi+(ue>>>30),P[H++]=Pr&1073741823}return ue}function a(_,E,P,H,ue,me){for(var Pe=E&16383,Me=E>>14;--me>=0;){var Pr=this[_]&16383,Fi=this[_++]>>14,Bs=Me*Pr+Fi*Pe;Pr=Pe*Pr+((Bs&16383)<<14)+P[H]+ue,ue=(Pr>>28)+(Bs>>14)+Me*Fi,P[H++]=Pr&268435455}return ue}var c=typeof navigator!="undefined";c&&t&&navigator.appName=="Microsoft Internet Explorer"?(i.prototype.am=o,r=30):c&&t&&navigator.appName!="Netscape"?(i.prototype.am=s,r=26):(i.prototype.am=a,r=28),i.prototype.DB=r,i.prototype.DM=(1<<r)-1,i.prototype.DV=1<<r;var u=52;i.prototype.FV=Math.pow(2,u),i.prototype.F1=u-r,i.prototype.F2=2*r-u;var l="0123456789abcdefghijklmnopqrstuvwxyz",d=new Array,h,p;for(h="0".charCodeAt(0),p=0;p<=9;++p)d[h++]=p;for(h="a".charCodeAt(0),p=10;p<36;++p)d[h++]=p;for(h="A".charCodeAt(0),p=10;p<36;++p)d[h++]=p;function y(_){return l.charAt(_)}function g(_,E){var P=d[_.charCodeAt(E)];return P??-1}function w(_){for(var E=this.t-1;E>=0;--E)_[E]=this[E];_.t=this.t,_.s=this.s}function b(_){this.t=1,this.s=_<0?-1:0,_>0?this[0]=_:_<-1?this[0]=_+this.DV:this.t=0}function v(_){var E=n();return E.fromInt(_),E}function A(_,E){var P;if(E==16)P=4;else if(E==8)P=3;else if(E==256)P=8;else if(E==2)P=1;else if(E==32)P=5;else if(E==4)P=2;else{this.fromRadix(_,E);return}this.t=0,this.s=0;for(var H=_.length,ue=!1,me=0;--H>=0;){var Pe=P==8?_[H]&255:g(_,H);if(Pe<0){_.charAt(H)=="-"&&(ue=!0);continue}ue=!1,me==0?this[this.t++]=Pe:me+P>this.DB?(this[this.t-1]|=(Pe&(1<<this.DB-me)-1)<<me,this[this.t++]=Pe>>this.DB-me):this[this.t-1]|=Pe<<me,me+=P,me>=this.DB&&(me-=this.DB)}P==8&&(_[0]&128)!=0&&(this.s=-1,me>0&&(this[this.t-1]|=(1<<this.DB-me)-1<<me)),this.clamp(),ue&&i.ZERO.subTo(this,this)}function k(){for(var _=this.s&this.DM;this.t>0&&this[this.t-1]==_;)--this.t}function C(_){if(this.s<0)return"-"+this.negate().toString(_);var E;if(_==16)E=4;else if(_==8)E=3;else if(_==2)E=1;else if(_==32)E=5;else if(_==4)E=2;else return this.toRadix(_);var P=(1<<E)-1,H,ue=!1,me="",Pe=this.t,Me=this.DB-Pe*this.DB%E;if(Pe-- >0)for(Me<this.DB&&(H=this[Pe]>>Me)>0&&(ue=!0,me=y(H));Pe>=0;)Me<E?(H=(this[Pe]&(1<<Me)-1)<<E-Me,H|=this[--Pe]>>(Me+=this.DB-E)):(H=this[Pe]>>(Me-=E)&P,Me<=0&&(Me+=this.DB,--Pe)),H>0&&(ue=!0),ue&&(me+=y(H));return ue?me:"0"}function T(){var _=n();return i.ZERO.subTo(this,_),_}function D(){return this.s<0?this.negate():this}function j(_){var E=this.s-_.s;if(E!=0)return E;var P=this.t;if(E=P-_.t,E!=0)return this.s<0?-E:E;for(;--P>=0;)if((E=this[P]-_[P])!=0)return E;return 0}function M(_){var E=1,P;return(P=_>>>16)!=0&&(_=P,E+=16),(P=_>>8)!=0&&(_=P,E+=8),(P=_>>4)!=0&&(_=P,E+=4),(P=_>>2)!=0&&(_=P,E+=2),(P=_>>1)!=0&&(_=P,E+=1),E}function se(){return this.t<=0?0:this.DB*(this.t-1)+M(this[this.t-1]^this.s&this.DM)}function ie(_,E){var P;for(P=this.t-1;P>=0;--P)E[P+_]=this[P];for(P=_-1;P>=0;--P)E[P]=0;E.t=this.t+_,E.s=this.s}function fe(_,E){for(var P=_;P<this.t;++P)E[P-_]=this[P];E.t=Math.max(this.t-_,0),E.s=this.s}function pe(_,E){var P=_%this.DB,H=this.DB-P,ue=(1<<H)-1,me=Math.floor(_/this.DB),Pe=this.s<<P&this.DM,Me;for(Me=this.t-1;Me>=0;--Me)E[Me+me+1]=this[Me]>>H|Pe,Pe=(this[Me]&ue)<<P;for(Me=me-1;Me>=0;--Me)E[Me]=0;E[me]=Pe,E.t=this.t+me+1,E.s=this.s,E.clamp()}function Le(_,E){E.s=this.s;var P=Math.floor(_/this.DB);if(P>=this.t){E.t=0;return}var H=_%this.DB,ue=this.DB-H,me=(1<<H)-1;E[0]=this[P]>>H;for(var Pe=P+1;Pe<this.t;++Pe)E[Pe-P-1]|=(this[Pe]&me)<<ue,E[Pe-P]=this[Pe]>>H;H>0&&(E[this.t-P-1]|=(this.s&me)<<ue),E.t=this.t-P,E.clamp()}function Re(_,E){for(var P=0,H=0,ue=Math.min(_.t,this.t);P<ue;)H+=this[P]-_[P],E[P++]=H&this.DM,H>>=this.DB;if(_.t<this.t){for(H-=_.s;P<this.t;)H+=this[P],E[P++]=H&this.DM,H>>=this.DB;H+=this.s}else{for(H+=this.s;P<_.t;)H-=_[P],E[P++]=H&this.DM,H>>=this.DB;H-=_.s}E.s=H<0?-1:0,H<-1?E[P++]=this.DV+H:H>0&&(E[P++]=H),E.t=P,E.clamp()}function De(_,E){var P=this.abs(),H=_.abs(),ue=P.t;for(E.t=ue+H.t;--ue>=0;)E[ue]=0;for(ue=0;ue<H.t;++ue)E[ue+P.t]=P.am(0,H[ue],E,ue,0,P.t);E.s=0,E.clamp(),this.s!=_.s&&i.ZERO.subTo(E,E)}function ne(_){for(var E=this.abs(),P=_.t=2*E.t;--P>=0;)_[P]=0;for(P=0;P<E.t-1;++P){var H=E.am(P,E[P],_,2*P,0,1);(_[P+E.t]+=E.am(P+1,2*E[P],_,2*P+1,H,E.t-P-1))>=E.DV&&(_[P+E.t]-=E.DV,_[P+E.t+1]=1)}_.t>0&&(_[_.t-1]+=E.am(P,E[P],_,2*P,0,1)),_.s=0,_.clamp()}function je(_,E,P){var H=_.abs();if(!(H.t<=0)){var ue=this.abs();if(ue.t<H.t){E!=null&&E.fromInt(0),P!=null&&this.copyTo(P);return}P==null&&(P=n());var me=n(),Pe=this.s,Me=_.s,Pr=this.DB-M(H[H.t-1]);Pr>0?(H.lShiftTo(Pr,me),ue.lShiftTo(Pr,P)):(H.copyTo(me),ue.copyTo(P));var Fi=me.t,Bs=me[Fi-1];if(Bs!=0){var ds=Bs*(1<<this.F1)+(Fi>1?me[Fi-2]>>this.F2:0),Dc=this.FV/ds,n3=(1<<this.F1)/ds,Lo=1<<this.F2,Mo=P.t,s3=Mo-Fi,ju=E??n();for(me.dlShiftTo(s3,ju),P.compareTo(ju)>=0&&(P[P.t++]=1,P.subTo(ju,P)),i.ONE.dlShiftTo(Fi,ju),ju.subTo(me,me);me.t<Fi;)me[me.t++]=0;for(;--s3>=0;){var P_=P[--Mo]==Bs?this.DM:Math.floor(P[Mo]*Dc+(P[Mo-1]+Lo)*n3);if((P[Mo]+=me.am(0,P_,P,s3,0,Fi))<P_)for(me.dlShiftTo(s3,ju),P.subTo(ju,P);P[Mo]<--P_;)P.subTo(ju,P)}E!=null&&(P.drShiftTo(Fi,E),Pe!=Me&&i.ZERO.subTo(E,E)),P.t=Fi,P.clamp(),Pr>0&&P.rShiftTo(Pr,P),Pe<0&&i.ZERO.subTo(P,P)}}}function ut(_){var E=n();return this.abs().divRemTo(_,null,E),this.s<0&&E.compareTo(i.ZERO)>0&&_.subTo(E,E),E}function Ye(_){this.m=_}function Xe(_){return _.s<0||_.compareTo(this.m)>=0?_.mod(this.m):_}function de(_){return _}function J(_){_.divRemTo(this.m,null,_)}function Ee(_,E,P){_.multiplyTo(E,P),this.reduce(P)}function qe(_,E){_.squareTo(E),this.reduce(E)}Ye.prototype.convert=Xe,Ye.prototype.revert=de,Ye.prototype.reduce=J,Ye.prototype.mulTo=Ee,Ye.prototype.sqrTo=qe;function ze(){if(this.t<1)return 0;var _=this[0];if((_&1)==0)return 0;var E=_&3;return E=E*(2-(_&15)*E)&15,E=E*(2-(_&255)*E)&255,E=E*(2-((_&65535)*E&65535))&65535,E=E*(2-_*E%this.DV)%this.DV,E>0?this.DV-E:-E}function Te(_){this.m=_,this.mp=_.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<_.DB-15)-1,this.mt2=2*_.t}function at(_){var E=n();return _.abs().dlShiftTo(this.m.t,E),E.divRemTo(this.m,null,E),_.s<0&&E.compareTo(i.ZERO)>0&&this.m.subTo(E,E),E}function I(_){var E=n();return _.copyTo(E),this.reduce(E),E}function O(_){for(;_.t<=this.mt2;)_[_.t++]=0;for(var E=0;E<this.m.t;++E){var P=_[E]&32767,H=P*this.mpl+((P*this.mph+(_[E]>>15)*this.mpl&this.um)<<15)&_.DM;for(P=E+this.m.t,_[P]+=this.m.am(0,H,_,E,0,this.m.t);_[P]>=_.DV;)_[P]-=_.DV,_[++P]++}_.clamp(),_.drShiftTo(this.m.t,_),_.compareTo(this.m)>=0&&_.subTo(this.m,_)}function N(_,E){_.squareTo(E),this.reduce(E)}function Y(_,E,P){_.multiplyTo(E,P),this.reduce(P)}Te.prototype.convert=at,Te.prototype.revert=I,Te.prototype.reduce=O,Te.prototype.mulTo=Y,Te.prototype.sqrTo=N;function F(){return(this.t>0?this[0]&1:this.s)==0}function W(_,E){if(_>4294967295||_<1)return i.ONE;var P=n(),H=n(),ue=E.convert(this),me=M(_)-1;for(ue.copyTo(P);--me>=0;)if(E.sqrTo(P,H),(_&1<<me)>0)E.mulTo(H,ue,P);else{var Pe=P;P=H,H=Pe}return E.revert(P)}function ee(_,E){var P;return _<256||E.isEven()?P=new Ye(E):P=new Te(E),this.exp(_,P)}i.prototype.copyTo=w,i.prototype.fromInt=b,i.prototype.fromString=A,i.prototype.clamp=k,i.prototype.dlShiftTo=ie,i.prototype.drShiftTo=fe,i.prototype.lShiftTo=pe,i.prototype.rShiftTo=Le,i.prototype.subTo=Re,i.prototype.multiplyTo=De,i.prototype.squareTo=ne,i.prototype.divRemTo=je,i.prototype.invDigit=ze,i.prototype.isEven=F,i.prototype.exp=W,i.prototype.toString=C,i.prototype.negate=T,i.prototype.abs=D,i.prototype.compareTo=j,i.prototype.bitLength=se,i.prototype.mod=ut,i.prototype.modPowInt=ee,i.ZERO=v(0),i.ONE=v(1);function V(){var _=n();return this.copyTo(_),_}function X(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function re(){return this.t==0?this.s:this[0]<<24>>24}function x(){return this.t==0?this.s:this[0]<<16>>16}function B(_){return Math.floor(Math.LN2*this.DB/Math.log(_))}function G(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Z(_){if(_==null&&(_=10),this.signum()==0||_<2||_>36)return"0";var E=this.chunkSize(_),P=Math.pow(_,E),H=v(P),ue=n(),me=n(),Pe="";for(this.divRemTo(H,ue,me);ue.signum()>0;)Pe=(P+me.intValue()).toString(_).substr(1)+Pe,ue.divRemTo(H,ue,me);return me.intValue().toString(_)+Pe}function he(_,E){this.fromInt(0),E==null&&(E=10);for(var P=this.chunkSize(E),H=Math.pow(E,P),ue=!1,me=0,Pe=0,Me=0;Me<_.length;++Me){var Pr=g(_,Me);if(Pr<0){_.charAt(Me)=="-"&&this.signum()==0&&(ue=!0);continue}Pe=E*Pe+Pr,++me>=P&&(this.dMultiply(H),this.dAddOffset(Pe,0),me=0,Pe=0)}me>0&&(this.dMultiply(Math.pow(E,me)),this.dAddOffset(Pe,0)),ue&&i.ZERO.subTo(this,this)}function Be(_,E,P){if(typeof E=="number")if(_<2)this.fromInt(1);else for(this.fromNumber(_,P),this.testBit(_-1)||this.bitwiseTo(i.ONE.shiftLeft(_-1),Nr,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(E);)this.dAddOffset(2,0),this.bitLength()>_&&this.subTo(i.ONE.shiftLeft(_-1),this);else{var H=new Array,ue=_&7;H.length=(_>>3)+1,E.nextBytes(H),ue>0?H[0]&=(1<<ue)-1:H[0]=0,this.fromString(H,256)}}function He(){var _=this.t,E=new Array;E[0]=this.s;var P=this.DB-_*this.DB%8,H,ue=0;if(_-- >0)for(P<this.DB&&(H=this[_]>>P)!=(this.s&this.DM)>>P&&(E[ue++]=H|this.s<<this.DB-P);_>=0;)P<8?(H=(this[_]&(1<<P)-1)<<8-P,H|=this[--_]>>(P+=this.DB-8)):(H=this[_]>>(P-=8)&255,P<=0&&(P+=this.DB,--_)),(H&128)!=0&&(H|=-256),ue==0&&(this.s&128)!=(H&128)&&++ue,(ue>0||H!=this.s)&&(E[ue++]=H);return E}function Fe(_){return this.compareTo(_)==0}function Ke(_){return this.compareTo(_)<0?this:_}function nt(_){return this.compareTo(_)>0?this:_}function Mt(_,E,P){var H,ue,me=Math.min(_.t,this.t);for(H=0;H<me;++H)P[H]=E(this[H],_[H]);if(_.t<this.t){for(ue=_.s&this.DM,H=me;H<this.t;++H)P[H]=E(this[H],ue);P.t=this.t}else{for(ue=this.s&this.DM,H=me;H<_.t;++H)P[H]=E(ue,_[H]);P.t=_.t}P.s=E(this.s,_.s),P.clamp()}function dt(_,E){return _&E}function _r(_){var E=n();return this.bitwiseTo(_,dt,E),E}function Nr(_,E){return _|E}function An(_){var E=n();return this.bitwiseTo(_,Nr,E),E}function mt(_,E){return _^E}function st(_){var E=n();return this.bitwiseTo(_,mt,E),E}function yr(_,E){return _&~E}function X3e(_){var E=n();return this.bitwiseTo(_,yr,E),E}function Q3e(){for(var _=n(),E=0;E<this.t;++E)_[E]=this.DM&~this[E];return _.t=this.t,_.s=~this.s,_}function Z3e(_){var E=n();return _<0?this.rShiftTo(-_,E):this.lShiftTo(_,E),E}function J3e(_){var E=n();return _<0?this.lShiftTo(-_,E):this.rShiftTo(_,E),E}function e4e(_){if(_==0)return-1;var E=0;return(_&65535)==0&&(_>>=16,E+=16),(_&255)==0&&(_>>=8,E+=8),(_&15)==0&&(_>>=4,E+=4),(_&3)==0&&(_>>=2,E+=2),(_&1)==0&&++E,E}function t4e(){for(var _=0;_<this.t;++_)if(this[_]!=0)return _*this.DB+e4e(this[_]);return this.s<0?this.t*this.DB:-1}function r4e(_){for(var E=0;_!=0;)_&=_-1,++E;return E}function i4e(){for(var _=0,E=this.s&this.DM,P=0;P<this.t;++P)_+=r4e(this[P]^E);return _}function n4e(_){var E=Math.floor(_/this.DB);return E>=this.t?this.s!=0:(this[E]&1<<_%this.DB)!=0}function s4e(_,E){var P=i.ONE.shiftLeft(_);return this.bitwiseTo(P,E,P),P}function o4e(_){return this.changeBit(_,Nr)}function a4e(_){return this.changeBit(_,yr)}function c4e(_){return this.changeBit(_,mt)}function u4e(_,E){for(var P=0,H=0,ue=Math.min(_.t,this.t);P<ue;)H+=this[P]+_[P],E[P++]=H&this.DM,H>>=this.DB;if(_.t<this.t){for(H+=_.s;P<this.t;)H+=this[P],E[P++]=H&this.DM,H>>=this.DB;H+=this.s}else{for(H+=this.s;P<_.t;)H+=_[P],E[P++]=H&this.DM,H>>=this.DB;H+=_.s}E.s=H<0?-1:0,H>0?E[P++]=H:H<-1&&(E[P++]=this.DV+H),E.t=P,E.clamp()}function l4e(_){var E=n();return this.addTo(_,E),E}function f4e(_){var E=n();return this.subTo(_,E),E}function d4e(_){var E=n();return this.multiplyTo(_,E),E}function h4e(){var _=n();return this.squareTo(_),_}function p4e(_){var E=n();return this.divRemTo(_,E,null),E}function y4e(_){var E=n();return this.divRemTo(_,null,E),E}function g4e(_){var E=n(),P=n();return this.divRemTo(_,E,P),new Array(E,P)}function m4e(_){this[this.t]=this.am(0,_-1,this,0,0,this.t),++this.t,this.clamp()}function b4e(_,E){if(_!=0){for(;this.t<=E;)this[this.t++]=0;for(this[E]+=_;this[E]>=this.DV;)this[E]-=this.DV,++E>=this.t&&(this[this.t++]=0),++this[E]}}function sy(){}function $C(_){return _}function w4e(_,E,P){_.multiplyTo(E,P)}function _4e(_,E){_.squareTo(E)}sy.prototype.convert=$C,sy.prototype.revert=$C,sy.prototype.mulTo=w4e,sy.prototype.sqrTo=_4e;function v4e(_){return this.exp(_,new sy)}function E4e(_,E,P){var H=Math.min(this.t+_.t,E);for(P.s=0,P.t=H;H>0;)P[--H]=0;var ue;for(ue=P.t-this.t;H<ue;++H)P[H+this.t]=this.am(0,_[H],P,H,0,this.t);for(ue=Math.min(_.t,E);H<ue;++H)this.am(0,_[H],P,H,0,E-H);P.clamp()}function S4e(_,E,P){--E;var H=P.t=this.t+_.t-E;for(P.s=0;--H>=0;)P[H]=0;for(H=Math.max(E-this.t,0);H<_.t;++H)P[this.t+H-E]=this.am(E-H,_[H],P,0,0,this.t+H-E);P.clamp(),P.drShiftTo(1,P)}function Cf(_){this.r2=n(),this.q3=n(),i.ONE.dlShiftTo(2*_.t,this.r2),this.mu=this.r2.divide(_),this.m=_}function R4e(_){if(_.s<0||_.t>2*this.m.t)return _.mod(this.m);if(_.compareTo(this.m)<0)return _;var E=n();return _.copyTo(E),this.reduce(E),E}function A4e(_){return _}function x4e(_){for(_.drShiftTo(this.m.t-1,this.r2),_.t>this.m.t+1&&(_.t=this.m.t+1,_.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);_.compareTo(this.r2)<0;)_.dAddOffset(1,this.m.t+1);for(_.subTo(this.r2,_);_.compareTo(this.m)>=0;)_.subTo(this.m,_)}function I4e(_,E){_.squareTo(E),this.reduce(E)}function T4e(_,E,P){_.multiplyTo(E,P),this.reduce(P)}Cf.prototype.convert=R4e,Cf.prototype.revert=A4e,Cf.prototype.reduce=x4e,Cf.prototype.mulTo=T4e,Cf.prototype.sqrTo=I4e;function P4e(_,E){var P=_.bitLength(),H,ue=v(1),me;if(P<=0)return ue;P<18?H=1:P<48?H=3:P<144?H=4:P<768?H=5:H=6,P<8?me=new Ye(E):E.isEven()?me=new Cf(E):me=new Te(E);var Pe=new Array,Me=3,Pr=H-1,Fi=(1<<H)-1;if(Pe[1]=me.convert(this),H>1){var Bs=n();for(me.sqrTo(Pe[1],Bs);Me<=Fi;)Pe[Me]=n(),me.mulTo(Bs,Pe[Me-2],Pe[Me]),Me+=2}var ds=_.t-1,Dc,n3=!0,Lo=n(),Mo;for(P=M(_[ds])-1;ds>=0;){for(P>=Pr?Dc=_[ds]>>P-Pr&Fi:(Dc=(_[ds]&(1<<P+1)-1)<<Pr-P,ds>0&&(Dc|=_[ds-1]>>this.DB+P-Pr)),Me=H;(Dc&1)==0;)Dc>>=1,--Me;if((P-=Me)<0&&(P+=this.DB,--ds),n3)Pe[Dc].copyTo(ue),n3=!1;else{for(;Me>1;)me.sqrTo(ue,Lo),me.sqrTo(Lo,ue),Me-=2;Me>0?me.sqrTo(ue,Lo):(Mo=ue,ue=Lo,Lo=Mo),me.mulTo(Lo,Pe[Dc],ue)}for(;ds>=0&&(_[ds]&1<<P)==0;)me.sqrTo(ue,Lo),Mo=ue,ue=Lo,Lo=Mo,--P<0&&(P=this.DB-1,--ds)}return me.revert(ue)}function C4e(_){var E=this.s<0?this.negate():this.clone(),P=_.s<0?_.negate():_.clone();if(E.compareTo(P)<0){var H=E;E=P,P=H}var ue=E.getLowestSetBit(),me=P.getLowestSetBit();if(me<0)return E;for(ue<me&&(me=ue),me>0&&(E.rShiftTo(me,E),P.rShiftTo(me,P));E.signum()>0;)(ue=E.getLowestSetBit())>0&&E.rShiftTo(ue,E),(ue=P.getLowestSetBit())>0&&P.rShiftTo(ue,P),E.compareTo(P)>=0?(E.subTo(P,E),E.rShiftTo(1,E)):(P.subTo(E,P),P.rShiftTo(1,P));return me>0&&P.lShiftTo(me,P),P}function O4e(_){if(_<=0)return 0;var E=this.DV%_,P=this.s<0?_-1:0;if(this.t>0)if(E==0)P=this[0]%_;else for(var H=this.t-1;H>=0;--H)P=(E*P+this[H])%_;return P}function k4e(_){var E=_.isEven();if(this.isEven()&&E||_.signum()==0)return i.ZERO;for(var P=_.clone(),H=this.clone(),ue=v(1),me=v(0),Pe=v(0),Me=v(1);P.signum()!=0;){for(;P.isEven();)P.rShiftTo(1,P),E?((!ue.isEven()||!me.isEven())&&(ue.addTo(this,ue),me.subTo(_,me)),ue.rShiftTo(1,ue)):me.isEven()||me.subTo(_,me),me.rShiftTo(1,me);for(;H.isEven();)H.rShiftTo(1,H),E?((!Pe.isEven()||!Me.isEven())&&(Pe.addTo(this,Pe),Me.subTo(_,Me)),Pe.rShiftTo(1,Pe)):Me.isEven()||Me.subTo(_,Me),Me.rShiftTo(1,Me);P.compareTo(H)>=0?(P.subTo(H,P),E&&ue.subTo(Pe,ue),me.subTo(Me,me)):(H.subTo(P,H),E&&Pe.subTo(ue,Pe),Me.subTo(me,Me))}if(H.compareTo(i.ONE)!=0)return i.ZERO;if(Me.compareTo(_)>=0)return Me.subtract(_);if(Me.signum()<0)Me.addTo(_,Me);else return Me;return Me.signum()<0?Me.add(_):Me}var xn=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],D4e=(1<<26)/xn[xn.length-1];function N4e(_){var E,P=this.abs();if(P.t==1&&P[0]<=xn[xn.length-1]){for(E=0;E<xn.length;++E)if(P[0]==xn[E])return!0;return!1}if(P.isEven())return!1;for(E=1;E<xn.length;){for(var H=xn[E],ue=E+1;ue<xn.length&&H<D4e;)H*=xn[ue++];for(H=P.modInt(H);E<ue;)if(H%xn[E++]==0)return!1}return P.millerRabin(_)}function B4e(_){var E=this.subtract(i.ONE),P=E.getLowestSetBit();if(P<=0)return!1;var H=E.shiftRight(P);_=_+1>>1,_>xn.length&&(_=xn.length);for(var ue=n(),me=0;me<_;++me){ue.fromInt(xn[Math.floor(Math.random()*xn.length)]);var Pe=ue.modPow(H,this);if(Pe.compareTo(i.ONE)!=0&&Pe.compareTo(E)!=0){for(var Me=1;Me++<P&&Pe.compareTo(E)!=0;)if(Pe=Pe.modPowInt(2,this),Pe.compareTo(i.ONE)==0)return!1;if(Pe.compareTo(E)!=0)return!1}}return!0}i.prototype.chunkSize=B,i.prototype.toRadix=Z,i.prototype.fromRadix=he,i.prototype.fromNumber=Be,i.prototype.bitwiseTo=Mt,i.prototype.changeBit=s4e,i.prototype.addTo=u4e,i.prototype.dMultiply=m4e,i.prototype.dAddOffset=b4e,i.prototype.multiplyLowerTo=E4e,i.prototype.multiplyUpperTo=S4e,i.prototype.modInt=O4e,i.prototype.millerRabin=B4e,i.prototype.clone=V,i.prototype.intValue=X,i.prototype.byteValue=re,i.prototype.shortValue=x,i.prototype.signum=G,i.prototype.toByteArray=He,i.prototype.equals=Fe,i.prototype.min=Ke,i.prototype.max=nt,i.prototype.and=_r,i.prototype.or=An,i.prototype.xor=st,i.prototype.andNot=X3e,i.prototype.not=Q3e,i.prototype.shiftLeft=Z3e,i.prototype.shiftRight=J3e,i.prototype.getLowestSetBit=t4e,i.prototype.bitCount=i4e,i.prototype.testBit=n4e,i.prototype.setBit=o4e,i.prototype.clearBit=a4e,i.prototype.flipBit=c4e,i.prototype.add=l4e,i.prototype.subtract=f4e,i.prototype.multiply=d4e,i.prototype.divide=p4e,i.prototype.remainder=y4e,i.prototype.divideAndRemainder=g4e,i.prototype.modPow=P4e,i.prototype.modInverse=k4e,i.prototype.pow=v4e,i.prototype.gcd=C4e,i.prototype.isProbablePrime=N4e,i.prototype.square=h4e,i.prototype.Barrett=Cf;var i3,fs,Ui;function L4e(_){fs[Ui++]^=_&255,fs[Ui++]^=_>>8&255,fs[Ui++]^=_>>16&255,fs[Ui++]^=_>>24&255,Ui>=T_&&(Ui-=T_)}function GC(){L4e(new Date().getTime())}if(fs==null){fs=new Array,Ui=0;var Bo;if(typeof window!="undefined"&&window.crypto){if(window.crypto.getRandomValues){var WC=new Uint8Array(32);for(window.crypto.getRandomValues(WC),Bo=0;Bo<32;++Bo)fs[Ui++]=WC[Bo]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var YC=window.crypto.random(32);for(Bo=0;Bo<YC.length;++Bo)fs[Ui++]=YC.charCodeAt(Bo)&255}}for(;Ui<T_;)Bo=Math.floor(65536*Math.random()),fs[Ui++]=Bo>>>8,fs[Ui++]=Bo&255;Ui=0,GC()}function M4e(){if(i3==null){for(GC(),i3=F4e(),i3.init(fs),Ui=0;Ui<fs.length;++Ui)fs[Ui]=0;Ui=0}return i3.next()}function j4e(_){var E;for(E=0;E<_.length;++E)_[E]=M4e()}function x_(){}x_.prototype.nextBytes=j4e;function I_(){this.i=0,this.j=0,this.S=new Array}function q4e(_){var E,P,H;for(E=0;E<256;++E)this.S[E]=E;for(P=0,E=0;E<256;++E)P=P+this.S[E]+_[E%_.length]&255,H=this.S[E],this.S[E]=this.S[P],this.S[P]=H;this.i=0,this.j=0}function U4e(){var _;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,_=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=_,this.S[_+this.S[this.i]&255]}I_.prototype.init=q4e,I_.prototype.next=U4e;function F4e(){return new I_}var T_=256;typeof _w!="undefined"?_w=Qoe.exports={default:i,BigInteger:i,SecureRandom:x_}:this.jsbn={BigInteger:i,SecureRandom:x_}}).call(_w)});var rm=m(vw=>{f();(function(){"use strict";var r={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function e(o){return i(s(o),arguments)}function t(o,a){return e.apply(null,[o].concat(a||[]))}function i(o,a){var c=1,u=o.length,l,d="",h,p,y,g,w,b,v,A;for(h=0;h<u;h++)if(typeof o[h]=="string")d+=o[h];else if(typeof o[h]=="object"){if(y=o[h],y.keys)for(l=a[c],p=0;p<y.keys.length;p++){if(l==null)throw new Error(e('[sprintf] Cannot access property "%s" of undefined value "%s"',y.keys[p],y.keys[p-1]));l=l[y.keys[p]]}else y.param_no?l=a[y.param_no]:l=a[c++];if(r.not_type.test(y.type)&&r.not_primitive.test(y.type)&&l instanceof Function&&(l=l()),r.numeric_arg.test(y.type)&&typeof l!="number"&&isNaN(l))throw new TypeError(e("[sprintf] expecting number but found %T",l));switch(r.number.test(y.type)&&(v=l>=0),y.type){case"b":l=parseInt(l,10).toString(2);break;case"c":l=String.fromCharCode(parseInt(l,10));break;case"d":case"i":l=parseInt(l,10);break;case"j":l=JSON.stringify(l,null,y.width?parseInt(y.width):0);break;case"e":l=y.precision?parseFloat(l).toExponential(y.precision):parseFloat(l).toExponential();break;case"f":l=y.precision?parseFloat(l).toFixed(y.precision):parseFloat(l);break;case"g":l=y.precision?String(Number(l.toPrecision(y.precision))):parseFloat(l);break;case"o":l=(parseInt(l,10)>>>0).toString(8);break;case"s":l=String(l),l=y.precision?l.substring(0,y.precision):l;break;case"t":l=String(!!l),l=y.precision?l.substring(0,y.precision):l;break;case"T":l=Object.prototype.toString.call(l).slice(8,-1).toLowerCase(),l=y.precision?l.substring(0,y.precision):l;break;case"u":l=parseInt(l,10)>>>0;break;case"v":l=l.valueOf(),l=y.precision?l.substring(0,y.precision):l;break;case"x":l=(parseInt(l,10)>>>0).toString(16);break;case"X":l=(parseInt(l,10)>>>0).toString(16).toUpperCase();break}r.json.test(y.type)?d+=l:(r.number.test(y.type)&&(!v||y.sign)?(A=v?"+":"-",l=l.toString().replace(r.sign,"")):A="",w=y.pad_char?y.pad_char==="0"?"0":y.pad_char.charAt(1):" ",b=y.width-(A+l).length,g=y.width&&b>0?w.repeat(b):"",d+=y.align?A+l+g:w==="0"?A+g+l:g+A+l)}return d}var n=Object.create(null);function s(o){if(n[o])return n[o];for(var a=o,c,u=[],l=0;a;){if((c=r.text.exec(a))!==null)u.push(c[0]);else if((c=r.modulo.exec(a))!==null)u.push("%");else if((c=r.placeholder.exec(a))!==null){if(c[2]){l|=1;var d=[],h=c[2],p=[];if((p=r.key.exec(h))!==null)for(d.push(p[1]);(h=h.substring(p[0].length))!=="";)if((p=r.key_access.exec(h))!==null)d.push(p[1]);else if((p=r.index_access.exec(h))!==null)d.push(p[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");c[2]=d}else l|=2;if(l===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");u.push({placeholder:c[0],param_no:c[1],keys:c[2],sign:c[3],pad_char:c[4],align:c[5],width:c[6],precision:c[7],type:c[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");a=a.substring(c[0].length)}return n[o]=u}typeof vw!="undefined"&&(vw.sprintf=e,vw.vsprintf=t),typeof window!="undefined"&&(window.sprintf=e,window.vsprintf=t,typeof define=="function"&&define.amd&&define(function(){return{sprintf:e,vsprintf:t}}))})()});var PI=m(bc=>{f();"use strict";var eMe=bc&&bc.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),tMe=bc&&bc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Zoe=bc&&bc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&eMe(e,r,t);return tMe(e,r),e};Object.defineProperty(bc,"__esModule",{value:!0});bc.Address4=void 0;var Joe=Zoe(xI()),da=Zoe(II()),eae=ww(),im=TI(),u1=rm(),rMe=function(){function r(e){this.groups=da.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=Joe.isCorrect(da.BITS),this.isInSubnet=Joe.isInSubnet,this.address=e;var t=da.RE_SUBNET_STRING.exec(e);if(t){if(this.parsedSubnet=t[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,this.subnetMask<0||this.subnetMask>da.BITS)throw new eae.AddressError("Invalid subnet mask.");e=e.replace(da.RE_SUBNET_STRING,"")}this.addressMinusSuffix=e,this.parsedAddress=this.parse(e)}return r.isValid=function(e){try{return new r(e),!0}catch(t){return!1}},r.prototype.parse=function(e){var t=e.split(".");if(!e.match(da.RE_ADDRESS))throw new eae.AddressError("Invalid IPv4 address.");return t},r.prototype.correctForm=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)}).join(".")},r.fromHex=function(e){var t=e.replace(/:/g,"").padStart(8,"0"),i=[],n;for(n=0;n<8;n+=2){var s=t.slice(n,n+2);i.push(parseInt(s,16))}return new r(i.join("."))},r.fromInteger=function(e){return r.fromHex(e.toString(16))},r.fromArpa=function(e){var t=e.replace(/(\.in-addr\.arpa)?\.$/,""),i=t.split(".").reverse().join(".");return new r(i)},r.prototype.toHex=function(){return this.parsedAddress.map(function(e){return u1.sprintf("%02x",parseInt(e,10))}).join(":")},r.prototype.toArray=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)})},r.prototype.toGroup6=function(){var e=[],t;for(t=0;t<da.GROUPS;t+=2){var i=u1.sprintf("%02x%02x",parseInt(this.parsedAddress[t],10),parseInt(this.parsedAddress[t+1],10));e.push(u1.sprintf("%x",parseInt(i,16)))}return e.join(":")},r.prototype.bigInteger=function(){return new im.BigInteger(this.parsedAddress.map(function(e){return u1.sprintf("%02x",parseInt(e,10))}).join(""),16)},r.prototype._startAddress=function(){return new im.BigInteger(this.mask()+"0".repeat(da.BITS-this.subnetMask),2)},r.prototype.startAddress=function(){return r.fromBigInteger(this._startAddress())},r.prototype.startAddressExclusive=function(){var e=new im.BigInteger("1");return r.fromBigInteger(this._startAddress().add(e))},r.prototype._endAddress=function(){return new im.BigInteger(this.mask()+"1".repeat(da.BITS-this.subnetMask),2)},r.prototype.endAddress=function(){return r.fromBigInteger(this._endAddress())},r.prototype.endAddressExclusive=function(){var e=new im.BigInteger("1");return r.fromBigInteger(this._endAddress().subtract(e))},r.fromBigInteger=function(e){return r.fromInteger(parseInt(e.toString(),10))},r.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},r.prototype.getBitsBase2=function(e,t){return this.binaryZeroPad().slice(e,t)},r.prototype.reverseForm=function(e){e||(e={});var t=this.correctForm().split(".").reverse().join(".");return e.omitSuffix?t:u1.sprintf("%s.in-addr.arpa.",t)},r.prototype.isMulticast=function(){return this.isInSubnet(new r("224.0.0.0/4"))},r.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(da.BITS,"0")},r.prototype.groupForV6=function(){var e=this.parsedAddress;return this.address.replace(da.RE_ADDRESS,u1.sprintf('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',e.slice(0,2).join("."),e.slice(2,4).join(".")))},r}();bc.Address4=rMe});var CI=m(ii=>{f();"use strict";Object.defineProperty(ii,"__esModule",{value:!0});ii.RE_URL_WITH_PORT=ii.RE_URL=ii.RE_ZONE_STRING=ii.RE_SUBNET_STRING=ii.RE_BAD_ADDRESS=ii.RE_BAD_CHARACTERS=ii.TYPES=ii.SCOPES=ii.GROUPS=ii.BITS=void 0;ii.BITS=128;ii.GROUPS=8;ii.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"};ii.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"};ii.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi;ii.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi;ii.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/;ii.RE_ZONE_STRING=/%.*$/;ii.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/);ii.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/)});var OI=m(wc=>{f();"use strict";Object.defineProperty(wc,"__esModule",{value:!0});wc.simpleGroup=wc.spanLeadingZeroes=wc.spanAll=wc.spanAllZeroes=void 0;var tae=rm();function rae(r){return r.replace(/(0+)/g,'<span class="zero">$1</span>')}wc.spanAllZeroes=rae;function iMe(r,e){e===void 0&&(e=0);var t=r.split("");return t.map(function(i,n){return tae.sprintf('<span class="digit value-%s position-%d">%s</span>',i,n+e,rae(i))}).join("")}wc.spanAll=iMe;function iae(r){return r.replace(/^(0+)/,'<span class="zero">$1</span>')}function nMe(r){var e=r.split(":");return e.map(function(t){return iae(t)}).join(":")}wc.spanLeadingZeroes=nMe;function sMe(r,e){e===void 0&&(e=0);var t=r.split(":");return t.map(function(i,n){return/group-v4/.test(i)?i:tae.sprintf('<span class="hover-group group-%d">%s</span>',n+e,iae(i))})}wc.simpleGroup=sMe});var nae=m(Xi=>{f();"use strict";var oMe=Xi&&Xi.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),aMe=Xi&&Xi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),cMe=Xi&&Xi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&oMe(e,r,t);return aMe(e,r),e};Object.defineProperty(Xi,"__esModule",{value:!0});Xi.possibleElisions=Xi.simpleRegularExpression=Xi.ADDRESS_BOUNDARY=Xi.padGroup=Xi.groupPossibilities=void 0;var uMe=cMe(CI()),l1=rm();function Ew(r){return l1.sprintf("(%s)",r.join("|"))}Xi.groupPossibilities=Ew;function Sw(r){return r.length<4?l1.sprintf("0{0,%d}%s",4-r.length,r):r}Xi.padGroup=Sw;Xi.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]";function lMe(r){var e=[];r.forEach(function(i,n){var s=parseInt(i,16);s===0&&e.push(n)});var t=e.map(function(i){return r.map(function(n,s){if(s===i){var o=s===0||s===uMe.GROUPS-1?":":"";return Ew([Sw(n),o])}return Sw(n)}).join(":")});return t.push(r.map(Sw).join(":")),Ew(t)}Xi.simpleRegularExpression=lMe;function fMe(r,e,t){var i=e?"":":",n=t?"":":",s=[];!e&&!t&&s.push("::"),e&&t&&s.push(""),(t&&!e||!t&&e)&&s.push(":"),s.push(l1.sprintf("%s(:0{1,4}){1,%d}",i,r-1)),s.push(l1.sprintf("(0{1,4}:){1,%d}%s",r-1,n)),s.push(l1.sprintf("(0{1,4}:){%d}0{1,4}",r-1));for(var o=1;o<r-1;o++)for(var a=1;a<r-o;a++)s.push(l1.sprintf("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",a,r-a-o-1));return Ew(s)}Xi.possibleElisions=fMe});var uae=m(bo=>{f();"use strict";var dMe=bo&&bo.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),hMe=bo&&bo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Rw=bo&&bo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&dMe(e,r,t);return hMe(e,r),e},sae=bo&&bo.__spreadArray||function(r,e){for(var t=0,i=e.length,n=r.length;t<i;t++,n++)r[n]=e[t];return r};Object.defineProperty(bo,"__esModule",{value:!0});bo.Address6=void 0;var oae=Rw(xI()),kI=Rw(II()),xr=Rw(CI()),DI=Rw(OI()),nh=PI(),sh=nae(),Su=ww(),Un=TI(),Fn=rm();function Aw(r){if(!r)throw new Error("Assertion failed.")}function pMe(r){for(var e=/(\d+)(\d{3})/;e.test(r);)r=r.replace(e,"$1,$2");return r}function yMe(r){return r=r.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2'),r=r.replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2'),r}function gMe(r,e){var t=[],i=[],n;for(n=0;n<r.length;n++)n<e[0]?t.push(r[n]):n>e[1]&&i.push(r[n]);return t.concat(["compact"]).concat(i)}function aae(r){return Fn.sprintf("%04x",parseInt(r,16))}function cae(r){return r&255}var mMe=function(){function r(e,t){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=oae.isInSubnet,this.isCorrect=oae.isCorrect(xr.BITS),t===void 0?this.groups=xr.GROUPS:this.groups=t,this.address=e;var i=xr.RE_SUBNET_STRING.exec(e);if(i){if(this.parsedSubnet=i[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>xr.BITS)throw new Su.AddressError("Invalid subnet mask.");e=e.replace(xr.RE_SUBNET_STRING,"")}else if(/\//.test(e))throw new Su.AddressError("Invalid subnet mask.");var n=xr.RE_ZONE_STRING.exec(e);n&&(this.zone=n[0],e=e.replace(xr.RE_ZONE_STRING,"")),this.addressMinusSuffix=e,this.parsedAddress=this.parse(this.addressMinusSuffix)}return r.isValid=function(e){try{return new r(e),!0}catch(t){return!1}},r.fromBigInteger=function(e){var t=e.toString(16).padStart(32,"0"),i=[],n;for(n=0;n<xr.GROUPS;n++)i.push(t.slice(n*4,(n+1)*4));return new r(i.join(":"))},r.fromURL=function(e){var t,i=null,n;if(e.indexOf("[")!==-1&&e.indexOf("]:")!==-1){if(n=xr.RE_URL_WITH_PORT.exec(e),n===null)return{error:"failed to parse address with port",address:null,port:null};t=n[1],i=n[2]}else if(e.indexOf("/")!==-1){if(e=e.replace(/^[a-z0-9]+:\/\//,""),n=xr.RE_URL.exec(e),n===null)return{error:"failed to parse address from URL",address:null,port:null};t=n[1]}else t=e;return i?(i=parseInt(i,10),(i<0||i>65536)&&(i=null)):i=null,{address:new r(t),port:i}},r.fromAddress4=function(e){var t=new nh.Address4(e),i=xr.BITS-(kI.BITS-t.subnetMask);return new r("::ffff:"+t.correctForm()+"/"+i)},r.fromArpa=function(e){var t=e.replace(/(\.ip6\.arpa)?\.$/,""),i=7;if(t.length!==63)throw new Su.AddressError("Invalid 'ip6.arpa' form.");for(var n=t.split(".").reverse(),s=i;s>0;s--){var o=s*4;n.splice(o,0,":")}return t=n.join(""),new r(t)},r.prototype.microsoftTranscription=function(){return Fn.sprintf("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))},r.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},r.prototype.possibleSubnets=function(e){e===void 0&&(e=128);var t=xr.BITS-this.subnetMask,i=Math.abs(e-xr.BITS),n=t-i;return n<0?"0":pMe(new Un.BigInteger("2",10).pow(n).toString(10))},r.prototype._startAddress=function(){return new Un.BigInteger(this.mask()+"0".repeat(xr.BITS-this.subnetMask),2)},r.prototype.startAddress=function(){return r.fromBigInteger(this._startAddress())},r.prototype.startAddressExclusive=function(){var e=new Un.BigInteger("1");return r.fromBigInteger(this._startAddress().add(e))},r.prototype._endAddress=function(){return new Un.BigInteger(this.mask()+"1".repeat(xr.BITS-this.subnetMask),2)},r.prototype.endAddress=function(){return r.fromBigInteger(this._endAddress())},r.prototype.endAddressExclusive=function(){var e=new Un.BigInteger("1");return r.fromBigInteger(this._endAddress().subtract(e))},r.prototype.getScope=function(){var e=xr.SCOPES[this.getBits(12,16).intValue()];return this.getType()==="Global unicast"&&e!=="Link local"&&(e="Global"),e||"Unknown"},r.prototype.getType=function(){for(var e=0,t=Object.keys(xr.TYPES);e<t.length;e++){var i=t[e];if(this.isInSubnet(new r(i)))return xr.TYPES[i]}return"Global unicast"},r.prototype.getBits=function(e,t){return new Un.BigInteger(this.getBitsBase2(e,t),2)},r.prototype.getBitsBase2=function(e,t){return this.binaryZeroPad().slice(e,t)},r.prototype.getBitsBase16=function(e,t){var i=t-e;if(i%4!=0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(e,t).toString(16).padStart(i/4,"0")},r.prototype.getBitsPastSubnet=function(){return this.getBitsBase2(this.subnetMask,xr.BITS)},r.prototype.reverseForm=function(e){e||(e={});var t=Math.floor(this.subnetMask/4),i=this.canonicalForm().replace(/:/g,"").split("").slice(0,t).reverse().join(".");return t>0?e.omitSuffix?i:Fn.sprintf("%s.ip6.arpa.",i):e.omitSuffix?"":"ip6.arpa."},r.prototype.correctForm=function(){var e,t=[],i=0,n=[];for(e=0;e<this.parsedAddress.length;e++){var s=parseInt(this.parsedAddress[e],16);s===0&&i++,s!==0&&i>0&&(i>1&&n.push([e-i,e-1]),i=0)}i>1&&n.push([this.parsedAddress.length-i,this.parsedAddress.length-1]);var o=n.map(function(u){return u[1]-u[0]+1});if(n.length>0){var a=o.indexOf(Math.max.apply(Math,o));t=gMe(this.parsedAddress,n[a])}else t=this.parsedAddress;for(e=0;e<t.length;e++)t[e]!=="compact"&&(t[e]=parseInt(t[e],16).toString(16));var c=t.join(":");return c=c.replace(/^compact$/,"::"),c=c.replace(/^compact|compact$/,":"),c=c.replace(/compact/,""),c},r.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(xr.BITS,"0")},r.prototype.parse4in6=function(e){var t=e.split(":"),i=t.slice(-1)[0],n=i.match(kI.RE_ADDRESS);if(n){this.parsedAddress4=n[0],this.address4=new nh.Address4(this.parsedAddress4);for(var s=0;s<this.address4.groups;s++)if(/^0[0-9]+/.test(this.address4.parsedAddress[s]))throw new Su.AddressError("IPv4 addresses can't have leading zeroes.",e.replace(kI.RE_ADDRESS,this.address4.parsedAddress.map(yMe).join(".")));this.v4=!0,t[t.length-1]=this.address4.toGroup6(),e=t.join(":")}return e},r.prototype.parse=function(e){e=this.parse4in6(e);var t=e.match(xr.RE_BAD_CHARACTERS);if(t)throw new Su.AddressError(Fn.sprintf("Bad character%s detected in address: %s",t.length>1?"s":"",t.join("")),e.replace(xr.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));var i=e.match(xr.RE_BAD_ADDRESS);if(i)throw new Su.AddressError(Fn.sprintf("Address failed regex: %s",i.join("")),e.replace(xr.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));var n=[],s=e.split("::");if(s.length===2){var o=s[0].split(":"),a=s[1].split(":");o.length===1&&o[0]===""&&(o=[]),a.length===1&&a[0]===""&&(a=[]);var c=this.groups-(o.length+a.length);if(!c)throw new Su.AddressError("Error parsing groups");this.elidedGroups=c,this.elisionBegin=o.length,this.elisionEnd=o.length+this.elidedGroups,n=n.concat(o);for(var u=0;u<c;u++)n.push("0");n=n.concat(a)}else if(s.length===1)n=e.split(":"),this.elidedGroups=0;else throw new Su.AddressError("Too many :: groups found");if(n=n.map(function(l){return Fn.sprintf("%x",parseInt(l,16))}),n.length!==this.groups)throw new Su.AddressError("Incorrect number of groups found");return n},r.prototype.canonicalForm=function(){return this.parsedAddress.map(aae).join(":")},r.prototype.decimal=function(){return this.parsedAddress.map(function(e){return Fn.sprintf("%05d",parseInt(e,16))}).join(":")},r.prototype.bigInteger=function(){return new Un.BigInteger(this.parsedAddress.map(aae).join(""),16)},r.prototype.to4=function(){var e=this.binaryZeroPad().split("");return nh.Address4.fromHex(new Un.BigInteger(e.slice(96,128).join(""),2).toString(16))},r.prototype.to4in6=function(){var e=this.to4(),t=new r(this.parsedAddress.slice(0,6).join(":"),6),i=t.correctForm(),n="";return/:$/.test(i)||(n=":"),i+n+e.address},r.prototype.inspectTeredo=function(){var e=this.getBitsBase16(0,32),t=this.getBits(80,96).xor(new Un.BigInteger("ffff",16)).toString(),i=nh.Address4.fromHex(this.getBitsBase16(32,64)),n=nh.Address4.fromHex(this.getBits(96,128).xor(new Un.BigInteger("ffffffff",16)).toString(16)),s=this.getBits(64,80),o=this.getBitsBase2(64,80),a=s.testBit(15),c=s.testBit(14),u=s.testBit(8),l=s.testBit(9),d=new Un.BigInteger(o.slice(2,6)+o.slice(8,16),2).toString(10);return{prefix:Fn.sprintf("%s:%s",e.slice(0,4),e.slice(4,8)),server4:i.address,client4:n.address,flags:o,coneNat:a,microsoft:{reserved:c,universalLocal:l,groupIndividual:u,nonce:d},udpPort:t}},r.prototype.inspect6to4=function(){var e=this.getBitsBase16(0,16),t=nh.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:Fn.sprintf("%s",e.slice(0,4)),gateway:t.address}},r.prototype.to6to4=function(){if(!this.is4())return null;var e=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new r(e)},r.prototype.toByteArray=function(){var e=this.bigInteger().toByteArray();return e.length===17&&e[0]===0?e.slice(1):e},r.prototype.toUnsignedByteArray=function(){return this.toByteArray().map(cae)},r.fromByteArray=function(e){return this.fromUnsignedByteArray(e.map(cae))},r.fromUnsignedByteArray=function(e){for(var t=new Un.BigInteger("256",10),i=new Un.BigInteger("0",10),n=new Un.BigInteger("1",10),s=e.length-1;s>=0;s--)i=i.add(n.multiply(new Un.BigInteger(e[s].toString(10),10))),n=n.multiply(t);return r.fromBigInteger(i)},r.prototype.isCanonical=function(){return this.addressMinusSuffix===this.canonicalForm()},r.prototype.isLinkLocal=function(){return this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000"},r.prototype.isMulticast=function(){return this.getType()==="Multicast"},r.prototype.is4=function(){return this.v4},r.prototype.isTeredo=function(){return this.isInSubnet(new r("2001::/32"))},r.prototype.is6to4=function(){return this.isInSubnet(new r("2002::/16"))},r.prototype.isLoopback=function(){return this.getType()==="Loopback"},r.prototype.href=function(e){return e===void 0?e="":e=Fn.sprintf(":%s",e),Fn.sprintf("http://[%s]%s/",this.correctForm(),e)},r.prototype.link=function(e){e||(e={}),e.className===void 0&&(e.className=""),e.prefix===void 0&&(e.prefix="/#address="),e.v4===void 0&&(e.v4=!1);var t=this.correctForm;return e.v4&&(t=this.to4in6),e.className?Fn.sprintf('<a href="%1$s%2$s" class="%3$s">%2$s</a>',e.prefix,t.call(this),e.className):Fn.sprintf('<a href="%1$s%2$s">%2$s</a>',e.prefix,t.call(this))},r.prototype.group=function(){if(this.elidedGroups===0)return DI.simpleGroup(this.address).join(":");Aw(typeof this.elidedGroups=="number"),Aw(typeof this.elisionBegin=="number");var e=[],t=this.address.split("::"),i=t[0],n=t[1];i.length?e.push.apply(e,DI.simpleGroup(i)):e.push("");for(var s=["hover-group"],o=this.elisionBegin;o<this.elisionBegin+this.elidedGroups;o++)s.push(Fn.sprintf("group-%d",o));return e.push(Fn.sprintf('<span class="%s"></span>',s.join(" "))),n.length?e.push.apply(e,DI.simpleGroup(n,this.elisionEnd)):e.push(""),this.is4()&&(Aw(this.address4 instanceof nh.Address4),e.pop(),e.push(this.address4.groupForV6())),e.join(":")},r.prototype.regularExpressionString=function(e){e===void 0&&(e=!1);var t=[],i=new r(this.correctForm());if(i.elidedGroups===0)t.push(sh.simpleRegularExpression(i.parsedAddress));else if(i.elidedGroups===xr.GROUPS)t.push(sh.possibleElisions(xr.GROUPS));else{var n=i.address.split("::");n[0].length&&t.push(sh.simpleRegularExpression(n[0].split(":"))),Aw(typeof i.elidedGroups=="number"),t.push(sh.possibleElisions(i.elidedGroups,n[0].length!==0,n[1].length!==0)),n[1].length&&t.push(sh.simpleRegularExpression(n[1].split(":"))),t=[t.join(":")]}return e||(t=sae(sae(["(?=^|",sh.ADDRESS_BOUNDARY,"|[^\\w\\:])("],t),[")(?=[^\\w\\:]|",sh.ADDRESS_BOUNDARY,"|$)"])),t.join("")},r.prototype.regularExpression=function(e){return e===void 0&&(e=!1),new RegExp(this.regularExpressionString(e),"i")},r}();bo.Address6=mMe});var lae=m(vn=>{f();"use strict";var bMe=vn&&vn.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),wMe=vn&&vn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),_Me=vn&&vn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&bMe(e,r,t);return wMe(e,r),e};Object.defineProperty(vn,"__esModule",{value:!0});vn.v6=vn.AddressError=vn.Address6=vn.Address4=void 0;var vMe=PI();Object.defineProperty(vn,"Address4",{enumerable:!0,get:function(){return vMe.Address4}});var EMe=uae();Object.defineProperty(vn,"Address6",{enumerable:!0,get:function(){return EMe.Address6}});var SMe=ww();Object.defineProperty(vn,"AddressError",{enumerable:!0,get:function(){return SMe.AddressError}});var RMe=_Me(OI());vn.v6={helpers:RMe}});var MI=m((kIt,LI)=>{f();"use strict";var fae=le(),AMe=Object.assign(fae("libp2p:ip-port-to-multiaddr"),{error:fae("libp2p:ip-port-to-multiaddr:err")}),{Multiaddr:NI}=ft(),BI=Xoe(),{Address4:xMe,Address6:IMe}=lae(),xw={ERR_INVALID_IP_PARAMETER:"ERR_INVALID_IP_PARAMETER",ERR_INVALID_PORT_PARAMETER:"ERR_INVALID_PORT_PARAMETER",ERR_INVALID_IP:"ERR_INVALID_IP"};function TMe(r,e){if(typeof r!="string")throw BI(new Error(`invalid ip provided: ${r}`),xw.ERR_INVALID_IP_PARAMETER);if(typeof e=="string"&&(e=parseInt(e)),isNaN(e))throw BI(new Error(`invalid port provided: ${e}`),xw.ERR_INVALID_PORT_PARAMETER);try{return new xMe(r),new NI(`/ip4/${r}/tcp/${e}`)}catch{}try{let t=new IMe(r);return t.is4()?new NI(`/ip4/${t.to4().correctForm()}/tcp/${e}`):new NI(`/ip6/${r}/tcp/${e}`)}catch(t){let i=`invalid ip:port for creating a multiaddr: ${r}:${e}`;throw AMe.error(i),BI(new Error(i),xw.ERR_INVALID_IP)}}LI.exports=TMe;LI.exports.Errors=xw});var hae=m((DIt,Iw)=>{f();"use strict";var jI=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},dae=(r,e,t,i)=>{let n,s=new Promise((o,a)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){o(r);return}i={customTimers:{setTimeout,clearTimeout},...i},n=i.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{o(t())}catch(l){a(l)}return}let c=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,u=t instanceof Error?t:new jI(c);typeof r.cancel=="function"&&r.cancel(),a(u)},e),(async()=>{try{o(await r)}catch(c){a(c)}finally{i.customTimers.clearTimeout.call(void 0,n)}})()});return s.clear=()=>{clearTimeout(n),n=void 0},s};Iw.exports=dae;Iw.exports.default=dae;Iw.exports.TimeoutError=jI});var bae=m((NIt,mae)=>{f();"use strict";var pae=ua(),{CLOSE_TIMEOUT:PMe}=AI(),yae=MI(),CMe=hae(),gae=le(),qI=gae("libp2p:websockets:socket");qI.error=gae("libp2p:websockets:socket:error");mae.exports=(r,e={})=>{let t={async sink(i){e.signal&&(i=pae(i,e.signal));try{await r.sink(async function*(){for await(let n of i)yield n instanceof Uint8Array?n:n.slice()}())}catch(n){n.type!=="aborted"&&qI.error(n)}},source:e.signal?pae(r.source,e.signal):r.source,conn:r,localAddr:e.localAddr||(r.localAddress&&r.localPort?yae(r.localAddress,r.localPort):void 0),remoteAddr:e.remoteAddr||yae(r.remoteAddress,r.remotePort),timeline:{open:Date.now()},async close(){let i=Date.now();try{await CMe(r.close(),PMe)}catch(n){let{host:s,port:o}=t.remoteAddr.toOptions();qI("timeout closing stream to %s:%s after %dms, destroying it manually",s,o,Date.now()-i),r.destroy()}finally{t.timeline.close=Date.now()}}};return r.socket.once&&r.socket.once("close",()=>{t.timeline.close||(t.timeline.close=Date.now())}),t}});var vae=m((BIt,_ae)=>{f();"use strict";var af=Ff(),{CODE_CIRCUIT:UI,CODE_P2P:FI,CODE_TCP:KI,CODE_WS:OMe,CODE_WSS:wae}=AI();_ae.exports={all:r=>r.filter(e=>{if(e.protoCodes().includes(UI))return!1;let t=e.decapsulateCode(FI);return af.WebSockets.matches(t)||af.WebSocketsSecure.matches(t)}),dnsWss:r=>r.filter(e=>{if(e.protoCodes().includes(UI))return!1;let t=e.decapsulateCode(FI);return af.WebSocketsSecure.matches(t)&&af.DNS.matches(t.decapsulateCode(KI).decapsulateCode(wae))}),dnsWsOrWss:r=>r.filter(e=>{if(e.protoCodes().includes(UI))return!1;let t=e.decapsulateCode(FI);return af.WebSockets.matches(t)?af.DNS.matches(t.decapsulateCode(KI).decapsulateCode(OMe)):af.WebSocketsSecure.matches(t)&&af.DNS.matches(t.decapsulateCode(KI).decapsulateCode(wae))})}});var Tae=m((LIt,Iae)=>{f();"use strict";var kMe=Hoe(),DMe=Q4(),NMe=Tb(),{AbortError:Eae}=ua(),BMe=Za(),Sae=le(),cf=Sae("libp2p:websockets");cf.error=Sae("libp2p:websockets:error");var Rae=cy(),LMe=Goe(),MMe=bae(),Aae=vae(),xae=class{constructor({upgrader:e,filter:t}){if(!e)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e,this._filter=t}async dial(e,t={}){cf("dialing %s",e);let i=await this._connect(e,t),n=MMe(i,{remoteAddr:e,signal:t.signal});cf("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return cf("outbound connection %s upgraded",n.remoteAddr),s}async _connect(e,t={}){if(t.signal&&t.signal.aborted)throw new Eae;let i=e.toOptions();cf("dialing %s:%s",i.host,i.port);let n=BMe(),s=u=>{let l=`connection error: ${u.message}`;cf.error(l),n.reject(u)},o=kMe(NMe(e),Object.assign({binary:!0},t));if(o.socket.on?o.socket.on("error",s):o.socket.onerror=s,!t.signal)return await Promise.race([o.connected(),n.promise]),cf("connected %s",e),o;let a,c=new Promise((u,l)=>{if(a=()=>{l(new Eae),setTimeout(()=>{o.close()})},t.signal.aborted)return a();t.signal.addEventListener("abort",a)});try{await Promise.race([c,n.promise,o.connected()])}finally{t.signal.removeEventListener("abort",a)}return cf("connected %s",e),o}createListener(e={},t){return typeof e=="function"&&(t=e,e={}),LMe({handler:t,upgrader:this._upgrader},e)}filter(e){return e=Array.isArray(e)?e:[e],this._filter?this._filter(e):Rae.isBrowser||Rae.isWebWorker?Aae.dnsWss(e):Aae.all(e)}};Iae.exports=DMe(xae,{className:"WebSockets",symbolName:"@libp2p/js-libp2p-websockets/websockets"})});var VI=m((MIt,Cae)=>{f();"use strict";function Pae(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function jMe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Pae(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Pae(new n,t)}}Cae.exports=jMe});var kae=m((jIt,Oae)=>{f();Oae.exports=function(){if(typeof globalThis=="undefined")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}});var $I=m((qIt,HI)=>{f();"use strict";var zI=65536,qMe=4294967295;function UMe(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var FMe=tx().Buffer,Tw=globalThis.crypto||globalThis.msCrypto;Tw&&Tw.getRandomValues?HI.exports=KMe:HI.exports=UMe;function KMe(r,e){if(r>qMe)throw new RangeError("requested too many random bytes");var t=FMe.allocUnsafe(r);if(r>0)if(r>zI)for(var i=0;i<r;i+=zI)Tw.getRandomValues(t.slice(i,i+zI));else Tw.getRandomValues(t);return typeof e=="function"?process.nextTick(function(){e(null,t)}):t}});var Bae=m((UIt,Nae)=>{f();"use strict";function Dae(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function VMe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=void 0),e!=null&&(t.code=e);try{return Dae(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Dae(new n,t)}}Nae.exports=VMe});var YI=m((FIt,qae)=>{f();var zMe=le()("simple-peer"),Lae=kae(),Mae=$I(),HMe=mx(),GI=Ig(),Ir=Bae(),WI=64*1024,$Me=5*1e3,GMe=5*1e3;function jae(r){return r.replace(/a=ice-options:trickle\s\n/g,"")}function WMe(r){console.warn(r)}var uf=class extends HMe.Duplex{constructor(e){e=Object.assign({allowHalfOpen:!1},e);super(e);if(this._id=Mae(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||Mae(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||uf.channelConfig,this.negotiated=this.channelConfig.negotiated,this.config=Object.assign({},uf.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(t=>t),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||$Me,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:Lae(),!this._wrtc)throw Ir(typeof window=="undefined"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=this.negotiated?!1:!this.initiator,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._firstStable=!0,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(t){GI(()=>this.destroy(Ir(t,"ERR_PC_CONSTRUCTOR")));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=t=>{this._onIceCandidate(t)},this.initiator||this.negotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=t=>{this._setupData(t)},this.streams&&this.streams.forEach(t=>{this.addStream(t)}),this._pc.ontrack=t=>{this._onTrack(t)},this.initiator&&this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(this.destroyed)throw Ir(new Error("cannot signal after peer is destroyed"),"ERR_SIGNALING");if(typeof e=="string")try{e=JSON.parse(e)}catch(t){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(t=>{this._addIceCandidate(t)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(t=>{this.destroy(Ir(t,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(Ir(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}_addIceCandidate(e){var t=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(t).catch(i=>{!t.address||t.address.endsWith(".local")?WMe("Ignoring unsupported ICE candidate."):this.destroy(Ir(i,"ERR_ADD_ICE_CANDIDATE"))})}send(e){this._channel.send(e)}addTransceiver(e,t){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,t),this._needsNegotiation()}catch(i){this.destroy(Ir(i,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{transceiverRequest:{kind:e,init:t}})}addStream(e){this._debug("addStream()"),e.getTracks().forEach(t=>{this.addTrack(t,e)})}addTrack(e,t){this._debug("addTrack()");var i=this._senderMap.get(e)||new Map,n=i.get(t);if(!n)n=this._pc.addTrack(e,t),i.set(t,n),this._senderMap.set(e,i),this._needsNegotiation();else throw n.removed?Ir(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):Ir(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,t,i){this._debug("replaceTrack()");var n=this._senderMap.get(e),s=n?n.get(i):null;if(!s)throw Ir(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");t&&this._senderMap.set(t,n),s.replaceTrack!=null?s.replaceTrack(t):this.destroy(Ir(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,t){this._debug("removeSender()");var i=this._senderMap.get(e),n=i?i.get(t):null;if(!n)throw Ir(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{n.removed=!0,this._pc.removeTrack(n)}catch(s){s.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(n):this.destroy(Ir(s,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){this._debug("removeSenders()"),e.getTracks().forEach(t=>{this.removeTrack(t,e)})}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,GI(()=>{this._batchedNegotiation=!1,this._debug("starting batched negotiation"),this.negotiate()}))}negotiate(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0}_destroy(e,t){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(i){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(i){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,t(e)}_setupData(e){if(!e.channel)return this.destroy(Ir(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=WI),this.channelName=this._channel.label,this._channel.onmessage=i=>{this._onChannelMessage(i)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=i=>{this.destroy(Ir(i,"ERR_DATA_CHANNEL"))};var t=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(t&&this._onChannelClose(),t=!0):t=!1},GMe)}_read(){}_write(e,t,i){if(this.destroyed)return i(Ir(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(n){return this.destroy(Ir(n,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>WI?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_onFinish(){if(this.destroyed)return;let e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=jae(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let t=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp})}},i=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))},n=s=>{this.destroy(Ir(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(Ir(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=jae(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let t=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp}),this.initiator||this._requestMissingTransceivers()}},i=()=>{this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))},n=s=>{this.destroy(Ir(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(Ir(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(Ir(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(Ir(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(Ir(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}}getStats(e){let t=i=>(Object.prototype.toString.call(i.values)==="[object Array]"&&i.values.forEach(n=>{Object.assign(i,n)}),i);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(i=>{var n=[];i.forEach(s=>{n.push(t(s))}),e(null,n)},i=>e(i)):this._pc.getStats.length>0?this._pc.getStats(i=>{if(!this.destroyed){var n=[];i.result().forEach(s=>{var o={};s.names().forEach(a=>{o[a]=s.stat(a)}),o.id=s.id,o.type=s.type,o.timestamp=s.timestamp,n.push(t(o))}),e(null,n)}},i=>e(i)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;let e=()=>{this.destroyed||this.getStats((t,i)=>{if(this.destroyed)return;t&&(i=[]);var n={},s={},o={},a=!1;i.forEach(l=>{(l.type==="remotecandidate"||l.type==="remote-candidate")&&(n[l.id]=l),(l.type==="localcandidate"||l.type==="local-candidate")&&(s[l.id]=l),(l.type==="candidatepair"||l.type==="candidate-pair")&&(o[l.id]=l)});let c=l=>{a=!0;var d=s[l.localCandidateId];d&&(d.ip||d.address)?(this.localAddress=d.ip||d.address,this.localPort=Number(d.port)):d&&d.ipAddress?(this.localAddress=d.ipAddress,this.localPort=Number(d.portNumber)):typeof l.googLocalAddress=="string"&&(d=l.googLocalAddress.split(":"),this.localAddress=d[0],this.localPort=Number(d[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");var h=n[l.remoteCandidateId];h&&(h.ip||h.address)?(this.remoteAddress=h.ip||h.address,this.remotePort=Number(h.port)):h&&h.ipAddress?(this.remoteAddress=h.ipAddress,this.remotePort=Number(h.portNumber)):typeof l.googRemoteAddress=="string"&&(h=l.googRemoteAddress.split(":"),this.remoteAddress=h[0],this.remotePort=Number(h[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach(l=>{l.type==="transport"&&l.selectedCandidatePairId&&c(o[l.selectedCandidatePairId]),(l.type==="googCandidatePair"&&l.googActiveConnection==="true"||(l.type==="candidatepair"||l.type==="candidate-pair")&&l.selected)&&c(l)}),!a&&(!Object.keys(o).length||Object.keys(s).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(l){return this.destroy(Ir(l,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');var u=this._cb;this._cb=null,u(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>WI||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&!this._firstStable&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation&&(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()),this._debug("negotiate"),this.emit("negotiate")),this._firstStable=!1,this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(!this.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=new Uint8Array(t)),this.push(t)}}_onChannelBufferedAmountLow(){if(!(this.destroyed||!this._cb)){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var e=this._cb;this._cb=null,e(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(t=>{this._debug("on track"),this.emit("track",e.track,t),this._remoteTracks.push({track:e.track,stream:t}),!this._remoteStreams.some(i=>i.id===t.id)&&(this._remoteStreams.push(t),GI(()=>{this.emit("stream",t)}))})}_debug(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],zMe.apply(null,e)}};uf.WEBRTC_SUPPORT=!!Lae();uf.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};uf.channelConfig={};qae.exports=uf});var Fae=m((KIt,Uae)=>{f();"use strict";Uae.exports={supportsFileReader:typeof self!="undefined"&&"FileReader"in self,supportsWebRTC:"RTCPeerConnection"in globalThis&&typeof navigator!="undefined"&&typeof navigator.mediaDevices!="undefined"&&"getUserMedia"in navigator.mediaDevices,supportsWebRTCDataChannels:"RTCPeerConnection"in globalThis}});var Cw=m(Pw=>{f();"use strict";Pw.CODE_P2P=421;Pw.CODE_CIRCUIT=290;Pw.CLOSE_TIMEOUT=2e3});var XI=m(lf=>{f();"use strict";Object.defineProperty(lf,"__esModule",{value:!0});lf.ERROR_PACKET=lf.PACKET_TYPES_REVERSE=lf.PACKET_TYPES=void 0;var _c=Object.create(null);lf.PACKET_TYPES=_c;_c.open="0";_c.close="1";_c.ping="2";_c.pong="3";_c.message="4";_c.upgrade="5";_c.noop="6";var Kae=Object.create(null);lf.PACKET_TYPES_REVERSE=Kae;Object.keys(_c).forEach(r=>{Kae[_c[r]]=r});var YMe={type:"error",data:"parser error"};lf.ERROR_PACKET=YMe});var zae=m(QI=>{f();"use strict";Object.defineProperty(QI,"__esModule",{value:!0});var XMe=XI(),QMe=typeof Blob=="function"||typeof Blob!="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",ZMe=typeof ArrayBuffer=="function",JMe=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,eje=({type:r,data:e},t,i)=>QMe&&e instanceof Blob?t?i(e):Vae(e,i):ZMe&&(e instanceof ArrayBuffer||JMe(e))?t?i(e):Vae(new Blob([e]),i):i(XMe.PACKET_TYPES[r]+(e||"")),Vae=(r,e)=>{let t=new FileReader;return t.onload=function(){let i=t.result.split(",")[1];e("b"+i)},t.readAsDataURL(r)};QI.default=eje});var $ae=m((Ow,Hae)=>{f();(function(r,e){typeof Ow=="object"&&typeof Hae!="undefined"?e(Ow):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r["base64-arraybuffer"]={}))})(Ow,function(r){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=typeof Uint8Array=="undefined"?[]:new Uint8Array(256),i=0;i<e.length;i++)t[e.charCodeAt(i)]=i;var n=function(o){var a=new Uint8Array(o),c,u=a.length,l="";for(c=0;c<u;c+=3)l+=e[a[c]>>2],l+=e[(a[c]&3)<<4|a[c+1]>>4],l+=e[(a[c+1]&15)<<2|a[c+2]>>6],l+=e[a[c+2]&63];return u%3==2?l=l.substring(0,l.length-1)+"=":u%3==1&&(l=l.substring(0,l.length-2)+"=="),l},s=function(o){var a=o.length*.75,c=o.length,u,l=0,d,h,p,y;o[o.length-1]==="="&&(a--,o[o.length-2]==="="&&a--);var g=new ArrayBuffer(a),w=new Uint8Array(g);for(u=0;u<c;u+=4)d=t[o.charCodeAt(u)],h=t[o.charCodeAt(u+1)],p=t[o.charCodeAt(u+2)],y=t[o.charCodeAt(u+3)],w[l++]=d<<2|h>>4,w[l++]=(h&15)<<4|p>>2,w[l++]=(p&3)<<6|y&63;return g};r.decode=s,r.encode=n,Object.defineProperty(r,"__esModule",{value:!0})})});var Wae=m(ZI=>{f();"use strict";Object.defineProperty(ZI,"__esModule",{value:!0});var kw=XI(),tje=$ae(),rje=typeof ArrayBuffer=="function",ije=(r,e)=>{if(typeof r!="string")return{type:"message",data:Gae(r,e)};let t=r.charAt(0);return t==="b"?{type:"message",data:nje(r.substring(1),e)}:kw.PACKET_TYPES_REVERSE[t]?r.length>1?{type:kw.PACKET_TYPES_REVERSE[t],data:r.substring(1)}:{type:kw.PACKET_TYPES_REVERSE[t]}:kw.ERROR_PACKET},nje=(r,e)=>{if(rje){let t=(0,tje.decode)(r);return Gae(t,e)}else return{base64:!0,data:r}},Gae=(r,e)=>{switch(e){case"blob":return r instanceof ArrayBuffer?new Blob([r]):r;case"arraybuffer":default:return r}};ZI.default=ije});var nm=m(wo=>{f();"use strict";Object.defineProperty(wo,"__esModule",{value:!0});wo.decodePayload=wo.decodePacket=wo.encodePayload=wo.encodePacket=wo.protocol=void 0;var Yae=zae();wo.encodePacket=Yae.default;var Xae=Wae();wo.decodePacket=Xae.default;var Qae=String.fromCharCode(30),sje=(r,e)=>{let t=r.length,i=new Array(t),n=0;r.forEach((s,o)=>{(0,Yae.default)(s,!1,a=>{i[o]=a,++n===t&&e(i.join(Qae))})})};wo.encodePayload=sje;var oje=(r,e)=>{let t=r.split(Qae),i=[];for(let n=0;n<t.length;n++){let s=(0,Xae.default)(t[n],e);if(i.push(s),s.type==="error")break}return i};wo.decodePayload=oje;wo.protocol=4});var oh=m(Zae=>{f();Zae.Emitter=Kn;function Kn(r){if(r)return aje(r)}function aje(r){for(var e in Kn.prototype)r[e]=Kn.prototype[e];return r}Kn.prototype.on=Kn.prototype.addEventListener=function(r,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(e),this};Kn.prototype.once=function(r,e){function t(){this.off(r,t),e.apply(this,arguments)}return t.fn=e,this.on(r,t),this};Kn.prototype.off=Kn.prototype.removeListener=Kn.prototype.removeAllListeners=Kn.prototype.removeEventListener=function(r,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+r];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var i,n=0;n<t.length;n++)if(i=t[n],i===e||i.fn===e){t.splice(n,1);break}return t.length===0&&delete this._callbacks["$"+r],this};Kn.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+r],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(t){t=t.slice(0);for(var i=0,n=t.length;i<n;++i)t[i].apply(this,e)}return this};Kn.prototype.emitReserved=Kn.prototype.emit;Kn.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};Kn.prototype.hasListeners=function(r){return!!this.listeners(r).length}});var sm=m(JI=>{f();"use strict";Object.defineProperty(JI,"__esModule",{value:!0});JI.default=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:Function("return this")())()});var f1=m(vc=>{f();"use strict";var cje=vc&&vc.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(vc,"__esModule",{value:!0});vc.byteLength=vc.installTimerFunctions=vc.pick=void 0;var Dw=cje(sm());function uje(r,...e){return e.reduce((t,i)=>(r.hasOwnProperty(i)&&(t[i]=r[i]),t),{})}vc.pick=uje;var lje=setTimeout,fje=clearTimeout;function dje(r,e){e.useNativeTimers?(r.setTimeoutFn=lje.bind(Dw.default),r.clearTimeoutFn=fje.bind(Dw.default)):(r.setTimeoutFn=setTimeout.bind(Dw.default),r.clearTimeoutFn=clearTimeout.bind(Dw.default))}vc.installTimerFunctions=dje;var hje=1.33;function pje(r){return typeof r=="string"?yje(r):Math.ceil((r.byteLength||r.size)*hje)}vc.byteLength=pje;function yje(r){let e=0,t=0;for(let i=0,n=r.length;i<n;i++)e=r.charCodeAt(i),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(i++,t+=4);return t}});var Nw=m(d1=>{f();"use strict";var gje=d1&&d1.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(d1,"__esModule",{value:!0});d1.Transport=void 0;var mje=nm(),bje=oh(),wje=f1(),_je=gje(le()),vje=(0,_je.default)("engine.io-client:transport"),Jae=class extends Error{constructor(e,t,i){super(e);this.description=t,this.context=i,this.type="TransportError"}},ece=class extends bje.Emitter{constructor(e){super();this.writable=!1,(0,wje.installTimerFunctions)(this,e),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,t,i){return super.emitReserved("error",new Jae(e,t,i)),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"?this.write(e):vje("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let t=(0,mje.decodePacket)(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}};d1.Transport=ece});var tT=m(df=>{f();"use strict";Object.defineProperty(df,"__esModule",{value:!0});df.yeast=df.decode=df.encode=void 0;var tce="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Bw=64,rce={},ice=0,ff=0,nce;function eT(r){let e="";do e=tce[r%Bw]+e,r=Math.floor(r/Bw);while(r>0);return e}df.encode=eT;function Eje(r){let e=0;for(ff=0;ff<r.length;ff++)e=e*Bw+rce[r.charAt(ff)];return e}df.decode=Eje;function Sje(){let r=eT(+new Date);return r!==nce?(ice=0,nce=r):r+"."+eT(ice++)}df.yeast=Sje;for(;ff<Bw;ff++)rce[tce[ff]]=ff});var Lw=m(h1=>{f();"use strict";Object.defineProperty(h1,"__esModule",{value:!0});h1.decode=h1.encode=void 0;function Rje(r){let e="";for(let t in r)r.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(r[t]));return e}h1.encode=Rje;function Aje(r){let e={},t=r.split("&");for(let i=0,n=t.length;i<n;i++){let s=t[i].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}h1.decode=Aje});var oce=m(Mw=>{f();"use strict";Object.defineProperty(Mw,"__esModule",{value:!0});Mw.hasCORS=void 0;var sce=!1;try{sce=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch(r){}Mw.hasCORS=sce});var ace=m(om=>{f();"use strict";var xje=om&&om.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(om,"__esModule",{value:!0});var Ije=oce(),Tje=xje(sm());function Pje(r){let e=r.xdomain;try{if(typeof XMLHttpRequest!="undefined"&&(!e||Ije.hasCORS))return new XMLHttpRequest}catch(t){}if(!e)try{return new Tje.default[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(t){}}om.default=Pje});var hce=m(hf=>{f();"use strict";var rT=hf&&hf.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(hf,"__esModule",{value:!0});hf.Request=hf.Polling=void 0;var Cje=Nw(),Oje=rT(le()),kje=tT(),Dje=Lw(),cce=nm(),uce=rT(ace()),Nje=oh(),lce=f1(),Bje=rT(sm()),as=(0,Oje.default)("engine.io-client:polling");function Lje(){}var Mje=function(){return new uce.default({xdomain:!1}).responseType!=null}(),fce=class extends Cje.Transport{constructor(e){super(e);if(this.polling=!1,typeof location!="undefined"){let i=location.protocol==="https:",n=location.port;n||(n=i?"443":"80"),this.xd=typeof location!="undefined"&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==i}let t=e&&e.forceBase64;this.supportsBinary=Mje&&!t}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let t=()=>{as("paused"),this.readyState="paused",e()};if(this.polling||!this.writable){let i=0;this.polling&&(as("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){as("pre-pause polling complete"),--i||t()})),this.writable||(as("we are currently writing - waiting to pause"),i++,this.once("drain",function(){as("pre-pause writing complete"),--i||t()}))}else t()}poll(){as("polling"),this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){as("polling got data %s",e);let t=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};(0,cce.decodePayload)(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"?this.poll():as('ignoring poll - transport state "%s"',this.readyState))}doClose(){let e=()=>{as("writing close packet"),this.write([{type:"close"}])};this.readyState==="open"?(as("transport open - closing"),e()):(as("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,(0,cce.encodePayload)(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.query||{},t=this.opts.secure?"https":"http",i="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=(0,kje.yeast)()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.opts.port&&(t==="https"&&Number(this.opts.port)!==443||t==="http"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port);let n=(0,Dje.encode)(e),s=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(n.length?"?"+n:"")}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new _o(this.uri(),e)}doWrite(e,t){let i=this.request({method:"POST",data:e});i.on("success",t),i.on("error",(n,s)=>{this.onError("xhr post error",n,s)})}doPoll(){as("xhr poll");let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,i)=>{this.onError("xhr poll error",t,i)}),this.pollXhr=e}};hf.Polling=fce;var _o=class extends Nje.Emitter{constructor(e,t){super();(0,lce.installTimerFunctions)(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=t.async!==!1,this.data=t.data!==void 0?t.data:null,this.create()}create(){let e=(0,lce.pick)(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;let t=this.xhr=new uce.default(e);try{as("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let i in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.opts.extraHeaders[i])}}catch(i){}if(this.method==="POST")try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(i){}try{t.setRequestHeader("Accept","*/*")}catch(i){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),t.onreadystatechange=()=>{t.readyState===4&&(t.status===200||t.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof t.status=="number"?t.status:0)},0))},as("xhr data %s",this.data),t.send(this.data)}catch(i){this.setTimeoutFn(()=>{this.onError(i)},0);return}typeof document!="undefined"&&(this.index=_o.requestsCount++,_o.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr=="undefined"||this.xhr===null)){if(this.xhr.onreadystatechange=Lje,e)try{this.xhr.abort()}catch(t){}typeof document!="undefined"&&delete _o.requests[this.index],this.xhr=null}}onLoad(){let e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};hf.Request=_o;_o.requestsCount=0;_o.requests={};if(typeof document!="undefined"){if(typeof attachEvent=="function")attachEvent("onunload",dce);else if(typeof addEventListener=="function"){let r="onpagehide"in Bje.default?"pagehide":"unload";addEventListener(r,dce,!1)}}function dce(){for(let r in _o.requests)_o.requests.hasOwnProperty(r)&&_o.requests[r].abort()}});var yce=m(vo=>{f();"use strict";var jje=vo&&vo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(vo,"__esModule",{value:!0});vo.defaultBinaryType=vo.usingBrowserWebSocket=vo.WebSocket=vo.nextTick=void 0;var pce=jje(sm());vo.nextTick=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0))();vo.WebSocket=pce.default.WebSocket||pce.default.MozWebSocket;vo.usingBrowserWebSocket=!0;vo.defaultBinaryType="arraybuffer"});var mce=m(p1=>{f();"use strict";var qje=p1&&p1.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(p1,"__esModule",{value:!0});p1.WS=void 0;var Uje=Nw(),Fje=Lw(),Kje=tT(),Vje=f1(),Ec=yce(),zje=qje(le()),Hje=nm(),$je=(0,zje.default)("engine.io-client:websocket"),gce=typeof navigator!="undefined"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",jw=class extends Uje.Transport{constructor(e){super(e);this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),t=this.opts.protocols,i=gce?{}:(0,Vje.pick)(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=Ec.usingBrowserWebSocket&&!gce?t?new Ec.WebSocket(e,t):new Ec.WebSocket(e):new Ec.WebSocket(e,t,i)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType||Ec.defaultBinaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let i=e[t],n=t===e.length-1;(0,Hje.encodePacket)(i,this.supportsBinary,s=>{let o={};Ec.usingBrowserWebSocket||(i.options&&(o.compress=i.options.compress),this.opts.perMessageDeflate&&(typeof s=="string"?Buffer.byteLength(s):s.length)<this.opts.perMessageDeflate.threshold&&(o.compress=!1));try{Ec.usingBrowserWebSocket?this.ws.send(s):this.ws.send(s,o)}catch(a){$je("websocket closed before onclose event")}n&&(0,Ec.nextTick)(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws!="undefined"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{},t=this.opts.secure?"wss":"ws",i="";this.opts.port&&(t==="wss"&&Number(this.opts.port)!==443||t==="ws"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=(0,Kje.yeast)()),this.supportsBinary||(e.b64=1);let n=(0,Fje.encode)(e),s=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(n.length?"?"+n:"")}check(){return!!Ec.WebSocket&&!("__initialize"in Ec.WebSocket&&this.name===jw.prototype.name)}};p1.WS=jw});var iT=m(qw=>{f();"use strict";Object.defineProperty(qw,"__esModule",{value:!0});qw.transports=void 0;var Gje=hce(),Wje=mce();qw.transports={websocket:Wje.WS,polling:Gje.Polling}});var nT=m(Uw=>{f();"use strict";Object.defineProperty(Uw,"__esModule",{value:!0});Uw.parse=void 0;var Yje=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Xje=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Qje(r){let e=r,t=r.indexOf("["),i=r.indexOf("]");t!=-1&&i!=-1&&(r=r.substring(0,t)+r.substring(t,i).replace(/:/g,";")+r.substring(i,r.length));let n=Yje.exec(r||""),s={},o=14;for(;o--;)s[Xje[o]]=n[o]||"";return t!=-1&&i!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=Zje(s,s.path),s.queryKey=Jje(s,s.query),s}Uw.parse=Qje;function Zje(r,e){let t=/\/{2,9}/g,i=e.replace(t,"/").split("/");return(e.substr(0,1)=="/"||e.length===0)&&i.splice(0,1),e.substr(e.length-1,1)=="/"&&i.splice(i.length-1,1),i}function Jje(r,e){let t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,n,s){n&&(t[n]=s)}),t}});var vce=m(y1=>{f();"use strict";var eqe=y1&&y1.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(y1,"__esModule",{value:!0});y1.Socket=void 0;var tqe=iT(),bce=f1(),rqe=Lw(),wce=nT(),iqe=eqe(le()),nqe=oh(),_ce=nm(),Wr=(0,iqe.default)("engine.io-client:socket"),Ru=class extends nqe.Emitter{constructor(e,t={}){super();e&&typeof e=="object"&&(t=e,e=null),e?(e=(0,wce.parse)(e),t.hostname=e.host,t.secure=e.protocol==="https"||e.protocol==="wss",t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=(0,wce.parse)(t.host).host),(0,bce.installTimerFunctions)(this,t),this.secure=t.secure!=null?t.secure:typeof location!="undefined"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location!="undefined"?location.hostname:"localhost"),this.port=t.port||(typeof location!="undefined"&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=(0,rqe.decode)(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){Wr('creating transport "%s"',e);let t=Object.assign({},this.opts.query);t.EIO=_ce.protocol,t.transport=e,this.id&&(t.sid=this.id);let i=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return Wr("options: %j",i),new tqe.transports[e](i)}open(){let e;if(this.opts.rememberUpgrade&&Ru.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch(t){Wr("error while creating transport: %s",t),this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){Wr("setting transport %s",e.name),this.transport&&(Wr("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",t=>this.onClose("transport close",t))}probe(e){Wr('probing transport "%s"',e);let t=this.createTransport(e),i=!1;Ru.priorWebsocketSuccess=!1;let n=()=>{i||(Wr('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",d=>{if(!i)if(d.type==="pong"&&d.data==="probe"){if(Wr('probe transport "%s" pong',e),this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Ru.priorWebsocketSuccess=t.name==="websocket",Wr('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{i||this.readyState!=="closed"&&(Wr("changing transport and sending upgrade packet"),l(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{Wr('probe transport "%s" failed',e);let h=new Error("probe error");h.transport=t.name,this.emitReserved("upgradeError",h)}}))};function s(){i||(i=!0,l(),t.close(),t=null)}let o=d=>{let h=new Error("probe error: "+d);h.transport=t.name,s(),Wr('probe transport "%s" failed because of error: %s',e,d),this.emitReserved("upgradeError",h)};function a(){o("transport closed")}function c(){o("socket closed")}function u(d){t&&d.name!==t.name&&(Wr('"%s" works - aborting "%s"',d.name,t.name),s())}let l=()=>{t.removeListener("open",n),t.removeListener("error",o),t.removeListener("close",a),this.off("close",c),this.off("upgrading",u)};t.once("open",n),t.once("error",o),t.once("close",a),this.once("close",c),this.once("upgrading",u),t.open()}onOpen(){if(Wr("socket open"),this.readyState="open",Ru.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){Wr("starting upgrade probes");let e=0,t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(Wr('socket receive: type "%s", data "%s"',e.type,e.data),this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}else Wr('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this.getWritablePackets();Wr("flushing %d packets in socket",e.length),this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let i=0;i<this.writeBuffer.length;i++){let n=this.writeBuffer[i].data;if(n&&(t+=(0,bce.byteLength)(n)),i>0&&t>this.maxPayload)return Wr("only send %d out of %d packets",i,this.writeBuffer.length),this.writeBuffer.slice(0,i);t+=2}return Wr("payload size is %d (max: %d)",t,this.maxPayload),this.writeBuffer}write(e,t,i){return this.sendPacket("message",e,t,i),this}send(e,t,i){return this.sendPacket("message",e,t,i),this}sendPacket(e,t,i,n){if(typeof t=="function"&&(n=t,t=void 0),typeof i=="function"&&(n=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;let s={type:e,data:t,options:i};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){let e=()=>{this.onClose("forced close"),Wr("socket closing - telling transport to close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},i=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}onError(e){Wr("socket error %j",e),Ru.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(Wr('socket close with reason: "%s"',e),this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){let t=[],i=0,n=e.length;for(;i<n;i++)~this.transports.indexOf(e[i])&&t.push(e[i]);return t}};y1.Socket=Ru;Ru.protocol=_ce.protocol});var sT=m(cs=>{f();"use strict";Object.defineProperty(cs,"__esModule",{value:!0});cs.parse=cs.installTimerFunctions=cs.transports=cs.Transport=cs.protocol=cs.Socket=void 0;var Ece=vce();Object.defineProperty(cs,"Socket",{enumerable:!0,get:function(){return Ece.Socket}});cs.protocol=Ece.Socket.protocol;var sqe=Nw();Object.defineProperty(cs,"Transport",{enumerable:!0,get:function(){return sqe.Transport}});var oqe=iT();Object.defineProperty(cs,"transports",{enumerable:!0,get:function(){return oqe.transports}});var aqe=f1();Object.defineProperty(cs,"installTimerFunctions",{enumerable:!0,get:function(){return aqe.installTimerFunctions}});var cqe=nT();Object.defineProperty(cs,"parse",{enumerable:!0,get:function(){return cqe.parse}})});var Rce=m(g1=>{f();"use strict";var uqe=g1&&g1.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(g1,"__esModule",{value:!0});g1.url=void 0;var lqe=sT(),fqe=uqe(le()),Sce=fqe.default("socket.io-client:url");function dqe(r,e="",t){let i=r;t=t||typeof location!="undefined"&&location,r==null&&(r=t.protocol+"//"+t.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=t.protocol+r:r=t.host+r),/^(https?|wss?):\/\//.test(r)||(Sce("protocol-less url %s",r),typeof t!="undefined"?r=t.protocol+"//"+r:r="https://"+r),Sce("parse %s",r),i=lqe.parse(r)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";let s=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port+e,i.href=i.protocol+"://"+s+(t&&t.port===i.port?"":":"+i.port),i}g1.url=dqe});var oT=m(m1=>{f();"use strict";Object.defineProperty(m1,"__esModule",{value:!0});m1.hasBinary=m1.isBinary=void 0;var hqe=typeof ArrayBuffer=="function",pqe=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,Ace=Object.prototype.toString,yqe=typeof Blob=="function"||typeof Blob!="undefined"&&Ace.call(Blob)==="[object BlobConstructor]",gqe=typeof File=="function"||typeof File!="undefined"&&Ace.call(File)==="[object FileConstructor]";function xce(r){return hqe&&(r instanceof ArrayBuffer||pqe(r))||yqe&&r instanceof Blob||gqe&&r instanceof File}m1.isBinary=xce;function Fw(r,e){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let t=0,i=r.length;t<i;t++)if(Fw(r[t]))return!0;return!1}if(xce(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return Fw(r.toJSON(),!0);for(let t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&Fw(r[t]))return!0;return!1}m1.hasBinary=Fw});var Ice=m(b1=>{f();"use strict";Object.defineProperty(b1,"__esModule",{value:!0});b1.reconstructPacket=b1.deconstructPacket=void 0;var mqe=oT();function bqe(r){let e=[],t=r.data,i=r;return i.data=aT(t,e),i.attachments=e.length,{packet:i,buffers:e}}b1.deconstructPacket=bqe;function aT(r,e){if(!r)return r;if(mqe.isBinary(r)){let t={_placeholder:!0,num:e.length};return e.push(r),t}else if(Array.isArray(r)){let t=new Array(r.length);for(let i=0;i<r.length;i++)t[i]=aT(r[i],e);return t}else if(typeof r=="object"&&!(r instanceof Date)){let t={};for(let i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=aT(r[i],e));return t}return r}function wqe(r,e){return r.data=cT(r.data,e),r.attachments=void 0,r}b1.reconstructPacket=wqe;function cT(r,e){if(!r)return r;if(r&&r._placeholder)return e[r.num];if(Array.isArray(r))for(let t=0;t<r.length;t++)r[t]=cT(r[t],e);else if(typeof r=="object")for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&(r[t]=cT(r[t],e));return r}});var Vw=m(ha=>{f();"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.Decoder=ha.Encoder=ha.PacketType=ha.protocol=void 0;var _qe=oh(),Tce=Ice(),Pce=oT(),vqe=le(),uT=vqe.default("socket.io-parser");ha.protocol=5;var Ci;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(Ci=ha.PacketType||(ha.PacketType={}));var Cce=class{constructor(e){this.replacer=e}encode(e){return uT("encoding packet %j",e),(e.type===Ci.EVENT||e.type===Ci.ACK)&&Pce.hasBinary(e)?(e.type=e.type===Ci.EVENT?Ci.BINARY_EVENT:Ci.BINARY_ACK,this.encodeAsBinary(e)):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===Ci.BINARY_EVENT||e.type===Ci.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),uT("encoded %j as %s",e,t),t}encodeAsBinary(e){let t=Tce.deconstructPacket(e),i=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(i),n}};ha.Encoder=Cce;var Kw=class extends _qe.Emitter{constructor(e){super();this.reviver=e}add(e){let t;if(typeof e=="string")t=this.decodeString(e),t.type===Ci.BINARY_EVENT||t.type===Ci.BINARY_ACK?(this.reconstructor=new Oce(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t);else if(Pce.isBinary(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0,i={type:Number(e.charAt(0))};if(Ci[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===Ci.BINARY_EVENT||i.type===Ci.BINARY_ACK){let s=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);let o=e.substring(s,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(e.charAt(t+1)==="/"){let s=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););i.nsp=e.substring(s,t)}else i.nsp="/";let n=e.charAt(t+1);if(n!==""&&Number(n)==n){let s=t+1;for(;++t;){let o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}i.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){let s=this.tryParse(e.substr(t));if(Kw.isPayloadValid(i.type,s))i.data=s;else throw new Error("invalid payload")}return uT("decoded %s as %j",e,i),i}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(t){return!1}}static isPayloadValid(e,t){switch(e){case Ci.CONNECT:return typeof t=="object";case Ci.DISCONNECT:return t===void 0;case Ci.CONNECT_ERROR:return typeof t=="string"||typeof t=="object";case Ci.EVENT:case Ci.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case Ci.ACK:case Ci.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}};ha.Decoder=Kw;var Oce=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let t=Tce.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}});var lT=m(zw=>{f();"use strict";Object.defineProperty(zw,"__esModule",{value:!0});zw.on=void 0;function Eqe(r,e,t){return r.on(e,t),function(){r.off(e,t)}}zw.on=Eqe});var fT=m(w1=>{f();"use strict";var Sqe=w1&&w1.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(w1,"__esModule",{value:!0});w1.Socket=void 0;var Eo=Vw(),Hw=lT(),Rqe=oh(),Aqe=Sqe(le()),us=Aqe.default("socket.io-client:socket"),xqe=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),kce=class extends Rqe.Emitter{constructor(e,t,i){super();this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,i&&i.auth&&(this.auth=i.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[Hw.on(e,"open",this.onopen.bind(this)),Hw.on(e,"packet",this.onpacket.bind(this)),Hw.on(e,"error",this.onerror.bind(this)),Hw.on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(xqe.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');t.unshift(e);let i={type:Eo.PacketType.EVENT,data:t};if(i.options={},i.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){let o=this.ids++;us("emitting packet with ack id %d",o);let a=t.pop();this._registerAckCallback(o,a),i.id=o}let n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)?us("discard packet as the transport is not currently writable"):this.connected?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i),this.flags={},this}_registerAckCallback(e,t){let i=this.flags.timeout;if(i===void 0){this.acks[e]=t;return}let n=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let s=0;s<this.sendBuffer.length;s++)this.sendBuffer[s].id===e&&(us("removing packet with ack id %d from the buffer",e),this.sendBuffer.splice(s,1));us("event with ack id %d has timed out after %d ms",e,i),t.call(this,new Error("operation has timed out"))},i);this.acks[e]=(...s)=>{this.io.clearTimeoutFn(n),t.apply(this,[null,...s])}}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){us("transport is open - connecting"),typeof this.auth=="function"?this.auth(e=>{this.packet({type:Eo.PacketType.CONNECT,data:e})}):this.packet({type:Eo.PacketType.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){us("close (%s)",e),this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Eo.PacketType.CONNECT:if(e.data&&e.data.sid){let n=e.data.sid;this.onconnect(n)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Eo.PacketType.EVENT:case Eo.PacketType.BINARY_EVENT:this.onevent(e);break;case Eo.PacketType.ACK:case Eo.PacketType.BINARY_ACK:this.onack(e);break;case Eo.PacketType.DISCONNECT:this.ondisconnect();break;case Eo.PacketType.CONNECT_ERROR:this.destroy();let i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){let t=e.data||[];us("emitting event %j",t),e.id!=null&&(us("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let t=this._anyListeners.slice();for(let i of t)i.apply(this,e)}super.emit.apply(this,e)}ack(e){let t=this,i=!1;return function(...n){i||(i=!0,us("sending ack %j",n),t.packet({type:Eo.PacketType.ACK,id:e,data:n}))}}onack(e){let t=this.acks[e.id];typeof t=="function"?(us("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):us("bad ack %s",e.id)}onconnect(e){us("socket connected with id %s",e),this.id=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){us("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(us("performing disconnect (%s)",this.nsp),this.packet({type:Eo.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let t=this._anyOutgoingListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let t=this._anyOutgoingListeners.slice();for(let i of t)i.apply(this,e.data)}}};w1.Socket=kce});var Dce=m($w=>{f();"use strict";Object.defineProperty($w,"__esModule",{value:!0});$w.Backoff=void 0;function _1(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}$w.Backoff=_1;_1.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*r);r=(Math.floor(e*10)&1)==0?r-t:r+t}return Math.min(r,this.max)|0};_1.prototype.reset=function(){this.attempts=0};_1.prototype.setMin=function(r){this.ms=r};_1.prototype.setMax=function(r){this.max=r};_1.prototype.setJitter=function(r){this.jitter=r}});var Lce=m(So=>{f();"use strict";var Iqe=So&&So.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Tqe=So&&So.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Pqe=So&&So.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Iqe(e,r,t);return Tqe(e,r),e},Cqe=So&&So.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(So,"__esModule",{value:!0});So.Manager=void 0;var Nce=sT(),Oqe=fT(),kqe=Pqe(Vw()),ah=lT(),Dqe=Dce(),Nqe=oh(),Bqe=Cqe(le()),un=Bqe.default("socket.io-client:manager"),Bce=class extends Nqe.Emitter{constructor(e,t){var i;super();this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Nce.installTimerFunctions(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((i=t.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new Dqe.Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;let n=t.parser||kqe;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(un("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;un("opening %s",this.uri),this.engine=new Nce.Socket(this.uri,this.opts);let t=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;let n=ah.on(t,"open",function(){i.onopen(),e&&e()}),s=ah.on(t,"error",o=>{un("error"),i.cleanup(),i._readyState="closed",this.emitReserved("error",o),e?e(o):i.maybeReconnectOnOpen()});if(this._timeout!==!1){let o=this._timeout;un("connect attempt will timeout after %d",o),o===0&&n();let a=this.setTimeoutFn(()=>{un("connect attempt timed out after %d",o),n(),t.close(),t.emit("error",new Error("timeout"))},o);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(n),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){un("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(ah.on(e,"ping",this.onping.bind(this)),ah.on(e,"data",this.ondata.bind(this)),ah.on(e,"error",this.onerror.bind(this)),ah.on(e,"close",this.onclose.bind(this)),ah.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){this.emitReserved("packet",e)}onerror(e){un("error",e),this.emitReserved("error",e)}socket(e,t){let i=this.nsps[e];return i||(i=new Oqe.Socket(this,e,t),this.nsps[e]=i),i}_destroy(e){let t=Object.keys(this.nsps);for(let i of t)if(this.nsps[i].active){un("socket %s is still active, skipping close",i);return}this._close()}_packet(e){un("writing packet %j",e);let t=this.encoder.encode(e);for(let i=0;i<t.length;i++)this.engine.write(t[i],e.options)}cleanup(){un("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){un("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){un("closed due to %s",e),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)un("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();un("will wait %dms before reconnect attempt",t),this._reconnecting=!0;let i=this.setTimeoutFn(()=>{e.skipReconnect||(un("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(un("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):(un("reconnect success"),e.onreconnect())}))},t);this.opts.autoUnref&&i.unref(),this.subs.push(function(){clearTimeout(i)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};So.Manager=Bce});var Uce=m((En,qce)=>{f();"use strict";var Lqe=En&&En.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(En,"__esModule",{value:!0});En.default=En.connect=En.io=En.Socket=En.Manager=En.protocol=void 0;var Mqe=Rce(),Gw=Lce();Object.defineProperty(En,"Manager",{enumerable:!0,get:function(){return Gw.Manager}});var Mce=fT();Object.defineProperty(En,"Socket",{enumerable:!0,get:function(){return Mce.Socket}});var jqe=Lqe(le()),jce=jqe.default("socket.io-client"),am={};function ch(r,e){typeof r=="object"&&(e=r,r=void 0),e=e||{};let t=Mqe.url(r,e.path||"/socket.io"),i=t.source,n=t.id,s=t.path,o=am[n]&&s in am[n].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o,c;return a?(jce("ignoring socket cache for %s",i),c=new Gw.Manager(i,e)):(am[n]||(jce("new io instance for %s",i),am[n]=new Gw.Manager(i,e)),c=am[n]),t.query&&!e.query&&(e.query=t.queryKey),c.socket(t.path,e)}En.io=ch;En.connect=ch;En.default=ch;Object.assign(ch,{Manager:Gw.Manager,Socket:Mce.Socket,io:ch,connect:ch});var qqe=Vw();Object.defineProperty(En,"protocol",{enumerable:!0,get:function(){return qqe.protocol}});qce.exports=ch});var dT=m((mTt,Fce)=>{f();var Uqe=z5();Fce.exports=r=>async e=>{e=Uqe(e);let t=b=>{typeof b.return=="function"&&b.return()},i=null,n=null,s=b=>{i=b,n&&n(b),t(e)},o=null,a=!1,c=()=>{a=!0,o&&o()},u=null,l=!1,d=()=>{l=!0,u&&u()},h=null,p=()=>{h&&h()},y=()=>new Promise((b,v)=>{o=h=b,n=v,r.once("drain",p)}),g=()=>(t(e),new Promise((b,v)=>{if(a||l||i)return b();u=o=b,n=v})),w=()=>{r.removeListener("error",s),r.removeListener("close",c),r.removeListener("finish",d),r.removeListener("drain",p)};r.once("error",s),r.once("close",c),r.once("finish",d);try{for await(let b of e){if(!r.writable||r.destroyed||i)break;r.write(b)===!1&&await y()}}catch(b){i||r.destroy(),i=b}try{if(r.writable&&r.end(),await g(),i)throw i}finally{w()}}});var hT=m((bTt,Kce)=>{f();var Fqe=dT(),Kqe=em();Kce.exports=r=>({sink:Fqe(r),source:Kqe(r)})});var zce=m((wTt,Vce)=>{f();var Vqe=hT();Vce.exports=r=>async function*(e){let t=Vqe(r),i;if(t.sink(e).catch(n=>{i=n}),yield*t.source,i)throw i}});var Hce=m((_Tt,v1)=>{f();v1.exports=em();v1.exports.source=em();v1.exports.sink=dT();v1.exports.transform=zce();v1.exports.duplex=hT()});var pT=m((vTt,Xce)=>{f();"use strict";var $ce=ua(),zqe=Hce(),{CLOSE_TIMEOUT:Hqe}=Cw(),Gce=MI(),Wce=le(),Ww=Wce("libp2p:webrtc-star:socket");Ww.error=Wce("libp2p:webrtc-star:socket:error");var Yce=(r,e)=>{if(!(!r||!e))try{return Gce(r,e)}catch(t){return Ww.error(t),Gce("0.0.0.0",e)}};Xce.exports=(r,e={})=>{let{sink:t,source:i}=zqe.duplex(r),n=e.remoteAddr||Yce(r.remoteAddress,r.remotePort),s=Yce(r.localAddress,r.localPort),o={async sink(a){e.signal&&(a=$ce(a,e.signal));try{await t(async function*(){for await(let c of a)yield c instanceof Uint8Array?c:c.slice()}())}catch(c){c.type!=="aborted"&&Ww.error(c)}},source:e.signal?$ce(i,e.signal):i,conn:r,localAddr:s,remoteAddr:n,timeline:{open:Date.now()},close(){if(!r.destroyed)return new Promise((a,c)=>{let u=Date.now(),l=setTimeout(()=>{if(o.remoteAddr){let{host:d,port:h}=o.remoteAddr.toOptions();Ww("timeout closing socket to %s:%s after %dms, destroying it manually",d,h,Date.now()-u)}r.destroyed||r.destroy()},Hqe);r.once("close",()=>{a()}),r.end(d=>{if(clearTimeout(l),o.timeline.close=Date.now(),d)return c(d)})})}};return r.once("close",()=>{o.timeline.close||(o.timeline.close=Date.now())}),o}});var yT=m((ETt,Zce)=>{f();"use strict";var{Multiaddr:Qce}=ft();function $qe(r){let e=r.toString().split("/"),t=r.protos()[1].name,i=r.protos()[2].name,n=r.stringTuples()[1][1];if(t!=="tcp"||i!=="ws"&&i!=="wss")throw new Error("invalid multiaddr: "+r.toString());if(!Qce.isName(r))return"http://"+e[2]+":"+e[4];if(i==="ws")return"http://"+e[2]+(n==="80"?"":":"+n);if(i==="wss")return"https://"+e[2]+(n==="443"?"":":"+n)}function Gqe(r){let e="/libp2p-webrtc-star";if(r.indexOf(e)!==-1){r=r.substring(e.length,r.length);let t=new Qce(r),i=t.stringTuples().filter(n=>n[0]===421)[0];t=t.decapsulate("p2p"),t=t.encapsulate("/p2p-webrtc-star"),t=t.encapsulate(`/p2p/${i[1]}`),r=t.toString()}return r}Zce.exports={cleanUrlSIO:$qe,cleanMultiaddr:Gqe}});var rue=m((STt,tue)=>{f();"use strict";var Wqe=Ut(),Jce=le(),uh=Jce("libp2p:webrtc-star:listener");uh.error=Jce("libp2p:webrtc-star:listener:error");var Yqe=VI(),Xqe=Uce(),Qqe=YI(),Zqe=Za(),Jqe=pT(),{cleanUrlSIO:eUe}=yT(),{CODE_P2P:eue}=Cw(),tUe={transports:["websocket"],"force new connection":!0,path:"/socket.io-next/"};tue.exports=({handler:r,upgrader:e},t,i={})=>{let n=new Wqe,s,o;return n.__connections=[],n.__spChannels=new Map,n.__pendingIntents=new Map,n.listen=a=>{if(s)throw Yqe(new Error("listener already in use"),"ERR_ALREADY_LISTENING");let c=Zqe();s=a;let u;!a.protoCodes().includes(eue)&&e.localPeer?u=a.encapsulate(`/p2p/${e.localPeer.toB58String()}`):u=a,n.on("error",()=>c.reject()),o=eUe(a),uh("Dialing to Signalling Server on: "+o),n.io=Xqe.connect(o,tUe);let l=d=>{if(d.answer||d.err||!d.intentId)return;let h=d.intentId,p=n.__pendingIntents.get(h);p||(p=[],n.__pendingIntents.set(h,p));let y=n.__spChannels.get(h);if(y){y.signal(d.signal);return}else if(d.signal.type!=="offer"){p.push(d);return}let g={trickle:!1,...i};t.wrtc&&(g.wrtc=t.wrtc),y=new Qqe(g);let w=b=>{uh.error("incoming connection errored",b)};y.on("error",w),y.once("close",(...b)=>{y.removeListener("error",w)}),y.on("signal",b=>{d.signal=b,d.answer=!0,n.io.emit("ss-handshake",d)}),y.signal(d.signal);for(let b of p)y.signal(b.signal);n.__pendingIntents.set(h,[]),y.once("connect",async()=>{let b=Jqe(y);uh("new inbound connection %s",b.remoteAddr);let v;try{v=await e.upgradeInbound(b)}catch(A){return uh.error("inbound connection failed to upgrade",A),b.close()}if(!v.remoteAddr)try{v.remoteAddr=a.decapsulateCode(eue).encapsulate(`/p2p/${v.remotePeer.toB58String()}`)}catch(A){uh.error("could not determine remote address",A)}uh("inbound connection %s upgraded",b.remoteAddr),rUe(n,b,h),n.emit("connection",v),r(v)}),n.__spChannels.set(h,y)};return n.io.once("connect_error",d=>c.reject(d)),n.io.once("error",d=>{n.emit("error",d),n.emit("close")}),n.io.on("ws-handshake",l),n.io.on("ws-peer",t._peerDiscovered),n.io.on("connect",()=>{n.io.emit("ss-join",u.toString())}),n.io.once("connect",()=>{n.emit("listening"),c.resolve()}),t.sigReferences.set(o,{listener:n,signallingAddr:u}),c.promise},n.close=async()=>{let a=t.sigReferences.get(o);a&&a.listener.io&&(a.listener.io.emit("ss-leave"),a.listener.io.close()),await Promise.all(n.__connections.map(c=>c.close())),n.emit("close"),n.removeAllListeners(),s=void 0,t.sigReferences.delete(o)},n.getAddrs=()=>[s],n};function rUe(r,e,t){r.__connections.push(e);let i=()=>{r.__connections=r.__connections.filter(n=>n!==e),r.__spChannels.delete(t),r.__pendingIntents.delete(t)};e.conn.once("close",i)}});var aue=m((RTt,oue)=>{f();"use strict";var iue=le(),Au=iue("libp2p:webrtc-star");Au.error=iue("libp2p:webrtc-star:error");var{EventEmitter:iUe}=Ut(),Yw=VI(),nUe=Q4(),{AbortError:nue}=ua(),sUe=YI(),{supportsWebRTCDataChannels:oUe}=Fae(),{Multiaddr:aUe}=ft(),cUe=Ff(),uUe=ot(),{CODE_CIRCUIT:lUe}=Cw(),fUe=rue(),dUe=pT(),{cleanMultiaddr:hUe,cleanUrlSIO:pUe}=yT();function yUe(){}var sue=class{constructor(e={}){if(!e.upgrader)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e.upgrader,this.sioOptions={transports:["websocket"],"force new connection":!0},e.wrtc&&(this.wrtc=e.wrtc),this.sigReferences=new Map,this.discovery=new iUe,this.discovery.tag="webRTCStar",this.discovery._isStarted=!1,this.discovery.start=()=>{this.discovery._isStarted=!0},this.discovery.stop=()=>{this.discovery._isStarted=!1},this._peerDiscovered=this._peerDiscovered.bind(this)}async dial(e,t={}){let i=await this._connect(e,t),n=dUe(i,{remoteAddr:e,signal:t.signal});Au("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return Au("outbound connection %s upgraded",n.remoteAddr),s}_connect(e,t={}){if(t.signal&&t.signal.aborted)throw new nue;let i={initiator:!0,trickle:!1,...t.spOptions||{}};this.wrtc&&(i.wrtc=this.wrtc);let n=e.toOptions(),s=(~~(Math.random()*1e9)).toString(36)+Date.now();return new Promise((o,a)=>{let c=this.sigReferences.get(pUe(e));if(!c||!c.listener)return a(Yw(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let u=c.listener.io,l=Date.now(),d;Au("dialing %s:%s",n.host,n.port);let h=new sUe(i),p=v=>{if(!d){let A=`connection error ${n.host}:${n.port}: ${v.message}`;Au.error(A),b(v)}},y=()=>{Au("connnection timeout %s:%s",n.host,n.port);let v=Yw(new Error(`connection timeout after ${Date.now()-l}ms`),"ERR_CONNECT_TIMEOUT");h.emit("error",v)},g=()=>{d=!0,Au("connection opened %s:%s",n.host,n.port),b(null)},w=()=>{Au.error("connection aborted %s:%s",n.host,n.port),h.destroy(),b(new nue)},b=v=>{h.removeListener("timeout",y),h.removeListener("connect",g),t.signal&&t.signal.removeEventListener("abort",w),v?a(v):o(h)};h.on("error",p),h.once("timeout",y),h.once("connect",g),h.on("close",()=>{h.removeListener("error",p)}),t.signal&&t.signal.addEventListener("abort",w),h.on("signal",v=>{u.emit("ss-handshake",{intentId:s,srcMultiaddr:c.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:v})}),u.on("ws-handshake",v=>{v.intentId===s&&v.err&&(h.destroy(),a(Yw(v.err instanceof Error?v.err:new Error(v.err),"ERR_SIGNALLING_FAILED"))),!(v.intentId!==s||!v.answer||h.destroyed)&&h.signal(v.signal)})})}createListener(e={},t){if(!oUe&&!this.wrtc)throw Yw(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");return typeof e=="function"&&(t=e,e={}),t=t||yUe,fUe({handler:t,upgrader:this._upgrader},this,e)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(t=>t.protoCodes().includes(lUe)?!1:cUe.WebRTCStar.matches(t))}_peerDiscovered(e){if(!this.discovery._isStarted)return;Au("Peer Discovered:",e),e=hUe(e);let t=new aUe(e),i=uUe.createFromB58String(t.getPeerId());this.discovery.emit("peer",{id:i,multiaddrs:[t]})}};oue.exports=nUe(sue,{className:"WebRTCStar",symbolName:"@libp2p/js-libp2p-webrtc-star/webrtcstar"})});var due=m((ATt,fue)=>{f();"use strict";var Xw=Wn(),cue=sn(),gT=10*1024,uue=class{constructor(){this._pool=new Uint8Array(gT),this._poolOffset=0}write(e){let t=this._pool,i=this._poolOffset;Xw.encode(e.id<<3|e.type,t,i),i+=Xw.encode.bytes,Xw.encode(e.data?e.data.length:0,t,i),i+=Xw.encode.bytes;let n=t.subarray(this._poolOffset,i);return gT-i<100?(this._pool=new Uint8Array(gT),this._poolOffset=0):this._poolOffset=i,e.data?[n,e.data]:n}},lue=new uue;fue.exports=r=>async function*(){for await(let t of r)Array.isArray(t)?yield new cue(t.map(i=>lue.write(i))):yield new cue(lue.write(t))}()});var yue=m((xTt,pue)=>{f();"use strict";var Qw=Wn(),gUe=sn();pue.exports=r=>async function*(){let t=new hue;for await(let i of r){let n=t.write(i);n.length&&(yield n)}}();var hue=class{constructor(){this._buffer=new gUe,this._bufferProxy=new Proxy({},{get:(e,t)=>t[0]==="l"?this._buffer[t]:this._buffer.get(parseInt(t))}),this._headerInfo=null}write(e){if(!e||!e.length)return[];this._buffer.append(e);let t=[];for(;this._buffer.length;){if(!this._headerInfo)try{this._headerInfo=this._decodeHeader(this._bufferProxy)}catch(c){break}let{id:i,type:n,length:s,offset:o}=this._headerInfo;if(this._buffer.length-o<s)break;t.push({id:i,type:n,data:this._buffer.shallowSlice(o,o+s)}),this._buffer.consume(o+s),this._headerInfo=null}return t}_decodeHeader(e){let t=Qw.decode(e),i=Qw.decode.bytes,n=Qw.decode(e,i);return i+=Qw.decode.bytes,{id:t>>3,type:t&7,offset:i,length:n}}}});var gue=m(mT=>{f();"use strict";mT.encode=due();mT.decode=yue()});var wT=m((TTt,bT)=>{f();"use strict";var mue=1<<20;bT.exports=r=>{r=r||mue;let e=t=>{if(t.data&&t.data.length>r)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return t=>async function*(){for await(let n of t)Array.isArray(n)?n.forEach(e):e(n),yield n}()};bT.exports.MAX_MSG_SIZE=mue});var _T=m(cm=>{f();"use strict";var xu=Object.freeze({NEW_STREAM:0,MESSAGE_RECEIVER:1,MESSAGE_INITIATOR:2,CLOSE_RECEIVER:3,CLOSE_INITIATOR:4,RESET_RECEIVER:5,RESET_INITIATOR:6});cm.MessageTypes=xu;cm.InitiatorMessageTypes=Object.freeze({NEW_STREAM:xu.NEW_STREAM,MESSAGE:xu.MESSAGE_INITIATOR,CLOSE:xu.CLOSE_INITIATOR,RESET:xu.RESET_INITIATOR});cm.ReceiverMessageTypes=Object.freeze({MESSAGE:xu.MESSAGE_RECEIVER,CLOSE:xu.CLOSE_RECEIVER,RESET:xu.RESET_RECEIVER});cm.MessageTypeNames=Object.freeze(Object.entries(xu).reduce((r,e)=>(r[e[1]]=e[0],r),{}))});var _ue=m((CTt,wue)=>{f();"use strict";function bue(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function mUe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return bue(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),bue(new n,t)}}wue.exports=mUe});var Sue=m((OTt,Eue)=>{f();"use strict";var bUe=ua(),um=le()("libp2p:mplex:stream"),wUe=Xa(),vue=sn(),_Ue=_ue(),{MAX_MSG_SIZE:vUe}=wT(),{InitiatorMessageTypes:EUe,ReceiverMessageTypes:SUe}=_T(),vT="ERR_MPLEX_STREAM_RESET",RUe="ERR_MPLEX_STREAM_ABORT";Eue.exports=({id:r,name:e,send:t,onEnd:i=()=>{},type:n="initiator",maxMsgSize:s=vUe})=>{let o=new AbortController,a=new AbortController,c=n==="initiator"?EUe:SUe,u=n==="initiator"?`i${r}`:`r${r}`;e=String(e??r);let l=!1,d=!1,h,p=w=>{l||(l=!0,um("%s stream %s source end",n,e,w),w&&!h&&(h=w),d&&(g.timeline.close=Date.now(),i(h)))},y=w=>{d||(d=!0,um("%s stream %s sink end",n,e,w),w&&!h&&(h=w),l&&(g.timeline.close=Date.now(),i(h)))},g={close:()=>g.source.end(),abort:w=>{um("%s stream %s abort",n,e,w),g.source.end(w),o.abort(),y(w)},reset:()=>{let w=_Ue(new Error("stream reset"),vT);a.abort(),g.source.end(w),y(w)},sink:async w=>{w=bUe(w,[{signal:o.signal,options:{abortMessage:"stream aborted",abortCode:RUe}},{signal:a.signal,options:{abortMessage:"stream reset",abortCode:vT}}]),n==="initiator"&&t({id:r,type:c.NEW_STREAM,data:e});try{for await(let b of w)for(;b.length;){if(b.length<=s){t({id:r,type:c.MESSAGE,data:b});break}b=vue.isBufferList(b)?b:new vue(b),t({id:r,type:c.MESSAGE,data:b.shallowSlice(0,s)}),b.consume(s)}}catch(b){return b.code===vT?um("%s stream %s reset",n,e):(um("%s stream %s error",n,e,b),t({id:r,type:c.RESET})),g.source.end(b),y(b)}t({id:r,type:c.CLOSE}),y()},source:wUe(p),timeline:{open:Date.now(),close:null},id:u};return g}});var Iue=m((kTt,xue)=>{f();"use strict";var AUe=dr(),xUe=Xa(),Iu=le()("libp2p:mplex"),IUe=ua(),Rue=gue(),TUe=wT(),{MessageTypes:lh,MessageTypeNames:Aue}=_T(),PUe=Sue(),ET=class{constructor(e){e=e||{},e=typeof e=="function"?{onStream:e}:e,this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._options=e,this.sink=this._createSink(),this.source=this._createSource(),this.onStream=e.onStream,this.onStreamEnd=e.onStreamEnd}get streams(){let e=[];return this._streams.initiators.forEach(t=>{e.push(t)}),this._streams.receivers.forEach(t=>{e.push(t)}),e}newStream(e){let t=this._streamId++;e=e==null?t.toString():String(e);let i=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:i})}_newReceiverStream({id:e,name:t}){let i=this._streams.receivers;return this._newStream({id:e,name:t,type:"receiver",registry:i})}_newStream({id:e,name:t,type:i,registry:n}){if(n.has(e))throw new Error(`${i} stream ${e} already exists!`);Iu("new %s stream %s %s",i,e,t);let a=PUe({id:e,name:t,send:c=>(Iu.enabled&&Iu("%s stream %s %s send",i,e,t,{...c,type:Aue[c.type],data:c.data&&c.data.slice()}),this.source.push(c)),type:i,onEnd:()=>{Iu("%s stream %s %s ended",i,e,t),n.delete(e),this.onStreamEnd&&this.onStreamEnd(a)},maxMsgSize:this._options.maxMsgSize});return n.set(e,a),a}_createSink(){return async e=>{this._options.signal&&(e=IUe(e,this._options.signal));try{await AUe(e,Rue.decode,TUe(this._options.maxMsgSize),async t=>{for await(let i of t)for(let n of i)this._handleIncoming(n)})}catch(t){return Iu("error in sink",t),this.source.end(t)}this.source.end()}}_createSource(){let t=xUe({onEnd:i=>{let{initiators:n,receivers:s}=this._streams;for(let o of n.values())o.abort(i);for(let o of s.values())o.abort(i)},writev:!0});return Object.assign(Rue.encode(t),{push:t.push,end:t.end,return:t.return})}_handleIncoming({id:e,type:t,data:i}){if(Iu.enabled&&Iu("incoming message",{id:e,type:Aue[t],data:i.slice()}),t===lh.NEW_STREAM&&this.onStream){let o=this._newReceiverStream({id:e,name:i.toString()});return this.onStream(o)}let s=(t&1?this._streams.initiators:this._streams.receivers).get(e);if(!s)return Iu("missing stream %s",e);switch(t){case lh.MESSAGE_INITIATOR:case lh.MESSAGE_RECEIVER:s.source.push(i);break;case lh.CLOSE_INITIATOR:case lh.CLOSE_RECEIVER:s.close();break;case lh.RESET_INITIATOR:case lh.RESET_RECEIVER:s.reset();break;default:Iu("unknown message type %s",t)}}};ET.multicodec="/mplex/6.7.0";xue.exports=ET});var Pue=m((DTt,Tue)=>{f();"use strict";Tue.exports=Iue()});var Oue=m(ST=>{f();"use strict";Object.defineProperty(ST,"__esModule",{value:!0});var Cue=65536,CUe=function(){function r(){this.isAvailable=!1,this.isInstantiated=!1;var e=typeof self!="undefined"?self.crypto||self.msCrypto:null;e&&e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return r.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var t=new Uint8Array(e),i=0;i<t.length;i+=Cue)this._crypto.getRandomValues(t.subarray(i,i+Math.min(t.length-i,Cue)));return t},r}();ST.BrowserRandomSource=CUe});var Sc=m(RT=>{f();"use strict";Object.defineProperty(RT,"__esModule",{value:!0});function OUe(r){for(var e=0;e<r.length;e++)r[e]=0;return r}RT.wipe=OUe});var kue=m(AT=>{f();"use strict";Object.defineProperty(AT,"__esModule",{value:!0});var kUe=Sc(),DUe=function(){function r(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof va!="undefined"){var e=Hf();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}return r.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var i=new Uint8Array(e),n=0;n<i.length;n++)i[n]=t[n];return kUe.wipe(t),i},r}();AT.NodeRandomSource=DUe});var Due=m(xT=>{f();"use strict";Object.defineProperty(xT,"__esModule",{value:!0});var NUe=Oue(),BUe=kue(),LUe=function(){function r(){if(this.isAvailable=!1,this.name="",this._source=new NUe.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new BUe.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}return r.prototype.randomBytes=function(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)},r}();xT.SystemRandomSource=LUe});var Nue=m(Is=>{f();"use strict";Object.defineProperty(Is,"__esModule",{value:!0});function MUe(r,e){var t=r>>>16&65535,i=r&65535,n=e>>>16&65535,s=e&65535;return i*s+(t*s+i*n<<16>>>0)|0}Is.mul=Math.imul||MUe;function jUe(r,e){return r+e|0}Is.add=jUe;function qUe(r,e){return r-e|0}Is.sub=qUe;function UUe(r,e){return r<<e|r>>>32-e}Is.rotl=UUe;function FUe(r,e){return r<<32-e|r>>>e}Is.rotr=FUe;function KUe(r){return typeof r=="number"&&isFinite(r)&&Math.floor(r)===r}Is.isInteger=Number.isInteger||KUe;Is.MAX_SAFE_INTEGER=9007199254740991;Is.isSafeInteger=function(r){return Is.isInteger(r)&&r>=-Is.MAX_SAFE_INTEGER&&r<=Is.MAX_SAFE_INTEGER}});var lm=m(Et=>{f();"use strict";Object.defineProperty(Et,"__esModule",{value:!0});var Bue=Nue();function VUe(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])<<16>>16}Et.readInt16BE=VUe;function zUe(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])>>>0}Et.readUint16BE=zUe;function HUe(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])<<16>>16}Et.readInt16LE=HUe;function $Ue(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])>>>0}Et.readUint16LE=$Ue;function Lue(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>8,e[t+1]=r>>>0,e}Et.writeUint16BE=Lue;Et.writeInt16BE=Lue;function Mue(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e}Et.writeUint16LE=Mue;Et.writeInt16LE=Mue;function IT(r,e){return e===void 0&&(e=0),r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}Et.readInt32BE=IT;function TT(r,e){return e===void 0&&(e=0),(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}Et.readUint32BE=TT;function PT(r,e){return e===void 0&&(e=0),r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]}Et.readInt32LE=PT;function CT(r,e){return e===void 0&&(e=0),(r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e])>>>0}Et.readUint32LE=CT;function Zw(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}Et.writeUint32BE=Zw;Et.writeInt32BE=Zw;function Jw(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24,e}Et.writeUint32LE=Jw;Et.writeInt32LE=Jw;function GUe(r,e){e===void 0&&(e=0);var t=IT(r,e),i=IT(r,e+4);return t*4294967296+i-(i>>31)*4294967296}Et.readInt64BE=GUe;function WUe(r,e){e===void 0&&(e=0);var t=TT(r,e),i=TT(r,e+4);return t*4294967296+i}Et.readUint64BE=WUe;function YUe(r,e){e===void 0&&(e=0);var t=PT(r,e),i=PT(r,e+4);return i*4294967296+t-(t>>31)*4294967296}Et.readInt64LE=YUe;function XUe(r,e){e===void 0&&(e=0);var t=CT(r,e),i=CT(r,e+4);return i*4294967296+t}Et.readUint64LE=XUe;function jue(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Zw(r/4294967296>>>0,e,t),Zw(r>>>0,e,t+4),e}Et.writeUint64BE=jue;Et.writeInt64BE=jue;function que(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Jw(r>>>0,e,t),Jw(r/4294967296>>>0,e,t+4),e}Et.writeUint64LE=que;Et.writeInt64LE=que;function QUe(r,e,t){if(t===void 0&&(t=0),r%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=r/8+t-1;s>=t;s--)i+=e[s]*n,n*=256;return i}Et.readUintBE=QUe;function ZUe(r,e,t){if(t===void 0&&(t=0),r%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=t;s<t+r/8;s++)i+=e[s]*n,n*=256;return i}Et.readUintLE=ZUe;function JUe(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Bue.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=r/8+i-1;s>=i;s--)t[s]=e/n&255,n*=256;return t}Et.writeUintBE=JUe;function eFe(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Bue.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+r/8;s++)t[s]=e/n&255,n*=256;return t}Et.writeUintLE=eFe;function tFe(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e)}Et.readFloat32BE=tFe;function rFe(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e,!0)}Et.readFloat32LE=rFe;function iFe(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e)}Et.readFloat64BE=iFe;function nFe(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e,!0)}Et.readFloat64LE=nFe;function sFe(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r),e}Et.writeFloat32BE=sFe;function oFe(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r,!0),e}Et.writeFloat32LE=oFe;function aFe(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r),e}Et.writeFloat64BE=aFe;function cFe(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r,!0),e}Et.writeFloat64LE=cFe});var Vue=m(pa=>{f();"use strict";Object.defineProperty(pa,"__esModule",{value:!0});var uFe=Due(),lFe=lm(),Uue=Sc();pa.defaultRandomSource=new uFe.SystemRandomSource;function OT(r,e){return e===void 0&&(e=pa.defaultRandomSource),e.randomBytes(r)}pa.randomBytes=OT;function fFe(r){r===void 0&&(r=pa.defaultRandomSource);var e=OT(4,r),t=lFe.readUint32LE(e);return Uue.wipe(e),t}pa.randomUint32=fFe;var Fue="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function Kue(r,e,t){if(e===void 0&&(e=Fue),t===void 0&&(t=pa.defaultRandomSource),e.length<2)throw new Error("randomString charset is too short");if(e.length>256)throw new Error("randomString charset is too long");for(var i="",n=e.length,s=256-256%n;r>0;){for(var o=OT(Math.ceil(r*256/s),t),a=0;a<o.length&&r>0;a++){var c=o[a];c<s&&(i+=e.charAt(c%n),r--)}Uue.wipe(o)}return i}pa.randomString=Kue;function dFe(r,e,t){e===void 0&&(e=Fue),t===void 0&&(t=pa.defaultRandomSource);var i=Math.ceil(r/(Math.log(e.length)/Math.LN2));return Kue(i,e,t)}pa.randomStringForEntropy=dFe});var r8=m(ls=>{f();"use strict";Object.defineProperty(ls,"__esModule",{value:!0});var hFe=Vue(),pFe=Sc();ls.PUBLIC_KEY_LENGTH=32;ls.SECRET_KEY_LENGTH=32;ls.SHARED_KEY_LENGTH=32;function Rc(r){var e=new Float64Array(16);if(r)for(var t=0;t<r.length;t++)e[t]=r[t];return e}var zue=new Uint8Array(32);zue[0]=9;var yFe=Rc([56129,1]);function kT(r){for(var e=1,t=0;t<16;t++){var i=r[t]+e+65535;e=Math.floor(i/65536),r[t]=i-e*65536}r[0]+=e-1+37*(e-1)}function fm(r,e,t){for(var i=~(t-1),n=0;n<16;n++){var s=i&(r[n]^e[n]);r[n]^=s,e[n]^=s}}function gFe(r,e){for(var t=Rc(),i=Rc(),n=0;n<16;n++)i[n]=e[n];kT(i),kT(i),kT(i);for(var s=0;s<2;s++){t[0]=i[0]-65517;for(var n=1;n<15;n++)t[n]=i[n]-65535-(t[n-1]>>16&1),t[n-1]&=65535;t[15]=i[15]-32767-(t[14]>>16&1);var o=t[15]>>16&1;t[14]&=65535,fm(i,t,1-o)}for(var n=0;n<16;n++)r[2*n]=i[n]&255,r[2*n+1]=i[n]>>8}function mFe(r,e){for(var t=0;t<16;t++)r[t]=e[2*t]+(e[2*t+1]<<8);r[15]&=32767}function e8(r,e,t){for(var i=0;i<16;i++)r[i]=e[i]+t[i]}function t8(r,e,t){for(var i=0;i<16;i++)r[i]=e[i]-t[i]}function Tu(r,e,t){var i,n,s=0,o=0,a=0,c=0,u=0,l=0,d=0,h=0,p=0,y=0,g=0,w=0,b=0,v=0,A=0,k=0,C=0,T=0,D=0,j=0,M=0,se=0,ie=0,fe=0,pe=0,Le=0,Re=0,De=0,ne=0,je=0,ut=0,Ye=t[0],Xe=t[1],de=t[2],J=t[3],Ee=t[4],qe=t[5],ze=t[6],Te=t[7],at=t[8],I=t[9],O=t[10],N=t[11],Y=t[12],F=t[13],W=t[14],ee=t[15];i=e[0],s+=i*Ye,o+=i*Xe,a+=i*de,c+=i*J,u+=i*Ee,l+=i*qe,d+=i*ze,h+=i*Te,p+=i*at,y+=i*I,g+=i*O,w+=i*N,b+=i*Y,v+=i*F,A+=i*W,k+=i*ee,i=e[1],o+=i*Ye,a+=i*Xe,c+=i*de,u+=i*J,l+=i*Ee,d+=i*qe,h+=i*ze,p+=i*Te,y+=i*at,g+=i*I,w+=i*O,b+=i*N,v+=i*Y,A+=i*F,k+=i*W,C+=i*ee,i=e[2],a+=i*Ye,c+=i*Xe,u+=i*de,l+=i*J,d+=i*Ee,h+=i*qe,p+=i*ze,y+=i*Te,g+=i*at,w+=i*I,b+=i*O,v+=i*N,A+=i*Y,k+=i*F,C+=i*W,T+=i*ee,i=e[3],c+=i*Ye,u+=i*Xe,l+=i*de,d+=i*J,h+=i*Ee,p+=i*qe,y+=i*ze,g+=i*Te,w+=i*at,b+=i*I,v+=i*O,A+=i*N,k+=i*Y,C+=i*F,T+=i*W,D+=i*ee,i=e[4],u+=i*Ye,l+=i*Xe,d+=i*de,h+=i*J,p+=i*Ee,y+=i*qe,g+=i*ze,w+=i*Te,b+=i*at,v+=i*I,A+=i*O,k+=i*N,C+=i*Y,T+=i*F,D+=i*W,j+=i*ee,i=e[5],l+=i*Ye,d+=i*Xe,h+=i*de,p+=i*J,y+=i*Ee,g+=i*qe,w+=i*ze,b+=i*Te,v+=i*at,A+=i*I,k+=i*O,C+=i*N,T+=i*Y,D+=i*F,j+=i*W,M+=i*ee,i=e[6],d+=i*Ye,h+=i*Xe,p+=i*de,y+=i*J,g+=i*Ee,w+=i*qe,b+=i*ze,v+=i*Te,A+=i*at,k+=i*I,C+=i*O,T+=i*N,D+=i*Y,j+=i*F,M+=i*W,se+=i*ee,i=e[7],h+=i*Ye,p+=i*Xe,y+=i*de,g+=i*J,w+=i*Ee,b+=i*qe,v+=i*ze,A+=i*Te,k+=i*at,C+=i*I,T+=i*O,D+=i*N,j+=i*Y,M+=i*F,se+=i*W,ie+=i*ee,i=e[8],p+=i*Ye,y+=i*Xe,g+=i*de,w+=i*J,b+=i*Ee,v+=i*qe,A+=i*ze,k+=i*Te,C+=i*at,T+=i*I,D+=i*O,j+=i*N,M+=i*Y,se+=i*F,ie+=i*W,fe+=i*ee,i=e[9],y+=i*Ye,g+=i*Xe,w+=i*de,b+=i*J,v+=i*Ee,A+=i*qe,k+=i*ze,C+=i*Te,T+=i*at,D+=i*I,j+=i*O,M+=i*N,se+=i*Y,ie+=i*F,fe+=i*W,pe+=i*ee,i=e[10],g+=i*Ye,w+=i*Xe,b+=i*de,v+=i*J,A+=i*Ee,k+=i*qe,C+=i*ze,T+=i*Te,D+=i*at,j+=i*I,M+=i*O,se+=i*N,ie+=i*Y,fe+=i*F,pe+=i*W,Le+=i*ee,i=e[11],w+=i*Ye,b+=i*Xe,v+=i*de,A+=i*J,k+=i*Ee,C+=i*qe,T+=i*ze,D+=i*Te,j+=i*at,M+=i*I,se+=i*O,ie+=i*N,fe+=i*Y,pe+=i*F,Le+=i*W,Re+=i*ee,i=e[12],b+=i*Ye,v+=i*Xe,A+=i*de,k+=i*J,C+=i*Ee,T+=i*qe,D+=i*ze,j+=i*Te,M+=i*at,se+=i*I,ie+=i*O,fe+=i*N,pe+=i*Y,Le+=i*F,Re+=i*W,De+=i*ee,i=e[13],v+=i*Ye,A+=i*Xe,k+=i*de,C+=i*J,T+=i*Ee,D+=i*qe,j+=i*ze,M+=i*Te,se+=i*at,ie+=i*I,fe+=i*O,pe+=i*N,Le+=i*Y,Re+=i*F,De+=i*W,ne+=i*ee,i=e[14],A+=i*Ye,k+=i*Xe,C+=i*de,T+=i*J,D+=i*Ee,j+=i*qe,M+=i*ze,se+=i*Te,ie+=i*at,fe+=i*I,pe+=i*O,Le+=i*N,Re+=i*Y,De+=i*F,ne+=i*W,je+=i*ee,i=e[15],k+=i*Ye,C+=i*Xe,T+=i*de,D+=i*J,j+=i*Ee,M+=i*qe,se+=i*ze,ie+=i*Te,fe+=i*at,pe+=i*I,Le+=i*O,Re+=i*N,De+=i*Y,ne+=i*F,je+=i*W,ut+=i*ee,s+=38*C,o+=38*T,a+=38*D,c+=38*j,u+=38*M,l+=38*se,d+=38*ie,h+=38*fe,p+=38*pe,y+=38*Le,g+=38*Re,w+=38*De,b+=38*ne,v+=38*je,A+=38*ut,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=w+n+65535,n=Math.floor(i/65536),w=i-n*65536,i=b+n+65535,n=Math.floor(i/65536),b=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=k+n+65535,n=Math.floor(i/65536),k=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=w+n+65535,n=Math.floor(i/65536),w=i-n*65536,i=b+n+65535,n=Math.floor(i/65536),b=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=k+n+65535,n=Math.floor(i/65536),k=i-n*65536,s+=n-1+37*(n-1),r[0]=s,r[1]=o,r[2]=a,r[3]=c,r[4]=u,r[5]=l,r[6]=d,r[7]=h,r[8]=p,r[9]=y,r[10]=g,r[11]=w,r[12]=b,r[13]=v,r[14]=A,r[15]=k}function dm(r,e){Tu(r,e,e)}function bFe(r,e){for(var t=Rc(),i=0;i<16;i++)t[i]=e[i];for(var i=253;i>=0;i--)dm(t,t),i!==2&&i!==4&&Tu(t,t,e);for(var i=0;i<16;i++)r[i]=t[i]}function DT(r,e){for(var t=new Uint8Array(32),i=new Float64Array(80),n=Rc(),s=Rc(),o=Rc(),a=Rc(),c=Rc(),u=Rc(),l=0;l<31;l++)t[l]=r[l];t[31]=r[31]&127|64,t[0]&=248,mFe(i,e);for(var l=0;l<16;l++)s[l]=i[l];n[0]=a[0]=1;for(var l=254;l>=0;--l){var d=t[l>>>3]>>>(l&7)&1;fm(n,s,d),fm(o,a,d),e8(c,n,o),t8(n,n,o),e8(o,s,a),t8(s,s,a),dm(a,c),dm(u,n),Tu(n,o,n),Tu(o,s,c),e8(c,n,o),t8(n,n,o),dm(s,n),t8(o,a,u),Tu(n,o,yFe),e8(n,n,a),Tu(o,o,n),Tu(n,a,u),Tu(a,s,i),dm(s,c),fm(n,s,d),fm(o,a,d)}for(var l=0;l<16;l++)i[l+16]=n[l],i[l+32]=o[l],i[l+48]=s[l],i[l+64]=a[l];var h=i.subarray(32),p=i.subarray(16);bFe(h,h),Tu(p,p,h);var y=new Uint8Array(32);return gFe(y,p),y}ls.scalarMult=DT;function Hue(r){return DT(r,zue)}ls.scalarMultBase=Hue;function $ue(r){if(r.length!==ls.SECRET_KEY_LENGTH)throw new Error("x25519: seed must be "+ls.SECRET_KEY_LENGTH+" bytes");var e=new Uint8Array(r),t=Hue(e);return{publicKey:t,secretKey:e}}ls.generateKeyPairFromSeed=$ue;function wFe(r){var e=hFe.randomBytes(32,r),t=$ue(e);return pFe.wipe(e),t}ls.generateKeyPair=wFe;function _Fe(r,e,t){if(t===void 0&&(t=!1),r.length!==ls.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(e.length!==ls.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");var i=DT(r,e);if(t){for(var n=0,s=0;s<i.length;s++)n|=i[s];if(n===0)throw new Error("X25519: invalid shared key")}return i}ls.sharedKey=_Fe});var fh=m((KTt,Gue)=>{f();"use strict";var vFe=ib(),EFe=Xa(),SFe=Za();Gue.exports=r=>{let e=EFe(),t=vFe(r.source),i=SFe(),n,s=r.sink(async function*(){yield*e,yield*await i.promise}());return s.catch(a=>{n=a}),{reader:t,writer:e,stream:{sink:a=>n?Promise.reject(n):(i.resolve(a),s),source:t},rest:()=>e.end(),write:e.push,read:async()=>(await t.next()).value}}});var Xue=m((VTt,Yue)=>{f();"use strict";var RFe=fh(),Wue=go();Yue.exports=(r,e={})=>{let t=RFe(r),i=Wue.decode.fromReader(t.reader,e),n=!1,s={read:async o=>{let{value:a,done:c}=await t.reader.next(o);if(c&&a.length<o)throw new Error("Couldn't read enough bytes");if(n=c,!a)throw new Error("Value is null");return a},readLP:async()=>{let{value:o,done:a}=await i.next();if(n=a,!o)throw new Error("Value is null");return o},readPB:async o=>{let a=await s.readLP();if(!a)throw new Error("Value is null");let c=a instanceof Uint8Array?a:a.slice();return o.decode(c)},write:o=>{t.writer.push(o)},writeLP:o=>{s.write(Wue.encode.single(o,e))},writePB:(o,a)=>{s.writeLP(a.encode(o))},pb:o=>({read:()=>s.readPB(o),write:a=>s.writePB(a,o)}),unwrap:()=>(t.rest(),t.stream)};return s}});var Zue=m((zTt,Que)=>{f();"use strict";var AFe=z5();Que.exports=function(){let e,t,i=async s=>{if(e)throw new Error("already piped");e=AFe(s),t&&t(e)},n={[Symbol.asyncIterator](){return this},next(){return e?e.next():new Promise(s=>{t=o=>{t=null,s(o.next())}})}};return{sink:i,source:n}}});var tle=m((HTt,ele)=>{f();var Jue=Zue();ele.exports=function(){var r=Jue(),e=Jue();return[{source:r.source,sink:e.sink},{source:e.source,sink:r.sink}]}});var s8=m(($Tt,hm)=>{f();"use strict";var{Buffer:i8}=ci(),n8=sn();hm.exports=async function*(r){for await(let e of r)i8.isBuffer(e)?yield e:n8.isBufferList(e)?yield e.slice():yield i8.from(e)};hm.exports.toBuffer=hm.exports;hm.exports.toList=async function*(r){for await(let e of r)i8.isBuffer(e)?yield new n8().append(e):n8.isBufferList(e)?yield e:yield new n8().append(i8.from(e))}});var rle=m(NT=>{f();"use strict";Object.defineProperty(NT,"__esModule",{value:!0});function xFe(r){return typeof r.saveState!="undefined"&&typeof r.restoreState!="undefined"&&typeof r.cleanSavedState!="undefined"}NT.isSerializableHash=xFe});var o8=m(E1=>{f();"use strict";Object.defineProperty(E1,"__esModule",{value:!0});function IFe(r,e,t){return~(r-1)&e|r-1&t}E1.select=IFe;function TFe(r,e){return(r|0)-(e|0)-1>>>31&1}E1.lessOrEqual=TFe;function ile(r,e){if(r.length!==e.length)return 0;for(var t=0,i=0;i<r.length;i++)t|=r[i]^e[i];return 1&t-1>>>8}E1.compare=ile;function PFe(r,e){return r.length===0||e.length===0?!1:ile(r,e)!==0}E1.equal=PFe});var sle=m(pm=>{f();"use strict";Object.defineProperty(pm,"__esModule",{value:!0});var Ac=rle(),CFe=o8(),OFe=Sc(),nle=function(){function r(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(i).clean():i.set(t);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=54^92;this._outer.update(i),Ac.isSerializableHash(this._inner)&&Ac.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),OFe.wipe(i)}return r.prototype.reset=function(){if(!Ac.isSerializableHash(this._inner)||!Ac.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){Ac.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Ac.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(e){return this._inner.update(e),this},r.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(!Ac.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(e){if(!Ac.isSerializableHash(this._inner)||!Ac.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(e){if(!Ac.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},r}();pm.HMAC=nle;function kFe(r,e,t){var i=new nle(r,e);i.update(t);var n=i.digest();return i.clean(),n}pm.hmac=kFe;pm.equal=CFe.equal});var cle=m(BT=>{f();"use strict";Object.defineProperty(BT,"__esModule",{value:!0});var ole=sle(),ale=Sc(),DFe=function(){function r(e,t,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=ole.hmac(this._hash,i,t);this._hmac=new ole.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(e){for(var t=new Uint8Array(e),i=0;i<t.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[i]=this._buffer[this._bufpos++];return t},r.prototype.clean=function(){this._hmac.clean(),ale.wipe(this._buffer),ale.wipe(this._counter),this._bufpos=0},r}();BT.HKDF=DFe});var MT=m(pf=>{f();"use strict";Object.defineProperty(pf,"__esModule",{value:!0});var a8=lm(),c8=Sc();pf.DIGEST_LENGTH=32;pf.BLOCK_SIZE=64;var ule=function(){function r(){this.digestLength=pf.DIGEST_LENGTH,this.blockSize=pf.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return r.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},r.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},r.prototype.clean=function(){c8.wipe(this._buffer),c8.wipe(this._temp),this.reset()},r.prototype.update=function(e,t){if(t===void 0&&(t=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var i=0;if(this._bytesHashed+=t,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&t>0;)this._buffer[this._bufferLength++]=e[i++],t--;this._bufferLength===this.blockSize&&(LT(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(t>=this.blockSize&&(i=LT(this._temp,this._state,e,i,t),t%=this.blockSize);t>0;)this._buffer[this._bufferLength++]=e[i++],t--;return this},r.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,i=this._bufferLength,n=t/536870912|0,s=t<<3,o=t%64<56?64:128;this._buffer[i]=128;for(var a=i+1;a<o-8;a++)this._buffer[a]=0;a8.writeUint32BE(n,this._buffer,o-8),a8.writeUint32BE(s,this._buffer,o-4),LT(this._temp,this._state,this._buffer,0,o),this._finished=!0}for(var a=0;a<this.digestLength/4;a++)a8.writeUint32BE(this._state[a],e,a*4);return this},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},r.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},r.prototype.cleanSavedState=function(e){c8.wipe(e.state),e.buffer&&c8.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},r}();pf.SHA256=ule;var NFe=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function LT(r,e,t,i,n){for(;n>=64;){for(var s=e[0],o=e[1],a=e[2],c=e[3],u=e[4],l=e[5],d=e[6],h=e[7],p=0;p<16;p++){var y=i+p*4;r[p]=a8.readUint32BE(t,y)}for(var p=16;p<64;p++){var g=r[p-2],w=(g>>>17|g<<32-17)^(g>>>19|g<<32-19)^g>>>10;g=r[p-15];var b=(g>>>7|g<<32-7)^(g>>>18|g<<32-18)^g>>>3;r[p]=(w+r[p-7]|0)+(b+r[p-16]|0)}for(var p=0;p<64;p++){var w=(((u>>>6|u<<32-6)^(u>>>11|u<<32-11)^(u>>>25|u<<32-25))+(u&l^~u&d)|0)+(h+(NFe[p]+r[p]|0)|0)|0,b=((s>>>2|s<<32-2)^(s>>>13|s<<32-13)^(s>>>22|s<<32-22))+(s&o^s&a^o&a)|0;h=d,d=l,l=u,u=c+w|0,c=a,a=o,o=s,s=w+b|0}e[0]+=s,e[1]+=o,e[2]+=a,e[3]+=c,e[4]+=u,e[5]+=l,e[6]+=d,e[7]+=h,i+=64,n-=64}return i}function BFe(r){var e=new ule;e.update(r);var t=e.digest();return e.clean(),t}pf.hash=BFe});var fle=m((lle,ym)=>{f();"use strict";(function(r,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof va=="function"&&typeof ym=="object"&&ym&&ym.exports&&(ym.exports=e(Br()))})(lle,function(r){"use strict";var e=r.Reader,t=r.Writer,i=r.util,n=r.roots["libp2p-noise"]||(r.roots["libp2p-noise"]={});return n.pb=function(){var s={};return s.NoiseHandshakePayload=function(){function o(a){if(a)for(var c=Object.keys(a),u=0;u<c.length;++u)a[c[u]]!=null&&(this[c[u]]=a[c[u]])}return o.prototype.identityKey=i.newBuffer([]),o.prototype.identitySig=i.newBuffer([]),o.prototype.data=i.newBuffer([]),o.create=function(c){return new o(c)},o.encode=function(c,u){return u||(u=t.create()),c.identityKey!=null&&Object.hasOwnProperty.call(c,"identityKey")&&u.uint32(10).bytes(c.identityKey),c.identitySig!=null&&Object.hasOwnProperty.call(c,"identitySig")&&u.uint32(18).bytes(c.identitySig),c.data!=null&&Object.hasOwnProperty.call(c,"data")&&u.uint32(26).bytes(c.data),u},o.encodeDelimited=function(c,u){return this.encode(c,u).ldelim()},o.decode=function(c,u){c instanceof e||(c=e.create(c));for(var l=u===void 0?c.len:c.pos+u,d=new n.pb.NoiseHandshakePayload;c.pos<l;){var h=c.uint32();switch(h>>>3){case 1:d.identityKey=c.bytes();break;case 2:d.identitySig=c.bytes();break;case 3:d.data=c.bytes();break;default:c.skipType(h&7);break}}return d},o.decodeDelimited=function(c){return c instanceof e||(c=new e(c)),this.decode(c,c.uint32())},o.verify=function(c){return typeof c!="object"||c===null?"object expected":c.identityKey!=null&&c.hasOwnProperty("identityKey")&&!(c.identityKey&&typeof c.identityKey.length=="number"||i.isString(c.identityKey))?"identityKey: buffer expected":c.identitySig!=null&&c.hasOwnProperty("identitySig")&&!(c.identitySig&&typeof c.identitySig.length=="number"||i.isString(c.identitySig))?"identitySig: buffer expected":c.data!=null&&c.hasOwnProperty("data")&&!(c.data&&typeof c.data.length=="number"||i.isString(c.data))?"data: buffer expected":null},o.fromObject=function(c){if(c instanceof n.pb.NoiseHandshakePayload)return c;var u=new n.pb.NoiseHandshakePayload;return c.identityKey!=null&&(typeof c.identityKey=="string"?i.base64.decode(c.identityKey,u.identityKey=i.newBuffer(i.base64.length(c.identityKey)),0):c.identityKey.length&&(u.identityKey=c.identityKey)),c.identitySig!=null&&(typeof c.identitySig=="string"?i.base64.decode(c.identitySig,u.identitySig=i.newBuffer(i.base64.length(c.identitySig)),0):c.identitySig.length&&(u.identitySig=c.identitySig)),c.data!=null&&(typeof c.data=="string"?i.base64.decode(c.data,u.data=i.newBuffer(i.base64.length(c.data)),0):c.data.length&&(u.data=c.data)),u},o.toObject=function(c,u){u||(u={});var l={};return u.defaults&&(u.bytes===String?l.identityKey="":(l.identityKey=[],u.bytes!==Array&&(l.identityKey=i.newBuffer(l.identityKey))),u.bytes===String?l.identitySig="":(l.identitySig=[],u.bytes!==Array&&(l.identitySig=i.newBuffer(l.identitySig))),u.bytes===String?l.data="":(l.data=[],u.bytes!==Array&&(l.data=i.newBuffer(l.data)))),c.identityKey!=null&&c.hasOwnProperty("identityKey")&&(l.identityKey=u.bytes===String?i.base64.encode(c.identityKey,0,c.identityKey.length):u.bytes===Array?Array.prototype.slice.call(c.identityKey):c.identityKey),c.identitySig!=null&&c.hasOwnProperty("identitySig")&&(l.identitySig=u.bytes===String?i.base64.encode(c.identitySig,0,c.identitySig.length):u.bytes===Array?Array.prototype.slice.call(c.identitySig):c.identitySig),c.data!=null&&c.hasOwnProperty("data")&&(l.data=u.bytes===String?i.base64.encode(c.data,0,c.data.length):u.bytes===Array?Array.prototype.slice.call(c.data):c.data),l},o.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},o}(),s}(),n})});var yf=m(rr=>{f();"use strict";var LFe=rr&&rr.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),MFe=rr&&rr.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),jFe=rr&&rr.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&LFe(e,r,t);return MFe(e,r),e},qFe=rr&&rr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(rr,"__esModule",{value:!0});rr.isValidPublicKey=rr.getHkdf=rr.verifySignedPayload=rr.getHandshakePayload=rr.decodePayload=rr.getPeerIdFromPayload=rr.signPayload=rr.createHandshakePayload=rr.getPayload=rr.generateKeypair=void 0;var UFe=cle(),FFe=MT(),KFe=jFe(r8()),jT=qFe(ot()),VFe=fle(),zFe=(hi(),dn),HFe=(ct(),Qr),$Fe=(Si(),Pn),u8=VFe.pb.NoiseHandshakePayload;function GFe(){let r=KFe.generateKeyPair();return{publicKey:r.publicKey,privateKey:r.secretKey}}rr.generateKeypair=GFe;async function WFe(r,e,t){let i=await hle(r,qT(e)),n=t??new Uint8Array(0);return dle(r.marshalPubKey(),i,n)}rr.getPayload=WFe;function dle(r,e,t){let i=u8.create({identityKey:r,identitySig:e,data:t??null});return u8.encode(i).finish()}rr.createHandshakePayload=dle;async function hle(r,e){return await r.privKey.sign(e)}rr.signPayload=hle;async function YFe(r){return await jT.default.createFromPubKey(r.identityKey)}rr.getPeerIdFromPayload=YFe;function XFe(r){return u8.toObject(u8.decode(r))}rr.decodePayload=XFe;function qT(r){let e=(0,HFe.fromString)("noise-libp2p-static-key:");return(0,$Fe.concat)([e,r],e.length+r.length)}rr.getHandshakePayload=qT;async function QFe(r,e){let t=await jT.default.createFromPubKey(e);return(0,zFe.equals)(t.id,r)}async function ZFe(r,e,t){let i=e.identityKey;if(!await QFe(t.id,i))throw new Error("Peer ID doesn't match libp2p public key.");let n=qT(r),s=await jT.default.createFromPubKey(i);if(!e.identitySig||!await s.pubKey.verify(n,e.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return s}rr.verifySignedPayload=ZFe;function JFe(r,e){let n=new UFe.HKDF(FFe.SHA256,e,r).expand(96),s=n.slice(0,32),o=n.slice(32,64),a=n.slice(64,96);return[s,o,a]}rr.getHkdf=JFe;function eKe(r){return!(!(r instanceof Uint8Array)||r.length!==32)}rr.isValidPublicKey=eKe});var yle=m(l8=>{f();"use strict";Object.defineProperty(l8,"__esModule",{value:!0});var Sn=lm(),UT=Sc(),tKe=20;function rKe(r,e,t){for(var i=1634760805,n=857760878,s=2036477234,o=1797285236,a=t[3]<<24|t[2]<<16|t[1]<<8|t[0],c=t[7]<<24|t[6]<<16|t[5]<<8|t[4],u=t[11]<<24|t[10]<<16|t[9]<<8|t[8],l=t[15]<<24|t[14]<<16|t[13]<<8|t[12],d=t[19]<<24|t[18]<<16|t[17]<<8|t[16],h=t[23]<<24|t[22]<<16|t[21]<<8|t[20],p=t[27]<<24|t[26]<<16|t[25]<<8|t[24],y=t[31]<<24|t[30]<<16|t[29]<<8|t[28],g=e[3]<<24|e[2]<<16|e[1]<<8|e[0],w=e[7]<<24|e[6]<<16|e[5]<<8|e[4],b=e[11]<<24|e[10]<<16|e[9]<<8|e[8],v=e[15]<<24|e[14]<<16|e[13]<<8|e[12],A=i,k=n,C=s,T=o,D=a,j=c,M=u,se=l,ie=d,fe=h,pe=p,Le=y,Re=g,De=w,ne=b,je=v,ut=0;ut<tKe;ut+=2)A=A+D|0,Re^=A,Re=Re>>>32-16|Re<<16,ie=ie+Re|0,D^=ie,D=D>>>32-12|D<<12,k=k+j|0,De^=k,De=De>>>32-16|De<<16,fe=fe+De|0,j^=fe,j=j>>>32-12|j<<12,C=C+M|0,ne^=C,ne=ne>>>32-16|ne<<16,pe=pe+ne|0,M^=pe,M=M>>>32-12|M<<12,T=T+se|0,je^=T,je=je>>>32-16|je<<16,Le=Le+je|0,se^=Le,se=se>>>32-12|se<<12,C=C+M|0,ne^=C,ne=ne>>>32-8|ne<<8,pe=pe+ne|0,M^=pe,M=M>>>32-7|M<<7,T=T+se|0,je^=T,je=je>>>32-8|je<<8,Le=Le+je|0,se^=Le,se=se>>>32-7|se<<7,k=k+j|0,De^=k,De=De>>>32-8|De<<8,fe=fe+De|0,j^=fe,j=j>>>32-7|j<<7,A=A+D|0,Re^=A,Re=Re>>>32-8|Re<<8,ie=ie+Re|0,D^=ie,D=D>>>32-7|D<<7,A=A+j|0,je^=A,je=je>>>32-16|je<<16,pe=pe+je|0,j^=pe,j=j>>>32-12|j<<12,k=k+M|0,Re^=k,Re=Re>>>32-16|Re<<16,Le=Le+Re|0,M^=Le,M=M>>>32-12|M<<12,C=C+se|0,De^=C,De=De>>>32-16|De<<16,ie=ie+De|0,se^=ie,se=se>>>32-12|se<<12,T=T+D|0,ne^=T,ne=ne>>>32-16|ne<<16,fe=fe+ne|0,D^=fe,D=D>>>32-12|D<<12,C=C+se|0,De^=C,De=De>>>32-8|De<<8,ie=ie+De|0,se^=ie,se=se>>>32-7|se<<7,T=T+D|0,ne^=T,ne=ne>>>32-8|ne<<8,fe=fe+ne|0,D^=fe,D=D>>>32-7|D<<7,k=k+M|0,Re^=k,Re=Re>>>32-8|Re<<8,Le=Le+Re|0,M^=Le,M=M>>>32-7|M<<7,A=A+j|0,je^=A,je=je>>>32-8|je<<8,pe=pe+je|0,j^=pe,j=j>>>32-7|j<<7;Sn.writeUint32LE(A+i|0,r,0),Sn.writeUint32LE(k+n|0,r,4),Sn.writeUint32LE(C+s|0,r,8),Sn.writeUint32LE(T+o|0,r,12),Sn.writeUint32LE(D+a|0,r,16),Sn.writeUint32LE(j+c|0,r,20),Sn.writeUint32LE(M+u|0,r,24),Sn.writeUint32LE(se+l|0,r,28),Sn.writeUint32LE(ie+d|0,r,32),Sn.writeUint32LE(fe+h|0,r,36),Sn.writeUint32LE(pe+p|0,r,40),Sn.writeUint32LE(Le+y|0,r,44),Sn.writeUint32LE(Re+g|0,r,48),Sn.writeUint32LE(De+w|0,r,52),Sn.writeUint32LE(ne+b|0,r,56),Sn.writeUint32LE(je+v|0,r,60)}function ple(r,e,t,i,n){if(n===void 0&&(n=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<t.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=n}for(var a=new Uint8Array(64),c=0;c<t.length;c+=64){rKe(a,s,r);for(var u=c;u<c+64&&u<t.length;u++)i[u]=t[u]^a[u-c];nKe(s,0,o)}return UT.wipe(a),n===0&&UT.wipe(s),i}l8.streamXOR=ple;function iKe(r,e,t,i){return i===void 0&&(i=0),UT.wipe(t),ple(r,e,t,t,i)}l8.stream=iKe;function nKe(r,e,t){for(var i=1;t--;)i=i+(r[e]&255)|0,r[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}});var mle=m(Pu=>{f();"use strict";Object.defineProperty(Pu,"__esModule",{value:!0});var sKe=o8(),f8=Sc();Pu.DIGEST_LENGTH=16;var gle=function(){function r(e){this.digestLength=Pu.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var t=e[0]|e[1]<<8;this._r[0]=t&8191;var i=e[2]|e[3]<<8;this._r[1]=(t>>>13|i<<3)&8191;var n=e[4]|e[5]<<8;this._r[2]=(i>>>10|n<<6)&7939;var s=e[6]|e[7]<<8;this._r[3]=(n>>>7|s<<9)&8191;var o=e[8]|e[9]<<8;this._r[4]=(s>>>4|o<<12)&255,this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=(o>>>14|a<<2)&8191;var c=e[12]|e[13]<<8;this._r[7]=(a>>>11|c<<5)&8065;var u=e[14]|e[15]<<8;this._r[8]=(c>>>8|u<<8)&8191,this._r[9]=u>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return r.prototype._blocks=function(e,t,i){for(var n=this._fin?0:1<<11,s=this._h[0],o=this._h[1],a=this._h[2],c=this._h[3],u=this._h[4],l=this._h[5],d=this._h[6],h=this._h[7],p=this._h[8],y=this._h[9],g=this._r[0],w=this._r[1],b=this._r[2],v=this._r[3],A=this._r[4],k=this._r[5],C=this._r[6],T=this._r[7],D=this._r[8],j=this._r[9];i>=16;){var M=e[t+0]|e[t+1]<<8;s+=M&8191;var se=e[t+2]|e[t+3]<<8;o+=(M>>>13|se<<3)&8191;var ie=e[t+4]|e[t+5]<<8;a+=(se>>>10|ie<<6)&8191;var fe=e[t+6]|e[t+7]<<8;c+=(ie>>>7|fe<<9)&8191;var pe=e[t+8]|e[t+9]<<8;u+=(fe>>>4|pe<<12)&8191,l+=pe>>>1&8191;var Le=e[t+10]|e[t+11]<<8;d+=(pe>>>14|Le<<2)&8191;var Re=e[t+12]|e[t+13]<<8;h+=(Le>>>11|Re<<5)&8191;var De=e[t+14]|e[t+15]<<8;p+=(Re>>>8|De<<8)&8191,y+=De>>>5|n;var ne=0,je=ne;je+=s*g,je+=o*(5*j),je+=a*(5*D),je+=c*(5*T),je+=u*(5*C),ne=je>>>13,je&=8191,je+=l*(5*k),je+=d*(5*A),je+=h*(5*v),je+=p*(5*b),je+=y*(5*w),ne+=je>>>13,je&=8191;var ut=ne;ut+=s*w,ut+=o*g,ut+=a*(5*j),ut+=c*(5*D),ut+=u*(5*T),ne=ut>>>13,ut&=8191,ut+=l*(5*C),ut+=d*(5*k),ut+=h*(5*A),ut+=p*(5*v),ut+=y*(5*b),ne+=ut>>>13,ut&=8191;var Ye=ne;Ye+=s*b,Ye+=o*w,Ye+=a*g,Ye+=c*(5*j),Ye+=u*(5*D),ne=Ye>>>13,Ye&=8191,Ye+=l*(5*T),Ye+=d*(5*C),Ye+=h*(5*k),Ye+=p*(5*A),Ye+=y*(5*v),ne+=Ye>>>13,Ye&=8191;var Xe=ne;Xe+=s*v,Xe+=o*b,Xe+=a*w,Xe+=c*g,Xe+=u*(5*j),ne=Xe>>>13,Xe&=8191,Xe+=l*(5*D),Xe+=d*(5*T),Xe+=h*(5*C),Xe+=p*(5*k),Xe+=y*(5*A),ne+=Xe>>>13,Xe&=8191;var de=ne;de+=s*A,de+=o*v,de+=a*b,de+=c*w,de+=u*g,ne=de>>>13,de&=8191,de+=l*(5*j),de+=d*(5*D),de+=h*(5*T),de+=p*(5*C),de+=y*(5*k),ne+=de>>>13,de&=8191;var J=ne;J+=s*k,J+=o*A,J+=a*v,J+=c*b,J+=u*w,ne=J>>>13,J&=8191,J+=l*g,J+=d*(5*j),J+=h*(5*D),J+=p*(5*T),J+=y*(5*C),ne+=J>>>13,J&=8191;var Ee=ne;Ee+=s*C,Ee+=o*k,Ee+=a*A,Ee+=c*v,Ee+=u*b,ne=Ee>>>13,Ee&=8191,Ee+=l*w,Ee+=d*g,Ee+=h*(5*j),Ee+=p*(5*D),Ee+=y*(5*T),ne+=Ee>>>13,Ee&=8191;var qe=ne;qe+=s*T,qe+=o*C,qe+=a*k,qe+=c*A,qe+=u*v,ne=qe>>>13,qe&=8191,qe+=l*b,qe+=d*w,qe+=h*g,qe+=p*(5*j),qe+=y*(5*D),ne+=qe>>>13,qe&=8191;var ze=ne;ze+=s*D,ze+=o*T,ze+=a*C,ze+=c*k,ze+=u*A,ne=ze>>>13,ze&=8191,ze+=l*v,ze+=d*b,ze+=h*w,ze+=p*g,ze+=y*(5*j),ne+=ze>>>13,ze&=8191;var Te=ne;Te+=s*j,Te+=o*D,Te+=a*T,Te+=c*C,Te+=u*k,ne=Te>>>13,Te&=8191,Te+=l*A,Te+=d*v,Te+=h*b,Te+=p*w,Te+=y*g,ne+=Te>>>13,Te&=8191,ne=(ne<<2)+ne|0,ne=ne+je|0,je=ne&8191,ne=ne>>>13,ut+=ne,s=je,o=ut,a=Ye,c=Xe,u=de,l=J,d=Ee,h=qe,p=ze,y=Te,t+=16,i-=16}this._h[0]=s,this._h[1]=o,this._h[2]=a,this._h[3]=c,this._h[4]=u,this._h[5]=l,this._h[6]=d,this._h[7]=h,this._h[8]=p,this._h[9]=y},r.prototype.finish=function(e,t){t===void 0&&(t=0);var i=new Uint16Array(10),n,s,o,a;if(this._leftover){for(a=this._leftover,this._buffer[a++]=1;a<16;a++)this._buffer[a]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(n=this._h[1]>>>13,this._h[1]&=8191,a=2;a<10;a++)this._h[a]+=n,n=this._h[a]>>>13,this._h[a]&=8191;for(this._h[0]+=n*5,n=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=n,n=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=n,i[0]=this._h[0]+5,n=i[0]>>>13,i[0]&=8191,a=1;a<10;a++)i[a]=this._h[a]+n,n=i[a]>>>13,i[a]&=8191;for(i[9]-=1<<13,s=(n^1)-1,a=0;a<10;a++)i[a]&=s;for(s=~s,a=0;a<10;a++)this._h[a]=this._h[a]&s|i[a];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,o=this._h[0]+this._pad[0],this._h[0]=o&65535,a=1;a<8;a++)o=(this._h[a]+this._pad[a]|0)+(o>>>16)|0,this._h[a]=o&65535;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},r.prototype.update=function(e){var t=0,i=e.length,n;if(this._leftover){n=16-this._leftover,n>i&&(n=i);for(var s=0;s<n;s++)this._buffer[this._leftover+s]=e[t+s];if(i-=n,t+=n,this._leftover+=n,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(i>=16&&(n=i-i%16,this._blocks(e,t,n),t+=n,i-=n),i){for(var s=0;s<i;s++)this._buffer[this._leftover+s]=e[t+s];this._leftover+=i}return this},r.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},r.prototype.clean=function(){return f8.wipe(this._buffer),f8.wipe(this._r),f8.wipe(this._h),f8.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},r}();Pu.Poly1305=gle;function oKe(r,e){var t=new gle(r);t.update(e);var i=t.digest();return t.clean(),i}Pu.oneTimeAuth=oKe;function aKe(r,e){return r.length!==Pu.DIGEST_LENGTH||e.length!==Pu.DIGEST_LENGTH?!1:sKe.equal(r,e)}Pu.equal=aKe});var _le=m(Cu=>{f();"use strict";Object.defineProperty(Cu,"__esModule",{value:!0});var d8=yle(),cKe=mle(),gm=Sc(),ble=lm(),uKe=o8();Cu.KEY_LENGTH=32;Cu.NONCE_LENGTH=12;Cu.TAG_LENGTH=16;var wle=new Uint8Array(16),lKe=function(){function r(e){if(this.nonceLength=Cu.NONCE_LENGTH,this.tagLength=Cu.TAG_LENGTH,e.length!==Cu.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return r.prototype.seal=function(e,t,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);d8.stream(this._key,s,o,4);var a=t.length+this.tagLength,c;if(n){if(n.length!==a)throw new Error("ChaCha20Poly1305: incorrect destination length");c=n}else c=new Uint8Array(a);return d8.streamXOR(this._key,s,t,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),o,c.subarray(0,c.length-this.tagLength),i),gm.wipe(s),c},r.prototype.open=function(e,t,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(t.length<this.tagLength)return null;var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);d8.stream(this._key,s,o,4);var a=new Uint8Array(this.tagLength);if(this._authenticate(a,o,t.subarray(0,t.length-this.tagLength),i),!uKe.equal(a,t.subarray(t.length-this.tagLength,t.length)))return null;var c=t.length-this.tagLength,u;if(n){if(n.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");u=n}else u=new Uint8Array(c);return d8.streamXOR(this._key,s,t.subarray(0,t.length-this.tagLength),u,4),gm.wipe(s),u},r.prototype.clean=function(){return gm.wipe(this._key),this},r.prototype._authenticate=function(e,t,i,n){var s=new cKe.Poly1305(t);n&&(s.update(n),n.length%16>0&&s.update(wle.subarray(n.length%16))),s.update(i),i.length%16>0&&s.update(wle.subarray(i.length%16));var o=new Uint8Array(8);n&&ble.writeUint64LE(n.length,o),s.update(o),ble.writeUint64LE(i.length,o),s.update(o);for(var a=s.digest(),c=0;c<a.length;c++)e[c]=a[c];s.clean(),gm.wipe(a),gm.wipe(o)},r}();Cu.ChaCha20Poly1305=lKe});var h8={};Tt(h8,{xor:()=>FT});function FT(r,e){if(r.length!==e.length)throw new Error("Inputs should have the same length");let t=new Uint8Array(r.length);for(let i=0;i<r.length;i++)t[i]=r[i]^e[i];return t}var mm=Ue(()=>{f()});var vle={};Tt(vle,{compare:()=>gg,concat:()=>Ni,equals:()=>Hs,fromString:()=>Qe,toString:()=>$e,xor:()=>FT});var Ele=Ue(()=>{f();zb();Si();hi();ct();tt();mm()});var p8=m(Ou=>{f();"use strict";Object.defineProperty(Ou,"__esModule",{value:!0});Ou.DUMP_SESSION_KEYS=Ou.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=Ou.NOISE_MSG_MAX_LENGTH_BYTES=void 0;Ou.NOISE_MSG_MAX_LENGTH_BYTES=65535;Ou.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=Ou.NOISE_MSG_MAX_LENGTH_BYTES-16;Ou.DUMP_SESSION_KEYS=process.env.DUMP_SESSION_KEYS});var S1=m(ln=>{f();"use strict";var fKe=ln&&ln.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ln,"__esModule",{value:!0});ln.logCipherState=ln.logRemoteEphemeralKey=ln.logRemoteStaticKey=ln.logLocalEphemeralKeys=ln.logLocalStaticKeys=ln.logger=void 0;var dKe=fKe(le()),hKe=p8(),gf=(tt(),sr);ln.logger=(0,dKe.default)("libp2p:noise");var Ro;hKe.DUMP_SESSION_KEYS?Ro=ln.logger:Ro=()=>{};function pKe(r){Ro(`LOCAL_STATIC_PUBLIC_KEY ${(0,gf.toString)(r.publicKey,"hex")}`),Ro(`LOCAL_STATIC_PRIVATE_KEY ${(0,gf.toString)(r.privateKey,"hex")}`)}ln.logLocalStaticKeys=pKe;function yKe(r){r?(Ro(`LOCAL_PUBLIC_EPHEMERAL_KEY ${(0,gf.toString)(r.publicKey,"hex")}`),Ro(`LOCAL_PRIVATE_EPHEMERAL_KEY ${(0,gf.toString)(r.privateKey,"hex")}`)):Ro("Missing local ephemeral keys.")}ln.logLocalEphemeralKeys=yKe;function gKe(r){Ro(`REMOTE_STATIC_PUBLIC_KEY ${(0,gf.toString)(r,"hex")}`)}ln.logRemoteStaticKey=gKe;function mKe(r){Ro(`REMOTE_EPHEMERAL_PUBLIC_KEY ${(0,gf.toString)(r,"hex")}`)}ln.logRemoteEphemeralKey=mKe;function bKe(r){r.cs1&&r.cs2?(Ro(`CIPHER_STATE_1 ${r.cs1.n} ${(0,gf.toString)(r.cs1.k,"hex")}`),Ro(`CIPHER_STATE_2 ${r.cs2.n} ${(0,gf.toString)(r.cs2.k,"hex")}`)):Ro("Missing cipher state.")}ln.logCipherState=bKe});var KT=m(fn=>{f();"use strict";var wKe=fn&&fn.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),_Ke=fn&&fn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Sle=fn&&fn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&wKe(e,r,t);return _Ke(e,r),e};Object.defineProperty(fn,"__esModule",{value:!0});fn.AbstractHandshake=fn.MAX_NONCE=fn.MIN_NONCE=void 0;var vKe=Sle(r8()),EKe=Sle(MT()),Rle=_le(),SKe=(hi(),dn),RKe=(Si(),Pn),AKe=(Ele(),vle),Ale=yf(),xKe=S1();fn.MIN_NONCE=0;fn.MAX_NONCE=Number.MAX_SAFE_INTEGER;var xle="Cipherstate has reached maximum n, a new handshake must be performed",Ile=class{encryptWithAd(e,t,i){let n=this.encrypt(e.k,e.n,t,i);return this.setNonce(e,this.incrementNonce(e.n)),n}decryptWithAd(e,t,i){let{plaintext:n,valid:s}=this.decrypt(e.k,e.n,t,i);return this.setNonce(e,this.incrementNonce(e.n)),{plaintext:n,valid:s}}hasKey(e){return!this.isEmptyKey(e.k)}setNonce(e,t){e.n=t}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(e){let t=this.createEmptyKey();return(0,SKe.equals)(t,e)}incrementNonce(e){return e+1}nonceToBytes(e){let t=new Uint8Array(12);return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint32(4,e,!0),t}encrypt(e,t,i,n){if(t>fn.MAX_NONCE)throw new Error(xle);let s=this.nonceToBytes(t);return new Rle.ChaCha20Poly1305(e).seal(s,n,i)}encryptAndHash(e,t){let i;return this.hasKey(e.cs)?i=this.encryptWithAd(e.cs,e.h,t):i=t,this.mixHash(e,i),i}decrypt(e,t,i,n){if(t>fn.MAX_NONCE)throw new Error(xle);let s=this.nonceToBytes(t),a=new Rle.ChaCha20Poly1305(e).open(s,n,i);return a?{plaintext:a,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(e,t){let i,n=!0;return this.hasKey(e.cs)?{plaintext:i,valid:n}=this.decryptWithAd(e.cs,e.h,t):i=t,this.mixHash(e,t),{plaintext:i,valid:n}}dh(e,t){try{let i=vKe.sharedKey(e,t);return i.length===32?i:i.slice(0,32)}catch(i){return(0,xKe.logger)(i.message),new Uint8Array(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){return EKe.hash((0,RKe.concat)([e,t],e.length+t.length))}mixKey(e,t){let[i,n]=(0,Ale.getHkdf)(e.ck,t);e.cs=this.initializeKey(n),e.ck=i}initializeKey(e){let t=fn.MIN_NONCE;return{k:e,n:t}}initializeSymmetric(e){let t=(0,AKe.fromString)(e,"utf-8"),i=this.hashProtocolName(t),n=i,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:n,h:i}}hashProtocolName(e){if(e.length<=32){let t=new Uint8Array(32);return t.set(e),t}else return this.getHash(e,new Uint8Array(0))}split(e){let[t,i]=(0,Ale.getHkdf)(e.ck,new Uint8Array(0)),n=this.initializeKey(t),s=this.initializeKey(i);return{cs1:n,cs2:s}}writeMessageRegular(e,t){let i=this.encryptWithAd(e,new Uint8Array(0),t),n=this.createEmptyKey(),s=new Uint8Array(0);return{ne:n,ns:s,ciphertext:i}}readMessageRegular(e,t){return this.decryptWithAd(e,new Uint8Array(0),t.ciphertext)}};fn.AbstractHandshake=Ile});var Ple=m(y8=>{f();"use strict";Object.defineProperty(y8,"__esModule",{value:!0});y8.XX=void 0;var R1=yf(),IKe=KT(),Tle=class extends IKe.AbstractHandshake{initializeInitiator(e,t,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=new Uint8Array(32);return{ss:o,s:t,rs:i,psk:n,re:a}}initializeResponder(e,t,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=new Uint8Array(32);return{ss:o,s:t,rs:i,psk:n,re:a}}writeMessageA(e,t,i){let n=new Uint8Array(0);i!==void 0?e.e=i:e.e=(0,R1.generateKeypair)();let s=e.e.publicKey;this.mixHash(e.ss,s);let o=this.encryptAndHash(e.ss,t);return{ne:s,ns:n,ciphertext:o}}writeMessageB(e,t){e.e=(0,R1.generateKeypair)();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let n=e.s.publicKey,s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let o=this.encryptAndHash(e.ss,t);return{ne:i,ns:s,ciphertext:o}}writeMessageC(e,t){let i=e.s.publicKey,n=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,t),a={ne:this.createEmptyKey(),ns:n,ciphertext:s},{cs1:c,cs2:u}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:c,cs2:u}}readMessageA(e,t){return(0,R1.isValidPublicKey)(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if((0,R1.isValidPublicKey)(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&i.length===32&&(0,R1.isValidPublicKey)(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:s,valid:n&&o}}readMessageC(e,t){let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);if(n&&i.length===32&&(0,R1.isValidPublicKey)(i)&&(e.rs=i),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,plaintext:s,valid:n&&o,cs1:a,cs2:c}}initSession(e,t,i){let n=this.createEmptyKey(),s=new Uint8Array(32),o;return e?o=this.initializeInitiator(t,i,s,n):o=this.initializeResponder(t,i,s,n),{hs:o,i:e,mc:0}}sendMessage(e,t,i){let n;if(e.mc===0)n=this.writeMessageA(e.hs,t,i);else if(e.mc===1)n=this.writeMessageB(e.hs,t);else if(e.mc===2){let{h:s,messageBuffer:o,cs1:a,cs2:c}=this.writeMessageC(e.hs,t);n=o,e.h=s,e.cs1=a,e.cs2=c}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,t)}else throw new Error("Session invalid.");return e.mc++,n}recvMessage(e,t){let i=new Uint8Array(0),n=!1;if(e.mc===0)({plaintext:i,valid:n}=this.readMessageA(e.hs,t));else if(e.mc===1)({plaintext:i,valid:n}=this.readMessageB(e.hs,t));else if(e.mc===2){let{h:s,plaintext:o,valid:a,cs1:c,cs2:u}=this.readMessageC(e.hs,t);i=o,n=a,e.h=s,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:i,valid:n}}};y8.XX=Tle});var bm=m(ni=>{f();"use strict";var TKe=ni&&ni.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ni,"__esModule",{value:!0});ni.decode2=ni.decode1=ni.decode0=ni.encode2=ni.encode1=ni.encode0=ni.uint16BEDecode=ni.uint16BEEncode=void 0;var PKe=TKe(sn()),VT=(Si(),Pn),CKe=r=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r),OKe=(r,e,t)=>(e=e||CKe(2),new DataView(e.buffer,e.byteOffset,e.byteLength).setUint16(t,r,!1),e);ni.uint16BEEncode=OKe;ni.uint16BEEncode.bytes=2;var kKe=r=>{if(r.length<2)throw RangeError("Could not decode int16BE");return r instanceof PKe.default?r.readUInt16BE(0):new DataView(r.buffer,r.byteOffset,r.byteLength).getUint16(0,!1)};ni.uint16BEDecode=kKe;ni.uint16BEDecode.bytes=2;function DKe(r){return(0,VT.concat)([r.ne,r.ciphertext],r.ne.length+r.ciphertext.length)}ni.encode0=DKe;function NKe(r){return(0,VT.concat)([r.ne,r.ns,r.ciphertext],r.ne.length+r.ns.length+r.ciphertext.length)}ni.encode1=NKe;function BKe(r){return(0,VT.concat)([r.ns,r.ciphertext],r.ns.length+r.ciphertext.length)}ni.encode2=BKe;function LKe(r){if(r.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:r.slice(0,32),ciphertext:r.slice(32,r.length),ns:new Uint8Array(0)}}ni.decode0=LKe;function MKe(r){if(r.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:r.slice(0,32),ns:r.slice(32,80),ciphertext:r.slice(80,r.length)}}ni.decode1=MKe;function jKe(r){if(r.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:r.slice(0,48),ciphertext:r.slice(48,r.length)}}ni.decode2=jKe});var zT=m(g8=>{f();"use strict";Object.defineProperty(g8,"__esModule",{value:!0});g8.XXHandshake=void 0;var qKe=Ple(),A1=yf(),mi=S1(),x1=bm(),Cle=class{constructor(e,t,i,n,s,o,a){this.isInitiator=e,this.payload=t,this.prologue=i,this.staticKeypair=n,this.connection=s,o&&(this.remotePeer=o),this.xx=a??new qKe.XX,this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair),this.remoteEarlyData=new Uint8Array(0)}async propose(){if((0,mi.logLocalStaticKeys)(this.session.hs.s),this.isInitiator){(0,mi.logger)("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP((0,x1.encode0)(e)),(0,mi.logger)("Stage 0 - Initiator finished sending first message."),(0,mi.logLocalEphemeralKeys)(this.session.hs.e)}else{(0,mi.logger)("Stage 0 - Responder waiting to receive first message...");let e=(0,x1.decode0)((await this.connection.readLP()).slice()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new Error("xx handshake stage 0 validation fail");(0,mi.logger)("Stage 0 - Responder received first message."),(0,mi.logRemoteEphemeralKey)(this.session.hs.re)}}async exchange(){if(this.isInitiator){(0,mi.logger)("Stage 1 - Initiator waiting to receive first message from responder...");let e=(0,x1.decode1)((await this.connection.readLP()).slice()),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 1 validation fail");(0,mi.logger)("Stage 1 - Initiator received the message."),(0,mi.logRemoteEphemeralKey)(this.session.hs.re),(0,mi.logRemoteStaticKey)(this.session.hs.rs),(0,mi.logger)("Initiator going to check remote's signature...");try{let n=await(0,A1.decodePayload)(t);this.remotePeer=this.remotePeer||await(0,A1.getPeerIdFromPayload)(n),this.remotePeer=await(0,A1.verifySignedPayload)(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}(0,mi.logger)("All good with the signature!")}else{(0,mi.logger)("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP((0,x1.encode1)(e)),(0,mi.logger)("Stage 1 - Responder sent the second handshake message with signed payload."),(0,mi.logLocalEphemeralKeys)(this.session.hs.e)}}async finish(){if(this.isInitiator){(0,mi.logger)("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP((0,x1.encode2)(e)),(0,mi.logger)("Stage 2 - Initiator sent message with signed payload.")}else{(0,mi.logger)("Stage 2 - Responder waiting for third handshake message...");let e=(0,x1.decode2)((await this.connection.readLP()).slice()),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 2 validation fail");(0,mi.logger)("Stage 2 - Responder received the message, finished handshake.");try{let n=await(0,A1.decodePayload)(t);this.remotePeer=this.remotePeer||await(0,A1.getPeerIdFromPayload)(n),await(0,A1.verifySignedPayload)(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}}(0,mi.logCipherState)(this.session)}encrypt(e,t){let i=this.getCS(t);return this.xx.encryptWithAd(i,new Uint8Array(0),e)}decrypt(e,t){let i=this.getCS(t,!1);return this.xx.decryptWithAd(i,new Uint8Array(0),e)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=e)}};g8.XXHandshake=Cle});var kle=m(m8=>{f();"use strict";Object.defineProperty(m8,"__esModule",{value:!0});m8.IK=void 0;var wm=yf(),UKe=KT(),Ole=class extends UKe.AbstractHandshake{initSession(e,t,i,n){let s=this.createEmptyKey(),o;return e?o=this.initializeInitiator(t,i,n,s):o=this.initializeResponder(t,i,n,s),{hs:o,i:e,mc:0}}sendMessage(e,t){let i;if(e.mc===0)i=this.writeMessageA(e.hs,t);else if(e.mc===1){let{messageBuffer:n,h:s,cs1:o,cs2:a}=this.writeMessageB(e.hs,t);i=n,e.h=s,e.cs1=o,e.cs2=a}else if(e.mc>1)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(e.cs2,t)}else throw new Error("Session invalid.");return e.mc++,i}recvMessage(e,t){let i=new Uint8Array(0),n=!1;if(e.mc===0&&({plaintext:i,valid:n}=this.readMessageA(e.hs,t)),e.mc===1){let{plaintext:s,valid:o,h:a,cs1:c,cs2:u}=this.readMessageB(e.hs,t);i=s,n=o,e.h=a,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:i,valid:n}}writeMessageA(e,t){e.e=(0,wm.generateKeypair)();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=e.s.publicKey,s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let o=this.encryptAndHash(e.ss,t);return{ne:i,ns:s,ciphertext:o}}writeMessageB(e,t){e.e=(0,wm.generateKeypair)();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=this.encryptAndHash(e.ss,t),s=this.createEmptyKey(),o={ne:i,ns:s,ciphertext:n},{cs1:a,cs2:c}=this.split(e.ss);return{messageBuffer:o,cs1:a,cs2:c,h:e.ss.h}}readMessageA(e,t){(0,wm.isValidPublicKey)(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&i.length===32&&(0,wm.isValidPublicKey)(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:s,valid:n&&o}}readMessageB(e,t){if((0,wm.isValidPublicKey)(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state should contain ephemeral key by now.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:s,cs2:o}=this.split(e.ss);return{h:e.ss.h,valid:n,plaintext:i,cs1:s,cs2:o}}initializeInitiator(e,t,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,i);let a=new Uint8Array(32);return{ss:o,s:t,rs:i,re:a,psk:n}}initializeResponder(e,t,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,t.publicKey);let a=new Uint8Array(32);return{ss:o,s:t,rs:i,re:a,psk:n}}};m8.IK=Ole});var Nle=m(b8=>{f();"use strict";Object.defineProperty(b8,"__esModule",{value:!0});b8.FailedIKError=void 0;var Dle=class extends Error{constructor(e,t){super(t);this.initialMsg=e,this.name="FailedIKhandshake"}};b8.FailedIKError=Dle});var Mle=m(_8=>{f();"use strict";Object.defineProperty(_8,"__esModule",{value:!0});_8.IKHandshake=void 0;var FKe=kle(),w8=bm(),I1=yf(),Ble=Nle(),qi=S1(),Lle=class{constructor(e,t,i,n,s,o,a,c){this.isInitiator=e,this.payload=t,this.prologue=i,this.staticKeypair=n,this.connection=s,a&&(this.remotePeer=a),this.ik=c??new FKe.IK,this.session=this.ik.initSession(this.isInitiator,this.prologue,this.staticKeypair,o),this.remoteEarlyData=new Uint8Array}async stage0(){if((0,qi.logLocalStaticKeys)(this.session.hs.s),(0,qi.logRemoteStaticKey)(this.session.hs.rs),this.isInitiator){(0,qi.logger)("IK Stage 0 - Initiator sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP((0,w8.encode1)(e)),(0,qi.logger)("IK Stage 0 - Initiator sent message."),(0,qi.logLocalEphemeralKeys)(this.session.hs.e)}else{(0,qi.logger)("IK Stage 0 - Responder receiving message...");let e=await this.connection.readLP();try{let t=(0,w8.decode1)(e.slice()),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,t);if(!n)throw new Error("ik handshake stage 0 decryption validation fail");(0,qi.logger)("IK Stage 0 - Responder got message, going to verify payload.");let s=await(0,I1.decodePayload)(i);this.remotePeer=this.remotePeer||await(0,I1.getPeerIdFromPayload)(s),await(0,I1.verifySignedPayload)(this.session.hs.rs,s,this.remotePeer),this.setRemoteEarlyData(s.data),(0,qi.logger)("IK Stage 0 - Responder successfully verified payload!"),(0,qi.logRemoteEphemeralKey)(this.session.hs.re)}catch(t){let i=t;throw(0,qi.logger)("Responder breaking up with IK handshake in stage 0."),new Ble.FailedIKError(e,`Error occurred while verifying initiator's signed payload: ${i.message}`)}}}async stage1(){if(this.isInitiator){(0,qi.logger)("IK Stage 1 - Initiator receiving message...");let e=(await this.connection.readLP()).slice(),t=(0,w8.decode0)(e),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,t);(0,qi.logger)("IK Stage 1 - Initiator got message, going to verify payload.");try{if(!n)throw new Error("ik stage 1 decryption validation fail");let s=await(0,I1.decodePayload)(i);this.remotePeer=this.remotePeer||await(0,I1.getPeerIdFromPayload)(s),await(0,I1.verifySignedPayload)(t.ns.slice(0,32),s,this.remotePeer),this.setRemoteEarlyData(s.data),(0,qi.logger)("IK Stage 1 - Initiator successfully verified payload!"),(0,qi.logRemoteEphemeralKey)(this.session.hs.re)}catch(s){let o=s;throw(0,qi.logger)("Initiator breaking up with IK handshake in stage 1."),new Ble.FailedIKError(e,`Error occurred while verifying responder's signed payload: ${o.message}`)}}else{(0,qi.logger)("IK Stage 1 - Responder sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP((0,w8.encode0)(e)),(0,qi.logger)("IK Stage 1 - Responder sent message..."),(0,qi.logLocalEphemeralKeys)(this.session.hs.e)}(0,qi.logCipherState)(this.session)}decrypt(e,t){let i=this.getCS(t,!1);return this.ik.decryptWithAd(i,new Uint8Array(0),e)}encrypt(e,t){let i=this.getCS(t);return this.ik.encryptWithAd(i,new Uint8Array(0),e)}getLocalEphemeralKeys(){if(!this.session.hs.e)throw new Error("Ephemeral keys do not exist.");return this.session.hs.e}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=e)}};_8.IKHandshake=Lle});var Ule=m(v8=>{f();"use strict";Object.defineProperty(v8,"__esModule",{value:!0});v8.XXFallbackHandshake=void 0;var KKe=zT(),HT=yf(),Ao=S1(),jle=bm(),qle=class extends KKe.XXHandshake{constructor(e,t,i,n,s,o,a,c,u){super(e,t,i,n,s,a,u);c&&(this.ephemeralKeys=c),this.initialMsg=o}async propose(){if(this.isInitiator)this.xx.sendMessage(this.session,new Uint8Array(0),this.ephemeralKeys),(0,Ao.logger)("XX Fallback Stage 0 - Initialized state as the first message was sent by initiator."),(0,Ao.logLocalEphemeralKeys)(this.session.hs.e);else{(0,Ao.logger)("XX Fallback Stage 0 - Responder decoding initial msg from IK.");let e=(0,jle.decode0)(this.initialMsg),{valid:t}=this.xx.recvMessage(this.session,{ne:e.ne,ns:new Uint8Array(0),ciphertext:new Uint8Array(0)});if(!t)throw new Error("xx fallback stage 0 decryption validation fail");(0,Ao.logger)("XX Fallback Stage 0 - Responder used received message from IK."),(0,Ao.logRemoteEphemeralKey)(this.session.hs.re)}}async exchange(){if(this.isInitiator){let e=(0,jle.decode1)(this.initialMsg),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx fallback stage 1 decryption validation fail");(0,Ao.logger)("XX Fallback Stage 1 - Initiator used received message from IK."),(0,Ao.logRemoteEphemeralKey)(this.session.hs.re),(0,Ao.logRemoteStaticKey)(this.session.hs.rs),(0,Ao.logger)("Initiator going to check remote's signature...");try{let n=await(0,HT.decodePayload)(t);this.remotePeer=this.remotePeer||await(0,HT.getPeerIdFromPayload)(n),await(0,HT.verifySignedPayload)(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload from responder: ${s.message}`)}(0,Ao.logger)("All good with the signature!")}else(0,Ao.logger)("XX Fallback Stage 1 - Responder start"),await super.exchange(),(0,Ao.logger)("XX Fallback Stage 1 - Responder end")}};v8.XXFallbackHandshake=qle});var Fle=m(T1=>{f();"use strict";Object.defineProperty(T1,"__esModule",{value:!0});T1.decryptStream=T1.encryptStream=void 0;var E8=p8();function VKe(r){return async function*(e){for await(let t of e)for(let i=0;i<t.length;i+=E8.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG){let n=i+E8.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG;n>t.length&&(n=t.length),yield r.encrypt(t.slice(i,n),r.session)}}}T1.encryptStream=VKe;function zKe(r){return async function*(e){for await(let t of e)for(let i=0;i<t.length;i+=E8.NOISE_MSG_MAX_LENGTH_BYTES){let n=i+E8.NOISE_MSG_MAX_LENGTH_BYTES;n>t.length&&(n=t.length);let{plaintext:s,valid:o}=await r.decrypt(t.slice(i,n),r.session);if(!o)throw new Error("Failed to validate decrypted chunk");yield s}}}T1.decryptStream=zKe});var Vle=m(S8=>{f();"use strict";Object.defineProperty(S8,"__esModule",{value:!0});S8.KeyCache=void 0;var Kle=class{constructor(){this.storage=new Map}store(e,t){this.storage.set(e.id,t)}load(e){var t;return e&&(t=this.storage.get(e.id))!==null&&t!==void 0?t:null}resetStorage(){this.storage.clear()}},HKe=new Kle;S8.KeyCache=HKe});var GT=m(xo=>{f();"use strict";var $Ke=xo&&xo.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),GKe=xo&&xo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),WKe=xo&&xo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&$Ke(e,r,t);return GKe(e,r),e},R8=xo&&xo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(xo,"__esModule",{value:!0});xo.Noise=void 0;var YKe=WKe(r8()),zle=R8(Xue()),XKe=R8(tle()),Hle=R8(s8()),QKe=R8(dr()),$le=go(),ZKe=zT(),JKe=Mle(),eVe=Ule(),Gle=yf(),P1=bm(),Wle=Fle(),$T=Vle(),tVe=S1(),Yle=p8(),Xle=class{constructor(e,t){if(this.protocol="/noise",this.prologue=new Uint8Array(0),this.earlyData=t??new Uint8Array(0),this.useNoisePipes=!1,e){let i=YKe.generateKeyPairFromSeed(e);this.staticKeys={privateKey:i.secretKey,publicKey:i.publicKey}}else this.staticKeys=(0,Gle.generateKeypair)()}async secureOutbound(e,t,i){let n=(0,zle.default)(t,{lengthEncoder:P1.uint16BEEncode,lengthDecoder:P1.uint16BEDecode,maxDataLength:Yle.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!0,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async secureInbound(e,t,i){let n=(0,zle.default)(t,{lengthEncoder:P1.uint16BEEncode,lengthDecoder:P1.uint16BEDecode,maxDataLength:Yle.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!1,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async performHandshake(e){var t;let i=await(0,Gle.getPayload)(e.localPeer,this.staticKeys.publicKey,this.earlyData),n=this.useNoisePipes;if(e.isInitiator&&$T.KeyCache.load(e.remotePeer)===null&&(n=!1),n){let{remotePeer:s,connection:o,isInitiator:a}=e,c=new JKe.IKHandshake(a,i,this.prologue,this.staticKeys,o,(t=$T.KeyCache.load(e.remotePeer))!==null&&t!==void 0?t:new Uint8Array(32),s);try{return await this.performIKHandshake(c)}catch(u){let l;return e.isInitiator&&(l=c.getLocalEphemeralKeys()),await this.performXXFallbackHandshake(e,i,u.initialMsg,l)}}else return await this.performXXHandshake(e,i)}async performXXFallbackHandshake(e,t,i,n){let{isInitiator:s,remotePeer:o,connection:a}=e,c=new eVe.XXFallbackHandshake(s,t,this.prologue,this.staticKeys,a,i,o,n);try{await c.propose(),await c.exchange(),await c.finish()}catch(u){(0,tVe.logger)(u);let l=u;throw new Error(`Error occurred during XX Fallback handshake: ${l.message}`)}return c}async performXXHandshake(e,t){let{isInitiator:i,remotePeer:n,connection:s}=e,o=new ZKe.XXHandshake(i,t,this.prologue,this.staticKeys,s,n);try{await o.propose(),await o.exchange(),await o.finish(),this.useNoisePipes&&o.remotePeer&&$T.KeyCache.store(o.remotePeer,o.getRemoteStaticKey())}catch(a){let c=a;throw new Error(`Error occurred during XX handshake: ${c.message}`)}return o}async performIKHandshake(e){return await e.stage0(),await e.stage1(),e}async createSecureConnection(e,t){let[i,n]=(0,XKe.default)(),s=e.unwrap();return await(0,QKe.default)(i,Hle.default,(0,Wle.encryptStream)(t),(0,$le.encode)({lengthEncoder:P1.uint16BEEncode}),s,(0,$le.decode)({lengthDecoder:P1.uint16BEDecode}),Hle.default,(0,Wle.decryptStream)(t),i),n}};xo.Noise=Xle});var Qle=m(ku=>{f();"use strict";var rVe=ku&&ku.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),iVe=ku&&ku.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&rVe(e,r,t)};Object.defineProperty(ku,"__esModule",{value:!0});ku.NOISE=void 0;var nVe=GT();iVe(GT(),ku);ku.NOISE=new nVe.Noise});var efe=m((EPt,Jle)=>{f();"use strict";var sVe=$I(),{EventEmitter:oVe}=Ut();function Zle(r,e){if(r===e)return!0;if(r.length!==e.length)return!1;for(let t=0,i=r.length;t<i;++t)if(r[t]!==e[t])return!1;return!0}function WT(){return{contacts:[],dontSplit:!1,left:null,right:null}}function _m(r,e){if(!(e instanceof Uint8Array))throw new TypeError(r+" is not a Uint8Array")}var vm=class extends oVe{constructor(e={}){super();this.localNodeId=e.localNodeId||sVe(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||vm.distance,this.arbiter=e.arbiter||vm.arbiter,this.metadata=Object.assign({},e.metadata),_m("option.localNodeId as parameter 1",this.localNodeId),this.root=WT()}static arbiter(e,t){return e.vectorClock>t.vectorClock?e:t}static distance(e,t){let i=0,n=0,s=Math.min(e.length,t.length),o=Math.max(e.length,t.length);for(;n<s;++n)i=i*256+(e[n]^t[n]);for(;n<o;++n)i=i*256+255;return i}add(e){_m("contact.id",(e||{}).id);let t=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e.id,t++);let n=this._indexOf(i,e.id);return n>=0?(this._update(i,n,e),this):i.contacts.length<this.numberOfNodesPerKBucket?(i.contacts.push(e),this.emit("added",e),this):i.dontSplit?(this.emit("ping",i.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(i,t),this.add(e))}closest(e,t=1/0){if(_m("id",e),!Number.isInteger(t)&&t!==1/0||t<=0)throw new TypeError("n is not positive number");let i=[];for(let n=[this.root],s=0;n.length>0&&i.length<t;){let o=n.pop();if(o.contacts===null){let a=this._determineNode(o,e,s++);n.push(o.left===a?o.right:o.left),n.push(a)}else i=i.concat(o.contacts)}return i.map(n=>[this.distance(n.id,e),n]).sort((n,s)=>n[0]-s[0]).slice(0,t).map(n=>n[1])}count(){let e=0;for(let t=[this.root];t.length>0;){let i=t.pop();i.contacts===null?t.push(i.right,i.left):e+=i.contacts.length}return e}_determineNode(e,t,i){let n=i>>3,s=i%8;return t.length<=n&&s!==0?e.left:t[n]&1<<7-s?e.right:e.left}get(e){_m("id",e);let t=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,t++);let n=this._indexOf(i,e);return n>=0?i.contacts[n]:null}_indexOf(e,t){for(let i=0;i<e.contacts.length;++i)if(Zle(e.contacts[i].id,t))return i;return-1}remove(e){_m("the id as parameter 1",e);let t=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,t++);let n=this._indexOf(i,e);if(n>=0){let s=i.contacts.splice(n,1)[0];this.emit("removed",s)}return this}_split(e,t){e.left=WT(),e.right=WT();for(let s of e.contacts)this._determineNode(e,s.id,t).contacts.push(s);e.contacts=null;let i=this._determineNode(e,this.localNodeId,t),n=e.left===i?e.right:e.left;n.dontSplit=!0}toArray(){let e=[];for(let t=[this.root];t.length>0;){let i=t.pop();i.contacts===null?t.push(i.right,i.left):e=e.concat(i.contacts)}return e}*toIterable(){for(let e=[this.root];e.length>0;){let t=e.pop();t.contacts===null?e.push(t.right,t.left):yield*t.contacts}}_update(e,t,i){if(!Zle(e.contacts[t].id,i.id))throw new Error("wrong index for _update");let n=e.contacts[t],s=this.arbiter(n,i);s===n&&n!==i||(e.contacts.splice(t,1),e.contacts.push(s),this.emit("updated",n,s))}};Jle.exports=vm});var tfe=m(Em=>{f();(function(){var r,e,t,i,n,s,o,a;a=function(c){var u,l,d,h;return u=(c&255<<24)>>>24,l=(c&255<<16)>>>16,d=(c&255<<8)>>>8,h=c&255,[u,l,d,h].join(".")},o=function(c){var u,l,d,h,p,y;for(u=[],d=h=0;h<=3&&c.length!==0;d=++h){if(d>0){if(c[0]!==".")throw new Error("Invalid IP");c=c.substring(1)}y=e(c),p=y[0],l=y[1],c=c.substring(l),u.push(p)}if(c.length!==0)throw new Error("Invalid IP");switch(u.length){case 1:if(u[0]>4294967295)throw new Error("Invalid IP");return u[0]>>>0;case 2:if(u[0]>255||u[1]>16777215)throw new Error("Invalid IP");return(u[0]<<24|u[1])>>>0;case 3:if(u[0]>255||u[1]>255||u[2]>65535)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2])>>>0;case 4:if(u[0]>255||u[1]>255||u[2]>255||u[3]>255)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2]<<8|u[3])>>>0;default:throw new Error("Invalid IP")}},t=function(c){return c.charCodeAt(0)},i=t("0"),s=t("a"),n=t("A"),e=function(c){var u,l,d,h,p;for(h=0,u=10,l="9",d=0,c.length>1&&c[d]==="0"&&(c[d+1]==="x"||c[d+1]==="X"?(d+=2,u=16):"0"<=c[d+1]&&c[d+1]<="9"&&(d++,u=8,l="7")),p=d;d<c.length;){if("0"<=c[d]&&c[d]<=l)h=h*u+(t(c[d])-i)>>>0;else if(u===16)if("a"<=c[d]&&c[d]<="f")h=h*u+(10+t(c[d])-s)>>>0;else if("A"<=c[d]&&c[d]<="F")h=h*u+(10+t(c[d])-n)>>>0;else break;else break;if(h>4294967295)throw new Error("too large");d++}if(d===p)throw new Error("empty octet");return[h,d]},r=function(){function c(u,l){var d,h,p,y;if(typeof u!="string")throw new Error("Missing `net' parameter");if(l||(y=u.split("/",2),u=y[0],l=y[1]),l||(l=32),typeof l=="string"&&l.indexOf(".")>-1){try{this.maskLong=o(l)}catch(g){throw d=g,new Error("Invalid mask: "+l)}for(h=p=32;p>=0;h=--p)if(this.maskLong===4294967295<<32-h>>>0){this.bitmask=h;break}}else if(l||l===0)this.bitmask=parseInt(l,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(o(u)&this.maskLong)>>>0}catch(g){throw d=g,new Error("Invalid net address: "+u)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+l);this.size=Math.pow(2,32-this.bitmask),this.base=a(this.netLong),this.mask=a(this.maskLong),this.hostmask=a(~this.maskLong),this.first=this.bitmask<=30?a(this.netLong+1):this.base,this.last=this.bitmask<=30?a(this.netLong+this.size-2):a(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?a(this.netLong+this.size-1):void 0}return c.prototype.contains=function(u){return typeof u=="string"&&(u.indexOf("/")>0||u.split(".").length!==4)&&(u=new c(u)),u instanceof c?this.contains(u.base)&&this.contains(u.broadcast||u.last):(o(u)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},c.prototype.next=function(u){return u==null&&(u=1),new c(a(this.netLong+this.size*u),this.mask)},c.prototype.forEach=function(u){var l,d,h;for(h=o(this.first),d=o(this.last),l=0;h<=d;)u(a(h),h,l),l++,h++},c.prototype.toString=function(){return this.base+"/"+this.bitmask},c}(),Em.ip2long=o,Em.long2ip=a,Em.Netmask=r}).call(Em)});var ife=m((rfe,A8)=>{f();(function(r){"use strict";let e="(0?\\d+|0x[a-f0-9]+)",t={fourOctet:new RegExp(`^${e}\\.${e}\\.${e}\\.${e}$`,"i"),threeOctet:new RegExp(`^${e}\\.${e}\\.${e}$`,"i"),twoOctet:new RegExp(`^${e}\\.${e}$`,"i"),longValue:new RegExp(`^${e}$`,"i")},i=new RegExp("^0[0-7]+$","i"),n=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",o="(?:[0-9a-f]+::?)+",a={zoneIndex:new RegExp(s,"i"),native:new RegExp(`^(::)?(${o})?([0-9a-f]+)?(::)?(${s})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${e}\\.${e}\\.${e}\\.${e}(${s})?)$`,"i"),transitional:new RegExp(`^((?:${o})|(?:::)(?:${o})?)${e}\\.${e}\\.${e}\\.${e}(${s})?$`,"i")};function c(p,y){if(p.indexOf("::")!==p.lastIndexOf("::"))return null;let g=0,w=-1,b=(p.match(a.zoneIndex)||[])[0],v,A;for(b&&(b=b.substring(1),p=p.replace(/%.+$/,""));(w=p.indexOf(":",w+1))>=0;)g++;if(p.substr(0,2)==="::"&&g--,p.substr(-2,2)==="::"&&g--,g>y)return null;for(A=y-g,v=":";A--;)v+="0:";return p=p.replace("::",v),p[0]===":"&&(p=p.slice(1)),p[p.length-1]===":"&&(p=p.slice(0,-1)),y=function(){let k=p.split(":"),C=[];for(let T=0;T<k.length;T++)C.push(parseInt(k[T],16));return C}(),{parts:y,zoneId:b}}function u(p,y,g,w){if(p.length!==y.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let b=0,v;for(;w>0;){if(v=g-w,v<0&&(v=0),p[b]>>v!=y[b]>>v)return!1;w-=g,b+=1}return!0}function l(p){if(n.test(p))return parseInt(p,16);if(p[0]==="0"&&!isNaN(parseInt(p[1],10))){if(i.test(p))return parseInt(p,8);throw new Error(`ipaddr: cannot parse ${p} as octal`)}return parseInt(p,10)}function d(p,y){for(;p.length<y;)p=`0${p}`;return p}let h={};h.IPv4=function(){function p(y){if(y.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let g,w;for(g=0;g<y.length;g++)if(w=y[g],!(0<=w&&w<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=y}return p.prototype.SpecialRanges={unspecified:[[new p([0,0,0,0]),8]],broadcast:[[new p([255,255,255,255]),32]],multicast:[[new p([224,0,0,0]),4]],linkLocal:[[new p([169,254,0,0]),16]],loopback:[[new p([127,0,0,0]),8]],carrierGradeNat:[[new p([100,64,0,0]),10]],private:[[new p([10,0,0,0]),8],[new p([172,16,0,0]),12],[new p([192,168,0,0]),16]],reserved:[[new p([192,0,0,0]),24],[new p([192,0,2,0]),24],[new p([192,88,99,0]),24],[new p([198,51,100,0]),24],[new p([203,0,113,0]),24],[new p([240,0,0,0]),4]]},p.prototype.kind=function(){return"ipv4"},p.prototype.match=function(y,g){let w;if(g===void 0&&(w=y,y=w[0],g=w[1]),y.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,y.octets,8,g)},p.prototype.prefixLengthFromSubnetMask=function(){let y=0,g=!1,w={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},b,v,A;for(b=3;b>=0;b-=1)if(v=this.octets[b],v in w){if(A=w[v],g&&A!==0)return null;A!==8&&(g=!0),y+=A}else return null;return 32-y},p.prototype.range=function(){return h.subnetMatch(this,this.SpecialRanges)},p.prototype.toByteArray=function(){return this.octets.slice(0)},p.prototype.toIPv4MappedAddress=function(){return h.IPv6.parse(`::ffff:${this.toString()}`)},p.prototype.toNormalizedString=function(){return this.toString()},p.prototype.toString=function(){return this.octets.join(".")},p}(),h.IPv4.broadcastAddressFromCIDR=function(p){try{let y=this.parseCIDR(p),g=y[0].toByteArray(),w=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),b=[],v=0;for(;v<4;)b.push(parseInt(g[v],10)|parseInt(w[v],10)^255),v++;return new this(b)}catch(y){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},h.IPv4.isIPv4=function(p){return this.parser(p)!==null},h.IPv4.isValid=function(p){try{return new this(this.parser(p)),!0}catch(y){return!1}},h.IPv4.isValidFourPartDecimal=function(p){return!!(h.IPv4.isValid(p)&&p.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},h.IPv4.networkAddressFromCIDR=function(p){let y,g,w,b,v;try{for(y=this.parseCIDR(p),w=y[0].toByteArray(),v=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),b=[],g=0;g<4;)b.push(parseInt(w[g],10)&parseInt(v[g],10)),g++;return new this(b)}catch(A){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},h.IPv4.parse=function(p){let y=this.parser(p);if(y===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(y)},h.IPv4.parseCIDR=function(p){let y;if(y=p.match(/^(.+)\/(\d+)$/)){let g=parseInt(y[2]);if(g>=0&&g<=32){let w=[this.parse(y[1]),g];return Object.defineProperty(w,"toString",{value:function(){return this.join("/")}}),w}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},h.IPv4.parser=function(p){let y,g,w;if(y=p.match(t.fourOctet))return function(){let b=y.slice(1,6),v=[];for(let A=0;A<b.length;A++)g=b[A],v.push(l(g));return v}();if(y=p.match(t.longValue)){if(w=l(y[1]),w>4294967295||w<0)throw new Error("ipaddr: address outside defined range");return function(){let b=[],v;for(v=0;v<=24;v+=8)b.push(w>>v&255);return b}().reverse()}else return(y=p.match(t.twoOctet))?function(){let b=y.slice(1,4),v=[];if(w=l(b[1]),w>16777215||w<0)throw new Error("ipaddr: address outside defined range");return v.push(l(b[0])),v.push(w>>16&255),v.push(w>>8&255),v.push(w&255),v}():(y=p.match(t.threeOctet))?function(){let b=y.slice(1,5),v=[];if(w=l(b[2]),w>65535||w<0)throw new Error("ipaddr: address outside defined range");return v.push(l(b[0])),v.push(l(b[1])),v.push(w>>8&255),v.push(w&255),v}():null},h.IPv4.subnetMaskFromPrefixLength=function(p){if(p=parseInt(p),p<0||p>32)throw new Error("ipaddr: invalid IPv4 prefix length");let y=[0,0,0,0],g=0,w=Math.floor(p/8);for(;g<w;)y[g]=255,g++;return w<4&&(y[w]=Math.pow(2,p%8)-1<<8-p%8),new this(y)},h.IPv6=function(){function p(y,g){let w,b;if(y.length===16)for(this.parts=[],w=0;w<=14;w+=2)this.parts.push(y[w]<<8|y[w+1]);else if(y.length===8)this.parts=y;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(w=0;w<this.parts.length;w++)if(b=this.parts[w],!(0<=b&&b<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");g&&(this.zoneId=g)}return p.prototype.SpecialRanges={unspecified:[new p([0,0,0,0,0,0,0,0]),128],linkLocal:[new p([65152,0,0,0,0,0,0,0]),10],multicast:[new p([65280,0,0,0,0,0,0,0]),8],loopback:[new p([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new p([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new p([0,0,0,0,0,65535,0,0]),96],rfc6145:[new p([0,0,0,0,65535,0,0,0]),96],rfc6052:[new p([100,65435,0,0,0,0,0,0]),96],"6to4":[new p([8194,0,0,0,0,0,0,0]),16],teredo:[new p([8193,0,0,0,0,0,0,0]),32],reserved:[[new p([8193,3512,0,0,0,0,0,0]),32]]},p.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},p.prototype.kind=function(){return"ipv6"},p.prototype.match=function(y,g){let w;if(g===void 0&&(w=y,y=w[0],g=w[1]),y.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,y.parts,16,g)},p.prototype.prefixLengthFromSubnetMask=function(){let y=0,g=!1,w={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},b,v;for(let A=7;A>=0;A-=1)if(b=this.parts[A],b in w){if(v=w[b],g&&v!==0)return null;v!==16&&(g=!0),y+=v}else return null;return 128-y},p.prototype.range=function(){return h.subnetMatch(this,this.SpecialRanges)},p.prototype.toByteArray=function(){let y,g=[],w=this.parts;for(let b=0;b<w.length;b++)y=w[b],g.push(y>>8),g.push(y&255);return g},p.prototype.toFixedLengthString=function(){let y=function(){let w=[];for(let b=0;b<this.parts.length;b++)w.push(d(this.parts[b].toString(16),4));return w}.call(this).join(":"),g="";return this.zoneId&&(g=`%${this.zoneId}`),y+g},p.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");let y=this.parts.slice(-2),g=y[0],w=y[1];return new h.IPv4([g>>8,g&255,w>>8,w&255])},p.prototype.toNormalizedString=function(){let y=function(){let w=[];for(let b=0;b<this.parts.length;b++)w.push(this.parts[b].toString(16));return w}.call(this).join(":"),g="";return this.zoneId&&(g=`%${this.zoneId}`),y+g},p.prototype.toRFC5952String=function(){let y=/((^|:)(0(:|$)){2,})/g,g=this.toNormalizedString(),w=0,b=-1,v;for(;v=y.exec(g);)v[0].length>b&&(w=v.index,b=v[0].length);return b<0?g:`${g.substring(0,w)}::${g.substring(w+b)}`},p.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},p}(),h.IPv6.broadcastAddressFromCIDR=function(p){try{let y=this.parseCIDR(p),g=y[0].toByteArray(),w=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),b=[],v=0;for(;v<16;)b.push(parseInt(g[v],10)|parseInt(w[v],10)^255),v++;return new this(b)}catch(y){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${y})`)}},h.IPv6.isIPv6=function(p){return this.parser(p)!==null},h.IPv6.isValid=function(p){if(typeof p=="string"&&p.indexOf(":")===-1)return!1;try{let y=this.parser(p);return new this(y.parts,y.zoneId),!0}catch(y){return!1}},h.IPv6.networkAddressFromCIDR=function(p){let y,g,w,b,v;try{for(y=this.parseCIDR(p),w=y[0].toByteArray(),v=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),b=[],g=0;g<16;)b.push(parseInt(w[g],10)&parseInt(v[g],10)),g++;return new this(b)}catch(A){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${A})`)}},h.IPv6.parse=function(p){let y=this.parser(p);if(y.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(y.parts,y.zoneId)},h.IPv6.parseCIDR=function(p){let y,g,w;if((g=p.match(/^(.+)\/(\d+)$/))&&(y=parseInt(g[2]),y>=0&&y<=128))return w=[this.parse(g[1]),y],Object.defineProperty(w,"toString",{value:function(){return this.join("/")}}),w;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},h.IPv6.parser=function(p){let y,g,w,b,v,A;if(w=p.match(a.deprecatedTransitional))return this.parser(`::ffff:${w[1]}`);if(a.native.test(p))return c(p,8);if((w=p.match(a.transitional))&&(A=w[6]||"",y=c(w[1].slice(0,-1)+A,6),y.parts)){for(v=[parseInt(w[2]),parseInt(w[3]),parseInt(w[4]),parseInt(w[5])],g=0;g<v.length;g++)if(b=v[g],!(0<=b&&b<=255))return null;return y.parts.push(v[0]<<8|v[1]),y.parts.push(v[2]<<8|v[3]),{parts:y.parts,zoneId:y.zoneId}}return null},h.IPv6.subnetMaskFromPrefixLength=function(p){if(p=parseInt(p),p<0||p>128)throw new Error("ipaddr: invalid IPv6 prefix length");let y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=0,w=Math.floor(p/8);for(;g<w;)y[g]=255,g++;return w<16&&(y[w]=Math.pow(2,p%8)-1<<8-p%8),new this(y)},h.fromByteArray=function(p){let y=p.length;if(y===4)return new h.IPv4(p);if(y===16)return new h.IPv6(p);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},h.isValid=function(p){return h.IPv6.isValid(p)||h.IPv4.isValid(p)},h.parse=function(p){if(h.IPv6.isValid(p))return h.IPv6.parse(p);if(h.IPv4.isValid(p))return h.IPv4.parse(p);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},h.parseCIDR=function(p){try{return h.IPv6.parseCIDR(p)}catch(y){try{return h.IPv4.parseCIDR(p)}catch(g){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},h.process=function(p){let y=this.parse(p);return y.kind()==="ipv6"&&y.isIPv4MappedAddress()?y.toIPv4Address():y},h.subnetMatch=function(p,y,g){let w,b,v,A;g==null&&(g="unicast");for(b in y)if(Object.prototype.hasOwnProperty.call(y,b)){for(v=y[b],v[0]&&!(v[0]instanceof Array)&&(v=[v]),w=0;w<v.length;w++)if(A=v[w],p.kind()===A[0].kind()&&p.match.apply(p,A))return b}return g},typeof A8!="undefined"&&A8.exports?A8.exports=h:r.ipaddr=h})(rfe)});var afe=m(Sm=>{f();"use strict";var nfe=Sm&&Sm.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Sm,"__esModule",{value:!0});var aVe=tfe(),cVe=nfe(r7()),uVe=nfe(n7()),sfe=ife(),lVe=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],fVe=lVe.map(r=>new aVe.Netmask(r));function dVe(r){for(let e of fVe)if(e.contains(r))return!0;return!1}function ofe(r){return/^::$/.test(r)||/^::1$/.test(r)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(r)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(r)||/^ff([0-9a-fA-F]{2,2}):/i.test(r)}Sm.default=r=>{if(sfe.isValid(r)){let e=sfe.parse(r);if(e.kind()==="ipv4")return dVe(e.toNormalizedString());if(e.kind()==="ipv6")return ofe(r)}else if(uVe.default(r)&&cVe.default.v6().test(r))return ofe(r)}});var x8=m((APt,cfe)=>{f();"use strict";cfe.exports=afe().default});var Dr=m((xPt,ffe)=>{f();"use strict";var Rm=le(),{sha256:ufe}=(vi(),Ks),{base58btc:hVe}=(di(),Uo),{base32:pVe}=(en(),Uc),{Key:yVe}=(Mr(),mp),{Record:gVe}=Qa(),mVe=ot(),{fromString:bVe}=(ct(),Qr),{toString:YT}=(tt(),sr),{concat:wVe}=(Si(),Pn),lfe=x8(),_Ve=bVe("/pk/");function vVe({id:r,multiaddrs:e}){return{id:r,multiaddrs:e.filter(t=>{let[[i,n]]=t.stringTuples();return i!==4&&i!==6?!1:!lfe(n)})}}function EVe({id:r,multiaddrs:e}){return{id:r,multiaddrs:e.filter(t=>{let[[i,n]]=t.stringTuples();return i!==4&&i!==6?!1:lfe(n)})}}var SVe=async r=>(await ufe.digest(r)).digest,RVe=async r=>(await ufe.digest(r.id)).digest,AVe=r=>new yVe("/"+YT(r,"base32"),!1),xVe=r=>wVe([_Ve,r.id]),IVe=r=>YT(r.slice(0,4))==="/pk/",TVe=r=>YT(r.slice(0,4))==="/ipns/",PVe=r=>new mVe(r.slice(4)),CVe=(r,e)=>{let t=new Date;return new gVe(r,e,t).serialize()},OVe=r=>(Rm.formatters.b=t=>hVe.baseEncode(t),Rm.formatters.t=t=>pVe.baseEncode(t),Rm.formatters.p=t=>t.toB58String(),Object.assign(Rm(r),{error:Rm(`${r}:error`)}));ffe.exports={removePrivateAddresses:vVe,removePublicAddresses:EVe,convertBuffer:SVe,convertPeerId:RVe,bufferToKey:AVe,keyForPublicKey:xVe,isPublicKeyKey:IVe,isIPNSKey:TVe,fromPublicKeyKey:PVe,createPutRecord:CVe,logger:OVe}});var xc=m(Oi=>{f();"use strict";var Am=Oi.second=1e3,XT=Oi.minute=60*Am,QT=Oi.hour=60*XT;Oi.MAX_RECORD_AGE=36*QT;Oi.PROTOCOL_DHT="/kad/1.0.0";Oi.RECORD_KEY_PREFIX="/dht/record";Oi.PROVIDER_KEY_PREFIX="/dht/provider";Oi.PROVIDERS_LRU_CACHE_SIZE=256;Oi.PROVIDERS_VALIDITY=24*QT;Oi.PROVIDERS_CLEANUP_INTERVAL=QT;Oi.READ_MESSAGE_TIMEOUT=10*Am;Oi.GET_MANY_RECORD_COUNT=16;Oi.K=20;Oi.ALPHA=3;Oi.QUERY_SELF_INTERVAL=Number(5*XT);Oi.QUERY_SELF_TIMEOUT=Number(30*Am);Oi.TABLE_REFRESH_INTERVAL=Number(5*XT);Oi.TABLE_REFRESH_QUERY_TIMEOUT=Number(30*Am);Oi.DEFAULT_QUERY_TIMEOUT=Number(30*Am)});var pfe=m((TPt,hfe)=>{f();"use strict";var kVe=efe(),xm=Dr(),{default:DVe}=$o(),{PROTOCOL_DHT:NVe}=xc(),{TimeoutController:BVe}=Da(),ZT="routing-table-size",dfe=class{constructor({peerId:e,dialer:t,kBucketSize:i,pingTimeout:n,lan:s,metrics:o}){this._log=xm.logger(`libp2p:kad-dht:${s?"lan":"wan"}:routing-table`),this._peerId=e,this._dialer=t,this._kBucketSize=i||20,this._pingTimeout=n||1e4,this._lan=s,this._metrics=o,this.kb,this.commonPrefixLengthRefreshedAt=[],this._onPing=this._onPing.bind(this),this._pingQueue=new DVe({concurrency:1}),this._running=!1}async start(){this._running=!0,this.kb=new kVe({localNodeId:await xm.convertPeerId(this._peerId),numberOfNodesPerKBucket:this._kBucketSize,numberOfNodesToPing:1}),this.kb.on("ping",this._onPing)}async stop(){this._running=!1,this._pingQueue.clear()}_onPing(e,t){this._pingQueue.add(async()=>{if(!this._running)return;let i=0;try{await Promise.all(e.map(async n=>{let s;try{s=new BVe(this._pingTimeout),this._log(`pinging old contact ${n.peer}`);let{stream:o}=await this._dialer.dialProtocol(n.peer,NVe,{signal:s.signal});await o.close(),i++}catch(o){this._running&&(this._log.error("could not ping peer %p",n.peer,o),this._log(`evicting old contact after ping failed ${n.peer}`),this.kb.remove(n.id))}finally{s&&s.clear(),this._metrics&&this._metrics.updateComponentMetric({component:`kad-dht-${this._lan?"lan":"wan"}`,metric:ZT,value:this.size})}})),this._running&&i<e.length&&(this._log(`adding new contact ${t.peer}`),this.kb.add(t))}catch(n){this._log.error("could not process k-bucket ping event",n)}})}get size(){return this.kb.count()}async find(e){let t=await xm.convertPeerId(e),i=this.closestPeer(t);if(i&&e.equals(i))return i}closestPeer(e){let t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e,t=this._kBucketSize){return this.kb.closest(e,t).map(n=>n.peer)}async add(e){let t=await xm.convertPeerId(e);this.kb.add({id:t,peer:e}),this._log("added %p with kad id %b",e,t),this._metrics&&this._metrics.updateComponentMetric({component:`kad-dht-${this._lan?"lan":"wan"}`,metric:ZT,value:this.size})}async remove(e){let t=await xm.convertPeerId(e);this.kb.remove(t),this._metrics&&this._metrics.updateComponentMetric({component:`kad-dht-${this._lan?"lan":"wan"}`,metric:ZT,value:this.size})}};hfe.exports.RoutingTable=dfe});var yfe=m((PPt,LVe)=>{LVe.exports=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782]});var bfe=m((CPt,mfe)=>{f();"use strict";var{xor:MVe}=(mm(),h8),jVe=yfe(),{sha256:qVe}=(vi(),Ks),UVe=Ya(),FVe=ot(),KVe=Dr(),VVe=pg(),{TimeoutController:zVe}=Da(),{TABLE_REFRESH_INTERVAL:HVe,TABLE_REFRESH_QUERY_TIMEOUT:$Ve}=xc(),I8=15,gfe=class{constructor({peerRouting:e,routingTable:t,refreshInterval:i,refreshQueryTimeout:n,lan:s}){this._log=KVe.logger(`libp2p:kad-dht:${s?"lan":"wan"}:routing-table:refresh`),this._peerRouting=e,this._routingTable=t,this._refreshInterval=i||HVe,this._refreshQueryTimeout=n||$Ve,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}async start(){this._log(`refreshing routing table every ${this._refreshInterval}ms`),await this.refreshTable(!0)}async stop(){this._refreshTimeoutId&&clearTimeout(this._refreshTimeoutId)}async refreshTable(e){this._log("refreshing routing table");let t=this._maxCommonPrefix(),i=this._getTrackedCommonPrefixLengthsForRefresh(t);this._log(`max common prefix length ${t}`),this._log(`tracked CPLs [ ${i.map(n=>n.toISOString()).join(", ")} ]`),await Promise.all(i.map(async(n,s)=>{try{if(await this._refreshCommonPrefixLength(s,n,e===!0),this._numPeersForCpl(t)===0){let o=Math.min(2*(s+1),i.length-1);for(let a=s+1;a<o+1;a++)try{await this._refreshCommonPrefixLength(a,n,e===!0)}catch(c){this._log.error(c)}}}catch(o){this._log.error(o)}})),this._refreshTimeoutId=setTimeout(this.refreshTable,this._refreshInterval),this._refreshTimeoutId.unref&&this._refreshTimeoutId.unref()}async _refreshCommonPrefixLength(e,t,i){if(!i&&t.getTime()>Date.now()-this._refreshInterval){this._log("not running refresh for cpl %s as time since last refresh not above interval",e);return}let n=await this._generateRandomPeerId(e);this._log("starting refreshing cpl %s with key %p (routing table size was %s)",e,n,this._routingTable.kb.count());let s=new zVe(this._refreshQueryTimeout);try{let o=await VVe(this._peerRouting.getClosestPeers(n.toBytes(),{signal:s.signal}));this._log(`found ${o} peers that were close to imaginary peer %p`,n),this._log("finished refreshing cpl %s with key %p (routing table size is now %s)",e,n,this._routingTable.kb.count())}finally{s.clear()}}_getTrackedCommonPrefixLengthsForRefresh(e){e>I8&&(e=I8);let t=[];for(let i=0;i<=e;i++)t[i]=this.commonPrefixLengthRefreshedAt[i]||new Date;return t}async _generateRandomPeerId(e){let t=UVe.randomBytes(2),i=(t[1]<<8)+t[0],n=await this._makePeerId(this._routingTable.kb.localNodeId,i,e);return FVe.createFromBytes(n)}async _makePeerId(e,t,i){if(i>I8)throw new Error(`Cannot generate peer ID for common prefix length greater than ${I8}`);let o=new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1)^32768>>i,a=65535<<16-(i+1),c=o&a|t&~a,u=jVe[c],l=new ArrayBuffer(34),d=new DataView(l,0,l.byteLength);return d.setUint8(0,qVe.code),d.setUint8(1,32),d.setUint32(2,u,!1),new Uint8Array(d.buffer,d.byteOffset,d.byteLength)}_maxCommonPrefix(){let e=0;for(let t of this._prefixLengths())t>e&&(e=t);return e}_numPeersForCpl(e){let t=0;for(let i of this._prefixLengths())i===e&&t++;return t}*_prefixLengths(){if(!!this._routingTable.kb)for(let{id:e}of this._routingTable.kb.toIterable()){let t=MVe(this._routingTable.kb.localNodeId,e),i=0;for(let n of t)if(n===0)i++;else break;yield i}}};mfe.exports.RoutingTableRefresh=gfe});var Ic=m((OPt,_fe)=>{f();"use strict";function wfe(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function GVe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return wfe(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),wfe(new n,t)}}_fe.exports=GVe});var eP=m((kPt,vfe)=>{f();"use strict";var mf=Br(),C1=mf.Reader,JT=mf.Writer,We=mf.util,si=mf.roots["libp2p-dht-message"]||(mf.roots["libp2p-dht-message"]={});si.Record=function(){function r(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.key=null,r.prototype.value=null,r.prototype.author=null,r.prototype.signature=null,r.prototype.timeReceived=null;var e;return Object.defineProperty(r.prototype,"_key",{get:We.oneOfGetter(e=["key"]),set:We.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_value",{get:We.oneOfGetter(e=["value"]),set:We.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_author",{get:We.oneOfGetter(e=["author"]),set:We.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_signature",{get:We.oneOfGetter(e=["signature"]),set:We.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_timeReceived",{get:We.oneOfGetter(e=["timeReceived"]),set:We.oneOfSetter(e)}),r.encode=function(i,n){return n||(n=JT.create()),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&n.uint32(10).bytes(i.key),i.value!=null&&Object.hasOwnProperty.call(i,"value")&&n.uint32(18).bytes(i.value),i.author!=null&&Object.hasOwnProperty.call(i,"author")&&n.uint32(26).bytes(i.author),i.signature!=null&&Object.hasOwnProperty.call(i,"signature")&&n.uint32(34).bytes(i.signature),i.timeReceived!=null&&Object.hasOwnProperty.call(i,"timeReceived")&&n.uint32(42).string(i.timeReceived),n},r.decode=function(i,n){i instanceof C1||(i=C1.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new si.Record;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.key=i.bytes();break;case 2:o.value=i.bytes();break;case 3:o.author=i.bytes();break;case 4:o.signature=i.bytes();break;case 5:o.timeReceived=i.string();break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof si.Record)return i;var n=new si.Record;return i.key!=null&&(typeof i.key=="string"?We.base64.decode(i.key,n.key=We.newBuffer(We.base64.length(i.key)),0):i.key.length&&(n.key=i.key)),i.value!=null&&(typeof i.value=="string"?We.base64.decode(i.value,n.value=We.newBuffer(We.base64.length(i.value)),0):i.value.length&&(n.value=i.value)),i.author!=null&&(typeof i.author=="string"?We.base64.decode(i.author,n.author=We.newBuffer(We.base64.length(i.author)),0):i.author.length&&(n.author=i.author)),i.signature!=null&&(typeof i.signature=="string"?We.base64.decode(i.signature,n.signature=We.newBuffer(We.base64.length(i.signature)),0):i.signature.length&&(n.signature=i.signature)),i.timeReceived!=null&&(n.timeReceived=String(i.timeReceived)),n},r.toObject=function(i,n){n||(n={});var s={};return i.key!=null&&i.hasOwnProperty("key")&&(s.key=n.bytes===String?We.base64.encode(i.key,0,i.key.length):n.bytes===Array?Array.prototype.slice.call(i.key):i.key,n.oneofs&&(s._key="key")),i.value!=null&&i.hasOwnProperty("value")&&(s.value=n.bytes===String?We.base64.encode(i.value,0,i.value.length):n.bytes===Array?Array.prototype.slice.call(i.value):i.value,n.oneofs&&(s._value="value")),i.author!=null&&i.hasOwnProperty("author")&&(s.author=n.bytes===String?We.base64.encode(i.author,0,i.author.length):n.bytes===Array?Array.prototype.slice.call(i.author):i.author,n.oneofs&&(s._author="author")),i.signature!=null&&i.hasOwnProperty("signature")&&(s.signature=n.bytes===String?We.base64.encode(i.signature,0,i.signature.length):n.bytes===Array?Array.prototype.slice.call(i.signature):i.signature,n.oneofs&&(s._signature="signature")),i.timeReceived!=null&&i.hasOwnProperty("timeReceived")&&(s.timeReceived=i.timeReceived,n.oneofs&&(s._timeReceived="timeReceived")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,mf.util.toJSONOptions)},r}();si.Message=function(){function r(t){if(this.closerPeers=[],this.providerPeers=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.type=null,r.prototype.clusterLevelRaw=null,r.prototype.key=null,r.prototype.record=null,r.prototype.closerPeers=We.emptyArray,r.prototype.providerPeers=We.emptyArray;var e;return Object.defineProperty(r.prototype,"_type",{get:We.oneOfGetter(e=["type"]),set:We.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_clusterLevelRaw",{get:We.oneOfGetter(e=["clusterLevelRaw"]),set:We.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_key",{get:We.oneOfGetter(e=["key"]),set:We.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_record",{get:We.oneOfGetter(e=["record"]),set:We.oneOfSetter(e)}),r.encode=function(i,n){if(n||(n=JT.create()),i.type!=null&&Object.hasOwnProperty.call(i,"type")&&n.uint32(8).int32(i.type),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&n.uint32(18).bytes(i.key),i.record!=null&&Object.hasOwnProperty.call(i,"record")&&n.uint32(26).bytes(i.record),i.closerPeers!=null&&i.closerPeers.length)for(var s=0;s<i.closerPeers.length;++s)si.Message.Peer.encode(i.closerPeers[s],n.uint32(66).fork()).ldelim();if(i.providerPeers!=null&&i.providerPeers.length)for(var s=0;s<i.providerPeers.length;++s)si.Message.Peer.encode(i.providerPeers[s],n.uint32(74).fork()).ldelim();return i.clusterLevelRaw!=null&&Object.hasOwnProperty.call(i,"clusterLevelRaw")&&n.uint32(80).int32(i.clusterLevelRaw),n},r.decode=function(i,n){i instanceof C1||(i=C1.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new si.Message;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.type=i.int32();break;case 10:o.clusterLevelRaw=i.int32();break;case 2:o.key=i.bytes();break;case 3:o.record=i.bytes();break;case 8:o.closerPeers&&o.closerPeers.length||(o.closerPeers=[]),o.closerPeers.push(si.Message.Peer.decode(i,i.uint32()));break;case 9:o.providerPeers&&o.providerPeers.length||(o.providerPeers=[]),o.providerPeers.push(si.Message.Peer.decode(i,i.uint32()));break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof si.Message)return i;var n=new si.Message;switch(i.type){case"PUT_VALUE":case 0:n.type=0;break;case"GET_VALUE":case 1:n.type=1;break;case"ADD_PROVIDER":case 2:n.type=2;break;case"GET_PROVIDERS":case 3:n.type=3;break;case"FIND_NODE":case 4:n.type=4;break;case"PING":case 5:n.type=5;break}if(i.clusterLevelRaw!=null&&(n.clusterLevelRaw=i.clusterLevelRaw|0),i.key!=null&&(typeof i.key=="string"?We.base64.decode(i.key,n.key=We.newBuffer(We.base64.length(i.key)),0):i.key.length&&(n.key=i.key)),i.record!=null&&(typeof i.record=="string"?We.base64.decode(i.record,n.record=We.newBuffer(We.base64.length(i.record)),0):i.record.length&&(n.record=i.record)),i.closerPeers){if(!Array.isArray(i.closerPeers))throw TypeError(".Message.closerPeers: array expected");n.closerPeers=[];for(var s=0;s<i.closerPeers.length;++s){if(typeof i.closerPeers[s]!="object")throw TypeError(".Message.closerPeers: object expected");n.closerPeers[s]=si.Message.Peer.fromObject(i.closerPeers[s])}}if(i.providerPeers){if(!Array.isArray(i.providerPeers))throw TypeError(".Message.providerPeers: array expected");n.providerPeers=[];for(var s=0;s<i.providerPeers.length;++s){if(typeof i.providerPeers[s]!="object")throw TypeError(".Message.providerPeers: object expected");n.providerPeers[s]=si.Message.Peer.fromObject(i.providerPeers[s])}}return n},r.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.closerPeers=[],s.providerPeers=[]),i.type!=null&&i.hasOwnProperty("type")&&(s.type=n.enums===String?si.Message.MessageType[i.type]:i.type,n.oneofs&&(s._type="type")),i.key!=null&&i.hasOwnProperty("key")&&(s.key=n.bytes===String?We.base64.encode(i.key,0,i.key.length):n.bytes===Array?Array.prototype.slice.call(i.key):i.key,n.oneofs&&(s._key="key")),i.record!=null&&i.hasOwnProperty("record")&&(s.record=n.bytes===String?We.base64.encode(i.record,0,i.record.length):n.bytes===Array?Array.prototype.slice.call(i.record):i.record,n.oneofs&&(s._record="record")),i.closerPeers&&i.closerPeers.length){s.closerPeers=[];for(var o=0;o<i.closerPeers.length;++o)s.closerPeers[o]=si.Message.Peer.toObject(i.closerPeers[o],n)}if(i.providerPeers&&i.providerPeers.length){s.providerPeers=[];for(var o=0;o<i.providerPeers.length;++o)s.providerPeers[o]=si.Message.Peer.toObject(i.providerPeers[o],n)}return i.clusterLevelRaw!=null&&i.hasOwnProperty("clusterLevelRaw")&&(s.clusterLevelRaw=i.clusterLevelRaw,n.oneofs&&(s._clusterLevelRaw="clusterLevelRaw")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,mf.util.toJSONOptions)},r.MessageType=function(){var t={},i=Object.create(t);return i[t[0]="PUT_VALUE"]=0,i[t[1]="GET_VALUE"]=1,i[t[2]="ADD_PROVIDER"]=2,i[t[3]="GET_PROVIDERS"]=3,i[t[4]="FIND_NODE"]=4,i[t[5]="PING"]=5,i}(),r.ConnectionType=function(){var t={},i=Object.create(t);return i[t[0]="NOT_CONNECTED"]=0,i[t[1]="CONNECTED"]=1,i[t[2]="CAN_CONNECT"]=2,i[t[3]="CANNOT_CONNECT"]=3,i}(),r.Peer=function(){function t(n){if(this.addrs=[],n)for(var s=Object.keys(n),o=0;o<s.length;++o)n[s[o]]!=null&&(this[s[o]]=n[s[o]])}t.prototype.id=null,t.prototype.addrs=We.emptyArray,t.prototype.connection=null;var i;return Object.defineProperty(t.prototype,"_id",{get:We.oneOfGetter(i=["id"]),set:We.oneOfSetter(i)}),Object.defineProperty(t.prototype,"_connection",{get:We.oneOfGetter(i=["connection"]),set:We.oneOfSetter(i)}),t.encode=function(s,o){if(o||(o=JT.create()),s.id!=null&&Object.hasOwnProperty.call(s,"id")&&o.uint32(10).bytes(s.id),s.addrs!=null&&s.addrs.length)for(var a=0;a<s.addrs.length;++a)o.uint32(18).bytes(s.addrs[a]);return s.connection!=null&&Object.hasOwnProperty.call(s,"connection")&&o.uint32(24).int32(s.connection),o},t.decode=function(s,o){s instanceof C1||(s=C1.create(s));for(var a=o===void 0?s.len:s.pos+o,c=new si.Message.Peer;s.pos<a;){var u=s.uint32();switch(u>>>3){case 1:c.id=s.bytes();break;case 2:c.addrs&&c.addrs.length||(c.addrs=[]),c.addrs.push(s.bytes());break;case 3:c.connection=s.int32();break;default:s.skipType(u&7);break}}return c},t.fromObject=function(s){if(s instanceof si.Message.Peer)return s;var o=new si.Message.Peer;if(s.id!=null&&(typeof s.id=="string"?We.base64.decode(s.id,o.id=We.newBuffer(We.base64.length(s.id)),0):s.id.length&&(o.id=s.id)),s.addrs){if(!Array.isArray(s.addrs))throw TypeError(".Message.Peer.addrs: array expected");o.addrs=[];for(var a=0;a<s.addrs.length;++a)typeof s.addrs[a]=="string"?We.base64.decode(s.addrs[a],o.addrs[a]=We.newBuffer(We.base64.length(s.addrs[a])),0):s.addrs[a].length&&(o.addrs[a]=s.addrs[a])}switch(s.connection){case"NOT_CONNECTED":case 0:o.connection=0;break;case"CONNECTED":case 1:o.connection=1;break;case"CAN_CONNECT":case 2:o.connection=2;break;case"CANNOT_CONNECT":case 3:o.connection=3;break}return o},t.toObject=function(s,o){o||(o={});var a={};if((o.arrays||o.defaults)&&(a.addrs=[]),s.id!=null&&s.hasOwnProperty("id")&&(a.id=o.bytes===String?We.base64.encode(s.id,0,s.id.length):o.bytes===Array?Array.prototype.slice.call(s.id):s.id,o.oneofs&&(a._id="id")),s.addrs&&s.addrs.length){a.addrs=[];for(var c=0;c<s.addrs.length;++c)a.addrs[c]=o.bytes===String?We.base64.encode(s.addrs[c],0,s.addrs[c].length):o.bytes===Array?Array.prototype.slice.call(s.addrs[c]):s.addrs[c]}return s.connection!=null&&s.hasOwnProperty("connection")&&(a.connection=o.enums===String?si.Message.ConnectionType[s.connection]:s.connection,o.oneofs&&(a._connection="connection")),a},t.prototype.toJSON=function(){return this.constructor.toObject(this,mf.util.toJSONOptions)},t}(),r}();vfe.exports=si});var ya=m((DPt,P8)=>{f();"use strict";var WVe=ot(),{Multiaddr:YVe}=ft(),{Record:XVe}=Qa(),T8=eP(),tP=T8.Message.MessageType,Efe=T8.Message.ConnectionType,QVe=Object.keys(tP),O1=class{constructor(e,t,i){if(t&&!(t instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=t,this._clusterLevelRaw=i,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){let e=this._clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this._clusterLevelRaw=e}serialize(){let e={key:this.key,type:this.type,clusterLevelRaw:this._clusterLevelRaw,closerPeers:this.closerPeers.map(Sfe),providerPeers:this.providerPeers.map(Sfe),record:void 0};return this.record&&(this.record instanceof Uint8Array?e.record=this.record:e.record=this.record.serialize()),T8.Message.encode(e).finish()}static deserialize(e){let t=T8.Message.decode(e),i=new O1(t.type||0,t.key||Uint8Array.from([]),t.clusterLevelRaw||0);return i.closerPeers=t.closerPeers.map(Rfe),i.providerPeers=t.providerPeers.map(Rfe),t.record&&t.record.length&&(i.record=XVe.deserialize(t.record)),i}};O1.TYPES=tP;O1.CONNECTION_TYPES=Efe;function Sfe(r){return{id:r.id.id,addrs:(r.multiaddrs||[]).map(t=>t.bytes),connection:Efe.CONNECTED}}function Rfe(r){return{id:new WVe(r.id),multiaddrs:(r.addrs||[]).map(e=>new YVe(e))}}P8.exports.Message=O1;P8.exports.MESSAGE_TYPE=tP;P8.exports.MESSAGE_TYPE_LOOKUP=QVe});var dh=m((NPt,Afe)=>{f();"use strict";var{MESSAGE_TYPE_LOOKUP:ZVe}=ya(),JVe=["PUT_VALUE","GET_VALUE","ADD_PROVIDER","GET_PROVIDERS","FIND_NODE","PING"];function eze(r){return{...r,name:"SENDING_QUERY",type:0,messageName:ZVe[r.type],messageType:r.type}}function tze(r){return{...r,name:"PEER_RESPONSE",type:1,messageName:JVe[r.messageType],closer:r.closer?r.closer:[],providers:r.providers?r.providers:[]}}function rze(r){return{...r,name:"FINAL_PEER",type:2}}function ize(r){return{...r,name:"QUERY_ERROR",type:3}}function nze(r){return{...r,name:"PROVIDER",type:4}}function sze(r){return{...r,name:"VALUE",type:5}}function oze(r){return{...r,name:"ADDING_PEER",type:6}}function aze(r){return{...r,name:"DIALING_PEER",type:7}}Afe.exports={sendingQueryEvent:eze,peerResponseEvent:tze,finalPeerEvent:rze,queryErrorEvent:ize,providerEvent:nze,valueEvent:sze,addingPeerEvent:oze,dialingPeerEvent:aze}});var Nfe=m((BPt,Dfe)=>{f();"use strict";var cze=Ic(),{pipe:xfe}=dr(),rP=go(),uze=ts(),lze=Rd(),{Message:fze,MESSAGE_TYPE_LOOKUP:Ife}=ya(),dze=Dr(),{EventEmitter:hze}=Ut(),{dialingPeerEvent:Tfe,sendingQueryEvent:Pfe,peerResponseEvent:Cfe,queryErrorEvent:Ofe}=dh(),kfe=class extends hze{constructor({dialer:e,protocol:t,lan:i}){super();this._log=dze.logger(`libp2p:kad-dht:${i?"lan":"wan"}:network`),this._running=!1,this._dialer=e,this._protocol=t}start(){this._running||(this._running=!0)}stop(){this._running=!1}get isStarted(){return this._running}async*sendRequest(e,t,i={}){if(!!this._running){this._log("sending %s to %p",Ife[t.type],e);try{yield Tfe({peer:e});let{stream:n}=await this._dialer.dialProtocol(e,this._protocol,i);yield Pfe({to:e,type:t.type});let s=await this._writeReadMessage(n,t.serialize(),i);yield Cfe({from:e,messageType:s.type,closer:s.closerPeers,providers:s.providerPeers,record:s.record})}catch(n){yield Ofe({from:e,error:n})}}}async*sendMessage(e,t,i={}){if(!this._running)return;this._log("sending %s to %p",Ife[t.type],e),yield Tfe({peer:e});let{stream:n}=await this._dialer.dialProtocol(e,this._protocol,i);yield Pfe({to:e,type:t.type});try{await this._writeMessage(n,t.serialize(),i),yield Cfe({from:e,messageType:t.type})}catch(s){yield Ofe({from:e,error:s})}}async _writeMessage(e,t,i={}){await xfe([t],rP.encode(),e,uze)}async _writeReadMessage(e,t,i={}){let n=await xfe([t],rP.encode(),e,rP.decode(),async o=>{let a=await lze(o);if(a)return a.slice()});if(n.length===0)throw cze(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED");let s=fze.deserialize(n);return s.closerPeers.forEach(o=>{this.emit("peer",o)}),s.providerPeers.forEach(o=>{this.emit("peer",o)}),s}};Dfe.exports.Network=kfe});var qfe=m((LPt,jfe)=>{f();"use strict";var iP=Ic(),{equals:nP}=(hi(),dn),{toString:pze}=(tt(),sr),sP=Qa(),{ALPHA:yze}=xc(),bf=Dr(),Im=sP.Record,gze=C6(),mze=bn(),{valueEvent:Bfe,queryErrorEvent:Lfe}=dh(),{Message:C8}=ya(),{pipe:bze}=dr(),Mfe=class{constructor({peerId:e,records:t,validators:i,selectors:n,peerRouting:s,queryManager:o,routingTable:a,network:c,lan:u}){this._log=bf.logger(`libp2p:kad-dht:${u?"lan":"wan"}:content-fetching`),this._peerId=e,this._records=t,this._validators=i,this._selectors=n,this._peerRouting=s,this._queryManager=o,this._routingTable=a,this._network=c}async putLocal(e,t){return this._records.put(bf.bufferToKey(e),t)}async getLocal(e){this._log(`getLocal ${pze(e,"base32")}`);let t=bf.bufferToKey(e);this._log(`fetching record for key ${t}`);let i=await this._records.get(t);this._log(`found ${t} in local datastore`);let n=Im.deserialize(i);return await sP.validator.verifyRecord(this._validators,n),n}async*sendCorrectionRecord(e,t,i,n={}){this._log("sendCorrection for %b",e);let s=await bf.createPutRecord(e,i);for(let{value:o,from:a}of t){if(nP(o,i)){this._log("record was ok");continue}if(this._peerId.equals(a)){try{let l=bf.bufferToKey(e);this._log(`Storing corrected record for key ${l}`),await this._records.put(l,s)}catch(l){this._log.error("Failed error correcting self",l)}continue}let c=!1,u=new C8(C8.TYPES.PUT_VALUE,e,0);u.record=Im.deserialize(s);for await(let l of this._network.sendRequest(a,u,n))l.name==="PEER_RESPONSE"&&l.record&&nP(l.record.value,Im.deserialize(s).value)&&(c=!0),yield l;c||(yield Lfe({from:a,error:iP(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})),this._log.error("Failed error correcting entry")}}async*put(e,t,i={}){this._log("put key %b value %b",e,t);let n=await bf.createPutRecord(e,t),s=bf.bufferToKey(e);this._log(`storing record for key ${s}`),await this._records.put(s,n),yield*bze(this._peerRouting.getClosestPeers(e,{signal:i.signal}),o=>mze(o,a=>async()=>{if(a.name!=="FINAL_PEER")return[a];let c=[],u=new C8(C8.TYPES.PUT_VALUE,e,0);u.record=Im.deserialize(n);for await(let l of this._network.sendRequest(a.peer.id,u,i))c.push(l),l.name==="PEER_RESPONSE"&&(l.record&&nP(l.record.value,Im.deserialize(n).value)||c.push(Lfe({from:a.peer.id,error:iP(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})));return c}),o=>gze(o,{ordered:!1,concurrency:yze}),async function*(o){for await(let a of o)yield*a})}async*get(e,t={}){this._log("get %b",e);let i=[];for await(let a of this.getMany(e,t))a.name==="VALUE"&&i.push(a),yield a;if(!i.length)return;let n=i.map(a=>a.value),s=0;try{s=sP.selection.bestRecord(this._selectors,e,n)}catch(a){if(a.code!=="ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")throw a}let o=n[s];if(this._log("GetValue %b %b",e,o),!o)throw iP(new Error("best value was not found"),"ERR_NOT_FOUND");yield*this.sendCorrectionRecord(e,i,o,t),yield i[s]}async*getMany(e,t={}){this._log("getMany values for %t",e);try{let a=await this.getLocal(e);yield Bfe({value:a.value,from:this._peerId})}catch(a){this._log("error getting local value for %b",e,a)}let i=await bf.convertBuffer(e),n=this._routingTable.closestPeers(i);this._log("found %d peers in routing table",n.length);let s=this,o=async function*({peer:a,signal:c}){for await(let u of s._peerRouting.getValueOrPeers(a,e,{signal:c}))yield u,u.name==="PEER_RESPONSE"&&u.record&&(yield Bfe({from:a,value:u.record.value}))};yield*this._queryManager.run(e,n,o,t)}};jfe.exports.ContentFetching=Mfe});var Vfe=m((MPt,Kfe)=>{f();"use strict";var{Message:O8}=ya(),wze=C6(),_ze=bn(),{convertBuffer:vze,logger:Eze}=Dr(),{ALPHA:Sze}=xc(),{pipe:Rze}=dr(),{queryErrorEvent:Aze,peerResponseEvent:xze,providerEvent:Ufe}=dh(),{Message:{MessageType:Ize}}=eP(),Ffe=class{constructor({peerId:e,network:t,peerRouting:i,queryManager:n,routingTable:s,providers:o,peerStore:a,lan:c}){this._log=Eze(`libp2p:kad-dht:${c?"lan":"wan"}:content-routing`),this._peerId=e,this._network=t,this._peerRouting=i,this._queryManager=n,this._routingTable=s,this._providers=o,this._peerStore=a}async*provide(e,t,i={}){this._log("provide %s",e),await this._providers.addProvider(e,this._peerId);let n=new O8(O8.TYPES.ADD_PROVIDER,e.bytes,0);n.providerPeers=[{id:this._peerId,multiaddrs:t}];let s=0,o=a=>async()=>{if(a.name!=="FINAL_PEER")return[a];let c=[];this._log("putProvider %s to %p",e,a.peer.id);try{this._log("sending provider record for %s to %p",e,a.peer.id);for await(let u of this._network.sendMessage(a.peer.id,n,i))u.name==="PEER_RESPONSE"&&(this._log("sent provider record for %s to %p",e,a.peer.id),s++),c.push(u)}catch(u){this._log.error("error sending provide record to peer %p",a.peer.id,u),c.push(Aze({from:a.peer.id,error:u}))}return c};yield*Rze(this._peerRouting.getClosestPeers(e.multihash.bytes,i),a=>_ze(a,c=>o(c)),a=>wze(a,{ordered:!1,concurrency:Sze}),async function*(a){for await(let c of a)yield*c}),this._log("sent provider records to %d peers",s)}async*findProviders(e,t={maxNumProviders:5}){let i=t.maxNumProviders||this._routingTable._kBucketSize,n=e.multihash.bytes,s=await vze(n),o=this;this._log(`findProviders ${e}`);let a=await this._providers.getProviders(e);if(a.length){let l=[];for(let d of a.slice(0,i))l.push({id:d,multiaddrs:(await this._peerStore.addressBook.get(d)||[]).map(h=>h.multiaddr)});yield xze({from:this._peerId,messageType:Ize.GET_PROVIDERS,providers:l}),yield Ufe({from:this._peerId,providers:l})}if(a.length>=i)return;let c=async function*({peer:l,signal:d}){let h=new O8(O8.TYPES.GET_PROVIDERS,n,0);yield*o._network.sendRequest(l,h,{signal:d})},u=new Set(a.map(l=>l.toB58String()));for await(let l of this._queryManager.run(n,this._routingTable.closestPeers(s),c,t))if(yield l,l.name==="PEER_RESPONSE"){this._log(`Found ${l.providers.length} provider entries for ${e} and ${l.closer.length} closer peers`);let d=[];for(let h of l.providers)u.has(h.id.toB58String())||(u.add(h.id.toB58String()),d.push(h));if(d.length&&(yield Ufe({from:l.from,providers:d})),u.size===i)return}}};Kfe.exports.ContentRouting=Ffe});var Hfe=m((jPt,zfe)=>{f();"use strict";zfe.exports=(r,e=1,t)=>{if(t={indent:" ",includeEmptyLines:!1,...t},typeof r!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof r}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(typeof t.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof t.indent}\``);if(e===0)return r;let i=t.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return r.replace(i,t.indent.repeat(e))}});var $fe=m(()=>{f()});var Xfe=m((FPt,Yfe)=>{f();"use strict";var Gfe=$fe(),Wfe=/\s+at.*(?:\(|\s)(.*)\)?/,Tze=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,Pze=typeof Gfe.homedir=="undefined"?"":Gfe.homedir();Yfe.exports=(r,e)=>(e=Object.assign({pretty:!1},e),r.replace(/\\/g,"/").split(`
`).filter(t=>{let i=t.match(Wfe);if(i===null||!i[1])return!0;let n=i[1];return n.includes(".app/Contents/Resources/electron.asar")||n.includes(".app/Contents/Resources/default_app.asar")?!1:!Tze.test(n)}).filter(t=>t.trim()!=="").map(t=>e.pretty?t.replace(Wfe,(i,n)=>i.replace(n,n.replace(Pze,"~"))):t).join(`
`))});var oP=m((KPt,Zfe)=>{f();"use strict";var Cze=Hfe(),Oze=Xfe(),kze=r=>r.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),Qfe=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);e=[...e].map(i=>i instanceof Error?i:i!==null&&typeof i=="object"?Object.assign(new Error(i.message),i):new Error(i));let t=e.map(i=>typeof i.stack=="string"?kze(Oze(i.stack)):String(i)).join(`
`);t=`
`+Cze(t,4);super(t);this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(let e of this._errors)yield e}};Zfe.exports=Qfe});var ede=m((VPt,Jfe)=>{f();"use strict";var Dze=oP();Jfe.exports=async(r,e,{concurrency:t=1/0,stopOnError:i=!0}={})=>new Promise((n,s)=>{if(typeof e!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(t)||t===1/0)&&t>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${t}\` (${typeof t})`);let o=[],a=[],c=r[Symbol.iterator](),u=!1,l=!1,d=0,h=0,p=()=>{if(u)return;let y=c.next(),g=h;if(h++,y.done){l=!0,d===0&&(!i&&a.length!==0?s(new Dze(a)):n(o));return}d++,(async()=>{try{let w=await y.value;o[g]=await e(w,g),d--,p()}catch(w){i?(u=!0,s(w)):(a.push(w),d--,p())}})()};for(let y=0;y<t&&(p(),!l);y++);})});var ode=m((zPt,sde)=>{f();"use strict";var tde=Dr(),Nze=ede(),{compare:rde}=(zb(),JX),{xor:ide}=(mm(),h8),nde=class{constructor(e,t){this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(e=>e.peerId)}async add(e){if(this.peerDistances.find(n=>n.peerId.equals(e)))return;let t=await tde.convertPeerId(e),i={peerId:e,distance:ide(this.originDhtKey,t)};this.peerDistances.push(i),this.peerDistances.sort((n,s)=>rde(n.distance,s.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(!e.length)return!1;if(!this.length)return!0;let t=await Nze(e,n=>tde.convertPeerId(n)),i=this.peerDistances[this.peerDistances.length-1].distance;for(let n of t){let s=ide(this.originDhtKey,n);if(rde(s,i)<0)return!0}return!1}};sde.exports=nde});var lde=m((HPt,ude)=>{f();"use strict";var k8=Ic(),{validator:Bze}=Qa(),Lze=ot(),{toString:Mze}=(tt(),sr),{Message:k1}=ya(),Tm=Dr(),{queryErrorEvent:ade,finalPeerEvent:D8,valueEvent:jze}=dh(),qze=ode(),{Record:Uze}=Qa(),cde=class{constructor({peerId:e,routingTable:t,peerStore:i,network:n,validators:s,queryManager:o,lan:a}){this._peerId=e,this._routingTable=t,this._peerStore=i,this._network=n,this._validators=s,this._queryManager=o,this._log=Tm.logger(`libp2p:kad-dht:${a?"lan":"wan"}:peer-routing`)}async findPeerLocal(e){let t,i=await this._routingTable.find(e);if(i){this._log("findPeerLocal found %p in routing table",e);try{t=await this._peerStore.get(i)}catch(n){if(n.code!=="ERR_NOT_FOUND")throw n}}if(!t)try{t=await this._peerStore.get(e)}catch(n){if(n.code!=="ERR_NOT_FOUND")throw n}if(t)return this._log("findPeerLocal found %p in peer store",e),{id:t.id,multiaddrs:t.addresses.map(n=>n.multiaddr)}}async*_getValueSingle(e,t,i={}){let n=new k1(k1.TYPES.GET_VALUE,t,0);yield*this._network.sendRequest(e,n,i)}async*getPublicKeyFromNode(e,t){let i=Tm.keyForPublicKey(e);for await(let n of this._getValueSingle(e,i,t))if(yield n,n.name==="PEER_RESPONSE"&&n.record){let s=await Lze.createFromPubKey(n.record.value);if(!s.equals(e))throw k8(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");yield jze({from:e,value:s.pubKey.bytes})}throw k8(new Error(`Node not responding with its public key: ${e.toB58String()}`),"ERR_INVALID_RECORD")}async*findPeer(e,t={}){this._log("findPeer %p",e);let i=await this.findPeerLocal(e);if(i!=null){this._log("found local"),yield D8({from:this._peerId,peer:i});return}let n=await Tm.convertPeerId(e),s=this._routingTable.closestPeers(n);if(s.find(l=>l.equals(e)))try{let l=await this._peerStore.get(e);this._log("found in peerStore"),yield D8({from:this._peerId,peer:{id:l.id,multiaddrs:l.addresses.map(d=>d.multiaddr)}});return}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l}let a=this,c=async function*({peer:l,signal:d}){let h=new k1(k1.TYPES.FIND_NODE,e.toBytes(),0);for await(let p of a._network.sendRequest(l,h,{signal:d}))if(yield p,p.name==="PEER_RESPONSE"){let y=p.closer.find(g=>g.id.equals(e));y&&(yield D8({from:p.from,peer:y}))}},u=!1;for await(let l of this._queryManager.run(e.id,s,c,t))l.name==="FINAL_PEER"&&(u=!0),yield l;u||(yield ade({from:this._peerId,error:k8(new Error("Not found"),"ERR_NOT_FOUND")}))}async*getClosestPeers(e,t={}){this._log("getClosestPeers to %b",e);let i=await Tm.convertBuffer(e),n=this._routingTable.closestPeers(i),s=this,o=new qze(i,this._routingTable._kBucketSize);n.forEach(c=>o.add(c));let a=async function*({peer:c,signal:u}){s._log("closerPeersSingle %s from %p",Mze(e,"base32"),c);let l=new k1(k1.TYPES.FIND_NODE,e,0);yield*s._network.sendRequest(c,l,{signal:u})};for await(let c of this._queryManager.run(e,n,a,t))yield c,c.name==="PEER_RESPONSE"&&c.closer.forEach(u=>{o.add(u.id)});this._log("found %d peers close to %b",o.length,e);for(let c of o.peers)yield D8({from:this._peerId,peer:{id:c,multiaddrs:(await this._peerStore.addressBook.get(c)||[]).map(u=>u.multiaddr)}})}async*getValueOrPeers(e,t,i={}){for await(let n of this._getValueSingle(e,t,i)){if(n.name==="PEER_RESPONSE"&&n.record)try{await this._verifyRecordOnline(n.record)}catch(s){let o="invalid record received, discarded";this._log(o),yield ade({from:n.from,error:k8(new Error(o),"ERR_INVALID_RECORD")});continue}yield n}}async _verifyRecordOnline({key:e,value:t,timeReceived:i}){await Bze.verifyRecord(this._validators,new Uze(e,t,i))}async getCloserPeersOffline(e,t){let i=await Tm.convertBuffer(e),n=this._routingTable.closestPeers(i),s=[];for(let o of n)if(!o.equals(t))try{let a=await this._peerStore.addressBook.get(o);s.push({id:o,multiaddrs:a.map(c=>c.multiaddr)})}catch(a){if(a.code!=="ERR_NOT_FOUND")throw a}return s.length?this._log("getCloserPeersOffline found %d peer(s) closer to %b than %p",s.length,e,t):this._log("getCloserPeersOffline could not find peer closer to %b than %p",e,t),s}};ude.exports.PeerRouting=cde});var mde=m(($Pt,gde)=>{f();"use strict";var Fze=wp(),fde=Wn(),Kze=ot(),{Key:Vze}=(Mr(),mp),{default:zze}=$o(),{PROVIDERS_CLEANUP_INTERVAL:Hze,PROVIDERS_VALIDITY:$ze,PROVIDERS_LRU_CACHE_SIZE:Gze,PROVIDER_KEY_PREFIX:dde}=xc(),Wze=Dr(),{toString:Yze}=(tt(),sr),wf=Wze.logger("libp2p:kad-dht:providers"),hde=class{constructor({providers:e,cacheSize:t,cleanupInterval:i,provideValidity:n}){this.datastore=e,this.cleanupInterval=i||Hze,this.provideValidity=n||$ze,this.cache=Fze(t||Gze),this.syncQueue=new zze({concurrency:1})}start(){this._started||(this._started=!0,this._cleaner=setInterval(()=>this._cleanup(),this.cleanupInterval))}stop(){this._started=!1,this._cleaner&&(clearInterval(this._cleaner),this._cleaner=null)}_cleanup(){return this.syncQueue.add(async()=>{let e=Date.now(),t=0,i=0,n=new Map,s=this.datastore.batch(),o=this.datastore.query({prefix:dde});for await(let a of o)try{let{cid:c,peerId:u}=pde(a.key),l=yde(a.value),d=Date.now(),h=d-l,p=h>this.provideValidity;if(wf("comparing: %d - %d = %d > %d %s",d,l,h,this.provideValidity,p?"(expired)":""),p){i++,s.delete(a.key);let y=n.get(c)||new Set;y.add(u),n.set(c,y)}t++}catch(c){wf.error(c.message)}n.size?(wf("deleting %d / %d entries",i,t),await s.commit()):wf("nothing to delete");for(let[a,c]of n){let u=Pm(a),l=this.cache.get(u);if(l){for(let d of c)l.delete(d);l.size===0?this.cache.remove(u):this.cache.set(u,l)}}wf("Cleanup successful (%dms)",Date.now()-e)})}async _getProvidersMap(e){let t=Pm(e),i=this.cache.get(t);return i||(i=await Qze(this.datastore,e),this.cache.set(t,i)),i}async addProvider(e,t){return this.syncQueue.add(async()=>{wf("%p provides %s",t,e);let i=await this._getProvidersMap(e);wf("loaded %s provs",i.size);let n=new Date;i.set(t.toString(),n);let s=Pm(e);return this.cache.set(s,i),Xze(this.datastore,e,t,n)})}async getProviders(e){return this.syncQueue.add(async()=>(wf("get providers for %s",e),[...(await this._getProvidersMap(e)).keys()].map(i=>Kze.parse(i))))}};function Pm(r){return r=typeof r=="string"?r:Yze(r.multihash.bytes,"base32"),`${dde}/${r}`}async function Xze(r,e,t,i){let n=[Pm(e),"/",t.toString()].join(""),s=new Vze(n),o=Uint8Array.from(fde.encode(i.getTime()));return r.put(s,o)}function pde(r){let e=r.toString().split("/");if(e.length!==5)throw new Error("incorrectly formatted provider entry key in datastore: "+r);return{cid:e[3],peerId:e[4]}}async function Qze(r,e){let t=new Map,i=r.query({prefix:Pm(e)});for await(let n of i){let{peerId:s}=pde(n.key);t.set(s,yde(n.value))}return t}function yde(r){return fde.decode(r)}gde.exports.Providers=hde});var Sde=m((GPt,Ede)=>{f();"use strict";var{default:Zze}=$o(),{xor:bde}=(mm(),h8),{toString:wde}=(tt(),sr),_de=Za(),Jze=Ic(),{convertPeerId:vde,convertBuffer:eHe}=Dr(),{TimeoutController:tHe}=Da(),{anySignal:rHe}=Ho(),{queryErrorEvent:iHe}=dh(),nHe=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");Ede.exports.queryPath=async function*({key:e,startingPeer:t,ourPeerId:i,signal:n,query:s,alpha:o,pathIndex:a,numPaths:c,cleanUp:u,queryFuncTimeout:l,log:d}){let h=new Zze({concurrency:o}),p=await eHe(e),y=new Set;function g(w,b){if(!w)return;y.add(w.toB58String());let v=BigInt("0x"+wde(bde(b,p),"base16"));h.add(async()=>{let A,k=[n];l!=null&&(A=new tHe(l),k.push(A.signal));let C=rHe(k);try{for await(let T of s({key:e,peer:w,signal:C,pathIndex:a,numPaths:c})){if(C.aborted)return;if(T.name==="PEER_RESPONSE")for(let D of T.closer){if(y.has(D.id.toB58String())){d("already seen %p in query",D.id);continue}if(i.equals(D.id)){d("not querying ourselves");continue}let j=await vde(D.id);if(BigInt("0x"+wde(bde(j,p),"base16"))>v){d("skipping %p as they are not closer to %b than %p",D.id,e,w);continue}d("querying closer peer %p",D.id),g(D.id,j)}h.emit("completed",T)}A&&A.clear()}catch(T){n.aborted?h.emit("error",T):h.emit("completed",iHe({from:w,error:T}))}finally{A&&A.clear()}},{priority:nHe-v})}g(t,await vde(t)),yield*sHe(h,n,u,d)};async function*sHe(r,e,t,i){let n=_de(),s=!0,o=[],a=()=>{!s||(i("clean up queue, results %d, queue size %d, pending tasks %d",o.length,r.size,r.pending),s=!1,r.clear(),o.splice(0,o.length))};for(r.on("completed",c=>{o.push(c),n.resolve()}),r.on("error",c=>{i("queue error",c),a(),n.reject(c)}),r.on("idle",()=>{i("queue idle"),s=!1,n.resolve()}),e.addEventListener("abort",()=>{i("abort queue");let c=s;a(),c&&n.reject(Jze(new Error("Query aborted"),"ERR_QUERY_ABORTED"))}),t.on("cleanup",()=>{a(),n.resolve()});s;)for(await n.promise,n=_de();o.length;){let c=o.shift();c&&(yield c)}yield*o}});var Cde=m((WPt,Pde)=>{f();"use strict";var{TimeoutController:oHe}=Da(),{anySignal:aHe}=Ho(),{ALPHA:Rde,K:Ade,DEFAULT_QUERY_TIMEOUT:cHe}=xc(),{toString:uHe}=(tt(),sr),{logger:lHe}=Dr(),{queryPath:fHe}=Sde(),dHe=Sl(),{EventEmitter:hHe,setMaxListeners:xde}=Ut(),Ide="running-queries",Tde=class{constructor({peerId:e,lan:t,metrics:i,disjointPaths:n=Ade,alpha:s=Rde}){this._peerId=e,this._disjointPaths=n||Ade,this._controllers=new Set,this._running=!1,this._alpha=s||Rde,this._lan=t,this._metrics=i,this._queries=0}start(){this._running=!0}stop(){this._running=!1;for(let e of this._controllers)e.abort();this._controllers.clear()}async*run(e,t,i,n={}){if(!this._running)throw new Error("QueryManager not started");let s;n.signal||(s=new oHe(cHe),n.signal=s.signal);let o=new AbortController;this._controllers.add(o);let a=[o.signal];n.signal&&a.push(n.signal);let c=aHe(a);try{xde&&xde(0,c)}catch{}let u=lHe(`libp2p:kad-dht:${this._lan?"lan":"wan"}:query:`+uHe(e,"base58btc")),l=t.slice(0,Math.min(this._disjointPaths,t.length)),d=Date.now(),h=new hHe;try{if(u("query:start"),this._queries++,this._metrics&&this._metrics.updateComponentMetric({component:`kad-dht-${this._lan?"lan":"wan"}`,metric:Ide,value:this._queries}),t.length===0){u.error("Running query with no peers");return}let p=l.map((y,g)=>fHe({key:e,startingPeer:y,ourPeerId:this._peerId,signal:c,query:i,pathIndex:g,numPaths:l.length,alpha:this._alpha,cleanUp:h,queryFuncTimeout:n.queryFuncTimeout,log:u}));for await(let y of dHe(...p))yield y,y.name==="QUERY_ERROR"&&y.error&&u("error",y.error)}catch(p){if(!(!this._running&&p.code==="ERR_QUERY_ABORTED"))throw p}finally{this._controllers.delete(o),s&&s.clear(),this._queries--,this._metrics&&this._metrics.updateComponentMetric({component:`kad-dht-${this._lan?"lan":"wan"}`,metric:Ide,value:this._queries}),h.emit("cleanup"),u(`query:done in ${Date.now()-(d||0)}ms`)}}};Pde.exports.QueryManager=Tde});var Nde=m((YPt,Dde)=>{f();"use strict";var{CID:pHe}=(we(),Fc),Ode=Ic(),yHe=Dr(),Cm=yHe.logger("libp2p:kad-dht:rpc:handlers:add-provider"),kde=class{constructor({peerId:e,providers:t,peerStore:i}){this._peerId=e,this._providers=t,this._peerStore=i}async handle(e,t){if(Cm("start"),!t.key||t.key.length===0)throw Ode(new Error("Missing key"),"ERR_MISSING_KEY");let i;try{i=pHe.decode(t.key)}catch(n){let s=`Invalid CID: ${n.message}`;throw Ode(new Error(s),"ERR_INVALID_CID")}(!t.providerPeers||!t.providerPeers.length)&&Cm.error("no providers found in message"),await Promise.all(t.providerPeers.map(async n=>{if(!n.id.equals(e)){Cm("invalid provider peer %p from %p",n.id,e);return}if(n.multiaddrs.length<1){Cm("no valid addresses for provider %p. Ignore",e);return}Cm("received provider %p for %s (addrs %s)",e,i,n.multiaddrs.map(s=>s.toString())),this._peerId.equals(n.id)||(await this._peerStore.addressBook.add(n.id,n.multiaddrs),await this._providers.addProvider(i,n.id))}))}};Dde.exports.AddProviderHandler=kde});var jde=m((XPt,Mde)=>{f();"use strict";var{Message:gHe}=ya(),mHe=Dr(),Bde=mHe.logger("libp2p:kad-dht:rpc:handlers:find-node"),{removePrivateAddresses:bHe,removePublicAddresses:wHe}=Dr(),Lde=class{constructor({peerId:e,addressable:t,peerRouting:i,lan:n}){this._peerId=e,this._addressable=t,this._peerRouting=i,this._lan=Boolean(n)}async handle(e,t){Bde("incoming request from %p for peers closer to %b",e,t.key);let i;this._peerId.equals(t.key)?i=[{id:this._peerId,multiaddrs:this._addressable.multiaddrs}]:i=await this._peerRouting.getCloserPeersOffline(t.key,e),i=i.map(this._lan?wHe:bHe).filter(({multiaddrs:s})=>s.length);let n=new gHe(t.type,new Uint8Array(0),t.clusterLevel);return i.length>0?n.closerPeers=i:Bde("could not find any peers closer to %p",e),n}};Mde.exports.FindNodeHandler=Lde});var Kde=m((QPt,Fde)=>{f();"use strict";var{CID:_He}=(we(),Fc),vHe=Ic(),{Message:EHe}=ya(),SHe=Dr(),qde=SHe.logger("libp2p:kad-dht:rpc:handlers:get-providers"),{removePrivateAddresses:RHe,removePublicAddresses:AHe}=Dr(),Ude=class{constructor({peerId:e,peerRouting:t,providers:i,peerStore:n,addressable:s,lan:o}){this._peerId=e,this._peerRouting=t,this._providers=i,this._peerStore=n,this._addressable=s,this._lan=Boolean(o)}async handle(e,t){let i;try{i=_He.decode(t.key)}catch(u){throw vHe(new Error(`Invalid CID: ${u.message}`),"ERR_INVALID_CID")}qde("%p asking for providers for %s",e,i);let[n,s]=await Promise.all([this._providers.getProviders(i),this._peerRouting.getCloserPeersOffline(t.key,e)]),o=await this._getPeers(n),a=await this._getPeers(s.map(({id:u})=>u)),c=new EHe(t.type,t.key,t.clusterLevel);return o.length>0&&(c.providerPeers=o),a.length>0&&(c.closerPeers=a),qde("got %s providers %s closerPeers",o.length,a.length),c}async _getAddresses(e){return this._peerId.equals(e)?this._addressable.multiaddrs:(await this._peerStore.addressBook.get(e)||[]).map(t=>t.multiaddr)}async _getPeers(e){let t=[],i=this._lan?AHe:RHe;for(let n of e){let s=i({id:n,multiaddrs:await this._getAddresses(n)});s.multiaddrs.length&&t.push(s)}return t}};Fde.exports.GetProvidersHandler=Ude});var Wde=m((ZPt,Gde)=>{f();"use strict";var{Record:Vde}=Qa(),zde=Ic(),{Message:Hde}=ya(),{MAX_RECORD_AGE:xHe}=xc(),N8=Dr(),D1=N8.logger("libp2p:kad-dht:rpc:handlers:get-value"),$de=class{constructor({peerId:e,peerStore:t,peerRouting:i,records:n}){this._peerId=e,this._peerStore=t,this._peerRouting=i,this._records=n}async handle(e,t){let i=t.key;if(D1("%p asked for key %b",e,i),!i||i.length===0)throw zde(new Error("Invalid key"),"ERR_INVALID_KEY");let n=new Hde(Hde.TYPES.GET_VALUE,i,t.clusterLevel);if(N8.isPublicKeyKey(i)){D1("is public key");let a=N8.fromPublicKeyKey(i),c;if(this._peerId.equals(a))c=this._peerId.pubKey;else try{c=await this._peerStore.keyBook.get(a)}catch(u){if(u.code!=="ERR_NOT_FOUND")throw u}if(c!=null)return D1("returning found public key"),n.record=new Vde(i,c.bytes),n}let[s,o]=await Promise.all([this._checkLocalDatastore(i),this._peerRouting.getCloserPeersOffline(t.key,e)]);return s&&(D1("had record for %b in local datastore",i),n.record=s),o.length>0&&(D1("had %s closer peers in routing table",o.length),n.closerPeers=o),n}async _checkLocalDatastore(e){D1("checkLocalDatastore looking for %b",e);let t=N8.bufferToKey(e),i;try{i=await this._records.get(t)}catch(s){if(s.code==="ERR_NOT_FOUND")return;throw s}let n=Vde.deserialize(i);if(!n)throw zde(new Error("Invalid record"),"ERR_INVALID_RECORD");if(n.timeReceived==null||Date.now()-n.timeReceived.getTime()>xHe){await this._records.delete(t);return}return n}};Gde.exports.GetValueHandler=$de});var Qde=m((JPt,Xde)=>{f();"use strict";var IHe=Dr(),THe=IHe.logger("libp2p:kad-dht:rpc:handlers:ping"),Yde=class{async handle(e,t){return THe(`ping from ${e}`),t}};Xde.exports.PingHandler=Yde});var rhe=m((eCt,the)=>{f();"use strict";var Zde=Dr(),PHe=Ic(),CHe=Qa(),Jde=Zde.logger("libp2p:kad-dht:rpc:handlers:put-value"),ehe=class{constructor({validators:e,records:t}){this._validators=e,this._records=t}async handle(e,t){let i=t.key;Jde("%p asked to store value for key %b",e,i);let n=t.record;if(!n){let o=`Empty record from: ${e.toB58String()}`;throw Jde.error(o),PHe(new Error(o),"ERR_EMPTY_RECORD")}await CHe.validator.verifyRecord(this._validators,n),n.timeReceived=new Date;let s=Zde.bufferToKey(n.key);return await this._records.put(s,n.serialize()),t}};the.exports.PutValueHandler=ehe});var nhe=m((tCt,ihe)=>{f();"use strict";var{Message:N1}=ya(),{AddProviderHandler:OHe}=Nde(),{FindNodeHandler:kHe}=jde(),{GetProvidersHandler:DHe}=Kde(),{GetValueHandler:NHe}=Wde(),{PingHandler:BHe}=Qde(),{PutValueHandler:LHe}=rhe();ihe.exports=({peerId:r,providers:e,peerStore:t,addressable:i,peerRouting:n,records:s,validators:o,lan:a})=>{let c={[N1.TYPES.GET_VALUE]:new NHe({peerId:r,peerStore:t,peerRouting:n,records:s}),[N1.TYPES.PUT_VALUE]:new LHe({validators:o,records:s}),[N1.TYPES.FIND_NODE]:new kHe({peerId:r,addressable:i,peerRouting:n,lan:a}),[N1.TYPES.ADD_PROVIDER]:new OHe({peerId:r,providers:e,peerStore:t}),[N1.TYPES.GET_PROVIDERS]:new DHe({peerId:r,peerRouting:n,providers:e,peerStore:t,addressable:i,lan:a}),[N1.TYPES.PING]:new BHe};function u(l){return c[l]}return u}});var che=m((rCt,ahe)=>{f();"use strict";var{pipe:MHe}=dr(),she=go(),{Message:jHe,MESSAGE_TYPE_LOOKUP:qHe}=ya(),UHe=nhe(),FHe=Dr(),B8=FHe.logger("libp2p:kad-dht:rpc"),ohe=class{constructor(e){this._messageHandler=UHe(e),this._routingTable=e.routingTable}async handleMessage(e,t){let i=this._messageHandler(t.type);try{await this._routingTable.add(e)}catch(n){B8.error("Failed to update the kbucket store",n)}if(!i){B8.error(`no handler found for message type: ${t.type}`);return}return i.handle(e,t)}async onIncomingStream({stream:e,connection:t}){let i=t.remotePeer;try{await this._routingTable.add(i)}catch(s){B8.error(s)}let n=this;await MHe(e.source,she.decode(),s=>async function*(){for await(let o of s){let a=jHe.deserialize(o.slice());B8("incoming %s from %p",qHe[a.type],i);let c=await n.handleMessage(i,a);c&&(yield c.serialize())}}(),she.encode(),e.sink)}};ahe.exports.RPC=ohe});var fhe=m((iCt,lhe)=>{f();"use strict";var KHe=U5(),{EventEmitter:VHe}=Ut(),zHe=Dr(),uhe=class extends VHe{constructor({registrar:e,protocol:t,lan:i}){super();this._log=zHe.logger(`libp2p:kad-dht:topology-listener:${i?"lan":"wan"}:network`),this._running=!1,this._registrar=e,this._protocol=t}async start(){if(this._running)return;this._running=!0;let e=new KHe({multicodecs:[this._protocol],handlers:{onConnect:t=>{this._log("observed peer that with protocol %s %p",this._protocol,t),this.emit("peer",t)},onDisconnect:()=>{}}});this._registrarId=await this._registrar.register(e)}stop(){this._running=!1,this._registrarId&&this._registrar.unregister(this._registrarId)}};lhe.exports.TopologyListener=uhe});var bhe=m((nCt,mhe)=>{f();"use strict";var{EventEmitter:HHe}=Ut(),$He=ad(),GHe=pg(),{QUERY_SELF_INTERVAL:dhe,QUERY_SELF_TIMEOUT:hhe,K:phe}=xc(),WHe=Dr(),{TimeoutController:YHe}=Da(),{anySignal:XHe}=Ho(),{setMaxListeners:yhe}=Ut(),ghe=class extends HHe{constructor({peerId:e,peerRouting:t,lan:i,count:n=phe,interval:s=dhe,queryTimeout:o=hhe}){super();this._log=WHe.logger(`libp2p:kad-dht:${i?"lan":"wan"}:query-self`),this._running=!1,this._peerId=e,this._peerRouting=t,this._count=n||phe,this._interval=s||dhe,this._queryTimeout=o||hhe}start(){this._running||(this._running=!0,this._querySelf())}stop(){this._running=!1,this._timeoutId&&clearTimeout(this._timeoutId),this._controller&&this._controller.abort()}async _querySelf(){let e=new YHe(this._queryTimeout);try{this._controller=new AbortController;let t=XHe([this._controller.signal,e.signal]);try{yhe&&yhe(1/0,t)}catch{}let i=await GHe(await $He(this._peerRouting.getClosestPeers(this._peerId.toBytes(),{signal:t}),this._count));this._log("query ran successfully - found %d peers",i)}catch(t){this._log("query error",t)}finally{this._timeoutId=setTimeout(this._querySelf.bind(this),this._interval),e.clear()}}};mhe.exports.QuerySelf=ghe});var xhe=m((sCt,Ahe)=>{f();"use strict";var{EventEmitter:QHe}=Ut(),whe=Ya(),_he=Qa(),{MemoryDatastore:ZHe}=(p6(),E9),{RoutingTable:JHe}=pfe(),{RoutingTableRefresh:e$e}=bfe(),vhe=Dr(),{K:t$e,QUERY_SELF_INTERVAL:r$e,RECORD_KEY_PREFIX:i$e}=xc(),{Network:n$e}=Nfe(),{ContentFetching:s$e}=qfe(),{ContentRouting:o$e}=Vfe(),{PeerRouting:a$e}=lde(),{Providers:c$e}=mde(),{QueryManager:u$e}=Cde(),{RPC:l$e}=che(),{TopologyListener:f$e}=fhe(),{QuerySelf:d$e}=bhe(),{removePrivateAddresses:h$e,removePublicAddresses:p$e}=Dr(),{KeyTransformDatastore:y$e}=(b6(),iK),{Key:Ehe}=(Mr(),mp),She=class{constructor(e){this._prefix=e,this._prefix.startsWith("/")&&(this._prefix=this._prefix.substring(1))}convert(e){return new Ehe(`/${this._prefix}${e}`)}invert(e){let t=e.namespaces();return t[0]===this._prefix&&t.shift(),Ehe.withNamespaces(t)}},Rhe=class extends QHe{constructor({libp2p:e,kBucketSize:t=t$e,clientMode:i=!0,validators:n={},selectors:s={},querySelfInterval:o=r$e,lan:a=!0,protocol:c="/ipfs/lan/kad/1.0.0",bootstrapPeers:u=[]}){super();this._running=!1,this._log=vhe.logger(`libp2p:kad-dht:${a?"lan":"wan"}`),this._libp2p=e,this._protocol=c,this._kBucketSize=t,this._clientMode=i,this._bootstrapPeers=u,this._routingTable=new JHe({peerId:e.peerId,dialer:e,kBucketSize:t,metrics:e.metrics,lan:a});let l=e.datastore||new ZHe,d=new y$e(l,new She(i$e));this._providers=new c$e({providers:l}),this._lan=a,this._validators={pk:_he.validator.validators.pk,...n},this._selectors={pk:_he.selection.selectors.pk,...s},this._network=new n$e({dialer:e,protocol:this._protocol,lan:a}),this._queryManager=new u$e({peerId:e.peerId,disjointPaths:Math.ceil(t/2),metrics:e.metrics,lan:a}),this._peerRouting=new a$e({peerId:e.peerId,routingTable:this._routingTable,peerStore:e.peerStore,network:this._network,validators:this._validators,queryManager:this._queryManager,lan:a}),this._contentFetching=new s$e({peerId:e.peerId,records:d,validators:this._validators,selectors:this._selectors,peerRouting:this._peerRouting,queryManager:this._queryManager,routingTable:this._routingTable,network:this._network,lan:a}),this._contentRouting=new o$e({peerId:e.peerId,network:this._network,peerRouting:this._peerRouting,queryManager:this._queryManager,routingTable:this._routingTable,providers:this._providers,peerStore:e.peerStore,lan:a}),this._routingTableRefresh=new e$e({peerRouting:this._peerRouting,routingTable:this._routingTable,lan:a}),this._rpc=new l$e({routingTable:this._routingTable,peerId:e.peerId,providers:this._providers,peerStore:e.peerStore,addressable:e,peerRouting:this._peerRouting,records:d,validators:this._validators,lan:a}),this._topologyListener=new f$e({registrar:e.registrar,protocol:this._protocol,lan:a}),this._querySelf=new d$e({peerId:e.peerId,peerRouting:this._peerRouting,interval:o,lan:a}),this._network.on("peer",h=>{this.onPeerConnect(h).catch(p=>{this._log.error(`could not add ${h.id} to routing table`,p)}),this.emit("peer",h)}),this._topologyListener.on("peer",async h=>{let p=await this._libp2p.peerStore.addressBook.get(h),y={id:h,multiaddrs:p.map(g=>g.multiaddr)};this.onPeerConnect(y).catch(g=>{this._log.error(`could not add ${y.id} to routing table`,g)})})}async onPeerConnect(e){if(this._log("peer %p connected",e.id),this._lan?e=p$e(e):e=h$e(e),!e.multiaddrs.length){this._log("ignoring %p as they do not have any %s addresses in %s",e.id,this._lan?"private":"public",e.multiaddrs.map(t=>t.toString()));return}try{await this._routingTable.add(e.id)}catch(t){this._log.error("could not add %p to routing table",e.id,t)}}isStarted(){return this._running}isServer(){return!this._clientMode}async enableServerMode(){this._log("enabling server mode"),this._clientMode=!1,await this._libp2p.handle(this._protocol,this._rpc.onIncomingStream.bind(this._rpc))}async enableClientMode(){this._log("enabling client mode"),this._clientMode=!0,await this._libp2p.unhandle(this._protocol)}async start(){this._running=!0,this._clientMode?await this.enableClientMode():await this.enableServerMode(),await Promise.all([this._providers.start(),this._queryManager.start(),this._network.start(),this._routingTable.start(),this._topologyListener.start(),this._querySelf.start()]),await Promise.all(this._bootstrapPeers.map(e=>this._routingTable.add(e.id))),await this._routingTableRefresh.start(),await this.refreshRoutingTable()}async stop(){this._running=!1,await Promise.all([this._providers.stop(),this._queryManager.stop(),this._network.stop(),this._routingTable.stop(),this._routingTableRefresh.stop(),this._topologyListener.stop(),this._querySelf.stop()])}async*put(e,t,i={}){yield*this._contentFetching.put(e,t,i)}async*get(e,t={}){yield*this._contentFetching.get(e,t)}async*provide(e,t={}){yield*this._contentRouting.provide(e,this._libp2p.multiaddrs,t)}async*findProviders(e,t={maxNumProviders:5}){yield*this._contentRouting.findProviders(e,t)}async*findPeer(e,t={}){yield*this._peerRouting.findPeer(e,t)}async*getClosestPeers(e,t={}){yield*this._peerRouting.getClosestPeers(e,t)}async getPublicKey(e,t={}){this._log("getPublicKey %p",e);for await(let n of this._peerRouting.getPublicKeyFromNode(e,t))if(n.name==="VALUE")return whe.keys.unmarshalPublicKey(n.value);let i=vhe.keyForPublicKey(e);for await(let n of this.get(i,t))if(n.name==="VALUE")return whe.keys.unmarshalPublicKey(n.value)}async refreshRoutingTable(){await this._routingTableRefresh.refreshTable(!0)}};Ahe.exports={KadDHT:Rhe}});var Phe=m((oCt,The)=>{f();"use strict";var{EventEmitter:g$e}=Ut(),m$e=ot(),b$e=Dr(),_f=Ic(),B1=Sl(),{queryErrorEvent:w$e}=dh(),Om=b$e.logger("libp2p:kad-dht"),Ihe=class extends g$e{constructor(e,t,i){super();this._wan=e,this._lan=t,this._libp2p=i,this._wan.on("peer",n=>{this.emit("peer",n)}),this._lan.on("peer",n=>{this.emit("peer",n)})}isStarted(){return this._wan.isStarted()&&this._lan.isStarted()}async enableServerMode(){await this._wan.enableServerMode()}async enableClientMode(){await this._wan.enableClientMode()}async start(){await Promise.all([this._lan.start(),this._wan.start()])}async stop(){await Promise.all([this._lan.stop(),this._wan.stop()])}async*put(e,t,i={}){let n=0,s=0;for await(let a of B1(this._lan.put(e,t,i),this._wan.put(e,t,i)))yield a,a.name==="SENDING_QUERY"&&a.messageName==="PUT_VALUE"&&n++,a.name==="PEER_RESPONSE"&&a.messageName==="PUT_VALUE"&&s++;let o=i.minPeers==null?n||1:i.minPeers;if(s<o){let a=_f(new Error(`Failed to put value to enough peers: ${s}/${o}`),"ERR_NOT_ENOUGH_PUT_PEERS");throw Om.error(a),a}}async*get(e,t={}){let i=!1,n=!1;for await(let s of B1(this._lan.get(e,t),this._wan.get(e,t)))yield s,s.name==="DIALING_PEER"&&(i=!0),s.name==="VALUE"&&(i=!0,s.value!=null&&(n=!0)),s.name==="SENDING_QUERY"&&(i=!0);if(!i)throw _f(new Error("No peers found in routing table!"),"ERR_NO_PEERS_IN_ROUTING_TABLE");n||(yield w$e({from:this._libp2p.peerId,error:_f(new Error("Not found"),"ERR_NOT_FOUND")}))}async*provide(e,t={}){let i=0,n=0,s=[],o=[this._lan];this._wan.isServer()&&o.push(this._wan);for await(let a of B1(...o.map(c=>c.provide(e,t))))yield a,a.name==="SENDING_QUERY"&&i++,a.name==="QUERY_ERROR"&&s.push(a.error),a.name==="PEER_RESPONSE"&&a.messageName==="ADD_PROVIDER"&&(Om("sent provider record for %s to %p",e,a.from.id),n++);if(n===0)throw s.length?_f(new Error(`Failed to provide to ${s.length} of ${i} peers`),"ERR_PROVIDES_FAILED",{errors:s}):_f(new Error("Failed to provide - no peers found"),"ERR_PROVIDES_FAILED")}async*findProviders(e,t={maxNumProviders:5}){yield*B1(this._lan.findProviders(e,t),this._wan.findProviders(e,t))}async*findPeer(e,t={}){let i=!1;for await(let n of B1(this._lan.findPeer(e,t),this._wan.findPeer(e,t)))yield n,(n.name==="SENDING_QUERY"||n.name==="FINAL_PEER")&&(i=!0);if(!i)throw _f(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED")}async*getClosestPeers(e,t={}){yield*B1(this._lan.getClosestPeers(e,t),this._wan.getClosestPeers(e,t))}async getPublicKey(e,t={}){Om("getPublicKey %p",e);let i;try{if(i=await this._libp2p.peerStore.get(e),i.pubKey)return Om("getPublicKey: found local copy"),i.pubKey;if(i.id.pubKey)return Om("getPublicKey: found local copy"),i.id.pubKey}catch(c){if(c.code!=="ERR_NOT_FOUND")throw c}let n=await Promise.all([this._lan.getPublicKey(e,t),this._wan.getPublicKey(e,t)]);if(n[0]&&n[1]&&!n[0].equals(n[1]))throw _f(new Error("Inconsistent public key loaded from wan and lan DHTs"),"ERR_FAILED_TO_LOAD_KEY");let s=n[0]||n[1];if(!s)throw _f(new Error("Failed to load public key"),"ERR_FAILED_TO_LOAD_KEY");let o=new m$e(e.id,void 0,s),a=(i&&i.addresses||[]).map(c=>c.multiaddr);return await this._libp2p.peerStore.addressBook.add(o,a),await this._libp2p.peerStore.keyBook.set(o,s),s}async refreshRoutingTable(){await Promise.all([this._lan.refreshRoutingTable(),this._wan.refreshRoutingTable()])}};The.exports={DualKadDHT:Ihe}});var khe=m((aCt,Ohe)=>{f();"use strict";var{KadDHT:Che}=xhe(),{DualKadDHT:_$e}=Phe();Ohe.exports={create:r=>new _$e(new Che({...r,protocol:"/ipfs/kad/1.0.0",lan:!1}),new Che({...r,protocol:"/ipfs/lan/kad/1.0.0",clientMode:!1,lan:!0}),r.libp2p)}});var Hhe=m((aP,zhe)=>{f();"use strict";var v$e=ot(),{Multiaddr:E$e}=ft(),S$e=Ff(),{EventEmitter:R$e}=Ut(),Khe=le(),L8=Object.assign(Khe("libp2p:bootstrap"),{error:Khe("libp2p:bootstrap:error")}),Vhe=class extends R$e{constructor(e={list:[]}){if(!e.list||!e.list.length)throw new Error("Bootstrap requires a list of peer addresses");super();this._list=e.list,this._interval=e.interval||1e4,this._timer=null}start(){this._timer||(this._timer=setInterval(()=>this._discoverBootstrapPeers(),this._interval),L8("Starting bootstrap node discovery"),this._discoverBootstrapPeers())}_discoverBootstrapPeers(){!this._timer||this._list.forEach(e=>{if(!S$e.P2P.matches(e))return L8.error("Invalid multiaddr");let t=new E$e(e),i=t.getPeerId();if(!i){L8.error("Invalid bootstrap multiaddr without peer id");return}let n=v$e.createFromB58String(i);try{this.emit("peer",{id:n,multiaddrs:[t]})}catch(s){L8.error("Invalid bootstrap peer id",s)}})}stop(){this._timer&&clearInterval(this._timer),this._timer=null}};aP=zhe.exports=Vhe;aP.tag="bootstrap"});var cP=m((dCt,$he)=>{f();"use strict";var A$e=br(),x$e=rs(),I$e=bn(),T$e=ad();async function*P$e(r,e){yield*I$e(r,async t=>(await e.addressBook.add(t.id,t.multiaddrs),t))}function C$e(r){let e=new Set;return x$e(r,t=>e.has(t.id.toString())?!1:(e.add(t.id.toString()),!0))}async function*O$e(r,e=1){let t=0;for await(let i of r)t++,yield i;if(t<e)throw A$e(new Error("not found"),"NOT_FOUND")}function k$e(r,e){return e?T$e(r,e):r}$he.exports={storeAddresses:P$e,uniquePeers:C$e,requirePeers:O$e,maybeLimitSource:k$e}});var uP=m((hCt,Ghe)=>{f();"use strict";var L1=new Map,D$e=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function N$e(r,e,t){for(;L1.get(t);){try{await r()}catch(i){setTimeout(()=>{throw i},1);break}if(!L1.get(t))break;await new Promise(i=>{let n=setTimeout(i,e);L1.set(t,n)})}}function B$e(r,e,t){t=t||e;let i=D$e(),n=setTimeout(()=>{N$e(r,e,i)},t);return L1.set(i,n),i}function L$e(r){let e=L1.get(r);e&&(clearTimeout(e),L1.delete(r))}Ghe.exports={setDelayedInterval:B$e,clearDelayedInterval:L$e}});var Xhe=m((pCt,Yhe)=>{f();"use strict";var M$e=br(),{messages:j$e,codes:q$e}=wr(),Whe=class{constructor(e){this._dht=e}async findPeer(e,t={}){for await(let i of this._dht.findPeer(e,t))if(i.name==="FINAL_PEER")return i.peer;throw M$e(new Error(j$e.NOT_FOUND),q$e.ERR_NOT_FOUND)}async*getClosestPeers(e,t={}){for await(let i of this._dht.getClosestPeers(e,t))i.name==="PEER_RESPONSE"&&(yield*i.closer)}};Yhe.exports={DHTPeerRouting:Whe}});var spe=m((yCt,npe)=>{f();"use strict";var Qhe=le(),Zhe=Object.assign(Qhe("libp2p:peer-routing"),{error:Qhe("libp2p:peer-routing:err")}),M8=br(),km=wr(),{storeAddresses:Jhe,uniquePeers:U$e,requirePeers:F$e}=cP(),{TimeoutController:K$e}=Da(),epe=Sl(),{pipe:tpe}=dr(),V$e=Rd(),z$e=ts(),H$e=rs(),{setDelayedInterval:$$e,clearDelayedInterval:G$e}=uP(),{DHTPeerRouting:W$e}=Xhe(),{setMaxListeners:rpe}=Ut(),ipe=class{constructor(e){this._peerId=e.peerId,this._peerStore=e.peerStore,this._routers=e._modules.peerRouting||[],e._dht&&e._config.dht.enabled&&this._routers.push(new W$e(e._dht)),this._refreshManagerOptions=e._options.peerRouting.refreshManager,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}start(){!this._routers.length||this._timeoutId||!this._refreshManagerOptions.enabled||(this._timeoutId=$$e(this._findClosestPeersTask,this._refreshManagerOptions.interval,this._refreshManagerOptions.bootDelay))}async _findClosestPeersTask(){try{await z$e(this.getClosestPeers(this._peerId.id,{timeout:this._refreshManagerOptions.timeout||1e4}))}catch(e){Zhe.error(e)}}stop(){G$e(this._timeoutId)}async findPeer(e,t){if(!this._routers.length)throw M8(new Error("No peer routers available"),km.codes.ERR_NO_ROUTERS_AVAILABLE);if(e.toB58String()===this._peerId.toB58String())throw M8(new Error("Should not try to find self"),km.codes.ERR_FIND_SELF);let i=await tpe(epe(...this._routers.map(n=>async function*(){try{yield await n.findPeer(e,t)}catch(s){Zhe.error(s)}}())),n=>H$e(n,Boolean),n=>Jhe(n,this._peerStore),n=>V$e(n));if(i)return i;throw M8(new Error(km.messages.NOT_FOUND),km.codes.ERR_NOT_FOUND)}async*getClosestPeers(e,t={timeout:3e4}){if(!this._routers.length)throw M8(new Error("No peer routers available"),km.codes.ERR_NO_ROUTERS_AVAILABLE);if(t.timeout){let i=new K$e(t.timeout);try{rpe&&rpe(1/0,i.signal)}catch{}t.signal=i.signal}yield*tpe(epe(...this._routers.map(i=>i.getClosestPeers(e,t))),i=>Jhe(i,this._peerStore),i=>U$e(i),i=>F$e(i))}};npe.exports=ipe});var cpe=m((gCt,ape)=>{f();"use strict";var Y$e=ts(),ope=class{constructor(e){this._dht=e}async provide(e){await Y$e(this._dht.provide(e))}async*findProviders(e,t){for await(let i of this._dht.findProviders(e,t))i.name==="PROVIDER"&&(yield*i.providers)}};ape.exports={DHTContentRouting:ope}});var fpe=m((mCt,lpe)=>{f();"use strict";var hh=br(),{messages:Dm,codes:ph}=wr(),{storeAddresses:X$e,uniquePeers:Q$e,requirePeers:Z$e,maybeLimitSource:J$e}=cP(),eGe=ts(),tGe=Sl(),{pipe:rGe}=dr(),{DHTContentRouting:iGe}=cpe(),upe=class{constructor(e){this.libp2p=e,this.routers=e._modules.contentRouting||[],this.dht=e._dht,this.dht&&e._config.dht.enabled&&this.routers.push(new iGe(this.dht))}async*findProviders(e,t={}){if(!this.routers.length)throw hh(new Error("No content this.routers available"),ph.ERR_NO_ROUTERS_AVAILABLE);yield*rGe(tGe(...this.routers.map(i=>i.findProviders(e,t))),i=>X$e(i,this.libp2p.peerStore),i=>Q$e(i),i=>J$e(i,t.maxNumProviders),i=>Z$e(i))}async provide(e){if(!this.routers.length)throw hh(new Error("No content routers available"),ph.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map(t=>t.provide(e)))}async put(e,t,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw hh(new Error(Dm.NOT_STARTED_YET),ph.DHT_NOT_STARTED);await eGe(this.dht.put(e,t,i))}async get(e,t){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw hh(new Error(Dm.NOT_STARTED_YET),ph.DHT_NOT_STARTED);for await(let i of this.dht.get(e,t))if(i.name==="VALUE")return{from:i.peerId,val:i.value};throw hh(new Error(Dm.NOT_FOUND),ph.ERR_NOT_FOUND)}async*getMany(e,t,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw hh(new Error(Dm.NOT_STARTED_YET),ph.DHT_NOT_STARTED);if(!t)return;let n=0;for await(let s of this.dht.get(e,i))if(s.name==="VALUE"&&(yield{from:s.peerId,val:s.value},n++,n===t))break;if(n===0)throw hh(new Error(Dm.NOT_FOUND),ph.ERR_NOT_FOUND)}};lpe.exports=upe});var lP=m((bCt,ype)=>{f();"use strict";var nGe=ot(),{Multiaddr:dpe}=ft(),hpe=br(),{codes:ppe}=wr();function sGe(r){typeof r=="string"&&(r=new dpe(r));let e;if(dpe.isMultiaddr(r)){e=r;let t=r.getPeerId();if(!t)throw hpe(new Error(`${r} does not have a valid peer type`),ppe.ERR_INVALID_MULTIADDR);try{r=nGe.createFromB58String(t)}catch(i){throw hpe(new Error(`${r} is not a valid peer type`),ppe.ERR_INVALID_MULTIADDR)}}return{id:r,multiaddrs:e?[e]:void 0}}ype.exports=sGe});var bpe=m((wCt,mpe)=>{f();"use strict";mpe.exports=gpe;var oGe=z_(),vf=gpe.prototype,aGe=new Date%1e9;function cGe(){return(Math.random()*1e9>>>0)+aGe++}function gpe(r){r=r||{},this.id=r.id||cGe(),this.max=r.max||1/0,this.items=r.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(r.lastModified||new Date);for(var e,t,i=this.items.length;i--;)e=this.items[i],t=new Date(e.expires)-new Date,this._lookup[e.key]=e,t>0?this.expire(e.key,t):t<=0&&this.delete(e.key)}vf.has=function(r){return r in this._lookup};vf.get=function(r){if(!this.has(r))return null;var e=this._lookup[r];return e.refresh&&this.expire(r,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value};vf.meta=function(r){if(!this.has(r))return null;var e=this._lookup[r];return"meta"in e?e.meta:null};vf.set=function(r,e,t){var i=this._lookup[r],n=this._lookup[r]={key:r,value:e};return this.lastModified=new Date,i?(clearTimeout(i.timeout),this.items.splice(this.items.indexOf(i),1,n)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(n),this.size++),t&&("ttl"in t&&this.expire(r,t.ttl),"meta"in t&&(n.meta=t.meta),t.refresh&&(n.refresh=t.ttl)),this};vf.delete=function(r){var e=this._lookup[r];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[r],this.size--,this):!1};vf.expire=function(r,e){var t=e||0,i=this._lookup[r];if(!i)return this;if(typeof t=="string"&&(t=oGe(e)),typeof t!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(i.timeout),i.timeout=setTimeout(this.delete.bind(this,i.key),t),i.expires=Number(new Date)+t,this};vf.clear=function(){for(var r=this.items.length;r--;)this.delete(this.items[r].key);return this};vf.toJSON=function(){for(var r=new Array(this.items.length),e,t=r.length;t--;)e=this.items[t],r[t]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:r}}});var _pe=m((_Ct,wpe)=>{f();"use strict";var{default:uGe,Headers:lGe}=j7();function fGe({serverResolver:r,hostname:e,recordType:t}){return`${r}?name=${e}&type=${t}`}function dGe(r){return uGe(r,{headers:new lGe({accept:"application/dns-json"})})}function hGe(r,e){return`${e}_${r}`}wpe.exports={buildResource:fGe,fetch:dGe,getCacheKey:hGe}});var Spe=m((vCt,Epe)=>{f();"use strict";var vpe=le(),j8=vpe("dns-over-http-resolver");j8.error=vpe("dns-over-http-resolver:error");var pGe=bpe(),Io=_pe(),q8=class{constructor({maxCache:e=100}={}){this._cache=new pGe({max:e}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"]}getServers(){return this._servers}_getShuffledServers(){let e=[].concat(this._servers);for(let t=e.length-1;t>0;t--){let i=Math.floor(Math.random()*t),n=e[t];e[t]=e[i],e[i]=n}return e}setServers(e){this._servers=e}resolve(e,t="A"){switch(t){case"A":return this.resolve4(e);case"AAAA":return this.resolve6(e);case"TXT":return this.resolveTxt(e);default:throw new Error(`${t} is not supported`)}}async resolve4(e){let t="A",i=this._cache.get(Io.getCacheKey(e,t));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await Io.fetch(Io.buildResource({serverResolver:n,hostname:e,recordType:t}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(Io.getCacheKey(e,t),a,{ttl:c}),a}catch(s){j8.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}async resolve6(e){let t="AAAA",i=this._cache.get(Io.getCacheKey(e,t));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await Io.fetch(Io.buildResource({serverResolver:n,hostname:e,recordType:t}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(Io.getCacheKey(e,t),a,{ttl:c}),a}catch(s){j8.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}async resolveTxt(e){let t="TXT",i=this._cache.get(Io.getCacheKey(e,t));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await Io.fetch(Io.buildResource({serverResolver:n,hostname:e,recordType:t}))).json(),a=o.Answer.map(u=>[u.data.replace(/['"]+/g,"")]),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(Io.getCacheKey(e,t),a,{ttl:c}),a}catch(s){j8.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}};q8.Resolver=q8;Epe.exports=q8});var Ape=m((ECt,Rpe)=>{f();"use strict";var yGe=Spe();Rpe.exports=yGe});var Ipe=m((SCt,xpe)=>{f();"use strict";var gGe=Py(),{code:mGe}=gGe("dnsaddr");async function bGe(r){let e=Ape(),t=new e,i=r.getPeerId(),[,n]=r.stringTuples().find(([a])=>a===mGe)||[],o=(await t.resolveTxt(`_dnsaddr.${n}`)).flat().map(a=>a.split("=")[1]);return i&&(o=o.filter(a=>a.includes(i))),o}xpe.exports={dnsaddrResolver:bGe}});var U8=m((RCt,Tpe)=>{f();"use strict";Tpe.exports={DIAL_TIMEOUT:3e4,MAX_PARALLEL_DIALS:100,MAX_PER_PEER_DIALS:4,MAX_ADDRS_TO_DIAL:25,METRICS:{computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50}}});var fP=m((ACt,wGe)=>{wGe.exports={name:"libp2p",version:"0.36.2",description:"JavaScript implementation of libp2p, a modular peer to peer network stack",leadMaintainer:"Jacob Heun <jacobheun@gmail.com>",main:"src/index.js",types:"dist/src/index.d.ts",typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"]}},files:["dist","src"],scripts:{lint:"aegir lint",build:"aegir build","build:proto":"npm run build:proto:circuit && npm run build:proto:fetch && npm run build:proto:identify && npm run build:proto:plaintext && npm run build:proto:address-book && npm run build:proto:proto-book && npm run build:proto:peer && npm run build:proto:peer-record && npm run build:proto:envelope","build:proto:circuit":"pbjs -t static-module -w commonjs -r libp2p-circuit --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/circuit/protocol/index.js ./src/circuit/protocol/index.proto","build:proto:fetch":"pbjs -t static-module -w commonjs -r libp2p-fetch --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/fetch/proto.js ./src/fetch/proto.proto","build:proto:identify":"pbjs -t static-module -w commonjs -r libp2p-identify --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/identify/message.js ./src/identify/message.proto","build:proto:plaintext":"pbjs -t static-module -w commonjs -r libp2p-plaintext --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/insecure/proto.js ./src/insecure/proto.proto","build:proto:peer":"pbjs -t static-module -w commonjs -r libp2p-peer --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/pb/peer.js ./src/peer-store/pb/peer.proto","build:proto:peer-record":"pbjs -t static-module -w commonjs -r libp2p-peer-record --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/peer-record/peer-record.js ./src/record/peer-record/peer-record.proto","build:proto:envelope":"pbjs -t static-module -w commonjs -r libp2p-envelope --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/envelope/envelope.js ./src/record/envelope/envelope.proto","build:proto-types":"npm run build:proto-types:circuit && npm run build:proto-types:fetch && npm run build:proto-types:identify && npm run build:proto-types:plaintext && npm run build:proto-types:address-book && npm run build:proto-types:proto-book && npm run build:proto-types:peer && npm run build:proto-types:peer-record && npm run build:proto-types:envelope","build:proto-types:circuit":"pbts -o src/circuit/protocol/index.d.ts src/circuit/protocol/index.js","build:proto-types:fetch":"pbts -o src/fetch/proto.d.ts src/fetch/proto.js","build:proto-types:identify":"pbts -o src/identify/message.d.ts src/identify/message.js","build:proto-types:plaintext":"pbts -o src/insecure/proto.d.ts src/insecure/proto.js","build:proto-types:peer":"pbts -o src/peer-store/pb/peer.d.ts src/peer-store/pb/peer.js","build:proto-types:peer-record":"pbts -o src/record/peer-record/peer-record.d.ts src/record/peer-record/peer-record.js","build:proto-types:envelope":"pbts -o src/record/envelope/envelope.d.ts src/record/envelope/envelope.js",test:"aegir test","test:ts":"aegir build --no-bundle && npm run test --prefix test/ts-use","test:node":'aegir test -t node -f "./test/**/*.{node,spec}.js"',"test:browser":"aegir test -t browser","test:examples":"cd examples && npm run test:all","test:interop":"LIBP2P_JS=$PWD npx aegir test -t node -f ./node_modules/libp2p-interop/test/*",prepare:"npm run build",coverage:"nyc --reporter=text --reporter=lcov npm run test:node"},repository:{type:"git",url:"https://github.com/libp2p/js-libp2p.git"},keywords:["libp2p","network","p2p","peer","peer-to-peer","IPFS"],bugs:{url:"https://github.com/libp2p/js-libp2p/issues"},homepage:"https://libp2p.io",license:"MIT",engines:{node:">=15.0.0"},browser:{"nat-api":!1},eslintConfig:{extends:"ipfs",ignorePatterns:["!.aegir.js","test/ts-use","*.d.ts"]},dependencies:{"@vascosantos/moving-average":"^1.1.0","abortable-iterator":"^3.0.0","aggregate-error":"^3.1.0","any-signal":"^3.0.0","bignumber.js":"^9.0.1","class-is":"^1.1.0","datastore-core":"^7.0.0",debug:"^4.3.1","err-code":"^3.0.0","es6-promisify":"^7.0.0",events:"^3.3.0",hashlru:"^2.3.0","interface-datastore":"^6.0.2","it-all":"^1.0.4","it-buffer":"^0.1.2","it-drain":"^1.0.3","it-filter":"^1.0.1","it-first":"^1.0.4","it-foreach":"^0.1.1","it-handshake":"^2.0.0","it-length-prefixed":"^5.0.2","it-map":"^1.0.4","it-merge":"^1.0.0","it-pipe":"^1.1.0","it-sort":"^1.0.1","it-take":"^1.0.0","libp2p-crypto":"^0.21.2","libp2p-interfaces":"^4.0.0","libp2p-utils":"^0.4.0",mafmt:"^10.0.0","merge-options":"^3.0.4",mortice:"^2.0.1",multiaddr:"^10.0.0",multiformats:"^9.0.0","multistream-select":"^3.0.0","mutable-proxy":"^1.0.0","nat-api":"^0.3.1","node-forge":"^1.2.1","p-any":"^3.0.0","p-fifo":"^1.0.0","p-retry":"^4.4.0","p-settle":"^4.1.1","peer-id":"^0.16.0","private-ip":"^2.1.0",protobufjs:"^6.10.2",retimer:"^3.0.0","sanitize-filename":"^1.6.3","set-delayed-interval":"^1.0.0","streaming-iterables":"^6.0.0","timeout-abort-controller":"^3.0.0",uint8arrays:"^3.0.0",varint:"^6.0.0",wherearewe:"^1.0.0",xsalsa20:"^1.1.0"},devDependencies:{"@chainsafe/libp2p-noise":"^5.0.0","@nodeutils/defaults-deep":"^1.1.0","@types/es6-promisify":"^6.0.0","@types/node":"^16.0.1","@types/node-forge":"^1.0.0","@types/varint":"^6.0.0",aegir:"^36.0.0",buffer:"^6.0.3",delay:"^5.0.0","into-stream":"^6.0.0","ipfs-http-client":"^54.0.2","it-concat":"^2.0.0","it-pair":"^1.0.0","it-pushable":"^1.4.0",libp2p:".","libp2p-bootstrap":"^0.14.0","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.11.1","libp2p-interfaces-compliance-tests":"^4.0.8","libp2p-interop":"^0.7.1","libp2p-kad-dht":"^0.28.6","libp2p-mdns":"^0.18.0","libp2p-mplex":"^0.10.4","libp2p-tcp":"^0.17.0","libp2p-webrtc-star":"^0.25.0","libp2p-websockets":"^0.16.0",nock:"^13.0.3","p-defer":"^3.0.0","p-times":"^3.0.0","p-wait-for":"^3.2.0",rimraf:"^3.0.2",sinon:"^12.0.1",util:"^0.12.3"},contributors:["Vasco Santos <vasco.santos@moxy.studio>","David Dias <daviddias.p@gmail.com>","Jacob Heun <jacobheun@gmail.com>","Alex Potsides <alex@achingbrain.net>","Alan Shaw <alan@tableflip.io>","Cayman <caymannava@gmail.com>","Pedro Teixeira <i@pgte.me>","Friedel Ziegelmayer <dignifiedquire@gmail.com>","Maciej Kr\xFCger <mkg20001@gmail.com>","Hugo Dias <mail@hugodias.me>","dirkmc <dirkmdev@gmail.com>","Volker Mische <volker.mische@gmail.com>","Chris Dostert <chrisdostert@users.noreply.github.com>","zeim839 <50573884+zeim839@users.noreply.github.com>","Robert Kiel <robert.kiel@hoprnet.org>","Richard Littauer <richard.littauer@gmail.com>","a1300 <matthias-knopp@gmx.net>","Ryan Bell <ryan@piing.net>","\u1D20\u026A\u1D04\u1D1B\u1D0F\u0280 \u0299\u1D0A\u1D07\u029F\u1D0B\u029C\u1D0F\u029F\u1D0D <victorbjelkholm@gmail.com>","Andrew Nesbitt <andrewnez@gmail.com>","Franck Royer <franck@royer.one>","Thomas Eizinger <thomas@eizinger.io>","V\xEDt Habada <vithabada93@gmail.com>","Giovanni T. Parra <fiatjaf@gmail.com>","acolytec3 <17355484+acolytec3@users.noreply.github.com>","Alan Smithee <ggnore.alan.smithee@gmail.com>","Elven <mon.samuel@qq.com>","Samlior <samlior@foxmail.com>","Didrik Nordstr\xF6m <didrik.nordstrom@gmail.com>","Aditya Bose <13054902+adbose@users.noreply.github.com>","TJKoury <TJKoury@gmail.com>","TheStarBoys <41286328+TheStarBoys@users.noreply.github.com>","Tiago Alves <alvesjtiago@gmail.com>","Tim Daubensch\xFCtz <tim@daubenschuetz.de>","XiaoZhang <zxinmyth@gmail.com>","Yusef Napora <yusef@napora.org>","Zane Starr <zcstarr@gmail.com>","ebinks <elizabethjbinks@gmail.com>","greenSnot <greenSnot@users.noreply.github.com>","isan_rivkin <isanrivkin@gmail.com>","mayerwin <mayerwin@users.noreply.github.com>","mcclure <andi.m.mcclure@gmail.com>","patrickwoodhead <91056047+patrickwoodhead@users.noreply.github.com>","phillmac <phillmac@users.noreply.github.com>","robertkiel <robert.kiel@validitylabs.org>","shresthagrawal <34920931+shresthagrawal@users.noreply.github.com>","swedneck <40505480+swedneck@users.noreply.github.com>","tuyennhv <vutuyen2636@gmail.com>","S\xF6nke Hahn <soenkehahn@gmail.com>","Aleksei <vozhdb@gmail.com>","Bernd Strehl <bernd.strehl@gmail.com>","Chris Bratlien <chrisbratlien@gmail.com>","Cindy Wu <ciindy.wu@gmail.com>","Daijiro Wachi <daijiro.wachi@gmail.com>","Diogo Silva <fsdiogo@gmail.com>","Dmitriy Ryajov <dryajov@gmail.com>","Ethan Lam <elmemphis2000@gmail.com>","Fei Liu <liu.feiwood@gmail.com>","Felipe Martins <felipebrasil93@gmail.com>","Florian-Merle <florian.david.merle@gmail.com>","Francis Gulotta <wizard@roborooter.com>","Guy Sviry <32539816+guysv@users.noreply.github.com>","Henrique Dias <hacdias@gmail.com>","Irakli Gozalishvili <rfobic@gmail.com>","Joel Gustafson <joelg@mit.edu>","John Rees <johnrees@users.noreply.github.com>","Jo\xE3o Santos <joaosantos15@users.noreply.github.com>","Julien Bouquillon <contact@revolunet.com>","Kevin Kwok <antimatter15@gmail.com>","Kevin Lacker <lacker@gmail.com>","Lars Gierth <lgierth@users.noreply.github.com>","Leask Wong <i@leaskh.com>","Marcin Tojek <mtojek@users.noreply.github.com>","Marston Connell <34043723+TheMarstonConnell@users.noreply.github.com>","Michael Burns <5170+mburns@users.noreply.github.com>","Miguel Mota <miguelmota2@gmail.com>","Nuno Nogueira <nunofmn@gmail.com>","Philipp Muens <raute1337@gmx.de>","RasmusErik Voel Jensen <github@solsort.com>","Smite Chow <xiaopengyou@live.com>","Soeren <nikorpoulsen@gmail.com>"]}});var dP=m((xCt,Tc)=>{f();"use strict";var _Ge=fP().version;Tc.exports.PROTOCOL_VERSION="ipfs/0.1.0";Tc.exports.AGENT_VERSION=`js-libp2p/${_Ge}`;Tc.exports.MULTICODEC_IDENTIFY="/ipfs/id/1.0.0";Tc.exports.MULTICODEC_IDENTIFY_PUSH="/ipfs/id/push/1.0.0";Tc.exports.IDENTIFY_PROTOCOL_VERSION="0.1.0";Tc.exports.MULTICODEC_IDENTIFY_PROTOCOL_NAME="id";Tc.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME="id/push";Tc.exports.MULTICODEC_IDENTIFY_PROTOCOL_VERSION="1.0.0";Tc.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION="1.0.0"});var F8=m((ICt,Cpe)=>{f();"use strict";var Ppe=60*1e3;Cpe.exports={ADVERTISE_BOOT_DELAY:15*Ppe,ADVERTISE_TTL:30*Ppe,CIRCUIT_PROTO_CODE:290,HOP_METADATA_KEY:"hop_relay",HOP_METADATA_VALUE:"true",RELAY_RENDEZVOUS_NS:"/libp2p/relay"}});var kpe=m((TCt,Ope)=>{f();"use strict";var vGe=x8();function EGe(r){let{address:e}=r.nodeAddress();return vGe(e)}Ope.exports=EGe});var hP=m((PCt,Npe)=>{f();"use strict";var Dpe=kpe();function SGe(r,e){let t=Dpe(r.multiaddr),i=Dpe(e.multiaddr);return t&&!i?1:!t&&i||r.isCertified&&!e.isCertified?-1:!r.isCertified&&e.isCertified?1:0}function RGe(r){return[...r].sort(SGe)}Npe.exports.publicAddressesFirst=RGe});var Lpe=m((CCt,pP)=>{f();"use strict";var Bpe=async r=>{try{let e=await r;return{isFulfilled:!0,isRejected:!1,value:e}}catch(e){return{isFulfilled:!1,isRejected:!0,reason:e}}};pP.exports=Bpe;pP.exports.default=Bpe});var jpe=m((OCt,yP)=>{f();"use strict";var Mpe=(r,...e)=>new Promise(t=>{t(r(...e))});yP.exports=Mpe;yP.exports.default=Mpe});var Upe=m((kCt,gP)=>{f();"use strict";var AGe=jpe(),qpe=r=>{if(!((Number.isInteger(r)||r===1/0)&&r>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));let e=[],t=0,i=()=>{t--,e.length>0&&e.shift()()},n=(a,c,...u)=>{t++;let l=AGe(a,...u);c(l),l.then(i,i)},s=(a,c,...u)=>{t<r?n(a,c,...u):e.push(n.bind(null,a,c,...u))},o=(a,...c)=>new Promise(u=>s(a,u,...c));return Object.defineProperties(o,{activeCount:{get:()=>t},pendingCount:{get:()=>e.length},clearQueue:{value:()=>{e.length=0}}}),o};gP.exports=qpe;gP.exports.default=qpe});var Kpe=m((DCt,Fpe)=>{f();"use strict";var mP=Lpe(),xGe=Upe();Fpe.exports=async(r,e={})=>{let{concurrency:t=1/0}=e,i=xGe(t);return Promise.all(r.map(n=>n&&typeof n.then=="function"?mP(n):mP(typeof n=="function"?i(()=>n()):Promise.resolve(n))))}});var zpe=m((NCt,Vpe)=>{f();"use strict";function IGe(r,e){return r.length===e.length&&e.sort()&&r.sort().every((t,i)=>e[i].equals(t))}Vpe.exports=IGe});var Gpe=m((BCt,$pe)=>{f();"use strict";var yh=Br(),K8=yh.Reader,Hpe=yh.Writer,oi=yh.util,To=yh.roots["libp2p-peer-record"]||(yh.roots["libp2p-peer-record"]={});To.PeerRecord=function(){function r(e){if(this.addresses=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.peerId=oi.newBuffer([]),r.prototype.seq=oi.Long?oi.Long.fromBits(0,0,!0):0,r.prototype.addresses=oi.emptyArray,r.encode=function(t,i){if(i||(i=Hpe.create()),t.peerId!=null&&Object.hasOwnProperty.call(t,"peerId")&&i.uint32(10).bytes(t.peerId),t.seq!=null&&Object.hasOwnProperty.call(t,"seq")&&i.uint32(16).uint64(t.seq),t.addresses!=null&&t.addresses.length)for(var n=0;n<t.addresses.length;++n)To.PeerRecord.AddressInfo.encode(t.addresses[n],i.uint32(26).fork()).ldelim();return i},r.decode=function(t,i){t instanceof K8||(t=K8.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new To.PeerRecord;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.peerId=t.bytes();break;case 2:s.seq=t.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(To.PeerRecord.AddressInfo.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof To.PeerRecord)return t;var i=new To.PeerRecord;if(t.peerId!=null&&(typeof t.peerId=="string"?oi.base64.decode(t.peerId,i.peerId=oi.newBuffer(oi.base64.length(t.peerId)),0):t.peerId.length&&(i.peerId=t.peerId)),t.seq!=null&&(oi.Long?(i.seq=oi.Long.fromValue(t.seq)).unsigned=!0:typeof t.seq=="string"?i.seq=parseInt(t.seq,10):typeof t.seq=="number"?i.seq=t.seq:typeof t.seq=="object"&&(i.seq=new oi.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0))),t.addresses){if(!Array.isArray(t.addresses))throw TypeError(".PeerRecord.addresses: array expected");i.addresses=[];for(var n=0;n<t.addresses.length;++n){if(typeof t.addresses[n]!="object")throw TypeError(".PeerRecord.addresses: object expected");i.addresses[n]=To.PeerRecord.AddressInfo.fromObject(t.addresses[n])}}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addresses=[]),i.defaults)if(i.bytes===String?n.peerId="":(n.peerId=[],i.bytes!==Array&&(n.peerId=oi.newBuffer(n.peerId))),oi.Long){var s=new oi.Long(0,0,!0);n.seq=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.seq=i.longs===String?"0":0;if(t.peerId!=null&&t.hasOwnProperty("peerId")&&(n.peerId=i.bytes===String?oi.base64.encode(t.peerId,0,t.peerId.length):i.bytes===Array?Array.prototype.slice.call(t.peerId):t.peerId),t.seq!=null&&t.hasOwnProperty("seq")&&(typeof t.seq=="number"?n.seq=i.longs===String?String(t.seq):t.seq:n.seq=i.longs===String?oi.Long.prototype.toString.call(t.seq):i.longs===Number?new oi.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0):t.seq),t.addresses&&t.addresses.length){n.addresses=[];for(var o=0;o<t.addresses.length;++o)n.addresses[o]=To.PeerRecord.AddressInfo.toObject(t.addresses[o],i)}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,yh.util.toJSONOptions)},r.AddressInfo=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.multiaddr=oi.newBuffer([]),e.encode=function(i,n){return n||(n=Hpe.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),n},e.decode=function(i,n){i instanceof K8||(i=K8.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new To.PeerRecord.AddressInfo;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof To.PeerRecord.AddressInfo)return i;var n=new To.PeerRecord.AddressInfo;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?oi.base64.decode(i.multiaddr,n.multiaddr=oi.newBuffer(oi.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=oi.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?oi.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,yh.util.toJSONOptions)},e}(),r}();$pe.exports=To});var Ype=m((LCt,Wpe)=>{f();"use strict";var TGe="libp2p-peer-record",PGe=Uint8Array.from([3,1]);Wpe.exports={ENVELOPE_DOMAIN_PEER_RECORD:TGe,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:PGe}});var V8=m((MCt,Zpe)=>{f();"use strict";var{Multiaddr:CGe}=ft(),OGe=ot(),kGe=zpe(),{PeerRecord:Xpe}=Gpe(),{ENVELOPE_DOMAIN_PEER_RECORD:Qpe,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:DGe}=Ype(),gh=class{constructor({peerId:e,multiaddrs:t=[],seqNumber:i=Date.now()}){this.domain=Qpe,this.codec=DGe,this.peerId=e,this.multiaddrs=t,this.seqNumber=i,this._marshal=void 0}marshal(){return this._marshal?this._marshal:(this._marshal=Xpe.encode({peerId:this.peerId.toBytes(),seq:this.seqNumber,addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))}).finish(),this._marshal)}equals(e){return!(!(e instanceof gh)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!kGe(this.multiaddrs,e.multiaddrs))}};gh.createFromProtobuf=r=>{let e=Xpe.decode(r),t=OGe.createFromBytes(e.peerId),i=(e.addresses||[]).map(s=>new CGe(s.multiaddr)),n=Number(e.seq);return new gh({peerId:t,multiaddrs:i,seqNumber:n})};gh.DOMAIN=Qpe;Zpe.exports=gh});var bP=m((jCt,Jpe)=>{f();"use strict";var NGe=Wg(),BGe=V8();async function LGe(r){let e=new BGe({peerId:r.peerId,multiaddrs:r.multiaddrs}),t=await NGe.seal(e,r.peerId);await r.peerStore.addressBook.consumePeerRecord(t)}Jpe.exports.updateSelfPeerRecord=LGe});var _P=m((qCt,r0e)=>{f();"use strict";var e0e=le(),mh=Object.assign(e0e("libp2p:transports"),{error:e0e("libp2p:transports:err")}),MGe=Kpe(),{codes:M1}=wr(),Nm=br(),{updateSelfPeerRecord:t0e}=bP(),wP=class{constructor({libp2p:e,upgrader:t,faultTolerance:i=z8.FATAL_ALL}){this.libp2p=e,this.upgrader=t,this._transports=new Map,this._listeners=new Map,this._listenerOptions=new Map,this.faultTolerance=i}add(e,t,i={}){if(mh("adding %s",e),!e)throw Nm(new Error(`Transport must have a valid key, was given '${e}'`),M1.ERR_INVALID_KEY);if(this._transports.has(e))throw Nm(new Error("There is already a transport with this key"),M1.ERR_DUPLICATE_TRANSPORT);let n=new t({...i,libp2p:this.libp2p,upgrader:this.upgrader});this._transports.set(e,n),this._listenerOptions.set(e,i.listenerOptions||{}),this._listeners.has(e)||this._listeners.set(e,[])}async close(){let e=[];for(let[t,i]of this._listeners)for(mh("closing listeners for %s",t);i.length;){let n=i.pop();n.removeAllListeners("listening"),n.removeAllListeners("close"),e.push(n.close())}await Promise.all(e),mh("all listeners closed");for(let t of this._listeners.keys())this._listeners.set(t,[])}async dial(e,t){let i=this.transportForMultiaddr(e);if(!i)throw Nm(new Error(`No transport available for address ${String(e)}`),M1.ERR_TRANSPORT_UNAVAILABLE);try{return await i.dial(e,t)}catch(n){throw n.code||(n.code=M1.ERR_TRANSPORT_DIAL_FAILED),n}}getAddrs(){let e=[];for(let t of this._listeners.values())for(let i of t)e=[...e,...i.getAddrs()];return e}getTransports(){return this._transports.values()}transportForMultiaddr(e){for(let t of this._transports.values())if(t.filter([e]).length)return t;return null}async listen(e){if(!e||e.length===0){mh("no addresses were provided for listening, this node is dial only");return}let t=[];for(let[i,n]of this._transports.entries()){let s=n.filter(e),o=[];for(let u of s){mh("creating listener for %s on %s",i,u);let l=n.createListener(this._listenerOptions.get(i));this._listeners.get(i).push(l),l.on("listening",()=>t0e(this.libp2p)),l.on("close",()=>t0e(this.libp2p)),o.push(l.listen(u))}if(o.length===0){t.push(i);continue}if(!(await MGe(o)).find(u=>u.isFulfilled===!0)&&this.faultTolerance!==z8.NO_FATAL)throw Nm(new Error(`Transport (${i}) could not listen on any available address`),M1.ERR_NO_VALID_ADDRESSES)}if(t.length===this._transports.size){let i=`no valid addresses were provided for transports [${t}]`;if(this.faultTolerance===z8.FATAL_ALL)throw Nm(new Error(i),M1.ERR_NO_VALID_ADDRESSES);mh(`libp2p in dial mode only: ${i}`)}}async remove(e){if(mh("removing %s",e),this._listeners.has(e))for(let t of this._listeners.get(e))t.removeAllListeners("listening"),t.removeAllListeners("close"),await t.close();this._transports.delete(e),this._listeners.delete(e)}async removeAll(){let e=[];for(let t of this._transports.keys())e.push(this.remove(t));await Promise.all(e)}},z8={FATAL_ALL:0,NO_FATAL:1};wP.FaultTolerance=z8;r0e.exports=wP});var s0e=m((UCt,n0e)=>{f();"use strict";var jGe=Uu(),{dnsaddrResolver:qGe}=Ipe(),vP=U8(),{AGENT_VERSION:UGe}=dP(),i0e=F8(),{publicAddressesFirst:FGe}=hP(),{FaultTolerance:KGe}=_P(),VGe={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:r=>r},connectionManager:{minConnections:25},connectionGater:{},transportManager:{faultTolerance:KGe.FATAL_ALL},dialer:{maxParallelDials:vP.MAX_PARALLEL_DIALS,maxDialsPerPeer:vP.MAX_PER_PEER_DIALS,dialTimeout:vP.DIAL_TIMEOUT,resolvers:{dnsaddr:qGe},addressSorter:FGe},host:{agentVersion:UGe},metrics:{enabled:!1},peerStore:{persistence:!1,threshold:5},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},config:{protocolPrefix:"ipfs",dht:{enabled:!1,kBucketSize:20},nat:{enabled:!0,ttl:7200,keepAlive:!0,gateway:null,externalIp:null,pmp:{enabled:!1}},peerDiscovery:{autoDial:!0},pubsub:{enabled:!0},relay:{enabled:!0,advertise:{bootDelay:i0e.ADVERTISE_BOOT_DELAY,enabled:!1,ttl:i0e.ADVERTISE_TTL},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},transport:{}}};n0e.exports.validate=r=>{let e=jGe(VGe,r);if(e.modules.transport.length<1)throw new Error("'options.modules.transport' must contain at least 1 transport");return e}});var c0e=m((FCt,a0e)=>{f();"use strict";var{EventEmitter:zGe}=Ut(),{Multiaddr:Bm}=ft(),HGe=ot(),o0e=class extends zGe{constructor(e,{listen:t=[],announce:i=[]}={}){super();this.peerId=e,this.listen=new Set(t.map(n=>n.toString())),this.announce=new Set(i.map(n=>n.toString())),this.observed=new Set}getListenAddrs(){return Array.from(this.listen).map(e=>new Bm(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new Bm(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new Bm(e))}addObservedAddr(e){let t=new Bm(e),i=t.getPeerId();i&&HGe.createFromB58String(i).equals(this.peerId)&&(t=t.decapsulate(new Bm(`/p2p/${this.peerId}`)));let n=t.toString();this.observed.has(n)||(this.observed.add(n),this.emit("change:addresses"))}};a0e.exports=o0e});var f0e=m((KCt,l0e)=>{f();"use strict";var{EventEmitter:$Ge}=Ut(),EP=le()("latency-monitor:VisibilityChangeEmitter"),u0e=class extends $Ge{constructor(){super();if(typeof document=="undefined"){EP('This is not a browser, no "document" found. Stopping.');return}this._initializeVisibilityVarNames(),this._addVisibilityChangeListener()}_initializeVisibilityVarNames(){let e,t;typeof document.hidden!="undefined"?(e="hidden",t="visibilitychange"):typeof document.mozHidden!="undefined"?(e="mozHidden",t="mozvisibilitychange"):typeof document.msHidden!="undefined"?(e="msHidden",t="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(e="webkitHidden",t="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=t}_addVisibilityChangeListener(){typeof document.addEventListener=="undefined"||typeof document[this._hidden]=="undefined"?EP("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this._hidden===void 0||document[this._hidden]===void 0))return!document[this._hidden]}_handleVisibilityChange(){let e=!document[this._hidden];EP(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}};l0e.exports=u0e});var p0e=m((VCt,h0e)=>{f();"use strict";var{EventEmitter:GGe}=Ut(),WGe=f0e(),Du=le()("latency-monitor:LatencyMonitor"),d0e=class extends GGe{constructor({latencyCheckIntervalMs:e,dataEmitIntervalMs:t,asyncTestFn:i,latencyRandomPercentage:n}={}){super();let s=this;s.latencyCheckIntervalMs=e||500,s.latencyRandomPercentage=n||10,s._latecyCheckMultiply=2*(s.latencyRandomPercentage/100)*s.latencyCheckIntervalMs,s._latecyCheckSubtract=s._latecyCheckMultiply/2,s.dataEmitIntervalMs=t===null||t===0?void 0:t||5*1e3,Du("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",s.latencyCheckIntervalMs,s.dataEmitIntervalMs),s.dataEmitIntervalMs?Du("Expecting ~%s events per summary",s.latencyCheckIntervalMs/s.dataEmitIntervalMs):Du("Not emitting summaries"),s.asyncTestFn=i}start(){globalThis.process&&globalThis.process.hrtime?(Du("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{let t=this.now(e);return t[0]*1e3+t[1]/1e6}):typeof window!="undefined"&&window.performance&&window.performance.now?(Du("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(Du("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this._latencyData=this._initLatencyData(),YGe()&&(this._visibilityChangeEmitter=new WGe,this._visibilityChangeEmitter.on("visibilityChange",e=>{e?this._startTimers():(this._emitSummary(),this._stopTimers())})),(!this._visibilityChangeEmitter||this._visibilityChangeEmitter.isVisible())&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this._checkLatencyID||(this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this._emitIntervalID.unref=="function"&&this._emitIntervalID.unref()))}_stopTimers(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=void 0),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=void 0)}_emitSummary(){let e=this.getSummary();e.events>0&&this.emit("data",e)}getSummary(){let e={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),Du("Summary: %O",e),e}_checkLatency(){let e=this,t=Math.random()*e._latecyCheckMultiply-e._latecyCheckSubtract,i={deltaOffset:Math.ceil(e.latencyCheckIntervalMs+t),startTime:e.now()},n=()=>{if(!this._checkLatencyID)return;let s=e.getDeltaMS(i.startTime)-i.deltaOffset;e._checkLatency(),e._latencyData.events++,e._latencyData.minMs=Math.min(e._latencyData.minMs,s),e._latencyData.maxMs=Math.max(e._latencyData.maxMs,s),e._latencyData.totalMs+=s,Du("MS: %s Data: %O",s,e._latencyData)};Du("localData: %O",i),this._checkLatencyID=setTimeout(()=>{e.asyncTestFn?(i.deltaOffset=0,i.startTime=e.now(),e.asyncTestFn(n)):(i.deltaOffset-=1,n())},i.deltaOffset),typeof this._checkLatencyID.unref=="function"&&this._checkLatencyID.unref()}_initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}};function YGe(){return typeof window!="undefined"}h0e.exports=d0e});var bh=m((zCt,g0e)=>{f();"use strict";var y0e=class extends Map{constructor(e){super();let{system:t,component:i,metric:n,metrics:s}=e;this._system=t,this._component=i,this._metric=n,this._metrics=s,this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size})}set(e,t){return super.set(e,t),this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size}),this}delete(e){let t=super.delete(e);return this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size}),t}clear(){super.clear(),this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size})}};g0e.exports=({system:r="libp2p",component:e,metric:t,metrics:i})=>{let n;return i?n=new y0e({system:r,component:e,metric:t,metrics:i}):n=new Map,n}});var A0e=m((HCt,R0e)=>{f();"use strict";var m0e=le(),ga=Object.assign(m0e("libp2p:connection-manager"),{error:m0e("libp2p:connection-manager:err")}),b0e=br(),XGe=Uu(),QGe=p0e(),w0e=jy(),{EventEmitter:ZGe}=Ut(),_0e=bh(),JGe=ot(),{codes:{ERR_INVALID_PARAMETERS:v0e}}=wr(),eWe={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:1},E0e="connection-manager",tWe="peer-connections",rWe="peer-values",S0e=class extends ZGe{constructor(e,t={}){super();if(this._libp2p=e,this._peerId=e.peerId.toB58String(),this._options=XGe.call({ignoreUndefined:!0},eWe,t),this._options.maxConnections<this._options.minConnections)throw b0e(new Error("Connection Manager maxConnections must be greater than minConnections"),v0e);ga("options: %j",this._options),this._peerValues=_0e({component:E0e,metric:rWe,metrics:this._libp2p.metrics}),this.connections=_0e({component:E0e,metric:tWe,metrics:this._libp2p.metrics}),this._started=!1,this._timer=null,this._checkMetrics=this._checkMetrics.bind(this),this._latencyMonitor=new QGe({latencyCheckIntervalMs:this._options.pollInterval,dataEmitIntervalMs:this._options.pollInterval}),this.setMaxListeners(1/0)}get size(){return Array.from(this.connections.values()).reduce((e,t)=>e+t.length,0)}start(){this._libp2p.metrics&&(this._timer=this._timer||w0e(this._checkMetrics,this._options.pollInterval)),this._latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure),this._started=!0,ga("started")}async stop(){this._timer&&this._timer.clear(),this._latencyMonitor.removeListener("data",this._onLatencyMeasure),this._latencyMonitor.stop(),this._started=!1,await this._close(),ga("stopped")}async _close(){let e=[];for(let t of this.connections.values())for(let i of t)e.push(i.close());await Promise.all(e),this.connections.clear()}setPeerValue(e,t){if(t<0||t>1)throw new Error("value should be a number between 0 and 1");this._peerValues.set(e.toB58String(),t)}async _checkMetrics(){if(this._libp2p.metrics)try{let e=this._libp2p.metrics.global.movingAverages,t=e.dataReceived[this._options.movingAverageInterval].movingAverage();await this._checkMaxLimit("maxReceivedData",t);let i=e.dataSent[this._options.movingAverageInterval].movingAverage();await this._checkMaxLimit("maxSentData",i);let n=t+i;await this._checkMaxLimit("maxData",n),ga("metrics update",n)}finally{this._timer=w0e(this._checkMetrics,this._options.pollInterval)}}async onConnect(e){if(!this._started){await e.close();return}let t=e.remotePeer,i=t.toB58String(),n=this.connections.get(i);this.emit("peer:connect",e),n?n.push(e):this.connections.set(i,[e]),await this._libp2p.peerStore.keyBook.set(t,t.pubKey),this._peerValues.has(i)||this._peerValues.set(i,this._options.defaultPeerValue),await this._checkMaxLimit("maxConnections",this.size)}onDisconnect(e){if(!this._started)return;let t=e.remotePeer.toB58String(),i=this.connections.get(t);i&&i.length>1?(i=i.filter(n=>n.id!==e.id),this.connections.set(t,i)):i&&(this.connections.delete(t),this._peerValues.delete(e.remotePeer.toB58String()),this.emit("peer:disconnect",e),this._libp2p.metrics&&this._libp2p.metrics.onPeerDisconnected(e.remotePeer))}get(e){let t=this.getAll(e);return t.length?t[0]:null}getAll(e){if(!JGe.isPeerId(e))throw b0e(new Error("peerId must be an instance of peer-id"),v0e);let t=e.toB58String(),i=this.connections.get(t);return i?i.filter(n=>n.stat.status==="open"):[]}_onLatencyMeasure(e){this._checkMaxLimit("maxEventLoopDelay",e.avgMs).catch(t=>{ga.error(t)})}async _checkMaxLimit(e,t){let i=this._options[e];ga("checking limit of %s. current value: %d of %d",e,t,i),t>i&&(ga("%s: limit exceeded: %s, %d",this._peerId,e,t),await this._maybeDisconnectOne())}async _maybeDisconnectOne(){if(this._options.minConnections<this.connections.size){let e=Array.from(new Map([...this._peerValues.entries()].sort((i,n)=>i[1]-n[1])));ga("%s: sorted peer values: %j",this._peerId,e);let t=e[0];if(t){let i=t[0];ga("%s: lowest value peer is %s",this._peerId,i),ga("%s: closing a connection to %j",this._peerId,i);for(let n of this.connections.values())if(n[0].remotePeer.toB58String()===i){n[0].close().catch(s=>{ga.error(s)}),this.onDisconnect(n[0]);break}}}}};R0e.exports=S0e});var C0e=m(($Ct,P0e)=>{f();"use strict";var x0e=le(),iWe=Uu(),I0e=jy(),nWe=Zo(),{pipe:sWe}=dr(),oWe=rs(),aWe=SA(),Ef=Object.assign(x0e("libp2p:connection-manager:auto-dialler"),{error:x0e("libp2p:connection-manager:auto-dialler:err")}),cWe={enabled:!0,minConnections:0,autoDialInterval:1e4},T0e=class{constructor(e,t={}){this._options=iWe.call({ignoreUndefined:!0},cWe,t),this._libp2p=e,this._running=!1,this._autoDialTimeout=null,this._autoDial=this._autoDial.bind(this),Ef("options: %j",this._options)}async start(){if(!this._options.enabled){Ef("not enabled");return}this._running=!0,this._autoDial().catch(e=>{Ef.error("could start autodial",e)}),Ef("started")}async stop(){if(!this._options.enabled){Ef("not enabled");return}this._running=!1,this._autoDialTimeout&&this._autoDialTimeout.clear(),Ef("stopped")}async _autoDial(){let e=this._options.minConnections;if(this._libp2p.connections.size>=e){this._autoDialTimeout=I0e(this._autoDial,this._options.autoDialInterval);return}let t=await sWe(this._libp2p.peerStore.getPeers(),i=>oWe(i,n=>!n.id.equals(this._libp2p.peerId)),i=>aWe(i,(n,s)=>s.protocols&&s.protocols.length&&(!n.protocols||!n.protocols.length)||s.id.pubKey&&!n.id.pubKey?1:-1),i=>nWe(i));for(let i=0;this._running&&i<t.length&&this._libp2p.connections.size<e;i++){let n=t[i];if(!this._libp2p.connectionManager.get(n.id)){Ef("connecting to a peerStore stored peer %s",n.id.toB58String());try{await this._libp2p.dialer.connectToPeer(n.id)}catch(s){Ef.error("could not connect to peerStore stored peer",s)}}}!this._running||(this._autoDialTimeout=I0e(this._autoDial,this._options.autoDialInterval))}};P0e.exports=T0e});var j1=m((GCt,k0e)=>{f();"use strict";var wh=Br(),H8=wh.Reader,O0e=wh.Writer,Po=wh.util,Qi=wh.roots["libp2p-circuit"]||(wh.roots["libp2p-circuit"]={});Qi.CircuitRelay=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.type=1,r.prototype.srcPeer=null,r.prototype.dstPeer=null,r.prototype.code=100,r.encode=function(t,i){return i||(i=O0e.create()),t.type!=null&&Object.hasOwnProperty.call(t,"type")&&i.uint32(8).int32(t.type),t.srcPeer!=null&&Object.hasOwnProperty.call(t,"srcPeer")&&Qi.CircuitRelay.Peer.encode(t.srcPeer,i.uint32(18).fork()).ldelim(),t.dstPeer!=null&&Object.hasOwnProperty.call(t,"dstPeer")&&Qi.CircuitRelay.Peer.encode(t.dstPeer,i.uint32(26).fork()).ldelim(),t.code!=null&&Object.hasOwnProperty.call(t,"code")&&i.uint32(32).int32(t.code),i},r.decode=function(t,i){t instanceof H8||(t=H8.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Qi.CircuitRelay;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.type=t.int32();break;case 2:s.srcPeer=Qi.CircuitRelay.Peer.decode(t,t.uint32());break;case 3:s.dstPeer=Qi.CircuitRelay.Peer.decode(t,t.uint32());break;case 4:s.code=t.int32();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Qi.CircuitRelay)return t;var i=new Qi.CircuitRelay;switch(t.type){case"HOP":case 1:i.type=1;break;case"STOP":case 2:i.type=2;break;case"STATUS":case 3:i.type=3;break;case"CAN_HOP":case 4:i.type=4;break}if(t.srcPeer!=null){if(typeof t.srcPeer!="object")throw TypeError(".CircuitRelay.srcPeer: object expected");i.srcPeer=Qi.CircuitRelay.Peer.fromObject(t.srcPeer)}if(t.dstPeer!=null){if(typeof t.dstPeer!="object")throw TypeError(".CircuitRelay.dstPeer: object expected");i.dstPeer=Qi.CircuitRelay.Peer.fromObject(t.dstPeer)}switch(t.code){case"SUCCESS":case 100:i.code=100;break;case"HOP_SRC_ADDR_TOO_LONG":case 220:i.code=220;break;case"HOP_DST_ADDR_TOO_LONG":case 221:i.code=221;break;case"HOP_SRC_MULTIADDR_INVALID":case 250:i.code=250;break;case"HOP_DST_MULTIADDR_INVALID":case 251:i.code=251;break;case"HOP_NO_CONN_TO_DST":case 260:i.code=260;break;case"HOP_CANT_DIAL_DST":case 261:i.code=261;break;case"HOP_CANT_OPEN_DST_STREAM":case 262:i.code=262;break;case"HOP_CANT_SPEAK_RELAY":case 270:i.code=270;break;case"HOP_CANT_RELAY_TO_SELF":case 280:i.code=280;break;case"STOP_SRC_ADDR_TOO_LONG":case 320:i.code=320;break;case"STOP_DST_ADDR_TOO_LONG":case 321:i.code=321;break;case"STOP_SRC_MULTIADDR_INVALID":case 350:i.code=350;break;case"STOP_DST_MULTIADDR_INVALID":case 351:i.code=351;break;case"STOP_RELAY_REFUSED":case 390:i.code=390;break;case"MALFORMED_MESSAGE":case 400:i.code=400;break}return i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.type=i.enums===String?"HOP":1,n.srcPeer=null,n.dstPeer=null,n.code=i.enums===String?"SUCCESS":100),t.type!=null&&t.hasOwnProperty("type")&&(n.type=i.enums===String?Qi.CircuitRelay.Type[t.type]:t.type),t.srcPeer!=null&&t.hasOwnProperty("srcPeer")&&(n.srcPeer=Qi.CircuitRelay.Peer.toObject(t.srcPeer,i)),t.dstPeer!=null&&t.hasOwnProperty("dstPeer")&&(n.dstPeer=Qi.CircuitRelay.Peer.toObject(t.dstPeer,i)),t.code!=null&&t.hasOwnProperty("code")&&(n.code=i.enums===String?Qi.CircuitRelay.Status[t.code]:t.code),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,wh.util.toJSONOptions)},r.Status=function(){var e={},t=Object.create(e);return t[e[100]="SUCCESS"]=100,t[e[220]="HOP_SRC_ADDR_TOO_LONG"]=220,t[e[221]="HOP_DST_ADDR_TOO_LONG"]=221,t[e[250]="HOP_SRC_MULTIADDR_INVALID"]=250,t[e[251]="HOP_DST_MULTIADDR_INVALID"]=251,t[e[260]="HOP_NO_CONN_TO_DST"]=260,t[e[261]="HOP_CANT_DIAL_DST"]=261,t[e[262]="HOP_CANT_OPEN_DST_STREAM"]=262,t[e[270]="HOP_CANT_SPEAK_RELAY"]=270,t[e[280]="HOP_CANT_RELAY_TO_SELF"]=280,t[e[320]="STOP_SRC_ADDR_TOO_LONG"]=320,t[e[321]="STOP_DST_ADDR_TOO_LONG"]=321,t[e[350]="STOP_SRC_MULTIADDR_INVALID"]=350,t[e[351]="STOP_DST_MULTIADDR_INVALID"]=351,t[e[390]="STOP_RELAY_REFUSED"]=390,t[e[400]="MALFORMED_MESSAGE"]=400,t}(),r.Type=function(){var e={},t=Object.create(e);return t[e[1]="HOP"]=1,t[e[2]="STOP"]=2,t[e[3]="STATUS"]=3,t[e[4]="CAN_HOP"]=4,t}(),r.Peer=function(){function e(t){if(this.addrs=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.id=Po.newBuffer([]),e.prototype.addrs=Po.emptyArray,e.encode=function(i,n){if(n||(n=O0e.create()),n.uint32(10).bytes(i.id),i.addrs!=null&&i.addrs.length)for(var s=0;s<i.addrs.length;++s)n.uint32(18).bytes(i.addrs[s]);return n},e.decode=function(i,n){i instanceof H8||(i=H8.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Qi.CircuitRelay.Peer;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.id=i.bytes();break;case 2:o.addrs&&o.addrs.length||(o.addrs=[]),o.addrs.push(i.bytes());break;default:i.skipType(a&7);break}}if(!o.hasOwnProperty("id"))throw Po.ProtocolError("missing required 'id'",{instance:o});return o},e.fromObject=function(i){if(i instanceof Qi.CircuitRelay.Peer)return i;var n=new Qi.CircuitRelay.Peer;if(i.id!=null&&(typeof i.id=="string"?Po.base64.decode(i.id,n.id=Po.newBuffer(Po.base64.length(i.id)),0):i.id.length&&(n.id=i.id)),i.addrs){if(!Array.isArray(i.addrs))throw TypeError(".CircuitRelay.Peer.addrs: array expected");n.addrs=[];for(var s=0;s<i.addrs.length;++s)typeof i.addrs[s]=="string"?Po.base64.decode(i.addrs[s],n.addrs[s]=Po.newBuffer(Po.base64.length(i.addrs[s])),0):i.addrs[s].length&&(n.addrs[s]=i.addrs[s])}return n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addrs=[]),n.defaults&&(n.bytes===String?s.id="":(s.id=[],n.bytes!==Array&&(s.id=Po.newBuffer(s.id)))),i.id!=null&&i.hasOwnProperty("id")&&(s.id=n.bytes===String?Po.base64.encode(i.id,0,i.id.length):n.bytes===Array?Array.prototype.slice.call(i.id):i.id),i.addrs&&i.addrs.length){s.addrs=[];for(var o=0;o<i.addrs.length;++o)s.addrs[o]=n.bytes===String?Po.base64.encode(i.addrs[o],0,i.addrs[o].length):n.bytes===Array?Array.prototype.slice.call(i.addrs[o]):i.addrs[o]}return s},e.prototype.toJSON=function(){return this.constructor.toObject(this,wh.util.toJSONOptions)},e}(),r}();k0e.exports=Qi});var B0e=m((WCt,N0e)=>{f();"use strict";var{source:D0e}=ua(),uWe=le(),lWe=uWe("libp2p:stream:converter");function fWe({stream:r,remoteAddr:e,localAddr:t},i={}){let{sink:n,source:s}=r,o={async sink(c){i.signal&&(c=D0e(c,i.signal));try{await n(c)}catch(u){u.type!=="aborted"&&lWe(u)}a()},source:i.signal?D0e(s,i.signal):s,conn:r,localAddr:t,remoteAddr:e,timeline:{open:Date.now(),close:void 0},close(){return n(new Uint8Array(0)),a()}};function a(){return o.timeline.close||(o.timeline.close=Date.now()),Promise.resolve()}return o}N0e.exports=fWe});var Lm=m((YCt,L0e)=>{f();"use strict";L0e.exports={relay:"/libp2p/circuit/relay/0.1.0"}});var j0e=m((XCt,M0e)=>{f();"use strict";var{EventEmitter:dWe}=Ut(),{Multiaddr:hWe}=ft();M0e.exports=r=>{let e=new Map;async function t(s){let o=String(s).split("/p2p-circuit").find(u=>u!==""),a=await r.dial(new hWe(o)),c=a.remoteAddr.encapsulate("/p2p-circuit");e.set(a.remotePeer.toB58String(),c),n.emit("listening")}function i(){let s=[];for(let o of e.values())s.push(o);return s}let n=Object.assign(new dWe,{close:()=>Promise.resolve(),listen:t,getAddrs:i});return r.connectionManager.on("peer:disconnect",s=>{e.delete(s.remotePeer.toB58String())&&n.emit("close")}),n}});var SP=m((QCt,F0e)=>{f();"use strict";var{Multiaddr:q0e}=ft(),{CircuitRelay:_h}=j1();function U0e(r,e){r.write({type:_h.Type.STATUS,code:e})}function pWe(r,e){try{r.dstPeer&&r.dstPeer.addrs&&r.dstPeer.addrs.forEach(t=>new q0e(t))}catch(t){throw U0e(e,r.type===_h.Type.HOP?_h.Status.HOP_DST_MULTIADDR_INVALID:_h.Status.STOP_DST_MULTIADDR_INVALID),t}try{r.srcPeer&&r.srcPeer.addrs&&r.srcPeer.addrs.forEach(t=>new q0e(t))}catch(t){throw U0e(e,r.type===_h.Type.HOP?_h.Status.HOP_SRC_MULTIADDR_INVALID:_h.Status.STOP_SRC_MULTIADDR_INVALID),t}}F0e.exports={validateAddrs:pWe}});var G8=m((ZCt,$0e)=>{f();"use strict";var K0e=le(),$8=Object.assign(K0e("libp2p:circuit:stream-handler"),{error:K0e("libp2p:circuit:stream-handler:err")}),V0e=go(),yWe=fh(),{CircuitRelay:z0e}=j1(),H0e=class{constructor({stream:e,maxLength:t=4096}){this.stream=e,this.shake=yWe(this.stream),this.decoder=V0e.decode.fromReader(this.shake.reader,{maxDataLength:t})}async read(){let e=await this.decoder.next();if(e.value){let t=z0e.decode(e.value.slice());return $8("read message type",t.type),t}$8("read received no value, closing stream"),this.close()}write(e){$8("write message type %s",e.type),this.shake.write(V0e.encode.single(z0e.encode(e).finish()))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){$8("closing the stream"),this.rest().sink([])}};$0e.exports=H0e});var xP=m((JCt,AP)=>{f();"use strict";var G0e=le(),Mm=Object.assign(G0e("libp2p:circuit:stop"),{error:G0e("libp2p:circuit:stop:err")}),{CircuitRelay:RP}=j1(),gWe=Lm(),mWe=G8(),{validateAddrs:bWe}=SP();AP.exports.handleStop=function({connection:e,request:t,streamHandler:i}){try{bWe(t,i)}catch(n){return Mm.error("invalid stop request via peer %s",e.remotePeer.toB58String(),n)}return Mm("stop request is valid"),i.write({type:RP.Type.STATUS,code:RP.Status.SUCCESS}),i.rest()};AP.exports.stop=async function({connection:e,request:t}){let{stream:i}=await e.newStream([gWe.relay]);Mm("starting stop request to %s",e.remotePeer.toB58String());let n=new mWe({stream:i});n.write(t);let s=await n.read();if(!s)return n.close();if(s.code===RP.Status.SUCCESS)return Mm("stop request to %s was successful",e.remotePeer.toB58String()),n.rest();Mm("stop request failed with code %d",s.code),n.close()}});var IP=m((eOt,J0e)=>{f();"use strict";var W0e=le(),Nu=Object.assign(W0e("libp2p:circuit:hop"),{error:W0e("libp2p:circuit:hop:err")}),Y0e=br(),wWe=ot(),{validateAddrs:_We}=SP(),X0e=G8(),{CircuitRelay:Ts}=j1(),{pipe:vWe}=dr(),{codes:Q0e}=wr(),{stop:EWe}=xP(),Z0e=Lm();async function SWe({connection:r,request:e,streamHandler:t,circuit:i}){if(!i._options.hop.enabled)return Nu("HOP request received but we are not acting as a relay"),t.end({type:Ts.Type.STATUS,code:Ts.Status.HOP_CANT_SPEAK_RELAY});try{_We(e,t)}catch(u){return Nu.error("invalid hop request via peer %s",r.remotePeer.toB58String(),u)}if(!e.dstPeer){Nu("HOP request received but we do not receive a dstPeer");return}let n=new wWe(e.dstPeer.id),s=i._connectionManager.get(n);if(!s&&!i._options.hop.active)return Nu("HOP request received but we are not connected to the destination peer"),t.end({type:Ts.Type.STATUS,code:Ts.Status.HOP_NO_CONN_TO_DST});if(!s)return;let o={type:Ts.Type.STOP,dstPeer:e.dstPeer,srcPeer:e.srcPeer},a;try{a=await EWe({connection:s,request:o})}catch(u){return Nu.error(u)}Nu("hop request from %s is valid",r.remotePeer.toB58String()),t.write({type:Ts.Type.STATUS,code:Ts.Status.SUCCESS});let c=t.rest();return vWe(c,a,c)}async function RWe({connection:r,request:e}){let{stream:t}=await r.newStream([Z0e.relay]),i=new X0e({stream:t});i.write(e);let n=await i.read();if(!n)throw Y0e(new Error("HOP request had no response"),Q0e.ERR_HOP_REQUEST_FAILED);if(n.code===Ts.Status.SUCCESS)return Nu("hop request was successful"),i.rest();throw Nu("hop request failed with code %d, closing stream",n.code),i.close(),Y0e(new Error(`HOP request failed with code ${n.code}`),Q0e.ERR_HOP_REQUEST_FAILED)}async function AWe({connection:r}){let{stream:e}=await r.newStream([Z0e.relay]),t=new X0e({stream:e});t.write({type:Ts.Type.CAN_HOP});let i=await t.read();return await t.close(),!(!i||i.code!==Ts.Status.SUCCESS)}function xWe({connection:r,streamHandler:e,circuit:t}){let i=t._options.hop.enabled;Nu("can hop (%s) request from %s",i,r.remotePeer.toB58String()),e.end({type:Ts.Type.STATUS,code:i?Ts.Status.SUCCESS:Ts.Status.HOP_CANT_SPEAK_RELAY})}J0e.exports={handleHop:SWe,hop:RWe,canHop:AWe,handleCanHop:xWe}});var s1e=m((tOt,n1e)=>{f();"use strict";var e1e=le(),Bu=Object.assign(e1e("libp2p:circuit"),{error:e1e("libp2p:circuit:err")}),IWe=br(),TWe=Ff(),{Multiaddr:jm}=ft(),t1e=ot(),{CircuitRelay:qm}=j1(),{codes:PWe}=wr(),r1e=B0e(),{relay:CWe}=Lm(),OWe=j0e(),{handleCanHop:kWe,handleHop:DWe,hop:NWe}=IP(),{handleStop:BWe}=xP(),LWe=G8(),MWe=Symbol.for("@libp2p/js-libp2p-circuit/circuit"),i1e=class{constructor({libp2p:e,upgrader:t}){this._dialer=e.dialer,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._upgrader=t,this._options=e._config.relay,this._libp2p=e,this.peerId=e.peerId,this._registrar.handle(CWe,this._onProtocol.bind(this))}async _onProtocol({connection:e,stream:t}){let i=new LWe({stream:t}),n=await i.read();if(!n)return;let s=this,o;switch(n.type){case qm.Type.CAN_HOP:{Bu("received CAN_HOP request from %s",e.remotePeer.toB58String()),await kWe({circuit:s,connection:e,streamHandler:i});break}case qm.Type.HOP:{Bu("received HOP request from %s",e.remotePeer.toB58String()),o=await DWe({connection:e,request:n,streamHandler:i,circuit:s});break}case qm.Type.STOP:{Bu("received STOP request from %s",e.remotePeer.toB58String()),o=await BWe({connection:e,request:n,streamHandler:i});break}default:Bu("Request of type %s not supported",n.type)}if(o){let a=new jm(n.dstPeer.addrs[0]),c=new jm(n.srcPeer.addrs[0]),u=r1e({stream:o,remoteAddr:a,localAddr:c}),l=n.type===qm.Type.HOP?"relay":"inbound";Bu("new %s connection %s",l,u.remoteAddr);let d=await this._upgrader.upgradeInbound(u);Bu("%s connection %s upgraded",l,u.remoteAddr),this.handler&&this.handler(d)}}async dial(e,t){let i=e.toString().split("/p2p-circuit"),n=new jm(i[0]),s=new jm(i[i.length-1]),o=n.getPeerId(),a=s.getPeerId();if(!o||!a){let h="Circuit relay dial failed as addresses did not have peer id";throw Bu.error(h),IWe(new Error(h),PWe.ERR_RELAYED_DIAL)}let c=t1e.createFromB58String(o),u=t1e.createFromB58String(a),l=!1,d=this._connectionManager.get(c);d||(d=await this._dialer.connectToPeer(n,t),l=!0);try{let h=await NWe({connection:d,request:{type:qm.Type.HOP,srcPeer:{id:this.peerId.toBytes(),addrs:this._libp2p.multiaddrs.map(g=>g.bytes)},dstPeer:{id:u.toBytes(),addrs:[new jm(s).bytes]}}}),p=n.encapsulate(`/p2p-circuit/p2p/${this.peerId.toB58String()}`),y=r1e({stream:h,remoteAddr:e,localAddr:p});return Bu("new outbound connection %s",y.remoteAddr),this._upgrader.upgradeOutbound(y)}catch(h){throw Bu.error("Circuit relay dial failed",h),l&&await d.close(),h}}createListener(e,t){return typeof e=="function"&&(t=e,e={}),this.handler=t,OWe(this._libp2p)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(t=>TWe.Circuit.matches(t))}get[Symbol.toStringTag](){return"Circuit"}static isTransport(e){return Boolean(e&&e[MWe])}};n1e.exports=i1e});var TP=m((rOt,o1e)=>{f();"use strict";var{CID:jWe}=(we(),Fc),{sha256:qWe}=(vi(),Ks);o1e.exports.namespaceToCid=async r=>{let e=new TextEncoder().encode(r),t=await qWe.digest(e);return jWe.createV0(t)}});var d1e=m((iOt,f1e)=>{f();"use strict";var a1e=le(),PP=Object.assign(a1e("libp2p:auto-relay"),{error:a1e("libp2p:auto-relay:err")}),{fromString:UWe}=(ct(),Qr),{toString:FWe}=(tt(),sr),{Multiaddr:KWe}=ft(),VWe=Zo(),{relay:zWe}=Lm(),{canHop:HWe}=IP(),{namespaceToCid:$We}=TP(),{CIRCUIT_PROTO_CODE:GWe,HOP_METADATA_KEY:c1e,HOP_METADATA_VALUE:u1e,RELAY_RENDEZVOUS_NS:WWe}=F8(),l1e=class{constructor({libp2p:e,maxListeners:t=1,onError:i}){this._libp2p=e,this._peerId=e.peerId,this._peerStore=e.peerStore,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._addressSorter=e.dialer.addressSorter,this.maxListeners=t,this._listenRelays=new Set,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this._peerStore.on("change:protocols",this._onProtocolChange),this._connectionManager.on("peer:disconnect",this._onPeerDisconnected),this._onError=(n,s)=>{PP.error(s||n),i&&i(n,s)}}async _onProtocolChange({peerId:e,protocols:t}){let i=e.toB58String(),n=t.find(s=>s===zWe);if(!n&&this._listenRelays.has(i)){await this._removeListenRelay(i);return}else if(!n||this._listenRelays.has(i))return;try{let s=this._connectionManager.get(e);if(!s)return;if(s.remoteAddr.protoCodes().includes(GWe)){PP(`relayed connection to ${i} will not be used to hop on`);return}await HWe({connection:s})&&(await this._peerStore.metadataBook.setValue(e,c1e,UWe(u1e)),await this._addListenRelay(s,i))}catch(s){this._onError(s)}}_onPeerDisconnected(e){let i=e.remotePeer.toB58String();!this._listenRelays.has(i)||this._removeListenRelay(i).catch(n=>{PP.error(n)})}async _addListenRelay(e,t){try{if(this._listenRelays.size>=this.maxListeners)return;let i=await this._peerStore.addressBook.getMultiaddrsForPeer(e.remotePeer,this._addressSorter);(await Promise.all(i.map(async s=>{try{return await this._transportManager.listen([new KWe(`${s.toString()}/p2p-circuit`)]),!0}catch(o){this._onError(o)}return!1}))).includes(!0)&&this._listenRelays.add(t)}catch(i){this._onError(i),this._listenRelays.delete(t)}}async _removeListenRelay(e){this._listenRelays.delete(e)&&await this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this._listenRelays.size>=this.maxListeners)return;let t=[],i=await VWe(this._peerStore.getPeers());for await(let{id:n,metadata:s}of i){let o=n.toB58String();if(this._listenRelays.has(o)||e.includes(o))continue;let a=s.get(c1e);if(!a||FWe(a)!==u1e)continue;let c=this._connectionManager.get(n);if(!c){t.push(n);continue}if(await this._addListenRelay(c,o),this._listenRelays.size>=this.maxListeners)return}for(let n of t)if(await this._tryToListenOnRelay(n),this._listenRelays.size>=this.maxListeners)return;try{let n=await $We(WWe);for await(let s of this._libp2p.contentRouting.findProviders(n)){if(!s.multiaddrs.length)continue;let o=s.id;if(await this._peerStore.addressBook.add(o,s.multiaddrs),await this._tryToListenOnRelay(o),this._listenRelays.size>=this.maxListeners)return}}catch(n){this._onError(n)}}async _tryToListenOnRelay(e){try{let t=await this._libp2p.dial(e);await this._addListenRelay(t,e.toB58String())}catch(t){this._onError(t,`could not connect and listen on known hop relay ${e.toB58String()}`)}}};f1e.exports=l1e});var m1e=m((nOt,g1e)=>{f();"use strict";var h1e=le(),p1e=Object.assign(h1e("libp2p:relay"),{error:h1e("libp2p:relay:err")}),{codes:YWe}=wr(),{setDelayedInterval:XWe,clearDelayedInterval:QWe}=uP(),ZWe=d1e(),{namespaceToCid:JWe}=TP(),{RELAY_RENDEZVOUS_NS:eYe}=F8(),y1e=class{constructor(e){this._libp2p=e,this._options={...e._config.relay},this._autoRelay=this._options.autoRelay.enabled&&new ZWe({libp2p:e,...this._options.autoRelay}),this._advertiseService=this._advertiseService.bind(this)}start(){this._options.hop.enabled&&this._options.advertise.enabled&&(this._timeout=XWe(this._advertiseService,this._options.advertise.ttl,this._options.advertise.bootDelay))}stop(){QWe(this._timeout)}async _advertiseService(){try{let e=await JWe(eYe);await this._libp2p.contentRouting.provide(e)}catch(e){e.code===YWe.ERR_NO_ROUTERS_AVAILABLE?(p1e.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),this.stop()):p1e.error(e)}}};g1e.exports=y1e});var v1e=m((oOt,_1e)=>{f();var b1e=c9(),w1e=Za();_1e.exports=class{constructor(){this._buffer=new b1e,this._waitingConsumers=new b1e}push(e){let{promise:t,resolve:i}=w1e();return this._buffer.push({chunk:e,resolve:i}),this._consume(),t}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let e=this._waitingConsumers.shift(),t=this._buffer.shift();e.resolve(t.chunk),t.resolve()}}shift(){let{promise:e,resolve:t}=w1e();return this._waitingConsumers.push({resolve:t}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}});var E1e=m((aOt,OP)=>{f();"use strict";var CP=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},Um=class{static fn(e){return(...t)=>new Um((i,n,s)=>{t.push(s),e(...t).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((t,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,t(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let t of this._cancelHandlers)t()}catch(t){this._reject(t);return}this._rejectOnCancel&&this._reject(new CP(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(Um.prototype,Promise.prototype);OP.exports=Um;OP.exports.CancelError=CP});var R1e=m((cOt,W8)=>{f();"use strict";var S1e=oP(),tYe=E1e(),kP=class extends Error{},rYe=(r,e)=>new tYe((t,i,n)=>{let{count:s,filter:o=()=>!0}=e;if(!Number.isFinite(s)){i(new TypeError(`Expected a finite number, got ${typeof e.count}`));return}let a=[],c=[],u=0,l=!1,d=new Set,h=()=>(a.length===s&&(t(a),l=!0),u-c.length<s&&(i(new S1e(c)),l=!0),l),p=()=>{for(let y of r)!d.has(y)&&typeof y.cancel=="function"&&y.cancel()};n(p);for(let y of r)u++,(async()=>{try{let g=await y;if(l)return;if(!o(g))throw new kP("Value does not satisfy filter");a.push(g)}catch(g){c.push(g)}finally{d.add(y),!l&&h()&&p()}})();s>u&&(i(new RangeError(`Expected input to contain at least ${e.count} items, but contains ${u} items`)),p())});W8.exports=rYe;W8.exports.AggregateError=S1e;W8.exports.FilterError=kP});var A1e=m((uOt,NP)=>{f();"use strict";var DP=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},Fm=class{static fn(e){return(...t)=>new Fm((i,n,s)=>{t.push(s),e(...t).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((t,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,t(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let t of this._cancelHandlers)t()}catch(t){this._reject(t);return}this._rejectOnCancel&&this._reject(new DP(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(Fm.prototype,Promise.prototype);NP.exports=Fm;NP.exports.CancelError=DP});var I1e=m((lOt,BP)=>{f();"use strict";var x1e=R1e(),iYe=A1e();BP.exports=(r,e)=>{let t=x1e(r,{...e,count:1});return iYe.fn(async i=>{i(()=>{t.cancel()});let[n]=await t;return n})()};BP.exports.AggregateError=x1e.AggregateError});var O1e=m((fOt,C1e)=>{f();"use strict";var nYe=br(),{anySignal:sYe}=Ho(),oYe=v1e(),aYe=I1e(),{setMaxListeners:T1e}=Ut(),{codes:cYe}=wr(),P1e=class{constructor({addrs:e,dialAction:t,dialer:i}){this.addrs=e,this.dialer=i,this.dialAction=t}async run(e={}){let t=this.dialer.getTokens(this.addrs.length);if(t.length<1)throw nYe(new Error("No dial tokens available"),cYe.ERR_NO_DIAL_TOKENS);let i=new oYe;t.forEach(o=>i.push(o));let n=this.addrs.map(()=>{let o=new AbortController;try{T1e&&T1e(1/0,o.signal)}catch{}return o}),s=0;try{return await aYe(this.addrs.map(async(o,a)=>{let c=await i.shift(),u;try{let l=n[a].signal;u=await this.dialAction(o,{...e,signal:e.signal?sYe([l,e.signal]):l}),n.splice(a,1)}finally{s++,this.addrs.length-s>=t.length?i.push(c):this.dialer.releaseToken(t.splice(t.indexOf(c),1)[0])}return u}))}finally{n.map(o=>o.abort()),t.forEach(o=>this.dialer.releaseToken(o))}}};C1e.exports=P1e});var q1e=m((dOt,j1e)=>{f();"use strict";var k1e=le(),uYe=Zo(),lYe=rs(),{pipe:fYe}=dr(),q1=Object.assign(k1e("libp2p:dialer"),{error:k1e("libp2p:dialer:err")}),Y8=br(),{Multiaddr:LP}=ft(),{TimeoutController:dYe}=Da(),{AbortError:hYe}=ua(),{anySignal:pYe}=Ho(),{setMaxListeners:D1e}=Ut(),yYe=O1e(),{publicAddressesFirst:gYe}=hP(),N1e=lP(),B1e=bh(),{codes:Km}=wr(),{DIAL_TIMEOUT:mYe,MAX_PARALLEL_DIALS:bYe,MAX_PER_PEER_DIALS:wYe,MAX_ADDRS_TO_DIAL:_Ye}=U8(),L1e="dialler",vYe="pending-dials",EYe="pending-dial-targets",M1e=class{constructor({transportManager:e,peerStore:t,connectionGater:i,addressSorter:n=gYe,maxParallelDials:s=bYe,maxAddrsToDial:o=_Ye,dialTimeout:a=mYe,maxDialsPerPeer:c=wYe,resolvers:u={},metrics:l}){this.connectionGater=i,this.transportManager=e,this.peerStore=t,this.addressSorter=n,this.maxParallelDials=s,this.maxAddrsToDial=o,this.timeout=a,this.maxDialsPerPeer=c,this.tokens=[...new Array(s)].map((d,h)=>h),this._pendingDials=B1e({component:L1e,metric:vYe,metrics:l}),this._pendingDialTargets=B1e({component:L1e,metric:EYe,metrics:l});for(let[d,h]of Object.entries(u))LP.resolvers.set(d,h)}destroy(){for(let e of this._pendingDials.values())try{e.controller.abort()}catch(t){q1.error(t)}this._pendingDials.clear();for(let e of this._pendingDialTargets.values())e.reject(new hYe("Dialer was destroyed"));this._pendingDialTargets.clear()}async connectToPeer(e,t={}){let{id:i}=N1e(e);if(await this.connectionGater.denyDialPeer(i))throw Y8(new Error("The dial request is blocked by gater.allowDialPeer"),Km.ERR_PEER_DIAL_INTERCEPTED);let n=await this._createCancellableDialTarget(e);if(!n.addrs.length)throw Y8(new Error("The dial request has no valid addresses"),Km.ERR_NO_VALID_ADDRESSES);let s=this._pendingDials.get(n.id)||this._createPendingDial(n,t);try{let o=await s.promise;return q1("dial succeeded to %s",n.id),o}catch(o){throw s.controller.signal.aborted&&(o.code=Km.ERR_TIMEOUT),q1.error(o),o}finally{s.destroy()}}async _createCancellableDialTarget(e){let t=`${parseInt(String(Math.random()*1e9),10).toString()+Date.now()}`,i=new Promise((n,s)=>{this._pendingDialTargets.set(t,{resolve:n,reject:s})});try{return await Promise.race([this._createDialTarget(e),i])}finally{this._pendingDialTargets.delete(t)}}async _createDialTarget(e){let{id:t,multiaddrs:i}=N1e(e);i&&await this.peerStore.addressBook.add(t,i);let n=await fYe(await this.peerStore.addressBook.getMultiaddrsForPeer(t,this.addressSorter),a=>lYe(a,async c=>!await this.connectionGater.denyDialMultiaddr(t,c)),a=>uYe(a));LP.isMultiaddr(e)&&(n=n.filter(a=>!e.equals(a)),n.unshift(e));let s=[];for(let a of n)(await this._resolve(a)).forEach(u=>s.push(u));let o=s.filter(a=>this.transportManager.transportForMultiaddr(a));if(o.length>this.maxAddrsToDial)throw await this.peerStore.delete(t),Y8(new Error("dial with more addresses than allowed"),Km.ERR_TOO_MANY_ADDRESSES);return{id:t.toB58String(),addrs:o}}_createPendingDial(e,t={}){let i=(u,l)=>{if(l.signal.aborted)throw Y8(new Error("already aborted"),Km.ERR_ALREADY_ABORTED);return this.transportManager.dial(u,l)},n=new yYe({addrs:e.addrs,dialAction:i,dialer:this}),s=new dYe(this.timeout),o=[s.signal];t.signal&&o.push(t.signal);let a=pYe(o);try{D1e&&D1e(1/0,a)}catch{}let c={dialRequest:n,controller:s,promise:n.run({...t,signal:a}),destroy:()=>{s.clear(),this._pendingDials.delete(e.id)}};return this._pendingDials.set(e.id,c),c}getTokens(e){let t=Math.min(e,this.maxDialsPerPeer,this.tokens.length),i=this.tokens.splice(0,t);return q1("%d tokens request, returning %d, %d remaining",e,t,this.tokens.length),i}releaseToken(e){this.tokens.indexOf(e)>-1||(q1("token %d released",e),this.tokens.push(e))}async _resolve(e){if(!e.protoNames().includes("dnsaddr"))return[e];let i=await this._resolveRecord(e);return(await Promise.all(i.map(o=>this._resolve(o)))).flat().reduce((o,a)=>(o.find(c=>c.equals(a))||o.push(a),o),[])}async _resolveRecord(e){try{return e=new LP(e.toString()),await e.resolve()}catch(t){return q1.error(`multiaddr ${e} could not be resolved`),[]}}};j1e.exports=M1e});var F1e=m((hOt,U1e)=>{f();"use strict";function SYe(r){return r>=55296&&r<=56319}function RYe(r){return r>=56320&&r<=57343}U1e.exports=function(e,t,i){if(typeof t!="string")throw new Error("Input must be string");for(var n=t.length,s=0,o,a,c=0;c<n;c+=1){if(o=t.charCodeAt(c),a=t[c],SYe(o)&&RYe(t.charCodeAt(c+1))&&(c+=1,a+=t[c]),s+=e(a),s===i)return t.slice(0,c+1);if(s>i)return t.slice(0,c-a.length+1)}return t}});var V1e=m((pOt,K1e)=>{f();"use strict";function AYe(r){return r>=55296&&r<=56319}function xYe(r){return r>=56320&&r<=57343}K1e.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var t=e.length,i=0,n=null,s=null,o=0;o<t;o++)n=e.charCodeAt(o),xYe(n)?s!=null&&AYe(s)?i+=1:i+=3:n<=127?i+=1:n>=128&&n<=2047?i+=2:n>=2048&&n<=65535&&(i+=3),s=n;return i}});var H1e=m((yOt,z1e)=>{f();"use strict";var IYe=F1e(),TYe=V1e();z1e.exports=IYe.bind(null,TYe)});var W1e=m((gOt,G1e)=>{f();"use strict";var PYe=H1e(),CYe=/[\/\?<>\\:\*\|"]/g,OYe=/[\x00-\x1f\x80-\x9f]/g,kYe=/^\.+$/,DYe=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,NYe=/[\. ]+$/;function $1e(r,e){if(typeof r!="string")throw new Error("Input must be string");var t=r.replace(CYe,e).replace(OYe,e).replace(kYe,e).replace(DYe,e).replace(NYe,e);return PYe(t,255)}G1e.exports=function(r,e){var t=e&&e.replacement||"",i=$1e(r,t);return t===""?i:$1e(i,"")}});var Z1e=m((mOt,Q1e)=>{f();var U1=Rt();ul();vr();var Oe=U1.asn1,F1=Q1e.exports=U1.pkcs7asn1=U1.pkcs7asn1||{};U1.pkcs7=U1.pkcs7||{};U1.pkcs7.asn1=F1;var Y1e={name:"ContentInfo",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:Oe.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};F1.contentInfoValidator=Y1e;var X1e={name:"EncryptedContentInfo",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:Oe.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:Oe.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};F1.envelopedDataValidator={name:"EnvelopedData",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(X1e)};F1.encryptedDataValidator={name:"EncryptedData",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.INTEGER,constructed:!1,capture:"version"}].concat(X1e)};var BYe={name:"SignerInfo",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:Oe.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:Oe.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:Oe.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};F1.signedDataValidator={name:"SignedData",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},Y1e,{name:"SignedData.Certificates",tagClass:Oe.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:Oe.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SET,capture:"signerInfos",optional:!0,value:[BYe]}]};F1.recipientInfoValidator={name:"RecipientInfo",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:Oe.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var eye=m((bOt,J1e)=>{f();var vh=Rt();vr();vh.mgf=vh.mgf||{};var LYe=J1e.exports=vh.mgf.mgf1=vh.mgf1=vh.mgf1||{};LYe.create=function(r){var e={generate:function(t,i){for(var n=new vh.util.ByteBuffer,s=Math.ceil(i/r.digestLength),o=0;o<s;o++){var a=new vh.util.ByteBuffer;a.putInt32(o),r.start(),r.update(t+a.getBytes()),n.putBuffer(r.digest())}return n.truncate(n.length()-i),n.getBytes()}};return e}});var rye=m((wOt,tye)=>{f();var X8=Rt();eye();tye.exports=X8.mgf=X8.mgf||{};X8.mgf.mgf1=X8.mgf1});var nye=m((_Ot,iye)=>{f();var Eh=Rt();$f();vr();var MYe=iye.exports=Eh.pss=Eh.pss||{};MYe.create=function(r){arguments.length===3&&(r={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=r.md,t=r.mgf,i=e.digestLength,n=r.salt||null;typeof n=="string"&&(n=Eh.util.createBuffer(n));var s;if("saltLength"in r)s=r.saltLength;else if(n!==null)s=n.length();else throw new Error("Salt length not specified or specific salt not given.");if(n!==null&&n.length()!==s)throw new Error("Given salt length does not match length of given salt.");var o=r.prng||Eh.random,a={};return a.encode=function(c,u){var l,d=u-1,h=Math.ceil(d/8),p=c.digest().getBytes();if(h<i+s+2)throw new Error("Message is too long to encrypt.");var y;n===null?y=o.getBytesSync(s):y=n.bytes();var g=new Eh.util.ByteBuffer;g.fillWithByte(0,8),g.putBytes(p),g.putBytes(y),e.start(),e.update(g.getBytes());var w=e.digest().getBytes(),b=new Eh.util.ByteBuffer;b.fillWithByte(0,h-s-i-2),b.putByte(1),b.putBytes(y);var v=b.getBytes(),A=h-i-1,k=t.generate(w,A),C="";for(l=0;l<A;l++)C+=String.fromCharCode(v.charCodeAt(l)^k.charCodeAt(l));var T=65280>>8*h-d&255;return C=String.fromCharCode(C.charCodeAt(0)&~T)+C.substr(1),C+w+String.fromCharCode(188)},a.verify=function(c,u,l){var d,h=l-1,p=Math.ceil(h/8);if(u=u.substr(-p),p<i+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(p-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var y=p-i-1,g=u.substr(0,y),w=u.substr(y,i),b=65280>>8*p-h&255;if((g.charCodeAt(0)&b)!=0)throw new Error("Bits beyond keysize not zero as expected.");var v=t.generate(w,y),A="";for(d=0;d<y;d++)A+=String.fromCharCode(g.charCodeAt(d)^v.charCodeAt(d));A=String.fromCharCode(A.charCodeAt(0)&~b)+A.substr(1);var k=p-i-s-2;for(d=0;d<k;d++)if(A.charCodeAt(d)!==0)throw new Error("Leftmost octets not zero as expected");if(A.charCodeAt(k)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var C=A.substr(-s),T=new Eh.util.ByteBuffer;T.fillWithByte(0,8),T.putBytes(c),T.putBytes(C),e.start(),e.update(T.getBytes());var D=e.digest().getBytes();return w===D},a}});var jP=m((vOt,uye)=>{f();var et=Rt();Ap();ul();S4();ll();rye();Ep();I4();nye();Gy();vr();var S=et.asn1,ve=uye.exports=et.pki=et.pki||{},Ft=ve.oids,ai={};ai.CN=Ft.commonName;ai.commonName="CN";ai.C=Ft.countryName;ai.countryName="C";ai.L=Ft.localityName;ai.localityName="L";ai.ST=Ft.stateOrProvinceName;ai.stateOrProvinceName="ST";ai.O=Ft.organizationName;ai.organizationName="O";ai.OU=Ft.organizationalUnitName;ai.organizationalUnitName="OU";ai.E=Ft.emailAddress;ai.emailAddress="E";var sye=et.pki.rsa.publicKeyValidator,jYe={name:"Certificate",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:S.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:S.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:S.Class.UNIVERSAL,type:S.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:S.Class.UNIVERSAL,type:S.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:S.Class.UNIVERSAL,type:S.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:S.Class.UNIVERSAL,type:S.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},sye,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:S.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:S.Class.UNIVERSAL,type:S.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:S.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:S.Class.UNIVERSAL,type:S.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:S.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:S.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:S.Class.UNIVERSAL,type:S.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},qYe={name:"rsapss",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:S.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:S.Class.UNIVERSAL,type:S.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:S.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:S.Class.UNIVERSAL,type:S.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:S.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:S.Class.UNIVERSAL,type:S.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:S.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:S.Class.UNIVERSAL,type:S.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},UYe={name:"CertificationRequestInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},sye,{name:"CertificationRequestInfo.attributes",tagClass:S.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:S.Class.UNIVERSAL,type:S.Type.SET,constructed:!0}]}]}]},FYe={name:"CertificationRequest",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[UYe,{name:"CertificationRequest.signatureAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:S.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:S.Class.UNIVERSAL,type:S.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};ve.RDNAttributesAsArray=function(r,e){for(var t=[],i,n,s,o=0;o<r.value.length;++o){i=r.value[o];for(var a=0;a<i.value.length;++a)s={},n=i.value[a],s.type=S.derToOid(n.value[0].value),s.value=n.value[1].value,s.valueTagClass=n.value[1].type,s.type in Ft&&(s.name=Ft[s.type],s.name in ai&&(s.shortName=ai[s.name])),e&&(e.update(s.type),e.update(s.value)),t.push(s)}return t};ve.CRIAttributesAsArray=function(r){for(var e=[],t=0;t<r.length;++t)for(var i=r[t],n=S.derToOid(i.value[0].value),s=i.value[1].value,o=0;o<s.length;++o){var a={};if(a.type=n,a.value=s[o].value,a.valueTagClass=s[o].type,a.type in Ft&&(a.name=Ft[a.type],a.name in ai&&(a.shortName=ai[a.name])),a.type===Ft.extensionRequest){a.extensions=[];for(var c=0;c<a.value.length;++c)a.extensions.push(ve.certificateExtensionFromAsn1(a.value[c]))}e.push(a)}return e};function Sf(r,e){typeof e=="string"&&(e={shortName:e});for(var t=null,i,n=0;t===null&&n<r.attributes.length;++n)i=r.attributes[n],(e.type&&e.type===i.type||e.name&&e.name===i.name||e.shortName&&e.shortName===i.shortName)&&(t=i);return t}var Q8=function(r,e,t){var i={};if(r!==Ft["RSASSA-PSS"])return i;t&&(i={hash:{algorithmOid:Ft.sha1},mgf:{algorithmOid:Ft.mgf1,hash:{algorithmOid:Ft.sha1}},saltLength:20});var n={},s=[];if(!S.validate(e,qYe,n,s)){var o=new Error("Cannot read RSASSA-PSS parameter block.");throw o.errors=s,o}return n.hashOid!==void 0&&(i.hash=i.hash||{},i.hash.algorithmOid=S.derToOid(n.hashOid)),n.maskGenOid!==void 0&&(i.mgf=i.mgf||{},i.mgf.algorithmOid=S.derToOid(n.maskGenOid),i.mgf.hash=i.mgf.hash||{},i.mgf.hash.algorithmOid=S.derToOid(n.maskGenHashOid)),n.saltLength!==void 0&&(i.saltLength=n.saltLength.charCodeAt(0)),i},Z8=function(r){switch(Ft[r.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return et.md.sha1.create();case"md5WithRSAEncryption":return et.md.md5.create();case"sha256WithRSAEncryption":return et.md.sha256.create();case"sha384WithRSAEncryption":return et.md.sha384.create();case"sha512WithRSAEncryption":return et.md.sha512.create();case"RSASSA-PSS":return et.md.sha256.create();default:var e=new Error("Could not compute "+r.type+" digest. Unknown signature OID.");throw e.signatureOid=r.signatureOid,e}},oye=function(r){var e=r.certificate,t;switch(e.signatureOid){case Ft.sha1WithRSAEncryption:case Ft.sha1WithRSASignature:break;case Ft["RSASSA-PSS"]:var i,n;if(i=Ft[e.signatureParameters.mgf.hash.algorithmOid],i===void 0||et.md[i]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=i,s}if(n=Ft[e.signatureParameters.mgf.algorithmOid],n===void 0||et.mgf[n]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=n,s}if(n=et.mgf[n].create(et.md[i].create()),i=Ft[e.signatureParameters.hash.algorithmOid],i===void 0||et.md[i]===void 0){var s=new Error("Unsupported RSASSA-PSS hash function.");throw s.oid=e.signatureParameters.hash.algorithmOid,s.name=i,s}t=et.pss.create(et.md[i].create(),n,e.signatureParameters.saltLength);break}return e.publicKey.verify(r.md.digest().getBytes(),r.signature,t)};ve.certificateFromPem=function(r,e,t){var i=et.pem.decode(r)[0];if(i.type!=="CERTIFICATE"&&i.type!=="X509 CERTIFICATE"&&i.type!=="TRUSTED CERTIFICATE"){var n=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=S.fromDer(i.body,t);return ve.certificateFromAsn1(s,e)};ve.certificateToPem=function(r,e){var t={type:"CERTIFICATE",body:S.toDer(ve.certificateToAsn1(r)).getBytes()};return et.pem.encode(t,{maxline:e})};ve.publicKeyFromPem=function(r){var e=et.pem.decode(r)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var t=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var i=S.fromDer(e.body);return ve.publicKeyFromAsn1(i)};ve.publicKeyToPem=function(r,e){var t={type:"PUBLIC KEY",body:S.toDer(ve.publicKeyToAsn1(r)).getBytes()};return et.pem.encode(t,{maxline:e})};ve.publicKeyToRSAPublicKeyPem=function(r,e){var t={type:"RSA PUBLIC KEY",body:S.toDer(ve.publicKeyToRSAPublicKey(r)).getBytes()};return et.pem.encode(t,{maxline:e})};ve.getPublicKeyFingerprint=function(r,e){e=e||{};var t=e.md||et.md.sha1.create(),i=e.type||"RSAPublicKey",n;switch(i){case"RSAPublicKey":n=S.toDer(ve.publicKeyToRSAPublicKey(r)).getBytes();break;case"SubjectPublicKeyInfo":n=S.toDer(ve.publicKeyToAsn1(r)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}t.start(),t.update(n);var s=t.digest();if(e.encoding==="hex"){var o=s.toHex();return e.delimiter?o.match(/.{2}/g).join(e.delimiter):o}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};ve.certificationRequestFromPem=function(r,e,t){var i=et.pem.decode(r)[0];if(i.type!=="CERTIFICATE REQUEST"){var n=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=S.fromDer(i.body,t);return ve.certificationRequestFromAsn1(s,e)};ve.certificationRequestToPem=function(r,e){var t={type:"CERTIFICATE REQUEST",body:S.toDer(ve.certificationRequestToAsn1(r)).getBytes()};return et.pem.encode(t,{maxline:e})};ve.createCertificate=function(){var r={};return r.version=2,r.serialNumber="00",r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.validity={},r.validity.notBefore=new Date,r.validity.notAfter=new Date,r.issuer={},r.issuer.getField=function(e){return Sf(r.issuer,e)},r.issuer.addField=function(e){Co([e]),r.issuer.attributes.push(e)},r.issuer.attributes=[],r.issuer.hash=null,r.subject={},r.subject.getField=function(e){return Sf(r.subject,e)},r.subject.addField=function(e){Co([e]),r.subject.attributes.push(e)},r.subject.attributes=[],r.subject.hash=null,r.extensions=[],r.publicKey=null,r.md=null,r.setSubject=function(e,t){Co(e),r.subject.attributes=e,delete r.subject.uniqueId,t&&(r.subject.uniqueId=t),r.subject.hash=null},r.setIssuer=function(e,t){Co(e),r.issuer.attributes=e,delete r.issuer.uniqueId,t&&(r.issuer.uniqueId=t),r.issuer.hash=null},r.setExtensions=function(e){for(var t=0;t<e.length;++t)aye(e[t],{cert:r});r.extensions=e},r.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var t=null,i,n=0;t===null&&n<r.extensions.length;++n)i=r.extensions[n],(e.id&&i.id===e.id||e.name&&i.name===e.name)&&(t=i);return t},r.sign=function(e,t){r.md=t||et.md.sha1.create();var i=Ft[r.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw n.algorithm=r.md.algorithm,n}r.signatureOid=r.siginfo.algorithmOid=i,r.tbsCertificate=ve.getTBSCertificate(r);var s=S.toDer(r.tbsCertificate);r.md.update(s.getBytes()),r.signature=e.sign(r.md)},r.verify=function(e){var t=!1;if(!r.issued(e)){var i=e.issuer,n=r.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=n.attributes,s.actualIssuer=i.attributes,s}var o=e.md;if(o===null){o=Z8({signatureOid:e.signatureOid,type:"certificate"});var a=e.tbsCertificate||ve.getTBSCertificate(e),c=S.toDer(a);o.update(c.getBytes())}return o!==null&&(t=oye({certificate:r,md:o,signature:e.signature})),t},r.isIssuer=function(e){var t=!1,i=r.issuer,n=e.subject;if(i.hash&&n.hash)t=i.hash===n.hash;else if(i.attributes.length===n.attributes.length){t=!0;for(var s,o,a=0;t&&a<i.attributes.length;++a)s=i.attributes[a],o=n.attributes[a],(s.type!==o.type||s.value!==o.value)&&(t=!1)}return t},r.issued=function(e){return e.isIssuer(r)},r.generateSubjectKeyIdentifier=function(){return ve.getPublicKeyFingerprint(r.publicKey,{type:"RSAPublicKey"})},r.verifySubjectKeyIdentifier=function(){for(var e=Ft.subjectKeyIdentifier,t=0;t<r.extensions.length;++t){var i=r.extensions[t];if(i.id===e){var n=r.generateSubjectKeyIdentifier().getBytes();return et.util.hexToBytes(i.subjectKeyIdentifier)===n}}return!1},r};ve.certificateFromAsn1=function(r,e){var t={},i=[];if(!S.validate(r,jYe,t,i)){var n=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw n.errors=i,n}var s=S.derToOid(t.publicKeyOid);if(s!==ve.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=ve.createCertificate();o.version=t.certVersion?t.certVersion.charCodeAt(0):0;var a=et.util.createBuffer(t.certSerialNumber);o.serialNumber=a.toHex(),o.signatureOid=et.asn1.derToOid(t.certSignatureOid),o.signatureParameters=Q8(o.signatureOid,t.certSignatureParams,!0),o.siginfo.algorithmOid=et.asn1.derToOid(t.certinfoSignatureOid),o.siginfo.parameters=Q8(o.siginfo.algorithmOid,t.certinfoSignatureParams,!1),o.signature=t.certSignature;var c=[];if(t.certValidity1UTCTime!==void 0&&c.push(S.utcTimeToDate(t.certValidity1UTCTime)),t.certValidity2GeneralizedTime!==void 0&&c.push(S.generalizedTimeToDate(t.certValidity2GeneralizedTime)),t.certValidity3UTCTime!==void 0&&c.push(S.utcTimeToDate(t.certValidity3UTCTime)),t.certValidity4GeneralizedTime!==void 0&&c.push(S.generalizedTimeToDate(t.certValidity4GeneralizedTime)),c.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(c.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(o.validity.notBefore=c[0],o.validity.notAfter=c[1],o.tbsCertificate=t.tbsCertificate,e){o.md=Z8({signatureOid:o.signatureOid,type:"certificate"});var u=S.toDer(o.tbsCertificate);o.md.update(u.getBytes())}var l=et.md.sha1.create(),d=S.toDer(t.certIssuer);l.update(d.getBytes()),o.issuer.getField=function(y){return Sf(o.issuer,y)},o.issuer.addField=function(y){Co([y]),o.issuer.attributes.push(y)},o.issuer.attributes=ve.RDNAttributesAsArray(t.certIssuer),t.certIssuerUniqueId&&(o.issuer.uniqueId=t.certIssuerUniqueId),o.issuer.hash=l.digest().toHex();var h=et.md.sha1.create(),p=S.toDer(t.certSubject);return h.update(p.getBytes()),o.subject.getField=function(y){return Sf(o.subject,y)},o.subject.addField=function(y){Co([y]),o.subject.attributes.push(y)},o.subject.attributes=ve.RDNAttributesAsArray(t.certSubject),t.certSubjectUniqueId&&(o.subject.uniqueId=t.certSubjectUniqueId),o.subject.hash=h.digest().toHex(),t.certExtensions?o.extensions=ve.certificateExtensionsFromAsn1(t.certExtensions):o.extensions=[],o.publicKey=ve.publicKeyFromAsn1(t.subjectPublicKeyInfo),o};ve.certificateExtensionsFromAsn1=function(r){for(var e=[],t=0;t<r.value.length;++t)for(var i=r.value[t],n=0;n<i.value.length;++n)e.push(ve.certificateExtensionFromAsn1(i.value[n]));return e};ve.certificateExtensionFromAsn1=function(r){var e={};if(e.id=S.derToOid(r.value[0].value),e.critical=!1,r.value[1].type===S.Type.BOOLEAN?(e.critical=r.value[1].value.charCodeAt(0)!==0,e.value=r.value[2].value):e.value=r.value[1].value,e.id in Ft){if(e.name=Ft[e.id],e.name==="keyUsage"){var t=S.fromDer(e.value),i=0,n=0;t.value.length>1&&(i=t.value.charCodeAt(1),n=t.value.length>2?t.value.charCodeAt(2):0),e.digitalSignature=(i&128)==128,e.nonRepudiation=(i&64)==64,e.keyEncipherment=(i&32)==32,e.dataEncipherment=(i&16)==16,e.keyAgreement=(i&8)==8,e.keyCertSign=(i&4)==4,e.cRLSign=(i&2)==2,e.encipherOnly=(i&1)==1,e.decipherOnly=(n&128)==128}else if(e.name==="basicConstraints"){var t=S.fromDer(e.value);t.value.length>0&&t.value[0].type===S.Type.BOOLEAN?e.cA=t.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;t.value.length>0&&t.value[0].type===S.Type.INTEGER?s=t.value[0].value:t.value.length>1&&(s=t.value[1].value),s!==null&&(e.pathLenConstraint=S.derToInteger(s))}else if(e.name==="extKeyUsage")for(var t=S.fromDer(e.value),o=0;o<t.value.length;++o){var a=S.derToOid(t.value[o].value);a in Ft?e[Ft[a]]=!0:e[a]=!0}else if(e.name==="nsCertType"){var t=S.fromDer(e.value),i=0;t.value.length>1&&(i=t.value.charCodeAt(1)),e.client=(i&128)==128,e.server=(i&64)==64,e.email=(i&32)==32,e.objsign=(i&16)==16,e.reserved=(i&8)==8,e.sslCA=(i&4)==4,e.emailCA=(i&2)==2,e.objCA=(i&1)==1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var c,t=S.fromDer(e.value),u=0;u<t.value.length;++u){c=t.value[u];var l={type:c.type,value:c.value};switch(e.altNames.push(l),c.type){case 1:case 2:case 6:break;case 7:l.ip=et.util.bytesToIP(c.value);break;case 8:l.oid=S.derToOid(c.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var t=S.fromDer(e.value);e.subjectKeyIdentifier=et.util.bytesToHex(t.value)}}return e};ve.certificationRequestFromAsn1=function(r,e){var t={},i=[];if(!S.validate(r,FYe,t,i)){var n=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw n.errors=i,n}var s=S.derToOid(t.publicKeyOid);if(s!==ve.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=ve.createCertificationRequest();if(o.version=t.csrVersion?t.csrVersion.charCodeAt(0):0,o.signatureOid=et.asn1.derToOid(t.csrSignatureOid),o.signatureParameters=Q8(o.signatureOid,t.csrSignatureParams,!0),o.siginfo.algorithmOid=et.asn1.derToOid(t.csrSignatureOid),o.siginfo.parameters=Q8(o.siginfo.algorithmOid,t.csrSignatureParams,!1),o.signature=t.csrSignature,o.certificationRequestInfo=t.certificationRequestInfo,e){o.md=Z8({signatureOid:o.signatureOid,type:"certification request"});var a=S.toDer(o.certificationRequestInfo);o.md.update(a.getBytes())}var c=et.md.sha1.create();return o.subject.getField=function(u){return Sf(o.subject,u)},o.subject.addField=function(u){Co([u]),o.subject.attributes.push(u)},o.subject.attributes=ve.RDNAttributesAsArray(t.certificationRequestInfoSubject,c),o.subject.hash=c.digest().toHex(),o.publicKey=ve.publicKeyFromAsn1(t.subjectPublicKeyInfo),o.getAttribute=function(u){return Sf(o,u)},o.addAttribute=function(u){Co([u]),o.attributes.push(u)},o.attributes=ve.CRIAttributesAsArray(t.certificationRequestInfoAttributes||[]),o};ve.createCertificationRequest=function(){var r={};return r.version=0,r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.subject={},r.subject.getField=function(e){return Sf(r.subject,e)},r.subject.addField=function(e){Co([e]),r.subject.attributes.push(e)},r.subject.attributes=[],r.subject.hash=null,r.publicKey=null,r.attributes=[],r.getAttribute=function(e){return Sf(r,e)},r.addAttribute=function(e){Co([e]),r.attributes.push(e)},r.md=null,r.setSubject=function(e){Co(e),r.subject.attributes=e,r.subject.hash=null},r.setAttributes=function(e){Co(e),r.attributes=e},r.sign=function(e,t){r.md=t||et.md.sha1.create();var i=Ft[r.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw n.algorithm=r.md.algorithm,n}r.signatureOid=r.siginfo.algorithmOid=i,r.certificationRequestInfo=ve.getCertificationRequestInfo(r);var s=S.toDer(r.certificationRequestInfo);r.md.update(s.getBytes()),r.signature=e.sign(r.md)},r.verify=function(){var e=!1,t=r.md;if(t===null){t=Z8({signatureOid:r.signatureOid,type:"certification request"});var i=r.certificationRequestInfo||ve.getCertificationRequestInfo(r),n=S.toDer(i);t.update(n.getBytes())}return t!==null&&(e=oye({certificate:r,md:t,signature:r.signature})),e},r};function K1(r){for(var e=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]),t,i,n=r.attributes,s=0;s<n.length;++s){t=n[s];var o=t.value,a=S.Type.PRINTABLESTRING;"valueTagClass"in t&&(a=t.valueTagClass,a===S.Type.UTF8&&(o=et.util.encodeUtf8(o))),i=S.create(S.Class.UNIVERSAL,S.Type.SET,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(t.type).getBytes()),S.create(S.Class.UNIVERSAL,a,!1,o)])]),e.value.push(i)}return e}function Co(r){for(var e,t=0;t<r.length;++t){if(e=r[t],typeof e.name=="undefined"&&(e.type&&e.type in ve.oids?e.name=ve.oids[e.type]:e.shortName&&e.shortName in ai&&(e.name=ve.oids[ai[e.shortName]])),typeof e.type=="undefined")if(e.name&&e.name in ve.oids)e.type=ve.oids[e.name];else{var i=new Error("Attribute type not specified.");throw i.attribute=e,i}if(typeof e.shortName=="undefined"&&e.name&&e.name in ai&&(e.shortName=ai[e.name]),e.type===Ft.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=S.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var n=0;n<e.extensions.length;++n)e.value.push(ve.certificateExtensionToAsn1(aye(e.extensions[n])))}if(typeof e.value=="undefined"){var i=new Error("Attribute value not specified.");throw i.attribute=e,i}}}function aye(r,e){if(e=e||{},typeof r.name=="undefined"&&r.id&&r.id in ve.oids&&(r.name=ve.oids[r.id]),typeof r.id=="undefined")if(r.name&&r.name in ve.oids)r.id=ve.oids[r.name];else{var t=new Error("Extension ID not specified.");throw t.extension=r,t}if(typeof r.value!="undefined")return r;if(r.name==="keyUsage"){var i=0,n=0,s=0;r.digitalSignature&&(n|=128,i=7),r.nonRepudiation&&(n|=64,i=6),r.keyEncipherment&&(n|=32,i=5),r.dataEncipherment&&(n|=16,i=4),r.keyAgreement&&(n|=8,i=3),r.keyCertSign&&(n|=4,i=2),r.cRLSign&&(n|=2,i=1),r.encipherOnly&&(n|=1,i=0),r.decipherOnly&&(s|=128,i=7);var o=String.fromCharCode(i);s!==0?o+=String.fromCharCode(n)+String.fromCharCode(s):n!==0&&(o+=String.fromCharCode(n)),r.value=S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,o)}else if(r.name==="basicConstraints")r.value=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]),r.cA&&r.value.value.push(S.create(S.Class.UNIVERSAL,S.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in r&&r.value.value.push(S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(r.pathLenConstraint).getBytes()));else if(r.name==="extKeyUsage"){r.value=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);var a=r.value.value;for(var c in r)r[c]===!0&&(c in Ft?a.push(S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Ft[c]).getBytes())):c.indexOf(".")!==-1&&a.push(S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(c).getBytes())))}else if(r.name==="nsCertType"){var i=0,n=0;r.client&&(n|=128,i=7),r.server&&(n|=64,i=6),r.email&&(n|=32,i=5),r.objsign&&(n|=16,i=4),r.reserved&&(n|=8,i=3),r.sslCA&&(n|=4,i=2),r.emailCA&&(n|=2,i=1),r.objCA&&(n|=1,i=0);var o=String.fromCharCode(i);n!==0&&(o+=String.fromCharCode(n)),r.value=S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,o)}else if(r.name==="subjectAltName"||r.name==="issuerAltName"){r.value=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);for(var u,l=0;l<r.altNames.length;++l){u=r.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=et.util.bytesFromIP(u.ip),o===null){var t=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw t.extension=r,t}}else u.type===8&&(u.oid?o=S.oidToDer(S.oidToDer(u.oid)):o=S.oidToDer(o));r.value.value.push(S.create(S.Class.CONTEXT_SPECIFIC,u.type,!1,o))}}else if(r.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(r.comment)||r.comment.length<1||r.comment.length>128)throw new Error('Invalid "nsComment" content.');r.value=S.create(S.Class.UNIVERSAL,S.Type.IA5STRING,!1,r.comment)}else if(r.name==="subjectKeyIdentifier"&&e.cert){var d=e.cert.generateSubjectKeyIdentifier();r.subjectKeyIdentifier=d.toHex(),r.value=S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,d.getBytes())}else if(r.name==="authorityKeyIdentifier"&&e.cert){r.value=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);var a=r.value.value;if(r.keyIdentifier){var h=r.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():r.keyIdentifier;a.push(S.create(S.Class.CONTEXT_SPECIFIC,0,!1,h))}if(r.authorityCertIssuer){var p=[S.create(S.Class.CONTEXT_SPECIFIC,4,!0,[K1(r.authorityCertIssuer===!0?e.cert.issuer:r.authorityCertIssuer)])];a.push(S.create(S.Class.CONTEXT_SPECIFIC,1,!0,p))}if(r.serialNumber){var y=et.util.hexToBytes(r.serialNumber===!0?e.cert.serialNumber:r.serialNumber);a.push(S.create(S.Class.CONTEXT_SPECIFIC,2,!1,y))}}else if(r.name==="cRLDistributionPoints"){r.value=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);for(var a=r.value.value,g=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]),w=S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[]),u,l=0;l<r.altNames.length;++l){u=r.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=et.util.bytesFromIP(u.ip),o===null){var t=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw t.extension=r,t}}else u.type===8&&(u.oid?o=S.oidToDer(S.oidToDer(u.oid)):o=S.oidToDer(o));w.value.push(S.create(S.Class.CONTEXT_SPECIFIC,u.type,!1,o))}g.value.push(S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[w])),a.push(g)}if(typeof r.value=="undefined"){var t=new Error("Extension value not specified.");throw t.extension=r,t}return r}function MP(r,e){switch(r){case Ft["RSASSA-PSS"]:var t=[];return e.hash.algorithmOid!==void 0&&t.push(S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(e.hash.algorithmOid).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&t.push(S.create(S.Class.CONTEXT_SPECIFIC,1,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(e.mgf.algorithmOid).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(e.mgf.hash.algorithmOid).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&t.push(S.create(S.Class.CONTEXT_SPECIFIC,2,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(e.saltLength).getBytes())])),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,t);default:return S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")}}function KYe(r){var e=S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[]);if(r.attributes.length===0)return e;for(var t=r.attributes,i=0;i<t.length;++i){var n=t[i],s=n.value,o=S.Type.UTF8;"valueTagClass"in n&&(o=n.valueTagClass),o===S.Type.UTF8&&(s=et.util.encodeUtf8(s));var a=!1;"valueConstructed"in n&&(a=n.valueConstructed);var c=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(n.type).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SET,!0,[S.create(S.Class.UNIVERSAL,o,a,s)])]);e.value.push(c)}return e}var VYe=new Date("1950-01-01T00:00:00Z"),zYe=new Date("2050-01-01T00:00:00Z");function cye(r){return r>=VYe&&r<zYe?S.create(S.Class.UNIVERSAL,S.Type.UTCTIME,!1,S.dateToUtcTime(r)):S.create(S.Class.UNIVERSAL,S.Type.GENERALIZEDTIME,!1,S.dateToGeneralizedTime(r))}ve.getTBSCertificate=function(r){var e=cye(r.validity.notBefore),t=cye(r.validity.notAfter),i=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(r.version).getBytes())]),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,et.util.hexToBytes(r.serialNumber)),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(r.siginfo.algorithmOid).getBytes()),MP(r.siginfo.algorithmOid,r.siginfo.parameters)]),K1(r.issuer),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[e,t]),K1(r.subject),ve.publicKeyToAsn1(r.publicKey)]);return r.issuer.uniqueId&&i.value.push(S.create(S.Class.CONTEXT_SPECIFIC,1,!0,[S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,String.fromCharCode(0)+r.issuer.uniqueId)])),r.subject.uniqueId&&i.value.push(S.create(S.Class.CONTEXT_SPECIFIC,2,!0,[S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,String.fromCharCode(0)+r.subject.uniqueId)])),r.extensions.length>0&&i.value.push(ve.certificateExtensionsToAsn1(r.extensions)),i};ve.getCertificationRequestInfo=function(r){var e=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(r.version).getBytes()),K1(r.subject),ve.publicKeyToAsn1(r.publicKey),KYe(r)]);return e};ve.distinguishedNameToAsn1=function(r){return K1(r)};ve.certificateToAsn1=function(r){var e=r.tbsCertificate||ve.getTBSCertificate(r);return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[e,S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(r.signatureOid).getBytes()),MP(r.signatureOid,r.signatureParameters)]),S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,String.fromCharCode(0)+r.signature)])};ve.certificateExtensionsToAsn1=function(r){var e=S.create(S.Class.CONTEXT_SPECIFIC,3,!0,[]),t=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);e.value.push(t);for(var i=0;i<r.length;++i)t.value.push(ve.certificateExtensionToAsn1(r[i]));return e};ve.certificateExtensionToAsn1=function(r){var e=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);e.value.push(S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(r.id).getBytes())),r.critical&&e.value.push(S.create(S.Class.UNIVERSAL,S.Type.BOOLEAN,!1,String.fromCharCode(255)));var t=r.value;return typeof r.value!="string"&&(t=S.toDer(t).getBytes()),e.value.push(S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,t)),e};ve.certificationRequestToAsn1=function(r){var e=r.certificationRequestInfo||ve.getCertificationRequestInfo(r);return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[e,S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(r.signatureOid).getBytes()),MP(r.signatureOid,r.signatureParameters)]),S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,String.fromCharCode(0)+r.signature)])};ve.createCaStore=function(r){var e={certs:{}};e.getIssuer=function(o){var a=t(o.issuer);return a},e.addCertificate=function(o){if(typeof o=="string"&&(o=et.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))if(o.subject.hash in e.certs){var a=e.certs[o.subject.hash];et.util.isArray(a)||(a=[a]),a.push(o),e.certs[o.subject.hash]=a}else e.certs[o.subject.hash]=o},e.hasCertificate=function(o){typeof o=="string"&&(o=et.pki.certificateFromPem(o));var a=t(o.subject);if(!a)return!1;et.util.isArray(a)||(a=[a]);for(var c=S.toDer(ve.certificateToAsn1(o)).getBytes(),u=0;u<a.length;++u){var l=S.toDer(ve.certificateToAsn1(a[u])).getBytes();if(c===l)return!0}return!1},e.listAllCertificates=function(){var o=[];for(var a in e.certs)if(e.certs.hasOwnProperty(a)){var c=e.certs[a];if(!et.util.isArray(c))o.push(c);else for(var u=0;u<c.length;++u)o.push(c[u])}return o},e.removeCertificate=function(o){var a;if(typeof o=="string"&&(o=et.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))return null;var c=t(o.subject);if(!et.util.isArray(c))return a=e.certs[o.subject.hash],delete e.certs[o.subject.hash],a;for(var u=S.toDer(ve.certificateToAsn1(o)).getBytes(),l=0;l<c.length;++l){var d=S.toDer(ve.certificateToAsn1(c[l])).getBytes();u===d&&(a=c[l],c.splice(l,1))}return c.length===0&&delete e.certs[o.subject.hash],a};function t(o){return i(o),e.certs[o.hash]||null}function i(o){if(!o.hash){var a=et.md.sha1.create();o.attributes=ve.RDNAttributesAsArray(K1(o),a),o.hash=a.digest().toHex()}}if(r)for(var n=0;n<r.length;++n){var s=r[n];e.addCertificate(s)}return e};ve.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};ve.verifyCertificateChain=function(r,e,t){typeof t=="function"&&(t={verify:t}),t=t||{},e=e.slice(0);var i=e.slice(0),n=t.validityCheckDate;typeof n=="undefined"&&(n=new Date);var s=!0,o=null,a=0;do{var c=e.shift(),u=null,l=!1;if(n&&(n<c.validity.notBefore||n>c.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:ve.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:n}),o===null){if(u=e[0]||r.getIssuer(c),u===null&&c.isIssuer(c)&&(l=!0,u=c),u){var d=u;et.util.isArray(d)||(d=[d]);for(var h=!1;!h&&d.length>0;){u=d.shift();try{h=u.verify(c)}catch(C){}}h||(o={message:"Certificate signature is invalid.",error:ve.certificateError.bad_certificate})}o===null&&(!u||l)&&!r.hasCertificate(c)&&(o={message:"Certificate is not trusted.",error:ve.certificateError.unknown_ca})}if(o===null&&u&&!c.isIssuer(u)&&(o={message:"Certificate issuer is invalid.",error:ve.certificateError.bad_certificate}),o===null)for(var p={keyUsage:!0,basicConstraints:!0},y=0;o===null&&y<c.extensions.length;++y){var g=c.extensions[y];g.critical&&!(g.name in p)&&(o={message:"Certificate has an unsupported critical extension.",error:ve.certificateError.unsupported_certificate})}if(o===null&&(!s||e.length===0&&(!u||l))){var w=c.getExtension("basicConstraints"),b=c.getExtension("keyUsage");if(b!==null&&(!b.keyCertSign||w===null)&&(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:ve.certificateError.bad_certificate}),o===null&&w!==null&&!w.cA&&(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:ve.certificateError.bad_certificate}),o===null&&b!==null&&"pathLenConstraint"in w){var v=a-1;v>w.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:ve.certificateError.bad_certificate})}}var A=o===null?!0:o.error,k=t.verify?t.verify(A,a,i):A;if(k===!0)o=null;else throw A===!0&&(o={message:"The application rejected the certificate.",error:ve.certificateError.bad_certificate}),(k||k===0)&&(typeof k=="object"&&!et.util.isArray(k)?(k.message&&(o.message=k.message),k.error&&(o.error=k.error)):typeof k=="string"&&(o.error=k)),o;s=!1,++a}while(e.length>0);return!0}});var dye=m((EOt,fye)=>{f();var Ie=Rt();Ap();ul();S4();Ep();I4();Z1e();$f();vr();jP();var U=Ie.asn1,Vn=fye.exports=Ie.pkcs7=Ie.pkcs7||{};Vn.messageFromPem=function(r){var e=Ie.pem.decode(r)[0];if(e.type!=="PKCS7"){var t=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var i=U.fromDer(e.body);return Vn.messageFromAsn1(i)};Vn.messageToPem=function(r,e){var t={type:"PKCS7",body:U.toDer(r.toAsn1()).getBytes()};return Ie.pem.encode(t,{maxline:e})};Vn.messageFromAsn1=function(r){var e={},t=[];if(!U.validate(r,Vn.asn1.contentInfoValidator,e,t)){var i=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw i.errors=t,i}var n=U.derToOid(e.contentType),s;switch(n){case Ie.pki.oids.envelopedData:s=Vn.createEnvelopedData();break;case Ie.pki.oids.encryptedData:s=Vn.createEncryptedData();break;case Ie.pki.oids.signedData:s=Vn.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+n+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};Vn.createSignedData=function(){var r=null;return r={type:Ie.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(i){if(UP(r,i,Vn.asn1.signedDataValidator),r.certificates=[],r.crls=[],r.digestAlgorithmIdentifiers=[],r.contentInfo=null,r.signerInfos=[],r.rawCapture.certificates)for(var n=r.rawCapture.certificates.value,s=0;s<n.length;++s)r.certificates.push(Ie.pki.certificateFromAsn1(n[s]))},toAsn1:function(){r.contentInfo||r.sign();for(var i=[],n=0;n<r.certificates.length;++n)i.push(Ie.pki.certificateToAsn1(r.certificates[n]));var s=[],o=U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(r.version).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SET,!0,r.digestAlgorithmIdentifiers),r.contentInfo])]);return i.length>0&&o.value[0].value.push(U.create(U.Class.CONTEXT_SPECIFIC,0,!0,i)),s.length>0&&o.value[0].value.push(U.create(U.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(U.create(U.Class.UNIVERSAL,U.Type.SET,!0,r.signerInfos)),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.type).getBytes()),o])},addSigner:function(i){var n=i.issuer,s=i.serialNumber;if(i.certificate){var o=i.certificate;typeof o=="string"&&(o=Ie.pki.certificateFromPem(o)),n=o.issuer.attributes,s=o.serialNumber}var a=i.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof a=="string"&&(a=Ie.pki.privateKeyFromPem(a));var c=i.digestAlgorithm||Ie.pki.oids.sha1;switch(c){case Ie.pki.oids.sha1:case Ie.pki.oids.sha256:case Ie.pki.oids.sha384:case Ie.pki.oids.sha512:case Ie.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var u=i.authenticatedAttributes||[];if(u.length>0){for(var l=!1,d=!1,h=0;h<u.length;++h){var p=u[h];if(!l&&p.type===Ie.pki.oids.contentType){if(l=!0,d)break;continue}if(!d&&p.type===Ie.pki.oids.messageDigest){if(d=!0,l)break;continue}}if(!l||!d)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}r.signers.push({key:a,version:1,issuer:n,serialNumber:s,digestAlgorithm:c,signatureAlgorithm:Ie.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(i){if(i=i||{},(typeof r.content!="object"||r.contentInfo===null)&&(r.contentInfo=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(Ie.pki.oids.data).getBytes())]),"content"in r)){var n;r.content instanceof Ie.util.ByteBuffer?n=r.content.bytes():typeof r.content=="string"&&(n=Ie.util.encodeUtf8(r.content)),i.detached?r.detachedContent=U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,n):r.contentInfo.value.push(U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,n)]))}if(r.signers.length!==0){var s=e();t(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(i){typeof i=="string"&&(i=Ie.pki.certificateFromPem(i)),r.certificates.push(i)},addCertificateRevokationList:function(i){throw new Error("PKCS#7 CRL support not yet implemented.")}},r;function e(){for(var i={},n=0;n<r.signers.length;++n){var s=r.signers[n],o=s.digestAlgorithm;o in i||(i[o]=Ie.md[Ie.pki.oids[o]].create()),s.authenticatedAttributes.length===0?s.md=i[o]:s.md=Ie.md[Ie.pki.oids[o]].create()}r.digestAlgorithmIdentifiers=[];for(var o in i)r.digestAlgorithmIdentifiers.push(U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(o).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")]));return i}function t(i){var n;if(r.detachedContent?n=r.detachedContent:(n=r.contentInfo.value[1],n=n.value[0]),!n)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=U.derToOid(r.contentInfo.value[0].value),o=U.toDer(n);o.getByte(),U.getBerValueLength(o),o=o.getBytes();for(var a in i)i[a].start().update(o);for(var c=new Date,u=0;u<r.signers.length;++u){var l=r.signers[u];if(l.authenticatedAttributes.length===0){if(s!==Ie.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{l.authenticatedAttributesAsn1=U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var d=U.create(U.Class.UNIVERSAL,U.Type.SET,!0,[]),h=0;h<l.authenticatedAttributes.length;++h){var p=l.authenticatedAttributes[h];p.type===Ie.pki.oids.messageDigest?p.value=i[l.digestAlgorithm].digest():p.type===Ie.pki.oids.signingTime&&(p.value||(p.value=c)),d.value.push(qP(p)),l.authenticatedAttributesAsn1.value.push(qP(p))}o=U.toDer(d).getBytes(),l.md.start().update(o)}l.signature=l.key.sign(l.md,"RSASSA-PKCS1-V1_5")}r.signerInfos=XYe(r.signers)}};Vn.createEncryptedData=function(){var r=null;return r={type:Ie.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:Ie.pki.oids["aes256-CBC"]},fromAsn1:function(e){UP(r,e,Vn.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(r.encryptedContent.key=e),lye(r)}},r};Vn.createEnvelopedData=function(){var r=null;return r={type:Ie.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:Ie.pki.oids["aes256-CBC"]},fromAsn1:function(e){var t=UP(r,e,Vn.asn1.envelopedDataValidator);r.recipients=GYe(t.recipientInfos.value)},toAsn1:function(){return U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.type).getBytes()),U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(r.version).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SET,!0,WYe(r.recipients)),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,QYe(r.encryptedContent))])])])},findRecipient:function(e){for(var t=e.issuer.attributes,i=0;i<r.recipients.length;++i){var n=r.recipients[i],s=n.issuer;if(n.serialNumber===e.serialNumber&&s.length===t.length){for(var o=!0,a=0;a<t.length;++a)if(s[a].type!==t[a].type||s[a].value!==t[a].value){o=!1;break}if(o)return n}}return null},decrypt:function(e,t){if(r.encryptedContent.key===void 0&&e!==void 0&&t!==void 0)switch(e.encryptedContent.algorithm){case Ie.pki.oids.rsaEncryption:case Ie.pki.oids.desCBC:var i=t.decrypt(e.encryptedContent.content);r.encryptedContent.key=Ie.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}lye(r)},addRecipient:function(e){r.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:Ie.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,t){if(r.encryptedContent.content===void 0){t=t||r.encryptedContent.algorithm,e=e||r.encryptedContent.key;var i,n,s;switch(t){case Ie.pki.oids["aes128-CBC"]:i=16,n=16,s=Ie.aes.createEncryptionCipher;break;case Ie.pki.oids["aes192-CBC"]:i=24,n=16,s=Ie.aes.createEncryptionCipher;break;case Ie.pki.oids["aes256-CBC"]:i=32,n=16,s=Ie.aes.createEncryptionCipher;break;case Ie.pki.oids["des-EDE3-CBC"]:i=24,n=8,s=Ie.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+t)}if(e===void 0)e=Ie.util.createBuffer(Ie.random.getBytes(i));else if(e.length()!=i)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+i+".");r.encryptedContent.algorithm=t,r.encryptedContent.key=e,r.encryptedContent.parameter=Ie.util.createBuffer(Ie.random.getBytes(n));var o=s(e);if(o.start(r.encryptedContent.parameter.copy()),o.update(r.content),!o.finish())throw new Error("Symmetric encryption failed.");r.encryptedContent.content=o.output}for(var a=0;a<r.recipients.length;++a){var c=r.recipients[a];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case Ie.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(r.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},r};function HYe(r){var e={},t=[];if(!U.validate(r,Vn.asn1.recipientInfoValidator,e,t)){var i=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw i.errors=t,i}return{version:e.version.charCodeAt(0),issuer:Ie.pki.RDNAttributesAsArray(e.issuer),serialNumber:Ie.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:U.derToOid(e.encAlgorithm),parameter:e.encParameter?e.encParameter.value:void 0,content:e.encKey}}}function $Ye(r){return U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(r.version).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[Ie.pki.distinguishedNameToAsn1({attributes:r.issuer}),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,Ie.util.hexToBytes(r.serialNumber))]),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.encryptedContent.algorithm).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")]),U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,r.encryptedContent.content)])}function GYe(r){for(var e=[],t=0;t<r.length;++t)e.push(HYe(r[t]));return e}function WYe(r){for(var e=[],t=0;t<r.length;++t)e.push($Ye(r[t]));return e}function YYe(r){var e=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(r.version).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[Ie.pki.distinguishedNameToAsn1({attributes:r.issuer}),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,Ie.util.hexToBytes(r.serialNumber))]),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.digestAlgorithm).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")])]);if(r.authenticatedAttributesAsn1&&e.value.push(r.authenticatedAttributesAsn1),e.value.push(U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.signatureAlgorithm).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")])),e.value.push(U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,r.signature)),r.unauthenticatedAttributes.length>0){for(var t=U.create(U.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<r.unauthenticatedAttributes.length;++i){var n=r.unauthenticatedAttributes[i];t.values.push(qP(n))}e.value.push(t)}return e}function XYe(r){for(var e=[],t=0;t<r.length;++t)e.push(YYe(r[t]));return e}function qP(r){var e;if(r.type===Ie.pki.oids.contentType)e=U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.value).getBytes());else if(r.type===Ie.pki.oids.messageDigest)e=U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,r.value.bytes());else if(r.type===Ie.pki.oids.signingTime){var t=new Date("1950-01-01T00:00:00Z"),i=new Date("2050-01-01T00:00:00Z"),n=r.value;if(typeof n=="string"){var s=Date.parse(n);isNaN(s)?n.length===13?n=U.utcTimeToDate(n):n=U.generalizedTimeToDate(n):n=new Date(s)}n>=t&&n<i?e=U.create(U.Class.UNIVERSAL,U.Type.UTCTIME,!1,U.dateToUtcTime(n)):e=U.create(U.Class.UNIVERSAL,U.Type.GENERALIZEDTIME,!1,U.dateToGeneralizedTime(n))}return U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.type).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SET,!0,[e])])}function QYe(r){return[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(Ie.pki.oids.data).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.algorithm).getBytes()),r.parameter?U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,r.parameter.getBytes()):void 0]),U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,r.content.getBytes())])]}function UP(r,e,t){var i={},n=[];if(!U.validate(e,t,i,n)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=U.derToOid(i.contentType);if(o!==Ie.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(i.encryptedContent){var a="";if(Ie.util.isArray(i.encryptedContent))for(var c=0;c<i.encryptedContent.length;++c){if(i.encryptedContent[c].type!==U.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=i.encryptedContent[c].value}else a=i.encryptedContent;r.encryptedContent={algorithm:U.derToOid(i.encAlgorithm),parameter:Ie.util.createBuffer(i.encParameter.value),content:Ie.util.createBuffer(a)}}if(i.content){var a="";if(Ie.util.isArray(i.content))for(var c=0;c<i.content.length;++c){if(i.content[c].type!==U.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=i.content[c].value}else a=i.content;r.content=Ie.util.createBuffer(a)}return r.version=i.version.charCodeAt(0),r.rawCapture=i,i}function lye(r){if(r.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(r.content===void 0){var e;switch(r.encryptedContent.algorithm){case Ie.pki.oids["aes128-CBC"]:case Ie.pki.oids["aes192-CBC"]:case Ie.pki.oids["aes256-CBC"]:e=Ie.aes.createDecryptionCipher(r.encryptedContent.key);break;case Ie.pki.oids.desCBC:case Ie.pki.oids["des-EDE3-CBC"]:e=Ie.des.createDecryptionCipher(r.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+r.encryptedContent.algorithm)}if(e.start(r.encryptedContent.parameter),e.update(r.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");r.content=e.output}}});var yye=m((SOt,pye)=>{f();"use strict";jP();var ZYe=Rt(),hye=ZYe.pki,JYe=(r,e)=>{let t=hye.setRsaPublicKey(e.n,e.e),i=hye.createCertificate();i.publicKey=t,i.serialNumber="01",i.validity.notBefore=new Date,i.validity.notAfter=new Date,i.validity.notAfter.setFullYear(i.validity.notBefore.getFullYear()+10);let n=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:r.id}];return i.setSubject(n),i.setIssuer(n),i.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),i.sign(e),i};async function eXe(r,e){let t=r.map(e),n=(await Promise.all(t)).findIndex(s=>s);return r[n]}pye.exports={certificateForKey:JYe,findAsync:eXe}});var wye=m((ROt,bye)=>{f();"use strict";dye();fE();var Rf=Rt(),{certificateForKey:tXe,findAsync:rXe}=yye(),V1=br(),{fromString:gye}=(ct(),Qr),{toString:iXe}=(tt(),sr),{codes:z1}=wr(),FP=new WeakMap,mye=class{constructor(e,t){if(!e)throw V1(new Error("keychain is required"),z1.ERR_KEYCHAIN_REQUIRED);this.keychain=e,FP.set(this,{dek:t})}async encrypt(e,t){if(!(t instanceof Uint8Array))throw V1(new Error("Plain data must be a Uint8Array"),z1.ERR_INVALID_PARAMETERS);let i=await this.keychain.findKeyByName(e),n=await this.keychain._getPrivateKey(e),s=FP.get(this).dek,o=Rf.pki.decryptRsaPrivateKey(n,s),a=await tXe(i,o),c=Rf.pkcs7.createEnvelopedData();c.addRecipient(a),c.content=Rf.util.createBuffer(t),c.encrypt();let u=Rf.asn1.toDer(c.toAsn1()).getBytes();return gye(u,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw V1(new Error("CMS data is required"),z1.ERR_INVALID_PARAMETERS);let t;try{let u=Rf.util.createBuffer(iXe(e,"ascii")),l=Rf.asn1.fromDer(u);t=Rf.pkcs7.messageFromAsn1(l)}catch(u){throw V1(new Error("Invalid CMS: "+u.message),z1.ERR_INVALID_CMS)}let i=t.recipients.filter(u=>u.issuer.find(l=>l.shortName==="O"&&l.value==="ipfs")).filter(u=>u.issuer.find(l=>l.shortName==="CN")).map(u=>({recipient:u,keyId:u.issuer.find(l=>l.shortName==="CN").value})),n=await rXe(i,async u=>{try{if(await this.keychain.findKeyById(u.keyId))return!0}catch(l){return!1}return!1});if(!n){let u=i.map(l=>l.keyId);throw V1(new Error("Decryption needs one of the key(s): "+u.join(", ")),z1.ERR_MISSING_KEYS,{missingKeys:u})}let s=await this.keychain.findKeyById(n.keyId);if(!s)throw V1(new Error("No key available to decrypto"),z1.ERR_NO_KEY);let o=await this.keychain._getPrivateKey(s.name),a=FP.get(this).dek,c=Rf.pki.decryptRsaPrivateKey(o,a);return t.decrypt(n.recipient,c),gye(t.content.getBytes(),"ascii")}};bye.exports=mye});var xye=m((AOt,Aye)=>{f();"use strict";var _ye=le(),vye=Object.assign(_ye("libp2p:keychain"),{error:_ye("libp2p:keychain:err")}),nXe=W1e(),sXe=Uu(),Sh=Ya(),{Key:Eye}=(Mr(),mp),oXe=wye(),zr=br(),{codes:Hr}=wr(),{toString:Rh}=(tt(),sr),{fromString:Lu}=(ct(),Qr);yE();var aXe="/pkcs8/",Sye="/info/",Af=new WeakMap,Ah={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},KP={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function Mu(r){return!r||typeof r!="string"?!1:r===nXe(r.trim())}async function ir(r){let e=200,t=1e3,i=Math.random()*(t-e)+e;throw await new Promise(n=>setTimeout(n,i)),r}function Pc(r){return new Eye(aXe+r)}function xf(r){return new Eye(Sye+r)}var Rye=class{constructor(e,t){if(!e)throw new Error("store is required");if(this.store=e,this.opts=sXe(KP,t),this.opts.pass&&this.opts.pass.length<20)throw new Error("pass must be least 20 characters");if(this.opts.dek.keyLength<Ah.minKeyLength)throw new Error(`dek.keyLength must be least ${Ah.minKeyLength} bytes`);if(this.opts.dek.salt.length<Ah.minSaltLength)throw new Error(`dek.saltLength must be least ${Ah.minSaltLength} bytes`);if(this.opts.dek.iterationCount<Ah.minIterationCount)throw new Error(`dek.iterationCount must be least ${Ah.minIterationCount}`);let i=this.opts.pass?Sh.pbkdf2(this.opts.pass,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Af.set(this,{dek:i})}get cms(){return new oXe(this,Af.get(this).dek)}static generateOptions(){let e=Object.assign({},KP),t=Math.ceil(Ah.minSaltLength/3)*3;return e.dek.salt=Rh(Sh.randomBytes(t),"base64"),e}static get options(){return KP}async createKey(e,t,i=2048){let n=this;if(!Mu(e)||e==="self")return ir(zr(new Error(`Invalid key name '${e}'`),Hr.ERR_INVALID_KEY_NAME));if(typeof t!="string")return ir(zr(new Error(`Invalid key type '${t}'`),Hr.ERR_INVALID_KEY_TYPE));let s=Pc(e);if(await n.store.has(s))return ir(zr(new Error(`Key '${e}' already exists`),Hr.ERR_KEY_ALREADY_EXISTS));switch(t.toLowerCase()){case"rsa":if(!Number.isSafeInteger(i)||i<2048)return ir(zr(new Error(`Invalid RSA key size ${i}`),Hr.ERR_INVALID_KEY_SIZE));break;default:break}let a;try{let c=await Sh.keys.generateKeyPair(t,i),u=await c.id(),l=Af.get(this).dek,d=await c.export(l);a={name:e,id:u};let h=n.store.batch();h.put(s,Lu(d)),h.put(xf(e),Lu(JSON.stringify(a))),await h.commit()}catch(c){return ir(c)}return a}async listKeys(){let e=this,t={prefix:Sye},i=[];for await(let n of e.store.query(t))i.push(JSON.parse(Rh(n.value)));return i}async findKeyById(e){try{return(await this.listKeys()).find(i=>i.id===e)}catch(t){return ir(t)}}async findKeyByName(e){if(!Mu(e))return ir(zr(new Error(`Invalid key name '${e}'`),Hr.ERR_INVALID_KEY_NAME));let t=xf(e);try{let i=await this.store.get(t);return JSON.parse(Rh(i))}catch(i){return ir(zr(new Error(`Key '${e}' does not exist. ${i.message}`),Hr.ERR_KEY_NOT_FOUND))}}async removeKey(e){let t=this;if(!Mu(e)||e==="self")return ir(zr(new Error(`Invalid key name '${e}'`),Hr.ERR_INVALID_KEY_NAME));let i=Pc(e),n=await t.findKeyByName(e),s=t.store.batch();return s.delete(i),s.delete(xf(e)),await s.commit(),n}async renameKey(e,t){let i=this;if(!Mu(e)||e==="self")return ir(zr(new Error(`Invalid old key name '${e}'`),Hr.ERR_OLD_KEY_NAME_INVALID));if(!Mu(t)||t==="self")return ir(zr(new Error(`Invalid new key name '${t}'`),Hr.ERR_NEW_KEY_NAME_INVALID));let n=Pc(e),s=Pc(t),o=xf(e),a=xf(t);if(await i.store.has(s))return ir(zr(new Error(`Key '${t}' already exists`),Hr.ERR_KEY_ALREADY_EXISTS));try{let u=await i.store.get(n),l=await i.store.get(o),d=JSON.parse(Rh(l));d.name=t;let h=i.store.batch();return h.put(s,u),h.put(a,Lu(JSON.stringify(d))),h.delete(n),h.delete(o),await h.commit(),d}catch(u){return ir(u)}}async exportKey(e,t){if(!Mu(e))return ir(zr(new Error(`Invalid key name '${e}'`),Hr.ERR_INVALID_KEY_NAME));if(!t)return ir(zr(new Error("Password is required"),Hr.ERR_PASSWORD_REQUIRED));let i=Pc(e);try{let n=await this.store.get(i),s=Rh(n),o=Af.get(this).dek;return(await Sh.keys.import(s,o)).export(t)}catch(n){return ir(n)}}async importKey(e,t,i){let n=this;if(!Mu(e)||e==="self")return ir(zr(new Error(`Invalid key name '${e}'`),Hr.ERR_INVALID_KEY_NAME));if(!t)return ir(zr(new Error("PEM encoded key is required"),Hr.ERR_PEM_REQUIRED));let s=Pc(e);if(await n.store.has(s))return ir(zr(new Error(`Key '${e}' already exists`),Hr.ERR_KEY_ALREADY_EXISTS));let a;try{a=await Sh.keys.import(t,i)}catch(d){return ir(zr(new Error("Cannot read the key, most likely the password is wrong"),Hr.ERR_CANNOT_READ_KEY))}let c;try{c=await a.id();let d=Af.get(this).dek;t=await a.export(d)}catch(d){return ir(d)}let u={name:e,id:c},l=n.store.batch();return l.put(s,Lu(t)),l.put(xf(e),Lu(JSON.stringify(u))),await l.commit(),u}async importPeer(e,t){let i=this;if(!Mu(e))return ir(zr(new Error(`Invalid key name '${e}'`),Hr.ERR_INVALID_KEY_NAME));if(!t||!t.privKey)return ir(zr(new Error("Peer.privKey is required"),Hr.ERR_MISSING_PRIVATE_KEY));let n=t.privKey,s=Pc(e);if(await i.store.has(s))return ir(zr(new Error(`Key '${e}' already exists`),Hr.ERR_KEY_ALREADY_EXISTS));try{let a=await n.id(),c=Af.get(this).dek,u=await n.export(c),l={name:e,id:a},d=i.store.batch();return d.put(s,Lu(u)),d.put(xf(e),Lu(JSON.stringify(l))),await d.commit(),l}catch(a){return ir(a)}}async _getPrivateKey(e){if(!Mu(e))return ir(zr(new Error(`Invalid key name '${e}'`),Hr.ERR_INVALID_KEY_NAME));try{let t=Pc(e),i=await this.store.get(t);return Rh(i)}catch(t){return ir(zr(new Error(`Key '${e}' does not exist. ${t.message}`),Hr.ERR_KEY_NOT_FOUND))}}async rotateKeychainPass(e,t){if(typeof e!="string")return ir(zr(new Error(`Invalid old pass type '${typeof e}'`),Hr.ERR_INVALID_OLD_PASS_TYPE));if(typeof t!="string")return ir(zr(new Error(`Invalid new pass type '${typeof t}'`),Hr.ERR_INVALID_NEW_PASS_TYPE));if(t.length<20)return ir(zr(new Error(`Invalid pass length ${t.length}`),Hr.ERR_INVALID_PASS_LENGTH));vye("recreating keychain");let i=Af.get(this).dek;this.opts.pass=t;let n=t?Sh.pbkdf2(t,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Af.set(this,{dek:n});let s=await this.listKeys();for(let o of s){let a=await this.store.get(Pc(o.name)),c=Rh(a),u=await Sh.keys.import(c,i),l=n.toString(),d=await u.export(l),h=this.store.batch(),p={name:o.name,id:o.id};h.put(Pc(o.name),Lu(d)),h.put(xf(o.name),Lu(JSON.stringify(p))),await h.commit()}vye("keychain reconstructed")}};Aye.exports=Rye});var e_=m((J8,Iye)=>{f();(function(r,e){typeof J8=="object"&&typeof Iye!="undefined"?e(J8):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.streamingIterables={}))})(J8,function(r){"use strict";async function*e(x,B){let G=[];for await(let Z of B)G.push(Z),G.length===x&&(yield G,G=[]);G.length>0&&(yield G)}function*t(x,B){let G=[];for(let Z of B)G.push(Z),G.length===x&&(yield G,G=[]);G.length>0&&(yield G)}function i(x,B){return B===void 0?G=>i(x,G):B[Symbol.asyncIterator]?e(x,B):t(x,B)}let n=Symbol("TIMEOUT"),s=x=>{let B;return[new Promise(G=>{B=setTimeout(()=>G(n),x)}),()=>{clearTimeout(B)}]};async function*o(x,B,G){let Z=G[Symbol.asyncIterator](),he,Be=[],He,Fe,Ke=()=>{nt(),[He,Fe]=s(B)},nt=()=>{Fe&&Fe(),He=void 0};for(he=Z.next();;){let Mt=await(He?Promise.race([he,He]):he);if(Mt===n||Mt.done){if(Be.length&&(yield Be,Be=[]),nt(),Mt!==n)break;continue}if(he=Z.next(),Be.push(Mt.value),Be.length===1&&Ke(),Be.length===x){yield Be,Be=[],nt();continue}}}function a(x,B,G){return G===void 0?Z=>a(x,B,Z):G[Symbol.asyncIterator]&&B!==1/0?o(x,B,G):i(x,G)}function c(x){if(typeof x.next=="function")return x;if(typeof x[Symbol.iterator]=="function")return x[Symbol.iterator]();if(typeof x[Symbol.asyncIterator]=="function")return x[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function u(){let x,B;return{promise:new Promise((Z,he)=>{B=Z,x=he}),reject:x,resolve:B}}function l(x,B){let G=c(B),Z=[],he=[],Be=!1,He=!1;function Fe(){for(;he.length>0&&Z.length>0;){let dt=he.shift(),{error:_r,value:Nr}=Z.shift();_r?dt.reject(_r):dt.resolve({done:!1,value:Nr})}for(;he.length>0&&He;){let{resolve:dt}=he.shift();dt({done:!0,value:void 0})}}async function Ke(){if(!He&&!Be&&!(Z.length>=x)){Be=!0;try{let{done:dt,value:_r}=await G.next();dt?He=!0:Z.push({value:_r})}catch(dt){He=!0,Z.push({error:dt})}Fe(),Be=!1,Ke()}}async function nt(){if(Z.length>0){let{error:_r,value:Nr}=Z.shift();if(_r)throw _r;return Ke(),{done:!1,value:Nr}}if(He)return{done:!0,value:void 0};let dt=u();return he.push(dt),Ke(),dt.promise}let Mt={next:nt,[Symbol.asyncIterator]:()=>Mt};return Mt}function*d(x,B){let G=[],Z;try{for(let he of B)G.push(he),!(G.length<=x)&&(yield G.shift())}catch(he){Z=he}for(let he of G)yield he;if(Z)throw Z}function h(x,B){return B===void 0?G=>h(x,G):x===0?B:B[Symbol.asyncIterator]?l(x,B):d(x,B)}async function p(x){let B=[];for await(let G of x)B.push(G);return B}function y(x){return x[Symbol.asyncIterator]?p(x):Array.from(x)}async function*g(x){for await(let B of x)yield*B}function*w(x){for(let B of x)yield*B}function b(...x){return x.find(G=>G[Symbol.asyncIterator]!==void 0)?g(x):w(x)}async function v(x){for await(let B of x);}function A(x){if(x[Symbol.asyncIterator])return v(x);for(let B of x);}async function*k(x,B){for await(let G of B)await x(G)&&(yield G)}function C(x,B){return B===void 0?G=>k(x,G):k(x,B)}async function*T(x){for await(let B of x)B&&typeof B!="string"&&(B[Symbol.iterator]||B[Symbol.asyncIterator])?yield*T(B):yield B}async function*D(x,B){for await(let G of B)yield await x(G)}function j(x,B){return B===void 0?G=>D(x,G):D(x,B)}function M(x,B){return B===void 0?G=>M(x,G):C(G=>G!=null,T(j(x,B)))}function se(x,B,G){let Z=c(G),he=[],Be=[],He=!1,Fe=!1,Ke=0,nt=null;function Mt(){for(;Be.length>0&&he.length>0;){let{resolve:mt}=Be.shift(),st=he.shift();mt({done:!1,value:st})}for(;Be.length>0&&Ke===0&&He;){let{resolve:mt,reject:st}=Be.shift();nt?(st(nt),nt=null):mt({done:!0,value:void 0})}}async function dt(){if(He){Mt();return}if(!Fe&&!(Ke+he.length>=x)){Fe=!0,Ke++;try{let{done:mt,value:st}=await Z.next();mt?(He=!0,Ke--,Mt()):_r(st)}catch(mt){He=!0,Ke--,nt=mt,Mt()}Fe=!1,dt()}}async function _r(mt){try{let st=await B(mt);if(st&&st[Symbol.asyncIterator])for await(let yr of st)he.push(yr);else he.push(st)}catch(st){He=!0,nt=st}Ke--,Mt(),dt()}async function Nr(){if(he.length===0){let st=u();return Be.push(st),dt(),st.promise}let mt=he.shift();return dt(),{done:!1,value:mt}}let An={next:Nr,[Symbol.asyncIterator]:()=>An};return An}function ie(x,B,G){return B===void 0?(Z,he)=>he?ie(x,Z,he):ie(x,Z):G===void 0?Z=>ie(x,B,Z):C(Z=>Z!=null,T(se(x,B,G)))}async function fe(x){return new Promise(B=>{x.once("readable",()=>{B()})})}async function*pe(x){for(;;){let B=x.read();if(B!==null){yield B;continue}if(x._readableState.ended)break;await fe(x)}}function Le(x){return typeof x[Symbol.asyncIterator]=="function"?x:pe(x)}async function*Re(...x){let B=new Set(x.map(c));for(;B.size>0;)for(let G of B){let Z=await G.next();Z.done?B.delete(G):yield Z.value}}function De(x,...B){let G=x();for(let Z of B)G=Z(G);return G}async function*ne(x,B,G){let Z=null,he=Ke=>({value:B(Ke)}),Be=async function*(Ke){for await(let nt of Ke){if(Z)return;yield nt}},He=De(()=>G,h(1),Be,j(he),h(x-1)),Fe=c(He);for(;;){let{value:Ke,done:nt}=await Fe.next();if(nt)break;try{let Mt=await Ke.value;Z||(yield Mt)}catch(Mt){Z=Mt}}if(Z)throw Z}function je(x,B,G){return B===void 0?(Z,he)=>je(x,Z,he):G===void 0?Z=>je(x,B,Z):x===1?j(B,G):ne(x,B,G)}function ut(x,B,G){return B===void 0?(Z,he)=>he?ut(x,Z,he):ut(x,Z):G===void 0?Z=>ut(x,B,Z):C(Z=>Z!=null,T(je(x,B,G)))}async function*Ye(...x){let B=x.map(c),G=new Set,Z=new Map,he=null,Be=null,He=null,Fe=dt=>{he=dt,Be&&Be(dt)},Ke=dt=>{He&&He(dt)},nt=()=>new Promise((dt,_r)=>{if(he&&_r(he),Z.size>0)return dt();He=dt,Be=_r}),Mt=dt=>{let _r=Promise.resolve(dt.next()).then(async({done:Nr,value:An})=>{Nr||Z.set(dt,An),G.delete(_r)});G.add(_r),_r.then(Ke,Fe)};for(let dt of B)Mt(dt);for(;;){if(G.size===0&&Z.size===0)return;await nt();for(let[dt,_r]of Z)Z.delete(dt),yield _r,Mt(dt)}}async function Xe(x,B,G){let Z=B;for await(let he of G)Z=await x(Z,he);return Z}function de(x,B,G){return B===void 0?(Z,he)=>he?Xe(x,Z,he):de(x,Z):G===void 0?Z=>de(x,B,Z):Xe(x,B,G)}async function*J(x,B){let G=0;for await(let Z of B)if(yield await Z,G++,G>=x)break}function*Ee(x,B){let G=0;for(let Z of B)if(yield Z,G++,G>=x)break}function qe(x,B){return B===void 0?G=>qe(x,G):B[Symbol.asyncIterator]?J(x,B):Ee(x,B)}async function*ze(x,B){for await(let G of B)await x(G),yield G}function Te(x,B){return B===void 0?G=>ze(x,G):ze(x,B)}let at=x=>new Promise(B=>setTimeout(B,x));function I(x,B,G){if(!Number.isFinite(x))throw new TypeError("Expected `limit` to be a finite number");if(x<=0)throw new TypeError("Expected `limit` to be greater than 0");if(!Number.isFinite(B))throw new TypeError("Expected `interval` to be a finite number");return async function*(){let he=0,Be;for await(let He of G){if(he<x){typeof Be=="undefined"&&(Be=Date.now()),he++,yield He;continue}let Fe=Date.now()-Be,Ke=B-Fe;Ke>0&&await at(Ke),Be=Date.now(),he=1,yield He}}()}function O(x,B,G){return G===void 0?Z=>I(x,B,Z):I(x,B,G)}function N(x,B){let G=x[0]+B[0],Z=x[1]+B[1];if(Z>=1e9){let he=Z%1e9;G+=(Z-he)/1e9,Z=he}return[G,Z]}async function*Y(x,B){let G=B[Symbol.asyncIterator](),Z=[0,0];for(;;){let he=process.hrtime(),{value:Be,done:He}=await G.next(),Fe=process.hrtime(he);if(Z=N(Z,Fe),x.progress&&x.progress(Fe,Z),He)return x.total&&x.total(Z),Be;yield Be}}function*F(x,B){let G=B[Symbol.iterator](),Z=[0,0];for(;;){let he=process.hrtime(),{value:Be,done:He}=G.next(),Fe=process.hrtime(he);if(Z=N(Z,Fe),x.progress&&x.progress(Fe,Z),He)return x.total&&x.total(Z),Be;yield Be}}function W(x={},B){return B===void 0?G=>W(x,G):B[Symbol.asyncIterator]!==void 0?Y(x,B):F(x,B)}function ee(x,B,G){let Z=c(G),he=[],Be=[],He=!1,Fe=!1,Ke=0,nt=null;function Mt(){for(;Be.length>0&&he.length>0;){let{resolve:mt}=Be.shift(),st=he.shift();mt({done:!1,value:st})}for(;Be.length>0&&Ke===0&&He;){let{resolve:mt,reject:st}=Be.shift();nt?(st(nt),nt=null):mt({done:!0,value:void 0})}}async function dt(){if(He){Mt();return}if(!Fe&&!(Ke+he.length>=x)){Fe=!0,Ke++;try{let{done:mt,value:st}=await Z.next();mt?(He=!0,Ke--,Mt()):_r(st)}catch(mt){He=!0,Ke--,nt=mt,Mt()}Fe=!1,dt()}}async function _r(mt){try{let st=await B(mt);he.push(st)}catch(st){He=!0,nt=st}Ke--,Mt(),dt()}async function Nr(){if(he.length===0){let st=u();return Be.push(st),dt(),st.promise}let mt=he.shift();return dt(),{done:!1,value:mt}}let An={next:Nr,[Symbol.asyncIterator]:()=>An};return An}function V(x,B,G){return B===void 0?(Z,he)=>he?V(x,Z,he):V(x,Z):G===void 0?Z=>V(x,B,Z):ee(x,B,G)}async function X(x,B){let G=null,Z=null,he=null,Be=nt=>{G=nt,Z&&Z(nt)},He=()=>{he&&he()},Fe=()=>{x.removeListener("error",Be),x.removeListener("drain",He)};x.once("error",Be);let Ke=()=>new Promise((nt,Mt)=>{if(G)return Mt(G);x.once("drain",He),he=nt,Z=Mt});for await(let nt of B)if(x.write(nt)===!1&&await Ke(),G)break;if(Fe(),G)throw G}function re(x,B){return B===void 0?G=>X(x,G):X(x,B)}r.batch=i,r.batchWithTimeout=a,r.buffer=h,r.collect=y,r.concat=b,r.consume=A,r.filter=C,r.flatMap=M,r.flatTransform=ie,r.flatten=T,r.fromStream=Le,r.getIterator=c,r.map=j,r.merge=Re,r.parallelFlatMap=ut,r.parallelMap=je,r.parallelMerge=Ye,r.pipeline=De,r.reduce=de,r.take=qe,r.tap=Te,r.throttle=O,r.time=W,r.transform=V,r.writeToStream=re,Object.defineProperty(r,"__esModule",{value:!0})})});var Pye=m((xOt,Tye)=>{f();"use strict";var cXe=wp();Tye.exports=r=>{let e=cXe(r);return e.delete=e.remove,e}});var Oye=m((Cye,t_)=>{f();(function(r){"use strict";var e,t=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,n=Math.floor,s="[BigNumber Error] ",o=s+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,u=9007199254740991,l=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,h=1e9;function p(C){var T,D,j,M=J.prototype={constructor:J,toString:null,valueOf:null},se=new J(1),ie=20,fe=4,pe=-7,Le=21,Re=-1e7,De=1e7,ne=!1,je=1,ut=0,Ye={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},Xe="0123456789abcdefghijklmnopqrstuvwxyz",de=!0;function J(I,O){var N,Y,F,W,ee,V,X,re,x=this;if(!(x instanceof J))return new J(I,O);if(O==null){if(I&&I._isBigNumber===!0){x.s=I.s,!I.c||I.e>De?x.c=x.e=null:I.e<Re?x.c=[x.e=0]:(x.e=I.e,x.c=I.c.slice());return}if((V=typeof I=="number")&&I*0==0){if(x.s=1/I<0?(I=-I,-1):1,I===~~I){for(W=0,ee=I;ee>=10;ee/=10,W++);W>De?x.c=x.e=null:(x.e=W,x.c=[I]);return}re=String(I)}else{if(!t.test(re=String(I)))return j(x,re,V);x.s=re.charCodeAt(0)==45?(re=re.slice(1),-1):1}(W=re.indexOf("."))>-1&&(re=re.replace(".","")),(ee=re.search(/e/i))>0?(W<0&&(W=ee),W+=+re.slice(ee+1),re=re.substring(0,ee)):W<0&&(W=re.length)}else{if(b(O,2,Xe.length,"Base"),O==10&&de)return x=new J(I),Te(x,ie+x.e+1,fe);if(re=String(I),V=typeof I=="number"){if(I*0!=0)return j(x,re,V,O);if(x.s=1/I<0?(re=re.slice(1),-1):1,J.DEBUG&&re.replace(/^0\.0*|\./,"").length>15)throw Error(o+I)}else x.s=re.charCodeAt(0)===45?(re=re.slice(1),-1):1;for(N=Xe.slice(0,O),W=ee=0,X=re.length;ee<X;ee++)if(N.indexOf(Y=re.charAt(ee))<0){if(Y=="."){if(ee>W){W=X;continue}}else if(!F&&(re==re.toUpperCase()&&(re=re.toLowerCase())||re==re.toLowerCase()&&(re=re.toUpperCase()))){F=!0,ee=-1,W=0;continue}return j(x,String(I),V,O)}V=!1,re=D(re,O,10,x.s),(W=re.indexOf("."))>-1?re=re.replace(".",""):W=re.length}for(ee=0;re.charCodeAt(ee)===48;ee++);for(X=re.length;re.charCodeAt(--X)===48;);if(re=re.slice(ee,++X)){if(X-=ee,V&&J.DEBUG&&X>15&&(I>u||I!==n(I)))throw Error(o+x.s*I);if((W=W-ee-1)>De)x.c=x.e=null;else if(W<Re)x.c=[x.e=0];else{if(x.e=W,x.c=[],ee=(W+1)%c,W<0&&(ee+=c),ee<X){for(ee&&x.c.push(+re.slice(0,ee)),X-=c;ee<X;)x.c.push(+re.slice(ee,ee+=c));ee=c-(re=re.slice(ee)).length}else ee-=X;for(;ee--;re+="0");x.c.push(+re)}}else x.c=[x.e=0]}J.clone=p,J.ROUND_UP=0,J.ROUND_DOWN=1,J.ROUND_CEIL=2,J.ROUND_FLOOR=3,J.ROUND_HALF_UP=4,J.ROUND_HALF_DOWN=5,J.ROUND_HALF_EVEN=6,J.ROUND_HALF_CEIL=7,J.ROUND_HALF_FLOOR=8,J.EUCLID=9,J.config=J.set=function(I){var O,N;if(I!=null)if(typeof I=="object"){if(I.hasOwnProperty(O="DECIMAL_PLACES")&&(N=I[O],b(N,0,h,O),ie=N),I.hasOwnProperty(O="ROUNDING_MODE")&&(N=I[O],b(N,0,8,O),fe=N),I.hasOwnProperty(O="EXPONENTIAL_AT")&&(N=I[O],N&&N.pop?(b(N[0],-h,0,O),b(N[1],0,h,O),pe=N[0],Le=N[1]):(b(N,-h,h,O),pe=-(Le=N<0?-N:N))),I.hasOwnProperty(O="RANGE"))if(N=I[O],N&&N.pop)b(N[0],-h,-1,O),b(N[1],1,h,O),Re=N[0],De=N[1];else if(b(N,-h,h,O),N)Re=-(De=N<0?-N:N);else throw Error(s+O+" cannot be zero: "+N);if(I.hasOwnProperty(O="CRYPTO"))if(N=I[O],N===!!N)if(N)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))ne=N;else throw ne=!N,Error(s+"crypto unavailable");else ne=N;else throw Error(s+O+" not true or false: "+N);if(I.hasOwnProperty(O="MODULO_MODE")&&(N=I[O],b(N,0,9,O),je=N),I.hasOwnProperty(O="POW_PRECISION")&&(N=I[O],b(N,0,h,O),ut=N),I.hasOwnProperty(O="FORMAT"))if(N=I[O],typeof N=="object")Ye=N;else throw Error(s+O+" not an object: "+N);if(I.hasOwnProperty(O="ALPHABET"))if(N=I[O],typeof N=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(N))de=N.slice(0,10)=="0123456789",Xe=N;else throw Error(s+O+" invalid: "+N)}else throw Error(s+"Object expected: "+I);return{DECIMAL_PLACES:ie,ROUNDING_MODE:fe,EXPONENTIAL_AT:[pe,Le],RANGE:[Re,De],CRYPTO:ne,MODULO_MODE:je,POW_PRECISION:ut,FORMAT:Ye,ALPHABET:Xe}},J.isBigNumber=function(I){if(!I||I._isBigNumber!==!0)return!1;if(!J.DEBUG)return!0;var O,N,Y=I.c,F=I.e,W=I.s;e:if({}.toString.call(Y)=="[object Array]"){if((W===1||W===-1)&&F>=-h&&F<=h&&F===n(F)){if(Y[0]===0){if(F===0&&Y.length===1)return!0;break e}if(O=(F+1)%c,O<1&&(O+=c),String(Y[0]).length==O){for(O=0;O<Y.length;O++)if(N=Y[O],N<0||N>=a||N!==n(N))break e;if(N!==0)return!0}}}else if(Y===null&&F===null&&(W===null||W===1||W===-1))return!0;throw Error(s+"Invalid BigNumber: "+I)},J.maximum=J.max=function(){return qe(arguments,M.lt)},J.minimum=J.min=function(){return qe(arguments,M.gt)},J.random=function(){var I=9007199254740992,O=Math.random()*I&2097151?function(){return n(Math.random()*I)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(N){var Y,F,W,ee,V,X=0,re=[],x=new J(se);if(N==null?N=ie:b(N,0,h),ee=i(N/c),ne)if(crypto.getRandomValues){for(Y=crypto.getRandomValues(new Uint32Array(ee*=2));X<ee;)V=Y[X]*131072+(Y[X+1]>>>11),V>=9e15?(F=crypto.getRandomValues(new Uint32Array(2)),Y[X]=F[0],Y[X+1]=F[1]):(re.push(V%1e14),X+=2);X=ee/2}else if(crypto.randomBytes){for(Y=crypto.randomBytes(ee*=7);X<ee;)V=(Y[X]&31)*281474976710656+Y[X+1]*1099511627776+Y[X+2]*4294967296+Y[X+3]*16777216+(Y[X+4]<<16)+(Y[X+5]<<8)+Y[X+6],V>=9e15?crypto.randomBytes(7).copy(Y,X):(re.push(V%1e14),X+=7);X=ee/7}else throw ne=!1,Error(s+"crypto unavailable");if(!ne)for(;X<ee;)V=O(),V<9e15&&(re[X++]=V%1e14);for(ee=re[--X],N%=c,ee&&N&&(V=l[c-N],re[X]=n(ee/V)*V);re[X]===0;re.pop(),X--);if(X<0)re=[W=0];else{for(W=-1;re[0]===0;re.splice(0,1),W-=c);for(X=1,V=re[0];V>=10;V/=10,X++);X<c&&(W-=c-X)}return x.e=W,x.c=re,x}}(),J.sum=function(){for(var I=1,O=arguments,N=new J(O[0]);I<O.length;)N=N.plus(O[I++]);return N},D=function(){var I="0123456789";function O(N,Y,F,W){for(var ee,V=[0],X,re=0,x=N.length;re<x;){for(X=V.length;X--;V[X]*=Y);for(V[0]+=W.indexOf(N.charAt(re++)),ee=0;ee<V.length;ee++)V[ee]>F-1&&(V[ee+1]==null&&(V[ee+1]=0),V[ee+1]+=V[ee]/F|0,V[ee]%=F)}return V.reverse()}return function(N,Y,F,W,ee){var V,X,re,x,B,G,Z,he,Be=N.indexOf("."),He=ie,Fe=fe;for(Be>=0&&(x=ut,ut=0,N=N.replace(".",""),he=new J(Y),G=he.pow(N.length-Be),ut=x,he.c=O(k(g(G.c),G.e,"0"),10,F,I),he.e=he.c.length),Z=O(N,Y,F,ee?(V=Xe,I):(V=I,Xe)),re=x=Z.length;Z[--x]==0;Z.pop());if(!Z[0])return V.charAt(0);if(Be<0?--re:(G.c=Z,G.e=re,G.s=W,G=T(G,he,He,Fe,F),Z=G.c,B=G.r,re=G.e),X=re+He+1,Be=Z[X],x=F/2,B=B||X<0||Z[X+1]!=null,B=Fe<4?(Be!=null||B)&&(Fe==0||Fe==(G.s<0?3:2)):Be>x||Be==x&&(Fe==4||B||Fe==6&&Z[X-1]&1||Fe==(G.s<0?8:7)),X<1||!Z[0])N=B?k(V.charAt(1),-He,V.charAt(0)):V.charAt(0);else{if(Z.length=X,B)for(--F;++Z[--X]>F;)Z[X]=0,X||(++re,Z=[1].concat(Z));for(x=Z.length;!Z[--x];);for(Be=0,N="";Be<=x;N+=V.charAt(Z[Be++]));N=k(N,re,V.charAt(0))}return N}}(),T=function(){function I(Y,F,W){var ee,V,X,re,x=0,B=Y.length,G=F%d,Z=F/d|0;for(Y=Y.slice();B--;)X=Y[B]%d,re=Y[B]/d|0,ee=Z*X+re*G,V=G*X+ee%d*d+x,x=(V/W|0)+(ee/d|0)+Z*re,Y[B]=V%W;return x&&(Y=[x].concat(Y)),Y}function O(Y,F,W,ee){var V,X;if(W!=ee)X=W>ee?1:-1;else for(V=X=0;V<W;V++)if(Y[V]!=F[V]){X=Y[V]>F[V]?1:-1;break}return X}function N(Y,F,W,ee){for(var V=0;W--;)Y[W]-=V,V=Y[W]<F[W]?1:0,Y[W]=V*ee+Y[W]-F[W];for(;!Y[0]&&Y.length>1;Y.splice(0,1));}return function(Y,F,W,ee,V){var X,re,x,B,G,Z,he,Be,He,Fe,Ke,nt,Mt,dt,_r,Nr,An,mt=Y.s==F.s?1:-1,st=Y.c,yr=F.c;if(!st||!st[0]||!yr||!yr[0])return new J(!Y.s||!F.s||(st?yr&&st[0]==yr[0]:!yr)?NaN:st&&st[0]==0||!yr?mt*0:mt/0);for(Be=new J(mt),He=Be.c=[],re=Y.e-F.e,mt=W+re+1,V||(V=a,re=y(Y.e/c)-y(F.e/c),mt=mt/c|0),x=0;yr[x]==(st[x]||0);x++);if(yr[x]>(st[x]||0)&&re--,mt<0)He.push(1),B=!0;else{for(dt=st.length,Nr=yr.length,x=0,mt+=2,G=n(V/(yr[0]+1)),G>1&&(yr=I(yr,G,V),st=I(st,G,V),Nr=yr.length,dt=st.length),Mt=Nr,Fe=st.slice(0,Nr),Ke=Fe.length;Ke<Nr;Fe[Ke++]=0);An=yr.slice(),An=[0].concat(An),_r=yr[0],yr[1]>=V/2&&_r++;do{if(G=0,X=O(yr,Fe,Nr,Ke),X<0){if(nt=Fe[0],Nr!=Ke&&(nt=nt*V+(Fe[1]||0)),G=n(nt/_r),G>1)for(G>=V&&(G=V-1),Z=I(yr,G,V),he=Z.length,Ke=Fe.length;O(Z,Fe,he,Ke)==1;)G--,N(Z,Nr<he?An:yr,he,V),he=Z.length,X=1;else G==0&&(X=G=1),Z=yr.slice(),he=Z.length;if(he<Ke&&(Z=[0].concat(Z)),N(Fe,Z,Ke,V),Ke=Fe.length,X==-1)for(;O(yr,Fe,Nr,Ke)<1;)G++,N(Fe,Nr<Ke?An:yr,Ke,V),Ke=Fe.length}else X===0&&(G++,Fe=[0]);He[x++]=G,Fe[0]?Fe[Ke++]=st[Mt]||0:(Fe=[st[Mt]],Ke=1)}while((Mt++<dt||Fe[0]!=null)&&mt--);B=Fe[0]!=null,He[0]||He.splice(0,1)}if(V==a){for(x=1,mt=He[0];mt>=10;mt/=10,x++);Te(Be,W+(Be.e=x+re*c-1)+1,ee,B)}else Be.e=re,Be.r=+B;return Be}}();function Ee(I,O,N,Y){var F,W,ee,V,X;if(N==null?N=fe:b(N,0,8),!I.c)return I.toString();if(F=I.c[0],ee=I.e,O==null)X=g(I.c),X=Y==1||Y==2&&(ee<=pe||ee>=Le)?A(X,ee):k(X,ee,"0");else if(I=Te(new J(I),O,N),W=I.e,X=g(I.c),V=X.length,Y==1||Y==2&&(O<=W||W<=pe)){for(;V<O;X+="0",V++);X=A(X,W)}else if(O-=ee,X=k(X,W,"0"),W+1>V){if(--O>0)for(X+=".";O--;X+="0");}else if(O+=W-V,O>0)for(W+1==V&&(X+=".");O--;X+="0");return I.s<0&&F?"-"+X:X}function qe(I,O){for(var N,Y=1,F=new J(I[0]);Y<I.length;Y++)if(N=new J(I[Y]),N.s)O.call(F,N)&&(F=N);else{F=N;break}return F}function ze(I,O,N){for(var Y=1,F=O.length;!O[--F];O.pop());for(F=O[0];F>=10;F/=10,Y++);return(N=Y+N*c-1)>De?I.c=I.e=null:N<Re?I.c=[I.e=0]:(I.e=N,I.c=O),I}j=function(){var I=/^(-?)0([xbo])(?=\w[\w.]*$)/i,O=/^([^.]+)\.$/,N=/^\.([^.]+)$/,Y=/^-?(Infinity|NaN)$/,F=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(W,ee,V,X){var re,x=V?ee:ee.replace(F,"");if(Y.test(x))W.s=isNaN(x)?null:x<0?-1:1;else{if(!V&&(x=x.replace(I,function(B,G,Z){return re=(Z=Z.toLowerCase())=="x"?16:Z=="b"?2:8,!X||X==re?G:B}),X&&(re=X,x=x.replace(O,"$1").replace(N,"0.$1")),ee!=x))return new J(x,re);if(J.DEBUG)throw Error(s+"Not a"+(X?" base "+X:"")+" number: "+ee);W.s=null}W.c=W.e=null}}();function Te(I,O,N,Y){var F,W,ee,V,X,re,x,B=I.c,G=l;if(B){e:{for(F=1,V=B[0];V>=10;V/=10,F++);if(W=O-F,W<0)W+=c,ee=O,X=B[re=0],x=X/G[F-ee-1]%10|0;else if(re=i((W+1)/c),re>=B.length)if(Y){for(;B.length<=re;B.push(0));X=x=0,F=1,W%=c,ee=W-c+1}else break e;else{for(X=V=B[re],F=1;V>=10;V/=10,F++);W%=c,ee=W-c+F,x=ee<0?0:X/G[F-ee-1]%10|0}if(Y=Y||O<0||B[re+1]!=null||(ee<0?X:X%G[F-ee-1]),Y=N<4?(x||Y)&&(N==0||N==(I.s<0?3:2)):x>5||x==5&&(N==4||Y||N==6&&(W>0?ee>0?X/G[F-ee]:0:B[re-1])%10&1||N==(I.s<0?8:7)),O<1||!B[0])return B.length=0,Y?(O-=I.e+1,B[0]=G[(c-O%c)%c],I.e=-O||0):B[0]=I.e=0,I;if(W==0?(B.length=re,V=1,re--):(B.length=re+1,V=G[c-W],B[re]=ee>0?n(X/G[F-ee]%G[ee])*V:0),Y)for(;;)if(re==0){for(W=1,ee=B[0];ee>=10;ee/=10,W++);for(ee=B[0]+=V,V=1;ee>=10;ee/=10,V++);W!=V&&(I.e++,B[0]==a&&(B[0]=1));break}else{if(B[re]+=V,B[re]!=a)break;B[re--]=0,V=1}for(W=B.length;B[--W]===0;B.pop());}I.e>De?I.c=I.e=null:I.e<Re&&(I.c=[I.e=0])}return I}function at(I){var O,N=I.e;return N===null?I.toString():(O=g(I.c),O=N<=pe||N>=Le?A(O,N):k(O,N,"0"),I.s<0?"-"+O:O)}return M.absoluteValue=M.abs=function(){var I=new J(this);return I.s<0&&(I.s=1),I},M.comparedTo=function(I,O){return w(this,new J(I,O))},M.decimalPlaces=M.dp=function(I,O){var N,Y,F,W=this;if(I!=null)return b(I,0,h),O==null?O=fe:b(O,0,8),Te(new J(W),I+W.e+1,O);if(!(N=W.c))return null;if(Y=((F=N.length-1)-y(this.e/c))*c,F=N[F])for(;F%10==0;F/=10,Y--);return Y<0&&(Y=0),Y},M.dividedBy=M.div=function(I,O){return T(this,new J(I,O),ie,fe)},M.dividedToIntegerBy=M.idiv=function(I,O){return T(this,new J(I,O),0,1)},M.exponentiatedBy=M.pow=function(I,O){var N,Y,F,W,ee,V,X,re,x,B=this;if(I=new J(I),I.c&&!I.isInteger())throw Error(s+"Exponent not an integer: "+at(I));if(O!=null&&(O=new J(O)),V=I.e>14,!B.c||!B.c[0]||B.c[0]==1&&!B.e&&B.c.length==1||!I.c||!I.c[0])return x=new J(Math.pow(+at(B),V?2-v(I):+at(I))),O?x.mod(O):x;if(X=I.s<0,O){if(O.c?!O.c[0]:!O.s)return new J(NaN);Y=!X&&B.isInteger()&&O.isInteger(),Y&&(B=B.mod(O))}else{if(I.e>9&&(B.e>0||B.e<-1||(B.e==0?B.c[0]>1||V&&B.c[1]>=24e7:B.c[0]<8e13||V&&B.c[0]<=9999975e7)))return W=B.s<0&&v(I)?-0:0,B.e>-1&&(W=1/W),new J(X?1/W:W);ut&&(W=i(ut/c+2))}for(V?(N=new J(.5),X&&(I.s=1),re=v(I)):(F=Math.abs(+at(I)),re=F%2),x=new J(se);;){if(re){if(x=x.times(B),!x.c)break;W?x.c.length>W&&(x.c.length=W):Y&&(x=x.mod(O))}if(F){if(F=n(F/2),F===0)break;re=F%2}else if(I=I.times(N),Te(I,I.e+1,1),I.e>14)re=v(I);else{if(F=+at(I),F===0)break;re=F%2}B=B.times(B),W?B.c&&B.c.length>W&&(B.c.length=W):Y&&(B=B.mod(O))}return Y?x:(X&&(x=se.div(x)),O?x.mod(O):W?Te(x,ut,fe,ee):x)},M.integerValue=function(I){var O=new J(this);return I==null?I=fe:b(I,0,8),Te(O,O.e+1,I)},M.isEqualTo=M.eq=function(I,O){return w(this,new J(I,O))===0},M.isFinite=function(){return!!this.c},M.isGreaterThan=M.gt=function(I,O){return w(this,new J(I,O))>0},M.isGreaterThanOrEqualTo=M.gte=function(I,O){return(O=w(this,new J(I,O)))===1||O===0},M.isInteger=function(){return!!this.c&&y(this.e/c)>this.c.length-2},M.isLessThan=M.lt=function(I,O){return w(this,new J(I,O))<0},M.isLessThanOrEqualTo=M.lte=function(I,O){return(O=w(this,new J(I,O)))===-1||O===0},M.isNaN=function(){return!this.s},M.isNegative=function(){return this.s<0},M.isPositive=function(){return this.s>0},M.isZero=function(){return!!this.c&&this.c[0]==0},M.minus=function(I,O){var N,Y,F,W,ee=this,V=ee.s;if(I=new J(I,O),O=I.s,!V||!O)return new J(NaN);if(V!=O)return I.s=-O,ee.plus(I);var X=ee.e/c,re=I.e/c,x=ee.c,B=I.c;if(!X||!re){if(!x||!B)return x?(I.s=-O,I):new J(B?ee:NaN);if(!x[0]||!B[0])return B[0]?(I.s=-O,I):new J(x[0]?ee:fe==3?-0:0)}if(X=y(X),re=y(re),x=x.slice(),V=X-re){for((W=V<0)?(V=-V,F=x):(re=X,F=B),F.reverse(),O=V;O--;F.push(0));F.reverse()}else for(Y=(W=(V=x.length)<(O=B.length))?V:O,V=O=0;O<Y;O++)if(x[O]!=B[O]){W=x[O]<B[O];break}if(W&&(F=x,x=B,B=F,I.s=-I.s),O=(Y=B.length)-(N=x.length),O>0)for(;O--;x[N++]=0);for(O=a-1;Y>V;){if(x[--Y]<B[Y]){for(N=Y;N&&!x[--N];x[N]=O);--x[N],x[Y]+=a}x[Y]-=B[Y]}for(;x[0]==0;x.splice(0,1),--re);return x[0]?ze(I,x,re):(I.s=fe==3?-1:1,I.c=[I.e=0],I)},M.modulo=M.mod=function(I,O){var N,Y,F=this;return I=new J(I,O),!F.c||!I.s||I.c&&!I.c[0]?new J(NaN):!I.c||F.c&&!F.c[0]?new J(F):(je==9?(Y=I.s,I.s=1,N=T(F,I,0,3),I.s=Y,N.s*=Y):N=T(F,I,0,je),I=F.minus(N.times(I)),!I.c[0]&&je==1&&(I.s=F.s),I)},M.multipliedBy=M.times=function(I,O){var N,Y,F,W,ee,V,X,re,x,B,G,Z,he,Be,He,Fe=this,Ke=Fe.c,nt=(I=new J(I,O)).c;if(!Ke||!nt||!Ke[0]||!nt[0])return!Fe.s||!I.s||Ke&&!Ke[0]&&!nt||nt&&!nt[0]&&!Ke?I.c=I.e=I.s=null:(I.s*=Fe.s,!Ke||!nt?I.c=I.e=null:(I.c=[0],I.e=0)),I;for(Y=y(Fe.e/c)+y(I.e/c),I.s*=Fe.s,X=Ke.length,B=nt.length,X<B&&(he=Ke,Ke=nt,nt=he,F=X,X=B,B=F),F=X+B,he=[];F--;he.push(0));for(Be=a,He=d,F=B;--F>=0;){for(N=0,G=nt[F]%He,Z=nt[F]/He|0,ee=X,W=F+ee;W>F;)re=Ke[--ee]%He,x=Ke[ee]/He|0,V=Z*re+x*G,re=G*re+V%He*He+he[W]+N,N=(re/Be|0)+(V/He|0)+Z*x,he[W--]=re%Be;he[W]=N}return N?++Y:he.splice(0,1),ze(I,he,Y)},M.negated=function(){var I=new J(this);return I.s=-I.s||null,I},M.plus=function(I,O){var N,Y=this,F=Y.s;if(I=new J(I,O),O=I.s,!F||!O)return new J(NaN);if(F!=O)return I.s=-O,Y.minus(I);var W=Y.e/c,ee=I.e/c,V=Y.c,X=I.c;if(!W||!ee){if(!V||!X)return new J(F/0);if(!V[0]||!X[0])return X[0]?I:new J(V[0]?Y:F*0)}if(W=y(W),ee=y(ee),V=V.slice(),F=W-ee){for(F>0?(ee=W,N=X):(F=-F,N=V),N.reverse();F--;N.push(0));N.reverse()}for(F=V.length,O=X.length,F-O<0&&(N=X,X=V,V=N,O=F),F=0;O;)F=(V[--O]=V[O]+X[O]+F)/a|0,V[O]=a===V[O]?0:V[O]%a;return F&&(V=[F].concat(V),++ee),ze(I,V,ee)},M.precision=M.sd=function(I,O){var N,Y,F,W=this;if(I!=null&&I!==!!I)return b(I,1,h),O==null?O=fe:b(O,0,8),Te(new J(W),I,O);if(!(N=W.c))return null;if(F=N.length-1,Y=F*c+1,F=N[F]){for(;F%10==0;F/=10,Y--);for(F=N[0];F>=10;F/=10,Y++);}return I&&W.e+1>Y&&(Y=W.e+1),Y},M.shiftedBy=function(I){return b(I,-u,u),this.times("1e"+I)},M.squareRoot=M.sqrt=function(){var I,O,N,Y,F,W=this,ee=W.c,V=W.s,X=W.e,re=ie+4,x=new J("0.5");if(V!==1||!ee||!ee[0])return new J(!V||V<0&&(!ee||ee[0])?NaN:ee?W:1/0);if(V=Math.sqrt(+at(W)),V==0||V==1/0?(O=g(ee),(O.length+X)%2==0&&(O+="0"),V=Math.sqrt(+O),X=y((X+1)/2)-(X<0||X%2),V==1/0?O="5e"+X:(O=V.toExponential(),O=O.slice(0,O.indexOf("e")+1)+X),N=new J(O)):N=new J(V+""),N.c[0]){for(X=N.e,V=X+re,V<3&&(V=0);;)if(F=N,N=x.times(F.plus(T(W,F,re,1))),g(F.c).slice(0,V)===(O=g(N.c)).slice(0,V))if(N.e<X&&--V,O=O.slice(V-3,V+1),O=="9999"||!Y&&O=="4999"){if(!Y&&(Te(F,F.e+ie+2,0),F.times(F).eq(W))){N=F;break}re+=4,V+=4,Y=1}else{(!+O||!+O.slice(1)&&O.charAt(0)=="5")&&(Te(N,N.e+ie+2,1),I=!N.times(N).eq(W));break}}return Te(N,N.e+ie+1,fe,I)},M.toExponential=function(I,O){return I!=null&&(b(I,0,h),I++),Ee(this,I,O,1)},M.toFixed=function(I,O){return I!=null&&(b(I,0,h),I=I+this.e+1),Ee(this,I,O)},M.toFormat=function(I,O,N){var Y,F=this;if(N==null)I!=null&&O&&typeof O=="object"?(N=O,O=null):I&&typeof I=="object"?(N=I,I=O=null):N=Ye;else if(typeof N!="object")throw Error(s+"Argument not an object: "+N);if(Y=F.toFixed(I,O),F.c){var W,ee=Y.split("."),V=+N.groupSize,X=+N.secondaryGroupSize,re=N.groupSeparator||"",x=ee[0],B=ee[1],G=F.s<0,Z=G?x.slice(1):x,he=Z.length;if(X&&(W=V,V=X,X=W,he-=W),V>0&&he>0){for(W=he%V||V,x=Z.substr(0,W);W<he;W+=V)x+=re+Z.substr(W,V);X>0&&(x+=re+Z.slice(W)),G&&(x="-"+x)}Y=B?x+(N.decimalSeparator||"")+((X=+N.fractionGroupSize)?B.replace(new RegExp("\\d{"+X+"}\\B","g"),"$&"+(N.fractionGroupSeparator||"")):B):x}return(N.prefix||"")+Y+(N.suffix||"")},M.toFraction=function(I){var O,N,Y,F,W,ee,V,X,re,x,B,G,Z=this,he=Z.c;if(I!=null&&(V=new J(I),!V.isInteger()&&(V.c||V.s!==1)||V.lt(se)))throw Error(s+"Argument "+(V.isInteger()?"out of range: ":"not an integer: ")+at(V));if(!he)return new J(Z);for(O=new J(se),re=N=new J(se),Y=X=new J(se),G=g(he),W=O.e=G.length-Z.e-1,O.c[0]=l[(ee=W%c)<0?c+ee:ee],I=!I||V.comparedTo(O)>0?W>0?O:re:V,ee=De,De=1/0,V=new J(G),X.c[0]=0;x=T(V,O,0,1),F=N.plus(x.times(Y)),F.comparedTo(I)!=1;)N=Y,Y=F,re=X.plus(x.times(F=re)),X=F,O=V.minus(x.times(F=O)),V=F;return F=T(I.minus(N),Y,0,1),X=X.plus(F.times(re)),N=N.plus(F.times(Y)),X.s=re.s=Z.s,W=W*2,B=T(re,Y,W,fe).minus(Z).abs().comparedTo(T(X,N,W,fe).minus(Z).abs())<1?[re,Y]:[X,N],De=ee,B},M.toNumber=function(){return+at(this)},M.toPrecision=function(I,O){return I!=null&&b(I,1,h),Ee(this,I,O,2)},M.toString=function(I){var O,N=this,Y=N.s,F=N.e;return F===null?Y?(O="Infinity",Y<0&&(O="-"+O)):O="NaN":(I==null?O=F<=pe||F>=Le?A(g(N.c),F):k(g(N.c),F,"0"):I===10&&de?(N=Te(new J(N),ie+F+1,fe),O=k(g(N.c),N.e,"0")):(b(I,2,Xe.length,"Base"),O=D(k(g(N.c),F,"0"),10,I,Y,!0)),Y<0&&N.c[0]&&(O="-"+O)),O},M.valueOf=M.toJSON=function(){return at(this)},M._isBigNumber=!0,C!=null&&J.set(C),J}function y(C){var T=C|0;return C>0||C===T?T:T-1}function g(C){for(var T,D,j=1,M=C.length,se=C[0]+"";j<M;){for(T=C[j++]+"",D=c-T.length;D--;T="0"+T);se+=T}for(M=se.length;se.charCodeAt(--M)===48;);return se.slice(0,M+1||1)}function w(C,T){var D,j,M=C.c,se=T.c,ie=C.s,fe=T.s,pe=C.e,Le=T.e;if(!ie||!fe)return null;if(D=M&&!M[0],j=se&&!se[0],D||j)return D?j?0:-fe:ie;if(ie!=fe)return ie;if(D=ie<0,j=pe==Le,!M||!se)return j?0:!M^D?1:-1;if(!j)return pe>Le^D?1:-1;for(fe=(pe=M.length)<(Le=se.length)?pe:Le,ie=0;ie<fe;ie++)if(M[ie]!=se[ie])return M[ie]>se[ie]^D?1:-1;return pe==Le?0:pe>Le^D?1:-1}function b(C,T,D,j){if(C<T||C>D||C!==n(C))throw Error(s+(j||"Argument")+(typeof C=="number"?C<T||C>D?" out of range: ":" not an integer: ":" not a primitive number: ")+String(C))}function v(C){var T=C.c.length-1;return y(C.e/c)==T&&C.c[T]%2!=0}function A(C,T){return(C.length>1?C.charAt(0)+"."+C.slice(1):C)+(T<0?"e":"e+")+T}function k(C,T,D){var j,M;if(T<0){for(M=D+".";++T;M+=D);C=M+C}else if(j=C.length,++T>j){for(M=D,T-=j;--T;M+=D);C+=M}else T<j&&(C=C.slice(0,T)+"."+C.slice(T));return C}e=p(),e.default=e.BigNumber=e,typeof define=="function"&&define.amd?define(function(){return e}):typeof t_!="undefined"&&t_.exports?t_.exports=e:(r||(r=typeof self!="undefined"&&self?self:window),r.BigNumber=e)})(Cye)});var VP=m((kye,Dye)=>{f();"use strict";var uXe=Math.exp;kye=Dye.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,i=0,n=0,s=0,o,a={};function c(u,l){return 1-uXe(-(u-l)/e)}return a.push=function(l,d){if(o){let h=c(l,o),p=d-t,y=h*p;t=h*d+(1-h)*t,i=(1-h)*(i+p*y),n=Math.sqrt(i),s=t+h*p}else t=d;o=l},a.movingAverage=function(){return t},a.variance=function(){return i},a.deviation=function(){return n},a.forecast=function(){return s},a}});var Mye=m((IOt,Lye)=>{f();"use strict";var{EventEmitter:lXe}=Ut(),{BigNumber:r_}=Oye(),Nye=VP(),fXe=jy(),Bye=class extends lXe{constructor(e,t){super();this._options=t,this._queue=[],this._stats={dataReceived:r_(0),dataSent:r_(0)},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);let i=this._options.movingAverageIntervals;for(let n=0;n<e.length;n++){let s=e[n];this._stats[s]=r_(0),this._movingAverages[s]={};for(let o=0;o<i.length;o++){let a=i[o];(this._movingAverages[s][a]=Nye(a)).push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}toJSON(){let e=this.snapshot,t=this.movingAverages,i={dataReceived:e.dataReceived.toString(),dataSent:e.dataSent.toString(),movingAverages:{}},n=Object.keys(t);for(let s of n){i.movingAverages[s]={};for(let o of Object.keys(t[s]))i.movingAverages[s][o]=t[s][o].movingAverage()}return i}push(e,t){this._queue.push([e,t,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout=fXe(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(e of this._queue)this._applyOp(e);this._queue=[],this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let t=e-this._frequencyLastTime;Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let o=n/(t||1)*1e3,a=this._movingAverages[e];a||(a=this._movingAverages[e]={});let c=this._options.movingAverageIntervals;for(let u=0;u<c.length;u++){let l=c[u],d=a[l];d||(d=a[l]=Nye(l)),d.push(i,o)}}_applyOp(e){let t=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);let n;Object.prototype.hasOwnProperty.call(this._stats,t)?n=this._stats[t]:n=this._stats[t]=r_(0),this._stats[t]=n.plus(i),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=i}};Lye.exports=Bye});var Uye=m((TOt,qye)=>{f();"use strict";var dXe=Uu(),{pipe:hXe}=dr(),{tap:jye}=e_(),pXe=Pye(),{METRICS:yXe}=U8(),zP=Mye(),HP=["dataReceived","dataSent"],gXe={in:"dataReceived",out:"dataSent"},i_=class{constructor(e){this._options=dXe(yXe,e),this._globalStats=new zP(HP,this._options),this._peerStats=new Map,this._protocolStats=new Map,this._oldPeers=pXe(this._options.maxOldPeersRetention),this._running=!1,this._onMessage=this._onMessage.bind(this),this._systems=new Map}start(){this._running=!0}stop(){this._running=!1,this._globalStats.stop();for(let e of this._peerStats.values())e.stop();for(let e of this._protocolStats.values())e.stop()}get global(){return this._globalStats}get peers(){return Array.from(this._peerStats.keys())}getComponentMetrics(){return this._systems}updateComponentMetric({system:e="libp2p",component:t,metric:i,value:n}){this._systems.has(e)||this._systems.set(e,new Map);let s=this._systems.get(e);s.has(t)||s.set(t,new Map),s.get(t).set(i,n)}forPeer(e){let t=e.toB58String();return this._peerStats.get(t)||this._oldPeers.get(t)}get protocols(){return Array.from(this._protocolStats.keys())}forProtocol(e){return this._protocolStats.get(e)}onPeerDisconnected(e){let t=e.toB58String(),i=this._peerStats.get(t);i&&(i.stop(),this._peerStats.delete(t),this._oldPeers.set(t,i))}_onMessage({remotePeer:e,protocol:t,direction:i,dataLength:n}){if(!this._running)return;let s=gXe[i],o=this.forPeer(e);if(o||(o=new zP(HP,this._options),this._peerStats.set(e.toB58String(),o)),o.push(s,n),this._globalStats.push(s,n),t){let a=this.forProtocol(t);a||(a=new zP(HP,this._options),this._protocolStats.set(t,a)),a.push(s,n)}}updatePlaceholder(e,t){if(!this._running)return;let i=this.forPeer(e),n=t.toB58String(),s=this.forPeer(t),o=i;s&&(o=i_.mergeStats(s,o),this._oldPeers.delete(n)),this._peerStats.delete(e.toB58String()),this._peerStats.set(n,o),o.start()}trackStream({stream:e,remotePeer:t,protocol:i}){let n=this,s=e.source;e.source=jye(a=>n._onMessage({remotePeer:t,protocol:i,direction:"in",dataLength:a.length}))(s);let o=e.sink;return e.sink=a=>hXe(a,jye(c=>n._onMessage({remotePeer:t,protocol:i,direction:"out",dataLength:c.length})),o),e}static mergeStats(e,t){return e.stop(),t.stop(),e._queue=[...e._queue,...t._queue],e}};qye.exports=i_});var $P=m((POt,Kye)=>{f();"use strict";function Fye(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function mXe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Fye(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Fye(new n,t)}}Kye.exports=mXe});var n_=m((COt,$ye)=>{f();"use strict";var Vye=sn(),zye=go(),{pipe:bXe}=dr(),wXe=$P(),{fromString:_Xe}=(ct(),Qr),vXe=Rd(),{source:EXe}=ua(),Hye=_Xe(`
`);function GP(r){return zye.encode.single(new Vye([r,Hye]))}function SXe(r,e){r.push(GP(e))}async function RXe(r,e){r.push(e.reduce((t,i)=>t.append(GP(i)),new Vye))}async function AXe(r,e){let t=1,i={[Symbol.asyncIterator](){return this},next:()=>r.next(t)},n=i;e&&e.signal&&(n=EXe(i,e.signal));let s=a=>{t=a},o=await bXe(n,zye.decode({onLength:s}),vXe);if(o.get(o.length-1)!==Hye[0])throw wXe(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return o.shallowSlice(0,-1)}$ye.exports={encode:GP,write:SXe,writeAll:RXe,read:AXe}});var Yye=m((OOt,Wye)=>{f();"use strict";var Gye=le(),xXe=$P(),H1=n_(),IXe=fh(),$1=Object.assign(Gye("mss:select"),{error:Gye("mss:select:error")});Wye.exports=async function(e,t,i,n){t=Array.isArray(t)?[...t]:[t];let{reader:s,writer:o,rest:a,stream:c}=IXe(e),u=t.shift();if(!u)throw new Error("At least one protocol must be specified");i?($1('select: write ["%s", "%s"]',i,u),H1.writeAll(o,[i,u])):($1('select: write "%s"',u),H1.write(o,u));let l=(await H1.read(s,n)).toString();if($1('select: read "%s"',l),l===i&&(l=(await H1.read(s,n)).toString(),$1('select: read "%s"',l)),l===u)return a(),{stream:c,protocol:u};for(let d of t){$1('select: write "%s"',d),H1.write(o,d);let h=(await H1.read(s,n)).toString();if($1('select: read "%s" for "%s"',h,d),h===d)return a(),{stream:c,protocol:d}}throw a(),xXe(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}});var WP=m(Xye=>{f();"use strict";Xye.PROTOCOL_ID="/multistream/1.0.0"});var Jye=m((DOt,Zye)=>{f();"use strict";var Qye=le(),TXe=sn(),G1=n_(),PXe=fh(),{PROTOCOL_ID:YP}=WP(),Vm=Object.assign(Qye("mss:handle"),{error:Qye("mss:handle:error")});Zye.exports=async function(e,t,i){t=Array.isArray(t)?t:[t];let{writer:n,reader:s,rest:o,stream:a}=PXe(e);for(;;){let c=(await G1.read(s,i)).toString();if(Vm('read "%s"',c),c===YP){Vm('respond with "%s" for "%s"',YP,c),G1.write(n,YP);continue}if(t.includes(c))return G1.write(n,c),Vm('respond with "%s" for "%s"',c,c),o(),{stream:a,protocol:c};if(c==="ls"){G1.write(n,new TXe(t.map(u=>G1.encode(u)))),Vm('respond with "%s" for %s',t,c);continue}G1.write(n,"na"),Vm('respond with "na" for "%s"',c)}}});var i2e=m((NOt,r2e)=>{f();"use strict";var CXe=ib(),e2e=le(),t2e=n_(),OXe=fh(),kXe=go(),{pipe:DXe}=dr(),NXe=Object.assign(e2e("mss:ls"),{error:e2e("mss:ls:error")});r2e.exports=async function(e,t){let{reader:i,writer:n,rest:s,stream:o}=OXe(e);NXe('write "ls"'),t2e.write(n,"ls"),s();let a=await t2e.read(i,t),c=CXe([a]),u=[];return await DXe(c,kXe.decode(),async d=>{for await(let h of d)u.push(h.shallowSlice(0,-1).toString())}),{stream:o,protocols:u}}});var a2e=m(s_=>{f();"use strict";var n2e=Yye(),BXe=Jye(),LXe=i2e(),{PROTOCOL_ID:XP}=WP();s_.PROTOCOL_ID=XP;var QP=class{constructor(e){this._stream=e,this._shaken=!1}async _handshake(e){if(this._shaken)return;let{stream:t}=await n2e(this._stream,XP,void 0,e);this._stream=t,this._shaken=!0}},s2e=class extends QP{select(e,t){return n2e(this._stream,e,this._shaken?void 0:XP,t)}async ls(e){await this._handshake(e);let t=await LXe(this._stream,e),{stream:i,protocols:n}=t;return this._stream=i,n}};s_.Dialer=s2e;var o2e=class extends QP{handle(e,t){return BXe(this._stream,e,t)}};s_.Listener=o2e});var u2e=m((LOt,c2e)=>{f();"use strict";var MXe={OPEN:"open",CLOSING:"closing",CLOSED:"closed"};c2e.exports=MXe});var y2e=m((MOt,p2e)=>{f();"use strict";var l2e=ot(),{Multiaddr:jXe}=ft(),Ps=jx(),{OPEN:qXe,CLOSING:f2e,CLOSED:ZP}=u2e(),d2e=Symbol.for("@libp2p/interface-connection/connection"),h2e=class{constructor({localAddr:e,remoteAddr:t,localPeer:i,remotePeer:n,newStream:s,close:o,getStreams:a,stat:c}){UXe(e,i,n,s,o,a,c),this.id=parseInt(String(Math.random()*1e9)).toString(36)+Date.now(),this.localAddr=e,this.remoteAddr=t,this.localPeer=i,this.remotePeer=n,this._stat={...c,status:qXe},this._newStream=s,this._close=o,this._getStreams=a,this.registry=new Map,this.tags=[]}get[Symbol.toStringTag](){return"Connection"}get[d2e](){return!0}static isConnection(e){return Boolean(e&&e[d2e])}get stat(){return this._stat}get streams(){return this._getStreams()}async newStream(e){if(this.stat.status===f2e)throw Ps(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===ZP)throw Ps(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);let{stream:t,protocol:i}=await this._newStream(e);return this.addStream(t,{protocol:i}),{stream:t,protocol:i}}addStream(e,{protocol:t,metadata:i={}}){this.registry.set(e.id,{protocol:t,...i})}removeStream(e){this.registry.delete(e)}async close(){if(this.stat.status!==ZP){if(this._closing)return this._closing;this.stat.status=f2e,this._closing=await this._close(),this._stat.timeline.close=Date.now(),this.stat.status=ZP}}};p2e.exports=h2e;function UXe(r,e,t,i,n,s,o){if(r&&!jXe.isMultiaddr(r))throw Ps(new Error("localAddr must be an instance of multiaddr"),"ERR_INVALID_PARAMETERS");if(!l2e.isPeerId(e))throw Ps(new Error("localPeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(!l2e.isPeerId(t))throw Ps(new Error("remotePeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw Ps(new Error("new stream must be a function"),"ERR_INVALID_PARAMETERS");if(typeof n!="function")throw Ps(new Error("close must be a function"),"ERR_INVALID_PARAMETERS");if(typeof s!="function")throw Ps(new Error("getStreams must be a function"),"ERR_INVALID_PARAMETERS");if(!o)throw Ps(new Error("connection metadata object must be provided"),"ERR_INVALID_PARAMETERS");if(o.direction!=="inbound"&&o.direction!=="outbound")throw Ps(new Error('direction must be "inbound" or "outbound"'),"ERR_INVALID_PARAMETERS");if(!o.timeline)throw Ps(new Error("connection timeline object must be provided in the stat object"),"ERR_INVALID_PARAMETERS");if(!o.timeline.open)throw Ps(new Error("connection open timestamp must be provided"),"ERR_INVALID_PARAMETERS");if(!o.timeline.upgraded)throw Ps(new Error("connection upgraded timestamp must be provided"),"ERR_INVALID_PARAMETERS")}});var m2e=m(g2e=>{f();"use strict";g2e.Connection=y2e()});var w2e=m((qOt,b2e)=>{f();"use strict";function FXe(r){if(Array.isArray(r)){for(var e=0,t=Array(r.length);e<r.length;e++)t[e]=r[e];return t}else return Array.from(r)}b2e.exports=function(e){var t=void 0,i=void 0;function n(a){if(!(a instanceof Object))throw new Error('Target "'+a+'" is not an object');i=a}function s(a){Object.keys(a).forEach(function(c){var u=a[c];if(typeof u!="function")throw new Error('Trap "'+c+": "+u+'" is not a function');if(!Reflect[c])throw new Error('Trap "'+c+": "+u+'" is not a valid trap')}),t=a}n(function(){}),e&&n(e),s(Reflect);var o=new Proxy({},{get:function(c,u){return function(){for(var l=arguments.length,d=Array(l),h=0;h<l;h++)d[h]=arguments[h];return t[u].apply(null,[i].concat(FXe(d.slice(1))))}}});return{setTarget:n,setHandler:s,getTarget:function(){return i},getHandler:function(){return t},proxy:new Proxy(i,o)}}});var R2e=m((UOt,S2e)=>{f();"use strict";var _2e=le(),ki=Object.assign(_2e("libp2p:upgrader"),{error:_2e("libp2p:upgrader:err")}),Cs=br(),W1=a2e(),{Connection:KXe}=m2e(),VXe=ot(),{pipe:zXe}=dr(),v2e=w2e(),{codes:Os}=wr(),E2e=class{constructor({localPeer:e,metrics:t,connectionGater:i,cryptos:n=new Map,muxers:s=new Map,onConnectionEnd:o=()=>{},onConnection:a=()=>{}}){this.connectionGater=i,this.localPeer=e,this.metrics=t,this.cryptos=n,this.muxers=s,this.protector=null,this.protocols=new Map,this.onConnection=a,this.onConnectionEnd=o}async upgradeInbound(e){let t,i,n,s,o,a,c;if(await this.connectionGater.denyInboundConnection(e))throw Cs(new Error("The multiaddr connection is blocked by gater.acceptConnection"),Os.ERR_CONNECTION_INTERCEPTED);if(this.metrics){({setTarget:a,proxy:c}=v2e());let l=(Math.random()*1e9).toString(36)+Date.now();a({toB58String:()=>l}),e=this.metrics.trackStream({stream:e,remotePeer:c})}ki("Starting the inbound connection upgrade");let u=e;this.protector&&(u=await this.protector.protect(e));try{if({conn:t,remotePeer:i,protocol:o}=await this._encryptInbound(this.localPeer,u,this.cryptos),await this.connectionGater.denyInboundEncryptedConnection(i,t))throw Cs(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Os.ERR_CONNECTION_INTERCEPTED);this.muxers.size?{stream:n,Muxer:s}=await this._multiplexInbound(t,this.muxers):n=t}catch(l){throw ki.error("Failed to upgrade inbound connection",l),await e.close(l),l}if(await this.connectionGater.denyInboundUpgradedConnection(i,t))throw Cs(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Os.ERR_CONNECTION_INTERCEPTED);return this.metrics&&(this.metrics.updatePlaceholder(c,i),a(i)),ki("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:o,direction:"inbound",maConn:e,upgradedConn:n,Muxer:s,remotePeer:i})}async upgradeOutbound(e){let t=e.remoteAddr.getPeerId();if(!t)throw Cs(new Error("outbound connection must have a peer id"),Os.ERR_INVALID_MULTIADDR);let i=VXe.createFromB58String(t);if(await this.connectionGater.denyOutboundConnection(i,e))throw Cs(new Error("The multiaddr connection is blocked by connectionGater.denyOutboundConnection"),Os.ERR_CONNECTION_INTERCEPTED);let n,s,o,a,c,u,l;if(this.metrics){({setTarget:u,proxy:l}=v2e());let h=(Math.random()*1e9).toString(36)+Date.now();u({toB58String:()=>h}),e=this.metrics.trackStream({stream:e,remotePeer:l})}ki("Starting the outbound connection upgrade");let d=e;this.protector&&(d=await this.protector.protect(e));try{if({conn:n,remotePeer:s,protocol:a}=await this._encryptOutbound(this.localPeer,d,i,this.cryptos),await this.connectionGater.denyOutboundEncryptedConnection(s,n))throw Cs(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Os.ERR_CONNECTION_INTERCEPTED);this.muxers.size?{stream:o,Muxer:c}=await this._multiplexOutbound(n,this.muxers):o=n}catch(h){throw ki.error("Failed to upgrade outbound connection",h),await e.close(h),h}if(await this.connectionGater.denyOutboundUpgradedConnection(s,n))throw Cs(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Os.ERR_CONNECTION_INTERCEPTED);return this.metrics&&(this.metrics.updatePlaceholder(l,s),u(s)),ki("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:o,Muxer:c,remotePeer:s})}_createConnection({cryptoProtocol:e,direction:t,maConn:i,upgradedConn:n,Muxer:s,remotePeer:o}){let a,c,u;s&&(a=new s({onStream:async h=>{if(!u)return;let p=new W1.Listener(h);try{let{stream:y,protocol:g}=await p.handle(Array.from(this.protocols.keys()));ki("%s: incoming stream opened on %s",t,g),this.metrics&&this.metrics.trackStream({stream:y,remotePeer:o,protocol:g}),u.addStream(h,{protocol:g}),this._onStream({connection:u,stream:{...h,...y},protocol:g})}catch(y){ki.error(y)}},onStreamEnd:h=>{u.removeStream(h.id)}}),c=async h=>{ki("%s: starting new stream on %s",t,h);let p=a.newStream(),y=new W1.Dialer(p);try{let{stream:g,protocol:w}=await y.select(h);return this.metrics&&this.metrics.trackStream({stream:g,remotePeer:o,protocol:w}),{stream:{...p,...g},protocol:w}}catch(g){throw ki.error("could not create new stream",g),Cs(g,Os.ERR_UNSUPPORTED_PROTOCOL)}},zXe(n,a,n).catch(ki.error));let l=i.timeline;i.timeline=new Proxy(l,{set:(...h)=>(u&&h[1]==="close"&&h[2]&&!l.close&&(async()=>{try{u.stat.status==="open"&&await u.close()}catch(p){ki.error(p)}finally{this.onConnectionEnd(u)}})().catch(p=>{ki.error(p)}),Reflect.set(...h))}),i.timeline.upgraded=Date.now();let d=()=>{throw Cs(new Error("connection is not multiplexed"),Os.ERR_CONNECTION_NOT_MULTIPLEXED)};return u=new KXe({localAddr:i.localAddr,remoteAddr:i.remoteAddr,localPeer:this.localPeer,remotePeer:o,stat:{direction:t,timeline:i.timeline,multiplexer:s&&s.multicodec,encryption:e},newStream:c||d,getStreams:()=>a?a.streams:d(),close:async()=>{await i.close(),a&&a.streams.map(h=>h.abort())}}),this.onConnection(u),u}_onStream({connection:e,stream:t,protocol:i}){this.protocols.get(i)({connection:e,stream:t,protocol:i})}async _encryptInbound(e,t,i){let n=new W1.Listener(t),s=Array.from(i.keys());ki("handling inbound crypto protocol selection",s);try{let{stream:o,protocol:a}=await n.handle(s),c=i.get(a);if(ki("encrypting inbound connection..."),!c)throw new Error(`no crypto module found for ${a}`);return{...await c.secureInbound(e,o),protocol:a}}catch(o){throw Cs(o,Os.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,t,i,n){let s=new W1.Dialer(t),o=Array.from(n.keys());ki("selecting outbound crypto protocol",o);try{let{stream:a,protocol:c}=await s.select(o),u=n.get(c);if(ki("encrypting outbound connection to %j",i),!u)throw new Error(`no crypto module found for ${c}`);return{...await u.secureOutbound(e,a,i),protocol:c}}catch(a){throw Cs(a,Os.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,t){let i=new W1.Dialer(e),n=Array.from(t.keys());ki("outbound selecting muxer %s",n);try{let{stream:s,protocol:o}=await i.select(n);ki("%s selected as muxer protocol",o);let a=t.get(o);return{stream:s,Muxer:a}}catch(s){throw Cs(s,Os.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,t){let i=new W1.Listener(e),n=Array.from(t.keys());ki("inbound handling muxers %s",n);try{let{stream:s,protocol:o}=await i.handle(n),a=t.get(o);return{stream:s,Muxer:a}}catch(s){throw Cs(s,Os.ERR_MUXER_UNAVAILABLE)}}};S2e.exports=E2e});var x2e=m((FOt,A2e)=>{f();"use strict";var HXe=async function*(r,e){for await(let t of r)await e(t),yield t};A2e.exports=HXe});var D2e=m((KOt,k2e)=>{f();"use strict";var I2e=le(),xh=br(),{Multiaddr:T2e}=ft(),o_=ot(),{codes:ma}=wr(),P2e=V8(),C2e=Wg(),{pipe:$Xe}=dr(),GXe=Zo(),WXe=rs(),YXe=bn(),XXe=x2e(),nr=Object.assign(I2e("libp2p:peer-store:address-book"),{error:I2e("libp2p:peer-store:address-book:err")}),a_="change:multiaddrs",O2e=class{constructor(e,t,i){this._emit=e,this._store=t,this._addressFilter=i}async consumePeerRecord(e){nr("consumePeerRecord await write lock");let t=await this._store.lock.writeLock();nr("consumePeerRecord got write lock");let i,n;try{let s;try{s=P2e.createFromProtobuf(e.payload)}catch(a){return nr.error("invalid peer record received"),!1}i=s.peerId;let o=s.multiaddrs;if(!i.equals(e.peerId))return nr("signing key does not match PeerId in the PeerRecord"),!1;if(!o||!o.length)return!1;if(await this._store.has(i)){let a=await this._store.load(i);if(a.peerRecordEnvelope){let c=await C2e.createFromProtobuf(a.peerRecordEnvelope);if(P2e.createFromProtobuf(c.payload).seqNumber>=s.seqNumber)return!1}}n=await this._store.patchOrCreate(i,{addresses:await JP(i,o,this._addressFilter,!0),peerRecordEnvelope:e.marshal()}),nr(`stored provided peer record for ${s.peerId.toB58String()}`)}finally{nr("consumePeerRecord release write lock"),t()}return this._emit(a_,{peerId:i,multiaddrs:n.addresses.map(({multiaddr:s})=>s)}),!0}async getRawEnvelope(e){nr("getRawEnvelope await read lock");let t=await this._store.lock.readLock();nr("getRawEnvelope got read lock");try{return(await this._store.load(e)).peerRecordEnvelope}catch(i){if(i.code!==ma.ERR_NOT_FOUND)throw i}finally{nr("getRawEnvelope release read lock"),t()}}async getPeerRecord(e){let t=await this.getRawEnvelope(e);if(!!t)return C2e.createFromProtobuf(t)}async get(e){if(!o_.isPeerId(e))throw nr.error("peerId must be an instance of peer-id to store data"),xh(new Error("peerId must be an instance of peer-id"),ma.ERR_INVALID_PARAMETERS);nr("get wait for read lock");let t=await this._store.lock.readLock();nr("get got read lock");try{return(await this._store.load(e)).addresses}catch(i){if(i.code!==ma.ERR_NOT_FOUND)throw i}finally{nr("get release read lock"),t()}return[]}async set(e,t){if(!o_.isPeerId(e))throw nr.error("peerId must be an instance of peer-id to store data"),xh(new Error("peerId must be an instance of peer-id"),ma.ERR_INVALID_PARAMETERS);if(!Array.isArray(t))throw nr.error("multiaddrs must be an array of Multiaddrs"),xh(new Error("multiaddrs must be an array of Multiaddrs"),ma.ERR_INVALID_PARAMETERS);nr("set await write lock");let i=await this._store.lock.writeLock();nr("set got write lock");let n=!1,s;try{let o=await JP(e,t,this._addressFilter);if(!o.length)return;try{let a=await this._store.load(e);if(n=!0,new Set([...o.map(({multiaddr:c})=>c.toString()),...a.addresses.map(({multiaddr:c})=>c.toString())]).size===a.addresses.length&&o.length===a.addresses.length)return}catch(a){if(a.code!==ma.ERR_NOT_FOUND)throw a}s=await this._store.patchOrCreate(e,{addresses:o}),nr(`set multiaddrs for ${e.toB58String()}`)}finally{nr("set release write lock"),i()}this._emit(a_,{peerId:e,multiaddrs:s.addresses.map(o=>o.multiaddr)}),n||this._emit("peer",e)}async add(e,t){if(!o_.isPeerId(e))throw nr.error("peerId must be an instance of peer-id to store data"),xh(new Error("peerId must be an instance of peer-id"),ma.ERR_INVALID_PARAMETERS);if(!Array.isArray(t))throw nr.error("multiaddrs must be an array of Multiaddrs"),xh(new Error("multiaddrs must be an array of Multiaddrs"),ma.ERR_INVALID_PARAMETERS);nr("add await write lock");let i=await this._store.lock.writeLock();nr("add got write lock");let n,s;try{let o=await JP(e,t,this._addressFilter);if(!o.length)return;try{let a=await this._store.load(e);if(n=!0,new Set([...o.map(({multiaddr:c})=>c.toString()),...a.addresses.map(({multiaddr:c})=>c.toString())]).size===a.addresses.length)return}catch(a){if(a.code!==ma.ERR_NOT_FOUND)throw a}s=await this._store.mergeOrCreate(e,{addresses:o}),nr(`added multiaddrs for ${e.toB58String()}`)}finally{nr("set release write lock"),i()}this._emit(a_,{peerId:e,multiaddrs:s.addresses.map(o=>o.multiaddr)}),n||this._emit("peer",e)}async delete(e){if(!o_.isPeerId(e))throw nr.error("peerId must be an instance of peer-id to store data"),xh(new Error("peerId must be an instance of peer-id"),ma.ERR_INVALID_PARAMETERS);nr("delete await write lock");let t=await this._store.lock.writeLock();nr("delete got write lock");let i;try{i=await this._store.has(e),await this._store.patchOrCreate(e,{addresses:[]})}finally{nr("delete release write lock"),t()}i&&this._emit(a_,{peerId:e,multiaddrs:[]})}async getMultiaddrsForPeer(e,t=i=>i){let i=await this.get(e);return t(i).map(n=>{let s=n.multiaddr,o=s.getPeerId();return o&&o===e.toB58String()?s:s.encapsulate(`/p2p/${e.toB58String()}`)})}};function JP(r,e,t,i=!1){return $Xe(e,n=>XXe(n,s=>{if(!T2e.isMultiaddr(s))throw nr.error("multiaddr must be an instance of Multiaddr"),xh(new Error("multiaddr must be an instance of Multiaddr"),ma.ERR_INVALID_PARAMETERS)}),n=>WXe(n,s=>t(r,s)),n=>YXe(n,s=>({multiaddr:new T2e(s.toString()),isCertified:i})),n=>GXe(n))}k2e.exports=O2e});var j2e=m((VOt,M2e)=>{f();"use strict";var N2e=le(),c_=br(),{codes:Y1}=wr(),eC=ot(),{equals:QXe}=(hi(),dn),ks=Object.assign(N2e("libp2p:peer-store:key-book"),{error:N2e("libp2p:peer-store:key-book:err")}),B2e="change:pubkey",L2e=class{constructor(e,t){this._emit=e,this._store=t}async set(e,t){if(!eC.isPeerId(e))throw ks.error("peerId must be an instance of peer-id to store data"),c_(new Error("peerId must be an instance of peer-id"),Y1.ERR_INVALID_PARAMETERS);if(!t)throw ks.error("publicKey must be an instance of PublicKey to store data"),c_(new Error("publicKey must be an instance of PublicKey"),Y1.ERR_INVALID_PARAMETERS);ks("set await write lock");let i=await this._store.lock.writeLock();ks("set got write lock");let n=!1;try{try{let s=await this._store.load(e);if(s.pubKey&&QXe(s.pubKey.bytes,t.bytes))return}catch(s){if(s.code!==Y1.ERR_NOT_FOUND)throw s}await this._store.patchOrCreate(e,{pubKey:t}),n=!0}finally{ks("set release write lock"),i()}n&&this._emit(B2e,{peerId:e,pubKey:t})}async get(e){if(!eC.isPeerId(e))throw ks.error("peerId must be an instance of peer-id to store data"),c_(new Error("peerId must be an instance of peer-id"),Y1.ERR_INVALID_PARAMETERS);ks("get await write lock");let t=await this._store.lock.readLock();ks("get got write lock");try{return(await this._store.load(e)).pubKey}catch(i){if(i.code!==Y1.ERR_NOT_FOUND)throw i}finally{ks("get release write lock"),t()}}async delete(e){if(!eC.isPeerId(e))throw ks.error("peerId must be an instance of peer-id to store data"),c_(new Error("peerId must be an instance of peer-id"),Y1.ERR_INVALID_PARAMETERS);ks("delete await write lock");let t=await this._store.lock.writeLock();ks("delete got write lock");try{await this._store.patchOrCreate(e,{pubKey:void 0})}finally{ks("delete release write lock"),t()}this._emit(B2e,{peerId:e,pubKey:void 0})}};M2e.exports=L2e});var K2e=m((zOt,F2e)=>{f();"use strict";var q2e=le(),If=br(),{codes:Oo}=wr(),X1=ot(),{equals:ZXe}=(hi(),dn),Tr=Object.assign(q2e("libp2p:peer-store:metadata-book"),{error:q2e("libp2p:peer-store:metadata-book:err")}),u_="change:metadata",U2e=class{constructor(e,t){this._emit=e,this._store=t}async get(e){if(!X1.isPeerId(e))throw Tr.error("peerId must be an instance of peer-id to store data"),If(new Error("peerId must be an instance of peer-id"),Oo.ERR_INVALID_PARAMETERS);Tr("get await read lock");let t=await this._store.lock.readLock();Tr("get got read lock");try{return(await this._store.load(e)).metadata}catch(i){if(i.code!==Oo.ERR_NOT_FOUND)throw i}finally{Tr("get release read lock"),t()}return new Map}async getValue(e,t){if(!X1.isPeerId(e))throw Tr.error("peerId must be an instance of peer-id to store data"),If(new Error("peerId must be an instance of peer-id"),Oo.ERR_INVALID_PARAMETERS);Tr("getValue await read lock");let i=await this._store.lock.readLock();Tr("getValue got read lock");try{return(await this._store.load(e)).metadata.get(t)}catch(n){if(n.code!==Oo.ERR_NOT_FOUND)throw n}finally{Tr("getValue release write lock"),i()}}async set(e,t){if(!X1.isPeerId(e))throw Tr.error("peerId must be an instance of peer-id to store data"),If(new Error("peerId must be an instance of peer-id"),Oo.ERR_INVALID_PARAMETERS);if(!t||!(t instanceof Map))throw Tr.error("valid metadata must be provided to store data"),If(new Error("valid metadata must be provided"),Oo.ERR_INVALID_PARAMETERS);Tr("set await write lock");let i=await this._store.lock.writeLock();Tr("set got write lock");try{await this._store.mergeOrCreate(e,{metadata:t})}finally{Tr("set release write lock"),i()}this._emit(u_,{peerId:e,metadata:t})}async setValue(e,t,i){if(!X1.isPeerId(e))throw Tr.error("peerId must be an instance of peer-id to store data"),If(new Error("peerId must be an instance of peer-id"),Oo.ERR_INVALID_PARAMETERS);if(typeof t!="string"||!(i instanceof Uint8Array))throw Tr.error("valid key and value must be provided to store data"),If(new Error("valid key and value must be provided"),Oo.ERR_INVALID_PARAMETERS);Tr("setValue await write lock");let n=await this._store.lock.writeLock();Tr("setValue got write lock");let s;try{try{let a=(await this._store.load(e)).metadata.get(t);if(a!=null&&ZXe(i,a))return}catch(o){if(o.code!==Oo.ERR_NOT_FOUND)throw o}s=await this._store.mergeOrCreate(e,{metadata:new Map([[t,i]])})}finally{Tr("setValue release write lock"),n()}this._emit(u_,{peerId:e,metadata:s.metadata})}async delete(e){if(!X1.isPeerId(e))throw Tr.error("peerId must be an instance of peer-id to store data"),If(new Error("peerId must be an instance of peer-id"),Oo.ERR_INVALID_PARAMETERS);Tr("delete await write lock");let t=await this._store.lock.writeLock();Tr("delete got write lock");let i;try{i=await this._store.has(e),i&&await this._store.patch(e,{metadata:new Map})}finally{Tr("delete release write lock"),t()}i&&this._emit(u_,{peerId:e,metadata:new Map})}async deleteValue(e,t){if(!X1.isPeerId(e))throw Tr.error("peerId must be an instance of peer-id to store data"),If(new Error("peerId must be an instance of peer-id"),Oo.ERR_INVALID_PARAMETERS);Tr("deleteValue await write lock");let i=await this._store.lock.writeLock();Tr("deleteValue got write lock");let n;try{n=(await this._store.load(e)).metadata,n.delete(t),await this._store.patch(e,{metadata:n})}catch(s){if(s.code!==Oo.ERR_NOT_FOUND)throw s}finally{Tr("deleteValue release write lock"),i()}n&&this._emit(u_,{peerId:e,metadata:n})}};F2e.exports=U2e});var $2e=m((HOt,H2e)=>{f();"use strict";var V2e=le(),Q1=br(),{codes:ba}=wr(),tC=ot(),Yr=Object.assign(V2e("libp2p:peer-store:proto-book"),{error:V2e("libp2p:peer-store:proto-book:err")}),l_="change:protocols",z2e=class{constructor(e,t){this._emit=e,this._store=t}async get(e){Yr("get wait for read lock");let t=await this._store.lock.readLock();Yr("get got read lock");try{return(await this._store.load(e)).protocols}catch(i){if(i.code!==ba.ERR_NOT_FOUND)throw i}finally{Yr("get release read lock"),t()}return[]}async set(e,t){if(!tC.isPeerId(e))throw Yr.error("peerId must be an instance of peer-id to store data"),Q1(new Error("peerId must be an instance of peer-id"),ba.ERR_INVALID_PARAMETERS);if(!Array.isArray(t))throw Yr.error("protocols must be provided to store data"),Q1(new Error("protocols must be provided"),ba.ERR_INVALID_PARAMETERS);Yr("set await write lock");let i=await this._store.lock.writeLock();Yr("set got write lock");let n;try{try{let s=await this._store.load(e);if(new Set([...t]).size===s.protocols.length)return}catch(s){if(s.code!==ba.ERR_NOT_FOUND)throw s}n=await this._store.patchOrCreate(e,{protocols:t}),Yr(`stored provided protocols for ${e.toB58String()}`)}finally{Yr("set release write lock"),i()}this._emit(l_,{peerId:e,protocols:n.protocols})}async add(e,t){if(!tC.isPeerId(e))throw Yr.error("peerId must be an instance of peer-id to store data"),Q1(new Error("peerId must be an instance of peer-id"),ba.ERR_INVALID_PARAMETERS);if(!Array.isArray(t))throw Yr.error("protocols must be provided to store data"),Q1(new Error("protocols must be provided"),ba.ERR_INVALID_PARAMETERS);Yr("add await write lock");let i=await this._store.lock.writeLock();Yr("add got write lock");let n;try{try{let s=await this._store.load(e);if(new Set([...s.protocols,...t]).size===s.protocols.length)return}catch(s){if(s.code!==ba.ERR_NOT_FOUND)throw s}n=await this._store.mergeOrCreate(e,{protocols:t}),Yr(`added provided protocols for ${e.toB58String()}`)}finally{Yr("add release write lock"),i()}this._emit(l_,{peerId:e,protocols:n.protocols})}async remove(e,t){if(!tC.isPeerId(e))throw Yr.error("peerId must be an instance of peer-id to store data"),Q1(new Error("peerId must be an instance of peer-id"),ba.ERR_INVALID_PARAMETERS);if(!Array.isArray(t))throw Yr.error("protocols must be provided to store data"),Q1(new Error("protocols must be provided"),ba.ERR_INVALID_PARAMETERS);Yr("remove await write lock");let i=await this._store.lock.writeLock();Yr("remove got write lock");let n;try{try{let s=await this._store.load(e),o=new Set(s.protocols);for(let a of t)o.delete(a);if(s.protocols.length===o.size)return;t=Array.from(o)}catch(s){if(s.code!==ba.ERR_NOT_FOUND)throw s}n=await this._store.patchOrCreate(e,{protocols:t})}finally{Yr("remove release write lock"),i()}this._emit(l_,{peerId:e,protocols:n.protocols})}async delete(e){Yr("delete await write lock");let t=await this._store.lock.writeLock();Yr("delete got write lock");let i;try{i=await this._store.has(e),await this._store.patchOrCreate(e,{protocols:[]})}catch(n){if(n.code!==ba.ERR_NOT_FOUND)throw n}finally{Yr("delete release write lock"),t()}i&&this._emit(l_,{peerId:e,protocols:[]})}};H2e.exports=z2e});var W2e=m(($Ot,G2e)=>{f();"use strict";var Tf=Br(),Z1=Tf.Reader,rC=Tf.Writer,ar=Tf.util,bi=Tf.roots["libp2p-peer"]||(Tf.roots["libp2p-peer"]={});bi.Peer=function(){function r(t){if(this.addresses=[],this.protocols=[],this.metadata=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.addresses=ar.emptyArray,r.prototype.protocols=ar.emptyArray,r.prototype.metadata=ar.emptyArray,r.prototype.pubKey=null,r.prototype.peerRecordEnvelope=null;var e;return Object.defineProperty(r.prototype,"_pubKey",{get:ar.oneOfGetter(e=["pubKey"]),set:ar.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_peerRecordEnvelope",{get:ar.oneOfGetter(e=["peerRecordEnvelope"]),set:ar.oneOfSetter(e)}),r.encode=function(i,n){if(n||(n=rC.create()),i.addresses!=null&&i.addresses.length)for(var s=0;s<i.addresses.length;++s)bi.Address.encode(i.addresses[s],n.uint32(10).fork()).ldelim();if(i.protocols!=null&&i.protocols.length)for(var s=0;s<i.protocols.length;++s)n.uint32(18).string(i.protocols[s]);if(i.metadata!=null&&i.metadata.length)for(var s=0;s<i.metadata.length;++s)bi.Metadata.encode(i.metadata[s],n.uint32(26).fork()).ldelim();return i.pubKey!=null&&Object.hasOwnProperty.call(i,"pubKey")&&n.uint32(34).bytes(i.pubKey),i.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(i,"peerRecordEnvelope")&&n.uint32(42).bytes(i.peerRecordEnvelope),n},r.decode=function(i,n){i instanceof Z1||(i=Z1.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new bi.Peer;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.addresses&&o.addresses.length||(o.addresses=[]),o.addresses.push(bi.Address.decode(i,i.uint32()));break;case 2:o.protocols&&o.protocols.length||(o.protocols=[]),o.protocols.push(i.string());break;case 3:o.metadata&&o.metadata.length||(o.metadata=[]),o.metadata.push(bi.Metadata.decode(i,i.uint32()));break;case 4:o.pubKey=i.bytes();break;case 5:o.peerRecordEnvelope=i.bytes();break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof bi.Peer)return i;var n=new bi.Peer;if(i.addresses){if(!Array.isArray(i.addresses))throw TypeError(".Peer.addresses: array expected");n.addresses=[];for(var s=0;s<i.addresses.length;++s){if(typeof i.addresses[s]!="object")throw TypeError(".Peer.addresses: object expected");n.addresses[s]=bi.Address.fromObject(i.addresses[s])}}if(i.protocols){if(!Array.isArray(i.protocols))throw TypeError(".Peer.protocols: array expected");n.protocols=[];for(var s=0;s<i.protocols.length;++s)n.protocols[s]=String(i.protocols[s])}if(i.metadata){if(!Array.isArray(i.metadata))throw TypeError(".Peer.metadata: array expected");n.metadata=[];for(var s=0;s<i.metadata.length;++s){if(typeof i.metadata[s]!="object")throw TypeError(".Peer.metadata: object expected");n.metadata[s]=bi.Metadata.fromObject(i.metadata[s])}}return i.pubKey!=null&&(typeof i.pubKey=="string"?ar.base64.decode(i.pubKey,n.pubKey=ar.newBuffer(ar.base64.length(i.pubKey)),0):i.pubKey.length&&(n.pubKey=i.pubKey)),i.peerRecordEnvelope!=null&&(typeof i.peerRecordEnvelope=="string"?ar.base64.decode(i.peerRecordEnvelope,n.peerRecordEnvelope=ar.newBuffer(ar.base64.length(i.peerRecordEnvelope)),0):i.peerRecordEnvelope.length&&(n.peerRecordEnvelope=i.peerRecordEnvelope)),n},r.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addresses=[],s.protocols=[],s.metadata=[]),i.addresses&&i.addresses.length){s.addresses=[];for(var o=0;o<i.addresses.length;++o)s.addresses[o]=bi.Address.toObject(i.addresses[o],n)}if(i.protocols&&i.protocols.length){s.protocols=[];for(var o=0;o<i.protocols.length;++o)s.protocols[o]=i.protocols[o]}if(i.metadata&&i.metadata.length){s.metadata=[];for(var o=0;o<i.metadata.length;++o)s.metadata[o]=bi.Metadata.toObject(i.metadata[o],n)}return i.pubKey!=null&&i.hasOwnProperty("pubKey")&&(s.pubKey=n.bytes===String?ar.base64.encode(i.pubKey,0,i.pubKey.length):n.bytes===Array?Array.prototype.slice.call(i.pubKey):i.pubKey,n.oneofs&&(s._pubKey="pubKey")),i.peerRecordEnvelope!=null&&i.hasOwnProperty("peerRecordEnvelope")&&(s.peerRecordEnvelope=n.bytes===String?ar.base64.encode(i.peerRecordEnvelope,0,i.peerRecordEnvelope.length):n.bytes===Array?Array.prototype.slice.call(i.peerRecordEnvelope):i.peerRecordEnvelope,n.oneofs&&(s._peerRecordEnvelope="peerRecordEnvelope")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,Tf.util.toJSONOptions)},r}();bi.Address=function(){function r(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.multiaddr=ar.newBuffer([]),r.prototype.isCertified=null;var e;return Object.defineProperty(r.prototype,"_isCertified",{get:ar.oneOfGetter(e=["isCertified"]),set:ar.oneOfSetter(e)}),r.encode=function(i,n){return n||(n=rC.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),i.isCertified!=null&&Object.hasOwnProperty.call(i,"isCertified")&&n.uint32(16).bool(i.isCertified),n},r.decode=function(i,n){i instanceof Z1||(i=Z1.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new bi.Address;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;case 2:o.isCertified=i.bool();break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof bi.Address)return i;var n=new bi.Address;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?ar.base64.decode(i.multiaddr,n.multiaddr=ar.newBuffer(ar.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),i.isCertified!=null&&(n.isCertified=Boolean(i.isCertified)),n},r.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=ar.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?ar.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),i.isCertified!=null&&i.hasOwnProperty("isCertified")&&(s.isCertified=i.isCertified,n.oneofs&&(s._isCertified="isCertified")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,Tf.util.toJSONOptions)},r}();bi.Metadata=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.key="",r.prototype.value=ar.newBuffer([]),r.encode=function(t,i){return i||(i=rC.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&i.uint32(10).string(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(18).bytes(t.value),i},r.decode=function(t,i){t instanceof Z1||(t=Z1.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new bi.Metadata;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.key=t.string();break;case 2:s.value=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof bi.Metadata)return t;var i=new bi.Metadata;return t.key!=null&&(i.key=String(t.key)),t.value!=null&&(typeof t.value=="string"?ar.base64.decode(t.value,i.value=ar.newBuffer(ar.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.key="",i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=ar.newBuffer(n.value)))),t.key!=null&&t.hasOwnProperty("key")&&(n.key=t.key),t.value!=null&&t.hasOwnProperty("value")&&(n.value=i.bytes===String?ar.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Tf.util.toJSONOptions)},r}();G2e.exports=bi});var nge=m((GOt,ige)=>{f();"use strict";var Y2e=le(),X2e=ot(),Q2e=br(),{codes:f_}=wr(),{Key:JXe}=(Mr(),mp),{base32:eQe}=(en(),Uc),{keys:{unmarshalPublicKey:tQe,marshalPublicKey:rQe}}=Ya(),{Multiaddr:Z2e}=ft(),{Peer:J2e}=W2e(),iQe=kb(),{equals:nQe}=(hi(),dn),ege=Object.assign(Y2e("libp2p:peer-store:store"),{error:Y2e("libp2p:peer-store:store:err")}),tge="/peers/",rge=class{constructor(e){this._datastore=e,this.lock=iQe("peer-store",{singleProcess:!0})}_peerIdToDatastoreKey(e){if(!X2e.isPeerId(e))throw ege.error("peerId must be an instance of peer-id to store data"),Q2e(new Error("peerId must be an instance of peer-id"),f_.ERR_INVALID_PARAMETERS);let t=e.toString();return new JXe(`${tge}${t}`)}async has(e){return this._datastore.has(this._peerIdToDatastoreKey(e))}async delete(e){await this._datastore.delete(this._peerIdToDatastoreKey(e))}async load(e){let t=await this._datastore.get(this._peerIdToDatastoreKey(e)),i=J2e.decode(t),n=i.pubKey?tQe(i.pubKey):e.pubKey,s=new Map;for(let o of i.metadata)s.set(o.key,o.value);return{...i,id:e,pubKey:n,addresses:i.addresses.map(({multiaddr:o,isCertified:a})=>({multiaddr:new Z2e(o),isCertified:a||!1})),metadata:s,peerRecordEnvelope:i.peerRecordEnvelope||void 0}}async save(e){if(e.pubKey!=null&&e.id.pubKey!=null&&!nQe(e.pubKey.bytes,e.id.pubKey.bytes))throw ege.error("peer publicKey bytes do not match peer id publicKey bytes"),Q2e(new Error("publicKey bytes do not match peer id publicKey bytes"),f_.ERR_INVALID_PARAMETERS);let t=new Set,i=J2e.encode({addresses:e.addresses.filter(n=>t.has(n.multiaddr.toString())?!1:(t.add(n.multiaddr.toString()),!0)).sort((n,s)=>n.multiaddr.toString().localeCompare(s.multiaddr.toString())).map(({multiaddr:n,isCertified:s})=>({multiaddr:n.bytes,isCertified:s})),protocols:e.protocols.sort(),pubKey:e.pubKey?rQe(e.pubKey):void 0,metadata:[...e.metadata.keys()].sort().map(n=>({key:n,value:e.metadata.get(n)})),peerRecordEnvelope:e.peerRecordEnvelope}).finish();return await this._datastore.put(this._peerIdToDatastoreKey(e.id),i),this.load(e.id)}async patch(e,t){let i=await this.load(e);return await this._patch(e,t,i)}async patchOrCreate(e,t){let i;try{i=await this.load(e)}catch(n){if(n.code!==f_.ERR_NOT_FOUND)throw n;i={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._patch(e,t,i)}async _patch(e,t,i){return await this.save({...i,...t,id:e})}async merge(e,t){let i=await this.load(e);return this._merge(e,t,i)}async mergeOrCreate(e,t){let i;try{i=await this.load(e)}catch(n){if(n.code!==f_.ERR_NOT_FOUND)throw n;i={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._merge(e,t,i)}async _merge(e,t,i){let n=new Map;return(t.addresses||[]).forEach(s=>{n.set(s.multiaddr.toString(),s.isCertified)}),i.addresses.forEach(({multiaddr:s,isCertified:o})=>{let a=s.toString();n.set(a,Boolean(n.get(a)||o))}),await this.save({id:e,addresses:Array.from(n.entries()).map(([s,o])=>({multiaddr:new Z2e(s),isCertified:o})),protocols:Array.from(new Set([...i.protocols||[],...t.protocols||[]])),metadata:new Map([...i.metadata?i.metadata.entries():[],...t.metadata?t.metadata.entries():[]]),pubKey:t.pubKey||(i!=null?i.pubKey:void 0),peerRecordEnvelope:t.peerRecordEnvelope||(i!=null?i.peerRecordEnvelope:void 0)})}async*all(){for await(let e of this._datastore.queryKeys({prefix:tge})){let t=e.toString().split("/")[2],i=eQe.decode(t);yield this.load(X2e.createFromBytes(i))}}};ige.exports=rge});var cge=m((WOt,age)=>{f();"use strict";var sge=le(),{EventEmitter:sQe}=Ut(),oQe=D2e(),aQe=j2e(),cQe=K2e(),uQe=$2e(),lQe=nge(),ko=Object.assign(sge("libp2p:peer-store"),{error:sge("libp2p:peer-store:err")}),oge=class extends sQe{constructor({peerId:e,datastore:t,addressFilter:i}){super();this._peerId=e,this._store=new lQe(t),this.addressBook=new oQe(this.emit.bind(this),this._store,i),this.keyBook=new aQe(this.emit.bind(this),this._store),this.metadataBook=new cQe(this.emit.bind(this),this._store),this.protoBook=new uQe(this.emit.bind(this),this._store)}async*getPeers(){ko("getPeers await read lock");let e=await this._store.lock.readLock();ko("getPeers got read lock");try{for await(let t of this._store.all())t.id.toB58String()!==this._peerId.toB58String()&&(yield t)}finally{ko("getPeers release read lock"),e()}}async delete(e){ko("delete await write lock");let t=await this._store.lock.writeLock();ko("delete got write lock");try{await this._store.delete(e)}finally{ko("delete release write lock"),t()}}async get(e){ko("get await read lock");let t=await this._store.lock.readLock();ko("get got read lock");try{return this._store.load(e)}finally{ko("get release read lock"),t()}}async has(e){ko("has await read lock");let t=await this._store.lock.readLock();ko("has got read lock");try{return this._store.has(e)}finally{ko("has release read lock"),t()}}};age.exports=oge});var lge=m((YOt,uge)=>{f();"use strict";function fQe(r,e,t){let i=new r(e,t);i._subscribeAdapter=i.subscribe,i._unsubscribeAdapter=i.unsubscribe;function n(o,a){a&&i.on(o,a),i._subscribeAdapter(o)}function s(o,a){a?i.removeListener(o,a):i.removeAllListeners(o),i.listenerCount(o)===0&&i._unsubscribeAdapter(o)}return i.subscribe=n,i.unsubscribe=s,i}uge.exports=fQe});var pge=m((XOt,hge)=>{f();"use strict";var fge=le(),dQe=Object.assign(fge("libp2p:registrar"),{error:fge("libp2p:registrar:err")}),hQe=br(),{codes:{ERR_INVALID_PARAMETERS:pQe}}=wr(),yQe=qx(),dge=class{constructor({peerStore:e,connectionManager:t}){this.peerStore=e,this.connectionManager=t,this.topologies=new Map,this._handle=void 0,this._onDisconnect=this._onDisconnect.bind(this),this.connectionManager.on("peer:disconnect",this._onDisconnect)}get handle(){return this._handle}set handle(e){this._handle=e}getConnection(e){return this.connectionManager.get(e)}async register(e){if(!yQe.isTopology(e))throw dQe.error("topology must be an instance of interfaces/topology"),hQe(new Error("topology must be an instance of interfaces/topology"),pQe);let t=(Math.random()*1e9).toString(36)+Date.now();return this.topologies.set(t,e),await e.setRegistrar(this),t}unregister(e){return this.topologies.delete(e)}_onDisconnect(e){for(let[,t]of this.topologies)t.disconnect(e.remotePeer)}};hge.exports=dge});var mge=m((QOt,gge)=>{f();"use strict";var J1=Br(),yge=J1.Reader,gQe=J1.Writer,$r=J1.util,zm=J1.roots["libp2p-identify"]||(J1.roots["libp2p-identify"]={});zm.Identify=function(){function r(e){if(this.listenAddrs=[],this.protocols=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.protocolVersion="",r.prototype.agentVersion="",r.prototype.publicKey=$r.newBuffer([]),r.prototype.listenAddrs=$r.emptyArray,r.prototype.observedAddr=$r.newBuffer([]),r.prototype.protocols=$r.emptyArray,r.prototype.signedPeerRecord=$r.newBuffer([]),r.encode=function(t,i){if(i||(i=gQe.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&i.uint32(10).bytes(t.publicKey),t.listenAddrs!=null&&t.listenAddrs.length)for(var n=0;n<t.listenAddrs.length;++n)i.uint32(18).bytes(t.listenAddrs[n]);if(t.protocols!=null&&t.protocols.length)for(var n=0;n<t.protocols.length;++n)i.uint32(26).string(t.protocols[n]);return t.observedAddr!=null&&Object.hasOwnProperty.call(t,"observedAddr")&&i.uint32(34).bytes(t.observedAddr),t.protocolVersion!=null&&Object.hasOwnProperty.call(t,"protocolVersion")&&i.uint32(42).string(t.protocolVersion),t.agentVersion!=null&&Object.hasOwnProperty.call(t,"agentVersion")&&i.uint32(50).string(t.agentVersion),t.signedPeerRecord!=null&&Object.hasOwnProperty.call(t,"signedPeerRecord")&&i.uint32(66).bytes(t.signedPeerRecord),i},r.decode=function(t,i){t instanceof yge||(t=yge.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new zm.Identify;t.pos<n;){var o=t.uint32();switch(o>>>3){case 5:s.protocolVersion=t.string();break;case 6:s.agentVersion=t.string();break;case 1:s.publicKey=t.bytes();break;case 2:s.listenAddrs&&s.listenAddrs.length||(s.listenAddrs=[]),s.listenAddrs.push(t.bytes());break;case 4:s.observedAddr=t.bytes();break;case 3:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(t.string());break;case 8:s.signedPeerRecord=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof zm.Identify)return t;var i=new zm.Identify;if(t.protocolVersion!=null&&(i.protocolVersion=String(t.protocolVersion)),t.agentVersion!=null&&(i.agentVersion=String(t.agentVersion)),t.publicKey!=null&&(typeof t.publicKey=="string"?$r.base64.decode(t.publicKey,i.publicKey=$r.newBuffer($r.base64.length(t.publicKey)),0):t.publicKey.length&&(i.publicKey=t.publicKey)),t.listenAddrs){if(!Array.isArray(t.listenAddrs))throw TypeError(".Identify.listenAddrs: array expected");i.listenAddrs=[];for(var n=0;n<t.listenAddrs.length;++n)typeof t.listenAddrs[n]=="string"?$r.base64.decode(t.listenAddrs[n],i.listenAddrs[n]=$r.newBuffer($r.base64.length(t.listenAddrs[n])),0):t.listenAddrs[n].length&&(i.listenAddrs[n]=t.listenAddrs[n])}if(t.observedAddr!=null&&(typeof t.observedAddr=="string"?$r.base64.decode(t.observedAddr,i.observedAddr=$r.newBuffer($r.base64.length(t.observedAddr)),0):t.observedAddr.length&&(i.observedAddr=t.observedAddr)),t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Identify.protocols: array expected");i.protocols=[];for(var n=0;n<t.protocols.length;++n)i.protocols[n]=String(t.protocols[n])}return t.signedPeerRecord!=null&&(typeof t.signedPeerRecord=="string"?$r.base64.decode(t.signedPeerRecord,i.signedPeerRecord=$r.newBuffer($r.base64.length(t.signedPeerRecord)),0):t.signedPeerRecord.length&&(i.signedPeerRecord=t.signedPeerRecord)),i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.listenAddrs=[],n.protocols=[]),i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=$r.newBuffer(n.publicKey))),i.bytes===String?n.observedAddr="":(n.observedAddr=[],i.bytes!==Array&&(n.observedAddr=$r.newBuffer(n.observedAddr))),n.protocolVersion="",n.agentVersion="",i.bytes===String?n.signedPeerRecord="":(n.signedPeerRecord=[],i.bytes!==Array&&(n.signedPeerRecord=$r.newBuffer(n.signedPeerRecord)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?$r.base64.encode(t.publicKey,0,t.publicKey.length):i.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.listenAddrs&&t.listenAddrs.length){n.listenAddrs=[];for(var s=0;s<t.listenAddrs.length;++s)n.listenAddrs[s]=i.bytes===String?$r.base64.encode(t.listenAddrs[s],0,t.listenAddrs[s].length):i.bytes===Array?Array.prototype.slice.call(t.listenAddrs[s]):t.listenAddrs[s]}if(t.protocols&&t.protocols.length){n.protocols=[];for(var s=0;s<t.protocols.length;++s)n.protocols[s]=t.protocols[s]}return t.observedAddr!=null&&t.hasOwnProperty("observedAddr")&&(n.observedAddr=i.bytes===String?$r.base64.encode(t.observedAddr,0,t.observedAddr.length):i.bytes===Array?Array.prototype.slice.call(t.observedAddr):t.observedAddr),t.protocolVersion!=null&&t.hasOwnProperty("protocolVersion")&&(n.protocolVersion=t.protocolVersion),t.agentVersion!=null&&t.hasOwnProperty("agentVersion")&&(n.agentVersion=t.agentVersion),t.signedPeerRecord!=null&&t.hasOwnProperty("signedPeerRecord")&&(n.signedPeerRecord=i.bytes===String?$r.base64.encode(t.signedPeerRecord,0,t.signedPeerRecord.length):i.bytes===Array?Array.prototype.slice.call(t.signedPeerRecord):t.signedPeerRecord),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,J1.util.toJSONOptions)},r}();gge.exports=zm});var xge=m((ZOt,Age)=>{f();"use strict";var bge=le(),Ds=Object.assign(bge("libp2p:identify"),{error:bge("libp2p:identify:err")}),iC=br(),d_=go(),{pipe:h_}=dr(),{collect:wge,take:_ge,consume:vge}=e_(),{fromString:ey}=(ct(),Qr),mQe=ot(),{Multiaddr:nC}=ft(),{toBuffer:Ege}=s8(),Hm=mge(),Sge=Wg(),Rge=V8(),{MULTICODEC_IDENTIFY:bQe,MULTICODEC_IDENTIFY_PUSH:wQe,IDENTIFY_PROTOCOL_VERSION:_Qe,MULTICODEC_IDENTIFY_PROTOCOL_NAME:vQe,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME:EQe,MULTICODEC_IDENTIFY_PROTOCOL_VERSION:SQe,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION:RQe}=dP(),{codes:sC}=wr(),Ih=class{static getProtocolStr(e){return{identifyProtocolStr:`/${e._config.protocolPrefix}/${vQe}/${SQe}`,identifyPushProtocolStr:`/${e._config.protocolPrefix}/${EQe}/${RQe}`}}constructor({libp2p:e}){this._libp2p=e,this.peerStore=e.peerStore,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.handleMessage=this.handleMessage.bind(this);let t=Ih.getProtocolStr(e);this.identifyProtocolStr=t.identifyProtocolStr,this.identifyPushProtocolStr=t.identifyPushProtocolStr,this._host={protocolVersion:`${e._config.protocolPrefix}/${_Qe}`,...e._options.host},this.connectionManager.on("peer:connect",i=>{this.identify(i).catch(Ds.error)}),this.peerStore.on("change:multiaddrs",({peerId:i})=>{i.toString()===this.peerId.toString()&&this.pushToPeerStore().catch(n=>Ds.error(n))}),this.peerStore.on("change:protocols",({peerId:i})=>{i.toString()===this.peerId.toString()&&this.pushToPeerStore().catch(n=>Ds.error(n))})}async start(){await this.peerStore.metadataBook.setValue(this.peerId,"AgentVersion",ey(this._host.agentVersion)),await this.peerStore.metadataBook.setValue(this.peerId,"ProtocolVersion",ey(this._host.protocolVersion))}async stop(){}async push(e){let t=await this.peerStore.addressBook.getRawEnvelope(this.peerId),i=this._libp2p.multiaddrs.map(o=>o.bytes),n=await this.peerStore.protoBook.get(this.peerId),s=e.map(async o=>{try{let{stream:a}=await o.newStream(this.identifyPushProtocolStr);await h_([Hm.Identify.encode({listenAddrs:i,signedPeerRecord:t,protocols:n}).finish()],d_.encode(),a,vge)}catch(a){Ds.error("could not push identify update to peer",a)}});return Promise.all(s)}async pushToPeerStore(){if(!this._libp2p.isStarted())return;let e=[],t;for await(let i of this.peerStore.getPeers())i.protocols.includes(this.identifyPushProtocolStr)&&(t=this.connectionManager.get(i.id))&&e.push(t);await this.push(e)}async identify(e){let{stream:t}=await e.newStream(this.identifyProtocolStr),[i]=await h_([],t,d_.decode(),_ge(1),Ege,wge);if(!i)throw iC(new Error("No data could be retrieved"),sC.ERR_CONNECTION_ENDED);let n;try{n=Hm.Identify.decode(i)}catch(h){throw iC(h,sC.ERR_INVALID_MESSAGE)}let{publicKey:s,listenAddrs:o,protocols:a,observedAddr:c,signedPeerRecord:u}=n,l=await mQe.createFromPubKey(s);if(e.remotePeer.toB58String()!==l.toB58String())throw iC(new Error("identified peer does not match the expected peer"),sC.ERR_INVALID_PEER);let d=Ih.getCleanMultiaddr(c);try{let h=await Sge.openAndCertify(u,Rge.DOMAIN);if(await this.peerStore.addressBook.consumePeerRecord(h)){await this.peerStore.protoBook.set(l,a),await this.peerStore.metadataBook.setValue(l,"AgentVersion",ey(n.agentVersion)),await this.peerStore.metadataBook.setValue(l,"ProtocolVersion",ey(n.protocolVersion));return}}catch(h){Ds("received invalid envelope, discard it and fallback to listenAddrs is available",h)}try{await this.peerStore.addressBook.set(l,o.map(h=>new nC(h)))}catch(h){Ds.error("received invalid addrs",h)}await this.peerStore.protoBook.set(l,a),await this.peerStore.metadataBook.setValue(l,"AgentVersion",ey(n.agentVersion)),await this.peerStore.metadataBook.setValue(l,"ProtocolVersion",ey(n.protocolVersion)),Ds("received observed address of %s",d)}handleMessage({connection:e,stream:t,protocol:i}){switch(i){case this.identifyProtocolStr:return this._handleIdentify({connection:e,stream:t});case this.identifyPushProtocolStr:return this._handlePush({connection:e,stream:t});default:Ds.error("cannot handle unknown protocol %s",i)}}async _handleIdentify({connection:e,stream:t}){try{let i=new Uint8Array(0);this.peerId.pubKey&&(i=this.peerId.pubKey.bytes);let n=await this.peerStore.addressBook.getRawEnvelope(this.peerId),s=await this.peerStore.protoBook.get(this.peerId),o=Hm.Identify.encode({protocolVersion:this._host.protocolVersion,agentVersion:this._host.agentVersion,publicKey:i,listenAddrs:this._libp2p.multiaddrs.map(a=>a.bytes),signedPeerRecord:n,observedAddr:e.remoteAddr.bytes,protocols:s}).finish();await h_([o],d_.encode(),t,vge)}catch(i){Ds.error("could not respond to identify request",i)}}async _handlePush({connection:e,stream:t}){let i;try{let[s]=await h_([],t,d_.decode(),_ge(1),Ege,wge);i=Hm.Identify.decode(s)}catch(s){return Ds.error("received invalid message",s)}let n=e.remotePeer;try{let s=await Sge.openAndCertify(i.signedPeerRecord,Rge.DOMAIN);if(await this.peerStore.addressBook.consumePeerRecord(s)){await this.peerStore.protoBook.set(n,i.protocols);return}}catch(s){Ds("received invalid envelope, discard it and fallback to listenAddrs is available",s)}try{await this.peerStore.addressBook.set(n,i.listenAddrs.map(s=>new nC(s)))}catch(s){Ds.error("received invalid addrs",s)}try{await this.peerStore.protoBook.set(n,i.protocols)}catch(s){Ds.error("received invalid protocols",s)}}static getCleanMultiaddr(e){if(e&&e.length>0)try{return new nC(e)}catch(t){return null}return null}},AQe={IDENTIFY:bQe,IDENTIFY_PUSH:wQe};Ih.multicodecs=AQe;Ih.Messsage=Hm;Age.exports=Ih});var Pge=m((JOt,Tge)=>{f();"use strict";var Th=Br(),p_=Th.Reader,Ige=Th.Writer,ty=Th.util,Cc=Th.roots["libp2p-fetch"]||(Th.roots["libp2p-fetch"]={});Cc.FetchRequest=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.identifier="",r.encode=function(t,i){return i||(i=Ige.create()),t.identifier!=null&&Object.hasOwnProperty.call(t,"identifier")&&i.uint32(10).string(t.identifier),i},r.decode=function(t,i){t instanceof p_||(t=p_.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Cc.FetchRequest;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.identifier=t.string();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Cc.FetchRequest)return t;var i=new Cc.FetchRequest;return t.identifier!=null&&(i.identifier=String(t.identifier)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.identifier=""),t.identifier!=null&&t.hasOwnProperty("identifier")&&(n.identifier=t.identifier),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Th.util.toJSONOptions)},r}();Cc.FetchResponse=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.status=0,r.prototype.data=ty.newBuffer([]),r.encode=function(t,i){return i||(i=Ige.create()),t.status!=null&&Object.hasOwnProperty.call(t,"status")&&i.uint32(8).int32(t.status),t.data!=null&&Object.hasOwnProperty.call(t,"data")&&i.uint32(18).bytes(t.data),i},r.decode=function(t,i){t instanceof p_||(t=p_.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Cc.FetchResponse;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.status=t.int32();break;case 2:s.data=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Cc.FetchResponse)return t;var i=new Cc.FetchResponse;switch(t.status){case"OK":case 0:i.status=0;break;case"NOT_FOUND":case 1:i.status=1;break;case"ERROR":case 2:i.status=2;break}return t.data!=null&&(typeof t.data=="string"?ty.base64.decode(t.data,i.data=ty.newBuffer(ty.base64.length(t.data)),0):t.data.length&&(i.data=t.data)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.status=i.enums===String?"OK":0,i.bytes===String?n.data="":(n.data=[],i.bytes!==Array&&(n.data=ty.newBuffer(n.data)))),t.status!=null&&t.hasOwnProperty("status")&&(n.status=i.enums===String?Cc.FetchResponse.StatusCode[t.status]:t.status),t.data!=null&&t.hasOwnProperty("data")&&(n.data=i.bytes===String?ty.base64.encode(t.data,0,t.data.length):i.bytes===Array?Array.prototype.slice.call(t.data):t.data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Th.util.toJSONOptions)},r.StatusCode=function(){var e={},t=Object.create(e);return t[e[0]="OK"]=0,t[e[1]="NOT_FOUND"]=1,t[e[2]="ERROR"]=2,t}(),r}();Tge.exports=Cc});var Oge=m((ekt,Cge)=>{f();"use strict";Cge.exports={PROTOCOL:"/libp2p/fetch/0.0.1"}});var Lge=m((Nge,Bge)=>{f();"use strict";var kge=le(),xQe=Object.assign(kge("libp2p:fetch"),{error:kge("libp2p:fetch:err")}),oC=br(),{codes:aC}=wr(),y_=go(),{FetchRequest:cC,FetchResponse:wa}=Pge(),Dge=fh(),{PROTOCOL:IQe}=Oge(),$m=class{constructor(e){this._lookupFunctions=new Map,this._libp2p=e,this.handleMessage=this.handleMessage.bind(this)}async fetch(e,t){xQe("dialing %s to %s",this._protocol,e.toB58String?e.toB58String():e);let i=await this._libp2p.dial(e),{stream:n}=await i.newStream($m.PROTOCOL),s=Dge(n),o=new cC({identifier:t});s.write(y_.encode.single(cC.encode(o).finish()));let a=wa.decode((await y_.decode.fromReader(s.reader).next()).value.slice());switch(a.status){case wa.StatusCode.OK:return a.data;case wa.StatusCode.NOT_FOUND:return null;case wa.StatusCode.ERROR:{let c=new TextDecoder().decode(a.data);throw oC(new Error("Error in fetch protocol response: "+c),aC.ERR_INVALID_PARAMETERS)}default:throw oC(new Error("Unknown response status"),aC.ERR_INVALID_MESSAGE)}}async handleMessage(e){let{stream:t}=e,i=Dge(t),n=cC.decode((await y_.decode.fromReader(i.reader).next()).value.slice()),s,o=this._getLookupFunction(n.identifier);if(o){let a=await o(n.identifier);a?s=new wa({status:wa.StatusCode.OK,data:a}):s=new wa({status:wa.StatusCode.NOT_FOUND})}else{let a=new TextEncoder().encode("No lookup function registered for key: "+n.identifier);s=new wa({status:wa.StatusCode.ERROR,data:a})}i.write(y_.encode.single(wa.encode(s).finish()))}_getLookupFunction(e){for(let t of this._lookupFunctions.keys())if(e.startsWith(t))return this._lookupFunctions.get(t);return null}registerLookupFunction(e,t){if(this._lookupFunctions.has(e))throw oC(new Error("Fetch protocol handler for key prefix '"+e+"' already registered"),aC.ERR_KEY_ALREADY_EXISTS);this._lookupFunctions.set(e,t)}unregisterLookupFunction(e,t){t!=null&&this._lookupFunctions.get(e)!==t||this._lookupFunctions.delete(e)}};$m.PROTOCOL=IQe;Nge=Bge.exports=$m});var jge=m((tkt,Mge)=>{f();"use strict";Mge.exports={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32,PROTOCOL_VERSION:"1.0.0",PROTOCOL_NAME:"ping"}});var Hge=m((rkt,zge)=>{f();"use strict";var qge=le(),TQe=Object.assign(qge("libp2p:ping"),{error:qge("libp2p:ping:err")}),PQe=br(),{codes:CQe}=wr(),OQe=Ya(),{pipe:Uge}=dr(),{toBuffer:kQe}=s8(),{collect:DQe,take:NQe}=e_(),{equals:BQe}=(hi(),dn),{PROTOCOL_NAME:Fge,PING_LENGTH:LQe,PROTOCOL_VERSION:Kge}=jge(),Vge=class{static getProtocolStr(e){return`/${e._config.protocolPrefix}/${Fge}/${Kge}`}constructor(e){this._libp2p=e}handleMessage({stream:e}){return Uge(e,e)}async ping(e){let t=`/${this._libp2p._config.protocolPrefix}/${Fge}/${Kge}`;TQe("dialing %s to %s",t,e.toB58String?e.toB58String():e);let i=await this._libp2p.dial(e),{stream:n}=await i.newStream(t),s=Date.now(),o=OQe.randomBytes(LQe),[a]=await Uge([o],n,u=>NQe(1,u),kQe,DQe),c=Date.now();if(!BQe(o,a))throw PQe(new Error("Received wrong ping ack"),CQe.ERR_WRONG_PING_ACK);return c-s}};zge.exports=Vge});var $ge=m(()=>{f()});var Gge=m(uC=>{f();"use strict";Object.defineProperty(uC,"__esModule",{value:!0}),uC.promisify=g_;var MQe="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function g_(r){if(typeof r!="function")throw new TypeError("Argument to promisify must be a function");var e=r[MQe],t=g_.Promise||Promise;if(typeof t!="function")throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var i=this,n=arguments.length,s=Array(n),o=0;o<n;o++)s[o]=arguments[o];return new t(function(a,c){s.push(function(u){if(u)return c(u);for(var l=arguments.length,d=Array(1<l?l-1:0),h=1;h<l;h++)d[h-1]=arguments[h];if(d.length===1||!e)return a(d[0]);var p={};d.forEach(function(y,g){var w=e[g];w&&(p[w]=y)}),a(p)}),r.apply(i,s)})}}g_.argumentNames="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__",g_.Promise=void 0});var Yge=m((okt,Wge)=>{f();"use strict";var jQe=V_(),m_=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,Gm=jQe(),qQe=m_&&!Gm,UQe=Gm&&!m_,FQe=Gm&&m_,KQe=typeof va=="function"&&typeof globalThis.process!="undefined"&&typeof globalThis.process.release!="undefined"&&globalThis.process.release.name==="node"&&!Gm,VQe=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,zQe=typeof globalThis.process!="undefined"&&typeof globalThis.process.env!="undefined"&&globalThis.process.env["NODE"+(()=>"_")()+"ENV"]==="test",HQe=typeof navigator!="undefined"&&navigator.product==="ReactNative";Wge.exports={isTest:zQe,isElectron:Gm,isElectronMain:UQe,isElectronRenderer:FQe,isNode:KQe,isBrowser:qQe,isWebWorker:VQe,isEnvWithDom:m_,isReactNative:HQe}});var Qge=m((akt,Xge)=>{f();function Do(r,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(r)),this._timeouts=r,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}Xge.exports=Do;Do.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};Do.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};Do.prototype.retry=function(r){if(this._timeout&&clearTimeout(this._timeout),!r)return!1;var e=new Date().getTime();if(r&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(r),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(r);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),t=this._cachedTimeouts.slice(-1);else return!1;var i=this;return this._timer=setTimeout(function(){i._attempts++,i._operationTimeoutCb&&(i._timeout=setTimeout(function(){i._operationTimeoutCb(i._attempts)},i._operationTimeout),i._options.unref&&i._timeout.unref()),i._fn(i._attempts)},t),this._options.unref&&this._timer.unref(),!0};Do.prototype.attempt=function(r,e){this._fn=r,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};Do.prototype.try=function(r){console.log("Using RetryOperation.try() is deprecated"),this.attempt(r)};Do.prototype.start=function(r){console.log("Using RetryOperation.start() is deprecated"),this.attempt(r)};Do.prototype.start=Do.prototype.try;Do.prototype.errors=function(){return this._errors};Do.prototype.attempts=function(){return this._attempts};Do.prototype.mainError=function(){if(this._errors.length===0)return null;for(var r={},e=null,t=0,i=0;i<this._errors.length;i++){var n=this._errors[i],s=n.message,o=(r[s]||0)+1;r[s]=o,o>=t&&(e=n,t=o)}return e}});var Zge=m(Ph=>{f();var $Qe=Qge();Ph.operation=function(r){var e=Ph.timeouts(r);return new $Qe(e,{forever:r&&(r.forever||r.retries===1/0),unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})};Ph.timeouts=function(r){if(r instanceof Array)return[].concat(r);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var t in r)e[t]=r[t];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],n=0;n<e.retries;n++)i.push(this.createTimeout(n,e));return r&&r.forever&&!i.length&&i.push(this.createTimeout(n,e)),i.sort(function(s,o){return s-o}),i};Ph.createTimeout=function(r,e){var t=e.randomize?Math.random()+1:1,i=Math.round(t*Math.max(e.minTimeout,1)*Math.pow(e.factor,r));return i=Math.min(i,e.maxTimeout),i};Ph.wrap=function(r,e,t){if(e instanceof Array&&(t=e,e=null),!t){t=[];for(var i in r)typeof r[i]=="function"&&t.push(i)}for(var n=0;n<t.length;n++){var s=t[n],o=r[s];r[s]=function(c){var u=Ph.operation(e),l=Array.prototype.slice.call(arguments,1),d=l.pop();l.push(function(h){u.retry(h)||(h&&(arguments[0]=u.mainError()),d.apply(this,arguments))}),u.attempt(function(){c.apply(r,l)})}.bind(r,o),r[s].options=e}}});var eme=m((ukt,Jge)=>{f();Jge.exports=Zge()});var rme=m((lkt,b_)=>{f();"use strict";var GQe=eme(),WQe=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"],lC=class extends Error{constructor(e){super();e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},YQe=(r,e,t)=>{let i=t.retries-(e-1);return r.attemptNumber=e,r.retriesLeft=i,r},XQe=r=>WQe.includes(r),tme=(r,e)=>new Promise((t,i)=>{e={onFailedAttempt:()=>{},retries:10,...e};let n=GQe.operation(e);n.attempt(async s=>{try{t(await r(s))}catch(o){if(!(o instanceof Error)){i(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof lC)n.stop(),i(o.originalError);else if(o instanceof TypeError&&!XQe(o.message))n.stop(),i(o);else{YQe(o,s,e);try{await e.onFailedAttempt(o)}catch(a){i(a);return}n.retry(o)||i(n.mainError())}}})});b_.exports=tme;b_.exports.default=tme;b_.exports.AbortError=lC});var nme=m((fkt,ime)=>{f();"use strict";function QQe(r){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(r)||/^::1$/.test(r)}ime.exports=QQe});var ome=m((dkt,sme)=>{f();"use strict";var ZQe=nme();function JQe(r){let{address:e}=r.nodeAddress();return ZQe(e)}sme.exports=JQe});var dme=m((hkt,fme)=>{f();"use strict";var eZe=$ge(),ame=le(),{promisify:fC}=Gge(),{Multiaddr:tZe}=ft(),ry=Object.assign(ame("libp2p:nat"),{error:ame("libp2p:nat:err")}),{isBrowser:cme}=Yge(),dC=rme(),rZe=x8(),ume=fP(),iZe=br(),{codes:{ERR_INVALID_PARAMETERS:nZe}}=wr(),sZe=ome(),hC=7200;function oZe(r=1024,e=65535){return Math.floor(Math.random()*(e-r+1)+r)}var lme=class{constructor({peerId:e,addressManager:t,transportManager:i,...n}){if(this._peerId=e,this._addressManager=t,this._transportManager=i,this._enabled=n.enabled,this._externalIp=n.externalIp,this._options={description:n.description||`${ume.name}@${ume.version} ${this._peerId}`,ttl:n.ttl||hC,autoUpdate:n.keepAlive||!0,gateway:n.gateway,enablePMP:Boolean(n.pmp&&n.pmp.enabled)},this._options.ttl<hC)throw iZe(new Error(`NatManager ttl should be at least ${hC} seconds`),nZe)}start(){cme||!this._enabled||this._start().catch(e=>{ry.error(e)})}async _start(){let e=this._transportManager.getAddrs();for(let t of e){let{family:i,host:n,port:s,transport:o}=t.toOptions();if(!t.isThinWaistAddress()||o!=="tcp"||sZe(t)||i!==4)continue;let a=this._getClient(),c=this._externalIp||await a.externalIp();if(rZe(c))throw new Error(`${c} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let u=oZe();ry(`opening uPnP connection from ${c}:${u} to ${n}:${s}`),await a.map({publicPort:u,privatePort:s,protocol:o.toUpperCase()}),this._addressManager.addObservedAddr(tZe.fromNodeAddress({family:4,address:c,port:u},o))}}_getClient(){if(this._client)return this._client;let e=new eZe(this._options),t=fC(e.map.bind(e)),i=fC(e.destroy.bind(e)),n=fC(e.externalIp.bind(e));return this._client={map:(...s)=>dC(()=>t(...s),{onFailedAttempt:ry.error,unref:!0}),destroy:(...s)=>dC(()=>i(...s),{onFailedAttempt:ry.error,unref:!0}),externalIp:(...s)=>dC(()=>n(...s),{onFailedAttempt:ry.error,unref:!0})},this._client}async stop(){if(!(cme||!this._client))try{await this._client.destroy(),this._client=null}catch(e){ry.error(e)}}};fme.exports=lme});var bme=m((pkt,mme)=>{f();"use strict";var hme=le(),Rn=Object.assign(hme("libp2p"),{error:hme("libp2p:err")}),{EventEmitter:aZe}=Ut(),pC=br(),cZe=ot(),{Multiaddr:uZe}=ft(),{MemoryDatastore:lZe}=(p6(),E9),fZe=spe(),dZe=fpe(),yC=lP(),{validate:hZe}=s0e(),{codes:w_,messages:pZe}=wr(),yZe=c0e(),gZe=A0e(),mZe=C0e(),pme=s1e(),bZe=m1e(),wZe=q1e(),yme=xye(),_Ze=Uye(),vZe=_P(),EZe=R2e(),SZe=cge(),RZe=lge(),AZe=pge(),gme=xge(),gC=Lge(),mC=Hge(),xZe=dme(),{updateSelfPeerRecord:IZe}=bP(),Wm=class extends aZe{static async create(e){if(e.peerId)return new Wm(e);let t=await cZe.create();return e.peerId=t,new Wm(e)}constructor(e){super();if(this._options=hZe(e),this.peerId=this._options.peerId,this.datastore=this._options.datastore,this._options.metrics.enabled){let i=new _Ze({...this._options.metrics});this.metrics=i}if(this.connectionGater={denyDialPeer:async()=>Promise.resolve(!1),denyDialMultiaddr:async()=>Promise.resolve(!1),denyInboundConnection:async()=>Promise.resolve(!1),denyOutboundConnection:async()=>Promise.resolve(!1),denyInboundEncryptedConnection:async()=>Promise.resolve(!1),denyOutboundEncryptedConnection:async()=>Promise.resolve(!1),denyInboundUpgradedConnection:async()=>Promise.resolve(!1),denyOutboundUpgradedConnection:async()=>Promise.resolve(!1),filterMultiaddrForPeer:async()=>Promise.resolve(!0),...this._options.connectionGater},this.peerStore=new SZe({peerId:this.peerId,datastore:this.datastore&&this._options.peerStore.persistence?this.datastore:new lZe,addressFilter:this.connectionGater.filterMultiaddrForPeer}),this.addresses=this._options.addresses,this.addressManager=new yZe(this.peerId,this._options.addresses),this.addressManager.on("change:addresses",()=>{IZe(this).catch(i=>{Rn.error("Error updating self peer record",i)})}),this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=new Map,this.connectionManager=new gZe(this,{...this._options.connectionManager}),this._autodialler=new mZe(this,{enabled:this._config.peerDiscovery.autoDial,minConnections:this._options.connectionManager.minConnections,autoDialInterval:this._options.connectionManager.autoDialInterval}),this._options.keychain&&this._options.keychain.datastore){Rn("creating keychain");let i=yme.generateOptions();this.keychain=new yme(this._options.keychain.datastore,{...i,...this._options.keychain}),Rn("keychain constructed")}if(this.upgrader=new EZe({connectionGater:this.connectionGater,localPeer:this.peerId,metrics:this.metrics,onConnection:i=>this.connectionManager.onConnect(i),onConnectionEnd:i=>this.connectionManager.onDisconnect(i)}),this.transportManager=new vZe({libp2p:this,upgrader:this.upgrader,faultTolerance:this._options.transportManager.faultTolerance}),this.natManager=new xZe({peerId:this.peerId,addressManager:this.addressManager,transportManager:this.transportManager,...this._options.config.nat}),this.registrar=new AZe({peerStore:this.peerStore,connectionManager:this.connectionManager}),this.handle=this.handle.bind(this),this.registrar.handle=this.handle,!this._modules.connEncryption||!this._modules.connEncryption.length)throw pC(new Error(pZe.CONN_ENCRYPTION_REQUIRED),w_.CONN_ENCRYPTION_REQUIRED);if(this._modules.connEncryption.forEach(i=>{this.upgrader.cryptos.set(i.protocol,i)}),this.dialer=new wZe({transportManager:this.transportManager,connectionGater:this.connectionGater,peerStore:this.peerStore,metrics:this.metrics,...this._options.dialer}),this._modules.transport.forEach(i=>{let n=i.prototype[Symbol.toStringTag],s=this._config.transport[n];this.transportManager.add(n,i,s)}),this._config.relay.enabled&&(this.transportManager.add(pme.prototype[Symbol.toStringTag],pme),this.relay=new bZe(this)),this._modules.streamMuxer&&(this._modules.streamMuxer.forEach(n=>{this.upgrader.muxers.set(n.multicodec,n)}),this.identifyService=new gme({libp2p:this})),this._modules.connProtector)this.upgrader.protector=this._modules.connProtector;else if(globalThis.process!==void 0&&globalThis.process.env&&globalThis.process.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._modules.dht){let i=this._modules.dht;this._dht=i.create({libp2p:this,...this._config.dht})}if(this._modules.pubsub){let i=this._modules.pubsub;this.pubsub=RZe(i,this,this._config.pubsub)}this.peerRouting=new fZe(this),this.contentRouting=new dZe(this),this._onDiscoveryPeer=this._onDiscoveryPeer.bind(this),this.fetchService=new gC(this),this.pingService=new mC(this)}emit(e,...t){return e==="error"&&!this._events.error?(Rn.error(t),!1):super.emit(e,...t)}async start(){Rn("libp2p is starting"),this.identifyService&&await this.handle(Object.values(gme.getProtocolStr(this)),this.identifyService.handleMessage),this.fetchService&&await this.handle(gC.PROTOCOL,this.fetchService.handleMessage),this.pingService&&await this.handle(mC.getProtocolStr(this),this.pingService.handleMessage);try{await this._onStarting(),await this._onDidStart(),Rn("libp2p has started")}catch(e){throw this.emit("error",e),Rn.error("An error occurred starting libp2p",e),await this.stop(),e}}async stop(){Rn("libp2p is stopping");try{this._isStarted=!1,this.identifyService&&await this.identifyService.stop(),this.relay&&this.relay.stop(),this.peerRouting.stop(),await this._autodialler.stop(),await(this._dht&&this._dht.stop());for(let e of this._discovery.values())e.removeListener("peer",this._onDiscoveryPeer);await Promise.all(Array.from(this._discovery.values(),e=>e.stop())),this._discovery=new Map,await this.connectionManager.stop(),await Promise.all([this.pubsub&&this.pubsub.stop(),this.metrics&&this.metrics.stop()]),await this.natManager.stop(),await this.transportManager.close(),await this.unhandle(gC.PROTOCOL),await this.unhandle(mC.getProtocolStr(this)),this.dialer.destroy()}catch(e){e&&(Rn.error(e),this.emit("error",e))}Rn("libp2p has stopped")}async loadKeychain(){if(!!this.keychain)try{await this.keychain.findKeyByName("self")}catch(e){await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this._isStarted}get connections(){return this.connectionManager.connections}dial(e,t){return this._dial(e,t)}async dialProtocol(e,t,i){if(!t||!t.length)throw pC(new Error("no protocols were provided to open a stream"),w_.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this._dial(e,i)).newStream(t)}async _dial(e,t){let{id:i,multiaddrs:n}=yC(e);if(i.equals(this.peerId))throw pC(new Error("Cannot dial self"),w_.ERR_DIALED_SELF);let s=this.connectionManager.get(i);return s?n&&await this.peerStore.addressBook.add(i,n):s=await this.dialer.connectToPeer(e,t),s}get multiaddrs(){let e=this.addressManager.getAnnounceAddrs().map(n=>n.toString());e.length||(e=this.transportManager.getAddrs().map(n=>n.toString())),e=e.concat(this.addressManager.getObservedAddrs().map(n=>n.toString()));let t=this._options.addresses.announceFilter,i=new Set(e);return t(Array.from(i).map(n=>new uZe(n)))}async hangUp(e){let{id:t}=yC(e),i=this.connectionManager.connections.get(t.toB58String());!i||await Promise.all(i.map(n=>n.close()))}fetch(e,t){return this.fetchService.fetch(e,t)}ping(e){let{id:t,multiaddrs:i}=yC(e);return i?this.pingService.ping(i[0]):this.pingService.ping(t)}async handle(e,t){e=Array.isArray(e)?e:[e],e.forEach(i=>{this.upgrader.protocols.set(i,t)}),await this.peerStore.protoBook.add(this.peerId,e)}async unhandle(e){e=Array.isArray(e)?e:[e],e.forEach(t=>{this.upgrader.protocols.delete(t)}),await this.peerStore.protoBook.remove(this.peerId,e)}async _onStarting(){let e=this.addressManager.getListenAddrs();await this.transportManager.listen(e),this.natManager.start(),this._config.pubsub.enabled&&this.pubsub&&await this.pubsub.start(),this._config.dht.enabled&&(this._dht&&await this._dht.start(),this._dht.on("peer",this._onDiscoveryPeer)),this.metrics&&this.metrics.start(),this.identifyService&&await this.identifyService.start()}async _onDidStart(){this._isStarted=!0,this.peerStore.on("peer",e=>{this.emit("peer:discovery",e),this._maybeConnect(e).catch(t=>{Rn.error(t)})});for await(let e of this.peerStore.getPeers())this.emit("peer:discovery",e.id);this.connectionManager.start(),await this._autodialler.start(),await this._setupPeerDiscovery(),this.relay&&this.relay.start(),this.peerRouting.start()}_onDiscoveryPeer(e){if(e.id.toB58String()===this.peerId.toB58String()){Rn.error(new Error(w_.ERR_DISCOVERED_SELF));return}e.multiaddrs&&this.peerStore.addressBook.add(e.id,e.multiaddrs).catch(t=>Rn.error(t)),e.protocols&&this.peerStore.protoBook.set(e.id,e.protocols).catch(t=>Rn.error(t))}async _maybeConnect(e){if(this._config.peerDiscovery.autoDial===!0&&!this.connectionManager.get(e)&&(this._options.connectionManager.minConnections||0)>this.connectionManager.size){Rn("connecting to discovered peer %s",e.toB58String());try{await this.dialer.connectToPeer(e)}catch(i){Rn.error(`could not connect to discovered peer ${e.toB58String()} with ${i}`)}}}async _setupPeerDiscovery(){let e=t=>{let i={enabled:!0};if(t.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[t.tag]&&(i={...i,...this._config.peerDiscovery[t.tag]}),i.enabled&&!this._discovery.has(t.tag)){let n;typeof t=="function"?n=new t(Object.assign({},i,{peerId:this.peerId,libp2p:this})):n=t,n.on("peer",this._onDiscoveryPeer),this._discovery.set(t.tag,n)}};for(let t of this._modules.peerDiscovery||[])e(t);for(let t of this.transportManager.getTransports())t.discovery&&e(t.discovery);await Promise.all(Array.from(this._discovery.values(),t=>t.start()))}};mme.exports=Wm});var kme=m((kkt,Ome)=>{f();Ome.exports=Cme;var Pme=128,LZe=127,MZe=~LZe,jZe=Math.pow(2,31);function Cme(r,e,t){e=e||[],t=t||0;for(var i=t;r>=jZe;)e[t++]=r&255|Pme,r/=128;for(;r&MZe;)e[t++]=r&255|Pme,r>>>=7;return e[t]=r|0,Cme.bytes=t-i+1,e}});var Bme=m((Dkt,Nme)=>{f();Nme.exports=bC;var qZe=128,Dme=127;function bC(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o)throw bC.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&Dme)<<i:(s&Dme)*Math.pow(2,i),i+=7}while(s>=qZe);return bC.bytes=n-e,t}});var Mme=m((Nkt,Lme)=>{f();var UZe=Math.pow(2,7),FZe=Math.pow(2,14),KZe=Math.pow(2,21),VZe=Math.pow(2,28),zZe=Math.pow(2,35),HZe=Math.pow(2,42),$Ze=Math.pow(2,49),GZe=Math.pow(2,56),WZe=Math.pow(2,63);Lme.exports=function(r){return r<UZe?1:r<FZe?2:r<KZe?3:r<VZe?4:r<zZe?5:r<HZe?6:r<$Ze?7:r<GZe?8:r<WZe?9:10}});var qme=m((Bkt,jme)=>{f();jme.exports={encode:kme(),decode:Bme(),encodingLength:Mme()}});var Kme=m((Lkt,Fme)=>{f();"use strict";var Ume=qme();Fme.exports=r=>{if(!(r instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");let e=[];for(;r.length>0;){let t=Ume.decode(r);e.push(t),r=r.slice(Ume.decode.bytes)}return e}});var Wme=m((Qkt,Gme)=>{f();"use strict";function $me(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function ZZe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return $me(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),$me(new n,t)}}Gme.exports=ZZe});var i3e=m((uDt,r3e)=>{f();r3e.exports=JZe;function JZe(r,e,t){var i=null,n=null,s=function(){i&&(clearTimeout(i),n=null,i=null)},o=function(){var c=n;s(),c&&c()},a=function(){if(!e)return r.apply(this,arguments);var c=this,u=arguments,l=t&&!i;if(s(),n=function(){r.apply(c,u)},i=setTimeout(function(){if(i=null,!l){var d=n;return n=null,d()}},e),l)return n()};return a.cancel=s,a.flush=o,a}});var E3e=m((nNt,v3e)=>{f();"use strict";function _3e(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function oJe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return _3e(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),_3e(new n,t)}}v3e.exports=oJe});var _Je={};Tt(_Je,{CID:()=>L,PeerId:()=>mJe,create:()=>pJe,crypto:()=>yJe,globSource:()=>bJe,isIPFS:()=>gJe,multiaddr:()=>Y3e.Multiaddr,urlSource:()=>wJe});f();f();f();var PO=R(Uu()),Pt=PO.default;var F3e=R(cy()),zC=R(le()),HC=R(St());f();var _3=R(qO());f();var Mc=R(Br()),Vh=Mc.default.Reader,nv=Mc.default.Writer,rt=Mc.default.util,Zi=Mc.default.roots["ipfs-unixfs"]||(Mc.default.roots["ipfs-unixfs"]={}),Lk=Zi.Data=(()=>{function r(e){if(this.blocksizes=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Type=0,r.prototype.Data=rt.newBuffer([]),r.prototype.filesize=rt.Long?rt.Long.fromBits(0,0,!0):0,r.prototype.blocksizes=rt.emptyArray,r.prototype.hashType=rt.Long?rt.Long.fromBits(0,0,!0):0,r.prototype.fanout=rt.Long?rt.Long.fromBits(0,0,!0):0,r.prototype.mode=0,r.prototype.mtime=null,r.encode=function(t,i){if(i||(i=nv.create()),i.uint32(8).int32(t.Type),t.Data!=null&&Object.hasOwnProperty.call(t,"Data")&&i.uint32(18).bytes(t.Data),t.filesize!=null&&Object.hasOwnProperty.call(t,"filesize")&&i.uint32(24).uint64(t.filesize),t.blocksizes!=null&&t.blocksizes.length)for(var n=0;n<t.blocksizes.length;++n)i.uint32(32).uint64(t.blocksizes[n]);return t.hashType!=null&&Object.hasOwnProperty.call(t,"hashType")&&i.uint32(40).uint64(t.hashType),t.fanout!=null&&Object.hasOwnProperty.call(t,"fanout")&&i.uint32(48).uint64(t.fanout),t.mode!=null&&Object.hasOwnProperty.call(t,"mode")&&i.uint32(56).uint32(t.mode),t.mtime!=null&&Object.hasOwnProperty.call(t,"mtime")&&Zi.UnixTime.encode(t.mtime,i.uint32(66).fork()).ldelim(),i},r.decode=function(t,i){t instanceof Vh||(t=Vh.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Zi.Data;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;case 3:s.filesize=t.uint64();break;case 4:if(s.blocksizes&&s.blocksizes.length||(s.blocksizes=[]),(o&7)==2)for(var a=t.uint32()+t.pos;t.pos<a;)s.blocksizes.push(t.uint64());else s.blocksizes.push(t.uint64());break;case 5:s.hashType=t.uint64();break;case 6:s.fanout=t.uint64();break;case 7:s.mode=t.uint32();break;case 8:s.mtime=Zi.UnixTime.decode(t,t.uint32());break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw rt.ProtocolError("missing required 'Type'",{instance:s});return s},r.fromObject=function(t){if(t instanceof Zi.Data)return t;var i=new Zi.Data;switch(t.Type){case"Raw":case 0:i.Type=0;break;case"Directory":case 1:i.Type=1;break;case"File":case 2:i.Type=2;break;case"Metadata":case 3:i.Type=3;break;case"Symlink":case 4:i.Type=4;break;case"HAMTShard":case 5:i.Type=5;break}if(t.Data!=null&&(typeof t.Data=="string"?rt.base64.decode(t.Data,i.Data=rt.newBuffer(rt.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),t.filesize!=null&&(rt.Long?(i.filesize=rt.Long.fromValue(t.filesize)).unsigned=!0:typeof t.filesize=="string"?i.filesize=parseInt(t.filesize,10):typeof t.filesize=="number"?i.filesize=t.filesize:typeof t.filesize=="object"&&(i.filesize=new rt.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0))),t.blocksizes){if(!Array.isArray(t.blocksizes))throw TypeError(".Data.blocksizes: array expected");i.blocksizes=[];for(var n=0;n<t.blocksizes.length;++n)rt.Long?(i.blocksizes[n]=rt.Long.fromValue(t.blocksizes[n])).unsigned=!0:typeof t.blocksizes[n]=="string"?i.blocksizes[n]=parseInt(t.blocksizes[n],10):typeof t.blocksizes[n]=="number"?i.blocksizes[n]=t.blocksizes[n]:typeof t.blocksizes[n]=="object"&&(i.blocksizes[n]=new rt.LongBits(t.blocksizes[n].low>>>0,t.blocksizes[n].high>>>0).toNumber(!0))}if(t.hashType!=null&&(rt.Long?(i.hashType=rt.Long.fromValue(t.hashType)).unsigned=!0:typeof t.hashType=="string"?i.hashType=parseInt(t.hashType,10):typeof t.hashType=="number"?i.hashType=t.hashType:typeof t.hashType=="object"&&(i.hashType=new rt.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0))),t.fanout!=null&&(rt.Long?(i.fanout=rt.Long.fromValue(t.fanout)).unsigned=!0:typeof t.fanout=="string"?i.fanout=parseInt(t.fanout,10):typeof t.fanout=="number"?i.fanout=t.fanout:typeof t.fanout=="object"&&(i.fanout=new rt.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0))),t.mode!=null&&(i.mode=t.mode>>>0),t.mtime!=null){if(typeof t.mtime!="object")throw TypeError(".Data.mtime: object expected");i.mtime=Zi.UnixTime.fromObject(t.mtime)}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocksizes=[]),i.defaults){if(n.Type=i.enums===String?"Raw":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=rt.newBuffer(n.Data))),rt.Long){var s=new rt.Long(0,0,!0);n.filesize=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.filesize=i.longs===String?"0":0;if(rt.Long){var s=new rt.Long(0,0,!0);n.hashType=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.hashType=i.longs===String?"0":0;if(rt.Long){var s=new rt.Long(0,0,!0);n.fanout=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.fanout=i.longs===String?"0":0;n.mode=0,n.mtime=null}if(t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=i.enums===String?Zi.Data.DataType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?rt.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),t.filesize!=null&&t.hasOwnProperty("filesize")&&(typeof t.filesize=="number"?n.filesize=i.longs===String?String(t.filesize):t.filesize:n.filesize=i.longs===String?rt.Long.prototype.toString.call(t.filesize):i.longs===Number?new rt.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0):t.filesize),t.blocksizes&&t.blocksizes.length){n.blocksizes=[];for(var o=0;o<t.blocksizes.length;++o)typeof t.blocksizes[o]=="number"?n.blocksizes[o]=i.longs===String?String(t.blocksizes[o]):t.blocksizes[o]:n.blocksizes[o]=i.longs===String?rt.Long.prototype.toString.call(t.blocksizes[o]):i.longs===Number?new rt.LongBits(t.blocksizes[o].low>>>0,t.blocksizes[o].high>>>0).toNumber(!0):t.blocksizes[o]}return t.hashType!=null&&t.hasOwnProperty("hashType")&&(typeof t.hashType=="number"?n.hashType=i.longs===String?String(t.hashType):t.hashType:n.hashType=i.longs===String?rt.Long.prototype.toString.call(t.hashType):i.longs===Number?new rt.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0):t.hashType),t.fanout!=null&&t.hasOwnProperty("fanout")&&(typeof t.fanout=="number"?n.fanout=i.longs===String?String(t.fanout):t.fanout:n.fanout=i.longs===String?rt.Long.prototype.toString.call(t.fanout):i.longs===Number?new rt.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0):t.fanout),t.mode!=null&&t.hasOwnProperty("mode")&&(n.mode=t.mode),t.mtime!=null&&t.hasOwnProperty("mtime")&&(n.mtime=Zi.UnixTime.toObject(t.mtime,i)),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Mc.default.util.toJSONOptions)},r.DataType=function(){let e={},t=Object.create(e);return t[e[0]="Raw"]=0,t[e[1]="Directory"]=1,t[e[2]="File"]=2,t[e[3]="Metadata"]=3,t[e[4]="Symlink"]=4,t[e[5]="HAMTShard"]=5,t}(),r})(),JJe=Zi.UnixTime=(()=>{function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Seconds=rt.Long?rt.Long.fromBits(0,0,!1):0,r.prototype.FractionalNanoseconds=0,r.encode=function(t,i){return i||(i=nv.create()),i.uint32(8).int64(t.Seconds),t.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(t,"FractionalNanoseconds")&&i.uint32(21).fixed32(t.FractionalNanoseconds),i},r.decode=function(t,i){t instanceof Vh||(t=Vh.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Zi.UnixTime;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Seconds=t.int64();break;case 2:s.FractionalNanoseconds=t.fixed32();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Seconds"))throw rt.ProtocolError("missing required 'Seconds'",{instance:s});return s},r.fromObject=function(t){if(t instanceof Zi.UnixTime)return t;var i=new Zi.UnixTime;return t.Seconds!=null&&(rt.Long?(i.Seconds=rt.Long.fromValue(t.Seconds)).unsigned=!1:typeof t.Seconds=="string"?i.Seconds=parseInt(t.Seconds,10):typeof t.Seconds=="number"?i.Seconds=t.Seconds:typeof t.Seconds=="object"&&(i.Seconds=new rt.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber())),t.FractionalNanoseconds!=null&&(i.FractionalNanoseconds=t.FractionalNanoseconds>>>0),i},r.toObject=function(t,i){i||(i={});var n={};if(i.defaults){if(rt.Long){var s=new rt.Long(0,0,!1);n.Seconds=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.Seconds=i.longs===String?"0":0;n.FractionalNanoseconds=0}return t.Seconds!=null&&t.hasOwnProperty("Seconds")&&(typeof t.Seconds=="number"?n.Seconds=i.longs===String?String(t.Seconds):t.Seconds:n.Seconds=i.longs===String?rt.Long.prototype.toString.call(t.Seconds):i.longs===Number?new rt.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber():t.Seconds),t.FractionalNanoseconds!=null&&t.hasOwnProperty("FractionalNanoseconds")&&(n.FractionalNanoseconds=t.FractionalNanoseconds),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Mc.default.util.toJSONOptions)},r})(),eet=Zi.Metadata=(()=>{function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.MimeType="",r.encode=function(t,i){return i||(i=nv.create()),t.MimeType!=null&&Object.hasOwnProperty.call(t,"MimeType")&&i.uint32(10).string(t.MimeType),i},r.decode=function(t,i){t instanceof Vh||(t=Vh.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Zi.Metadata;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.MimeType=t.string();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Zi.Metadata)return t;var i=new Zi.Metadata;return t.MimeType!=null&&(i.MimeType=String(t.MimeType)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.MimeType=""),t.MimeType!=null&&t.hasOwnProperty("MimeType")&&(n.MimeType=t.MimeType),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Mc.default.util.toJSONOptions)},r})();var jc=Lk,Mk=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],fbe=["directory","hamt-sharded-directory"],jk=parseInt("0644",8),qk=parseInt("0755",8);function qc(r){if(r!=null)return typeof r=="number"?r&4095:(r=r.toString(),r.substring(0,1)==="0"?parseInt(r,8)&4095:parseInt(r,10)&4095)}function zu(r){if(r==null)return;let e;if(r.secs!=null&&(e={secs:r.secs,nsecs:r.nsecs}),r.Seconds!=null&&(e={secs:r.Seconds,nsecs:r.FractionalNanoseconds}),Array.isArray(r)&&(e={secs:r[0],nsecs:r[1]}),r instanceof Date){let t=r.getTime(),i=Math.floor(t/1e3);e={secs:i,nsecs:(t-i*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw(0,_3.default)(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}var ht=class{static unmarshal(e){let t=jc.decode(e),i=jc.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}),n=new ht({type:Mk[i.Type],data:i.Data,blockSizes:i.blocksizes,mode:i.mode,mtime:i.mtime?{secs:i.mtime.Seconds,nsecs:i.mtime.FractionalNanoseconds}:void 0});return n._originalMode=i.mode||0,n}constructor(e={type:"file"}){let{type:t,data:i,blockSizes:n,hashType:s,fanout:o,mtime:a,mode:c}=e;if(t&&!Mk.includes(t))throw(0,_3.default)(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=t||"file",this.data=i,this.hashType=s,this.fanout=o,this.blockSizes=n||[],this._originalMode=0,this.mode=qc(c),a&&(this.mtime=zu(a),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?qk:jk;let t=qc(e);t!==void 0&&(this._mode=t)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&fbe.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach(t=>{e+=t}),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=jc.DataType.Raw;break;case"directory":e=jc.DataType.Directory;break;case"file":e=jc.DataType.File;break;case"metadata":e=jc.DataType.Metadata;break;case"symlink":e=jc.DataType.Symlink;break;case"hamt-sharded-directory":e=jc.DataType.HAMTShard;break;default:throw(0,_3.default)(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let t=this.data;(!this.data||!this.data.length)&&(t=void 0);let i;this.mode!=null&&(i=this._originalMode&4294963200|(qc(this.mode)||0),i===jk&&!this.isDirectory()&&(i=void 0),i===qk&&this.isDirectory()&&(i=void 0));let n;if(this.mtime!=null){let o=zu(this.mtime);o&&(n={Seconds:o.secs,FractionalNanoseconds:o.nsecs},n.FractionalNanoseconds===0&&delete n.FractionalNanoseconds)}let s={Type:e,Data:t,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:i,mtime:n};return jc.encode(s).finish()}};var In={};Tt(In,{code:()=>wt,createLink:()=>lD,createNode:()=>uD,decode:()=>Nt,encode:()=>lt,name:()=>c5e,prepare:()=>zi,validate:()=>pv});f();we();f();var Zbe=new TextDecoder;function dv(r,e){let t=0;for(let i=0;;i+=7){if(i>=64)throw new Error("protobuf: varint overflow");if(e>=r.length)throw new Error("protobuf: unexpected end of data");let n=r[e++];if(t+=i<28?(n&127)<<i:(n&127)*2**i,n<128)break}return[t,e]}function A3(r,e){let t;[t,e]=dv(r,e);let i=e+t;if(t<0||i<0)throw new Error("protobuf: invalid length");if(i>r.length)throw new Error("protobuf: unexpected end of data");return[r.subarray(e,i),i]}function tD(r,e){let t;return[t,e]=dv(r,e),[t&7,t>>3,e]}function Jbe(r){let e={},t=r.length,i=0;for(;i<t;){let n,s;if([n,s,i]=tD(r,i),s===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,i]=A3(r,i)}else if(s===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,i]=A3(r,i),e.Name=Zbe.decode(o)}else if(s===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(n!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Tsize`);[e.Tsize,i]=dv(r,i)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${s}`)}if(i>t)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function rD(r){let e=r.length,t=0,i,n=!1,s;for(;t<e;){let a,c;if([a,c,t]=tD(r,t),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(c===1){if(s)throw new Error("protobuf: (PBNode) duplicate Data section");[s,t]=A3(r,t),i&&(n=!0)}else if(c===2){if(n)throw new Error("protobuf: (PBNode) duplicate Links section");i||(i=[]);let u;[u,t]=A3(r,t),i.push(Jbe(u))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${c}`)}if(t>e)throw new Error("protobuf: (PBNode) unexpected end of data");let o={};return s&&(o.Data=s),o.Links=i||[],o}f();var iD=new TextEncoder,nD=2**32,e5e=2**31;function t5e(r,e){let t=e.length;if(typeof r.Tsize=="number"){if(r.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(r.Tsize))throw new Error("Tsize too large for encoding");t=yy(e,t,r.Tsize)-1,e[t]=24}if(typeof r.Name=="string"){let i=iD.encode(r.Name);t-=i.length,e.set(i,t),t=yy(e,t,i.length)-1,e[t]=18}return r.Hash&&(t-=r.Hash.length,e.set(r.Hash,t),t=yy(e,t,r.Hash.length)-1,e[t]=10),e.length-t}function sD(r){let e=i5e(r),t=new Uint8Array(e),i=e;if(r.Data&&(i-=r.Data.length,t.set(r.Data,i),i=yy(t,i,r.Data.length)-1,t[i]=10),r.Links)for(let n=r.Links.length-1;n>=0;n--){let s=t5e(r.Links[n],t.subarray(0,i));i-=s,i=yy(t,i,s)-1,t[i]=18}return t}function r5e(r){let e=0;if(r.Hash){let t=r.Hash.length;e+=1+t+Yh(t)}if(typeof r.Name=="string"){let t=iD.encode(r.Name).length;e+=1+t+Yh(t)}return typeof r.Tsize=="number"&&(e+=1+Yh(r.Tsize)),e}function i5e(r){let e=0;if(r.Data){let t=r.Data.length;e+=1+t+Yh(t)}if(r.Links)for(let t of r.Links){let i=r5e(t);e+=1+i+Yh(i)}return e}function yy(r,e,t){e-=Yh(t);let i=e;for(;t>=e5e;)r[e++]=t&127|128,t/=128;for(;t>=128;)r[e++]=t&127|128,t>>>=7;return r[e]=t,i}function Yh(r){return r%2==0&&r++,Math.floor((n5e(r)+6)/7)}function n5e(r){let e=0;return r>=nD&&(r=Math.floor(r/nD),e=32),r>=1<<16&&(r>>>=16,e+=16),r>=1<<8&&(r>>>=8,e+=8),e+s5e[r]}var s5e=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8];f();we();var o5e=["Data","Links"],a5e=["Hash","Name","Tsize"],hv=new TextEncoder;function oD(r,e){if(r===e)return 0;let t=r.Name?hv.encode(r.Name):[],i=e.Name?hv.encode(e.Name):[],n=t.length,s=i.length;for(let o=0,a=Math.min(n,s);o<a;++o)if(t[o]!==i[o]){n=t[o],s=i[o];break}return n<s?-1:s<n?1:0}function aD(r,e){return!Object.keys(r).some(t=>!e.includes(t))}function cD(r){if(typeof r.asCID=="object"){let t=L.asCID(r);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if(typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");let e={};if(r.Hash){let t=L.asCID(r.Hash);try{t||(typeof r.Hash=="string"?t=L.parse(r.Hash):r.Hash instanceof Uint8Array&&(t=L.decode(r.Hash)))}catch(i){throw new TypeError(`Invalid DAG-PB form: ${i.message}`)}t&&(e.Hash=t)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return typeof r.Name=="string"&&(e.Name=r.Name),typeof r.Tsize=="number"&&(e.Tsize=r.Tsize),e}function zi(r){if((r instanceof Uint8Array||typeof r=="string")&&(r={Data:r}),typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");let e={};if(r.Data!==void 0)if(typeof r.Data=="string")e.Data=hv.encode(r.Data);else if(r.Data instanceof Uint8Array)e.Data=r.Data;else throw new TypeError("Invalid DAG-PB form");if(r.Links!==void 0)if(Array.isArray(r.Links))e.Links=r.Links.map(cD),e.Links.sort(oD);else throw new TypeError("Invalid DAG-PB form");else e.Links=[];return e}function pv(r){if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");if(!aD(r,o5e))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(r.Data!==void 0&&!(r.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(r.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let e=0;e<r.Links.length;e++){let t=r.Links[e];if(!t||typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!aD(t,a5e))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!t.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(t.Hash.asCID!==t.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(t.Name!==void 0&&typeof t.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(t.Tsize!==void 0&&(typeof t.Tsize!="number"||t.Tsize%1!=0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e>0&&oD(t,r.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function uD(r,e=[]){return zi({Data:r,Links:e})}function lD(r,e,t){return cD({Hash:t,Name:r,Tsize:e})}var c5e="dag-pb",wt=112;function lt(r){pv(r);let e={};return r.Links&&(e.Links=r.Links.map(t=>{let i={};return t.Hash&&(i.Hash=t.Hash.bytes),t.Name!==void 0&&(i.Name=t.Name),t.Tsize!==void 0&&(i.Tsize=t.Tsize),i})),r.Data&&(e.Data=r.Data),sD(e)}function Nt(r){let e=rD(r),t={};return e.Data&&(t.Data=e.Data),e.Links&&(t.Links=e.Links.map(i=>{let n={};try{n.Hash=L.decode(i.Hash)}catch(s){}if(!n.Hash)throw new Error("Invalid Hash field found in link, expected CID");return i.Name!==void 0&&(n.Name=i.Name),i.Tsize!==void 0&&(n.Tsize=i.Tsize),n})),t}var Sy={};Tt(Sy,{code:()=>Ov,decode:()=>Dv,encode:()=>kv,name:()=>N5e});f();Qu();we();var mN=42;function P5e(r){if(r.asCID!==r)return null;let e=L.asCID(r);if(!e)return null;let t=new Uint8Array(e.bytes.byteLength+1);return t.set(e.bytes,1),[new ge($.tag,mN),new ge($.bytes,t)]}function C5e(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function O5e(r){if(Number.isNaN(r))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(r===1/0||r===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var k5e={float64:!0,typeEncoders:{Object:P5e,undefined:C5e,number:O5e}};function D5e(r){if(r[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return L.decode(r.subarray(1))}var bN={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};bN.tags[mN]=D5e;var N5e="dag-cbor",Ov=113,kv=r=>$n(r,k5e),Dv=r=>wi(r,bN);var Ay={};Tt(Ay,{code:()=>Mv,decode:()=>H5e,encode:()=>z5e,name:()=>V5e});f();rp();Zu();Qu();f();f();Tn();Pv();ps();Wu();var vN=class extends Array{constructor(){super();this.inRecursive=[]}prefix(e){let t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===$.array&&(t.elements++,t.elements!==1&&e.push([44])),t.type===$.map&&(t.elements++,t.elements!==1&&(t.elements%2==1?e.push([44]):e.push([58]))))}[$.uint.major](e,t){this.prefix(e);let i=String(t.value),n=[];for(let s=0;s<i.length;s++)n[s]=i.charCodeAt(s);e.push(n)}[$.negint.major](e,t){this[$.uint.major](e,t)}[$.bytes.major](e,t){throw new Error(`${Kc} unsupported type: Uint8Array`)}[$.string.major](e,t){this.prefix(e);let i=I3(JSON.stringify(t.value));e.push(i.length>32?gy(i):i)}[$.array.major](e,t){this.prefix(e),this.inRecursive.push({type:$.array,elements:0}),e.push([91])}[$.map.major](e,t){this.prefix(e),this.inRecursive.push({type:$.map,elements:0}),e.push([123])}[$.tag.major](e,t){}[$.float.major](e,t){if(t.type.name==="break"){let o=this.inRecursive.pop();if(o){if(o.type===$.array)e.push([93]);else if(o.type===$.map)e.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(t.value===void 0)throw new Error(`${Kc} unsupported type: undefined`);if(this.prefix(e),t.type.name==="true"){e.push([116,114,117,101]);return}else if(t.type.name==="false"){e.push([102,97,108,115,101]);return}else if(t.type.name==="null"){e.push([110,117,108,108]);return}let i=String(t.value),n=[],s=!1;for(let o=0;o<i.length;o++)n[o]=i.charCodeAt(o),!s&&(n[o]===46||n[o]===101||n[o]===69)&&(s=!0);s||(n.push(46),n.push(48)),e.push(n)}};function M5e(r,e){if(Array.isArray(r[0])||Array.isArray(e[0]))throw new Error(`${Kc} complex map keys are not supported`);let t=r[0],i=e[0];if(t.type!==$.string||i.type!==$.string)throw new Error(`${Kc} non-string map keys are not supported`);if(t<i)return-1;if(t>i)return 1;throw new Error(`${Kc} unexpected duplicate map keys, this is not supported`)}var j5e={addBreakTokens:!0,mapSorter:M5e};function Nv(r,e){return e=Object.assign({},j5e,e),Tv(r,new vN,e)}f();Cv();Tn();Wu();ps();var Ry=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;e===32||e===9||e===13||e===10;)e=this.data[++this.pos]}expect(e){if(this.data.length-this.pos<e.length)throw new Error(`${Ve} unexpected end of input at position ${this.pos}`);for(let t=0;t<e.length;t++)if(this.data[this.pos++]!==e[t])throw new Error(`${Ve} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){let e=this.pos,t=!1,i=!1,n=a=>{for(;!this.done();){let c=this.ch();if(a.includes(c))this.pos++;else break}};if(this.ch()===45&&(t=!0,this.pos++),this.ch()===48)if(this.pos++,this.ch()===46)this.pos++,i=!0;else return new ge($.uint,0,this.pos-e);if(n([48,49,50,51,52,53,54,55,56,57]),t&&this.pos===e+1)throw new Error(`${Ve} unexpected token at position ${this.pos}`);if(!this.done()&&this.ch()===46){if(i)throw new Error(`${Ve} unexpected token at position ${this.pos}`);i=!0,this.pos++,n([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(i=!0,this.pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this.pos++,n([48,49,50,51,52,53,54,55,56,57]));let s=String.fromCharCode.apply(null,this.data.subarray(e,this.pos)),o=parseFloat(s);return i?new ge($.float,o,this.pos-e):this.options.allowBigInt!==!0||Number.isSafeInteger(o)?new ge(o>=0?$.uint:$.negint,o,this.pos-e):new ge(o>=0?$.uint:$.negint,BigInt(s),this.pos-e)}parseString(){if(this.ch()!==34)throw new Error(`${Ve} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let s=this.pos,o=0;s<this.data.length&&o<65536;s++,o++){let a=this.data[s];if(a===92||a<32||a>=128)break;if(a===34){let c=String.fromCharCode.apply(null,this.data.subarray(this.pos,s));return this.pos=s+1,new ge($.string,c,o)}}let e=this.pos,t=[],i=()=>{if(this.pos+4>=this.data.length)throw new Error(`${Ve} unexpected end of unicode escape sequence at position ${this.pos}`);let s=0;for(let o=0;o<4;o++){let a=this.ch();if(a>=48&&a<=57)a-=48;else if(a>=97&&a<=102)a=a-97+10;else if(a>=65&&a<=70)a=a-65+10;else throw new Error(`${Ve} unexpected unicode escape character at position ${this.pos}`);s=s*16+a,this.pos++}return s},n=()=>{let s=this.ch(),o=null,a=s>239?4:s>223?3:s>191?2:1;if(this.pos+a>this.data.length)throw new Error(`${Ve} unexpected unicode sequence at position ${this.pos}`);let c,u,l,d;switch(a){case 1:s<128&&(o=s);break;case 2:c=this.data[this.pos+1],(c&192)==128&&(d=(s&31)<<6|c&63,d>127&&(o=d));break;case 3:c=this.data[this.pos+1],u=this.data[this.pos+2],(c&192)==128&&(u&192)==128&&(d=(s&15)<<12|(c&63)<<6|u&63,d>2047&&(d<55296||d>57343)&&(o=d));break;case 4:c=this.data[this.pos+1],u=this.data[this.pos+2],l=this.data[this.pos+3],(c&192)==128&&(u&192)==128&&(l&192)==128&&(d=(s&15)<<18|(c&63)<<12|(u&63)<<6|l&63,d>65535&&d<1114112&&(o=d))}o===null?(o=65533,a=1):o>65535&&(o-=65536,t.push(o>>>10&1023|55296),o=56320|o&1023),t.push(o),this.pos+=a};for(;!this.done();){let s=this.ch(),o;switch(s){case 92:if(this.pos++,this.done())throw new Error(`${Ve} unexpected string termination at position ${this.pos}`);switch(o=this.ch(),this.pos++,o){case 34:case 39:case 92:case 47:t.push(o);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(i());break;default:throw new Error(`${Ve} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new ge($.string,yv(t),this.pos-e);default:if(s<32)throw new Error(`${Ve} invalid control character at position ${this.pos}`);s<128?(t.push(s),this.pos++):n()}}throw new Error(`${Ve} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new ge($.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new ge($.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new ge($.null,null,4);case 102:return this.expect([102,97,108,115,101]),new ge($.false,!1,5);case 116:return this.expect([116,114,117,101]),new ge($.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${Ve} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this.pos++,this.skipWhitespace(),new ge($.break,void 0,1);if(this.ch()!==44)throw new Error(`${Ve} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this.pos++,this.skipWhitespace(),new ge($.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new ge($.break,void 0,1);if(this.ch()!==44)throw new Error(`${Ve} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this.pos++,this.skipWhitespace(),new ge($.break,void 0,1);let e=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${Ve} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${Ve} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}};function Bv(r,e){return e=Object.assign({tokenizer:new Ry(r,e)},e),wi(r,e)}function q5e(r){if(r.asCID!==r)return null;let e=L.asCID(r);if(!e)return null;let t=e.toString();return[new ge($.map,1/0,1),new ge($.string,"/",1),new ge($.string,t,t.length),new ge($.break,void 0,1)]}function EN(r){let e=U3.encode(r).slice(1);return[new ge($.map,1/0,1),new ge($.string,"/",1),new ge($.map,1/0,1),new ge($.string,"bytes",5),new ge($.string,e,e.length),new ge($.break,void 0,1),new ge($.break,void 0,1)]}function U5e(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function F5e(r){if(Number.isNaN(r))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(r===1/0||r===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var K5e={typeEncoders:{Object:q5e,Uint8Array:EN,Buffer:EN,undefined:U5e,number:F5e}},SN=class extends Ry{constructor(e,t){super(e,t);this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){let e=this._next();if(e.type===$.map){let t=this._next();if(t.type===$.string&&t.value==="/"){let i=this._next();if(i.type===$.string){if(this._next().type!==$.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(i),new ge($.tag,42,0)}if(i.type===$.map){let n=this._next();if(n.type===$.string&&n.value==="bytes"){let s=this._next();if(s.type===$.string){for(let a=0;a<2;a++)if(this._next().type!==$.break)throw new Error("Invalid encoded Bytes form");let o=U3.decode(`m${s.value}`);return new ge($.bytes,o,s.value.length)}this.tokenBuffer.push(s)}this.tokenBuffer.push(n)}this.tokenBuffer.push(i)}this.tokenBuffer.push(t)}return e}},Lv={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};Lv.tags[42]=L.parse;var V5e="dag-json",Mv=297,z5e=r=>Nv(r,K5e),H5e=r=>{let e=Object.assign(Lv,{tokenizer:new SN(r,Lv)});return Bv(r,e)};var lJe=R(zv());zc();$3();f();function VN(){}f();var Ju=class extends Error{constructor(e="not initialized"){super(e);this.name="NotInitializedError",this.code=Ju.code}};Ju.code="ERR_NOT_INITIALIZED";var zN=class extends Error{constructor(e="cannot initialize an initializing node"){super(e);this.name="AlreadyInitializingError",this.code=Oa.code}};zN.code="ERR_ALREADY_INITIALIZING";var Oa=class extends Error{constructor(e="cannot re-initialize an initialized node"){super(e);this.name="AlreadyInitializedError",this.code=Oa.code}};Oa.code="ERR_ALREADY_INITIALIZED";var el=class extends Error{constructor(e="not started"){super(e);this.name="NotStartedError",this.code=el.code}};el.code="ERR_NOT_STARTED";var sp=class extends Error{constructor(e="cannot start, already startin"){super(e);this.name="AlreadyStartingError",this.code=sp.code}};sp.code="ERR_ALREADY_STARTING";var op=class extends Error{constructor(e="cannot start, already started"){super(e);this.name="AlreadyStartedError",this.code=op.code}};op.code="ERR_ALREADY_STARTED";var ka=class extends Error{constructor(e="not enabled"){super(e);this.name="NotEnabledError",this.code=ka.code}};ka.code="ERR_NOT_ENABLED";ct();f();f();f();var kL=R(gp());we();Mr();var c4=R(St());f();var IL=R(Da()),TL=R(Ho());f();var Q8e=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;_t.nanosecond=_t.ns=1/1e6;_t.\u00B5s=_t.\u03BCs=_t.us=_t.microsecond=1/1e3;_t.millisecond=_t.ms=_t[""]=1;_t.second=_t.sec=_t.s=_t.ms*1e3;_t.minute=_t.min=_t.m=_t.s*60;_t.hour=_t.hr=_t.h=_t.m*60;_t.day=_t.d=_t.h*24;_t.week=_t.wk=_t.w=_t.d*7;_t.month=_t.b=_t.d*(365.25/12);_t.year=_t.yr=_t.y=_t.d*365.25;function _t(r="",e="ms"){var t=null;return r=(r+"").replace(/(\d)[,_](\d)/g,"$1$2"),r.replace(Q8e,function(i,n,s){s=xL(s),s&&(t=(t||0)+parseFloat(n,10)*s)}),t&&t/(xL(e)||1)}function xL(r){return _t[r]||_t[r.toLowerCase().replace(/s$/,"")]}var il=_t;f();var nl=class extends Error{constructor(e="request timed out"){super(e);this.name="TimeoutError",this.code=nl.code}};nl.code="ERR_TIMEOUT";function Q(r,e){return(...t)=>{let i=t[e??t.length-1];if(!i||!i.timeout)return r(...t);let n=typeof i.timeout=="string"?il(i.timeout):i.timeout,s=new IL.TimeoutController(n);i.signal=(0,TL.anySignal)([i.signal,s.signal]);let o=r(...t),a=new Promise((l,d)=>{s.signal.addEventListener("abort",()=>{d(new nl)})}),c=Date.now(),u=()=>{if(s.signal.aborted)throw new nl;if(Date.now()-c>n)throw s.abort(),new nl};return o[Symbol.asyncIterator]?async function*(){let l=o[Symbol.asyncIterator]();try{for(;;){let{value:d,done:h}=await Promise.race([l.next(),a]);if(h)break;u(),yield d}}catch(d){throw u(),d}finally{s.clear(),l.return&&l.return()}}():(async()=>{try{let l=await Promise.race([o,a]);return u(),l}catch(l){throw u(),l}finally{s.clear()}})()}}f();we();var T7=R(Kf()),OL="/ipfs/";function $c(r){if(r instanceof Uint8Array)try{r=L.decode(r)}catch(n){throw(0,T7.default)(n,"ERR_INVALID_CID")}let e=L.asCID(r);if(e)return{cid:e,path:void 0};r=r.toString(),r.startsWith(OL)&&(r=r.substring(OL.length));let t=r.split("/"),i;try{e=L.parse(t.shift()||"")}catch(n){throw(0,T7.default)(n,"ERR_INVALID_CID")}return t.length&&(i=`/${t.join("/")}`),{cid:e,path:i}}var J8e="ERR_BAD_PATH",u4="This command must be run in online mode. Try running 'ipfs daemon' first.",qy=new xe("/local/filesroot"),Uy=262144;var DL=r=>{if(L.asCID(r))return`/ipfs/${r}`;let t=r.toString();try{return`/ipfs/${L.parse(t)}`}catch{}if(kL.default.path(t))return t;throw(0,c4.default)(new Error(`invalid path: ${r}`),J8e)},bp=r=>r instanceof Uint8Array?L.decode(r).toString():(r=r.toString(),r.indexOf("/ipfs/")===0&&(r=r.substring("/ipfs/".length)),r.charAt(r.length-1)==="/"&&(r=r.substring(0,r.length-1)),r),sl=async function(r,e,t,i={}){let{cid:n,path:s}=$c(t);s&&(i.path=s);let o=n,a=i.path||"";if(a.startsWith("/")&&(a=a.substring(1)),i.path)try{for await(let{value:c,remainderPath:u}of ol(n,i.path,e,r,{signal:i.signal})){if(!L.asCID(c))break;a=u,o=c}}catch(c){throw c.message.startsWith("Object has no property")&&(c.message=`no link named "${a.split("/")[0]}" under ${o}`,c.code="ERR_NO_LINK"),c}return{cid:o,remainderPath:a||""}},P7=r=>{if(r.type!=="file"&&r.type!=="directory"&&r.type!=="raw")throw new Error(`Unknown node type '${r.type}'`);let e={cid:r.cid,path:r.path,name:r.name,size:r.size,type:"file"};return r.type==="directory"&&(e.type="dir"),r.type==="file"&&(e.size=r.unixfs.fileSize()),(r.type==="file"||r.type==="directory")&&(e.mode=r.unixfs.mode,r.unixfs.mtime!==void 0&&(e.mtime=r.unixfs.mtime)),e},NL=Q(async(r,e)=>await r),ol=async function*(r,e,t,i,n){let s=async u=>{let l=await t.getCodec(u.code),d=await i.blocks.get(u,n);return l.decode(d)},o=e.split("/").filter(Boolean),a=await s(r),c=r;for(;o.length;){let u=o.shift();if(!u)throw(0,c4.default)(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(r.code===wt&&Array.isArray(a.Links)){let l=a.Links.find(d=>d.Name===u);if(l){yield{value:l.Hash,remainderPath:o.join("/")},a=await s(l.Hash),c=l.Hash;continue}}if(Object.prototype.hasOwnProperty.call(a,u))a=a[u],yield{value:a,remainderPath:o.join("/")};else throw(0,c4.default)(new Error(`no link named "${u}" under ${c}`),"ERR_NO_LINK");L.asCID(a)&&(c=a,a=await s(a))}yield{value:a,remainderPath:""}};var On=class{static create({start:e,stop:t}){return new On(e,t)}static async start(e,t){let{state:i,activate:n}=e;switch(i.status){case"stopped":try{let s=n(t);e.state={status:"starting",ready:s};let o=await s;return e.state={status:"started",value:o},o}catch(s){throw e.state={status:"stopped"},s}case"starting":throw new sp;case"started":throw new op;case"stopping":return await i.ready,await On.start(e,t);default:return On.panic(e)}}static async stop(e){let{state:t,deactivate:i}=e;switch(t.status){case"stopped":break;case"starting":{try{await t.ready}catch(n){}return await On.stop(e)}case"stopping":return await t.ready;case"started":{i&&await i(t.value),e.state={status:"stopped"};break}default:On.panic(t)}}static try({state:e}){switch(e.status){case"started":return e.value;default:return null}}static async use({state:e},t){switch(e.status){case"started":return e.value;case"starting":return await NL(e.ready,t);default:throw new el}}static panic({state:e}){let t=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${t}, should never happen if you see this please report a bug`)}constructor(e,t){this.activate=e,this.deactivate=t,this.state={status:"stopped"}}async use(e){return await On.use(this,e)}try(){return On.try(this)}};function BL({network:r,preload:e,peerId:t,keychain:i,repo:n,ipns:s,mfsPreload:o,print:a,hashers:c,options:u}){return async()=>{let{libp2p:d}=await On.start(r,{peerId:t,repo:n,print:a,hashers:c,options:u});await Promise.all([s.startOnline({keychain:i,libp2p:d,peerId:t,repo:n}),e.start(),o.start()])}}f();function LL({network:r,preload:e,ipns:t,repo:i,mfsPreload:n}){return async()=>{await Promise.all([e.stop(),t.stop(),n.stop()]),await On.stop(r),await i.close()}}f();f();f();var jL=R(wp()),C7=class{constructor(e){this.lru=(0,jL.default)(e)}get(e){let t=this.lru.get(e);if(t){if(t.expire&&t.expire<Date.now()){this.lru.remove(e);return}return t.value}}set(e,t,i){this.lru.set(e,{value:t,expire:Date.now()+i})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}};var p4=R($o()),dM=R(vp()),K7=new C7(1e3),T_e=60*1e3,P_e=p4.default.default?p4.default.default:p4.default,C_e=new P_e({concurrency:4}),hM=r=>{if(r.Path)return r.Path;throw new Error(r.Message)};async function pM(r,e){return(async(i,n={})=>{let s=new URLSearchParams(n);s.set("arg",i);let o=s.toString();if(!n.nocache&&K7.has(o)){let c=K7.get(o);return hM(c)}let a=await C_e.add(async()=>{let c=await dM.default.get("https://ipfs.io/api/v0/dns",{searchParams:s}),u=new URL(c.url).search.slice(1),l=await c.json();return K7.set(u,l,T_e),l});return hM(a)})(r,e)}function O_e(r){return r.endsWith(".eth")&&(r=r.replace(/.eth$/,".eth.link")),r}function yM(){return Q(async(e,t={recursive:!0})=>{if(typeof e!="string")throw new Error("Invalid arguments, domain must be a string");return e=O_e(e),pM(e,t)})}f();function gM({network:r}){return()=>{let e=r.try();return e!=null&&Boolean(e.libp2p.isStarted())}}f();var ME=R(gp());we();var TU=R(ot());function PU({repo:r,codecs:e,bases:t,name:i}){async function n(s,o={}){if(!ME.default.path(s))throw new Error("invalid argument "+s);if(ME.default.ipnsPath(s))for await(let w of i.resolve(s,o))s=w;let[,a,c,...u]=s.split("/"),l=o.cidBase?await t.getBase(o.cidBase):void 0,d=iSe(c);if(u.length===0){let w=l?l.encoder.encode(d):c;return`/${a}/${w}`}let h=L.decode(d);s=u.join("/");let p=ol(h,s,e,r,o),y=h,g=s;for await(let w of p)L.asCID(w.value)&&(y=w.value,g=w.remainderPath);return`/ipfs/${y.toString(l&&l.encoder)}${g?"/"+g:""}`}return Q(n)}function iSe(r){try{return TU.default.parse(r).toBytes()}catch{return L.parse(r).bytes}}f();f();var OU=R(Qn());we();function kU({addAll:r}){return(e,t={})=>{let i,n=L.asCID(e);return n?i=r([{cid:n,...t}],t):i=r([{path:e.toString(),...t}],t),(0,OU.default)(i)}}f();f();var Mp=R(Kf());we();async function*Wa(r){if(r==null)throw(0,Mp.default)(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT");let e=L.asCID(r);if(e){yield Xo({cid:e});return}if(r instanceof String||typeof r=="string"){yield Xo({path:r});return}if(r.cid!=null||r.path!=null)return yield Xo(r);if(Symbol.iterator in r){let t=r[Symbol.iterator](),i=t.next();if(i.done)return t;if(L.asCID(i.value)||i.value instanceof String||typeof i.value=="string"){yield Xo({cid:i.value});for(let n of t)yield Xo({cid:n});return}if(i.value.cid!=null||i.value.path!=null){yield Xo(i.value);for(let n of t)yield Xo(n);return}throw(0,Mp.default)(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in r){let t=r[Symbol.asyncIterator](),i=await t.next();if(i.done)return t;if(L.asCID(i.value)||i.value instanceof String||typeof i.value=="string"){yield Xo({cid:i.value});for await(let n of t)yield Xo({cid:n});return}if(i.value.cid!=null||i.value.path!=null){yield Xo(i.value);for await(let n of t)yield Xo(n);return}throw(0,Mp.default)(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}throw(0,Mp.default)(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}function Xo(r){let e=r.cid||`${r.path}`;if(!e)throw(0,Mp.default)(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");let t={path:e,recursive:r.recursive!==!1};return r.metadata!=null&&(t.metadata=r.metadata),t}f();var Ot={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};function DU({repo:r,codecs:e}){async function*t(i,n={}){let s=async function*(){for await(let{path:c,recursive:u,metadata:l}of Wa(i)){let{cid:d}=await sl(r,e,c),{reason:h}=await r.pins.isPinnedWithType(d,[Ot.recursive,Ot.direct]);if(h==="recursive"&&!u)throw new Error(`${d} already pinned recursively`);u?await r.pins.pinRecursively(d,{metadata:l}):await r.pins.pinDirectly(d,{metadata:l}),yield d}};if(!Boolean(n.lock)){yield*s();return}let a=await r.gcLock.readLock();try{yield*s()}finally{a()}}return Q(t)}f();var jE=R(St());function y2(r,e,t){let i={type:r,cid:e};return t&&(i.metadata=t),i}function NU({repo:r,codecs:e}){async function*t(i={}){let n=Ot.all;if(i.type&&(n=i.type,!Object.keys(Ot).includes(n)))throw(0,jE.default)(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(i.paths){let s=!1;for await(let{path:o}of Wa(i.paths)){let{cid:a}=await sl(r,e,o),{reason:c,pinned:u,parent:l,metadata:d}=await r.pins.isPinnedWithType(a,n);if(!u)throw(0,jE.default)(new Error(`path '${o}' is not pinned`),"ERR_NOT_PINNED");switch(c){case Ot.direct:case Ot.recursive:s=!0,yield y2(c,a,d);break;default:s=!0,yield y2(`${Ot.indirect} through ${l}`,a,d)}}if(!s)throw new Error("No match found");return}if(n===Ot.recursive||n===Ot.all)for await(let{cid:s,metadata:o}of r.pins.recursiveKeys())yield y2(Ot.recursive,s,o);if(n===Ot.indirect||n===Ot.all)for await(let s of r.pins.indirectKeys(i))yield y2(Ot.indirect,s);if(n===Ot.direct||n===Ot.all)for await(let{cid:s,metadata:o}of r.pins.directKeys())yield y2(Ot.direct,s,o)}return Q(t)}f();var BU=R(Qn());function LU({rmAll:r}){async function e(t,i={}){let n=await(0,BU.default)(r([{path:t,...i}],i));if(!n)throw new Error("CID expected");return n}return e}f();function MU({repo:r,codecs:e}){async function*t(i,n={}){let s=await r.gcLock.readLock();try{for await(let{path:o,recursive:a}of Wa(i)){let{cid:c}=await sl(r,e,o),{pinned:u,reason:l}=await r.pins.isPinnedWithType(c,Ot.all);if(!u)throw new Error(`${c} is not pinned`);switch(l){case Ot.recursive:if(!a)throw new Error(`${c} is pinned recursively`);await r.pins.unpin(c),yield c;break;case Ot.direct:await r.pins.unpin(c),yield c;break;default:throw new Error(`${c} is pinned indirectly under ${l}`)}}}finally{s()}}return Q(t)}var qE=class{constructor({codecs:e,repo:t}){let i=DU({codecs:e,repo:t});this.addAll=i,this.add=kU({addAll:i});let n=MU({codecs:e,repo:t});this.rmAll=n,this.rm=LU({rmAll:n}),this.ls=NU({codecs:e,repo:t}),this.remote={add:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:async function*(s,o={}){return Promise.reject(new Error("Not implemented"))},rm:(s,o={})=>Promise.reject(new Error("Not implemented")),rmAll:(s,o={})=>Promise.reject(new Error("Not implemented")),service:{add:(s,o)=>Promise.reject(new Error("Not implemented")),rm:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:(s={})=>Promise.reject(new Error("Not implemented"))}}}};f();f();var BF=R(ot()),LF=R(St()),n9=R(le());f();var E2=R(ot());Mr();eo();var Es=R(St()),QE=R(le());tt();hi();f();var EF=R(FU());Mr();var i6=R(Ya()),n6=R(ot());Ji();zc();var Li=R(rF());en();ct();tt();Si();hi();Qu();var HE=R(hF()),$E=R(le());f();var rd=R(Br()),pF=rd.default.Reader,bSe=rd.default.Writer,Je=rd.default.util,w2=rd.default.roots["ipfs-ipns"]||(rd.default.roots["ipfs-ipns"]={}),Vp=w2.IpnsEntry=(()=>{function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.value=Je.newBuffer([]),r.prototype.signature=Je.newBuffer([]),r.prototype.validityType=0,r.prototype.validity=Je.newBuffer([]),r.prototype.sequence=Je.Long?Je.Long.fromBits(0,0,!0):0,r.prototype.ttl=Je.Long?Je.Long.fromBits(0,0,!0):0,r.prototype.pubKey=Je.newBuffer([]),r.prototype.signatureV2=Je.newBuffer([]),r.prototype.data=Je.newBuffer([]),r.encode=function(t,i){return i||(i=bSe.create()),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(10).bytes(t.value),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&i.uint32(18).bytes(t.signature),t.validityType!=null&&Object.hasOwnProperty.call(t,"validityType")&&i.uint32(24).int32(t.validityType),t.validity!=null&&Object.hasOwnProperty.call(t,"validity")&&i.uint32(34).bytes(t.validity),t.sequence!=null&&Object.hasOwnProperty.call(t,"sequence")&&i.uint32(40).uint64(t.sequence),t.ttl!=null&&Object.hasOwnProperty.call(t,"ttl")&&i.uint32(48).uint64(t.ttl),t.pubKey!=null&&Object.hasOwnProperty.call(t,"pubKey")&&i.uint32(58).bytes(t.pubKey),t.signatureV2!=null&&Object.hasOwnProperty.call(t,"signatureV2")&&i.uint32(66).bytes(t.signatureV2),t.data!=null&&Object.hasOwnProperty.call(t,"data")&&i.uint32(74).bytes(t.data),i},r.decode=function(t,i){t instanceof pF||(t=pF.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new w2.IpnsEntry;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.value=t.bytes();break;case 2:s.signature=t.bytes();break;case 3:s.validityType=t.int32();break;case 4:s.validity=t.bytes();break;case 5:s.sequence=t.uint64();break;case 6:s.ttl=t.uint64();break;case 7:s.pubKey=t.bytes();break;case 8:s.signatureV2=t.bytes();break;case 9:s.data=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof w2.IpnsEntry)return t;var i=new w2.IpnsEntry;switch(t.value!=null&&(typeof t.value=="string"?Je.base64.decode(t.value,i.value=Je.newBuffer(Je.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),t.signature!=null&&(typeof t.signature=="string"?Je.base64.decode(t.signature,i.signature=Je.newBuffer(Je.base64.length(t.signature)),0):t.signature.length&&(i.signature=t.signature)),t.validityType){case"EOL":case 0:i.validityType=0;break}return t.validity!=null&&(typeof t.validity=="string"?Je.base64.decode(t.validity,i.validity=Je.newBuffer(Je.base64.length(t.validity)),0):t.validity.length&&(i.validity=t.validity)),t.sequence!=null&&(Je.Long?(i.sequence=Je.Long.fromValue(t.sequence)).unsigned=!0:typeof t.sequence=="string"?i.sequence=parseInt(t.sequence,10):typeof t.sequence=="number"?i.sequence=t.sequence:typeof t.sequence=="object"&&(i.sequence=new Je.LongBits(t.sequence.low>>>0,t.sequence.high>>>0).toNumber(!0))),t.ttl!=null&&(Je.Long?(i.ttl=Je.Long.fromValue(t.ttl)).unsigned=!0:typeof t.ttl=="string"?i.ttl=parseInt(t.ttl,10):typeof t.ttl=="number"?i.ttl=t.ttl:typeof t.ttl=="object"&&(i.ttl=new Je.LongBits(t.ttl.low>>>0,t.ttl.high>>>0).toNumber(!0))),t.pubKey!=null&&(typeof t.pubKey=="string"?Je.base64.decode(t.pubKey,i.pubKey=Je.newBuffer(Je.base64.length(t.pubKey)),0):t.pubKey.length&&(i.pubKey=t.pubKey)),t.signatureV2!=null&&(typeof t.signatureV2=="string"?Je.base64.decode(t.signatureV2,i.signatureV2=Je.newBuffer(Je.base64.length(t.signatureV2)),0):t.signatureV2.length&&(i.signatureV2=t.signatureV2)),t.data!=null&&(typeof t.data=="string"?Je.base64.decode(t.data,i.data=Je.newBuffer(Je.base64.length(t.data)),0):t.data.length&&(i.data=t.data)),i},r.toObject=function(t,i){i||(i={});var n={};if(i.defaults){if(i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=Je.newBuffer(n.value))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=Je.newBuffer(n.signature))),n.validityType=i.enums===String?"EOL":0,i.bytes===String?n.validity="":(n.validity=[],i.bytes!==Array&&(n.validity=Je.newBuffer(n.validity))),Je.Long){var s=new Je.Long(0,0,!0);n.sequence=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.sequence=i.longs===String?"0":0;if(Je.Long){var s=new Je.Long(0,0,!0);n.ttl=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.ttl=i.longs===String?"0":0;i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=Je.newBuffer(n.pubKey))),i.bytes===String?n.signatureV2="":(n.signatureV2=[],i.bytes!==Array&&(n.signatureV2=Je.newBuffer(n.signatureV2))),i.bytes===String?n.data="":(n.data=[],i.bytes!==Array&&(n.data=Je.newBuffer(n.data)))}return t.value!=null&&t.hasOwnProperty("value")&&(n.value=i.bytes===String?Je.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),t.signature!=null&&t.hasOwnProperty("signature")&&(n.signature=i.bytes===String?Je.base64.encode(t.signature,0,t.signature.length):i.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),t.validityType!=null&&t.hasOwnProperty("validityType")&&(n.validityType=i.enums===String?w2.IpnsEntry.ValidityType[t.validityType]:t.validityType),t.validity!=null&&t.hasOwnProperty("validity")&&(n.validity=i.bytes===String?Je.base64.encode(t.validity,0,t.validity.length):i.bytes===Array?Array.prototype.slice.call(t.validity):t.validity),t.sequence!=null&&t.hasOwnProperty("sequence")&&(typeof t.sequence=="number"?n.sequence=i.longs===String?String(t.sequence):t.sequence:n.sequence=i.longs===String?Je.Long.prototype.toString.call(t.sequence):i.longs===Number?new Je.LongBits(t.sequence.low>>>0,t.sequence.high>>>0).toNumber(!0):t.sequence),t.ttl!=null&&t.hasOwnProperty("ttl")&&(typeof t.ttl=="number"?n.ttl=i.longs===String?String(t.ttl):t.ttl:n.ttl=i.longs===String?Je.Long.prototype.toString.call(t.ttl):i.longs===Number?new Je.LongBits(t.ttl.low>>>0,t.ttl.high>>>0).toNumber(!0):t.ttl),t.pubKey!=null&&t.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?Je.base64.encode(t.pubKey,0,t.pubKey.length):i.bytes===Array?Array.prototype.slice.call(t.pubKey):t.pubKey),t.signatureV2!=null&&t.hasOwnProperty("signatureV2")&&(n.signatureV2=i.bytes===String?Je.base64.encode(t.signatureV2,0,t.signatureV2.length):i.bytes===Array?Array.prototype.slice.call(t.signatureV2):t.signatureV2),t.data!=null&&t.hasOwnProperty("data")&&(n.data=i.bytes===String?Je.base64.encode(t.data,0,t.data.length):i.bytes===Array?Array.prototype.slice.call(t.data):t.data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,rd.default.util.toJSONOptions)},r.ValidityType=function(){let e={},t=Object.create(e);return t[e[0]="EOL"]=0,t}(),r})();f();function t6(r){let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),t=String(r).trim().match(e);if(!t)throw new Error("Invalid format");let i=parseInt(t[1],10),n=parseInt(t[2],10)-1,s=parseInt(t[3],10),o=parseInt(t[4],10),a=parseInt(t[5],10),c=parseInt(t[6],10),u=parseInt(t[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,u))}f();var yF="ERR_IPNS_EXPIRED_RECORD",zE="ERR_UNRECOGNIZED_VALIDITY",gF="ERR_SIGNATURE_CREATION",id="ERR_SIGNATURE_VERIFICATION",mF="ERR_UNRECOGNIZED_FORMAT",bF="ERR_PEER_ID_FROM_PUBLIC_KEY",wF="ERR_PUBLIC_KEY_FROM_ID",r6="ERR_UNDEFINED_PARAMETER",_F="ERR_INVALID_RECORD_DATA",vF="ERR_INVALID_EMBEDDED_KEY";var vs=Object.assign((0,$E.default)("jsipns"),{error:(0,$E.default)("jsipns:error")}),wSe=ws.code,_Se=Qe("/ipns/"),_2="/ipns/",s6=_2.length,SF=(r,e,t,i)=>{let n=new EF.default(Date.now()+Number(i)),s=Vp.ValidityType.EOL,[o,a]=i.toString().split("."),c=BigInt(o)*BigInt(1e5)+BigInt(a||0);return vSe(r,e,t,s,n,c)};var vSe=async(r,e,t,i,n,s)=>{t=BigInt(t);let o=Qe(n.toString()),a=await RSe(r,e,i,o),c=ESe(e,o,i,t,s),u=xF(c),l=await r.sign(u),d={value:e,signature:a,validityType:i,validity:o,sequence:t,ttl:s,signatureV2:l,data:c};return vs(`ipns entry for ${e} created`),d},ESe=(r,e,t,i,n)=>$n({Value:r,Validity:e,ValidityType:t,Sequence:i,TTL:n}),GE=async(r,e)=>{let{value:t,validityType:i,validity:n}=e,s,o;e.signatureV2&&e.data?(o=e.signatureV2,s=xF(e.data),SSe(e)):(o=e.signature,s=AF(t,i,n));let a;try{a=await r.verify(s,o)}catch(c){a=!1}if(!a)throw vs.error("record signature verification failed"),(0,Li.default)(new Error("record signature verification failed"),id);if(i===Vp.ValidityType.EOL){let c;try{c=t6($e(n))}catch(u){throw vs.error("unrecognized validity format (not an rfc3339 format)"),(0,Li.default)(new Error("unrecognized validity format (not an rfc3339 format)"),mF)}if(c.getTime()<Date.now())throw vs.error("record has expired"),(0,Li.default)(new Error("record has expired"),yF)}else if(i)throw vs.error("unrecognized validity type"),(0,Li.default)(new Error("unrecognized validity type"),zE);vs(`ipns entry for ${t} is valid`)},SSe=r=>{if(!r.data)throw(0,Li.default)(new Error("Record data is missing"),_F);let e=wi(r.data);if(Number.isInteger(e.Sequence)&&(e.Sequence=BigInt(e.Sequence)),Number.isInteger(e.TTL)&&(e.TTL=BigInt(e.TTL)),!Hs(e.Value,r.value))throw(0,Li.default)(new Error('Field "value" did not match between protobuf and CBOR'),id);if(!Hs(e.Validity,r.validity))throw(0,Li.default)(new Error('Field "validity" did not match between protobuf and CBOR'),id);if(e.ValidityType!==r.validityType)throw(0,Li.default)(new Error('Field "validityType" did not match between protobuf and CBOR'),id);if(e.Sequence!==r.sequence)throw(0,Li.default)(new Error('Field "sequence" did not match between protobuf and CBOR'),id);if(e.TTL!==r.ttl)throw(0,Li.default)(new Error('Field "ttl" did not match between protobuf and CBOR'),id)},RF=async(r,e)=>{if(!r||!r.bytes||!e){let n=new Error("one or more of the provided parameters are not defined");throw vs.error(n),(0,Li.default)(n,r6)}let t;try{t=await n6.default.createFromPubKey(r.bytes)}catch(n){throw(0,Li.default)(n,bF)}let i;try{i=xSe(t)}catch(n){throw vs.error(n),(0,Li.default)(n,wF)}if(i)return null;try{e.pubKey=i6.default.keys.marshalPublicKey(r)}catch(n){throw vs.error(n),n}return e},WE=async(r,e)=>{if(!e||!r){let i=new Error("one or more of the provided parameters are not defined");throw vs.error(i),(0,Li.default)(i,r6)}let t;if(e.pubKey){try{t=i6.default.keys.unmarshalPublicKey(e.pubKey)}catch(n){throw vs.error(n),n}if(!(await n6.default.createFromPubKey(e.pubKey)).equals(r))throw(0,Li.default)(new Error("Embedded public key did not match PeerID"),vF)}else r.pubKey&&(t=r.pubKey);if(t)return t;throw(0,Li.default)(new Error("no public key is available"),r6)},YE=r=>lv.encode(r).slice(1),v2=r=>new xe(`/ipns/${YE(r)}`),nd=r=>{let e=Qe("/pk/"),t=Qe("/ipns/");return{routingPubKey:new xe(Ni([e,r]),!1),pkKey:new xe(YE(Ni([e,r]))),routingKey:new xe(Ni([t,r]),!1),ipnsKey:new xe(YE(Ni([t,r])))}},RSe=(r,e,t,i)=>{try{let n=AF(e,t,i);return r.sign(n)}catch(n){throw vs.error("record signature creation failed"),(0,Li.default)(new Error("record signature creation failed: "+n.message),gF)}},ASe=r=>{if(r.toString()==="0")return"EOL";let e=new Error(`unrecognized validity type ${r.toString()}`);throw vs.error(e),(0,Li.default)(e,zE)},AF=(r,e,t)=>{let i=Qe(ASe(e));return Ni([r,t,i])},xF=r=>{let e=Qe("ipns-signature:");return Ni([e,r])},xSe=r=>{let e=fi(r.id);return e.code!==wSe?null:i6.default.keys.unmarshalPublicKey(e.digest)},XE=r=>Vp.encode({...r,sequence:HE.default.fromString(r.sequence.toString()),ttl:r.ttl==null?void 0:HE.default.fromString(r.ttl.toString())}).finish(),eu=r=>{let e=Vp.decode(r),t=Vp.toObject(e,{defaults:!1,arrays:!0,objects:!1});return{value:t.value,signature:t.signature,validityType:t.validityType,validity:t.validity,sequence:Object.hasOwnProperty.call(t,"sequence")?BigInt(`${t.sequence}`):0,pubKey:t.pubKey,ttl:Object.hasOwnProperty.call(t,"ttl")?BigInt(`${t.ttl}`):void 0,signatureV2:t.signatureV2,data:t.data}},sd={validate:async(r,e)=>{let t=eu(r),i=e.slice(_Se.length),n=n6.default.createFromBytes(i),s=await WE(n,t);await GE(s,t)},select:(r,e)=>{let t=eu(r),i=eu(e);if(t.signatureV2&&!i.signatureV2)return 0;if(i.signatureV2&&!t.signatureV2)return 1;if(t.sequence>i.sequence)return 0;if(t.sequence<i.sequence)return 1;let n=t6($e(t.validity));return t6($e(i.validity)).getTime()>n.getTime()?1:0}};var es=Object.assign((0,QE.default)("ipfs:ipns:publisher"),{error:(0,QE.default)("ipfs:ipns:publisher:error")}),IF=Ri().code,TF=60*60*1e3,zp=class{constructor(e,t){this._routing=e,this._datastore=t}async publishWithEOL(e,t,i){if(!e||!e.bytes)throw(0,Es.default)(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");let n=await E2.default.createFromPrivKey(e.bytes),s=await this._updateOrCreateRecord(e,t,i,n);return this._putRecordToRouting(s,n)}publish(e,t){return this.publishWithEOL(e,t,TF)}async _putRecordToRouting(e,t){if(!E2.default.isPeerId(t)){let o="peerId received is not valid";throw es.error(o),(0,Es.default)(new Error(o),"ERR_INVALID_PEER_ID")}let i=t.pubKey,n=await RF(i,e),s=nd(t.toBytes());return await this._publishEntry(s.routingKey,n||e),n||e}async _publishEntry(e,t){let i=xe.asKey(e);if(!i){let s="datastore key does not have a valid format";throw es.error(s),(0,Es.default)(new Error(s),"ERR_INVALID_DATASTORE_KEY")}let n;try{n=XE(t)}catch(s){throw es.error(s),s}try{let s=await this._routing.put(i.uint8Array(),n);return es(`ipns record for ${$e(i.uint8Array(),"base32")} was stored in the routing`),s}catch(s){let o=`ipns record for ${$e(i.uint8Array(),"base32")} could not be stored in the routing - ${s.stack}`;throw es.error(o),es.error(s),(0,Es.default)(new Error(o),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(e,t={}){if(!E2.default.isPeerId(e)){let n="peerId received is not valid";throw es.error(n),(0,Es.default)(new Error(n),"ERR_INVALID_PEER_ID")}let i=t.checkRouting!==!1;try{let n=await this._datastore.get(v2(e.id));return this._unmarshalData(n)}catch(n){if(n.code!==IF){let s=`unexpected error getting the ipns record ${e.id} from datastore`;throw es.error(s),(0,Es.default)(new Error(s),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!i)throw(0,Es.default)(n,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{let s=nd(e.toBytes()),o=await this._routing.get(s.routingKey.uint8Array());return this._unmarshalData(o)}catch(s){throw es.error(s),s}}}_unmarshalData(e){try{return eu(e)}catch(t){throw(0,Es.default)(t,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(e,t,i,n){if(!E2.default.isPeerId(n)){let u="peerId received is not valid";throw es.error(u),(0,Es.default)(new Error(u),"ERR_INVALID_PEER_ID")}let s={checkRouting:!0},o;try{o=await this._getPublished(n,s)}catch(u){if(u.code!==IF){let l=`unexpected error when determining the last published IPNS record for ${n.id} ${u.stack}`;throw es.error(l),(0,Es.default)(new Error(l),"ERR_DETERMINING_PUBLISHED_RECORD")}}let a=0n;o&&o.sequence!==void 0&&(a=Hs(o.value,t)?BigInt(o.sequence):BigInt(o.sequence)+BigInt(1));let c;try{c=await SF(e,t,a,i)}catch(u){let l=`ipns record for ${t} could not be created`;throw es.error(u),(0,Es.default)(new Error(l),"ERR_CREATING_IPNS_RECORD")}try{let u=XE(c);return await this._datastore.put(v2(n.id),u),es(`ipns record for ${$e(t,"base32")} was stored in the datastore`),c}catch(u){let l=`ipns record for ${t} could not be stored in the datastore`;throw es.error(l),(0,Es.default)(new Error(l),"ERR_STORING_IN_DATASTORE")}}};zp.defaultRecordLifetime=TF;f();var PF=R(Ya()),ZE=R(ot()),_l=R(St()),JE=R(le()),o6=Object.assign((0,JE.default)("ipfs:ipns:republisher"),{error:(0,JE.default)("ipfs:ipns:republisher:error")}),CF=60*1e3,OF=60*CF,ISe=4*OF,TSe=24*OF,e9=class{constructor(e,t,i,n,s={pass:""}){this._publisher=e,this._datastore=t,this._peerId=i,this._keychain=n,this._options=s,this._republishHandle=null}async start(){if(this._republishHandle)throw(0,_l.default)(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");let e={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:s=>{e._timeoutId=setTimeout(async()=>{e._timeoutId=null;try{e._inflightTask=e._task(),await e._inflightTask,e._task&&e.runPeriodically(s)}catch(o){o6.error(o)}},s())},cancel:async()=>{e._timeoutId!=null&&clearTimeout(e._timeoutId),e._task=null,await e._inflightTask}},{privKey:t}=this._peerId,{pass:i}=this._options,n=!0;e._task=()=>this._republishEntries(t,i),e.runPeriodically(()=>n?(n=!1,this._options.initialBroadcastInterval||CF):this._options.broadcastInterval||ISe),this._republishHandle=e}async stop(){let e=this._republishHandle;if(!e)throw(0,_l.default)(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await e.cancel()}async _republishEntries(e,t){try{await this._republishEntry(e)}catch(i){let n="cannot republish entry for the node's private key";o6.error(n);return}if(t)try{let i=await this._keychain.listKeys();for(let n of i){if(n.name==="self")continue;let s=await this._keychain.exportKey(n.name,t),o=await PF.default.keys.import(s,t);await this._republishEntry(o)}}catch(i){o6.error(i)}}async _republishEntry(e){if(!e||!e.bytes)throw(0,_l.default)(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");try{let t=await ZE.default.createFromPrivKey(e.bytes),i=await this._getPreviousValue(t);await this._publisher.publishWithEOL(e,i,TSe)}catch(t){if(t.code==="ERR_NO_ENTRY_FOUND")return;throw t}}async _getPreviousValue(e){if(!ZE.default.isPeerId(e))throw(0,_l.default)(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{let t=await this._datastore.get(v2(e.id));if(!(t instanceof Uint8Array))throw(0,_l.default)(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return eu(t).value}catch(i){throw o6.error(i),(0,_l.default)(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(t){throw t&&t.notFound?(0,_l.default)(new Error(`no previous entry for record with id: ${e.id}`),"ERR_NO_ENTRY_FOUND"):t}}};f();var kF=R(ot()),od=R(St()),t9=R(le());tt();eo();var a6=Object.assign((0,t9.default)("ipfs:ipns:resolver"),{error:(0,t9.default)("ipfs:ipns:resolver:error")}),PSe=Ri().code,DF=32,r9=class{constructor(e){this._routing=e}async resolve(e,t={}){if(typeof e!="string")throw(0,od.default)(new Error("invalid name"),"ERR_INVALID_NAME");let i=t.recursive&&t.recursive.toString()==="true",n=e.split("/");if(n.length!==3||n[0]!=="")throw(0,od.default)(new Error("invalid name"),"ERR_INVALID_NAME");let s=n[2],o=1/0;i&&(o=DF);let a=await this.resolver(s,o);return a6(`${e} was locally resolved correctly`),a}async resolver(e,t){if(t===0){let s=`could not resolve name (recursion limit of ${DF} exceeded)`;throw a6.error(s),(0,od.default)(new Error(s),"ERR_RESOLVE_RECURSION_LIMIT")}let i=await this._resolveName(e),n=i.split("/");return n[1]==="ipfs"||!t?i:this.resolver(n[2],t-1)}async _resolveName(e){let t=kF.default.parse(e),{routingKey:i}=nd(t.toBytes()),n;try{n=await this._routing.get(i.uint8Array())}catch(o){throw a6.error("could not get record from routing",o),o.code===PSe?(0,od.default)(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND"):(0,od.default)(new Error(`unexpected error getting the ipns record ${t.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s;try{s=eu(n)}catch(o){throw a6.error("could not unmarshal record",o),(0,od.default)(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_RECORD_RECEIVED")}return this._validateRecord(t,s)}async _validateRecord(e,t){let i=await WE(e,t);return await GE(i,t),$e(t.value)}};f();var NF=R(wp()),i9=class{constructor(e){this.lru=(0,NF.default)(e)}get(e){let t=this.lru.get(e);if(t){if(t.expire&&t.expire<Date.now()){this.lru.remove(e);return}return t.value}}set(e,t,i){this.lru.set(e,{value:t,expire:Date.now()+i})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}};tt();var S2=Object.assign((0,n9.default)("ipfs:ipns"),{error:(0,n9.default)("ipfs:ipns:error")}),MF=60*1e3,c6=class{constructor(e,t,i,n,s){this.publisher=new zp(e,t),this.republisher=new e9(this.publisher,t,i,n,s),this.resolver=new r9(e),this.cache=new i9(1e3),this.routing=e}async publish(e,t,i=zp.defaultRecordLifetime){try{let n=await(0,BF.createFromPrivKey)(e.bytes);await this.publisher.publishWithEOL(e,t,i),S2(`IPNS value ${$e(t,"base32")} was published correctly`);let s=n.toB58String(),o=parseFloat(i),a=o<MF?o:MF;return this.cache.set(s,t,a),S2(`IPNS value ${$e(t,"base32")} was cached correctly`),{name:s,value:t}}catch(n){throw S2.error(n),n}}async resolve(e,t={}){if(typeof e!="string")throw(0,LF.default)(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!t.nocache&&!t.recursive){let i=e.split("/")[2],n=this.cache.get(i);if(n)return n}try{let i=await this.resolver.resolve(e,t);return S2(`IPNS record from ${e} was resolved correctly`),i}catch(i){throw S2.error(i),i}}async initializeKeyspace(e,t){return this.publish(e,t,zp.defaultRecordLifetime)}};f();d9();var S6=R(A2());f();di();f();$p();b6();f();var oK=R(T9());tt();ct();var w6="/record/";function P9(r){return $e(r,"base32")}function P2(r){(typeof r=="string"||r instanceof String)&&(r=Qe(r.toString()));let e=$e(r,"base64url");return`${w6}${e}`}function aK(r){if(r.substring(0,w6.length)!==w6)throw(0,oK.default)(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");let e=r.substring(w6.length);return Qe(e,"base64url")}hi();var Ss=R(T9()),C9=R(le()),wn=Object.assign((0,C9.default)("datastore-pubsub:publisher"),{error:(0,C9.default)("datastore-pubsub:publisher:error")}),O9=class extends nn{constructor(e,t,i,n,s){super();if(!n)throw(0,Ss.default)(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if(typeof n.validate!="function")throw(0,Ss.default)(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if(typeof n.select!="function")throw(0,Ss.default)(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(s&&typeof s!="function")throw(0,Ss.default)(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=t,this._peerId=i,this._validator=n,this._handleSubscriptionKeyFn=s,this._onMessage=this._onMessage.bind(this)}async put(e,t){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw wn.error(n),(0,Ss.default)(new Error(n),"ERR_INVALID_DATASTORE_KEY")}if(!(t instanceof Uint8Array)){let n="received value is not a Uint8Array";throw wn.error(n),(0,Ss.default)(new Error(n),"ERR_INVALID_VALUE_RECEIVED")}let i=P2(e);wn(`publish value for topic ${i}`),await this._pubsub.publish(i,t)}async get(e){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw wn.error(n),(0,Ss.default)(new Error(n),"ERR_INVALID_DATASTORE_KEY")}let t=P2(e),i=await this._pubsub.getTopics();if(i&&Array.isArray(i)&&i.indexOf(t)>-1)return this._getLocal(e);try{this._pubsub.on(t,this._onMessage),await this._pubsub.subscribe(t)}catch(n){let s=`cannot subscribe topic ${t}`;throw wn.error(s),(0,Ss.default)(new Error(s),"ERR_SUBSCRIBING_TOPIC")}return wn(`subscribed values for key ${t}`),this._getLocal(e)}unsubscribe(e){let t=P2(e);return this._pubsub.removeListener(t,this._onMessage),this._pubsub.unsubscribe(t)}async _getLocal(e){let t=new xe("/"+P9(e),!1),i;try{i=await this._datastore.get(t)}catch(n){if(n.code!=="ERR_NOT_FOUND"){let o=`unexpected error getting the ipns record for ${t.toString()}`;throw wn.error(o),(0,Ss.default)(new Error(o),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s=`local record requested was not found for ${t.toString()}`;throw wn.error(s),(0,Ss.default)(new Error(s),"ERR_NOT_FOUND")}if(!(i instanceof Uint8Array)){let n="found record that we couldn't convert to a value";throw wn.error(n),(0,Ss.default)(new Error(n),"ERR_INVALID_RECORD_RECEIVED")}return i}async _onMessage(e){let{data:t,from:i,topicIDs:n}=e,s;try{s=aK(n[0])}catch(o){wn.error(o);return}if(wn(`message received for topic ${n[0]}`),i===this._peerId.toB58String()){wn("message discarded as it is from the same peer");return}if(this._handleSubscriptionKeyFn){let o;try{o=await this._handleSubscriptionKeyFn(s)}catch(a){wn.error("message discarded by the subscriptionKeyFn");return}s=o}try{await this._storeIfSubscriptionIsBetter(s,t)}catch(o){wn.error(o)}}async _storeIfSubscriptionIsBetter(e,t){let i=!1;try{i=await this._isBetter(e,t)}catch(n){if(n.code!=="ERR_NOT_VALID_RECORD")throw n}i&&await this._storeRecord(e,t)}async _validateRecord(e,t){return this._validator.validate(e,t)}async _selectRecord(e,t){return await this._validator.select(e,t)===0}async _isBetter(e,t){try{await this._validateRecord(t,e)}catch(s){let o="record received through pubsub is not valid";throw wn.error(o),(0,Ss.default)(new Error(o),"ERR_NOT_VALID_RECORD")}let i=new xe(e),n;try{n=await this._getLocal(i.uint8Array())}catch(s){return!0}return Hs(n,t)?!1:this._selectRecord(e,[n,t])}async _storeRecord(e,t){let i=new xe("/"+P9(e),!1);await this._datastore.put(i,t),wn(`record for ${P2(e)} was stored in the datastore`)}};ct();tt();var k9=R(St()),D9=R(le()),_6=Object.assign((0,D9.default)("ipfs:ipns:pubsub"),{error:(0,D9.default)("ipfs:ipns:pubsub:error")}),Yp=class{constructor(e,t,i){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new O9(e,t,i,sd,this._handleSubscriptionKey)}async put(e,t){try{await this._pubsubDs.put(e,t)}catch(i){throw _6.error(i),i}}async get(e){let t,i;try{t=await this._pubsubDs.get(e)}catch(s){i=s}let n=e.slice(0,s6);if($e(n)===_2){let s=yt.encode(e).substring(1),o=yt.encode(e.slice(s6)).substring(1);this._subscriptions[s]=o,_6(`subscribed to pubsub topic ${s}, id ${o}`)}if(i)throw i;return t}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=$e(e,"base58btc"));let t=this._subscriptions[e];if(!t)throw(0,k9.default)(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");let i;try{i=nd(Qe(t,"base58btc"))}catch(n){throw _6.error(n),n}return i.routingKey.uint8Array()}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map(t=>`${_2}${t}`)}async cancel(e){if(typeof e!="string")throw(0,k9.default)(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(_2)&&(e=e.substring(s6));let t=Object.keys(this._subscriptions).find(n=>this._subscriptions[n]===e);if(!t)return{canceled:!1};let i=Qe(t);return this._pubsubDs.unsubscribe(i),delete this._subscriptions[t],_6(`unsubscribed pubsub ${t}: ${e}`),{canceled:!0}}};f();Mr();var M9=R(Qa()),Qp=R(St()),j9=R(le());tt();var q9=Object.assign((0,j9.default)("ipfs:ipns:offline-datastore"),{error:(0,j9.default)("ipfs:ipns:offline-datastore:error")}),k2=class{constructor(e){this._repo=e,this.stores=[]}async put(e,t){if(!(e instanceof Uint8Array))throw(0,Qp.default)(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(t instanceof Uint8Array))throw(0,Qp.default)(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let i;try{i=this._routingKey(e)}catch(s){throw q9.error(s),(0,Qp.default)(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let n=new M9.Record(e,t);return this._repo.datastore.put(i,n.serialize())}async get(e){if(!(e instanceof Uint8Array))throw(0,Qp.default)(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let t;try{t=this._routingKey(e)}catch(s){throw q9.error(s),(0,Qp.default)(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let i=await this._repo.datastore.get(t),n;try{n=M9.Record.deserialize(i)}catch(s){throw q9.error(s),s}return n.value}_routingKey(e){return new xe("/dht/record/"+$e(e,"base32"),!1)}};f();var CK=R(ts());eo();var U9=R(le()),JSe=Object.assign((0,U9.default)("ipfs:ipns:dht-datastore"),{error:(0,U9.default)("ipfs:ipns:dht-datastore:error")}),F9=class{constructor(e){this._dht=e}async put(e,t){try{await(0,CK.default)(this._dht.put(e,t))}catch(i){throw JSe.error(i),i}}async get(e){for await(let t of this._dht.get(e))if(t.name==="VALUE")return t.value;throw Ri()}};function OK({libp2p:r,repo:e,peerId:t,options:i}){let n=[],s;if((0,S6.default)(i,"EXPERIMENTAL.ipnsPubsub",!1)){let o=r.pubsub,a=e.datastore;s=new Yp(o,a,t),n.push(s)}if(!(0,S6.default)(i,"offline",!1)&&r._config&&r._config.dht&&r._config.dht.enabled&&n.push(new F9(r._dht)),(0,S6.default)(i,"offline",!1)||n.length===0){let o=new k2(e);n.push(o)}return new R2(n)}var kK=R(le()),eRe=(0,kK.default)("ipfs:components:ipns"),K9=class{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){let e=this.online||this.offline;if(e)return e;throw new Ju}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:t,keychain:i}){if(this.offline!=null)throw new Oa;eRe("initializing IPNS keyspace");let n=new k2(e),s=new c6(n,e.datastore,t,i,this.options);this.offline=s}async startOnline({libp2p:e,repo:t,peerId:i,keychain:n}){if(this.online!=null)throw new Oa;let s=OK({libp2p:e,repo:t,peerId:i,options:this.options}),o=new c6(s,t.datastore,i,n,this.options);await o.republisher.start(),this.online=o}async stop(){let e=this.online;e&&(await e.republisher.stop(),this.online=null)}publish(e,t,i){return this.getIPNS().publish(e,t,i)}resolve(e,t){return this.getIPNS().resolve(e,t)}initializeKeyspace(e,t){return this.getIPNS().initializeKeyspace(e,t)}};f();f();var V9=R(le());var LK=R(Ya()),z9=R(St());ct();tt();f();var DK=R(gp());var NK=R(ts());async function BK({ipns:r,repo:e,codecs:t},i,n){if(DK.default.ipnsPath(i))return r.resolve(i);let{cid:s,path:o}=$c(i);await(0,NK.default)(ol(s,o||"",t,e,n))}var H9=Object.assign((0,V9.default)("ipfs:name:publish"),{error:(0,V9.default)("ipfs:name:publish:error")});function MK({ipns:r,repo:e,codecs:t,peerId:i,isOnline:n,keychain:s}){let o=async c=>{if(c==="self")return i.privKey;try{let u=await s.exportKey(c,"temp");return await LK.default.keys.import(u,"temp")}catch(u){throw H9.error(u),(0,z9.default)(u,"ERR_CANNOT_GET_KEY")}};async function a(c,u={}){let l=u.resolve!==!1,d=u.lifetime||"24h",h=u.key||"self";if(!n())throw(0,z9.default)(new Error(u4),"OFFLINE_ERROR");try{c=DL(c)}catch(b){throw H9.error(b),b}let p=0;try{p=il(d)||0,p=parseFloat(p.toFixed(6))}catch(b){throw H9.error(b),b}let y=await Promise.all([o(h),l?BK({ipns:r,repo:e,codecs:t},c):Promise.resolve()]),g=Qe(c),w=await r.publish(y[0],g,p);return{name:w.name,value:$e(w.value)}}return Q(a)}f();var $9=R(le()),R6=R(St());we();Ji();Iy();var UK=R(ot()),FK=R(qK());tt();var rRe=Pt.bind({ignoreUndefined:!0}),iRe=Object.assign((0,$9.default)("ipfs:name:resolve"),{error:(0,$9.default)("ipfs:name:resolve:error")}),KK=(r,e)=>e.length>0?r+"/"+e.join("/"):r;function VK({dns:r,ipns:e,peerId:t,isOnline:i,options:{offline:n}}){async function*s(o,a={}){if(a=rRe({nocache:!1,recursive:!0},a),n&&a&&a.nocache)throw(0,R6.default)(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");if(!i()&&!n)throw(0,R6.default)(new Error(u4),"OFFLINE_ERROR");o||(o=t.toB58String()),o.startsWith("/ipns/")||(o=`/ipns/${o}`);let[c,u,...l]=o.slice(1).split("/");try{if(u.substring(0,1)==="1"){let h=UK.default.parse(u),p=fi(h.toBytes());u=L.createV1(114,p).toString(np)}else{let h=L.parse(u);h.version===1&&(u=h.toString(np))}}catch(h){if((0,FK.default)(u)){yield KK(await r(u,a),l);return}throw iRe.error(h),(0,R6.default)(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}let d=await e.resolve(`/${c}/${u}`,a);yield KK(d instanceof Uint8Array?$e(d):d,l)}return Q(s)}f();f();f();var G9=R(St());function Zp(r,e){if(!r||!(e&&e.ipnsPubsub))throw(0,G9.default)(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(r.routing instanceof Yp)return r.routing;let t=(r.routing.stores||[]).find(i=>i instanceof Yp);if(!t)throw(0,G9.default)(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return t}function zK({ipns:r,options:e}){let t=e.EXPERIMENTAL;async function i(n,s={}){return Zp(r,t).cancel(n,s)}return Q(i)}f();function HK({ipns:r,options:e}){let t=e.EXPERIMENTAL;async function i(n={}){try{return{enabled:Boolean(Zp(r,t))}}catch(s){return{enabled:!1}}}return Q(i)}f();function $K({ipns:r,options:e}){let t=e.EXPERIMENTAL;async function i(n={}){return Zp(r,t).getSubscriptions(n)}return Q(i)}var W9=class{constructor({ipns:e,options:t}){this.cancel=zK({ipns:e,options:t}),this.state=HK({ipns:e,options:t}),this.subs=$K({ipns:e,options:t})}};var Y9=class{constructor({dns:e,ipns:t,repo:i,codecs:n,peerId:s,isOnline:o,keychain:a,options:c}){this.publish=MK({ipns:t,repo:i,codecs:n,peerId:s,isOnline:o,keychain:a}),this.resolve=VK({dns:e,ipns:t,peerId:s,isOnline:o,options:c}),this.pubsub=new W9({ipns:t,options:c})}};f();eo();we();var GK=R(Da()),WK=R(Ho()),nRe=Ri().code,X9={default:"<dst>",edges:"<src> -> <dst>"};function YK({repo:r,codecs:e,resolve:t,preload:i}){async function*n(s,o={}){if(o.maxDepth===0)return;if(o.edges&&o.format&&o.format!==X9.default)throw new Error("Cannot set edges to true and also specify format");if(o.format=o.edges?X9.edges:o.format,typeof o.maxDepth!="number"&&(o.maxDepth=o.recursive?1/0:1),o.timeout){let l=[new GK.TimeoutController(o.timeout).signal];o.signal&&l.push(o.signal),o.signal=(0,WK.anySignal)(l)}let c=(Array.isArray(s)?s:[s]).map(u=>sRe(i,u,o));for(let u of c)try{yield*oRe(t,r,e,u,o)}catch(l){yield{ref:"",err:l.message}}}return n}function sRe(r,e,t){let{cid:i,path:n}=$c(e);return t.preload!==!1&&r(i),`/ipfs/${i}${n||""}`}async function*oRe(r,e,t,i,n){let s=await r(i,n),{cid:o}=$c(s),a=n.maxDepth!=null?n.maxDepth:1/0,c=n.unique||!1;for await(let u of cRe(e,t,o,a,c,n))!u.parent||u.isDuplicate||(yield{ref:aRe(u.parent.cid,u.node.cid,u.node.name,n.format)})}function aRe(r,e,t="",i=X9.default){let n=i.replace(/<src>/g,r.toString());return n=n.replace(/<dst>/g,e.toString()),n=n.replace(/<linkname>/g,t),n}async function*cRe(r,e,t,i,n,s){let o=new Set;async function*a(c,u){let l=u+1;if(!(l>i))try{for await(let d of uRe(r,e,c.cid,s))yield{parent:c,node:d,isDuplicate:n&&o.has(d.cid.toString())},n&&o.add(d.cid.toString()),yield*a(d,l)}catch(d){throw d.code===nRe&&(d.message=`Could not find object with CID: ${c.cid}`),d}}yield*a({cid:t},0)}async function*uRe(r,e,t,i){let n=await r.blocks.get(t,i),o=(await e.getCodec(t.code)).decode(n),a=t.code===wt,c=[];for(let[u,l]of Q9(o,c)){if(a){let d=u.match(/^Links\/(\d+)\/Hash$/);if(d){let h=Number(d[1]);if(h<o.Links.length){yield{name:o.Links[h].Name,cid:l};continue}}}yield{name:u,cid:l}}}var Q9=function*(r,e){if(r!=null&&!(r instanceof Uint8Array)){for(let[t,i]of Object.entries(r)){let n=[...e,t];if(i!=null&&typeof i=="object")if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s],c=L.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*Q9(o,a))}else{let s=L.asCID(i);s?yield[n.join("/"),s]:yield*Q9(i,n)}}return[]}};f();function XK({repo:r}){async function*e(t={}){for await(let i of r.blocks.queryKeys({},{signal:t.signal}))yield{ref:i.toString()}}return Q(e)}f();f();function QK({network:r}){async function e(t={}){let{bitswap:i}=await r.use(t),n=i.getWantlist();return Array.from(n).map(s=>s[1].cid)}return Q(e)}f();var ZK=R(ot());function JK({network:r}){async function e(t,i={}){let{bitswap:n}=await r.use(i),s=n.wantlistForPeer(ZK.default.createFromB58String(t));return Array.from(s).map(o=>o[1].cid)}return Q(e)}f();function eV({network:r}){async function e(t,i={}){let{bitswap:n}=await r.use(i);return Array.isArray(t)||(t=[t]),n.unwant(t)}return Q(e)}f();function A6({network:r}){async function e(t={}){let i=(await r.use(t)).bitswap,n=i.stat().snapshot;return{provideBufLen:parseInt(n.providesBufferLength.toString()),blocksReceived:BigInt(n.blocksReceived.toString()),wantlist:Array.from(i.getWantlist()).map(s=>s[1].cid),peers:i.peers().map(s=>s.toB58String()),dupBlksReceived:BigInt(n.dupBlksReceived.toString()),dupDataReceived:BigInt(n.dupDataReceived.toString()),dataReceived:BigInt(n.dataReceived.toString()),blocksSent:BigInt(n.blocksSent.toString()),dataSent:BigInt(n.dataSent.toString())}}return Q(e)}var Z9=class{constructor({network:e}){this.wantlist=QK({network:e}),this.wantlistForPeer=JK({network:e}),this.unwant=eV({network:e}),this.stat=A6({network:e})}};f();f();f();var tV=R(Ff());function x6(r){try{return tV.default.IPFS.matches(r)}catch(e){return!1}}function rV({repo:r}){async function e(t,i={}){if(!x6(t))throw new Error(`${t} is not a valid Multiaddr`);let n=await r.config.getAll(i),s=n.Bootstrap||[];return s.push(t.toString()),n.Bootstrap=Array.from(new Set(s)).sort((o,a)=>o.localeCompare(a)),await r.config.replace(n),{Peers:[t]}}return Q(e)}f();var iV=R(ft());function nV({repo:r}){async function e(t={}){let i=await r.config.getAll(t),n=i.Bootstrap||[];return i.Bootstrap=[],await r.config.replace(i),{Peers:n.map(s=>new iV.Multiaddr(s))}}return Q(e)}f();var sV=R(ft());function oV({repo:r}){async function e(t={}){return{Peers:(await r.config.get("Bootstrap",t)||[]).map(n=>new sV.Multiaddr(n))}}return Q(e)}f();f();var tu=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}});var aV=R(ft());function cV({repo:r}){async function e(t={}){let i=await r.config.getAll(t);return i.Bootstrap=tu().Bootstrap,await r.config.replace(i),{Peers:tu().Bootstrap.map(n=>new aV.Multiaddr(n))}}return Q(e)}f();function uV({repo:r}){async function e(t,i={}){if(!x6(t))throw new Error(`${t} is not a valid Multiaddr`);let n=await r.config.getAll(i);return n.Bootstrap=(n.Bootstrap||[]).filter(s=>s.toString()!==t.toString()),await r.config.replace(n),{Peers:[t]}}return Q(e)}var J9=class{constructor({repo:e}){this.add=rV({repo:e}),this.list=oV({repo:e}),this.rm=uV({repo:e}),this.clear=nV({repo:e}),this.reset=cV({repo:e})}};f();f();function lV({preload:r,repo:e}){async function t(i,n={}){return n.preload!==!1&&r(i),e.blocks.get(i,n)}return Q(t)}f();we();function fV({codecs:r,hashers:e,repo:t,preload:i}){async function n(s,o={}){let a=o.pin?await t.gcLock.readLock():null;try{let c=o.version!=null?o.version:0,u=o.format||(c===0?"dag-pb":"raw"),d=await(await e.getHasher(o.mhtype||"sha2-256")).digest(s),h=await r.getCodec(u),p=L.create(c,h.code,d);return await t.blocks.put(p,s,{signal:o.signal}),o.preload!==!1&&i(p),o.pin===!0&&await t.pins.pinRecursively(p,{signal:o.signal}),p}finally{a&&a()}}return Q(n)}f();var RV=R(St()),AV=R(C6()),xV=R(bn()),IV=R(rs()),TV=R(dr());f();we();function O6(r){return r instanceof Uint8Array?L.decode(r):L.parse(r.toString())}var wRe=8;function PV({repo:r}){async function*e(t,i={}){Array.isArray(t)||(t=[t]);let n=await r.gcLock.writeLock();try{yield*(0,TV.pipe)(t,s=>(0,xV.default)(s,o=>async()=>{o=O6(o);let a={cid:o};try{if(!await r.blocks.has(o))throw(0,RV.default)(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await r.blocks.delete(o)}catch(c){i.force||(c.message=`cannot remove ${o}: ${c.message}`,a.error=c)}return a}),s=>(0,AV.default)(s,{concurrency:wRe}),s=>(0,IV.default)(s,()=>!i.quiet))}finally{n()}}return Q(e)}f();function CV({repo:r,preload:e}){async function t(i,n={}){i=O6(i),n.preload!==!1&&e(i);let s=await r.blocks.get(i);return{cid:i,size:s.length}}return Q(t)}var tS=class{constructor({codecs:e,hashers:t,preload:i,repo:n}){this.get=lV({preload:i,repo:n}),this.put=fV({codecs:e,hashers:t,preload:i,repo:n}),this.rm=PV({repo:n}),this.stat=CV({preload:i,repo:n})}};f();f();var HV=R(Qn());f();f();var LV=R(Kf());ct();var MV=R(e0()),jV=R(NV()),qV=R(t0()),UV=R(Zo()),FV=R(bn());f();function so(r){return ArrayBuffer.isView(r)||r instanceof ArrayBuffer}function ru(r){return r.constructor&&(r.constructor.name==="Blob"||r.constructor.name==="File")&&typeof r.stream=="function"}function D2(r){return typeof r=="object"&&(r.path||r.content)}var iu=r=>r&&typeof r.getReader=="function";async function*k6(r){yield r}async function D6(r){if(so(r))return k6(rS(r));if(typeof r=="string"||r instanceof String)return k6(rS(r.toString()));if(ru(r))return(0,jV.default)(r);if(iu(r)&&(r=(0,MV.default)(r)),Symbol.iterator in r||Symbol.asyncIterator in r){let e=(0,qV.default)(r),{value:t,done:i}=await e.peek();if(i)return k6(new Uint8Array(0));if(e.push(t),Number.isInteger(t))return k6(Uint8Array.from(await(0,UV.default)(e)));if(so(t)||typeof t=="string"||t instanceof String)return(0,FV.default)(e,rS)}throw(0,LV.default)(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT")}function rS(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r instanceof ArrayBuffer?new Uint8Array(r):Array.isArray(r)?Uint8Array.from(r):Qe(r.toString())}f();var N6=R(Kf()),KV=R(e0()),VV=R(t0());async function*zV(r,e){if(r==null)throw(0,N6.default)(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT");if(typeof r=="string"||r instanceof String){yield B6(r.toString(),e);return}if(so(r)||ru(r)){yield B6(r,e);return}if(iu(r)&&(r=(0,KV.default)(r)),Symbol.iterator in r||Symbol.asyncIterator in r){let t=(0,VV.default)(r),{value:i,done:n}=await t.peek();if(n){yield{content:[]};return}if(t.push(i),Number.isInteger(i)||so(i)||typeof i=="string"||i instanceof String){yield B6(t,e);return}throw(0,N6.default)(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(D2(r)){yield B6(r,e);return}throw(0,N6.default)(new Error('Unexpected input: cannot convert "'+typeof r+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function B6(r,e){let{path:t,mode:i,mtime:n,content:s}=r,o={path:t||"",mode:qc(i),mtime:zu(n)};return s?o.content=await e(s):t||(o.content=await e(r)),o}function L6(r){return zV(r,D6)}function $V({addAll:r}){async function e(t,i={}){let n=await(0,HV.default)(r(L6(t),i));if(n==null)throw Error("Failed to add a file, if you see this please report a bug");return n}return e}f();f();var lH=R(j6());f();vi();f();q3();rp();var iS=R(QV());function xRe(r){let e=new Array(4);for(let t=0;t<4;t++)e[t]=r&255,r=r>>8;return new Uint8Array(e)}var Elt=tp({name:"murmur3-32",code:35,encode:r=>xRe(iS.default.x86.hash32(r))}),dd=tp({name:"murmur3-128",code:34,encode:r=>$h.fromHex(iS.default.x64.hash128(r))});async function IRe(r){return(await dd.encode(r)).slice(0,8).reverse()}var TRe={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:Lr,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:17437180132763652,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:IRe,hamtHashCode:34,hamtBucketBits:8},ZV=(r={})=>Pt.bind({ignoreUndefined:!0})(TRe,r);f();f();f();we();vi();var PRe=async(r,e,t)=>{t.codec||(t.codec=In),t.hasher||(t.hasher=Lr),t.cidVersion===void 0&&(t.cidVersion=1),t.codec===In&&t.hasher!==Lr&&(t.cidVersion=1);let i=await t.hasher.digest(r),n=L.create(t.cidVersion,t.codec.code,i);return t.onlyHash||await e.put(n,r,{signal:t.signal}),n},Jo=PRe;var CRe=async(r,e,t)=>{let i=new ht({type:"directory",mtime:r.mtime,mode:r.mode}),n=lt(zi({Data:i.marshal()})),s=await Jo(n,e,t),o=r.path;return{cid:s,path:o,unixfs:i,size:n.length}},JV=CRe;f();var fz=R(B2());var dz=R(j6());Vs();f();var rz=R(Zo());async function kRe(r,e){return e(await(0,rz.default)(r))}var iz=kRe;f();var nz=R(M6());function DRe(r,e,t){return sz(r,e,t)}async function sz(r,e,t){let i=[];for await(let n of(0,nz.default)(r,t.maxChildrenPerNode))i.push(await e(n));return i.length>1?sz(i,e,t):i[0]}var oz=DRe;f();var az=R(M6());async function NRe(r,e,t){let i=new uz(t.layerRepeat),n=0,s=1,o=i;for await(let a of(0,az.default)(r,t.maxChildrenPerNode))o.isFull()&&(o!==i&&i.addChild(await o.reduce(e)),n&&n%t.layerRepeat==0&&s++,o=new nS(s,t.layerRepeat,n),n++),o.append(a);return o&&o!==i&&i.addChild(await o.reduce(e)),i.reduce(e)}var cz=NRe,nS=class{constructor(e,t,i=0){this.maxDepth=e,this.layerRepeat=t,this.currentDepth=1,this.iteration=i,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;let e=this._findParent(this.node,this.currentDepth);return e?(this._addNextNodeToParent(e),!1):!0}_addNextNodeToParent(e){this.parent=e;let t={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(t),this.currentDepth=t.depth,this.node=t}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,t){let i=[];return e.children.length&&(i=await Promise.all(e.children.filter(n=>n.data).map(n=>this._reduce(n,t)))),t((e.data||[]).concat(i))}_findParent(e,t){let i=e.parent;if(!(!i||i.depth===0))return i.children.length===i.maxChildren||!i.maxChildren?this._findParent(i,t):i}},uz=class extends nS{constructor(e){super(0,e);this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}};f();Vs();async function*BRe(r,e,t){for await(let i of r.content)yield async()=>{t.progress(i.length,r.path);let n,s={codec:In,cidVersion:t.cidVersion,hasher:t.hasher,onlyHash:t.onlyHash};return t.rawLeaves?(s.codec=Ty,s.cidVersion=1):(n=new ht({type:t.leafType,data:i,mtime:r.mtime,mode:r.mode}),i=lt({Data:n.marshal(),Links:[]})),{cid:await Jo(i,e,s),unixfs:n,size:i.length}}}var lz=BRe;var LRe={flat:iz,balanced:oz,trickle:cz};async function*MRe(r,e,t){let i=-1,n,s;typeof t.bufferImporter=="function"?s=t.bufferImporter:s=lz;for await(let o of(0,dz.default)(s(r,e,t),t.blockWriteConcurrency)){if(i++,i===0){n=o;continue}else i===1&&n&&(yield n,n=null);yield o}n&&(n.single=!0,yield n)}var jRe=(r,e,t)=>{async function i(n){if(n.length===1&&n[0].single&&t.reduceSingleLeafToSelf){let l=n[0];if(l.cid.code===Di&&(r.mtime!==void 0||r.mode!==void 0)){let d=await e.get(l.cid);l.unixfs=new ht({type:"file",mtime:r.mtime,mode:r.mode,data:d}),d=lt(zi({Data:l.unixfs.marshal()})),l.cid=await Jo(d,e,{...t,codec:In,hasher:t.hasher,cidVersion:t.cidVersion}),l.size=d.length}return{cid:l.cid,path:r.path,unixfs:l.unixfs,size:l.size}}let s=new ht({type:"file",mtime:r.mtime,mode:r.mode}),o=n.filter(l=>l.cid.code===Di&&l.size||l.unixfs&&!l.unixfs.data&&l.unixfs.fileSize()?!0:Boolean(l.unixfs&&l.unixfs.data&&l.unixfs.data.length)).map(l=>l.cid.code===Di?(s.addBlockSize(l.size),{Name:"",Tsize:l.size,Hash:l.cid}):(!l.unixfs||!l.unixfs.data?s.addBlockSize(l.unixfs&&l.unixfs.fileSize()||0):s.addBlockSize(l.unixfs.data.length),{Name:"",Tsize:l.size,Hash:l.cid})),a={Data:s.marshal(),Links:o},c=lt(zi(a));return{cid:await Jo(c,e,t),path:r.path,unixfs:s,size:c.length+a.Links.reduce((l,d)=>l+d.Tsize,0)}}return i};function qRe(r,e,t){let i=LRe[t.strategy];if(!i)throw(0,fz.default)(new Error(`Unknown importer build strategy name: ${t.strategy}`),"ERR_BAD_STRATEGY");return i(MRe(r,e,t),jRe(r,e,t),t)}var hz=qRe;var dS=R(B2());f();var Mz=R(sn()),jz=R(Lz()),lS=R(B2());async function*QRe(r,e){let t,i,n;if(e.minChunkSize&&e.maxChunkSize&&e.avgChunkSize)n=e.avgChunkSize,t=e.minChunkSize,i=e.maxChunkSize;else if(e.avgChunkSize)n=e.avgChunkSize,t=n/3,i=n+n/2;else throw(0,lS.default)(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");if(t<16)throw(0,lS.default)(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");i<t&&(i=t),n<t&&(n=t);let s=Math.floor(Math.log2(n));for await(let o of ZRe(r,{min:t,max:i,bits:s,window:e.window,polynomial:e.polynomial}))yield o}var qz=QRe;async function*ZRe(r,e){let t=await(0,jz.create)(e.bits,e.min,e.max,e.window),i=new Mz.default;for await(let n of r){i.append(n);let s=t.fingerprint(n);for(let o=0;o<s.length;o++){let a=s[o],c=i.slice(0,a);i.consume(a),yield c}}i.length&&(yield i.slice(0))}f();var K6=R(sn());async function*JRe(r,e){let t=new K6.default,i=0,n=!1,s=e.maxChunkSize;for await(let o of r)for(t.append(o),i+=o.length;i>=s;)if(yield t.slice(0,s),n=!0,s===t.length)t=new K6.default,i=0;else{let a=new K6.default;a.append(t.shallowSlice(s)),t=a,i-=s}(!n||i)&&(yield t.slice(0,i))}var Uz=JRe;f();var fS=R(B2());ct();async function*eAe(r){for await(let e of r){if(e.length===void 0)throw(0,fS.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof e=="string"||e instanceof String)yield Qe(e.toString());else if(Array.isArray(e))yield Uint8Array.from(e);else if(e instanceof Uint8Array)yield e;else throw(0,fS.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}}var Fz=eAe;function tAe(r){return Symbol.iterator in r}function rAe(r){return Symbol.asyncIterator in r}function iAe(r){try{if(r instanceof Uint8Array)return async function*(){yield r}();if(tAe(r))return async function*(){yield*r}();if(rAe(r))return r}catch{throw(0,dS.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw(0,dS.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*nAe(r,e,t){for await(let i of r)if(i.path&&(i.path.substring(0,2)==="./"&&(t.wrapWithDirectory=!0),i.path=i.path.split("/").filter(n=>n&&n!==".").join("/")),i.content){let n;typeof t.chunker=="function"?n=t.chunker:t.chunker==="rabin"?n=qz:n=Uz;let s;typeof t.chunkValidator=="function"?s=t.chunkValidator:s=Fz;let o={path:i.path,mtime:i.mtime,mode:i.mode,content:n(s(iAe(i.content),t),t)};yield()=>hz(o,e,t)}else if(i.path){let n={path:i.path,mtime:i.mtime,mode:i.mode};yield()=>JV(n,e,t)}else throw new Error("Import candidate must have content or path or both")}var Kz=nAe;f();f();f();var Vz=class{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}},Rl=Vz;var zz=class extends Rl{constructor(e,t){super(e,t);this._children={}}async put(e,t){this.cid=void 0,this.size=void 0,this._children[e]=t}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){let e=Object.keys(this._children);for(let t=0;t<e.length;t++){let i=e[t];yield{key:i,child:this._children[i]}}}async*flush(e){let t=Object.keys(this._children),i=[];for(let u=0;u<t.length;u++){let l=this._children[t[u]];if(l instanceof Rl)for await(let d of l.flush(e))l=d,yield l;l.size!=null&&l.cid&&i.push({Name:t[u],Tsize:l.size,Hash:l.cid})}let n=new ht({type:"directory",mtime:this.mtime,mode:this.mode}),s={Data:n.marshal(),Links:i},o=lt(zi(s)),a=await Jo(o,e,this.options),c=o.length+s.Links.reduce((u,l)=>u+(l.Tsize==null?0:l.Tsize),0);this.cid=a,this.size=c,yield{cid:a,unixfs:n,path:this.path,size:c}}},q2=zz;f();f();var H6=R(U2()),rH=class extends Rl{constructor(e,t){super(e,t);this._bucket=(0,H6.createHAMT)({hashFn:t.hamtHashFn,bits:t.hamtBucketBits})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){for await(let t of nH(this._bucket,e,this,this.options))yield{...t,path:this.path}}},iH=rH;async function*nH(r,e,t,i){let n=r._children,s=[],o=0;for(let p=0;p<n.length;p++){let y=n.get(p);if(!y)continue;let g=p.toString(16).toUpperCase().padStart(2,"0");if(y instanceof H6.Bucket){let w;for await(let b of await nH(y,e,null,i))w=b;if(!w)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:g,Tsize:w.size,Hash:w.cid}),o+=w.size}else if(typeof y.value.flush=="function"){let w=y.value,b;for await(let A of w.flush(e))b=A,yield b;let v=g+y.key;s.push({Name:v,Tsize:b.size,Hash:b.cid}),o+=b.size}else{let w=y.value;if(!w.cid)continue;let b=g+y.key,v=w.size;s.push({Name:b,Tsize:v,Hash:w.cid}),o+=v}}let a=Uint8Array.from(n.bitField().reverse()),c=new ht({type:"hamt-sharded-directory",data:a,fanout:r.tableSize(),hashType:i.hamtHashCode,mtime:t&&t.mtime,mode:t&&t.mode}),u={Data:c.marshal(),Links:s},l=lt(zi(u)),d=await Jo(l,e,i),h=l.length+o;yield{cid:d,unixfs:c,size:h}}async function sH(r,e,t,i){let n=e;e instanceof q2&&e.directChildrenCount()>=t&&(n=await EAe(e,i));let s=n.parent;if(s){if(n!==e){if(r&&(r.parent=n),!n.parentKey)throw new Error("No parent key found");await s.put(n.parentKey,n)}return sH(n,s,t,i)}return n}async function EAe(r,e){let t=new iH({root:r.root,dir:!0,parent:r.parent,parentKey:r.parentKey,path:r.path,dirty:r.dirty,flat:!1,mtime:r.mtime,mode:r.mode},e);for await(let{key:i,child:n}of r.eachChildSeries())await t.put(i,n);return t}var oH=sH;f();var SAe=(r="")=>(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),aH=SAe;async function RAe(r,e,t){let i=aH(r.path||""),n=i.length-1,s=e,o="";for(let a=0;a<i.length;a++){let c=i[a];o+=`${o?"/":""}${c}`;let u=a===n;if(s.dirty=!0,s.cid=void 0,s.size=void 0,u)await s.put(c,r),e=await oH(null,s,t.shardSplitThreshold,t);else{let l=await s.get(c);(!l||!(l instanceof Rl))&&(l=new q2({root:!1,dir:!0,parent:s,parentKey:c,path:o,dirty:!0,flat:!0,mtime:l&&l.unixfs&&l.unixfs.mtime,mode:l&&l.unixfs&&l.unixfs.mode},t)),await s.put(c,l),s=l}}return e}async function*cH(r,e){if(!(r instanceof Rl)){r&&r.unixfs&&r.unixfs.isDirectory()&&(yield r);return}yield*r.flush(e)}async function*AAe(r,e,t){let i=new q2({root:!0,dir:!0,path:"",dirty:!0,flat:!0},t);for await(let n of r)!n||(i=await RAe(n,i,t),(!n.unixfs||!n.unixfs.isDirectory())&&(yield n));if(t.wrapWithDirectory)yield*cH(i,e);else for await(let n of i.eachChildSeries())!n||(yield*cH(n.child,e))}var uH=AAe;async function*r0(r,e,t={}){let i=ZV(t),n;typeof t.dagBuilder=="function"?n=t.dagBuilder:n=Kz;let s;typeof t.treeBuilder=="function"?s=t.treeBuilder:s=uH;let o;Symbol.asyncIterator in r||Symbol.iterator in r?o=r:o=[r];for await(let a of s((0,lH.default)(n(o,e,i),i.fileImportConcurrency),e,i))yield{cid:a.cid,path:a.path,unixfs:a.unixfs,size:a.size}}f();f();var F2=R(Kf()),fH=R(e0()),dH=R(t0()),pS=R(bn());async function*$6(r,e){if(typeof r=="string"||r instanceof String||so(r)||ru(r)||r._readableState)throw(0,F2.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(iu(r)&&(r=(0,fH.default)(r)),Symbol.iterator in r||Symbol.asyncIterator in r){let t=(0,dH.default)(r),{value:i,done:n}=await t.peek();if(n){yield*[];return}if(t.push(i),Number.isInteger(i))throw(0,F2.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(i._readableState){yield*(0,pS.default)(t,s=>yS({content:s},e));return}if(so(i)){yield yS({content:t},e);return}if(D2(i)||i[Symbol.iterator]||i[Symbol.asyncIterator]||iu(i)||ru(i)){yield*(0,pS.default)(t,s=>yS(s,e));return}}throw D2(r)?(0,F2.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):(0,F2.default)(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}async function yS(r,e){let{path:t,mode:i,mtime:n,content:s}=r,o={path:t||"",mode:qc(i),mtime:zu(n)};return s?o.content=await e(s):t||(o.content=await e(r)),o}function hH(r){return $6(r,D6)}f();var pH=r=>{if(r)if(r.startsWith("size-")){let e=r.split("-")[1],t=parseInt(e);if(isNaN(t))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:t}}else{if(r.startsWith("rabin"))return{chunker:"rabin",...xAe(r)};throw new Error(`Unrecognized chunker option: ${r}`)}else return{chunker:"fixed"}},xAe=r=>{let e={},t=r.split("-");switch(t.length){case 1:e.avgChunkSize=262144;break;case 2:e.avgChunkSize=G6(t[1],"avg");break;case 4:e.minChunkSize=G6(t[1],"min"),e.avgChunkSize=G6(t[2],"avg"),e.maxChunkSize=G6(t[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return e},G6=(r,e)=>{let t=parseInt(r);if(isNaN(t))throw new Error(`Chunker parameter ${e} must be an integer`);return t};var yH=R(dr());var IAe=Pt.bind({ignoreUndefined:!0});function gH({repo:r,preload:e,hashers:t,options:i}){let n=i&&i.sharding;async function*s(o,a={}){let c=IAe({shardSplitThreshold:n?1e3:1/0,strategy:"balanced"},a,{...pH(a.chunker)});c.hashAlg&&c.hashAlg!=="sha2-256"&&c.cidVersion!==1&&(c.cidVersion=1),c.trickle&&(c.strategy="trickle"),c.strategy==="trickle"&&(c.leafType="raw",c.reduceSingleLeafToSelf=!1),c.cidVersion>0&&c.rawLeaves===void 0&&(c.rawLeaves=!0),c.hashAlg!==void 0&&c.rawLeaves===void 0&&(c.rawLeaves=!0),delete c.trickle;let u={};if(c.progress){let p=c.progress;c.progress=(y,g)=>{u[g]||(u[g]=0),u[g]+=y,p(u[g],g)}}let l;c.hashAlg!=null&&(l=await t.getHasher(c.hashAlg));let d=(0,yH.pipe)(hH(o),p=>r0(p,r.blocks,{...c,hasher:l,pin:!1}),TAe(c),PAe(e,c),CAe(r,c)),h=await r.gcLock.readLock();try{for await(let p of d)delete u[p.path],yield p}finally{h()}}return Q(s)}function TAe(r){async function*e(t){for await(let i of t){let n=i.cid;r.cidVersion===1&&(n=n.toV1());let s=i.path?i.path:n.toString();r.wrapWithDirectory&&!i.path&&(s=""),yield{path:s,cid:n,size:i.size,mode:i.unixfs&&i.unixfs.mode,mtime:i.unixfs&&i.unixfs.mtime}}}return e}function PAe(r,e){async function*t(i){for await(let n of i)(!n.path||e.wrapWithDirectory?n.path==="":!n.path.includes("/"))&&!e.onlyHash&&e.preload!==!1&&r(n.cid),yield n}return t}function CAe(r,e){async function*t(i){for await(let n of i){let s=!(n.path&&n.path.includes("/"));(e.pin==null?!0:e.pin)&&s&&!e.onlyHash&&await r.pins.pinRecursively(n.cid),yield n}}return t}f();f();var J6=R(nu());we();f();var NH=R(nu());f();Qu();we();var kAe=42;function DAe(r){if(r[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return L.decode(r.subarray(1))}var wH={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};wH.tags[kAe]=DAe;var W6=113;var Y6=r=>wi(r,wH);Vs();zc();f();var Z6=R(nu());f();var X6=R(U2());var NAe=async function(r){return(await dd.encode(r)).slice(0,8).reverse()},BAe=(r,e,t)=>Promise.all(r.map(i=>{if(i.Name==null)throw new Error("Unexpected Link without a Name");if(i.Name.length===2){let n=parseInt(i.Name,16);return e._putObjectAt(n,new X6.Bucket({hash:t._options.hash,bits:t._options.bits},e,n))}return t.put(i.Name.substring(2),!0)})),_H=r=>r.toString(16).toUpperCase().padStart(2,"0").substring(0,2),LAe=r=>{let e=r.bucket,t=[];for(;e._parent;)t.push(e),e=e._parent;return t.push(e),t.reverse()},vH=async(r,e,t,i,n)=>{if(!i){let l=(0,X6.createHAMT)({hashFn:NAe});i={rootBucket:l,hamtDepth:1,lastBucket:l}}await BAe(r.Links,i.lastBucket,i.rootBucket);let s=await i.rootBucket._findNewBucketAndPos(e),o=_H(s.pos),a=LAe(s);a.length>i.hamtDepth&&(i.lastBucket=a[i.hamtDepth],o=_H(i.lastBucket._posAtParent));let c=r.Links.find(l=>{if(l.Name==null)return!1;let d=l.Name.substring(0,2),h=l.Name.substring(2);return!(d!==o||h&&h!==e)});if(!c)return null;if(c.Name!=null&&c.Name.substring(2)===e)return c.Hash;i.hamtDepth++;let u=await t.get(c.Hash,n);return r=Nt(u),vH(r,e,t,i,n)},EH=vH;f();f();function MAe(r,e,t,i){let n=r.length,s=e+n;return t>=s||i<e?new Uint8Array(0):(i>=e&&i<s&&(r=r.slice(0,i-e)),t>=e&&t<s&&(r=r.slice(t-e)),r)}var hd=MAe;f();var Q6=R(nu()),jAe=(r,e,t)=>{if(e||(e=0),e<0)throw(0,Q6.default)(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(e>r)throw(0,Q6.default)(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(!t&&t!==0&&(t=r-e),t<0)throw(0,Q6.default)(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return e+t>r&&(t=r-e),{offset:e,length:t}},i0=jAe;var gS=R(nu());Vs();async function*SH(r,e,t,i,n=0,s){if(e instanceof Uint8Array){let c=hd(e,n,t,i);return c.length&&(yield c),n+=c.length,n}if(e.Data==null)throw(0,gS.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let o;try{o=ht.unmarshal(e.Data)}catch(c){throw(0,gS.default)(c,"ERR_NOT_UNIXFS")}if(o.data&&o.data.length){let c=hd(o.data,n,t,i);c.length&&(yield c),n+=o.data.length}let a=n;for(let c=0;c<e.Links.length;c++){let u=e.Links[c],l=n+o.blockSizes[c];if(t>=a&&t<l||i>a&&i<=l||t<a&&i>l){let d=await r.get(u.Hash,{signal:s.signal}),h;switch(u.Hash.code){case wt:h=await Nt(d);break;case Di:h=d;break;case W6:h=await Y6(d);break;default:throw Error(`Unsupported codec: ${u.Hash.code}`)}for await(let p of SH(r,h,t,i,n,s))n+=p.length,yield p}n=l,a=l+1}}var qAe=(r,e,t,i,n,s,o)=>{function a(c={}){let u=t.fileSize();if(u===void 0)throw new Error("File was a directory");let{offset:l,length:d}=i0(u,c.offset,c.length),h=l,p=l+d;return SH(o,e,h,p,0,c)}return a},mS=qAe;f();var UAe=(r,e,t,i,n,s,o)=>{async function*a(c={}){let u=c.offset||0,l=c.length||e.Links.length,d=e.Links.slice(u,l);for(let h of d){let p=await n(h.Hash,h.Name||"",`${i}/${h.Name||""}`,[],s+1,o,c);p.entry&&(yield p.entry)}}return a},RH=UAe;f();var FAe=(r,e,t,i,n,s,o)=>{function a(c={}){return AH(e,i,n,s,o,c)}return a};async function*AH(r,e,t,i,n,s){let o=r.Links;for(let a of o){let c=a.Name!=null?a.Name.substring(2):null;if(c)yield(await t(a.Hash,c,`${e}/${c}`,[],i+1,n,s)).entry;else{let u=await n.get(a.Hash);r=Nt(u);for await(let l of AH(r,e,t,i,n,s))yield l}}}var xH=FAe;var KAe=(r,e)=>{let t=r.Links.find(i=>i.Name===e);return t&&t.Hash},VAe={raw:mS,file:mS,directory:RH,"hamt-sharded-directory":xH,metadata:(r,e,t,i,n,s,o)=>()=>[],symlink:(r,e,t,i,n,s,o)=>()=>[]},zAe=async(r,e,t,i,n,s,o,a)=>{let c=await o.get(r,a),u=Nt(c),l,d;if(e||(e=r.toString()),u.Data==null)throw(0,Z6.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{l=ht.unmarshal(u.Data)}catch(h){throw(0,Z6.default)(h,"ERR_NOT_UNIXFS")}if(t||(t=e),i.length){let h;if(l&&l.type==="hamt-sharded-directory"?h=await EH(u,i[0],o):h=KAe(u,i[0]),!h)throw(0,Z6.default)(new Error("file does not exist"),"ERR_NOT_FOUND");let p=i.shift(),y=`${t}/${p}`;d={cid:h,toResolve:i,name:p||"",path:y}}return{entry:{type:l.isDirectory()?"directory":"file",name:e,path:t,cid:r,content:VAe[l.type](r,u,l,t,n,s,o),unixfs:l,depth:s,node:u,size:l.fileSize()},next:d}},IH=zAe;f();var TH=R(nu());var HAe=r=>{async function*e(t={}){let{offset:i,length:n}=i0(r.length,t.offset,t.length);yield hd(r,0,i,i+n)}return e},$Ae=async(r,e,t,i,n,s,o,a)=>{if(i.length)throw(0,TH.default)(new Error(`No link named ${t} found in raw node ${r}`),"ERR_NOT_FOUND");let c=await o.get(r,a);return{entry:{type:"raw",name:e,path:t,cid:r,content:HAe(c),depth:s,size:c.length,node:c}}},PH=$Ae;f();we();var CH=R(nu());var GAe=async(r,e,t,i,n,s,o,a)=>{let c=await o.get(r),u=Y6(c),l=u,d=t;for(;i.length;){let h=i[0];if(h in l){i.shift(),d=`${d}/${h}`;let p=L.asCID(l[h]);if(p)return{entry:{type:"object",name:e,path:t,cid:r,node:c,depth:s,size:c.length,content:async function*(){yield u}},next:{cid:p,name:h,path:d,toResolve:i}};l=l[h]}else throw(0,CH.default)(new Error(`No property named ${h} found in cbor node ${r}`),"ERR_NO_PROP")}return{entry:{type:"object",name:e,path:t,cid:r,node:c,depth:s,size:c.length,content:async function*(){yield u}}}},OH=GAe;f();var kH=R(nu());Ji();var WAe=r=>{async function*e(t={}){let{offset:i,length:n}=i0(r.length,t.offset,t.length);yield hd(r,0,i,i+n)}return e},YAe=async(r,e,t,i,n,s,o,a)=>{if(i.length)throw(0,kH.default)(new Error(`No link named ${t} found in raw node ${r}`),"ERR_NOT_FOUND");let c=await fi(r.multihash.bytes);return{entry:{type:"identity",name:e,path:t,cid:r,content:WAe(c.digest),depth:s,size:c.digest.length,node:c.digest}}},DH=YAe;var XAe={[wt]:IH,[Di]:PH,[W6]:OH,[ws.code]:DH};function BH(r,e,t,i,n,s,o){let a=XAe[r.code];if(!a)throw(0,NH.default)(new Error(`No resolver for code ${r.code}`),"ERR_NO_RESOLVER");return a(r,e,t,i,BH,n,s,o)}var LH=BH;var MH=R(Qn()),QAe=(r="")=>(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),ZAe=r=>{if(r instanceof Uint8Array)return{cid:L.decode(r),toResolve:[]};let e=L.asCID(r);if(e)return{cid:e,toResolve:[]};if(typeof r=="string"){r.indexOf("/ipfs/")===0&&(r=r.substring(6));let t=QAe(r);return{cid:L.parse(t[0]),toResolve:t.slice(1)}}throw(0,J6.default)(new Error(`Unknown path type ${r}`),"ERR_BAD_PATH")};async function*bS(r,e,t={}){let{cid:i,toResolve:n}=ZAe(r),s=i.toString(),o=s,a=n.length;for(;;){let c=await LH(i,s,o,n,a,e,t);if(!c.entry&&!c.next)throw(0,J6.default)(new Error(`Could not resolve ${r}`),"ERR_NOT_FOUND");if(c.entry&&(yield c.entry),!c.next)return;n=c.next.toResolve,i=c.next.cid,s=c.next.name,o=c.next.path}}async function on(r,e,t={}){let i=await(0,MH.default)(bS(r,e,t));if(!i)throw(0,J6.default)(new Error(`Could not resolve ${r}`),"ERR_NOT_FOUND");return i}async function*eb(r,e,t={}){let i=await on(r,e,t);if(!i)return;if(yield i,i.type==="directory")for await(let s of n(i,t))yield s;async function*n(s,o){for await(let a of s.content(o))yield a,!(a instanceof Uint8Array)&&a.type==="directory"&&(yield*n(a,o))}}we();function jH({repo:r,preload:e}){async function*t(i,n={}){if(i=bp(i),n.preload!==!1){let o=i.split("/");e(L.parse(o[0]))}let s=await on(i,r.blocks,n);if(s.type==="directory")throw new Error("this dag node is a directory");if(!s.content)throw new Error("this dag node has no content");yield*s.content(n)}return Q(t)}f();var g0=R(St());we();var uR=R(t$()),lR=R(dr()),fR=R(KG()),dR=R(bn()),hR=R(zG()),HG=6;function $G({repo:r,preload:e}){async function*t(i,n={}){if(n.compressionLevel!=null&&(n.compressionLevel<-1||n.compressionLevel>9))throw(0,g0.default)(new Error("Compression level must be between -1 and 9"),"ERR_INVALID_PARAMS");if(n.preload!==!1){let a;try{a=bp(i).split("/")}catch(c){throw(0,g0.default)(c,"ERR_INVALID_PATH")}e(L.parse(a[0]))}let s=L.asCID(i)||i,o=await on(s,r.blocks,n);if(o.type==="file"||o.type==="raw"){let a=[];!n.compress||n.archive===!0?a.push([{header:{name:o.path,mode:o.type==="file"&&o.unixfs.mode,mtime:o.type==="file"&&o.unixfs.mtime?new Date(o.unixfs.mtime.secs*1e3):void 0,size:o.size,type:"file"},body:o.content()}],(0,uR.pack)(),c=>(0,dR.default)(c,u=>u.slice())):a.push(o.content),n.compress&&a.push(async function*(c){let u=await(0,hR.default)(c);yield fR.default.gzip(u,{level:n.compressionLevel||HG})}),yield*(0,lR.pipe)(...a);return}if(o.type==="directory"){let a=[eb(s,r.blocks,n),async function*(c){for await(let u of c){let l={header:{name:u.path,size:u.size}};if(u.type==="file")l.header.type="file",l.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,l.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0,l.body=u.content();else if(u.type==="raw")l.header.type="file",l.body=u.content();else if(u.type==="directory")l.header.type="directory",l.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,l.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0;else throw(0,g0.default)(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");yield l}},(0,uR.pack)(),c=>(0,dR.default)(c,u=>u.slice())];if(n.compress){if(!n.archive)throw(0,g0.default)(new Error("file is not regular"),"ERR_INVALID_PATH");n.compress&&a.push(async function*(c){let u=await(0,hR.default)(c);yield fR.default.gzip(u,{level:n.compressionLevel||HG})})}yield*(0,lR.pipe)(...a);return}throw(0,g0.default)(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS")}return Q(t)}f();var GG=R(St());we();function WG({repo:r,preload:e}){async function*t(i,n={}){let s=bp(i),o=s.split("/");n.preload!==!1&&e(L.parse(o[0]));let a=L.asCID(s)||s,c=await on(a,r.blocks,n);if(c.type==="file"){yield P7(c);return}if(c.type==="directory"){for await(let u of c.content())yield P7(u);return}throw(0,GG.default)(new Error(`Unknown UnixFS type ${c.type}`),"ERR_UNKNOWN_UNIXFS_TYPE")}return Q(t)}var pR=class{constructor({preload:e,repo:t,hashers:i,options:n}){let s=gH({preload:e,repo:t,options:n,hashers:i});this.addAll=s,this.add=$V({addAll:s}),this.cat=jH({repo:t,preload:e}),this.get=$G({repo:t,preload:e}),this.ls=WG({repo:t,preload:e})}};f();f();var Sd="0.14.3",YG="",XG="^0.154.3";function QG({repo:r}){async function e(t={}){let i=await r.version.get();return{version:Sd,commit:YG,repo:`${i}`,"ipfs-core":Sd,"interface-ipfs-core":XG}}return Q(e)}f();var ZG=R(ft());tt();var JG=R(ot());var eW=R(St()),yR=R(le()),TTe=Object.assign((0,yR.default)("ipfs:components:id"),{error:(0,yR.default)("ipfs:components:id:error")});function tW({peerId:r,network:e}){async function t(i={}){let n=e.try();if(!n){if(i.peerId)throw new el;return{id:r.toB58String(),publicKey:$e(r.pubKey.bytes,"base64pad"),addresses:[],agentVersion:`js-ipfs/${Sd}`,protocolVersion:"9000",protocols:[]}}let{libp2p:s}=n,o=i.peerId?JG.default.parse(i.peerId):r,a=await PTe(o,s,i),c=$e(a.metadata.get("AgentVersion")||new Uint8Array),u=$e(a.metadata.get("ProtocolVersion")||new Uint8Array),l=a.id.toB58String(),d=a.publicKey?$e(a.publicKey.bytes,"base64pad"):"";return{id:l,publicKey:d,addresses:(a.addresses||[]).map(h=>{let p=h.toString();return p.endsWith(`/p2p/${l}`)?p:`${p}/p2p/${l}`}).sort().map(h=>new ZG.Multiaddr(h)),agentVersion:c,protocolVersion:u,protocols:(a.protocols||[]).sort()}}return Q(t)}async function PTe(r,e,t){let i=await e.peerStore.get(r);i||(i=await CTe(r,e,t));let n=r.pubKey?r.pubKey:await e.peerStore.keyBook.get(r);if(!n)try{n=await e._dht.getPublicKey(r,t)}catch(s){TTe.error("Could not load public key for",r.toB58String(),s)}return{...i,publicKey:n,metadata:i.metadata||new Map,addresses:i.addresses.map(s=>s.multiaddr)}}async function CTe(r,e,t){for await(let n of e._dht.findPeer(r,t))if(n.name==="FINAL_PEER")break;let i=await e.peerStore.get(r);if(!i)throw(0,eW.default)(new Error("Could not find peer"),"ERR_NOT_FOUND");return i}f();var nW=R(le());f();var Zr=R(gR());var m0={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:r=>((0,Zr.default)(r,"Discovery.MDNS.Enabled",!1),(0,Zr.default)(r,"Discovery.webRTCStar.Enabled",!1),r.Swarm={...r.Swarm||{},DisableNatPortMap:!0},r)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:r=>((0,Zr.default)(r,"Discovery.MDNS.Enabled",!0),(0,Zr.default)(r,"Discovery.webRTCStar.Enabled",!0),(0,Zr.default)(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!1}),r)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:r=>{let e=tu();return(0,Zr.default)(r,"Addresses.API",e.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),(0,Zr.default)(r,"Addresses.Gateway",e.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),(0,Zr.default)(r,"Addresses.Swarm",e.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),(0,Zr.default)(r,"Addresses.Delegates",[]),(0,Zr.default)(r,"Bootstrap",[]),(0,Zr.default)(r,"Discovery.MDNS.Enabled",!1),(0,Zr.default)(r,"Discovery.webRTCStar.Enabled",!1),(0,Zr.default)(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!0}),r}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:r=>{let e=tu();return(0,Zr.default)(r,"Addresses.API",e.Addresses.API),(0,Zr.default)(r,"Addresses.Gateway",e.Addresses.Gateway),(0,Zr.default)(r,"Addresses.Swarm",e.Addresses.Swarm),(0,Zr.default)(r,"Addresses.Delegates",e.Addresses.Delegates),(0,Zr.default)(r,"Bootstrap",e.Bootstrap),(0,Zr.default)(r,"Discovery.MDNS.Enabled",e.Discovery.MDNS.Enabled),(0,Zr.default)(r,"Discovery.webRTCStar.Enabled",e.Discovery.webRTCStar.Enabled),(0,Zr.default)(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!1}),r}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:r=>{let e=r.Swarm||{},t=e.ConnMgr||{};return t.LowWater=20,t.HighWater=40,e.ConnMgr=t,r.Swarm=e,r}},"default-power":{description:'Inverse of "lowpower" profile.',transform:r=>{let e=tu();return r.Swarm=e.Swarm,r}}};var kTe=(0,nW.default)("ipfs:core:config");function sW({repo:r}){return{getAll:Q(e),get:Q(t),set:Q(i),replace:Q(n),profiles:{apply:Q(s),list:Q(DTe)}};async function e(o={}){return r.config.getAll(o)}async function t(o,a){return o?r.config.get(o,a):Promise.reject(new Error("key argument is required"))}async function i(o,a,c){return r.config.set(o,a,c)}async function n(o,a){return r.config.replace(o,a)}async function s(o,a={dryRun:!1}){let{dryRun:c}=a,u=m0[o];if(!u)throw new Error(`No profile with name '${o}' exists`);try{let l=await r.config.getAll(a),d=JSON.parse(JSON.stringify(l));return d=u.transform(d),c||await r.config.replace(d,a),delete l.Identity.PrivKey,delete d.Identity.PrivKey,{original:l,updated:d}}catch(l){throw kTe(l),new Error(`Could not apply profile '${o}' to config: ${l.message}`)}}}async function DTe(r){return Object.keys(m0).map(e=>({name:e,description:m0[e].description}))}f();f();we();f();rp();var vb=({enumerable:r=!0,configurable:e=!1}={})=>({enumerable:r,configurable:e,writable:!1}),mR=function*(r,e){if(r!=null&&!(r instanceof Uint8Array))for(let[t,i]of Object.entries(r)){let n=[...e,t];if(i!=null&&typeof i=="object")if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s],c=L.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*mR(o,a))}else{let s=L.asCID(i);s?yield[n.join("/"),s]:yield*mR(i,n)}}},bR=function*(r,e){if(r!=null)for(let[t,i]of Object.entries(r)){let n=[...e,t];if(yield n.join("/"),i!=null&&!(i instanceof Uint8Array)&&typeof i=="object"&&!L.asCID(i))if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s];yield a.join("/"),typeof o=="object"&&!L.asCID(o)&&(yield*bR(o,a))}else yield*bR(i,n)}},NTe=(r,e)=>{let t=r;for(let[i,n]of e.entries()){if(t=t[n],t==null)throw new Error(`Object has no property at ${e.slice(0,i+1).map(o=>`[${JSON.stringify(o)}]`).join("")}`);let s=L.asCID(t);if(s)return{value:s,remaining:e.slice(i+1).join("/")}}return{value:t}},oW=class{constructor({cid:e,bytes:t,value:i}){if(!e||!t||typeof i=="undefined")throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=i,this.asBlock=this,Object.defineProperties(this,{cid:vb(),bytes:vb(),value:vb(),asBlock:vb()})}links(){return mR(this.value,[])}tree(){return bR(this.value,[])}get(e="/"){return NTe(this.value,e.split("/").filter(Boolean))}};var b0=({bytes:r,cid:e,value:t,codec:i})=>{let n=t!==void 0?t:i&&i.decode(r);if(n===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new oW({cid:e,bytes:r,value:n})};f();we();f();var wR=R(Wn());function _R(r){let e=kv({version:1,roots:r}),t=wR.default.encode(e.length),i=new Uint8Array(t.length+e.length);return i.set(t,0),i.set(e,t.length),i}function aW(r){return{async setRoots(e){let t=_R(e);await r.write(t)},async writeBlock(e){let{cid:t,bytes:i}=e;await r.write(new Uint8Array(wR.default.encode(t.bytes.length+i.length))),await r.write(t.bytes),i.length&&await r.write(i)},async close(){await r.end()}}}f();function Eb(){}function cW(){let r=[],e=null,t=Eb,i=!1,n=null,s=Eb,o=()=>(e||(e=new Promise(u=>{t=()=>{e=null,t=Eb,u()}})),e),a={write(u){r.push(u);let l=o();return s(),l},async end(){i=!0;let u=o();s(),await u}},c={async next(){let u=r.shift();return u?(r.length===0&&t(),{done:!1,value:u}):i?(t(),{done:!0,value:void 0}):(n||(n=new Promise(l=>{s=()=>(n=null,s=Eb,l(c.next()))})),n)}};return{writer:a,iterator:c}}f();var Nl=R(Wn());we();Ji();f();var Dl={Null:r=>r===null,Int:r=>Number.isInteger(r),Float:r=>typeof r=="number"&&Number.isFinite(r),String:r=>typeof r=="string",Bool:r=>typeof r=="boolean",Bytes:r=>r instanceof Uint8Array,Link:r=>!Dl.Null(r)&&typeof r=="object"&&r.asCID===r,List:r=>Array.isArray(r),Map:r=>!Dl.Null(r)&&typeof r=="object"&&r.asCID!==r&&!Dl.List(r)&&!Dl.Bytes(r)},w0={Int:Dl.Int,"CarHeader > version":r=>w0.Int(r),"CarHeader > roots (anon) > valueType (anon)":Dl.Link,"CarHeader > roots (anon)":r=>Dl.List(r)&&Array.prototype.every.call(r,w0["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":r=>w0["CarHeader > roots (anon)"](r),CarHeader:r=>{let e=r&&Object.keys(r);return Dl.Map(r)&&["version"].every(t=>e.includes(t))&&Object.entries(r).every(([t,i])=>w0["CarHeader > "+t]&&w0["CarHeader > "+t](i))}},uW=w0.CarHeader;var vR={SHA2_256:18,LENGTH:32,DAG_PB:112},lW=16+8+8+8;async function Sb(r){let e=await r.upTo(8);if(!e.length)throw new Error("Unexpected end of data");let t=Nl.default.decode(e);return r.seek(Nl.default.decode.bytes),t}async function BTe(r){let e=await r.exactly(lW),t=new DataView(e.buffer,e.byteOffset,e.byteLength),i=0,n={version:2,characteristics:[t.getBigUint64(i,!0),t.getBigUint64(i+=8,!0)],dataOffset:Number(t.getBigUint64(i+=8,!0)),dataSize:Number(t.getBigUint64(i+=8,!0)),indexOffset:Number(t.getBigUint64(i+=8,!0))};return r.seek(lW),n}async function Rb(r,e){let t=await Sb(r);if(t===0)throw new Error("Invalid CAR header (zero length)");let i=await r.exactly(t);r.seek(t);let n=Dv(i);if(!uW(n))throw new Error("Invalid CAR header format");if(n.version!==1&&n.version!==2||e!==void 0&&n.version!==e)throw new Error(`Invalid CAR version: ${n.version}${e!==void 0?` (expected ${e})`:""}`);let s=Array.isArray(n.roots);if(n.version===1&&!s||n.version===2&&s)throw new Error("Invalid CAR header format");if(n.version===1)return n;let o=await BTe(r);r.seek(o.dataOffset-r.pos);let a=await Rb(r,1);return Object.assign(a,o)}async function LTe(r){let e=await r.upTo(8);Nl.default.decode(e);let t=Nl.default.decode.bytes,i=Nl.default.decode(e.subarray(Nl.default.decode.bytes)),n=Nl.default.decode.bytes,s=t+n+i,o=await r.exactly(s);return r.seek(s),o}async function MTe(r){let e=await r.exactly(2);if(e[0]===vR.SHA2_256&&e[1]===vR.LENGTH){let o=await r.exactly(34);r.seek(34);let a=fi(o);return L.create(0,vR.DAG_PB,a)}let t=await Sb(r);if(t!==1)throw new Error(`Unexpected CID version (${t})`);let i=await Sb(r),n=await LTe(r),s=fi(n);return L.create(t,i,s)}async function fW(r){let e=r.pos,t=await Sb(r);if(t===0)throw new Error("Invalid CAR section (zero length)");t+=r.pos-e;let i=await MTe(r),n=t-Number(r.pos-e);return{cid:i,length:t,blockLength:n}}async function jTe(r){let{cid:e,blockLength:t}=await fW(r),i=await r.exactly(t);return r.seek(t),{bytes:i,cid:e}}async function qTe(r){let e=r.pos,{cid:t,length:i,blockLength:n}=await fW(r),s={cid:t,length:i,blockLength:n,offset:e,blockOffset:r.pos};return r.seek(s.blockLength),s}function dW(r){let e=(async()=>{let t=await Rb(r);if(t.version===2){let i=r.pos-t.dataOffset;r=FTe(r,t.dataSize-i)}return t})();return{header:()=>e,async*blocks(){for(await e;(await r.upTo(8)).length>0;)yield await jTe(r)},async*blocksIndex(){for(await e;(await r.upTo(8)).length>0;)yield await qTe(r)}}}function Ab(r){let e=0;return{async upTo(t){return r.subarray(e,e+Math.min(t,r.length-e))},async exactly(t){if(t>r.length-e)throw new Error("Unexpected end of data");return r.subarray(e,e+t)},seek(t){e+=t},get pos(){return e}}}function UTe(r){let e=0,t=0,i=0,n=new Uint8Array(0),s=async o=>{t=n.length-i;let a=[n.subarray(i)];for(;t<o;){let u=await r();if(u==null)break;t<0?u.length>t&&a.push(u.subarray(-t)):a.push(u),t+=u.length}n=new Uint8Array(a.reduce((u,l)=>u+l.length,0));let c=0;for(let u of a)n.set(u,c),c+=u.length;i=0};return{async upTo(o){return n.length-i<o&&await s(o),n.subarray(i,i+Math.min(n.length-i,o))},async exactly(o){if(n.length-i<o&&await s(o),n.length-i<o)throw new Error("Unexpected end of data");return n.subarray(i,i+o)},seek(o){e+=o,i+=o},get pos(){return e}}}function hW(r){let e=r[Symbol.asyncIterator]();async function t(){let i=await e.next();return i.done?null:i.value}return UTe(t)}function FTe(r,e){let t=0;return{async upTo(i){let n=await r.upTo(i);return n.length+t>e&&(n=n.subarray(0,e-t)),n},async exactly(i){let n=await r.exactly(i);if(n.length+t>e)throw new Error("Unexpected end of data");return n},seek(i){t+=i,r.seek(i)},get pos(){return r.pos}}}var _0=class{constructor(e,t){this._encoder=t,this._mutex=t.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array)||!e.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");let t=L.asCID(e.cid);if(!t)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:t,bytes:e.bytes})),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=KTe(e);let{encoder:t,iterator:i}=pW(),n=new _0(e,t),s=new ER(i);return{writer:n,out:s}}static createAppender(){let{encoder:e,iterator:t}=pW();e.setRoots=()=>Promise.resolve();let i=new _0([],e),n=new ER(t);return{writer:i,out:n}}static async updateRootsInBytes(e,t){let i=Ab(e);await Rb(i);let n=_R(t);if(Number(i.pos)!==n.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${i.pos} bytes, new header is ${n.length} bytes)`);return e.set(n,0),e}},ER=class{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}};function pW(){let r=cW(),{writer:e,iterator:t}=r;return{encoder:aW(e),iterator:t}}function KTe(r){if(r===void 0)return[];if(!Array.isArray(r)){let t=L.asCID(r);if(!t)throw new TypeError("roots must be a single CID or an array of CIDs");return[t]}let e=[];for(let t of r){let i=L.asCID(t);if(!i)throw new TypeError("roots must be a single CID or an array of CIDs");e.push(i)}return e}var yW=R(le());Vs();Zv();f();di();var SR=async({cid:r,load:e,seen:t})=>{t=t||new Set;let i=r.toString(yt);if(t.has(i))return;let n=await e(r);if(t.add(i),n!==null)for(let[,s]of n.links())await SR({cid:s,load:e,seen:t})};var gW=(0,yW.default)("ipfs:components:dag:import"),VTe=[Di,Xv];function mW({repo:r,preload:e,codecs:t}){async function*i(n,s={}){s.preload!==!1&&e(n);let o=L.asCID(n);if(!o)throw new Error(`Unexpected error converting CID type: ${n}`);gW(`Exporting ${o} as car`);let{writer:a,out:c}=await _0.create([o]),u=null;(async()=>{try{let l=zTe(r,a,{signal:s.signal,timeout:s.timeout},t);await SR({cid:o,load:l})}catch(l){u=l}finally{a.close()}})();for await(let l of c){if(u)break;yield l}if(u)throw u}return Q(i)}function zTe(r,e,t,i){return async n=>{let s=await i.getCodec(n.code);if(!s)throw new Error(`Can't decode links in block with codec 0x${n.code.toString(16)} to form complete DAG`);let o=await r.blocks.get(n,t);return gW(`Adding block ${n} to car`),await e.put({cid:n,bytes:o}),VTe.includes(n.code)?null:b0({bytes:o,cid:n,codec:s})}}f();var wW=R(Rd()),_W=R(Qn());var vW=R(St());function EW({codecs:r,repo:e,preload:t}){return Q(async function(s,o={}){if(o.preload!==!1&&t(s),o.path){let d=o.localResolve?await(0,wW.default)(ol(s,o.path,r,e,o)):await(0,_W.default)(ol(s,o.path,r,e,o));if(!d)throw(0,vW.default)(new Error("Not found"),"ERR_NOT_FOUND");return d}let a=await r.getCodec(s.code),c=await e.blocks.get(s,o);return{value:a.decode(c),remainderPath:""}})}f();f();var RR=class{constructor(e,t,i){this._version=e,this._roots=t,this._iterable=i,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}},v0=class extends RR{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){let{version:t,roots:i,iterator:n}=await SW(e);return new v0(t,i,n)}static async fromIterable(e){let{version:t,roots:i,iterator:n}=await RW(e);return new v0(t,i,n)}},xb=class extends RR{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");this._decoded=!0;let e=this._iterable[Symbol.asyncIterator]();return{async next(){let t=await e.next();return t.done?t:{done:!1,value:t.value.cid}}}}static async fromBytes(e){let{version:t,roots:i,iterator:n}=await SW(e);return new xb(t,i,n)}static async fromIterable(e){let{version:t,roots:i,iterator:n}=await RW(e);return new xb(t,i,n)}};async function SW(r){if(!(r instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return AW(Ab(r))}async function RW(r){if(!r||typeof r[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return AW(hW(r))}async function AW(r){let e=dW(r),{version:t,roots:i}=await e.header();return{version:t,roots:i,iterator:e.blocks()}}var xW=R(t0()),IW=R(ts()),TW=R(bn()),PW=R(le()),CW=(0,PW.default)("ipfs:components:dag:import");function OW({repo:r}){async function*e(t,i={}){let n=await r.gcLock.readLock();try{let s={signal:i.signal,timeout:i.timeout},o=(0,xW.default)(t),{value:a,done:c}=await o.peek();if(c)return;a&&o.push(a);let u;a instanceof Uint8Array?u=[o]:u=o;for await(let l of u){let d=await $Te(r,s,l);if(i.pinRoots!==!1)for(let h of d){let p="";try{await r.blocks.has(h)?(CW(`Pinning root ${h}`),await r.pins.pinRecursively(h)):p="blockstore: block not found"}catch(y){p=y.message}yield{root:{cid:h,pinErrorMsg:p}}}}}finally{n()}}return Q(e)}async function $Te(r,e,t){let i=await v0.fromIterable(t),n=await i.getRoots();return await(0,IW.default)(r.blocks.putMany((0,TW.default)(i,({cid:s,bytes:o})=>(CW(`Import block ${s}`),{key:s,value:o})),{signal:e.signal})),n}f();we();function kW({repo:r,codecs:e,hashers:t,preload:i}){async function n(s,o={}){let a=o.pin?await r.gcLock.readLock():null;try{let c=await e.getCodec(o.storeCodec||"dag-cbor");if(!c)throw new Error(`Unknown storeCodec ${o.storeCodec}, please configure additional BlockCodecs for this IPFS instance`);if(o.inputCodec){if(!(s instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");let y=await e.getCodec(o.inputCodec);if(!y)throw new Error(`Unknown inputCodec ${o.inputCodec}, please configure additional BlockCodecs for this IPFS instance`);s=y.decode(s)}let u=o.version!=null?o.version:1,l=await t.getHasher(o.hashAlg||"sha2-256");if(!l)throw new Error(`Unknown hash algorithm ${o.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);let d=c.encode(s),h=await l.digest(d),p=L.create(u,c.code,h);return await r.blocks.put(p,d,{signal:o.signal}),o.pin&&await r.pins.pinRecursively(p),o.preload!==!1&&i(p),p}finally{a&&a()}}return Q(n)}f();function DW({repo:r,codecs:e,preload:t}){async function i(n,s={}){let{cid:o}=$c(n);return s.preload!==!1&&t(o),sl(r,e,n,s)}return Q(i)}var AR=class{constructor({repo:e,codecs:t,hashers:i,preload:n}){this.export=mW({repo:e,preload:n,codecs:t}),this.get=EW({codecs:t,repo:e,preload:n}),this.import=OW({repo:e}),this.resolve=DW({repo:e,codecs:t,preload:n}),this.put=kW({repo:e,codecs:t,hashers:i,preload:n})}};f();var qW=R(Tb()),IR=R(le()),UW=R(LW());f();var MW=R(vp()),xR=R(le()),Pb=R($o()),XTe=Object.assign((0,xR.default)("ipfs:preload"),{error:(0,xR.default)("ipfs:preload:error")}),QTe=Pb.default.default?Pb.default.default:Pb.default,ZTe=new QTe({concurrency:4});function jW(r,e={}){return XTe(r),ZTe.add(async()=>{let i=(await MW.default.post(r,{signal:e.signal})).body.getReader();try{for(;;){let{done:n}=await i.read();if(n)return}}finally{i.releaseLock()}})}var FW=R(wp()),og=Object.assign((0,IR.default)("ipfs:preload"),{error:(0,IR.default)("ipfs:preload:error")});function KW(r={}){if(r.enabled=Boolean(r.enabled),r.addresses=r.addresses||[],r.cache=r.cache||1e3,!r.enabled||!r.addresses.length)return og("preload disabled"),Object.assign(()=>{},{start:()=>{},stop:()=>{}});let e=!0,t=[],i=r.addresses.map(qW.default),n=(0,FW.default)(r.cache),s=async o=>{try{if(e)throw new Error(`preload ${o} but preloader is not started`);let a=o.toString();if(n.has(a))return;n.set(a,!0);let c=(0,UW.default)(i),u=!1,l=Date.now();for(let d of c){if(e)throw new Error(`preload aborted for ${a}`);let h;try{h=new AbortController,t=t.concat(h),await jW(`${d}/api/v0/refs?r=true&arg=${encodeURIComponent(a)}`,{signal:h.signal}),u=!0}catch(p){p.type!=="aborted"&&og.error(p)}finally{t=t.filter(p=>p!==h)}if(u)break}og(`${u?"":"un"}successfully preloaded ${a} in ${Date.now()-l}ms`)}catch(a){og.error(a)}};return s.start=()=>{e=!1},s.stop=()=>{e=!0,og(`aborting ${t.length} pending preload request(s)`),t.forEach(o=>o.abort()),t=[]},s}f();var TR=R(le()),Cb=Object.assign((0,TR.default)("ipfs:mfs-preload"),{error:(0,TR.default)("ipfs:mfs-preload:error")});function VW({preload:r,files:e,options:t={}}){if(t.interval=t.interval||30*1e3,!t.enabled){Cb("MFS preload disabled");let o=async()=>{};return{start:o,stop:o}}let i="",n,s=async()=>{try{let o=await e.stat("/"),a=o.cid.toString();i!==a&&(Cb(`preloading updated MFS root ${i} -> ${o.cid}`),await r(o.cid),i=a)}catch(o){Cb.error("failed to preload MFS root",o)}finally{n=setTimeout(s,t.interval)}};return{async start(){let o=await e.stat("/");i=o.cid.toString(),Cb(`monitoring MFS root ${o.cid}`),n=setTimeout(s,t.interval)},stop(){clearTimeout(n)}}}f();f();var gY=R(kb()),Db;function cg(r=!1){if(Db)return Db;let e=(0,gY.default)({singleProcess:r});return Db={readLock:t=>async(...i)=>{let n=await e.readLock();try{return await t.apply(null,i)}finally{n()}},writeLock:t=>async(...i)=>{let n=await e.writeLock();try{return await t.apply(null,i)}finally{n()}}},Db}var KR=R(gp());f();f();f();we();vi();var mY=R(le()),NR=R(St());var bY=(0,mY.default)("ipfs:mfs:utils:with-mfs-root");async function S0(r,e){if(e&&e.signal&&e.signal.aborted)throw(0,NR.default)(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await r.repo.datastore.open();let t;try{let i=await r.repo.datastore.get(qy);t=L.decode(i)}catch(i){if(i.code!=="ERR_NOT_FOUND")throw i;bY("Creating new MFS root");let n=lt({Data:new ht({type:"directory"}).marshal(),Links:[]}),s=await Lr.digest(n);if(t=L.createV0(s),await r.repo.blocks.put(t,n),e&&e.signal&&e.signal.aborted)throw(0,NR.default)(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await r.repo.datastore.put(qy,t.bytes)}return bY(`Loaded MFS root /ipfs/${t}`),t}f();function R0(r=""){return(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean)}var BR=R(St());we();var LR="ipfs",Jr=async(r,e,t)=>{let i=await S0(r,t),n={entryType:"file"},s="";if(L.asCID(e)?s=`/ipfs/${e}`:s=e.toString(),s=s.trim(),s=s.replace(/(\/\/+)/g,"/"),s.endsWith("/")&&s.length>1&&(s=s.substring(0,s.length-1)),!s)throw(0,BR.default)(new Error("paths must not be empty"),"ERR_NO_PATH");if(s.substring(0,1)!=="/")throw(0,BR.default)(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");s.substring(s.length-1)==="/"&&(s=s.substring(0,s.length-1));let o=R0(s);if(o[0]===LR){let c;o.length===2?c=`/${o.join("/")}`:c=`/${o.slice(0,o.length-1).join("/")}`,n={type:"ipfs",depth:o.length-2,entryType:"file",mfsPath:`/${o.join("/")}`,mfsDirectory:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}else{let c=`/${LR}/${i}${o.length?"/"+o.join("/"):""}`,u=`/${LR}/${i}/${o.slice(0,o.length-1).join("/")}`;n={type:"mfs",depth:o.length,entryType:"file",mfsDirectory:u,mfsPath:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}let a=n.type==="mfs"?n.mfsPath:n.path;try{let c=await on(a,r.repo.blocks,t);n.cid=c.cid,n.mfsPath=`/ipfs/${c.path}`,n.entryType=c.type,n.content=c.content,(n.entryType==="file"||n.entryType==="directory")&&(c.type==="file"||c.type==="directory")&&(n.unixfs=c.unixfs)}catch(c){if(c.code!=="ERR_NOT_FOUND")throw c}return n.exists=Boolean(n.cid),n};var wY=R(le()),_Y=R(St());var lPe=Pt.bind({ignoreUndefined:!0}),fPe=(0,wY.default)("ipfs:mfs:stat"),dPe={withLocal:!1};function Ml(r){async function e(t,i={}){i=lPe(dPe,i),fPe(`Fetching stats for ${t}`);let{type:n,cid:s,mfsPath:o}=await Jr(r,t,i),a=n==="ipfs"&&s?s:o,c;try{c=await on(a,r.repo.blocks)}catch(u){throw u.code==="ERR_NOT_FOUND"?(0,_Y.default)(new Error(`${t} does not exist`),"ERR_NOT_FOUND"):u}if(!vY[c.type])throw new Error(`Cannot stat codec ${c.cid.code}`);return vY[c.type](c)}return Q(e)}var vY={raw:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:r=>{let e={cid:r.cid,type:"file",size:r.unixfs.fileSize(),cumulativeSize:lt(r.node).length+(r.node.Links||[]).reduce((t,i)=>t+(i.Tsize||0),0),blocks:r.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:r.unixfs.mode};return r.unixfs.mtime&&(e.mtime=r.unixfs.mtime),e},directory:r=>{let e={cid:r.cid,type:"directory",size:0,cumulativeSize:lt(r.node).length+(r.node.Links||[]).reduce((t,i)=>t+(i.Tsize||0),0),blocks:r.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:r.unixfs.mode};return r.unixfs.mtime&&(e.mtime=r.unixfs.mtime),e},object:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})};f();var zY=R(le()),P0=R(St());f();var EY=R(le()),hPe=(0,EY.default)("ipfs:mfs:utils:to-trail");async function sc(r,e){hPe(`Creating trail for path ${e}`);let t=[];for await(let i of bS(e,r.repo.blocks))t.push({name:i.name,cid:i.cid,size:i.size,type:i.type});return t}f();we();var PY=R(le());f();f();we();vi();var Nb=async(r,e,t)=>{t.codec||(t.codec=In),t.hasher||(t.hasher=Lr),t.cidVersion===void 0&&(t.cidVersion=1),t.codec===In&&t.hasher!==Lr&&(t.cidVersion=1);let i=await t.hasher.digest(r),n=L.create(t.cidVersion,t.codec.code,i);return t.onlyHash||await e.put(n,r,{signal:t.signal}),n};var jb=R(U2());f();var Bb=dd.code,Lb=8;async function Mb(r){return(await dd.encode(r)).slice(0,8).reverse()}var SY=class{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}},ug=class extends SY{constructor(e,t){super(e,t);this._bucket=(0,jb.createHAMT)({hashFn:Mb,bits:Lb})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){yield*RY(this._bucket,e,this,this.options)}};async function*RY(r,e,t,i){let n=r._children,s=[],o=0;for(let p=0;p<n.length;p++){let y=n.get(p);if(!y)continue;let g=p.toString(16).toUpperCase().padStart(2,"0");if(y instanceof jb.Bucket){let w;for await(let b of await RY(y,e,null,i))w=b;if(!w)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:g,Tsize:w.size,Hash:w.cid}),o+=w.size}else if(typeof y.value.flush=="function"){let w=y.value,b;for await(let A of w.flush(e))b=A,yield b;let v=g+y.key;s.push({Name:v,Tsize:b.size,Hash:b.cid}),o+=b.size}else{let w=y.value;if(!w.cid)continue;let b=g+y.key,v=w.size;s.push({Name:b,Tsize:v,Hash:w.cid}),o+=v}}let a=Uint8Array.from(n.bitField().reverse()),u={Data:new ht({type:"hamt-sharded-directory",data:a,fanout:r.tableSize(),hashType:Bb,mtime:t&&t.mtime,mode:t&&t.mode}).marshal(),Links:s},l=lt(zi(u)),d=await Nb(l,e,i),h=l.length+o;yield{cid:d,node:u,size:h}}f();var A0=R(U2());var AY=R(le());var xY=R(Qn());we();var lg=(0,AY.default)("ipfs:mfs:core:utils:hamt-utils"),x0=async(r,e,t,i)=>{if(!i.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");let n=Uint8Array.from(t._children.bitField().reverse()),s=ht.unmarshal(i.parent.Data),o=new ht({type:"hamt-sharded-directory",data:n,fanout:t.tableSize(),hashType:Bb,mode:s.mode,mtime:s.mtime}),a=await r.hashers.getHasher(i.hashAlg),c={Data:o.marshal(),Links:e.sort((h,p)=>(h.Name||"").localeCompare(p.Name||""))},u=lt(c),l=await a.digest(u),d=L.create(i.cidVersion,wt,l);return i.flush&&await r.repo.blocks.put(d,u),{node:c,cid:d,size:e.reduce((h,p)=>h+(p.Tsize||0),u.length)}},MR=async(r,e,t,i,n)=>{let s=new A0.Bucket({hash:t._options.hash,bits:t._options.bits},i,n);return i._putObjectAt(n,s),await fg(r,e,s,t),s},jR=async r=>{let e=(0,A0.createHAMT)({hashFn:Mb,bits:Lb});return await Promise.all(r.map(async t=>{let i=t.Name||"";if(i.length===2){let n=parseInt(i,16),s=new A0.Bucket({hash:e._options.hash,bits:e._options.bits},e,n);return e._putObjectAt(n,s),Promise.resolve()}return e.put(i.substring(2),{size:t.Tsize,cid:t.Hash})})),e},fg=async(r,e,t,i)=>{await Promise.all(e.map(async n=>{let s=n.Name||"";if(s.length===2){lg("Populating sub bucket",s);let o=parseInt(s,16),a=await r.repo.blocks.get(n.Hash),c=Nt(a),u=new A0.Bucket({hash:i._options.hash,bits:i._options.bits},t,o);return t._putObjectAt(o,u),await fg(r,c.Links,u,i),Promise.resolve()}return i.put(s.substring(2),{size:n.Tsize,cid:n.Hash})}))},xd=r=>r.toString(16).toUpperCase().padStart(2,"0").substring(0,2),IY=async(r,e,t)=>{let i=await jR(t.Links),n=await i._findNewBucketAndPos(e),s=[{bucket:n.bucket,prefix:xd(n.pos)}],o=n.bucket;for(;o!==i;)s.push({bucket:o,prefix:xd(o._posAtParent)}),o=o._parent;s.reverse(),s[0].node=t;for(let a=0;a<s.length;a++){let c=s[a];if(!c.node)throw new Error("Could not generate HAMT path");let u=c.node.Links.filter(p=>(p.Name||"").substring(0,2)===c.prefix).pop();if(!u){lg(`Link ${c.prefix}${e} will be added`);continue}if(u.Name===`${c.prefix}${e}`){lg(`Link ${c.prefix}${e} will be replaced`);continue}lg(`Found subshard ${c.prefix}`);let l=await r.repo.blocks.get(u.Hash),d=Nt(l);if(!s[a+1]){lg(`Loaded new subshard ${c.prefix}`),await MR(r,d.Links,i,c.bucket,parseInt(c.prefix,16));let p=await i._findNewBucketAndPos(e);s.push({bucket:p.bucket,prefix:xd(p.pos),node:d});continue}let h=s[a+1];await fg(r,d.Links,h.bucket,i),h.node=d}return await i.put(e,!0),s.reverse(),{rootBucket:i,path:s}},TY=async(r,e,t={})=>{let i=new ug({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:t.mtime,mode:t.mode},t);for(let s=0;s<e.length;s++)await i._bucket.put(e[s].name,{size:e[s].size,cid:e[s].cid});let n=await(0,xY.default)(i.flush(r.repo.blocks));if(!n)throw new Error("Flushing shard yielded no result");return n};var oc=R(St()),CY=R(Qn()),ac=(0,PY.default)("ipfs:mfs:core:utils:add-link");async function uo(r,e){let t=e.parent;if(e.parentCid){let n=L.asCID(e.parentCid);if(n===null)throw(0,oc.default)(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(n.code!==wt)throw(0,oc.default)(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");ac(`Loading parent node ${n}`);let s=await r.repo.blocks.get(n);t=Nt(s)}if(!t)throw(0,oc.default)(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!e.cid)throw(0,oc.default)(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!e.name)throw(0,oc.default)(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!e.size&&e.size!==0)throw(0,oc.default)(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!t.Data)throw(0,oc.default)(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");let i=ht.unmarshal(t.Data);return i.type==="hamt-sharded-directory"?(ac("Adding link to sharded directory"),gPe(r,{...e,parent:t})):t.Links.length>=e.shardSplitThreshold?(ac("Converting directory to sharded directory"),pPe(r,{...e,parent:t,mtime:i.mtime,mode:i.mode})):(ac(`Adding ${e.name} (${e.cid}) to regular directory`),yPe(r,{...e,parent:t}))}var pPe=async(r,e)=>{let t=await TY(r,e.parent.Links.map(i=>({name:i.Name||"",size:i.Tsize||0,cid:i.Hash})).concat({name:e.name,size:e.size,cid:e.cid}),e);return ac(`Converted directory to sharded directory ${t.cid}`),t},yPe=async(r,e)=>{let t=e.parent.Links.filter(u=>u.Name!==e.name);if(t.push({Name:e.name,Tsize:e.size,Hash:e.cid}),!e.parent.Data)throw(0,oc.default)(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");let i=ht.unmarshal(e.parent.Data),n;if(i.mtime){let u=Date.now(),l=Math.floor(u/1e3);i.mtime={secs:l,nsecs:(u-l*1e3)*1e3},n=i.marshal()}else n=e.parent.Data;e.parent=zi({Data:n,Links:t});let s=await r.hashers.getHasher(e.hashAlg),o=lt(e.parent),a=await s.digest(o),c=L.create(e.cidVersion,wt,a);return e.flush&&await r.repo.blocks.put(c,o),{node:e.parent,cid:c,size:o.length}},gPe=async(r,e)=>{let{shard:t,path:i}=await mPe(r,e),n=await(0,CY.default)(t.flush(r.repo.blocks));if(!n)throw new Error("No result from flushing shard");let s=await r.repo.blocks.get(n.cid),o=Nt(s),a=e.parent.Links.filter(u=>(u.Name||"").substring(0,2)!==i[0].prefix),c=o.Links.find(u=>(u.Name||"").substring(0,2)===i[0].prefix);if(!c)throw new Error(`No link found with prefix ${i[0].prefix}`);return a.push(c),x0(r,a,i[0].bucket,e)},mPe=async(r,e)=>{let t={name:e.name,cid:e.cid,size:e.size};if(!e.parent.Data)throw(0,oc.default)(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");let i=await jR(e.parent.Links),n=ht.unmarshal(e.parent.Data),s=new ug({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mode:n.mode},e);s._bucket=i,n.mtime&&(s.mtime={secs:Math.round(Date.now()/1e3)});let o=await i._findNewBucketAndPos(t.name),a=bPe(o);a[0].node=e.parent;let c=0;for(;c<a.length;){let u=a[c];c++;let l=u.node;if(!l)throw new Error("Segment had no node");let d=l.Links.find(g=>(g.Name||"").substring(0,2)===u.prefix);if(!d){ac(`Link ${u.prefix}${t.name} will be added`),c=a.length;break}if(d.Name===`${u.prefix}${t.name}`){ac(`Link ${u.prefix}${t.name} will be replaced`),c=a.length;break}if((d.Name||"").length>2){ac(`Link ${d.Name} ${d.Hash} will be replaced with a subshard`),c=a.length;break}ac(`Found subshard ${u.prefix}`);let h=await r.repo.blocks.get(d.Hash),p=Nt(h);if(!a[c]){ac(`Loaded new subshard ${u.prefix}`),await MR(r,p.Links,i,u.bucket,parseInt(u.prefix,16));let g=await i._findNewBucketAndPos(t.name);a.push({bucket:g.bucket,prefix:xd(g.pos),node:p});break}let y=a[c];await fg(r,p.Links,y.bucket,i),y.node=p}return await s._bucket.put(t.name,{size:t.size,cid:t.cid}),{shard:s,path:a}},bPe=r=>{let e=[{bucket:r.bucket,prefix:xd(r.pos)}],t=r.bucket._parent,i=r.bucket._posAtParent;for(;t;)e.push({bucket:t,prefix:xd(i)}),i=t._posAtParent,t=t._parent;return e.reverse(),e};f();var OY=R(le());var kY=(0,OY.default)("ipfs:mfs:utils:update-tree"),wPe={shardSplitThreshold:1e3};async function As(r,e,t){t=Object.assign({},wPe,t),kY("Trail",e),e=e.slice().reverse();let i=0,n;for await(let o of r.repo.blocks.getMany(e.map(a=>a.cid))){let a=Nt(o),c=e[i].cid,u=e[i].name;if(i++,!n){n={cid:c,name:u,size:o.length};continue}let l=await uo(r,{parent:a,name:n.name,cid:n.cid,size:n.size,flush:t.flush,shardSplitThreshold:t.shardSplitThreshold,hashAlg:t.hashAlg,cidVersion:t.cidVersion});n={cid:l.cid,name:u,size:l.size}}let{cid:s}=n;return kY(`Final CID ${s}`),s}f();var DY=R(le());var NY=R(St()),_Pe=(0,DY.default)("ipfs:mfs:utils:update-mfs-root");async function xs(r,e,t){if(t&&t.signal&&t.signal.aborted)throw(0,NY.default)(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return _Pe(`New MFS root will be ${e}`),await r.repo.datastore.put(qy,e.bytes),e}we();var HY=R(dr());var $Y=R(Qn());f();f();var Id=R(St()),LY=R(le());f();we();async function BY(r,e,t){let i=new ht({type:e,mode:t.mode,mtime:t.mtime}),n=await r.hashers.getHasher(t.hashAlg),s={Data:i.marshal(),Links:[]},o=lt(s),a=await n.digest(o),c=L.create(t.cidVersion,wt,a);return t.flush&&await r.repo.blocks.put(c,o),{cid:c,node:s}}var vPe=Pt.bind({ignoreUndefined:!0}),MY=(0,LY.default)("ipfs:mfs:mkdir"),EPe={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};function Td(r){async function e(t,i={}){let n=vPe(EPe,i);if(!t)throw new Error("no path given to Mkdir");if(t=t.trim(),t==="/"){if(n.parents)return;throw(0,Id.default)(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if(t.substring(0,1)!=="/")throw(0,Id.default)(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");MY(`Creating ${t}`);let s=R0(t);if(s[0]==="ipfs")throw(0,Id.default)(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");let o=await S0(r,n),a,c=[],u=await BY(r,"directory",n);for(let d=0;d<=s.length;d++){let h=s.slice(0,d),p=`/ipfs/${o}/${h.join("/")}`;try{if(a=await on(p,r.repo.blocks),a.type!=="file"&&a.type!=="directory")throw(0,Id.default)(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(d===s.length){if(n.parents)return;throw(0,Id.default)(new Error("file already exists"),"ERR_ALREADY_EXISTS")}c.push({name:a.name,cid:a.cid})}catch(y){if(y.code==="ERR_NOT_FOUND"){if(d<s.length&&!n.parents)throw(0,Id.default)(new Error(`Intermediate directory path ${p} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await SPe(r,h[h.length-1],u,c[c.length-1],c,n)}else throw y}}let l=await As(r,c,n);await xs(r,l,n)}return Q(e)}var SPe=async(r,e,t,i,n,s)=>{MY(`Adding empty dir called ${e} to ${i.cid}`);let o=await uo(r,{parent:i.node,parentCid:i.cid,size:0,cid:t.cid,name:e,hashAlg:s.hashAlg,cidVersion:s.cidVersion,flush:s.flush,shardSplitThreshold:s.shardSplitThreshold});n[n.length-1].cid=o.cid,n.push({name:e,cid:t.cid})};var jY=R(le()),jl=R(St());var RPe=Pt.bind({ignoreUndefined:!0}),qb=(0,jY.default)("ipfs:mfs:cp"),APe={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};function I0(r){async function e(t,i,n={}){let s=RPe(APe,n);Array.isArray(t)||(t=[t]);let o=await Promise.all(t.map(h=>Jr(r,h,s))),a=await Jr(r,i,s);if(!o.length||!a)throw(0,jl.default)(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");let c=o.find(h=>!h.exists);if(c)throw(0,jl.default)(new Error(`${c.path} does not exist`),"ERR_INVALID_PARAMS");let u=qY(a);if(a.exists){if(qb("Destination exists"),o.length===1&&!u)throw(0,jl.default)(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(qb("Destination does not exist"),o.length>1){if(!s.parents)throw(0,jl.default)(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await Td(r)(a.path,s),a=await Jr(r,a.path,s)}else if(a.parts.length>1){let h=`/${a.parts.slice(0,-1).join("/")}`;try{await Ml(r)(h,s)}catch(p){if(p.code!=="ERR_NOT_FOUND")throw p;if(!s.parents)throw(0,jl.default)(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await Td(r)(h,s),a=await Jr(r,a.path,s)}}let l=qY(a)?a.mfsPath:a.mfsDirectory,d=await sc(r,l);if(o.length===1){let h=o.pop();if(!h)throw(0,jl.default)(new Error("could not find source"),"ERR_INVALID_PARAMS");let p=u?h.name:a.name;return qb(`Only one source, copying to destination ${u?"directory":"file"} ${p}`),xPe(r,h,p,d,s)}return qb("Multiple sources, wrapping in a directory"),IPe(r,o,a,d,s)}return Q(e)}var qY=r=>r.unixfs&&r.unixfs.type&&r.unixfs.type.includes("directory"),xPe=async(r,e,t,i,n)=>{let s=i.pop();if(!s)throw(0,jl.default)(new Error("destination had no parent"),"ERR_INVALID_PARAMS");s=await UY(r,e,t,s,n),i.push(s);let o=await As(r,i,n);await xs(r,o,n)},IPe=async(r,e,t,i,n)=>{for(let o=0;o<e.length;o++){let a=e[o];t=await UY(r,a,a.name,t,n)}i[i.length-1]=t;let s=await As(r,i,n);await xs(r,s,n)},UY=async(r,e,t,i,n)=>{let s=await r.repo.blocks.get(e.cid),{node:o,cid:a,size:c}=await uo(r,{parentCid:i.cid,size:s.length,cid:e.cid,name:t,hashAlg:n.hashAlg,cidVersion:n.cidVersion,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold});return i.node=o,i.cid=a,i.size=c,i};f();var dg=R(St());f();we();var FY=R(le());var ql=R(St()),Ul=(0,FY.default)("ipfs:mfs:core:utils:remove-link");async function KY(r,e){let t=e.parent;if(e.parentCid){let n=L.asCID(e.parentCid);if(n===null)throw(0,ql.default)(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");Ul(`Loading parent node ${n}`);let s=await r.repo.blocks.get(n);t=Nt(s)}if(!t)throw(0,ql.default)(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!e.name)throw(0,ql.default)(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!t.Data)throw(0,ql.default)(new Error("Parent node had no data"),"ERR_INVALID_NODE");return ht.unmarshal(t.Data).type==="hamt-sharded-directory"?(Ul(`Removing ${e.name} from sharded directory`),PPe(r,{...e,parent:t})):(Ul(`Removing link ${e.name} regular directory`),TPe(r,{...e,parent:t}))}var TPe=async(r,e)=>{e.parent.Links=e.parent.Links.filter(o=>o.Name!==e.name);let t=await lt(e.parent),n=await(await r.hashers.getHasher(e.hashAlg)).digest(t),s=L.create(e.cidVersion,wt,n);return await r.repo.blocks.put(s,t),Ul(`Updated regular directory ${s}`),{node:e.parent,cid:s}},PPe=async(r,e)=>{let{rootBucket:t,path:i}=await IY(r,e.name,e.parent);await t.del(e.name);let{node:n}=await VY(r,i,e.name,e);return x0(r,n.Links,t,e)},VY=async(r,e,t,i)=>{let n=e.pop();if(!n)throw(0,ql.default)(new Error("Could not find parent"),"EINVALIDPARENT");let{bucket:s,prefix:o,node:a}=n;if(!a)throw(0,ql.default)(new Error("Could not find parent"),"EINVALIDPARENT");let c=a.Links.find(p=>(p.Name||"").substring(0,2)===o);if(!c)throw(0,ql.default)(new Error(`No link found with prefix ${o} for file ${t}`),"ERR_NOT_FOUND");if(c.Name===`${o}${t}`){Ul(`Removing existing link ${c.Name}`);let p=a.Links.filter(y=>y.Name!==c.Name);return await s.del(t),x0(r,p,s,i)}Ul(`Descending into sub-shard ${c.Name} for ${o}${t}`);let u=await VY(r,e,t,i),l=u.cid,d=u.size,h=o;if(u.node.Links.length===1){Ul(`Removing subshard for ${o}`);let p=u.node.Links[0];h=`${o}${(p.Name||"").substring(2)}`,l=p.Hash,d=p.Tsize||0}return Ul(`Updating shard ${o} with name ${h}`),CPe(r,s,a,o,h,d,l,i)},CPe=(r,e,t,i,n,s,o,a)=>{let c=t.Links.filter(u=>u.Name!==i);return c.push({Name:n,Tsize:s,Hash:o}),x0(r,c,e,a)};var OPe=Pt.bind({ignoreUndefined:!0}),kPe={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};function T0(r){async function e(t,i={}){let n=OPe(kPe,i);Array.isArray(t)||(t=[t]);let s=await Promise.all(t.map(o=>Jr(r,o,n)));if(!s.length)throw(0,dg.default)(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");s.forEach(o=>{if(o.path==="/")throw(0,dg.default)(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")});for(let o of s)await DPe(r,o.path,n)}return Q(e)}var DPe=async(r,e,t)=>{let i=await Jr(r,e,t),n=await sc(r,i.mfsPath),s=n[n.length-1];n.pop();let o=n[n.length-1];if(!o)throw(0,dg.default)(new Error(`${e} does not exist`),"ERR_NOT_FOUND");if(s.type==="directory"&&!t.recursive)throw(0,dg.default)(new Error(`${e} is a directory, use -r to remove directories`),"ERR_WAS_DIR");let{cid:a}=await KY(r,{parentCid:o.cid,name:s.name,hashAlg:t.hashAlg,cidVersion:t.cidVersion,flush:t.flush,shardSplitThreshold:t.shardSplitThreshold});o.cid=a;let c=await As(r,n,t);await xs(r,c,t)};var NPe=Pt.bind({ignoreUndefined:!0}),BPe=(0,zY.default)("ipfs:mfs:touch"),GY={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function LPe(r,e,t){let i=0;return(r.includes("x")||r.includes("X")&&(t||e&1||e&8||e&64))&&(i+=1),r.includes("w")&&(i+=2),r.includes("r")&&(i+=4),i}function MPe(r,e){let t=0;return r.includes("u")&&(t+=e<<6),r.includes("g")&&(t+=e<<3),r.includes("o")&&(t+=e),t}function jPe(r,e,t){return e.includes("t")&&(t+=parseInt("1000",8)),e.includes("s")&&(r.includes("u")&&(t+=parseInt("4000",8)),r.includes("g")&&(t+=parseInt("2000",8))),t}function qPe(r,e,t){e||(e=0);let i=r.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!i)throw new Error(`Invalid file mode: ${r}`);let[,n,s,o]=i;(n==="a"||!n)&&(n="ugo");let a=LPe(o,e,t);return a=MPe(n,a),a=jPe(n,o,a),s==="="?(n.includes("u")&&(e=e&parseInt("7077",8),e=e|a),n.includes("g")&&(e=e&parseInt("7707",8),e=e|a),n.includes("o")&&(e=e&parseInt("7770",8),e=e|a),e):s==="+"?a|e:s==="-"?a^e:e}function WY(r,e){if(r instanceof String||typeof r=="string"){let t=`${r}`;t.match(/^\d+$/g)?r=parseInt(t,8):r=0+t.split(",").reduce((i,n)=>qPe(n,i,e.isDirectory()),e.mode||0)}return r}function YY(r){async function e(t,i,n={}){let s=NPe(GY,n);BPe(`Fetching stats for ${t}`);let{cid:o,mfsDirectory:a,name:c}=await Jr(r,t,s);if(o.code!==wt)throw(0,P0.default)(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(s.recursive){let j=await(0,HY.pipe)(async function*(){for await(let M of eb(o,r.repo.blocks)){if(M.type!=="file"&&M.type!=="directory")throw(0,P0.default)(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");M.unixfs.mode=WY(i,M.unixfs);let se=zi({Data:M.unixfs.marshal(),Links:M.node.Links});yield{path:M.path,content:se}}},M=>r0(M,r.repo.blocks,{...s,pin:!1,dagBuilder:async function*(se,ie,fe){for await(let pe of se)yield async function(){let Le=pe.content,Re=lt(Le),De=await Nb(Re,ie,fe);if(!Le.Data)throw(0,P0.default)(new Error(`${De} had no data`),"ERR_INVALID_NODE");let ne=ht.unmarshal(Le.Data);return{cid:De,size:Re.length,path:pe.path,unixfs:ne}}}}),M=>(0,$Y.default)(M));if(!j)throw(0,P0.default)(new Error(`Could not chmod ${t}`),"ERR_COULD_NOT_CHMOD");await T0(r)(t,s),await I0(r)(`/ipfs/${j.cid}`,t,s);return}let u=await r.repo.blocks.get(o),l=Nt(u);if(!l.Data)throw(0,P0.default)(new Error(`${o} had no data`),"ERR_INVALID_NODE");let d=ht.unmarshal(l.Data);d.mode=WY(i,d);let h=lt({Data:d.marshal(),Links:l.Links}),p=s.hashAlg||GY.hashAlg,g=await(await r.hashers.getHasher(p)).digest(h),w=L.create(s.cidVersion,wt,g);s.flush&&await r.repo.blocks.put(w,h);let b=await sc(r,a),v=b[b.length-1],A=L.decode(v.cid.bytes),k=await r.repo.blocks.get(A),C=Nt(k),T=await uo(r,{parent:C,name:c,cid:w,size:h.length,flush:s.flush,hashAlg:p,cidVersion:o.version,shardSplitThreshold:1/0});v.cid=T.cid;let D=await As(r,b,s);await xs(r,D,s)}return Q(e)}f();var UPe=Pt.bind({ignoreUndefined:!0}),FPe={};function XY(r){async function e(t,i={}){i=UPe(FPe,i);let{cid:n}=await Ml(r)(t,i);return n}return Q(e)}f();var KPe=Pt.bind({ignoreUndefined:!0}),VPe={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};function QY(r){async function e(t,i,n={}){let s=KPe(VPe,n);await I0(r)(t,i,s),await T0(r)(t,{...s,recursive:!0})}return Q(e)}f();var ZY=R(le()),qR=R(St());we();var zPe=Pt.bind({ignoreUndefined:!0}),HPe=(0,ZY.default)("ipfs:mfs:touch"),JY={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};function eX(r){async function e(t,i={}){let n=zPe(JY,i);n.mtime=n.mtime||new Date,HPe(`Touching ${t} mtime: ${n.mtime}`);let{cid:s,mfsDirectory:o,name:a,exists:c}=await Jr(r,t,n),u=i.hashAlg||JY.hashAlg,l=await r.hashers.getHasher(u),d,h,p=n.cidVersion;if(c){if(s.code!==wt)throw(0,qR.default)(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");p=s.version;let C=await r.repo.blocks.get(s),T=Nt(C);if(!T.Data)throw(0,qR.default)(new Error(`${t} had no data`),"ERR_INVALID_NODE");let D=ht.unmarshal(T.Data);D.mtime=n.mtime,d=lt({Data:D.marshal(),Links:T.Links});let j=await l.digest(d);h=L.create(n.cidVersion,wt,j),n.flush&&await r.repo.blocks.put(h,d)}else{let C=new ht({type:"file",mtime:n.mtime});d=lt({Data:C.marshal(),Links:[]});let T=await l.digest(d);h=L.create(n.cidVersion,wt,T),n.flush&&await r.repo.blocks.put(h,d)}let y=await sc(r,o),g=y[y.length-1],w=g.cid,b=await r.repo.blocks.get(w),v=Nt(b),A=await uo(r,{parent:v,name:a,cid:h,size:d.length,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:p});g.cid=A.cid;let k=await As(r,y,n);await xs(r,k,n)}return Q(e)}f();var UR=R(St());var $Pe=Pt.bind({ignoreUndefined:!0}),GPe={offset:0,length:1/0};function tX(r){function e(t,i={}){return i=$Pe(GPe,i),{[Symbol.asyncIterator]:async function*(){let s=await Jr(r,t,i),o=await on(s.mfsPath,r.repo.blocks);if(o.type!=="file")throw(0,UR.default)(new Error(`${t} was not a file`),"ERR_NOT_FILE");if(!o.content)throw(0,UR.default)(new Error(`Could not load content stream from ${t}`),"ERR_NO_CONTENT");for await(let a of o.content({offset:i.offset,length:i.length}))yield a}}}return Q(e)}f();var nX=R(le());f();var FR=R(St()),rX=R(le());ct();var hg=(0,rX.default)("ipfs:mfs:utils:to-async-iterator");function iX(r){if(!r)throw(0,FR.default)(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if((typeof r=="string"||r instanceof String)&&(hg("Content was a string"),r=Qe(r.toString())),r.length)return hg("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield r}};if(r[Symbol.asyncIterator])return hg("Content was an async iterator"),r;if(r[Symbol.iterator])return hg("Content was an iterator"),r;if(globalThis.Blob&&r instanceof globalThis.Blob){hg("Content was an HTML5 Blob");let e=0,t={next:()=>e>r.size?{done:!0}:new Promise((i,n)=>{let s=r.slice(e,Uy);e+=Uy;let o=new globalThis.FileReader,a=c=>{if(o.removeEventListener("loadend",a,!1),c.error)return n(c.error);i({done:!1,value:new Uint8Array(o.result)})};o.addEventListener("loadend",a),o.readAsArrayBuffer(s)})};return{[Symbol.asyncIterator]:()=>t}}throw(0,FR.default)(new Error(`Don't know how to convert ${r} into an async iterator`),"ERR_INVALID_PARAMS")}var cc=R(St());var sX=R(Qn());var WPe=Pt.bind({ignoreUndefined:!0}),uc=(0,nX.default)("ipfs:mfs:write"),YPe={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(r,e)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};function oX(r){async function e(t,i,n={}){let s=WPe(YPe,n),o,a,c;if(uc("Reading source, destination and parent"),await cg().readLock(async()=>{o=await iX(i),a=await Jr(r,t,s),c=await Jr(r,a.mfsDirectory,s)})(),uc("Read source, destination and parent"),!s.parents&&!c.exists)throw(0,cc.default)(new Error("directory does not exist"),"ERR_NO_EXIST");if(o==null)throw(0,cc.default)(new Error("could not create source"),"ERR_NO_SOURCE");if(a==null)throw(0,cc.default)(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!s.create&&!a.exists)throw(0,cc.default)(new Error("file does not exist"),"ERR_NO_EXIST");if(a.entryType!=="file")throw(0,cc.default)(new Error("not a file"),"ERR_NOT_A_FILE");return XPe(r,t,o,a,s)}return Q(e)}var XPe=async(r,e,t,i,n)=>{let s=await QPe(r,t,i,n);await cg().writeLock(async()=>{let o=R0(e),a=o.pop();if(a==null)throw(0,cc.default)(new Error("source does not exist"),"ERR_NO_EXIST");let c=!1;try{await Ml(r)(`/${o.join("/")}`,n),c=!0}catch(w){if(w.code!=="ERR_NOT_FOUND")throw w}c||await Td(r)(`/${o.join("/")}`,n);let u=await Jr(r,e,n),l=await sc(r,u.mfsDirectory),d=l[l.length-1];if(!d)throw(0,cc.default)(new Error("directory does not exist"),"ERR_NO_EXIST");if(!d.type||!d.type.includes("directory"))throw(0,cc.default)(new Error(`cannot write to ${d.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");let h=await r.repo.blocks.get(d.cid),p=Nt(h),y=await uo(r,{parent:p,name:a,cid:s.cid,size:s.size,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:n.cidVersion});d.cid=y.cid;let g=await As(r,l,n);await xs(r,g,n)})()},QPe=async(r,e,t,i)=>{t.exists?uc(`Overwriting file ${t.cid} offset ${i.offset} length ${i.length}`):uc(`Writing file offset ${i.offset} length ${i.length}`);let n=[];if(i.offset>0)if(t.unixfs){if(uc(`Writing first ${i.offset} bytes of original file`),n.push(()=>t.content({offset:0,length:i.offset})),t.unixfs.fileSize()<i.offset){let l=i.offset-t.unixfs.fileSize();uc(`Writing zeros for extra ${l} bytes`),n.push(cX(l))}}else uc(`Writing zeros for first ${i.offset} bytes`),n.push(cX(i.offset));n.push(aX(e,i.length));let s=JPe(ZPe(n),l=>{if(t.unixfs&&!i.truncate){let d=t.unixfs.fileSize();if(d>l)return uc(`Writing last ${d-l} of ${d} bytes from original file starting at offset ${l}`),t.content({offset:l});uc("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}),o;i.mode!==void 0&&i.mode!==null?o=qc(i.mode):t&&t.unixfs&&(o=t.unixfs.mode);let a;i.mtime!=null?a=zu(i.mtime):t&&t.unixfs&&(a=t.unixfs.mtime);let c=await r.hashers.getHasher(i.hashAlg),u=await(0,sX.default)(r0([{content:s,mode:o,mtime:a}],r.repo.blocks,{progress:i.progress,hasher:c,cidVersion:i.cidVersion,strategy:i.strategy,rawLeaves:i.rawLeaves,reduceSingleLeafToSelf:i.reduceSingleLeafToSelf,leafType:i.leafType}));if(!u)throw(0,cc.default)(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return uc(`Wrote ${u.cid}`),{cid:u.cid,size:u.size}},aX=(r,e)=>async function*(){let i=0;for await(let n of r){if(i+=n.length,i>e){yield n.slice(0,e-i);return}yield n}},cX=(r,e=Uy)=>{let t=new Uint8Array(e);async function*i(){for(;;)yield t.slice()}return aX(i(),r)},ZPe=async function*(r){for(let e=0;e<r.length;e++)yield*r[e]()},JPe=async function*(r,e){let t=0;for await(let i of r)t+=i.length,yield i;for await(let i of e(t))t+=i.length,yield i};f();var uX=R(bn()),lX=r=>{let e={cid:r.cid,name:r.name,type:r.type==="directory"?"directory":"file",size:r.size};return(r.type==="file"||r.type==="directory")&&(e.mode=r.unixfs.mode,e.mtime=r.unixfs.mtime),e};function fX(r){async function*e(t,i={}){let n=await Jr(r,t,i),s=await on(n.mfsPath,r.repo.blocks);if(s.type==="directory"){yield*(0,uX.default)(s.content(i),lX);return}yield lX(s)}return Q(e)}var eCe={stat:Ml},tCe={chmod:YY,cp:I0,flush:XY,mkdir:Td,mv:QY,rm:T0,touch:eX},dX={write:oX,read:tX,ls:fX},hX=({options:r,mfs:e,operations:t,lock:i})=>{Object.keys(t).forEach(n=>{e[n]=i(t[n](r))})},rCe={repoOwner:!0,repo:null};function iCe(r){let{repoOwner:e}=Object.assign({},rCe||{},r),t=cg(e),i=o=>t.readLock(o),n=o=>t.writeLock(o),s={};return hX({options:r,mfs:s,operations:eCe,lock:i}),hX({options:r,mfs:s,operations:tCe,lock:n}),Object.keys(dX).forEach(o=>{s[o]=dX[o](r)}),s}function pX({repo:r,preload:e,hashers:t,options:i}){let n=iCe({repo:r,repoOwner:Boolean(i.repoOwner),hashers:t}),s=o=>(...c)=>{let u=c.filter(l=>KR.default.ipfsPath(l)||KR.default.cid(l));if(u.length){let l=c[c.length-1];l&&l.preload!==!1&&u.forEach(d=>e(d))}return o(...c)};return{...n,chmod:n.chmod,cp:s(n.cp),mkdir:n.mkdir,stat:s(n.stat),rm:n.rm,read:s(n.read),touch:n.touch,write:n.write,mv:s(n.mv),flush:n.flush,ls:s(async function*(...o){for await(let a of n.ls(...o))yield{...a,size:a.size||0}})}}f();f();function yX({keychain:r}){return Q((t,i)=>r.exportKey(t,i))}f();var gX="ed25519",mX=2048;function bX({keychain:r}){return Q((t,i={type:gX,size:mX})=>r.createKey(t,i.type||gX,i.size||mX))}f();function wX({keychain:r}){return Q((t,i,n)=>r.importKey(t,i,n))}f();function _X({keychain:r}){return Q(t=>r.findKeyByName(t))}f();function vX({keychain:r}){return Q(()=>r.listKeys())}f();function EX({keychain:r}){return Q(async(t,i)=>{let n=await r.renameKey(t,i);return{was:t,now:n.name,id:n.id,overwrite:!1}})}f();function SX({keychain:r}){return Q(t=>r.removeKey(t))}var VR=class{constructor({keychain:e}){this.gen=bX({keychain:e}),this.list=vX({keychain:e}),this.rm=SX({keychain:e}),this.rename=EX({keychain:e}),this.export=yX({keychain:e}),this.import=wX({keychain:e}),this.info=_X({keychain:e})}};f();f();f();function ns({repo:r,preload:e}){async function t(i,n={}){n.preload!==!1&&e(i);let s=await r.blocks.get(i,n);return Nt(s)}return Q(t)}function RX({repo:r,preload:e}){let t=ns({repo:r,preload:e});async function i(n,s={}){return(await t(n,s)).Data||new Uint8Array(0)}return Q(i)}f();Vs();we();function zR(r,e=[]){for(let t in r){let i=r[t];if(t==="/"&&Object.keys(r).length===1)try{e.push({Name:"",Tsize:0,Hash:L.parse(i)});continue}catch(s){}let n=L.asCID(i);if(n){e.push({Name:"",Tsize:0,Hash:n});continue}Array.isArray(i)&&zR(i,e),i&&typeof i=="object"&&zR(i,e)}return e}function AX({repo:r,codecs:e}){async function t(i,n={}){let s=await e.getCodec(i.code),o=await r.blocks.get(i,n),a=s.decode(o);switch(i.code){case Di:return[];case wt:return a.Links;case Ov:case Mv:return zR(a);default:throw new Error(`Cannot resolve links from codec ${i.code}`)}}return Q(t)}f();vi();we();function xX({repo:r,preload:e}){async function t(i={}){let n;if(i.template)if(i.template==="unixfs-dir")n=new ht({type:"directory"}).marshal();else throw new Error("unknown template");let s=lt({Data:n,Links:[]}),o=await Lr.digest(s),a=L.createV0(o);return await r.blocks.put(a,s,{signal:i.signal}),i.preload!==!1&&e(a),a}return Q(t)}f();we();vi();function lc({repo:r,preload:e}){async function t(i,n={}){let s=await r.gcLock.readLock();try{let o=lt(i),a=await Lr.digest(o),c=L.createV1(wt,a);return await r.blocks.put(c,o,{signal:n.signal}),n.preload!==!1&&e(c),n.pin&&await r.pins.pinRecursively(c,{signal:n.signal}),c}finally{s()}}return Q(t)}f();function IX({repo:r,preload:e}){let t=ns({repo:r,preload:e});async function i(n,s={}){let o=await t(n,s),c=lt(o).length,u=o.Links.reduce((l,d)=>l+(d.Tsize||0),0);return{Hash:n,NumLinks:o.Links.length,BlockSize:c,LinksSize:c-(o.Data||[]).length,DataSize:(o.Data||[]).length,CumulativeSize:c+u}}return Q(i)}f();f();function TX({repo:r,preload:e}){let t=ns({repo:r,preload:e}),i=lc({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a);return i({...c,Links:c.Links.concat([o])},a)}return Q(n)}f();Si();function PX({repo:r,preload:e}){let t=ns({repo:r,preload:e}),i=lc({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a),u=Ni([c.Data||[],o]);return i({...c,Data:u},a)}return Q(n)}f();function CX({repo:r,preload:e}){let t=ns({repo:r,preload:e}),i=lc({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a),u=(typeof o=="string"?o:o.Name)||"";return c.Links=c.Links.filter(l=>l.Name!==u),i(c,a)}return Q(n)}f();function OX({repo:r,preload:e}){let t=ns({repo:r,preload:e}),i=lc({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a);return i({...c,Data:o},a)}return Q(n)}var HR=class{constructor({repo:e,preload:t}){this.addLink=TX({repo:e,preload:t}),this.appendData=PX({repo:e,preload:t}),this.rmLink=CX({repo:e,preload:t}),this.setData=OX({repo:e,preload:t})}};var $R=class{constructor({repo:e,codecs:t,preload:i}){this.data=RX({repo:e,preload:i}),this.get=ns({repo:e,preload:i}),this.links=AX({repo:e,codecs:t}),this.new=xX({repo:e,preload:i}),this.put=lc({repo:e,preload:i}),this.stat=IX({repo:e,preload:i}),this.patch=new HR({repo:e,preload:i})}};f();f();var kX=R(le());var nCe=(0,kX.default)("ipfs:repo:gc");function DX({repo:r,hashers:e}){async function*t(i={}){let n=Date.now(),s;try{s=await S0({repo:r,hashers:e},i),await r.pins.pinRecursively(s),yield*r.gc()}finally{s&&await r.pins.unpin(s)}nCe(`Complete (${Date.now()-n}ms)`)}return Q(t)}f();function Ub({repo:r}){async function e(t={}){let i=await r.stat();return{numObjects:BigInt(i.numObjects.toString()),repoSize:BigInt(i.repoSize.toString()),repoPath:i.repoPath,version:`${i.version}`,storageMax:BigInt(i.storageMax.toString())}}return Q(e)}f();f();var C0=12;function NX({repo:r}){async function e(t={}){try{await r._checkInitialized(t)}catch(i){if([/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(s=>s.test(i.message)))return C0;throw i}return r.version.get()}return Q(e)}var GR=class{constructor({repo:e,hashers:t}){this.gc=DX({repo:e,hashers:t}),this.stat=Ub({repo:e}),this.version=NX({repo:e}),this.setApiAddr=i=>e.apiAddr.set(i)}};f();f();var BX=R(St());var LX=R(ot());function MX(r,e){let t;if(r.metrics?e.peer?t=r.metrics.forPeer(LX.default.parse(e.peer)):e.proto?t=r.metrics.forProtocol(e.proto):t=r.metrics.global:t=void 0,!t)return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0};let{movingAverages:i,snapshot:n}=t;return{totalIn:BigInt(n.dataReceived.integerValue().toString()),totalOut:BigInt(n.dataSent.integerValue().toString()),rateIn:i.dataReceived[6e4].movingAverage()/60,rateOut:i.dataSent[6e4].movingAverage()/60}}function jX({network:r}){return Q(async function*(t={}){let{libp2p:i}=await r.use(t);if(!t.poll){yield MX(i,t);return}let n=t.interval||1e3,s=-1;try{if(s=typeof n=="string"?il(n)||-1:n,!s||s<0)throw new Error("invalid duration")}catch(a){throw(0,BX.default)(a,"ERR_INVALID_POLL_INTERVAL")}let o;try{for(;;)yield MX(i,t),await new Promise(a=>{o=setTimeout(a,s)})}finally{clearTimeout(o)}})}var WR=class{constructor({repo:e,network:t}){this.repo=Ub({repo:e}),this.bw=jX({network:t}),this.bitswap=A6({network:t})}};f();var Ame=R(le());f();f();var EA=R(YR()),cZ=R(le()),Md=R(Pd());f();f();f();we();Mr();var VX=R(le()),zX=R(pg());en();Vs();Ji();var cCe=(0,VX.default)("ipfs:repo:migrator:migration-8");function HX(r){return r.child?HX(r.child):r}function uCe(r){try{let e=ur.decode(`b${r.toString().toLowerCase().slice(1)}`),t=L.decode(e).multihash.bytes,i=ur.encode(t).slice(1).toUpperCase();return new xe(`/${i}`,!1)}catch(e){return r}}function lCe(r){try{let e=ur.decode(`b${r.toString().toLowerCase().slice(1)}`),t=fi(e),i=ur.encode(L.createV1(Di,t).bytes).slice(1);return new xe(`/${i.toUpperCase()}`,!1)}catch{return r}}async function $X(r,e,t){let i=r.blocks;await i.open();let n=HX(i),s=await(0,zX.default)(n.queryKeys({filters:[o=>t(o).toString()!==o.toString()]}));try{let o=0;for await(let a of n.query({})){let c=t(a.key);c.toString()!==a.key.toString()&&(o+=1,cCe(`Migrating Block from ${a.key} to ${c}`,await n.has(a.key)),await n.delete(a.key),await n.put(c,a.value),e(o/s*100,`Migrated Block from ${a.key} to ${c}`))}}finally{await i.close()}}var GX={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(r,e=()=>{})=>$X(r,e,uCe),revert:(r,e=()=>{})=>$X(r,e,lCe)};f();we();Qu();f();we();f();var Cd=R(Br()),WX=Cd.default.Reader,fCe=Cd.default.Writer,Rmt=Cd.default.util,Fb=Cd.default.roots.default||(Cd.default.roots.default={}),YX=Fb.ipfs=(()=>{let r={};return r.pin=function(){let e={};return e.Set=function(){function t(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return t.prototype.version=0,t.prototype.fanout=0,t.prototype.seed=0,t.encode=function(n,s){return s||(s=fCe.create()),n.version!=null&&Object.hasOwnProperty.call(n,"version")&&s.uint32(8).uint32(n.version),n.fanout!=null&&Object.hasOwnProperty.call(n,"fanout")&&s.uint32(16).uint32(n.fanout),n.seed!=null&&Object.hasOwnProperty.call(n,"seed")&&s.uint32(29).fixed32(n.seed),s},t.decode=function(n,s){n instanceof WX||(n=WX.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new Fb.ipfs.pin.Set;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.version=n.uint32();break;case 2:a.fanout=n.uint32();break;case 3:a.seed=n.fixed32();break;default:n.skipType(c&7);break}}return a},t.fromObject=function(n){if(n instanceof Fb.ipfs.pin.Set)return n;var s=new Fb.ipfs.pin.Set;return n.version!=null&&(s.version=n.version>>>0),n.fanout!=null&&(s.fanout=n.fanout>>>0),n.seed!=null&&(s.seed=n.seed>>>0),s},t.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(o.version=0,o.fanout=0,o.seed=0),n.version!=null&&n.hasOwnProperty("version")&&(o.version=n.version),n.fanout!=null&&n.hasOwnProperty("fanout")&&(o.fanout=n.fanout),n.seed!=null&&n.hasOwnProperty("seed")&&(o.seed=n.seed),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,Cd.default.util.toJSONOptions)},t}(),e}(),r})();var eQ=R(QX()),Hb=R(Wn());f();Mr();en();we();var yg=new xe("/local/pins"),Vb=256,ZX=8192,QR=L.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),Od={direct:"direct",recursive:"recursive"};function ZR(r){return new xe(`/${ur.encode(r.multihash.bytes).toUpperCase().substring(1)}`)}Si();zb();tt();ct();vi();var JR=YX.pin.Set;function dCe(r){let e=r.Data;if(!e)throw new Error("No data present");let t=Hb.default.decode(e),i=Hb.default.decode.bytes;if(i<=0)throw new Error("Invalid Set header length");if(i+t>e.length)throw new Error("Impossibly large set header length");let n=e.slice(i,t+i),s=JR.toObject(JR.decode(n),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(s.version!==1)throw new Error(`Unsupported Set version: ${s.version}`);if(s.fanout>r.Links.length)throw new Error("Impossibly large fanout");return{header:s,data:e.slice(t+i)}}function hCe(r,e){let t=new Uint8Array(4);new DataView(t.buffer).setUint32(0,r,!0);let n=Qe(e.toString()),s=Ni([t,n],t.byteLength+n.byteLength);return(0,eQ.default)($e(s))}async function*tQ(r,e){let t=dCe(e),i=0;for(let n of e.Links){if(i<t.header.fanout){let s=n.Hash;if(!QR.equals(s)){let o=await r.get(s),a=Nt(o);yield*tQ(r,a)}}else yield n.Hash;i++}}async function*mg(r,e,t){let i=e.Links.find(o=>o.Name===t);if(!i)throw new Error("No link found with name "+t);let n=await r.get(i.Hash),s=Nt(n);yield*tQ(r,s)}function pCe(r,e){return t(e,0);async function t(i,n){let s=JR.encode({version:1,fanout:Vb,seed:n}).finish(),o=Hb.default.encode(s.length),a=Ni([o,s]),c=[];for(let l=0;l<Vb;l++)c.push({Name:"",Tsize:1,Hash:QR});if(i.length<=ZX){let l=i.map(p=>({link:{Name:"",Tsize:1,Hash:p.key},data:p.data||new Uint8Array})).sort((p,y)=>gg(p.link.Hash.bytes,y.link.Hash.bytes)),d=c.concat(l.map(p=>p.link));return{Data:Ni([a,...l.map(p=>p.data)]),Links:d}}else{let l=i.reduce((h,p)=>{let y=hCe(n,p.key)%Vb;return h[y]=y in h?h[y].concat([p]):[p],h},[]),d=0;for(let h of l){let p=await t(h,n+1);await u(p,d),d++}return{Data:a,Links:c}}async function u(l,d){let h=lt(l),p=await Lr.digest(h),y=L.createV0(p);await r.put(y,h);let g=l.Links.reduce((w,b)=>w+(b.Tsize||0),0)+h.length;c[d]={Name:"",Tsize:g,Hash:y}}}}async function eA(r,e,t){let i=await pCe(r,t.map(c=>({key:c}))),n=lt(i),s=await Lr.digest(n),o=L.createV0(s);await r.put(o,n);let a=i.Links.reduce((c,u)=>c+u.Tsize,0)+n.length;return{Name:e,Tsize:a,Hash:o}}var $b=R(pg());vi();Ji();en();async function yCe(r,e,t,i){if(!await e.has(yg))return;let n=await e.get(yg),s=L.decode(n),o=await r.get(s),a=Nt(o),c=0,u=await(0,$b.default)(mg(r,a,Od.recursive))+await(0,$b.default)(mg(r,a,Od.direct));for await(let l of mg(r,a,Od.recursive)){c++;let d={depth:1/0};l.version!==0&&(d.version=l.version),l.code!==wt&&(d.codec=l.code),await t.put(ZR(l),$n(d)),i(c/u*100,`Migrated recursive pin ${l}`)}for await(let l of mg(r,a,Od.direct)){c++;let d={depth:0};l.version!==0&&(d.version=l.version),l.code!==wt&&(d.codec=l.code),await t.put(ZR(l),$n(d)),i(c/u*100,`Migrated direct pin ${l}`)}await r.delete(s),await e.delete(yg)}async function gCe(r,e,t,i){let n=[],s=[],o=0,a=await(0,$b.default)(t.queryKeys({}));for await(let{key:h,value:p}of t.query({})){o++;let y=wi(p),g=L.create(y.version||0,y.codec||wt,fi(ur.decode("b"+h.toString().toLowerCase().split("/").pop())));y.depth===0?(i(o/a*100,`Reverted direct pin ${g}`),s.push(g)):(i(o/a*100,`Reverted recursive pin ${g}`),n.push(g))}i(100,"Updating pin root");let c={Links:[await eA(r,Od.direct,s),await eA(r,Od.recursive,n)]},u=lt(c),l=await Lr.digest(u),d=L.createV0(l);await r.put(d,u),await e.put(yg,d.bytes)}async function rQ(r,e,t){let i=r.blocks,n=r.datastore,s=r.pins;await i.open(),await n.open(),await s.open();try{await t(i,n,s,e)}finally{await s.close(),await n.close(),await i.close()}}var iQ={version:9,description:"Migrates pins to datastore",migrate:(r,e=()=>{})=>rQ(r,e,yCe),revert:(r,e=()=>{})=>rQ(r,e,gCe)};f();f();Mr();eo();var nQ=new xe("/config"),bg=new xe("/version");function wg(r){let e=r;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}async function mCe(r,e,t){let i=await e(r);if(i)return i;let n=wg(t);return n?new Promise((s,o)=>{let a=n.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{s(Boolean(a.result))}}):!1}async function bCe(r,e,t,i){if(await t(r))return e(r);let n=wg(i);if(!n)throw Ri();return new Promise((s,o)=>{let a=n.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return s(a.result);o(Ri())}})}function Gb(r){let e=r.get.bind(r),t=r.has.bind(r);return r.get=i=>bCe(i,e,t,r),r.has=i=>mCe(i,t,r),r}function tA(r){return{...r,root:Gb(r.root),datastore:Gb(r.datastore),pins:Gb(r.pins),keys:Gb(r.keys)}}ct();tt();async function wCe(r,e,t=()=>{}){let i=wg(e);if(!i){t(`${r} did not need an upgrade`);return}t(`Upgrading ${r}`),await cQ(i,(s,o)=>[{type:"del",key:s},{type:"put",key:Qe(s),value:o}])}async function _Ce(r,e,t=()=>{}){let i=wg(e);if(!i){t(`${r} did not need a downgrade`);return}t(`Downgrading ${r}`),await cQ(i,(s,o)=>[{type:"del",key:s},{type:"put",key:$e(s),value:o}])}function sQ(r){return r.child?sQ(r.child):r}async function oQ(r,e,t){let i=Object.entries(r).map(([o,a])=>({key:o,backend:sQ(a)})).filter(({key:o,backend:a})=>a.constructor.name==="LevelDatastore").map(({key:o,backend:a})=>({name:o,store:a}));e(0,`Migrating ${i.length} dbs`);let n=0,s=o=>{e(Math.round(n/i.length*100),o)};for(let{name:o,store:a}of i){await a.open();try{await t(o,a,s)}finally{n++,await a.close()}}e(100,`Migrated ${i.length} dbs`)}var aQ={version:10,description:"Migrates datastore-level keys to binary",migrate:(r,e=()=>{})=>oQ(r,e,wCe),revert:(r,e=()=>{})=>oQ(r,e,_Ce)};function cQ(r,e){function t(i,n){let s=r.store("readwrite"),o=s.transaction,a=0,c;o.onabort=()=>n(c||o.error||new Error("aborted by user")),o.oncomplete=()=>n();function u(){let l=i[a++],d=l.key,h;try{h=l.type==="del"?s.delete(d):s.put(l.value,d)}catch(p){c=p,o.abort();return}a<i.length&&(h.onsuccess=u)}u()}return new Promise((i,n)=>{let s=r.iterator(),o=c=>c;s._deserializeKey=s._deserializeValue=o,a();function a(){let c=(u,l,d)=>{if(u||l===void 0){let h=p=>{if(p){n(p);return}i()};s.end(h);return}t(e(l,d),a)};s.next(c)}})}f();Mr();var Fl=new xe("/local/filesroot");async function vCe(r,e=()=>{}){if(e(100,"Migrating MFS root to repo datastore"),await r.root.open(),await r.datastore.open(),await r.root.has(Fl)){let t=await r.root.get(Fl);await r.datastore.put(Fl,t),await r.root.delete(Fl)}await r.datastore.close(),await r.root.close(),e(100,"Stored MFS root in repo datastore")}async function ECe(r,e=()=>{}){if(e(100,"Migrating MFS root to repo root datastore"),await r.root.open(),await r.datastore.open(),await r.datastore.has(Fl)){let t=await r.datastore.get(Fl);await r.root.put(Fl,t),await r.datastore.delete(Fl)}await r.datastore.close(),await r.root.close(),e(100,"Stored MFS root in repo root datastore")}var uQ={version:11,description:"Store mfs root in the datastore",migrate:vCe,revert:ECe};f();var aA=R(Br());Mr();f();var kd=R(Br()),lQ=kd.default.Reader,SCe=kd.default.Writer,RCe=kd.default.util,Wb=kd.default.roots.default||(kd.default.roots.default={}),rA=Wb.Protocols=(()=>{function r(e){if(this.protocols=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.protocols=RCe.emptyArray,r.encode=function(t,i){if(i||(i=SCe.create()),t.protocols!=null&&t.protocols.length)for(var n=0;n<t.protocols.length;++n)i.uint32(10).string(t.protocols[n]);return i},r.decode=function(t,i){t instanceof lQ||(t=lQ.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Wb.Protocols;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(t.string());break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Wb.Protocols)return t;var i=new Wb.Protocols;if(t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Protocols.protocols: array expected");i.protocols=[];for(var n=0;n<t.protocols.length;++n)i.protocols[n]=String(t.protocols[n])}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.protocols=[]),t.protocols&&t.protocols.length){n.protocols=[];for(var s=0;s<t.protocols.length;++s)n.protocols[s]=t.protocols[s]}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,kd.default.util.toJSONOptions)},r})();f();var uu=R(Br()),O0=uu.default.Reader,iA=uu.default.Writer,Fr=uu.default.util,Yi=uu.default.roots.default||(uu.default.roots.default={}),nA=Yi.Addresses=(()=>{function r(e){if(this.addrs=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.addrs=Fr.emptyArray,r.prototype.certifiedRecord=null,r.encode=function(t,i){if(i||(i=iA.create()),t.addrs!=null&&t.addrs.length)for(var n=0;n<t.addrs.length;++n)Yi.Addresses.Address.encode(t.addrs[n],i.uint32(10).fork()).ldelim();return t.certifiedRecord!=null&&Object.hasOwnProperty.call(t,"certifiedRecord")&&Yi.Addresses.CertifiedRecord.encode(t.certifiedRecord,i.uint32(18).fork()).ldelim(),i},r.decode=function(t,i){t instanceof O0||(t=O0.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Yi.Addresses;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.addrs&&s.addrs.length||(s.addrs=[]),s.addrs.push(Yi.Addresses.Address.decode(t,t.uint32()));break;case 2:s.certifiedRecord=Yi.Addresses.CertifiedRecord.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Yi.Addresses)return t;var i=new Yi.Addresses;if(t.addrs){if(!Array.isArray(t.addrs))throw TypeError(".Addresses.addrs: array expected");i.addrs=[];for(var n=0;n<t.addrs.length;++n){if(typeof t.addrs[n]!="object")throw TypeError(".Addresses.addrs: object expected");i.addrs[n]=Yi.Addresses.Address.fromObject(t.addrs[n])}}if(t.certifiedRecord!=null){if(typeof t.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");i.certifiedRecord=Yi.Addresses.CertifiedRecord.fromObject(t.certifiedRecord)}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addrs=[]),i.defaults&&(n.certifiedRecord=null),t.addrs&&t.addrs.length){n.addrs=[];for(var s=0;s<t.addrs.length;++s)n.addrs[s]=Yi.Addresses.Address.toObject(t.addrs[s],i)}return t.certifiedRecord!=null&&t.hasOwnProperty("certifiedRecord")&&(n.certifiedRecord=Yi.Addresses.CertifiedRecord.toObject(t.certifiedRecord,i)),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,uu.default.util.toJSONOptions)},r.Address=function(){function e(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.multiaddr=Fr.newBuffer([]),e.prototype.isCertified=null;let t;return Object.defineProperty(e.prototype,"_isCertified",{get:Fr.oneOfGetter(t=["isCertified"]),set:Fr.oneOfSetter(t)}),e.encode=function(n,s){return s||(s=iA.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&s.uint32(10).bytes(n.multiaddr),n.isCertified!=null&&Object.hasOwnProperty.call(n,"isCertified")&&s.uint32(16).bool(n.isCertified),s},e.decode=function(n,s){n instanceof O0||(n=O0.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new Yi.Addresses.Address;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.multiaddr=n.bytes();break;case 2:a.isCertified=n.bool();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof Yi.Addresses.Address)return n;var s=new Yi.Addresses.Address;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?Fr.base64.decode(n.multiaddr,s.multiaddr=Fr.newBuffer(Fr.base64.length(n.multiaddr)),0):n.multiaddr.length&&(s.multiaddr=n.multiaddr)),n.isCertified!=null&&(s.isCertified=Boolean(n.isCertified)),s},e.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(s.bytes===String?o.multiaddr="":(o.multiaddr=[],s.bytes!==Array&&(o.multiaddr=Fr.newBuffer(o.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(o.multiaddr=s.bytes===String?Fr.base64.encode(n.multiaddr,0,n.multiaddr.length):s.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),n.isCertified!=null&&n.hasOwnProperty("isCertified")&&(o.isCertified=n.isCertified,s.oneofs&&(o._isCertified="isCertified")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,uu.default.util.toJSONOptions)},e}(),r.CertifiedRecord=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.seq=Fr.Long?Fr.Long.fromBits(0,0,!0):0,e.prototype.raw=Fr.newBuffer([]),e.encode=function(i,n){return n||(n=iA.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&n.uint32(8).uint64(i.seq),i.raw!=null&&Object.hasOwnProperty.call(i,"raw")&&n.uint32(18).bytes(i.raw),n},e.decode=function(i,n){i instanceof O0||(i=O0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Yi.Addresses.CertifiedRecord;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.seq=i.uint64();break;case 2:o.raw=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Yi.Addresses.CertifiedRecord)return i;var n=new Yi.Addresses.CertifiedRecord;return i.seq!=null&&(Fr.Long?(n.seq=Fr.Long.fromValue(i.seq)).unsigned=!0:typeof i.seq=="string"?n.seq=parseInt(i.seq,10):typeof i.seq=="number"?n.seq=i.seq:typeof i.seq=="object"&&(n.seq=new Fr.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0))),i.raw!=null&&(typeof i.raw=="string"?Fr.base64.decode(i.raw,n.raw=Fr.newBuffer(Fr.base64.length(i.raw)),0):i.raw.length&&(n.raw=i.raw)),n},e.toObject=function(i,n){n||(n={});var s={};if(n.defaults){if(Fr.Long){var o=new Fr.Long(0,0,!0);s.seq=n.longs===String?o.toString():n.longs===Number?o.toNumber():o}else s.seq=n.longs===String?"0":0;n.bytes===String?s.raw="":(s.raw=[],n.bytes!==Array&&(s.raw=Fr.newBuffer(s.raw)))}return i.seq!=null&&i.hasOwnProperty("seq")&&(typeof i.seq=="number"?s.seq=n.longs===String?String(i.seq):i.seq:s.seq=n.longs===String?Fr.Long.prototype.toString.call(i.seq):n.longs===Number?new Fr.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0):i.seq),i.raw!=null&&i.hasOwnProperty("raw")&&(s.raw=n.bytes===String?Fr.base64.encode(i.raw,0,i.raw.length):n.bytes===Array?Array.prototype.slice.call(i.raw):i.raw),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,uu.default.util.toJSONOptions)},e}(),r})();f();var lu=R(Br()),k0=lu.default.Reader,sA=lu.default.Writer,or=lu.default.util,Ai=lu.default.roots.default||(lu.default.roots.default={}),oA=Ai.Peer=(()=>{function r(t){if(this.addresses=[],this.protocols=[],this.metadata=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.addresses=or.emptyArray,r.prototype.protocols=or.emptyArray,r.prototype.metadata=or.emptyArray,r.prototype.pubKey=null,r.prototype.peerRecordEnvelope=null;let e;return Object.defineProperty(r.prototype,"_pubKey",{get:or.oneOfGetter(e=["pubKey"]),set:or.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_peerRecordEnvelope",{get:or.oneOfGetter(e=["peerRecordEnvelope"]),set:or.oneOfSetter(e)}),r.encode=function(i,n){if(n||(n=sA.create()),i.addresses!=null&&i.addresses.length)for(var s=0;s<i.addresses.length;++s)Ai.Address.encode(i.addresses[s],n.uint32(10).fork()).ldelim();if(i.protocols!=null&&i.protocols.length)for(var s=0;s<i.protocols.length;++s)n.uint32(18).string(i.protocols[s]);if(i.metadata!=null&&i.metadata.length)for(var s=0;s<i.metadata.length;++s)Ai.Metadata.encode(i.metadata[s],n.uint32(26).fork()).ldelim();return i.pubKey!=null&&Object.hasOwnProperty.call(i,"pubKey")&&n.uint32(34).bytes(i.pubKey),i.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(i,"peerRecordEnvelope")&&n.uint32(42).bytes(i.peerRecordEnvelope),n},r.decode=function(i,n){i instanceof k0||(i=k0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ai.Peer;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.addresses&&o.addresses.length||(o.addresses=[]),o.addresses.push(Ai.Address.decode(i,i.uint32()));break;case 2:o.protocols&&o.protocols.length||(o.protocols=[]),o.protocols.push(i.string());break;case 3:o.metadata&&o.metadata.length||(o.metadata=[]),o.metadata.push(Ai.Metadata.decode(i,i.uint32()));break;case 4:o.pubKey=i.bytes();break;case 5:o.peerRecordEnvelope=i.bytes();break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof Ai.Peer)return i;var n=new Ai.Peer;if(i.addresses){if(!Array.isArray(i.addresses))throw TypeError(".Peer.addresses: array expected");n.addresses=[];for(var s=0;s<i.addresses.length;++s){if(typeof i.addresses[s]!="object")throw TypeError(".Peer.addresses: object expected");n.addresses[s]=Ai.Address.fromObject(i.addresses[s])}}if(i.protocols){if(!Array.isArray(i.protocols))throw TypeError(".Peer.protocols: array expected");n.protocols=[];for(var s=0;s<i.protocols.length;++s)n.protocols[s]=String(i.protocols[s])}if(i.metadata){if(!Array.isArray(i.metadata))throw TypeError(".Peer.metadata: array expected");n.metadata=[];for(var s=0;s<i.metadata.length;++s){if(typeof i.metadata[s]!="object")throw TypeError(".Peer.metadata: object expected");n.metadata[s]=Ai.Metadata.fromObject(i.metadata[s])}}return i.pubKey!=null&&(typeof i.pubKey=="string"?or.base64.decode(i.pubKey,n.pubKey=or.newBuffer(or.base64.length(i.pubKey)),0):i.pubKey.length&&(n.pubKey=i.pubKey)),i.peerRecordEnvelope!=null&&(typeof i.peerRecordEnvelope=="string"?or.base64.decode(i.peerRecordEnvelope,n.peerRecordEnvelope=or.newBuffer(or.base64.length(i.peerRecordEnvelope)),0):i.peerRecordEnvelope.length&&(n.peerRecordEnvelope=i.peerRecordEnvelope)),n},r.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addresses=[],s.protocols=[],s.metadata=[]),i.addresses&&i.addresses.length){s.addresses=[];for(var o=0;o<i.addresses.length;++o)s.addresses[o]=Ai.Address.toObject(i.addresses[o],n)}if(i.protocols&&i.protocols.length){s.protocols=[];for(var o=0;o<i.protocols.length;++o)s.protocols[o]=i.protocols[o]}if(i.metadata&&i.metadata.length){s.metadata=[];for(var o=0;o<i.metadata.length;++o)s.metadata[o]=Ai.Metadata.toObject(i.metadata[o],n)}return i.pubKey!=null&&i.hasOwnProperty("pubKey")&&(s.pubKey=n.bytes===String?or.base64.encode(i.pubKey,0,i.pubKey.length):n.bytes===Array?Array.prototype.slice.call(i.pubKey):i.pubKey,n.oneofs&&(s._pubKey="pubKey")),i.peerRecordEnvelope!=null&&i.hasOwnProperty("peerRecordEnvelope")&&(s.peerRecordEnvelope=n.bytes===String?or.base64.encode(i.peerRecordEnvelope,0,i.peerRecordEnvelope.length):n.bytes===Array?Array.prototype.slice.call(i.peerRecordEnvelope):i.peerRecordEnvelope,n.oneofs&&(s._peerRecordEnvelope="peerRecordEnvelope")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,lu.default.util.toJSONOptions)},r})(),o3t=Ai.Address=(()=>{function r(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.multiaddr=or.newBuffer([]),r.prototype.isCertified=null;let e;return Object.defineProperty(r.prototype,"_isCertified",{get:or.oneOfGetter(e=["isCertified"]),set:or.oneOfSetter(e)}),r.encode=function(i,n){return n||(n=sA.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),i.isCertified!=null&&Object.hasOwnProperty.call(i,"isCertified")&&n.uint32(16).bool(i.isCertified),n},r.decode=function(i,n){i instanceof k0||(i=k0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ai.Address;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;case 2:o.isCertified=i.bool();break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof Ai.Address)return i;var n=new Ai.Address;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?or.base64.decode(i.multiaddr,n.multiaddr=or.newBuffer(or.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),i.isCertified!=null&&(n.isCertified=Boolean(i.isCertified)),n},r.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=or.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?or.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),i.isCertified!=null&&i.hasOwnProperty("isCertified")&&(s.isCertified=i.isCertified,n.oneofs&&(s._isCertified="isCertified")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,lu.default.util.toJSONOptions)},r})(),a3t=Ai.Metadata=(()=>{function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.key="",r.prototype.value=or.newBuffer([]),r.encode=function(t,i){return i||(i=sA.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&i.uint32(10).string(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(18).bytes(t.value),i},r.decode=function(t,i){t instanceof k0||(t=k0.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Ai.Metadata;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.key=t.string();break;case 2:s.value=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Ai.Metadata)return t;var i=new Ai.Metadata;return t.key!=null&&(i.key=String(t.key)),t.value!=null&&(typeof t.value=="string"?or.base64.decode(t.value,i.value=or.newBuffer(or.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.key="",i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=or.newBuffer(n.value)))),t.key!=null&&t.hasOwnProperty("key")&&(n.key=t.key),t.value!=null&&t.hasOwnProperty("value")&&(n.value=i.bytes===String?or.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,lu.default.util.toJSONOptions)},r})();f();var Dd=R(Br()),fQ=Dd.default.Reader,ACe=Dd.default.Writer,Kr=Dd.default.util,Yb=Dd.default.roots.default||(Dd.default.roots.default={}),dQ=Yb.Envelope=(()=>{function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.publicKey=Kr.newBuffer([]),r.prototype.payloadType=Kr.newBuffer([]),r.prototype.payload=Kr.newBuffer([]),r.prototype.signature=Kr.newBuffer([]),r.encode=function(t,i){return i||(i=ACe.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&i.uint32(10).bytes(t.publicKey),t.payloadType!=null&&Object.hasOwnProperty.call(t,"payloadType")&&i.uint32(18).bytes(t.payloadType),t.payload!=null&&Object.hasOwnProperty.call(t,"payload")&&i.uint32(26).bytes(t.payload),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&i.uint32(42).bytes(t.signature),i},r.decode=function(t,i){t instanceof fQ||(t=fQ.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Yb.Envelope;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.publicKey=t.bytes();break;case 2:s.payloadType=t.bytes();break;case 3:s.payload=t.bytes();break;case 5:s.signature=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Yb.Envelope)return t;var i=new Yb.Envelope;return t.publicKey!=null&&(typeof t.publicKey=="string"?Kr.base64.decode(t.publicKey,i.publicKey=Kr.newBuffer(Kr.base64.length(t.publicKey)),0):t.publicKey.length&&(i.publicKey=t.publicKey)),t.payloadType!=null&&(typeof t.payloadType=="string"?Kr.base64.decode(t.payloadType,i.payloadType=Kr.newBuffer(Kr.base64.length(t.payloadType)),0):t.payloadType.length&&(i.payloadType=t.payloadType)),t.payload!=null&&(typeof t.payload=="string"?Kr.base64.decode(t.payload,i.payload=Kr.newBuffer(Kr.base64.length(t.payload)),0):t.payload.length&&(i.payload=t.payload)),t.signature!=null&&(typeof t.signature=="string"?Kr.base64.decode(t.signature,i.signature=Kr.newBuffer(Kr.base64.length(t.signature)),0):t.signature.length&&(i.signature=t.signature)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=Kr.newBuffer(n.publicKey))),i.bytes===String?n.payloadType="":(n.payloadType=[],i.bytes!==Array&&(n.payloadType=Kr.newBuffer(n.payloadType))),i.bytes===String?n.payload="":(n.payload=[],i.bytes!==Array&&(n.payload=Kr.newBuffer(n.payload))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=Kr.newBuffer(n.signature)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?Kr.base64.encode(t.publicKey,0,t.publicKey.length):i.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.payloadType!=null&&t.hasOwnProperty("payloadType")&&(n.payloadType=i.bytes===String?Kr.base64.encode(t.payloadType,0,t.payloadType.length):i.bytes===Array?Array.prototype.slice.call(t.payloadType):t.payloadType),t.payload!=null&&t.hasOwnProperty("payload")&&(n.payload=i.bytes===String?Kr.base64.encode(t.payload,0,t.payload.length):i.bytes===Array?Array.prototype.slice.call(t.payload):t.payload),t.signature!=null&&t.hasOwnProperty("signature")&&(n.signature=i.bytes===String?Kr.base64.encode(t.signature,0,t.signature.length):i.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Dd.default.util.toJSONOptions)},r})();f();var Kl=R(Br()),Xb=Kl.default.Reader,hQ=Kl.default.Writer,ei=Kl.default.util,na=Kl.default.roots.default||(Kl.default.roots.default={}),pQ=na.PeerRecord=(()=>{function r(e){if(this.addresses=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.peerId=ei.newBuffer([]),r.prototype.seq=ei.Long?ei.Long.fromBits(0,0,!0):0,r.prototype.addresses=ei.emptyArray,r.encode=function(t,i){if(i||(i=hQ.create()),t.peerId!=null&&Object.hasOwnProperty.call(t,"peerId")&&i.uint32(10).bytes(t.peerId),t.seq!=null&&Object.hasOwnProperty.call(t,"seq")&&i.uint32(16).uint64(t.seq),t.addresses!=null&&t.addresses.length)for(var n=0;n<t.addresses.length;++n)na.PeerRecord.AddressInfo.encode(t.addresses[n],i.uint32(26).fork()).ldelim();return i},r.decode=function(t,i){t instanceof Xb||(t=Xb.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new na.PeerRecord;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.peerId=t.bytes();break;case 2:s.seq=t.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(na.PeerRecord.AddressInfo.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof na.PeerRecord)return t;var i=new na.PeerRecord;if(t.peerId!=null&&(typeof t.peerId=="string"?ei.base64.decode(t.peerId,i.peerId=ei.newBuffer(ei.base64.length(t.peerId)),0):t.peerId.length&&(i.peerId=t.peerId)),t.seq!=null&&(ei.Long?(i.seq=ei.Long.fromValue(t.seq)).unsigned=!0:typeof t.seq=="string"?i.seq=parseInt(t.seq,10):typeof t.seq=="number"?i.seq=t.seq:typeof t.seq=="object"&&(i.seq=new ei.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0))),t.addresses){if(!Array.isArray(t.addresses))throw TypeError(".PeerRecord.addresses: array expected");i.addresses=[];for(var n=0;n<t.addresses.length;++n){if(typeof t.addresses[n]!="object")throw TypeError(".PeerRecord.addresses: object expected");i.addresses[n]=na.PeerRecord.AddressInfo.fromObject(t.addresses[n])}}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addresses=[]),i.defaults)if(i.bytes===String?n.peerId="":(n.peerId=[],i.bytes!==Array&&(n.peerId=ei.newBuffer(n.peerId))),ei.Long){var s=new ei.Long(0,0,!0);n.seq=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.seq=i.longs===String?"0":0;if(t.peerId!=null&&t.hasOwnProperty("peerId")&&(n.peerId=i.bytes===String?ei.base64.encode(t.peerId,0,t.peerId.length):i.bytes===Array?Array.prototype.slice.call(t.peerId):t.peerId),t.seq!=null&&t.hasOwnProperty("seq")&&(typeof t.seq=="number"?n.seq=i.longs===String?String(t.seq):t.seq:n.seq=i.longs===String?ei.Long.prototype.toString.call(t.seq):i.longs===Number?new ei.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0):t.seq),t.addresses&&t.addresses.length){n.addresses=[];for(var o=0;o<t.addresses.length;++o)n.addresses[o]=na.PeerRecord.AddressInfo.toObject(t.addresses[o],i)}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Kl.default.util.toJSONOptions)},r.AddressInfo=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.multiaddr=ei.newBuffer([]),e.encode=function(i,n){return n||(n=hQ.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),n},e.decode=function(i,n){i instanceof Xb||(i=Xb.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new na.PeerRecord.AddressInfo;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof na.PeerRecord.AddressInfo)return i;var n=new na.PeerRecord.AddressInfo;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?ei.base64.decode(i.multiaddr,n.multiaddr=ei.newBuffer(ei.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=ei.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?ei.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Kl.default.util.toJSONOptions)},e}(),r})();var cA=R(ft());aA.default.util.Long=void 0;aA.default.configure();async function xCe(r,e=()=>{}){e(0,"Storing each peerstore key under a single datastore key"),await r.datastore.open();let t={},i=[];for await(let{key:n,value:s}of r.datastore.query({prefix:"/peers"})){i.push(n);let o=n.toString(),[a,c,u,l,d]=o.split("/");if(c==="peers"&&!!["protos","addrs","metadata","keys"].includes(u)&&!!l)if(t[l]=t[l]||{addresses:[],protocols:[],metadata:[]},u==="protos"){let h=rA.decode(s);t[l].protocols=h.protocols.sort()}else if(u==="addrs"){let h=nA.decode(s);t[l].addresses=h.addrs.sort((p,y)=>new cA.Multiaddr(p.multiaddr).toString().localeCompare(new cA.Multiaddr(y.multiaddr).toString())),h.certifiedRecord&&h.certifiedRecord.raw&&(t[l].peerRecordEnvelope=h.certifiedRecord.raw)}else u==="metadata"?t[l].metadata.push({key:d,value:s}):u==="keys"&&(t[l].pubKey=s)}e(33,"Read peer data from store");for(let n of i)await r.datastore.delete(n);e(66,"Removed existing peer data from store");for(let n of Object.keys(t)){let s=t[n];s.metadata=s.metadata.sort((a,c)=>a.key.localeCompare(c.key));let o=oA.encode(s).finish();await r.datastore.put(new xe(`/peers/${n}`),o)}await r.datastore.close(),e(100,"Stored each peerstore key under a single datastore key")}async function ICe(r,e=()=>{}){e(0,"Storing each peerstore key under a multiple datastore keys"),await r.datastore.open();let t={},i=[];for await(let{key:n,value:s}of r.datastore.query({prefix:"/peers"})){i.push(n);let o=n.toString(),[a,c,u]=o.split("/");t[u]=oA.decode(s)}e(33,"Read peer data from store");for(let n of i)await r.datastore.delete(n);e(66,"Removed existing peer data from store");for(let[n,s]of Object.entries(t)){if(s.protocols&&s.protocols.length>0&&await r.datastore.put(new xe(`/peers/protos/${n}`),rA.encode({protocols:s.protocols}).finish()),s.addresses&&s.addresses.length>0){let o=s.peerRecordEnvelope,a;if(o){let c=dQ.decode(o),u=pQ.decode(c.payload);a={raw:o,seq:u.seq}}await r.datastore.put(new xe(`/peers/addrs/${n}`),nA.encode({addrs:s.addresses,certifiedRecord:a}).finish())}if(s.metadata&&s.metadata.length>0)for(let{key:o,value:a}of s.metadata)await r.datastore.put(new xe(`/peers/metadata/${n}/${o}`),a);s.pubKey&&await r.datastore.put(new xe(`/peers/keys/${n}`),s.pubKey)}await r.datastore.close(),e(100,"Stored each peerstore key under multiple datastore keys")}var yQ={version:12,description:"Store each peerstore peer under a single datastore key",migrate:xCe,revert:ICe};var Nd={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0},Qb=[Object.assign({version:1},Nd),Object.assign({version:2},Nd),Object.assign({version:3},Nd),Object.assign({version:4},Nd),Object.assign({version:5},Nd),Object.assign({version:6},Nd),Object.assign({version:7},Nd),GX,iQ,aQ,uQ,yQ];f();f();var gQ=R(le());var uA={};Tt(uA,{InvalidValueError:()=>Eg,MissingRepoOptionsError:()=>fu,NonReversibleMigrationError:()=>_g,NotInitializedRepoError:()=>Bd,RequiredParameterError:()=>vg});f();var _g=class extends Error{constructor(e){super(e);this.name="NonReversibleMigrationError",this.code=_g.code,this.message=e}};_g.code="ERR_NON_REVERSIBLE_MIGRATION";var Bd=class extends Error{constructor(e){super(e);this.name="NotInitializedRepoError",this.code=Bd.code,this.message=e}};Bd.code="ERR_NOT_INITIALIZED_REPO";var vg=class extends Error{constructor(e){super(e);this.name="RequiredParameterError",this.code=vg.code,this.message=e}};vg.code="ERR_REQUIRED_PARAMETER";var Eg=class extends Error{constructor(e){super(e);this.name="InvalidValueError",this.code=Eg.code,this.message=e}};Eg.code="ERR_INVALID_VALUE";var fu=class extends Error{constructor(e){super(e);this.name="MissingRepoOptionsError",this.code=fu.code,this.message=e}};fu.code="ERR_MISSING_REPO_OPTIONS";var lA=(0,gQ.default)("ipfs:repo:migrator:repo:init");async function mQ(r){if(!r)throw new fu("Please pass repo options when trying to open a repo");let e=r.root;try{await e.open();let t=await e.has(bg),i=await e.has(nQ);return!t||!i?(lA(`Version entry present: ${t}`),lA(`Config entry present: ${i}`),!1):!0}catch(t){return lA("While checking if repo is initialized error was thrown: "+t.message),!1}finally{if(e!==void 0)try{await e.close()}catch{}}}ct();tt();async function fA(r){if(!await mQ(r))throw new Bd("Repo is not initialized!");let e=r.root;await e.open();try{return parseInt($e(await e.get(bg)))}finally{await e.close()}}async function Sg(r,e){if(!e)throw new fu("Please pass repo options when trying to open a repo");let t=e.root;await t.open(),await t.put(bg,Qe(String(r))),await t.close()}var bQ=R(le()),sa=(0,bQ.default)("ipfs:repo:migrator");function TCe(r){return r=r||Qb,!Array.isArray(r)||r.length===0?0:r[r.length-1].version}async function wQ(r,e,t,i,{ignoreLock:n=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||Qb,!r)throw new lo.RequiredParameterError("Path argument is required!");if(!t)throw new lo.RequiredParameterError("repoOptions argument is required!");if(!i)throw new lo.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(i)||i<=0)throw new lo.InvalidValueError("Version has to be positive integer!");e=tA(e);let c=await fA(e);if(c===i){sa("Nothing to migrate.");return}if(c>i)throw new lo.InvalidValueError(`Current repo's version (${c}) is higher then toVersion (${i}), you probably wanted to revert it?`);vQ(a,c,i);let u;!o&&!n&&(u=await t.repoLock.lock(r));try{for(let l of a){if(i!==void 0&&l.version>i)break;if(!(l.version<=c)){sa(`Migrating version ${l.version}`);try{if(!o){let d=()=>{};s&&(d=(h,p)=>s(l.version,h.toFixed(2),p)),await l.migrate(e,d)}}catch(d){let h=l.version-1;throw sa(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${h}`),await Sg(h,e),new Error(`During migration to version ${l.version} exception was raised: ${d.stack||d.message||d}`)}sa(`Migrating to version ${l.version} finished`)}}o||await Sg(i||TCe(a),e),sa("Repo successfully migrated",i!==void 0?`to version ${i}!`:"to latest version!")}finally{!o&&!n&&u&&await u.close()}}async function _Q(r,e,t,i,{ignoreLock:n=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||Qb,!r)throw new lo.RequiredParameterError("Path argument is required!");if(!t)throw new lo.RequiredParameterError("repoOptions argument is required!");if(!i)throw new lo.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(i)||i<=0)throw new lo.InvalidValueError("Version has to be positive integer!");e=tA(e);let c=await fA(e);if(c===i){sa("Nothing to revert.");return}if(c<i)throw new lo.InvalidValueError(`Current repo's version (${c}) is lower then toVersion (${i}), you probably wanted to migrate it?`);vQ(a,i,c,!0);let u;!o&&!n&&(u=await t.repoLock.lock(r)),sa(`Reverting from version ${c} to ${i}`);try{let l=a.slice().reverse();for(let d of l){if(d.version<=i)break;if(!(d.version>c)){sa(`Reverting migration version ${d.version}`);try{if(!o){let h=()=>{};s&&(h=(p,y)=>s(d.version,p.toFixed(2),y)),await d.revert(e,h)}}catch(h){let p=d.version;throw sa(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${p}`),await Sg(p,e),h.message=`During reversion to version ${d.version} exception was raised: ${h.message}`,h}sa(`Reverting to version ${d.version} finished`)}}o||await Sg(i,e),sa(`All migrations successfully reverted to version ${i}!`)}finally{!o&&!n&&u&&await u.close()}}function vQ(r,e,t,i=!1){let n=0;for(let s of r){if(s.version>t)break;if(s.version>e){if(i&&!s.revert)throw new lo.NonReversibleMigrationError(`It is not possible to revert to version ${e} because migration version ${s.version} is not reversible. Cancelling reversion.`);n++}}if(n!==t-e)throw new lo.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${e} to ${t}`)}var lo=uA;var uZ=R(RQ());f();Mr();var TQ=R(le());tt();ct();f();f();var D0=class extends Error{constructor(e){super(e);this.name="LockExistsError",this.code=D0.code}};D0.code="ERR_LOCK_EXISTS";var fo=class extends Error{constructor(e){super(e);this.name="NotFoundError",this.code=fo.code}};fo.code="ERR_NOT_FOUND";var N0=class extends Error{constructor(e){super(e);this.name="InvalidRepoVersionError",this.code=N0.code}};N0.code="ERR_INVALID_REPO_VERSION";var Ld="ERR_REPO_NOT_INITIALIZED",AQ="ERR_REPO_ALREADY_OPEN",xQ="ERR_REPO_ALREADY_CLOSED";async function Jb(r,e,t){let i=await e(r);if(i)return i;let n=IQ(t);return n?new Promise((s,o)=>{let a=n.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{s(Boolean(a.result))}}):!1}async function e5(r,e,t,i){if(await t(r))return e(r);let n=IQ(i);if(!n)throw new fo;return new Promise((s,o)=>{let a=n.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return s(a.result);o(new fo)}})}function IQ(r){let e=r;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}var DCe=(0,TQ.default)("ipfs:repo:version"),dA=new xe("version");function PQ(r){return{async exists(){return Jb(dA,r.has.bind(r),r)},async get(){let e=await e5(dA,r.get.bind(r),r.has.bind(r),r);return parseInt($e(e),10)},set(e){return r.put(dA,Qe(String(e)))},async check(e){let t=await this.get();return DCe("comparing version: %s and %s",t,e),t===e||(t===6&&e===7||e===6&&t===7)}}}f();Mr();var t5=R($o()),CQ=R(YR()),OQ=R(gR()),r5=R(Pd());tt();ct();var NCe=t5.default.default?t5.default.default:t5.default,hA=new xe("config");function kQ(r){let e=new NCe({concurrency:1}),t={async getAll(s={}){let o=await e5(hA,r.get.bind(r),r.has.bind(r),r);return JSON.parse($e(o))},async get(s,o={}){if(s==null)throw new fo(`Key ${s} does not exist in config`);let a=await this.getAll(o),c=(0,CQ.default)(a,s);if(c===void 0)throw new fo(`Key ${s} does not exist in config`);return c},set(s,o,a={}){if(typeof s!="string"&&!(s instanceof String))throw(0,r5.default)(new Error("Invalid key type: "+typeof s),"ERR_INVALID_KEY");if(o===void 0||o instanceof Uint8Array)throw(0,r5.default)(new Error("Invalid value type: "+typeof o),"ERR_INVALID_VALUE");return e.add(()=>i({key:s,value:o},a.signal))},replace(s,o={}){if(!s||s instanceof Uint8Array)throw(0,r5.default)(new Error("Invalid value type: "+typeof s),"ERR_INVALID_VALUE");return e.add(()=>i({key:void 0,value:s},o.signal))},async exists(){return Jb(hA,r.has.bind(r),r)}};return t;async function i(s,o){if(o&&o.aborted)return;let a=s.key,c=s.value;if(a){let u=await t.getAll();return typeof u=="object"&&u!==null&&(0,OQ.default)(u,a,c),n(u)}return n(c)}function n(s){let o=Qe(JSON.stringify(s,null,2));return r.put(hA,o)}}f();$p();var MQ=R(LQ());tt();ct();var yA=new xe("datastore_spec");function jQ(r){return{exists(){return r.has(yA)},async get(){let e=await r.get(yA);return JSON.parse($e(e))},async set(e){return r.put(yA,Qe(JSON.stringify((0,MQ.default)(e,{deep:!0}))))}}}f();Mr();ct();var gA=new xe("api");function qQ(r){return{async get(){let e=await r.get(gA);return e&&e.toString()},set(e){return r.put(gA,Qe(e.toString()))},delete(){return r.delete(gA)}}}f();var UQ=R(rs()),FQ=R(Xa()),KQ=R(ts());we();var VQ=R(Pd());zc();function zQ(r){return{open(){return r.open()},close(){return r.close()},query(e,t){return r.query(e,t)},queryKeys(e,t){return r.queryKeys(e,t)},async get(e,t){let i=zl(e);return i.isIdentity?Promise.resolve(i.digest):r.get(e,t)},async*getMany(e,t){for await(let i of e)yield this.get(i,t)},async put(e,t,i){let{isIdentity:n}=zl(e);n||await r.put(e,t,i)},async*putMany(e,t){let i=(0,FQ.default)();(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{await(0,KQ.default)(r.putMany(async function*(){for await(let{key:s,value:o}of e)zl(s).isIdentity||(yield{key:s,value:o}),i.push({key:s,value:o})}())),i.end()}catch(s){i.end(s)}}),yield*i},has(e,t){let{isIdentity:i}=zl(e);return i?Promise.resolve(!0):r.has(e,t)},delete(e,t){let{isIdentity:i}=zl(e);return i?Promise.resolve():r.delete(e,t)},deleteMany(e,t){return r.deleteMany((0,UQ.default)(e,i=>!zl(i).isIdentity),t)},batch(){let e=r.batch();return{put(t,i){let{isIdentity:n}=zl(t);n||e.put(t,i)},delete(t){let{isIdentity:i}=zl(t);i||e.delete(t)},commit:t=>e.commit(t)}}}}function zl(r){let e=L.asCID(r);if(e==null)throw(0,VQ.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return e.multihash.code!==ws.code?{isIdentity:!1}:{isIdentity:!0,digest:e.multihash.digest}}f();f();var HQ=R(le()),$Q=(0,HQ.default)("ipfs:repo:lock:memory"),GQ="repo.lock",Rg={};async function BCe(r){let e=r+"/"+GQ;if($Q("locking %s",e),Rg[e]===!0)throw new D0(`Lock already being held for file: ${e}`);return Rg[e]=!0,{async close(){Rg[e]&&delete Rg[e]}}}async function LCe(r){let e=r+"/"+GQ;return $Q(`checking lock: ${e}`),Boolean(Rg[e])}var i5={lock:BCe,locked:LCe};var WQ={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:i5};f();var mA={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};f();we();var QQ=R(Pd()),ZQ=R(le()),wA=R(Rd());Qu();f();Mr();rp();Vs();var YQ=R(Pd());en();Ji();function Ag(r){let e=L.asCID(r);if(e==null)throw(0,YQ.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");let t=ur.encode(e.multihash.bytes);return new xe("/"+t.slice(1).toUpperCase(),!1)}function bA(r){return fi(ur.decode(`b${r.toString().toLowerCase().substring(1)}`))}f();var XQ=R(le());var MCe=(0,XQ.default)("ipfs:repo:utils:walk-dag");async function*B0(r,e,t,i){try{let n=await e.get(r,i),s=await t(r.code),o=b0({bytes:n,cid:r,codec:s});for(let[,a]of o.links())yield a,yield*B0(a,e,t,i)}catch(n){throw MCe("Could not walk DAG for CID",r.toString(),n),n}}function jCe(r){let e=`Invalid type '${r}', must be one of {direct, indirect, recursive, all}`;return(0,QQ.default)(new Error(e),"ERR_INVALID_PIN_TYPE")}var _A=class{constructor({pinstore:e,blockstore:t,loadCodec:i}){this.pinstore=e,this.blockstore=t,this.loadCodec=i,this.log=(0,ZQ.default)("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,t={}){await this.blockstore.get(e,t);let i={depth:0};return e.version!==0&&(i.version=e.version),e.code!==wt&&(i.codec=e.code),t.metadata&&(i.metadata=t.metadata),this.pinstore.put(Ag(e),$n(i))}unpin(e,t){return this.pinstore.delete(Ag(e),t)}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);let i={depth:1/0};e.version!==0&&(i.version=e.version),e.code!==wt&&(i.codec=e.code),t.metadata&&(i.metadata=t.metadata),await this.pinstore.put(Ag(e),$n(i))}async*directKeys(e){for await(let t of this.pinstore.query({filters:[i=>wi(i.value).depth===0]})){let i=wi(t.value),n=i.version||0,s=i.codec!=null?i.codec:wt,o=bA(t.key);yield{cid:L.create(n,s,o),metadata:i.metadata}}}async*recursiveKeys(e){for await(let t of this.pinstore.query({filters:[i=>wi(i.value).depth===1/0]})){let i=wi(t.value),n=i.version||0,s=i.codec!=null?i.codec:wt,o=bA(t.key);yield{cid:L.create(n,s,o),metadata:i.metadata}}}async*indirectKeys(e){for await(let{cid:t}of this.recursiveKeys())for await(let i of B0(t,this.blockstore,this.loadCodec,e)){let n=[Ot.recursive];(await this.isPinnedWithType(i,n)).pinned||(yield i)}}async isPinnedWithType(e,t,i){Array.isArray(t)||(t=[t]);let n=t.includes(Ot.all),s=t.includes(Ot.direct),o=t.includes(Ot.recursive),a=t.includes(Ot.indirect);if(o||s||n){let l=await(0,wA.default)(this.pinstore.query({prefix:Ag(e).toString(),filters:[d=>{if(n)return!0;let h=wi(d.value);return t.includes(h.depth===0?Ot.direct:Ot.recursive)}],limit:1}));if(l){let d=wi(l.value);return{cid:e,pinned:!0,reason:d.depth===0?Ot.direct:Ot.recursive,metadata:d.metadata}}}let c=this;async function*u(l,d){for await(let{cid:h}of d)for await(let p of B0(h,c.blockstore,c.loadCodec))if(p.equals(l)){yield h;return}}if(n||a){let l=await(0,wA.default)(u(e,this.recursiveKeys()));if(l)return{cid:e,pinned:!0,reason:Ot.indirect,parent:l}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t){let i=new Set,n=async(s,o)=>{if(i.has(s.toString()))return;i.add(s.toString());let a=await this.blockstore.get(s,o),c=await this.loadCodec(s.code),u=b0({bytes:a,cid:s,codec:c});await Promise.all([...u.links()].map(([,l])=>n(l,o)))};await n(e,t)}static checkPinType(e){if(typeof e!="string"||!Object.keys(Ot).includes(e))throw jCe(e);return!0}};f();var JQ=R(bn()),eZ=R(Pd());function tZ(r,e){return{open(){return e.open()},close(){return e.close()},query(t,i){return e.query(t,i)},queryKeys(t,i){return e.queryKeys(t,i)},async get(t,i){return e.get(t,i)},async*getMany(t,i){yield*e.getMany(t,i)},async put(t,i,n){await e.put(t,i,n)},async*putMany(t,i){yield*e.putMany(t,i)},has(t,i){return e.has(t,i)},async delete(t,i){return await rZ(t,r),e.delete(t,i)},deleteMany(t,i){return e.deleteMany((0,JQ.default)(t,async n=>(await rZ(n,r),n)),i)},batch(){return e.batch()}}}async function rZ(r,e){let{pinned:t,reason:i}=await e.isPinnedWithType(r,Ot.all);if(t)throw(0,eZ.default)(new Error(`pinned: ${i}`),"ERR_BLOCK_PINNED")}var lZ=R(kb());f();we();var iZ=R(le());eo();var nZ=R(j6()),sZ=R(dr()),vA=R(Sl()),n5=R(bn()),oZ=R(rs());Mr();en();var xg=(0,iZ.default)("ipfs:repo:gc"),qCe=Ri().code,UCe=256,FCe=new xe("/local/filesroot");function aZ({gcLock:r,pins:e,blockstore:t,root:i,loadCodec:n}){async function*s(){let o=Date.now();xg("Creating set of marked blocks");let a=await r.writeLock();try{let c=await KCe({pins:e,blockstore:t,root:i,loadCodec:n}),u=t.queryKeys({});yield*VCe({blockstore:t},c,u),xg(`Complete (${Date.now()-o}ms)`)}finally{a()}}return s}async function KCe({pins:r,blockstore:e,loadCodec:t,root:i}){let n=async function*(){let a;try{a=await i.get(FCe)}catch(u){if(u.code===qCe){xg("No blocks in MFS");return}throw u}let c=L.decode(a);yield c,yield*B0(c,e,t)}(),s=(0,vA.default)((0,n5.default)(r.recursiveKeys(),({cid:a})=>a),r.indirectKeys(),(0,n5.default)(r.directKeys(),({cid:a})=>a),n),o=new Set;for await(let a of(0,vA.default)(s,n))o.add(ur.encode(a.multihash.bytes));return o}async function*VCe({blockstore:r},e,t){let i=0,n=0;yield*(0,sZ.pipe)((0,nZ.default)((0,n5.default)(t,async o=>async function(){i++;try{let c=ur.encode(o.multihash.bytes);if(e.has(c))return null;try{await r.delete(o),n++}catch(u){return{err:new Error(`Could not delete block with CID ${o}: ${u.message}`)}}return{cid:o}}catch(c){let u=`Could delete block with CID ${o}`;return xg(u,c),{err:new Error(u+`: ${c.message}`)}}}),UCe),o=>(0,oZ.default)(o,Boolean)),xg(`Marked set has ${e.size} unique blocks. Blockstore has ${i} blocks. Deleted ${n} blocks.`)}var ss=(0,cZ.default)("ipfs:repo"),zCe=Number.MAX_SAFE_INTEGER,HCe="repoAutoMigrate",fZ=class{constructor(e,t,i,n){if(typeof e!="string")throw new Error("missing repo path");if(typeof t!="function")throw new Error("missing codec loader");this.options=Pt(WQ,n),this.closed=!0,this.path=e,this.root=i.root,this.datastore=i.datastore,this.keys=i.keys;let s=i.blocks,o=i.pins;this.pins=new _A({pinstore:o,blockstore:s,loadCodec:t});let a=tZ(this.pins,s);this.blocks=zQ(a),this.version=PQ(this.root),this.config=kQ(this.root),this.spec=jQ(this.root),this.apiAddr=qQ(this.root),this.gcLock=(0,lZ.default)(e,{singleProcess:this.options.repoOwner!==!1}),this.gc=aZ({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:t})}async init(e){ss("initializing at: %s",this.path),await this._openRoot(),await this.config.replace($Ce(e)),await this.spec.set(GCe(e)),await this.version.set(C0)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch(e){return!1}}async open(){if(!this.closed)throw(0,Md.default)(new Error("repo is already open"),AQ);ss("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),ss("acquired repo.lock"),!await this.version.check(C0))if(await this._isAutoMigrationEnabled())await this._migrate(C0,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new N0("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");ss("creating datastore"),await this.datastore.open(),ss("creating blocks"),await this.blocks.open(),ss("creating keystore"),await this.keys.open(),ss("creating pins"),await this.pins.pinstore.open(),this.closed=!1,ss("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(t){ss("error removing lock",t)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(){let e=await this.options.repoLock.lock(this.path);if(typeof e.close!="function")throw(0,Md.default)(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){ss("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(t){throw t.code==="ERR_NOT_FOUND"?(0,Md.default)(new Error("repo is not initialized yet"),Ld,{path:this.path}):t}if(!e)throw(0,Md.default)(new Error("repo is not initialized yet"),Ld,{path:this.path})}async close(){if(this.closed)throw(0,Md.default)(new Error("repo is already closed"),xQ);ss("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==Ld&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(e=>e&&e.close())),ss("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[e,t,i,n,s]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),dZ(this.datastore),dZ(this.keys)]),o=t.size+n+s;return{repoPath:this.path,storageMax:e,version:i,numObjects:t.count,repoSize:o}}throw(0,Md.default)(new Error("repo is not initialized yet"),Ld,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(HCe)}catch(t){if(t.code===fo.code)e=!0;else throw t}return e}async _migrate(e,t){return await this.version.get()>e?(ss(`reverting to version ${e}`),_Q(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(ss(`migrating to version ${e}`),wQ(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let e=await this.config.get("Datastore.StorageMax");return BigInt((0,uZ.default)(e))}catch(e){return BigInt(zCe)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(let{key:i,value:n}of this.blocks.query({}))e+=BigInt(1),t+=BigInt(n.byteLength),t+=BigInt(i.bytes.byteLength);return{count:e,size:t}}};async function dZ(r){let e=BigInt(0);for await(let t of r.query({}))e+=BigInt(t.value.byteLength),e+=BigInt(t.key.uint8Array().byteLength);return e}function hZ(r,e,t,i){return new fZ(r,e,t,i)}function $Ce(r){return r.Datastore=Object.assign({},mA,(0,EA.default)(r,"datastore")),r}function GCe(r){let e={...mA.Spec,...(0,EA.default)(r,"Datastore.Spec")};return{type:e.type,mounts:e.mounts.map(t=>({mountpoint:t.mountpoint,type:t.child.type,path:t.child.path,shardFunc:t.child.shardFunc}))}}f();$p();b6();var Vg=R(rs()),Vee=R(bn()),Cx=R(ad()),Ox=R(SA()),zee=R(Kee()),Yd=class extends nn{constructor(e,t){super();this.path=e,this.opts=t,t&&t.db?(this.database=t.db,delete t.db):this.database=zee.default}_initDb(){return new Promise((e,t)=>{this.db=this.database(this.path,{...this.opts,valueEncoding:"binary",compression:!1},i=>{if(i)return t(i);e(this.db)})})}async open(){try{this.db?await this.db.open():this.db=await this._initDb()}catch(e){throw fd.dbOpenFailedError(e)}}async put(e,t){try{await this.db.put(e.toString(),t)}catch(i){throw fd.dbWriteFailedError(i)}}async get(e){let t;try{t=await this.db.get(e.toString())}catch(i){throw i.notFound?fd.notFoundError(i):fd.dbWriteFailedError(i)}return t}async has(e){try{await this.db.get(e.toString())}catch(t){if(t.notFound)return!1;throw t}return!0}async delete(e){try{await this.db.del(e.toString())}catch(t){throw fd.dbDeleteFailedError(t)}}close(){return this.db&&this.db.close()}batch(){let e=[];return{put:(t,i)=>{e.push({type:"put",key:t.toString(),value:i})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce((s,o)=>(0,Vg.default)(s,o),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((s,o)=>(0,Ox.default)(s,o),t));let{offset:i,limit:n}=e;if(i){let s=0;t=(0,Vg.default)(t,()=>s++>=i)}return n&&(t=(0,Cx.default)(t,n)),t}queryKeys(e){let t=(0,Vee.default)(this._query({values:!1,prefix:e.prefix}),({key:s})=>s);Array.isArray(e.filters)&&(t=e.filters.reduce((s,o)=>(0,Vg.default)(s,o),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((s,o)=>(0,Ox.default)(s,o),t));let{offset:i,limit:n}=e;if(i){let s=0;t=(0,Vg.default)(t,()=>s++>=i)}return n&&(t=(0,Cx.default)(t,n)),t}_query(e){let t={keys:!0,keyAsBuffer:!0,values:e.values};if(e.prefix!=null){let i=e.prefix.toString();t.gte=i,t.lt=i+"\xFF"}return cNe(this.db.iterator(t))}};function cNe(r){return{[Symbol.asyncIterator](){return{next:()=>new Promise((e,t)=>{r.next((i,n,s)=>{if(i)return t(i);if(n==null)return r.end(o=>{if(o)return t(o);e({done:!0,value:void 0})});e({done:!1,value:{key:new xe(n,!1),value:s}})})}),return:()=>new Promise((e,t)=>{r.end(i=>{if(i)return t(i);e({done:!0,value:void 0})})})}}}}f();var Nx=R(ts()),Bx=R(Xa());Mr();we();Vs();Ji();en();di();var Xee=R(Gee());f();var kx=R(ts()),Xd=R(rs()),Dx=R(ad()),Wee=R(Zo()),Yee=(r,e)=>async function*(){yield*(await(0,Wee.default)(r)).sort(e)}(),mu=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,i){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:i,value:n}of e)await this.put(i,n,t),yield{key:i,value:n}}async*getMany(e,t={}){for await(let i of e)yield this.get(i,t)}async*deleteMany(e,t={}){for await(let i of e)await this.delete(i,t),yield i}batch(){let e=[],t=[];return{put(i,n){e.push({key:i,value:n})},delete(i){t.push(i)},commit:async i=>{await(0,kx.default)(this.putMany(e,i)),e=[],await(0,kx.default)(this.deleteMany(t,i)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let i=this._all(e,t);if(e.prefix!=null&&(i=(0,Xd.default)(i,n=>n.key.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>(0,Xd.default)(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>Yee(n,s),i)),e.offset!=null){let n=0;i=(0,Xd.default)(i,()=>n++>=(e.offset||0))}return e.limit!=null&&(i=(0,Dx.default)(i,e.limit)),i}queryKeys(e,t){let i=this._allKeys(e,t);if(e.prefix!=null&&(i=(0,Xd.default)(i,n=>n.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>(0,Xd.default)(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>Yee(n,s),i)),e.offset!=null){let n=0;i=(0,Xd.default)(i,()=>n++>=e.offset)}return e.limit!=null&&(i=(0,Dx.default)(i,e.limit)),i}};function Y0(r){let e=L.asCID(r);if(!e)throw(0,Xee.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return new xe("/"+ur.encode(e.multihash.bytes).slice(1).toUpperCase(),!1)}function Ql(r){return L.createV1(Di,fi(ur.decode("b"+r.toString().slice(1).toLowerCase())))}function Lx(r){let e=r.substring(0,1);if(e==="/")return Lx(r.substring(1));let t;e.toLowerCase()==="b"?t=s=>ur.decode(s.toLowerCase()).subarray(2):e.toLowerCase()==="c"?t=s=>fv.decode(s.toLowerCase()).subarray(2):e==="z"?t=s=>yt.decode(s).subarray(2):e==="Q"?t=s=>yt.decode("z"+s):t=s=>ur.decode("b"+s.toLowerCase()).subarray(2);let i;for(let s=1;s<r.length;s++)try{i=t(r.substring(0,s))}catch(o){if(o.message!=="Unexpected end of data")throw o}let n="/C";return i&&(n=`/${ur.encode(i).slice(1,-1).toUpperCase()||"C"}`),n}function lNe(r){return{...r,prefix:r.prefix?Lx(r.prefix):void 0,filters:r.filters?r.filters.map(e=>t=>e({key:Ql(t.key),value:t.value})):void 0,orders:r.orders?r.orders.map(e=>(t,i)=>e({key:Ql(t.key),value:t.value},{key:Ql(i.key),value:i.value})):void 0}}function fNe(r){return{...r,prefix:r.prefix?Lx(r.prefix):void 0,filters:r.filters?r.filters.map(e=>t=>e(Ql(t))):void 0,orders:r.orders?r.orders.map(e=>(t,i)=>e(Ql(t),Ql(i))):void 0}}var Mx=class extends mu{constructor(e){super();this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,t){for await(let{key:i,value:n}of this.child.query(lNe(e),t))yield{key:Ql(i),value:n}}async*queryKeys(e,t){for await(let i of this.child.queryKeys(fNe(e),t))yield Ql(i)}async get(e,t){return this.child.get(Y0(e),t)}async*getMany(e,t){for await(let i of e)yield this.get(i,t)}async put(e,t,i){await this.child.put(Y0(e),t,i)}async*putMany(e,t){let i=(0,Bx.default)();(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{let s=this.child;await(0,Nx.default)(this.child.putMany(async function*(){for await(let o of e){let a=Y0(o.key);await s.has(a,t)||(yield{key:a,value:o.value}),i.push(o)}}())),i.end()}catch(s){i.end(s)}}),yield*i}has(e,t){return this.child.has(Y0(e),t)}delete(e,t){return this.child.delete(Y0(e),t)}deleteMany(e,t){let i=(0,Bx.default)();return(0,Nx.default)(this.child.deleteMany(async function*(){for await(let n of e)yield Y0(n),i.push(n);i.end()}(),t)).catch(n=>{i.end(n)}),i}};function Qee(r,e,t){let i=t.path||"ipfs";return hZ(i,n=>e.getCodec(n),{root:new Yd(i,{prefix:"",version:2}),blocks:new Mx(new Yd(`${i}/blocks`,{prefix:"",version:2})),datastore:new Yd(`${i}/datastore`,{prefix:"",version:2}),keys:new Yd(`${i}/keys`,{prefix:"",version:2}),pins:new Yd(`${i}/pins`,{prefix:"",version:2})},{autoMigrate:t.autoMigrate,onMigrationProgress:t.onMigrationProgress||r,repoLock:i5})}ct();tt();var __=R(ot());f();var $t=R(A2());var wme=R(St());f();var Wre=R(pI()),yI={gossipsub:Wre.default};var _me=R(tie()),vme=R(aie());f();f();var iLe=r=>Promise.reject(new Error(`No base found for "${r}"`)),Yg=class{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||iLe;for(let t of e.bases)this.addBase(t)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];let t=await this._loadBase(e);return this._basesByName[t.name]==null&&this._basesByPrefix[t.prefix]==null&&this.addBase(t),t}listBases(){return Object.values(this._basesByName)}};f();var nLe=r=>Promise.reject(new Error(`No codec found for "${r}"`)),Xg=class{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||nLe;for(let t of e.codecs)this.addCodec(t)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){let t=typeof e=="string"?this._codecsByName:this._codecsByCode;if(t[e])return t[e];let i=await this._loadCodec(e);return t[e]==null&&this.addCodec(i),i}listCodecs(){return Object.values(this._codecsByName)}};f();var sLe=r=>Promise.reject(new Error(`No hasher found for "${r}"`)),Qg=class{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||sLe;for(let t of e.hashers)this.addHasher(t)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){let t=typeof e=="string"?this._hashersByName:this._hashersByCode;if(t[e])return t[e];let i=await this._loadHasher(e);return t[e]==null&&this.addHasher(i),i}listHashers(){return Object.values(this._hashersByName)}};var kLe=R(zv());zc();$3();f();f();we();f();f();var mI=R(ft()),gc=R(cy());var fie=R(le()),eh=R(vp());f();var cie=R(ft()),uie=R(Tb());function gI(r){try{r=(0,uie.default)(new cie.Multiaddr(r))}catch(e){}return r=r.toString(),r}f();var lie=()=>{};var die=(0,fie.default)("ipfs-http-client:lib:error-handler"),oLe=Pt.bind({ignoreUndefined:!0}),aLe=gc.isBrowser||gc.isWebWorker?location.protocol:"http",cLe=gc.isBrowser||gc.isWebWorker?location.hostname:"localhost",uLe=gc.isBrowser||gc.isWebWorker?location.port:"5001",lLe=(r={})=>{let e,t={},i;if(typeof r=="string"||mI.Multiaddr.isMultiaddr(r))e=new URL(gI(r));else if(r instanceof URL)e=r;else if(typeof r.url=="string"||mI.Multiaddr.isMultiaddr(r.url))e=new URL(gI(r.url)),t=r;else if(r.url instanceof URL)e=r.url,t=r;else{t=r||{};let n=(t.protocol||aLe).replace(":",""),s=(t.host||cLe).split(":")[0],o=t.port||uLe;e=new URL(`${n}://${s}:${o}`)}if(t.apiPath?e.pathname=t.apiPath:(e.pathname==="/"||e.pathname===void 0)&&(e.pathname="api/v0"),gc.isNode){let n=lie(e);i=t.agent||new n({keepAlive:!0,maxSockets:6})}return{...t,host:e.host,protocol:e.protocol.replace(":",""),port:Number(e.port),apiPath:e.pathname,url:e,agent:i}},fLe=async r=>{let e;try{if((r.headers.get("Content-Type")||"").startsWith("application/json")){let i=await r.json();die(i),e=i.Message||i.message}else e=await r.text()}catch(i){die("Failed to parse error response",i),e=i.message}let t=new eh.default.HTTPError(r);throw e&&(e.includes("deadline has elapsed")&&(t=new eh.default.TimeoutError),e&&e.includes("context deadline exceeded")&&(t=new eh.default.TimeoutError)),e&&e.includes("request timed out")&&(t=new eh.default.TimeoutError),e&&(t.message=e),t},dLe=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,hie=r=>r.replace(dLe,function(e){return"-"+e.toLowerCase()}),hLe=r=>typeof r=="string"?il(r):r,th=class extends eh.default{constructor(e={}){let t=lLe(e);super({timeout:hLe(t.timeout||0)||void 0,headers:t.headers,base:`${t.url}`,handleError:fLe,transformSearchParams:n=>{let s=new URLSearchParams;for(let[o,a]of n)a!=="undefined"&&a!=="null"&&o!=="signal"&&s.append(hie(o),a),o==="timeout"&&!isNaN(a)&&s.append(hie(o),a);return s},agent:t.agent});delete this.get,delete this.put,delete this.delete,delete this.options;let i=this.fetch;this.fetch=(n,s={})=>(typeof n=="string"&&!n.startsWith("/")&&(n=`${t.url}/${n}`),i.call(this,n,oLe(s,{method:"POST"})))}},T5t=eh.default.HTTPError;var q=r=>e=>r(new th(e),e);f();f();function iw(r){if(r!=null)return typeof r=="string"?r:r.toString(8).padStart(4,"0")}f();var gie=R(rh());function nw(r){if(r==null)return;let e;if(r.secs!=null&&(e={secs:r.secs,nsecs:r.nsecs}),r.Seconds!=null&&(e={secs:r.Seconds,nsecs:r.FractionalNanoseconds}),Array.isArray(r)&&(e={secs:r[0],nsecs:r[1]}),r instanceof Date){let t=r.getTime(),i=Math.floor(t/1e3);e={secs:i,nsecs:(t-i*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw(0,gie.default)(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}function K({arg:r,searchParams:e,hashAlg:t,mtime:i,mode:n,...s}={}){e&&(s={...s,...e}),t&&(s.hash=t),i!=null&&(i=nw(i),s.mtime=i.secs,s.mtimeNsecs=i.nsecs),n!=null&&(s.mode=iw(n)),s.timeout&&!isNaN(s.timeout)&&(s.timeout=`${s.timeout}ms`),r==null?r=[]:Array.isArray(r)||(r=[r]);let o=new URLSearchParams(s);return r.forEach(a=>o.append("arg",a)),o}var mie=q(r=>{async function e(t={}){return((await(await r.post("bitswap/wantlist",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()).Keys||[]).map(n=>L.parse(n["/"]))}return e});f();we();var bie=q(r=>{async function e(t,i={}){return((await(await r.post("bitswap/wantlist",{signal:i.signal,searchParams:K({...i,peer:t.toString()}),headers:i.headers})).json()).Keys||[]).map(s=>L.parse(s["/"]))}return e});f();we();var sw=q(r=>{async function e(t={}){let i=await r.post("bitswap/stat",{searchParams:K(t),signal:t.signal,headers:t.headers});return yLe(await i.json())}return e});function yLe(r){return{provideBufLen:r.ProvideBufLen,wantlist:(r.Wantlist||[]).map(e=>L.parse(e["/"])),peers:r.Peers||[],blocksReceived:BigInt(r.BlocksReceived),dataReceived:BigInt(r.DataReceived),blocksSent:BigInt(r.BlocksSent),dataSent:BigInt(r.DataSent),dupBlksReceived:BigInt(r.DupBlksReceived),dupDataReceived:BigInt(r.DupDataReceived)}}f();var wie=q(r=>{async function e(t,i={}){return(await r.post("bitswap/unwant",{signal:i.signal,searchParams:K({arg:t.toString(),...i}),headers:i.headers})).json()}return e});function _ie(r){return{wantlist:mie(r),wantlistForPeer:bie(r),unwant:wie(r),stat:sw(r)}}f();f();var ow=q(r=>{async function e(t,i={}){let n=await r.post("block/get",{signal:i.signal,searchParams:K({arg:t.toString(),...i}),headers:i.headers});return new Uint8Array(await n.arrayBuffer())}return e});f();we();f();f();f();var vie=R(Kf()),Eie=R(t0()),Sie=R(e0()),Rie=R(Zo());async function Aie(r){if(so(r))return new Blob([r]);if(typeof r=="string"||r instanceof String)return new Blob([r.toString()]);if(ru(r))return r;if(iu(r)&&(r=(0,Sie.default)(r)),Symbol.iterator in r||Symbol.asyncIterator in r){let e=(0,Eie.default)(r),{value:t,done:i}=await e.peek();if(i)return xie(e);if(e.push(t),Number.isInteger(t))return new Blob([Uint8Array.from(await(0,Rie.default)(e))]);if(so(t)||typeof t=="string"||t instanceof String)return xie(e)}throw(0,vie.default)(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT")}async function xie(r){let e=[];for await(let t of r)e.push(t);return new Blob(e)}function Iie(r){return $6(r,Aie,!0)}f();function Tie(r){if(r!=null)return typeof r=="string"?r:r.toString(8).padStart(4,"0")}async function Ti(r,e,t={}){let i=[],n=new FormData,s=0,o=0;for await(let{content:a,path:c,mode:u,mtime:l}of Iie(r)){let d="",h=a?"file":"dir";s>0&&(d=`-${s}`);let p=h+d,y=[];if(u!=null&&y.push(`mode=${Tie(u)}`),l!=null){let{secs:g,nsecs:w}=l;y.push(`mtime=${g}`),w!=null&&y.push(`mtime-nsecs=${w}`)}if(y.length&&(p=`${p}?${y.join("&")}`),a){n.set(p,a,c!=null?encodeURIComponent(c):void 0);let g=o+a.size;i.push({name:c,start:o,end:g}),o=g}else if(c!=null)n.set(p,new File([""],encodeURIComponent(c),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");s++}return{total:o,parts:i,headers:t,body:n}}f();var Pie=R(Ho());function gLe(r){return r.filter(Boolean)}function Pi(...r){return(0,Pie.anySignal)(gLe(r))}var Cie=q(r=>{async function e(t,i={}){let n=new AbortController,s=Pi(n.signal,i.signal),o;try{o=await(await r.post("block/put",{signal:s,searchParams:K(i),...await Ti([t],n,i.headers)})).json()}catch(a){if(i.format==="dag-pb")return e(t,{...i,format:"protobuf"});if(i.format==="dag-cbor")return e(t,{...i,format:"cbor"});throw a}return L.parse(o.Key)}return e});f();we();var Oie=q(r=>{async function*e(t,i={}){Array.isArray(t)||(t=[t]);let n=await r.post("block/rm",{signal:i.signal,searchParams:K({arg:t.map(s=>s.toString()),"stream-channels":!0,...i}),headers:i.headers});for await(let s of n.ndjson())yield mLe(s)}return e});function mLe(r){let e={cid:L.parse(r.Hash)};return r.Error&&(e.error=new Error(r.Error)),e}f();we();var kie=q(r=>{async function e(t,i={}){let s=await(await r.post("block/stat",{signal:i.signal,searchParams:K({arg:t.toString(),...i}),headers:i.headers})).json();return{cid:L.parse(s.Key),size:s.Size}}return e});function Die(r){return{get:ow(r),put:Cie(r),rm:Oie(r),stat:kie(r)}}f();f();var Nie=R(ft()),Bie=q(r=>{async function e(t,i={}){let n=await r.post("bootstrap/add",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new Nie.Multiaddr(o))}}return e});f();var Lie=R(ft()),Mie=q(r=>{async function e(t={}){let i=await r.post("bootstrap/rm",{signal:t.signal,searchParams:K({...t,all:!0}),headers:t.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new Lie.Multiaddr(s))}}return e});f();var jie=R(ft()),qie=q(r=>{async function e(t={}){let i=await r.post("bootstrap/list",{signal:t.signal,searchParams:K(t),headers:t.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new jie.Multiaddr(s))}}return e});f();var Uie=R(ft()),Fie=q(r=>{async function e(t={}){let i=await r.post("bootstrap/add",{signal:t.signal,searchParams:K({...t,default:!0}),headers:t.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new Uie.Multiaddr(s))}}return e});f();var Kie=R(ft()),Vie=q(r=>{async function e(t,i={}){let n=await r.post("bootstrap/rm",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new Kie.Multiaddr(o))}}return e});function zie(r){return{add:Bie(r),clear:Mie(r),list:qie(r),reset:Fie(r),rm:Vie(r)}}f();f();f();var Hie=q(r=>{async function e(t,i={}){let s=await(await r.post("config/profile/apply",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).json();return{original:s.OldCfg,updated:s.NewCfg}}return e});f();f();function Dt(r){if(r==null)return r;let e=/^[A-Z]+$/,t={};return Object.keys(r).reduce((i,n)=>(e.test(n)?i[n.toLowerCase()]=r[n]:e.test(n[0])?i[n[0].toLowerCase()+n.slice(1)]=r[n]:i[n]=r[n],i),t)}var $ie=q(r=>{async function e(t={}){return(await(await r.post("config/profile/list",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()).map(s=>Dt(s))}return e});function Gie(r){return{apply:Hie(r),list:$ie(r)}}f();var Wie=q(r=>async(t,i={})=>{if(!t)throw new Error("key argument is required");return(await(await r.post("config",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).json()).Value});f();var Yie=q(r=>async(t={})=>await(await r.post("config/show",{signal:t.signal,searchParams:K({...t}),headers:t.headers})).json());f();ct();var Xie=q(r=>async(t,i={})=>{let n=new AbortController,s=Pi(n.signal,i.signal);await(await r.post("config/replace",{signal:s,searchParams:K(i),...await Ti([Qe(JSON.stringify(t))],n,i.headers)})).text()});f();var Qie=q(r=>async(t,i,n={})=>{if(typeof t!="string")throw new Error("Invalid key type");let s={...n,...bLe(t,i)};await(await r.post("config",{signal:n.signal,searchParams:K(s),headers:n.headers})).text()}),bLe=(r,e)=>{switch(typeof e){case"boolean":return{arg:[r,e.toString()],bool:!0};case"string":return{arg:[r,e]};default:return{arg:[r,JSON.stringify(e)],json:!0}}};function Zie(r){return{getAll:Yie(r),get:Wie(r),set:Qie(r),replace:Xie(r),profiles:Gie(r)}}f();f();var Jie=q(r=>{async function*e(t,i={}){yield*(await r.post("dag/export",{signal:i.signal,searchParams:K({arg:t.toString()}),headers:i.headers})).iterator()}return e});f();f();we();var bI=R(rh());async function*wI(r,e,t,i,n){let s=async u=>{let l=await t.getCodec(u.code),d=await i(u,n);return l.decode(d)},o=e.split("/").filter(Boolean),a=await s(r),c=r;for(;o.length;){let u=o.shift();if(!u)throw(0,bI.default)(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(a,u))a=a[u],yield{value:a,remainderPath:o.join("/")};else throw(0,bI.default)(new Error(`no link named "${u}" under ${c}`),"ERR_NO_LINK");let l=L.asCID(a);l&&(c=l,a=await s(a))}yield{value:a,remainderPath:""}}var ene=R(Rd()),tne=R(Qn()),rne=R(rh());var ine=(r,e)=>q((i,n)=>{let s=ow(n);return async(a,c={})=>{if(c.path){let p=c.localResolve?await(0,ene.default)(wI(a,c.path,r,s,c)):await(0,tne.default)(wI(a,c.path,r,s,c));if(!p)throw(0,rne.default)(new Error("Not found"),"ERR_NOT_FOUND");return p}let u=await r.getCodec(a.code),l=await s(a,c);return{value:u.decode(l),remainderPath:""}}})(e);f();we();var nne=q(r=>{async function*e(t,i={}){let n=new AbortController,s=Pi(n.signal,i.signal),{headers:o,body:a}=await Ti(t,n,i.headers),c=await r.post("dag/import",{signal:s,headers:o,body:a,searchParams:K({"pin-roots":i.pinRoots})});for await(let{Root:u}of c.ndjson())if(u!==void 0){let{Cid:{"/":l},PinErrorMsg:d}=u;yield{root:{cid:L.parse(l),pinErrorMsg:d}}}}return e});f();we();var aw=(r,e)=>q(i=>async(s,o={})=>{let a={storeCodec:"dag-cbor",hashAlg:"sha2-256",...o},c;if(a.inputCodec){if(!(s instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");c=s}else c=(await r.getCodec(a.storeCodec)).encode(s),a.inputCodec=a.storeCodec;let u=new AbortController,l=Pi(u.signal,a.signal),h=await(await i.post("dag/put",{timeout:a.timeout,signal:l,searchParams:K(a),...await Ti([c],u,a.headers)})).json();return L.parse(h.Cid["/"])})(e);f();we();var sne=q(r=>async(t,i={})=>{let s=await(await r.post("dag/resolve",{signal:i.signal,searchParams:K({arg:`${t}${i.path?`/${i.path}`.replace(/\/[/]+/g,"/"):""}`,...i}),headers:i.headers})).json();return{cid:L.parse(s.Cid["/"]),remainderPath:s.RemPath}});function one(r,e){return{export:Jie(e),get:ine(r,e),import:nne(e),put:aw(r,e),resolve:sne(e)}}f();f();f();ct();f();var ane=0,cne=1,une=2,lne=3,fne=4,dne=5,hne=6,pne=7;var Zg=R(ft()),mo=r=>{if(r.Type===ane)return{to:r.ID,name:"SENDING_QUERY",type:r.Type};if(r.Type===cne)return{from:r.ID,name:"PEER_RESPONSE",type:r.Type,messageType:0,messageName:"PUT_VALUE",closer:(r.Responses||[]).map(({ID:e,Addrs:t})=>({id:e,multiaddrs:t.map(i=>new Zg.Multiaddr(i))})),providers:(r.Responses||[]).map(({ID:e,Addrs:t})=>({id:e,multiaddrs:t.map(i=>new Zg.Multiaddr(i))}))};if(r.Type===une){let e={id:r.ID,multiaddrs:[]};return r.Responses&&r.Responses.length&&(e={id:r.Responses[0].ID,multiaddrs:r.Responses[0].Addrs.map(t=>new Zg.Multiaddr(t))}),{from:r.ID,name:"FINAL_PEER",type:r.Type,peer:e}}if(r.Type===lne)return{from:r.ID,name:"QUERY_ERROR",type:r.Type,error:new Error(r.Extra)};if(r.Type===fne)return{from:r.ID,name:"PROVIDER",type:r.Type,providers:r.Responses.map(({ID:e,Addrs:t})=>({id:e,multiaddrs:t.map(i=>new Zg.Multiaddr(i))}))};if(r.Type===dne)return{from:r.ID,name:"VALUE",type:r.Type,value:Qe(r.Extra,"base64pad")};if(r.Type===hne){let e=r.Responses.map(({ID:t})=>t);if(!e.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:r.Type,peer:e[0]}}if(r.Type===pne)return{name:"DIALING_PEER",type:r.Type,peer:r.ID};throw new Error("Unknown DHT event type")};var yne=q(r=>{async function*e(t,i={}){let n=await r.post("dht/findpeer",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers});for await(let s of n.ndjson())yield mo(s)}return e});f();var gne=q(r=>{async function*e(t,i={}){let n=await r.post("dht/findprovs",{signal:i.signal,searchParams:K({arg:t.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())yield mo(s)}return e});f();tt();var mne=q(r=>{async function*e(t,i={}){let n=await r.post("dht/get",{signal:i.signal,searchParams:K({arg:t instanceof Uint8Array?$e(t):t.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())yield mo(s)}return e});f();var bne=q(r=>{async function*e(t,i={recursive:!1}){let n=Array.isArray(t)?t:[t],s=await r.post("dht/provide",{signal:i.signal,searchParams:K({arg:n.map(o=>o.toString()),...i}),headers:i.headers});for await(let o of s.ndjson())yield mo(o)}return e});f();tt();var wne=q(r=>{async function*e(t,i,n={}){let s=new AbortController,o=Pi(s.signal,n.signal),a=await r.post("dht/put",{signal:o,searchParams:K({arg:t instanceof Uint8Array?$e(t):t.toString(),...n}),...await Ti([i],s,n.headers)});for await(let c of a.ndjson())yield mo(c)}return e});f();var _ne=q(r=>{async function*e(t,i={}){let n=await r.post("dht/query",{signal:i.signal,searchParams:K({arg:t.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())yield mo(s)}return e});function vne(r){return{findPeer:yne(r),findProvs:gne(r),get:mne(r),provide:bne(r),put:wne(r),query:_ne(r)}}f();f();var Ene=q(r=>{async function e(t={}){return(await r.post("diag/cmds",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()}return e});f();var Sne=q(r=>{async function e(t={}){return(await r.post("diag/net",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()}return e});f();var Rne=q(r=>{async function e(t={}){return(await r.post("diag/sys",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()}return e});function Ane(r){return{cmds:Ene(r),net:Sne(r),sys:Rne(r)}}f();f();var xne=q(r=>{async function e(t,i,n={}){await(await r.post("files/chmod",{signal:n.signal,searchParams:K({arg:t,mode:i,...n}),headers:n.headers})).text()}return e});f();we();var Ine=q(r=>{async function e(t,i,n={}){let s=Array.isArray(t)?t:[t];await(await r.post("files/cp",{signal:n.signal,searchParams:K({arg:s.concat(i).map(a=>L.asCID(a)?`/ipfs/${a}`:a),...n}),headers:n.headers})).text()}return e});f();we();var Tne=q(r=>{async function e(t,i={}){if(!t||typeof t!="string")throw new Error("ipfs.files.flush requires a path");let s=await(await r.post("files/flush",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).json();return L.parse(s.Cid)}return e});f();we();f();function Jg(r){let e=Dt(r);return Object.prototype.hasOwnProperty.call(e,"mode")&&(e.mode=parseInt(e.mode,8)),Object.prototype.hasOwnProperty.call(e,"mtime")&&(e.mtime={secs:e.mtime,nsecs:e.mtimeNsecs||0},delete e.mtimeNsecs),e}var Pne=q(r=>{async function*e(t,i={}){if(!t)throw new Error("ipfs.files.ls requires a path");let n=await r.post("files/ls",{signal:i.signal,searchParams:K({arg:L.asCID(t)?`/ipfs/${t}`:t,long:!0,...i,stream:!0}),headers:i.headers});for await(let s of n.ndjson())if("Entries"in s)for(let o of s.Entries||[])yield Cne(Jg(o));else yield Cne(Jg(s))}return e});function Cne(r){return r.hash&&(r.cid=L.parse(r.hash)),delete r.hash,r.type=r.type===1?"directory":"file",r}f();var One=q(r=>{async function e(t,i={}){await(await r.post("files/mkdir",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).text()}return e});f();var kne=q(r=>{async function e(t,i,n={}){Array.isArray(t)||(t=[t]),await(await r.post("files/mv",{signal:n.signal,searchParams:K({arg:t.concat(i),...n}),headers:n.headers})).text()}return e});f();var Nne=R(em()),Bne=q(r=>{async function*e(t,i={}){let n=await r.post("files/read",{signal:i.signal,searchParams:K({arg:t,count:i.length,...i}),headers:i.headers});yield*(0,Nne.default)(n.body)}return e});f();var Lne=R(vp()),Mne=q(r=>{async function e(t,i={}){let n=await r.post("files/rm",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers}),s=await n.text();if(s!==""){let o=new Lne.default.HTTPError(n);throw o.message=s,o}}return e});f();we();var cw=q(r=>{async function e(t,i={}){let s=await(await r.post("files/stat",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).json();return s.WithLocality=s.WithLocality||!1,wLe(Jg(s))}return e});function wLe(r){return r.cid=L.parse(r.hash),delete r.hash,r}f();var jne=q(r=>{async function e(t,i={}){await(await r.post("files/touch",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).text()}return e});f();var qne=q(r=>{async function e(t,i,n={}){let s=new AbortController,o=Pi(s.signal,n.signal);await(await r.post("files/write",{signal:o,searchParams:K({arg:t,streamChannels:!0,count:n.length,...n}),...await Ti([{content:i,path:"arg",mode:iw(n.mode),mtime:nw(n.mtime)}],s,n.headers)})).text()}return e});function Une(r){return{chmod:xne(r),cp:Ine(r),flush:Tne(r),ls:Pne(r),mkdir:One(r),mv:kne(r),read:Bne(r),rm:Mne(r),stat:cw(r),touch:jne(r),write:qne(r)}}f();f();var Fne=R(rh()),Kne=q(r=>async(t,i,n={})=>{throw(0,Fne.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});f();var Vne=q(r=>{async function e(t,i={type:"rsa",size:2048}){let s=await(await r.post("key/gen",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).json();return Dt(s)}return e});f();var zne=q(r=>{async function e(t,i,n,s={}){let a=await(await r.post("key/import",{signal:s.signal,searchParams:K({arg:t,pem:i,password:n,...s}),headers:s.headers})).json();return Dt(a)}return e});f();var Hne=R(rh()),$ne=q(r=>async(t,i={})=>{throw(0,Hne.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});f();var Gne=q(r=>{async function e(t={}){return((await(await r.post("key/list",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()).Keys||[]).map(s=>Dt(s))}return e});f();var Wne=q(r=>{async function e(t,i,n={}){let s=await r.post("key/rename",{signal:n.signal,searchParams:K({arg:[t,i],...n}),headers:n.headers});return Dt(await s.json())}return e});f();var Yne=q(r=>{async function e(t,i={}){let s=await(await r.post("key/rm",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).json();return Dt(s.Keys[0])}return e});function Xne(r){return{export:Kne(r),gen:Vne(r),import:zne(r),info:$ne(r),list:Gne(r),rename:Wne(r),rm:Yne(r)}}f();f();var Qne=q(r=>{async function e(t,i,n={}){let s=await r.post("log/level",{signal:n.signal,searchParams:K({arg:[t,i],...n}),headers:n.headers});return Dt(await s.json())}return e});f();var Zne=q(r=>{async function e(t={}){return(await(await r.post("log/ls",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()).Strings}return e});f();var Jne=q(r=>{async function*e(t={}){yield*(await r.post("log/tail",{signal:t.signal,searchParams:K(t),headers:t.headers})).ndjson()}return e});function ese(r){return{level:Qne(r),ls:Zne(r),tail:Jne(r)}}f();f();var tse=q(r=>{async function e(t,i={}){let n=await r.post("name/publish",{signal:i.signal,searchParams:K({arg:`${t}`,...i}),headers:i.headers});return Dt(await n.json())}return e});f();var rse=q(r=>{async function*e(t,i={}){let n=await r.post("name/resolve",{signal:i.signal,searchParams:K({arg:t,stream:!0,...i}),headers:i.headers});for await(let s of n.ndjson())yield s.Path}return e});f();f();var ise=q(r=>{async function e(t,i={}){let n=await r.post("name/pubsub/cancel",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers});return Dt(await n.json())}return e});f();var nse=q(r=>{async function e(t={}){let i=await r.post("name/pubsub/state",{signal:t.signal,searchParams:K(t),headers:t.headers});return Dt(await i.json())}return e});f();var sse=q(r=>{async function e(t={}){return(await(await r.post("name/pubsub/subs",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()).Strings||[]}return e});function ose(r){return{cancel:ise(r),state:nse(r),subs:sse(r)}}function ase(r){return{publish:tse(r),resolve:rse(r),pubsub:ose(r)}}f();f();we();var cse=q(r=>{async function e(t,i={}){let s=await(await r.post("object/data",{signal:i.signal,searchParams:K({arg:`${t instanceof Uint8Array?L.decode(t):t}`,...i}),headers:i.headers})).arrayBuffer();return new Uint8Array(s,0,s.byteLength)}return e});f();we();ct();var use=q(r=>{async function e(t,i={}){let s=await(await r.post("object/get",{signal:i.signal,searchParams:K({arg:`${t instanceof Uint8Array?L.decode(t):t}`,dataEncoding:"base64",...i}),headers:i.headers})).json();return{Data:Qe(s.Data,"base64pad"),Links:(s.Links||[]).map(o=>({Name:o.Name,Hash:L.parse(o.Hash),Tsize:o.Size}))}}return e});f();we();var lse=q(r=>{async function e(t,i={}){return((await(await r.post("object/links",{signal:i.signal,searchParams:K({arg:`${t instanceof Uint8Array?L.decode(t):t}`,...i}),headers:i.headers})).json()).Links||[]).map(o=>({Name:o.Name,Tsize:o.Size,Hash:L.parse(o.Hash)}))}return e});f();we();var fse=q(r=>{async function e(t={}){let i=await r.post("object/new",{signal:t.signal,searchParams:K({arg:t.template,...t}),headers:t.headers}),{Hash:n}=await i.json();return L.parse(n)}return e});f();var dse=(r,e)=>q(i=>{let n=aw(r,e);async function s(o,a={}){return n(o,{...a,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}return s})(e);f();we();var hse=q(r=>{async function e(t,i={}){let s=await(await r.post("object/stat",{signal:i.signal,searchParams:K({arg:`${t}`,...i}),headers:i.headers})).json();return{...s,Hash:L.parse(s.Hash)}}return e});f();f();we();var pse=q(r=>{async function e(t,i,n={}){let s=await r.post("object/patch/add-link",{signal:n.signal,searchParams:K({arg:[`${t}`,i.Name||i.name||"",(i.Hash||i.cid||"").toString()||null],...n}),headers:n.headers}),{Hash:o}=await s.json();return L.parse(o)}return e});f();we();var yse=q(r=>{async function e(t,i,n={}){let s=new AbortController,o=Pi(s.signal,n.signal),a=await r.post("object/patch/append-data",{signal:o,searchParams:K({arg:`${t}`,...n}),...await Ti([i],s,n.headers)}),{Hash:c}=await a.json();return L.parse(c)}return e});f();we();var gse=q(r=>{async function e(t,i,n={}){let s=await r.post("object/patch/rm-link",{signal:n.signal,searchParams:K({arg:[`${t}`,i.Name||i.name||null],...n}),headers:n.headers}),{Hash:o}=await s.json();return L.parse(o)}return e});f();we();var mse=q(r=>{async function e(t,i,n={}){let s=new AbortController,o=Pi(s.signal,n.signal),a=await r.post("object/patch/set-data",{signal:o,searchParams:K({arg:[`${t}`],...n}),...await Ti([i],s,n.headers)}),{Hash:c}=await a.json();return L.parse(c)}return e});function bse(r){return{addLink:pse(r),appendData:yse(r),rmLink:gse(r),setData:mse(r)}}function wse(r,e){return{data:cse(e),get:use(e),links:lse(e),new:fse(e),put:dse(r,e),stat:hse(e),patch:bse(e)}}f();f();we();var uw=q(r=>{async function*e(t,i={}){for await(let{path:n,recursive:s,metadata:o}of Wa(t)){let a=await r.post("pin/add",{signal:i.signal,searchParams:K({...i,arg:n,recursive:s,metadata:o?JSON.stringify(o):void 0,stream:!0}),headers:i.headers});for await(let c of a.ndjson()){if(c.Pins){for(let u of c.Pins)yield L.parse(u);continue}yield L.parse(c)}}}return e});f();var _se=R(Qn());function vse(r){let e=uw(r);return q(()=>{async function t(i,n={}){return(0,_se.default)(e([{path:i,...n}],n))}return t})(r)}f();we();function Ese(r,e,t){let i={type:r,cid:L.parse(e)};return t&&(i.metadata=t),i}var Sse=q(r=>{async function*e(t={}){let i=[];t.paths&&(i=Array.isArray(t.paths)?t.paths:[t.paths]);let n=await r.post("pin/ls",{signal:t.signal,searchParams:K({...t,arg:i.map(s=>`${s}`),stream:!0}),headers:t.headers});for await(let s of n.ndjson()){if(s.Keys){for(let o of Object.keys(s.Keys))yield Ese(s.Keys[o].Type,o,s.Keys[o].Metadata);return}yield Ese(s.Type,s.Cid,s.Metadata)}}return e});f();we();var lw=q(r=>{async function*e(t,i={}){for await(let{path:n,recursive:s}of Wa(t)){let o=new URLSearchParams(i.searchParams);o.append("arg",`${n}`),s!=null&&o.set("recursive",String(s));let a=await r.post("pin/rm",{signal:i.signal,headers:i.headers,searchParams:K({...i,arg:`${n}`,recursive:s})});for await(let c of a.ndjson()){if(c.Pins){yield*c.Pins.map(u=>L.parse(u));continue}yield L.parse(c)}}}return e});f();var Rse=R(Qn());var Ase=r=>{let e=lw(r);return q(()=>{async function t(i,n={}){return(0,Rse.default)(e([{path:i,...n}],n))}return t})(r)};f();f();f();we();var fw=({Name:r,Status:e,Cid:t})=>({cid:L.parse(t),name:r,status:e}),xse=r=>{if(typeof r=="string"&&r!=="")return r;throw new TypeError("service name must be passed")},Ise=r=>{if(L.asCID(r))return r.toString();throw new TypeError(`CID instance expected instead of ${typeof r}`)},s1=({service:r,cid:e,name:t,status:i,all:n})=>{let s=K({service:xse(r),name:t,force:n?!0:void 0});if(e)for(let o of e)s.append("cid",Ise(o));if(i)for(let o of i)s.append("status",o);return s},Tse=({cid:r,service:e,background:t,name:i,origins:n})=>{let s=K({arg:Ise(r),service:xse(e),name:i,background:t?!0:void 0});if(n)for(let o of n)s.append("origin",o.toString());return s};function Pse(r){async function e(t,{timeout:i,signal:n,headers:s,...o}){let a=await r.post("pin/remote/add",{timeout:i,signal:n,headers:s,searchParams:Tse({cid:t,...o})});return fw(await a.json())}return e}f();function Cse(r){async function*e({timeout:t,signal:i,headers:n,...s}){let o=await r.post("pin/remote/ls",{timeout:t,signal:i,headers:n,searchParams:s1(s)});for await(let a of o.ndjson())yield fw(a)}return e}f();function Ose(r){async function e({timeout:t,signal:i,headers:n,...s}){await r.post("pin/remote/rm",{timeout:t,signal:i,headers:n,searchParams:s1({...s,all:!1})})}return e}f();function kse(r){async function e({timeout:t,signal:i,headers:n,...s}){await r.post("pin/remote/rm",{timeout:t,signal:i,headers:n,searchParams:s1({...s,all:!0})})}return e}f();f();f();function Dse(r){let e=String(r);if(e==="undefined")throw Error("endpoint is required");return e[e.length-1]==="/"?e.slice(0,-1):e}function Nse(r){return{service:r.Service,endpoint:new URL(r.ApiEndpoint),...r.Stat&&{stat:_Le(r.Stat)}}}function _Le(r){switch(r.Status){case"valid":{let{Pinning:e,Pinned:t,Queued:i,Failed:n}=r.PinCount;return{status:"valid",pinCount:{queued:i,pinning:e,pinned:t,failed:n}}}case"invalid":return{status:"invalid"};default:return{status:r.Status}}}function Bse(r){async function e(t,i){let{endpoint:n,key:s,headers:o,timeout:a,signal:c}=i;await r.post("pin/remote/service/add",{timeout:a,signal:c,searchParams:K({arg:[t,Dse(n),s]}),headers:o})}return e}f();function Lse(r){async function e(t={}){let{stat:i,headers:n,timeout:s,signal:o}=t,a=await r.post("pin/remote/service/ls",{timeout:s,signal:o,headers:n,searchParams:i===!0?K({stat:i}):void 0}),{RemoteServices:c}=await a.json();return c.map(Nse)}return e}f();function Mse(r){async function e(t,i={}){await r.post("pin/remote/service/rm",{signal:i.signal,headers:i.headers,searchParams:K({arg:t})})}return e}function jse(r){let e=new th(r);return{add:Bse(e),ls:Lse(e),rm:Mse(e)}}function qse(r){let e=new th(r);return{add:Pse(e),ls:Cse(e),rm:Ose(e),rmAll:kse(e),service:jse(r)}}function Use(r){return{addAll:uw(r),add:vse(r),ls:Sse(r),rmAll:lw(r),rm:Ase(r),remote:qse(r)}}f();f();f();ct();tt();Zu();var dw=r=>Array.isArray(r)?r.map(vLe):r,vLe=r=>$e(hw(r)),hw=r=>F3.decode(r),o1=r=>F3.encode(Qe(r));var Fse=q(r=>{async function e(t={}){let{Strings:i}=await(await r.post("pubsub/ls",{signal:t.signal,searchParams:K(t),headers:t.headers})).json();return dw(i)||[]}return e});f();var Kse=q(r=>{async function e(t,i={}){let n=await r.post("pubsub/peers",{signal:i.signal,searchParams:K({arg:o1(t),...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e});f();var Vse=q(r=>{async function e(t,i,n={}){let s=K({arg:o1(t),...n}),o=new AbortController,a=Pi(o.signal,n.signal);await(await r.post("pubsub/pub",{signal:a,searchParams:s,...await Ti([i],o,n.headers)})).text()}return e});f();var zse=R(le());var ELe=(0,zse.default)("ipfs-http-client:pubsub:subscribe"),Hse=(r,e)=>q(t=>{async function i(n,s,o={}){o.signal=e.subscribe(n,s,o.signal);let a,c,u=new Promise((d,h)=>{a=d,c=h}),l=setTimeout(()=>a(),1e3);return t.post("pubsub/sub",{signal:o.signal,searchParams:K({arg:o1(n),...o}),headers:o.headers}).catch(d=>{e.unsubscribe(n,s),c(d)}).then(d=>{clearTimeout(l),!!d&&(SLe(d,{onMessage:s,onEnd:()=>e.unsubscribe(n,s),onError:o.onError}),a())}),u}return i})(r);async function SLe(r,{onMessage:e,onEnd:t,onError:i}){i=i||ELe;try{for await(let n of r.ndjson())try{if(!n.from)continue;e({from:n.from,data:hw(n.data),seqno:hw(n.seqno),topicIDs:dw(n.topicIDs)})}catch(s){s.message=`Failed to parse pubsub message: ${s.message}`,i(s,!1,n)}}catch(n){RLe(n)||i(n,!0)}finally{t()}}var RLe=r=>{switch(r.type){case"aborted":return!0;case"abort":return!0;default:return r.name==="AbortError"}};f();var $se=(r,e)=>{async function t(i,n){e.unsubscribe(i,n)}return t};f();var _I=class{constructor(){this._subs=new Map}subscribe(e,t,i){let n=this._subs.get(e)||[];if(n.find(o=>o.handler===t))throw new Error(`Already subscribed to ${e} with this handler`);let s=new AbortController;return this._subs.set(e,[{handler:t,controller:s}].concat(n)),i&&i.addEventListener("abort",()=>this.unsubscribe(e,t)),s.signal}unsubscribe(e,t){let i=this._subs.get(e)||[],n;t?(this._subs.set(e,i.filter(s=>s.handler!==t)),n=i.filter(s=>s.handler===t)):(this._subs.set(e,[]),n=i),(this._subs.get(e)||[]).length||this._subs.delete(e),n.forEach(s=>s.controller.abort())}};function Gse(r){let e=new _I;return{ls:Fse(r),peers:Kse(r),publish:Vse(r),subscribe:Hse(r,e),unsubscribe:$se(r,e)}}f();we();f();var Wse=q(r=>{async function*e(t={}){yield*(await r.post("refs/local",{signal:t.signal,transform:Dt,searchParams:K(t),headers:t.headers})).ndjson()}return e});var Yse=q((r,e)=>Object.assign(async function*(i,n={}){let s=Array.isArray(i)?i:[i];yield*(await r.post("refs",{signal:n.signal,searchParams:K({arg:s.map(a=>`${a instanceof Uint8Array?L.decode(a):a}`),...n}),headers:n.headers,transform:Dt})).ndjson()},{local:Wse(e)}));f();f();we();var Xse=q(r=>{async function*e(t={}){yield*(await r.post("repo/gc",{signal:t.signal,searchParams:K(t),headers:t.headers,transform:n=>({err:n.Error?new Error(n.Error):null,cid:(n.Key||{})["/"]?L.parse(n.Key["/"]):null})})).ndjson()}return e});f();var pw=q(r=>{async function e(t={}){let n=await(await r.post("repo/stat",{signal:t.signal,searchParams:K(t),headers:t.headers})).json();return{numObjects:BigInt(n.NumObjects),repoSize:BigInt(n.RepoSize),repoPath:n.RepoPath,version:n.Version,storageMax:BigInt(n.StorageMax)}}return e});f();var Qse=q(r=>{async function e(t={}){return(await(await r.post("repo/version",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()).Version}return e});function Zse(r){return{gc:Xse(r),stat:pw(r),version:Qse(r)}}f();f();var Jse=q(r=>{async function*e(t={}){yield*(await r.post("stats/bw",{signal:t.signal,searchParams:K(t),headers:t.headers,transform:n=>({totalIn:BigInt(n.TotalIn),totalOut:BigInt(n.TotalOut),rateIn:parseFloat(n.RateIn),rateOut:parseFloat(n.RateOut)})})).ndjson()}return e});function eoe(r){return{bitswap:sw(r),repo:pw(r),bw:Jse(r)}}f();f();var toe=R(ft());var roe=q(r=>{async function e(t={}){let i=await r.post("swarm/addrs",{signal:t.signal,searchParams:K(t),headers:t.headers}),{Addrs:n}=await i.json();return Object.keys(n).map(s=>({id:s,addrs:(n[s]||[]).map(o=>new toe.Multiaddr(o))}))}return e});f();var ioe=q(r=>{async function e(t,i={}){let n=await r.post("swarm/connect",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e});f();var noe=q(r=>{async function e(t,i={}){let n=await r.post("swarm/disconnect",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e});f();var soe=R(ft());var ooe=q(r=>{async function e(t={}){let i=await r.post("swarm/addrs/local",{signal:t.signal,searchParams:K(t),headers:t.headers}),{Strings:n}=await i.json();return(n||[]).map(s=>new soe.Multiaddr(s))}return e});f();var aoe=R(ft());var coe=q(r=>{async function e(t={}){let i=await r.post("swarm/peers",{signal:t.signal,searchParams:K(t),headers:t.headers}),{Peers:n}=await i.json();return(n||[]).map(s=>({addr:new aoe.Multiaddr(s.Addr),peer:s.Peer,muxer:s.Muxer,latency:s.Latency,streams:s.Streams,direction:s.Direction==null?void 0:s.Direction===0?"inbound":"outbound"}))}return e});function uoe(r){return{addrs:roe(r),connect:ioe(r),disconnect:noe(r),localAddrs:ooe(r),peers:coe(r)}}f();f();we();var yw=q(r=>{async function*e(t,i={}){let n=new AbortController,s=Pi(n.signal,i.signal),{headers:o,body:a,total:c,parts:u}=await Ti(t,n,i.headers),[l,d]=typeof i.progress=="function"?ALe(c,u,i.progress):[void 0,void 0],h=await r.post("add",{searchParams:K({"stream-channels":!0,...i,progress:Boolean(l)}),onUploadProgress:d,signal:s,headers:o,body:a});for await(let p of h.ndjson())p=Dt(p),p.hash!==void 0?yield ILe(p):l&&l(p.bytes||0,p.name)}return e}),ALe=(r,e,t)=>e?[void 0,xLe(r,e,t)]:[t,void 0],xLe=(r,e,t)=>{let i=0,n=e.length;return({loaded:s,total:o})=>{let a=Math.floor(s/o*r);for(;i<n;){let{start:c,end:u,name:l}=e[i];if(a<u){t(a-c,l);break}else t(u-c,l),i+=1}}};function ILe({name:r,hash:e,size:t,mode:i,mtime:n,mtimeNsecs:s}){let o={path:r,cid:L.parse(e),size:parseInt(t)};return i!=null&&(o.mode=parseInt(i,8)),n!=null&&(o.mtime={secs:n,nsecs:s||0}),o}var loe=R(Qn());function foe(r){let e=yw(r);return q(()=>{async function t(i,n={}){return await(0,loe.default)(e(L6(i),n))}return t})(r)}f();var doe=q(r=>{async function*e(t,i={}){yield*(await r.post("cat",{signal:i.signal,searchParams:K({arg:t.toString(),...i}),headers:i.headers})).iterator()}return e});f();var hoe=q(r=>async(t={})=>(await r.post("commands",{signal:t.signal,searchParams:K(t),headers:t.headers})).json());f();var poe=q(r=>async(t,i={})=>(await(await r.post("dns",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).json()).Path);f();var yoe=q(r=>()=>{let e=new URL(r.opts.base||"");return{host:e.hostname,port:e.port,protocol:e.protocol,pathname:e.pathname,"api-path":e.pathname}});f();we();var goe=q(r=>{async function*e(t,i={}){let n={arg:`${t instanceof Uint8Array?L.decode(t):t}`,...i};n.compressionLevel&&(n["compression-level"]=n.compressionLevel,delete n.compressionLevel),yield*(await r.post("get",{signal:i.signal,searchParams:K(n),headers:i.headers})).iterator()}return e});f();var moe=R(ft());var gw=q(r=>{async function e(t={}){let n=await(await r.post("id",{signal:t.signal,searchParams:K({arg:t.peerId?t.peerId.toString():void 0,...t}),headers:t.headers})).json(),s={...Dt(n)};return s.addresses&&(s.addresses=s.addresses.map(o=>new moe.Multiaddr(o))),s}return e});f();var boe=r=>{let e=gw(r);async function t(i={}){let n=await e(i);return Boolean(n&&n.addresses&&n.addresses.length)}return t};f();we();var woe=q((r,e)=>{async function*t(i,n={}){let s=`${i instanceof Uint8Array?L.decode(i):i}`;async function o(c){let u=c.Hash;if(u.includes("/")){let d=u.startsWith("/ipfs/")?u:`/ipfs/${u}`;u=(await cw(e)(d)).cid}else u=L.parse(u);let l={name:c.Name,path:s+(c.Name?`/${c.Name}`:""),size:c.Size,cid:u,type:TLe(c)};return c.Mode&&(l.mode=parseInt(c.Mode,8)),c.Mtime!==void 0&&c.Mtime!==null&&(l.mtime={secs:c.Mtime},c.MtimeNsecs!==void 0&&c.MtimeNsecs!==null&&(l.mtime.nsecs=c.MtimeNsecs)),l}let a=await r.post("ls",{signal:n.signal,searchParams:K({arg:s,...n}),headers:n.headers});for await(let c of a.ndjson()){if(c=c.Objects,!c)throw new Error("expected .Objects in results");if(c=c[0],!c)throw new Error("expected one array in results.Objects");let u=c.Links;if(!Array.isArray(u))throw new Error("expected one array in results.Objects[0].Links");if(!u.length){yield o(c);return}yield*u.map(o)}}return t});function TLe(r){switch(r.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}f();var _oe=q(r=>{async function e(t={}){let i=await r.post("dns",{signal:t.signal,searchParams:K(t),headers:t.headers});return Dt(await i.json())}return e});f();var voe=q(r=>{async function*e(t,i={}){yield*(await r.post("ping",{signal:i.signal,searchParams:K({arg:`${t}`,...i}),headers:i.headers,transform:Dt})).ndjson()}return e});f();var Eoe=q(r=>{async function e(t,i={}){let n=await r.post("resolve",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers}),{Path:s}=await n.json();return s}return e});f();var Soe=R(rh()),Roe=q(r=>async(t={})=>{throw(0,Soe.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});f();var Aoe=q(r=>{async function e(t={}){await(await r.post("shutdown",{signal:t.signal,searchParams:K(t),headers:t.headers})).text()}return e});f();var xoe=q(r=>{async function e(t={}){let i=await r.post("version",{signal:t.signal,searchParams:K(t),headers:t.headers});return{...Dt(await i.json()),"ipfs-http-client":"1.0.0"}}return e});var DLe=R(vI());we();var NLe=R(ft()),BLe=R(EI());function Toe(r={}){let e={name:ws.name,code:ws.code,encode:u=>u,decode:u=>u},t=Object.values(qf);(r.ipld&&r.ipld.bases?r.ipld.bases:[]).forEach(u=>t.push(u));let i=new Yg({bases:t,loadBase:r.ipld&&r.ipld.loadBase}),n=Object.values(H3);[In,Sy,Ay,kLe,e].concat(r.ipld&&r.ipld.codecs||[]).forEach(u=>n.push(u));let s=new Xg({codecs:n,loadCodec:r.ipld&&r.ipld.loadCodec}),o=Object.values(z3);(r.ipld&&r.ipld.hashers?r.ipld.hashers:[]).forEach(u=>o.push(u));let a=new Qg({hashers:o,loadHasher:r.ipld&&r.ipld.loadHasher});return{add:foe(r),addAll:yw(r),bitswap:_ie(r),block:Die(r),bootstrap:zie(r),cat:doe(r),commands:hoe(r),config:Zie(r),dag:one(s,r),dht:vne(r),diag:Ane(r),dns:poe(r),files:Une(r),get:goe(r),getEndpointConfig:yoe(r),id:gw(r),isOnline:boe(r),key:Xne(r),log:ese(r),ls:woe(r),mount:_oe(r),name:ase(r),object:wse(s,r),pin:Use(r),ping:voe(r),pubsub:Gse(r),refs:Yse(r),repo:Zse(r),resolve:Eoe(r),start:Roe(r),stats:eoe(r),stop:Aoe(r),swarm:uoe(r),version:xoe(r),bases:i,codecs:s,hashers:a}}var Eme=R(ft());f();var Bhe=R(Tae()),Lhe=R(aue()),Mhe=R(Pue()),jhe=R(Qle()),qhe=R(khe()),Uhe=R(pI());f();var Dhe={func:(r,e)=>sd.validate(e,r)};function Nhe(r,e){return sd.select(e[0],e[1])}function Fhe(){return{dialer:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4},modules:{transport:[Bhe.default,Lhe.default],streamMuxer:[Mhe.default],connEncryption:[jhe.NOISE],peerDiscovery:[],dht:qhe.default,pubsub:Uhe.default},config:{peerDiscovery:{autoDial:!0,bootstrap:{enabled:!0},webRTCStar:{enabled:!0}},dht:{kBucketSize:20,enabled:!0,clientMode:!0,validators:{ipns:Dhe},selectors:{ipns:Nhe}},pubsub:{enabled:!0,emitSelf:!0},nat:{enabled:!1}},metrics:{enabled:!0},peerStore:{persistence:!0}}}var Sme=R(Hhe()),Rme=R(bme());var TZe=Pt.bind({ignoreUndefined:!0});function Ym({options:r={},peerId:e,multiaddrs:t=[],repo:i,keychainConfig:n={},config:s={}}){let{datastore:o,keys:a}=i,c=PZe({options:r,config:s,datastore:o,keys:a,keychainConfig:n,peerId:e,multiaddrs:t});return typeof r.libp2p=="function"?r.libp2p({libp2pOptions:c,options:r,config:s,datastore:o,peerId:e}):Rme.default.create(c)}function PZe({options:r,config:e,datastore:t,keys:i,keychainConfig:n,peerId:s,multiaddrs:o}){let a=()=>{let y=(0,$t.default)(e,"Pubsub.Router")||"gossipsub";if(!yI[y])throw(0,wme.default)(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${y} router.`),"ERR_NOT_SUPPORTED");return yI[y]},c={datastore:t,peerId:s,modules:{}},u={modules:{pubsub:a(),contentRouting:[],peerRouting:[]},config:{peerDiscovery:{mdns:{enabled:(0,$t.default)(r,"config.Discovery.MDNS.Enabled",(0,$t.default)(e,"Discovery.MDNS.Enabled",!0))},webRTCStar:{enabled:(0,$t.default)(r,"config.Discovery.webRTCStar.Enabled",(0,$t.default)(e,"Discovery.webRTCStar.Enabled",!0))},bootstrap:{list:(0,$t.default)(r,"config.Bootstrap",(0,$t.default)(e,"Bootstrap",[]))}},relay:{enabled:(0,$t.default)(r,"relay.enabled",(0,$t.default)(e,"relay.enabled",!0)),hop:{enabled:(0,$t.default)(r,"relay.hop.enabled",(0,$t.default)(e,"relay.hop.enabled",!1)),active:(0,$t.default)(r,"relay.hop.active",(0,$t.default)(e,"relay.hop.active",!1))}},dht:{enabled:(0,$t.default)(e,"Routing.Type","dhtclient")!=="none",clientMode:(0,$t.default)(e,"Routing.Type","dht")!=="dhtserver",kBucketSize:(0,$t.default)(r,"dht.kBucketSize",20),validators:{ipns:sd}},pubsub:{enabled:(0,$t.default)(r,"config.Pubsub.Enabled",(0,$t.default)(e,"Pubsub.Enabled",!0))},nat:{enabled:!(0,$t.default)(e,"Swarm.DisableNatPortMap",!1)}},addresses:{listen:o.map(y=>y.toString()),announce:(0,$t.default)(r,"addresses.announce",(0,$t.default)(e,"Addresses.Announce",[])),noAnnounce:(0,$t.default)(r,"addresses.noAnnounce",(0,$t.default)(e,"Addresses.NoAnnounce",[]))},connectionManager:(0,$t.default)(r,"connectionManager",{maxConnections:(0,$t.default)(r,"config.Swarm.ConnMgr.HighWater",(0,$t.default)(e,"Swarm.ConnMgr.HighWater")),minConnections:(0,$t.default)(r,"config.Swarm.ConnMgr.LowWater",(0,$t.default)(e,"Swarm.ConnMgr.LowWater"))}),keychain:{datastore:i,...n},host:{agentVersion:`js-ipfs/${Sd}`}},l=(0,$t.default)(r,"libp2p",void 0);typeof l=="function"&&(l=void 0);let d=TZe(c,Fhe(),u,l);(0,$t.default)(d,"config.peerDiscovery.bootstrap.list",[]).length>0&&d.modules.peerDiscovery.push(Sme.default);let p=(0,$t.default)(r,"config.Addresses.Delegates",(0,$t.default)(e,"Addresses.Delegates",[]));if(p.length>0){let y=p[Math.floor(Math.random()*p.length)],g=new Eme.Multiaddr(y).toOptions(),w={host:g.host,protocol:parseInt(g.port)===443?"https":"http",port:g.port},b=Toe(w);u.modules.contentRouting=u.modules.contentRouting||[],u.modules.contentRouting.push(new vme.default(s,b)),u.modules.peerRouting=u.modules.peerRouting||[],u.modules.peerRouting.push(new _me.default(b))}return d}var xme=Pt.bind({ignoreUndefined:!0}),Xm=(0,Ame.default)("ipfs:components:peer:storage"),Qm=class{constructor(e,t,i,n,s){this.print=n,this.peerId=e,this.keychain=t,this.repo=i,this.print=n,this.isNew=s}static async start(e,t,i){let{repoAutoMigrate:n,repo:s,onMigrationProgress:o}=i,a=typeof s=="string"||s==null?Qee(e,t,{path:s,autoMigrate:n,onMigrationProgress:o}):s,{peerId:c,keychain:u,isNew:l}=await CZe(e,a,i);return new Qm(c,u,a,e,l)}},CZe=async(r,e,t)=>{if(!e.closed)return{...await Ime(e,t),isNew:!1};try{return await e.open(),{...await Ime(e,t),isNew:!1}}catch(i){if(i.code!==Ld)throw i;if(t.init&&t.init.allowNew===!1)throw new ka("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await OZe(r,e,t),isNew:!0}}},OZe=async(r,e,t)=>{let i=t.init||{},n=await e.exists();if(Xm("repo exists?",n),n===!0)throw new Error("repo already exists");let s=i.privateKey?await kZe(i.privateKey):await DZe(r,i),o=NZe(s);Xm("peer identity: %s",o.PeerID);let a={...xme(Tme(tu(),i.profiles),t.config),Identity:o};await e.init(a),await e.open(),Xm("repo opened");let c={pass:t.pass};try{c.dek=await e.config.get("Keychain.DEK")}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l}let u=await Ym({options:void 0,multiaddrs:void 0,peerId:s,repo:e,config:a,keychainConfig:c});return u.keychain&&u.keychain.opts&&(await u.loadKeychain(),await e.config.set("Keychain",{DEK:u.keychain.opts.dek})),{peerId:s,keychain:u.keychain}},kZe=r=>(Xm("using user-supplied private-key"),typeof r=="object"?r:__.default.createFromPrivKey(Qe(r,"base64pad"))),DZe=(r,{algorithm:e="Ed25519",bits:t=2048})=>(r("generating %s keypair...",e),__.default.create({keyType:e,bits:t})),NZe=r=>({PeerID:r.toB58String(),PrivKey:$e(r.privKey.bytes,"base64pad")}),Ime=async(r,e)=>{let t=e.config,i=e.init&&e.init.profiles||[],n=e.pass,s=await r.config.getAll(),o=BZe(Tme(s,i),t);if(s!==o&&await r.config.replace(o),!o.Identity||!o.Identity.PrivKey)throw new Ju("No private key was found in the config, please intialize the repo");let a=await __.default.createFromPrivKey(o.Identity.PrivKey),c=await Ym({options:void 0,multiaddrs:void 0,peerId:a,repo:r,config:o,keychainConfig:{pass:n,...o.Keychain}});return c.keychain&&await c.loadKeychain(),{peerId:a,keychain:c.keychain}},BZe=(r,e)=>e?xme(r,e):r,Tme=(r,e)=>(e||[]).reduce((t,i)=>{let n=m0[i];if(!n)throw new Error(`Could not find profile with name '${i}'`);return Xm("applying profile %s",i),n.transform(t)},r);f();f();f();f();f();we();vi();di();var Yme=R(Kme());f();var Zm=R(Wn());function YZe(r){let e=new Uint8Array(r.reduce((i,n)=>i+Zm.default.encodingLength(n),0)),t=0;for(let i of r)e=Zm.encode(i,e,t),t+=Zm.default.encodingLength(i);return e}var Vme=YZe;f();var wC=R(le());hi();f();f();f();di();var v_=class{constructor(e,t,i){this._refCounter=1,this.cid=e,this.priority=t||1,this.wantType=i}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(yt)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}};di();f();var _a=R(Br()),Oc=_a.default.Reader,Jm=_a.default.Writer,Xt=_a.default.util,Kt=_a.default.roots["ipfs-bitswap"]||(_a.default.roots["ipfs-bitswap"]={}),Ns=Kt.Message=(()=>{function r(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.wantlist=null,r.prototype.blocks=Xt.emptyArray,r.prototype.payload=Xt.emptyArray,r.prototype.blockPresences=Xt.emptyArray,r.prototype.pendingBytes=0,r.encode=function(t,i){if(i||(i=Jm.create()),t.wantlist!=null&&Object.hasOwnProperty.call(t,"wantlist")&&Kt.Message.Wantlist.encode(t.wantlist,i.uint32(10).fork()).ldelim(),t.blocks!=null&&t.blocks.length)for(var n=0;n<t.blocks.length;++n)i.uint32(18).bytes(t.blocks[n]);if(t.payload!=null&&t.payload.length)for(var n=0;n<t.payload.length;++n)Kt.Message.Block.encode(t.payload[n],i.uint32(26).fork()).ldelim();if(t.blockPresences!=null&&t.blockPresences.length)for(var n=0;n<t.blockPresences.length;++n)Kt.Message.BlockPresence.encode(t.blockPresences[n],i.uint32(34).fork()).ldelim();return t.pendingBytes!=null&&Object.hasOwnProperty.call(t,"pendingBytes")&&i.uint32(40).int32(t.pendingBytes),i},r.decode=function(t,i){t instanceof Oc||(t=Oc.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Kt.Message;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.wantlist=Kt.Message.Wantlist.decode(t,t.uint32());break;case 2:s.blocks&&s.blocks.length||(s.blocks=[]),s.blocks.push(t.bytes());break;case 3:s.payload&&s.payload.length||(s.payload=[]),s.payload.push(Kt.Message.Block.decode(t,t.uint32()));break;case 4:s.blockPresences&&s.blockPresences.length||(s.blockPresences=[]),s.blockPresences.push(Kt.Message.BlockPresence.decode(t,t.uint32()));break;case 5:s.pendingBytes=t.int32();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Kt.Message)return t;var i=new Kt.Message;if(t.wantlist!=null){if(typeof t.wantlist!="object")throw TypeError(".Message.wantlist: object expected");i.wantlist=Kt.Message.Wantlist.fromObject(t.wantlist)}if(t.blocks){if(!Array.isArray(t.blocks))throw TypeError(".Message.blocks: array expected");i.blocks=[];for(var n=0;n<t.blocks.length;++n)typeof t.blocks[n]=="string"?Xt.base64.decode(t.blocks[n],i.blocks[n]=Xt.newBuffer(Xt.base64.length(t.blocks[n])),0):t.blocks[n].length&&(i.blocks[n]=t.blocks[n])}if(t.payload){if(!Array.isArray(t.payload))throw TypeError(".Message.payload: array expected");i.payload=[];for(var n=0;n<t.payload.length;++n){if(typeof t.payload[n]!="object")throw TypeError(".Message.payload: object expected");i.payload[n]=Kt.Message.Block.fromObject(t.payload[n])}}if(t.blockPresences){if(!Array.isArray(t.blockPresences))throw TypeError(".Message.blockPresences: array expected");i.blockPresences=[];for(var n=0;n<t.blockPresences.length;++n){if(typeof t.blockPresences[n]!="object")throw TypeError(".Message.blockPresences: object expected");i.blockPresences[n]=Kt.Message.BlockPresence.fromObject(t.blockPresences[n])}}return t.pendingBytes!=null&&(i.pendingBytes=t.pendingBytes|0),i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocks=[],n.payload=[],n.blockPresences=[]),i.defaults&&(n.wantlist=null,n.pendingBytes=0),t.wantlist!=null&&t.hasOwnProperty("wantlist")&&(n.wantlist=Kt.Message.Wantlist.toObject(t.wantlist,i)),t.blocks&&t.blocks.length){n.blocks=[];for(var s=0;s<t.blocks.length;++s)n.blocks[s]=i.bytes===String?Xt.base64.encode(t.blocks[s],0,t.blocks[s].length):i.bytes===Array?Array.prototype.slice.call(t.blocks[s]):t.blocks[s]}if(t.payload&&t.payload.length){n.payload=[];for(var s=0;s<t.payload.length;++s)n.payload[s]=Kt.Message.Block.toObject(t.payload[s],i)}if(t.blockPresences&&t.blockPresences.length){n.blockPresences=[];for(var s=0;s<t.blockPresences.length;++s)n.blockPresences[s]=Kt.Message.BlockPresence.toObject(t.blockPresences[s],i)}return t.pendingBytes!=null&&t.hasOwnProperty("pendingBytes")&&(n.pendingBytes=t.pendingBytes),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,_a.default.util.toJSONOptions)},r.Wantlist=function(){function e(t){if(this.entries=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.entries=Xt.emptyArray,e.prototype.full=!1,e.encode=function(i,n){if(n||(n=Jm.create()),i.entries!=null&&i.entries.length)for(var s=0;s<i.entries.length;++s)Kt.Message.Wantlist.Entry.encode(i.entries[s],n.uint32(10).fork()).ldelim();return i.full!=null&&Object.hasOwnProperty.call(i,"full")&&n.uint32(16).bool(i.full),n},e.decode=function(i,n){i instanceof Oc||(i=Oc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Kt.Message.Wantlist;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.entries&&o.entries.length||(o.entries=[]),o.entries.push(Kt.Message.Wantlist.Entry.decode(i,i.uint32()));break;case 2:o.full=i.bool();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Kt.Message.Wantlist)return i;var n=new Kt.Message.Wantlist;if(i.entries){if(!Array.isArray(i.entries))throw TypeError(".Message.Wantlist.entries: array expected");n.entries=[];for(var s=0;s<i.entries.length;++s){if(typeof i.entries[s]!="object")throw TypeError(".Message.Wantlist.entries: object expected");n.entries[s]=Kt.Message.Wantlist.Entry.fromObject(i.entries[s])}}return i.full!=null&&(n.full=Boolean(i.full)),n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.entries=[]),n.defaults&&(s.full=!1),i.entries&&i.entries.length){s.entries=[];for(var o=0;o<i.entries.length;++o)s.entries[o]=Kt.Message.Wantlist.Entry.toObject(i.entries[o],n)}return i.full!=null&&i.hasOwnProperty("full")&&(s.full=i.full),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,_a.default.util.toJSONOptions)},e.WantType=function(){let t={},i=Object.create(t);return i[t[0]="Block"]=0,i[t[1]="Have"]=1,i}(),e.Entry=function(){function t(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return t.prototype.block=Xt.newBuffer([]),t.prototype.priority=0,t.prototype.cancel=!1,t.prototype.wantType=0,t.prototype.sendDontHave=!1,t.encode=function(n,s){return s||(s=Jm.create()),n.block!=null&&Object.hasOwnProperty.call(n,"block")&&s.uint32(10).bytes(n.block),n.priority!=null&&Object.hasOwnProperty.call(n,"priority")&&s.uint32(16).int32(n.priority),n.cancel!=null&&Object.hasOwnProperty.call(n,"cancel")&&s.uint32(24).bool(n.cancel),n.wantType!=null&&Object.hasOwnProperty.call(n,"wantType")&&s.uint32(32).int32(n.wantType),n.sendDontHave!=null&&Object.hasOwnProperty.call(n,"sendDontHave")&&s.uint32(40).bool(n.sendDontHave),s},t.decode=function(n,s){n instanceof Oc||(n=Oc.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new Kt.Message.Wantlist.Entry;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.block=n.bytes();break;case 2:a.priority=n.int32();break;case 3:a.cancel=n.bool();break;case 4:a.wantType=n.int32();break;case 5:a.sendDontHave=n.bool();break;default:n.skipType(c&7);break}}return a},t.fromObject=function(n){if(n instanceof Kt.Message.Wantlist.Entry)return n;var s=new Kt.Message.Wantlist.Entry;switch(n.block!=null&&(typeof n.block=="string"?Xt.base64.decode(n.block,s.block=Xt.newBuffer(Xt.base64.length(n.block)),0):n.block.length&&(s.block=n.block)),n.priority!=null&&(s.priority=n.priority|0),n.cancel!=null&&(s.cancel=Boolean(n.cancel)),n.wantType){case"Block":case 0:s.wantType=0;break;case"Have":case 1:s.wantType=1;break}return n.sendDontHave!=null&&(s.sendDontHave=Boolean(n.sendDontHave)),s},t.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(s.bytes===String?o.block="":(o.block=[],s.bytes!==Array&&(o.block=Xt.newBuffer(o.block))),o.priority=0,o.cancel=!1,o.wantType=s.enums===String?"Block":0,o.sendDontHave=!1),n.block!=null&&n.hasOwnProperty("block")&&(o.block=s.bytes===String?Xt.base64.encode(n.block,0,n.block.length):s.bytes===Array?Array.prototype.slice.call(n.block):n.block),n.priority!=null&&n.hasOwnProperty("priority")&&(o.priority=n.priority),n.cancel!=null&&n.hasOwnProperty("cancel")&&(o.cancel=n.cancel),n.wantType!=null&&n.hasOwnProperty("wantType")&&(o.wantType=s.enums===String?Kt.Message.Wantlist.WantType[n.wantType]:n.wantType),n.sendDontHave!=null&&n.hasOwnProperty("sendDontHave")&&(o.sendDontHave=n.sendDontHave),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,_a.default.util.toJSONOptions)},t}(),e}(),r.Block=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.prefix=Xt.newBuffer([]),e.prototype.data=Xt.newBuffer([]),e.encode=function(i,n){return n||(n=Jm.create()),i.prefix!=null&&Object.hasOwnProperty.call(i,"prefix")&&n.uint32(10).bytes(i.prefix),i.data!=null&&Object.hasOwnProperty.call(i,"data")&&n.uint32(18).bytes(i.data),n},e.decode=function(i,n){i instanceof Oc||(i=Oc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Kt.Message.Block;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.prefix=i.bytes();break;case 2:o.data=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Kt.Message.Block)return i;var n=new Kt.Message.Block;return i.prefix!=null&&(typeof i.prefix=="string"?Xt.base64.decode(i.prefix,n.prefix=Xt.newBuffer(Xt.base64.length(i.prefix)),0):i.prefix.length&&(n.prefix=i.prefix)),i.data!=null&&(typeof i.data=="string"?Xt.base64.decode(i.data,n.data=Xt.newBuffer(Xt.base64.length(i.data)),0):i.data.length&&(n.data=i.data)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.prefix="":(s.prefix=[],n.bytes!==Array&&(s.prefix=Xt.newBuffer(s.prefix))),n.bytes===String?s.data="":(s.data=[],n.bytes!==Array&&(s.data=Xt.newBuffer(s.data)))),i.prefix!=null&&i.hasOwnProperty("prefix")&&(s.prefix=n.bytes===String?Xt.base64.encode(i.prefix,0,i.prefix.length):n.bytes===Array?Array.prototype.slice.call(i.prefix):i.prefix),i.data!=null&&i.hasOwnProperty("data")&&(s.data=n.bytes===String?Xt.base64.encode(i.data,0,i.data.length):n.bytes===Array?Array.prototype.slice.call(i.data):i.data),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,_a.default.util.toJSONOptions)},e}(),r.BlockPresenceType=function(){let e={},t=Object.create(e);return t[e[0]="Have"]=0,t[e[1]="DontHave"]=1,t}(),r.BlockPresence=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.cid=Xt.newBuffer([]),e.prototype.type=0,e.encode=function(i,n){return n||(n=Jm.create()),i.cid!=null&&Object.hasOwnProperty.call(i,"cid")&&n.uint32(10).bytes(i.cid),i.type!=null&&Object.hasOwnProperty.call(i,"type")&&n.uint32(16).int32(i.type),n},e.decode=function(i,n){i instanceof Oc||(i=Oc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Kt.Message.BlockPresence;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.cid=i.bytes();break;case 2:o.type=i.int32();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Kt.Message.BlockPresence)return i;var n=new Kt.Message.BlockPresence;switch(i.cid!=null&&(typeof i.cid=="string"?Xt.base64.decode(i.cid,n.cid=Xt.newBuffer(Xt.base64.length(i.cid)),0):i.cid.length&&(n.cid=i.cid)),i.type){case"Have":case 0:n.type=0;break;case"DontHave":case 1:n.type=1;break}return n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.cid="":(s.cid=[],n.bytes!==Array&&(s.cid=Xt.newBuffer(s.cid))),s.type=n.enums===String?"Have":0),i.cid!=null&&i.hasOwnProperty("cid")&&(s.cid=n.bytes===String?Xt.base64.encode(i.cid,0,i.cid.length):n.bytes===Array?Array.prototype.slice.call(i.cid):i.cid),i.type!=null&&i.hasOwnProperty("type")&&(s.type=n.enums===String?Kt.Message.BlockPresenceType[i.type]:i.type),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,_a.default.util.toJSONOptions)},e}(),r})();var zme=R(bh()),Hme={Block:Ns.Wantlist.WantType.Block,Have:Ns.Wantlist.WantType.Have},XZe=(r,e)=>Array.prototype.slice.call(e,0).sort((t,i)=>{let n=r(t),s=r(i);return n<s?-1:n>s?1:0}),kc=class{constructor(e,t){this.set=t?(0,zme.default)({system:"ipfs",component:"bitswap",metric:"wantlist",metrics:t.metrics}):new Map,this._stats=e}get length(){return this.set.size}add(e,t,i){let n=e.toString(yt),s=this.set.get(n);s?(s.inc(),s.priority=t,s.wantType===Hme.Have&&i===Hme.Block&&(s.wantType=i)):(this.set.set(n,new v_(e,t,i)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){let t=e.toString(yt),i=this.set.get(t);!i||(i.dec(),!i.hasRefs()&&(this.set.delete(t),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(XZe(e=>e[1].key,Array.from(this.set.entries())))}contains(e){let t=e.toString(yt);return this.set.has(t)}get(e){let t=e.toString(yt);return this.set.get(t)}};kc.Entry=v_;di();var QZe=kc.Entry,Ch=class{constructor(e,t,i,n,s){this.entry=new QZe(e,t,i),this.cancel=Boolean(n),this.sendDontHave=Boolean(s)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(yt)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}};var No=(r,e)=>{let t=["bitswap"];return e&&t.push(e),r&&t.push(`${r.toB58String().slice(0,8)}`),Object.assign((0,wC.default)(t.join(":")),{error:(0,wC.default)(t.concat(["error"]).join(":"))})};var E_=(r,e)=>{if(r.size!==e.size)return!1;for(let[t,i]of r){let n=e.get(t);if(n===void 0||i instanceof Uint8Array&&n instanceof Uint8Array&&!Hs(i,n)||i instanceof Ch&&n instanceof Ch&&!i.equals(n))return!1}return!0};var Xme=R(Wme()),cr=class{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(e,t,i,n,s){i==null&&(i=cr.WantType.Block);let o=e.toString(yt),a=this.wantlist.get(o);a?(a.wantType===i&&(a.priority=t),n&&(a.cancel=Boolean(n)),s&&(a.sendDontHave=Boolean(s)),i===cr.WantType.Block&&a.wantType===cr.WantType.Have&&(a.wantType=i)):this.wantlist.set(o,new Ch(e,t,i,n,s))}addBlock(e,t){let i=e.toString(yt);this.blocks.set(i,t)}addHave(e){let t=e.toString(yt);this.blockPresences.has(t)||this.blockPresences.set(t,cr.BlockPresenceType.Have)}addDontHave(e){let t=e.toString(yt);this.blockPresences.has(t)||this.blockPresences.set(t,cr.BlockPresenceType.DontHave)}cancel(e){let t=e.toString(yt);this.wantlist.delete(t),this.addEntry(e,0,cr.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),cancel:Boolean(t.cancel)})),full:this.full?!0:void 0},blocks:Array.from(this.blocks.values())};return Ns.encode(e).finish()}serializeToBitswap110(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),wantType:t.wantType,cancel:Boolean(t.cancel),sendDontHave:Boolean(t.sendDontHave)})),full:this.full?!0:void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(let[t,i]of this.blocks.entries()){let n=L.parse(t),s=n.version,o=n.code,a=n.multihash.code,c=n.multihash.digest.length,u=Vme([s,o,a,c]);e.payload.push(new Ns.Block({prefix:u,data:i}))}for(let[t,i]of this.blockPresences)e.blockPresences.push(new Ns.BlockPresence({cid:L.parse(t).bytes,type:i}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),Ns.encode(e).finish()}equals(e){return!(this.full!==e.full||this.pendingBytes!==e.pendingBytes||!E_(this.wantlist,e.wantlist)||!E_(this.blocks,e.blocks)||!E_(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){let e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}};cr.deserialize=async(r,e)=>{let t=Ns.decode(r),i=t.wantlist&&t.wantlist.full||!1,n=new cr(i);return t.wantlist&&t.wantlist.entries&&t.wantlist.entries.forEach(s=>{if(!s.block)return;let o=L.decode(s.block);n.addEntry(o,s.priority||0,s.wantType,Boolean(s.cancel),Boolean(s.sendDontHave))}),t.blockPresences&&t.blockPresences.forEach(s=>{if(!s.cid)return;let o=L.decode(s.cid);s.type===cr.BlockPresenceType.Have?n.addHave(o):n.addDontHave(o)}),t.blocks.length>0?(await Promise.all(t.blocks.map(async s=>{let o=await Lr.digest(s),a=L.createV0(o);n.addBlock(a,s)})),n):(t.payload.length>0&&(await Promise.all(t.payload.map(async s=>{if(!s.prefix||!s.data)return;let o=(0,Yme.default)(s.prefix),a=o[0],c=o[1],u=o[2],l=u===Lr.code?Lr:e&&await e.getHasher(u);if(!l)throw(0,Xme.default)(new Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");let d=await l.digest(s.data),h=L.create(a,c,d);n.addBlock(h,s.data)})),n.setPendingBytes(t.pendingBytes)),n)};cr.blockPresenceSize=r=>r.bytes.length+1;cr.Entry=Ch;cr.WantType={Block:Ns.Wantlist.WantType.Block,Have:Ns.Wantlist.WantType.Have};cr.BlockPresenceType={Have:Ns.BlockPresenceType.Have,DontHave:Ns.BlockPresenceType.DontHave};f();var _C=1e3,Qme=3,Zme=10*_C,oDt=15*_C,aDt=15*_C,Jme=Math.pow(2,31)-1,e3e=1e3,t3e=1;f();var n3e=R(i3e());var vC=class{constructor(e,t,i){this.peerId=t,this.network=i,this.refcnt=1,this._entries=[],this._log=No(e,"msgqueue"),this.sendEntries=(0,n3e.default)(this._sendEntries.bind(this),t3e)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;let e=new cr(!1);this._entries.forEach(t=>{t.cancel?e.cancel(t.cid):e.addEntry(t.cid,t.priority)}),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(t){this._log.error("cant connect to peer %s: %s",this.peerId.toB58String(),t.message);return}this._log("sending message to peer %s",this.peerId.toB58String()),this.network.sendMessage(this.peerId,e).catch(t=>{this._log.error("send error: %s",t.message)})}};di();var s3e=R(bh()),EC=class{constructor(e,t,i,n){this.peers=(0,s3e.default)({system:"ipfs",component:"bitswap",metric:"want-manager-peers",metrics:n.metrics}),this.wantlist=new kc(i,n),this.network=t,this._stats=i,this._peerId=e,this._log=No(e,"want")}_addEntries(e,t,i){let n=e.map((s,o)=>new cr.Entry(s,Jme-o,cr.WantType.Block,t));n.forEach(s=>{s.cancel?i?this.wantlist.removeForce(s.cid.toString(yt)):this.wantlist.remove(s.cid):(this._log("adding to wl"),this.wantlist.add(s.cid,s.priority))});for(let s of this.peers.values())s.addEntries(n)}_startPeerHandler(e){let t=this.peers.get(e.toB58String());if(t){t.refcnt++;return}t=new vC(this._peerId,e,this.network);let i=new cr(!0);for(let n of this.wantlist.entries())i.addEntry(n[1].cid,n[1].priority);return t.addMessage(i),this.peers.set(e.toB58String(),t),t}_stopPeerHandler(e){let t=this.peers.get(e.toB58String());!t||(t.refcnt--,!(t.refcnt>0)&&this.peers.delete(e.toB58String()))}wantBlocks(e,t={}){this._addEntries(e,!1),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>this.disconnected(e.peerId))}};f();var SC=R(go()),RC=R(dr()),o3e=R(U5());var AC="/ipfs/bitswap/1.0.0",xC="/ipfs/bitswap/1.1.0",IC="/ipfs/bitswap/1.2.0",TC=class{constructor(e,t,i,n={}){this._log=No(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[AC],n.b100Only||(this._protocols.unshift(xC),this._protocols.unshift(IC)),this._stats=i,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=n.hashLoader}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection);let e=new o3e.default({multicodecs:this._protocols,handlers:{onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect}});this._registrarId=await this._libp2p.registrar.register(e);for await(let t of this._libp2p.peerStore.getPeers()){let i=this._libp2p.connectionManager.get(t.id);i&&this._onPeerConnect(i.remotePeer)}}async stop(){this._running=!1,await this._libp2p.unhandle(this._protocols),this._registrarId!=null&&this._libp2p.registrar.unregister(this._registrarId)}async _onConnection({protocol:e,stream:t,connection:i}){if(!!this._running){this._log("incoming new bitswap %s connection from %s",e,i.remotePeer.toB58String());try{await(0,RC.pipe)(t,SC.default.decode(),async n=>{for await(let s of n)try{let o=await cr.deserialize(s.slice(),this._hashLoader);await this._bitswap._receiveMessage(i.remotePeer,o)}catch(o){this._bitswap._receiveError(o);break}})}catch(n){this._log(n)}}}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,t,i={}){return this._libp2p.contentRouting.findProviders(e,{timeout:Zme,maxNumProviders:t})}async findAndConnect(e,t){let i=[];for await(let n of this.findProviders(e,Qme,t))this._log(`connecting to provider ${n.id}`),i.push(this.connectTo(n.id,t).catch(s=>{this._log.error(s)}));await Promise.all(i)}async provide(e,t){await this._libp2p.contentRouting.provide(e,t)}async sendMessage(e,t){if(!this._running)throw new Error("network isn't running");let i=e.toB58String();this._log("sendMessage to %s",i,t);let n=await this._libp2p.dial(e),{stream:s,protocol:o}=await n.newStream([IC,xC,AC]),a;switch(o){case AC:a=t.serializeToBitswap100();break;case xC:case IC:a=t.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+o)}eJe(s,a,this._log),this._updateSentStats(e,t.blocks)}async connectTo(e,t){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,t)}_updateSentStats(e,t){let i=e.toB58String();if(this._stats){for(let n of t.values())this._stats.push(i,"dataSent",n.length);this._stats.push(i,"blocksSent",t.size)}}};async function eJe(r,e,t){try{await(0,RC.pipe)([e],SC.default.encode(),r)}catch(i){t(i)}}f();we();di();f();var PC=class{constructor(e){this.partner=e,this.wantlist=new kc,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=e}wants(e,t,i){this.wantlist.add(e,t,i)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}};f();f();var S_=class extends Map{constructor(e,t){super();this._cmp=t||this._defaultSort,this._keys=[];for(let[i,n]of e||[])this.set(i,n)}update(e){if(e<0||e>=this._keys.length)return;let t=this._keys[e];this._keys.splice(e,1);let i=this._find(t);this._keys.splice(i,0,t)}set(e,t){if(this.has(e)){let n=this.indexOf(e);this._keys.splice(n,1)}super.set(e,t);let i=this._find(e);return this._keys.splice(i,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;let t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;let t=this._find(e);if(this._keys[t]===e)return t;for(let i=1;i<this._keys.length;i++){if(this._keys[t+i]===e)return t+i;if(this._keys[t-i]===e)return t-i}return-1}_find(e){let t=0,i=this._keys.length;for(;t<i;){let n=t+i>>>1,s=this._kCmp(this._keys[n],e);if(s<0)t=n+1;else if(s>0)i=n;else return n}return t}*keys(){for(let e of this._keys)yield e}*values(){for(let e of this._keys)yield this.get(e)}*entries(){for(let e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,t){if(!!e)for(let i of this._keys)e.apply(t,[[i,this.get(i)]])}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}};var tJe={hasNewInfo(){return!1},merge(){}},CC=class{constructor(e=tJe){this._taskMerger=e,this._byPeer=new S_([],OC.compare)}pushTasks(e,t){let i=this._byPeer.get(e.toB58String());i||(i=new OC(e,this._taskMerger)),i.pushTasks(t),this._byPeer.set(e.toB58String(),i)}popTasks(e){let t=this._head();if(t===void 0)return{tasks:[],pendingSize:0};let{tasks:i,pendingSize:n}=t.popTasks(e);if(i.length===0)return{tasks:i,pendingSize:n};let s=t.peerId;return t.isIdle()?this._byPeer.delete(s.toB58String()):this._byPeer.update(0),{peerId:s,tasks:i,pendingSize:n}}_head(){if(this._byPeer.size!==0)for(let[,e]of this._byPeer)return e}remove(e,t){let i=this._byPeer.get(t.toB58String());i&&i.remove(e)}tasksDone(e,t){let i=this._byPeer.get(e.toB58String());if(!i)return;let n=this._byPeer.indexOf(e.toB58String());for(let s of t)i.taskDone(s);this._byPeer.update(n)}},OC=class{constructor(e,t){this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new a3e,this._active=new Set}pushTasks(e){for(let t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;let t=this._pending.get(e.topic);if(t){e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),this._taskMerger.merge(e,t);return}this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){let t=[];for(let i of this._active)i.topic===e.topic&&t.push(i);return t.length===0?!0:this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0,i=[],n=this._pending.tasks();for(let s=0;s<n.length&&t<e;s++){let o=n[s];i.push(o),t+=o.size,this._pending.delete(o.topic),this._activeTotalSize+=o.size,this._active.add(o)}return{tasks:i,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(e,t){return e[1]._pending.length===0?1:t[1]._pending.length===0?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}},a3e=class{constructor(){this._tasks=new S_([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,t)=>e+t.task.size,0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,t){let i=this._tasks.get(e);if(!i)return;let n=this._tasks.indexOf(e);i.task.priority=t,this._tasks.update(n)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}};f();var c3e={hasNewInfo(r,e){let t=!1,i=!1;for(let n of e)n.data.haveBlock&&(t=!0),n.data.isWantBlock&&(i=!0);return!!(!i&&r.data.isWantBlock||!t&&r.data.haveBlock)},merge(r,e){let t=r.data,i=e.data;!i.haveBlock&&t.haveBlock&&(i.haveBlock=t.haveBlock,i.blockSize=t.blockSize),!i.isWantBlock&&t.isWantBlock&&(i.isWantBlock=!0,(!i.haveBlock||t.haveBlock)&&(i.haveBlock=t.haveBlock,e.size=r.size)),i.isWantBlock&&i.haveBlock&&(e.size=i.blockSize)}};var u3e=R(bh()),l3e=cr.WantType,rJe=16*1024,iJe=1024,kC=class{constructor(e,t,i,n,s,o={}){this._log=No(e,"engine"),this.blockstore=t,this.network=i,this._stats=n,this._opts=this._processOpts(o),this.ledgerMap=(0,u3e.default)({system:"ipfs",component:"bitswap",metric:"ledger-map",metrics:s.metrics}),this._running=!1,this._requestQueue=new CC(c3e)}_processOpts(e){return{maxSizeReplaceHasWithBlock:iJe,targetMessageSize:rJe,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}async _processTasks(){if(!this._running)return;let{peerId:e,tasks:t,pendingSize:i}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(t.length===0)return;let n=new cr(!1);n.setPendingBytes(i);let s=[],o=new Map;for(let c of t){let u=L.parse(c.topic);c.data.haveBlock?c.data.isWantBlock?(s.push(u),o.set(c.topic,c.data)):n.addHave(u):n.addDontHave(u)}let a=await this._getBlocks(s);for(let[c,u]of o){let l=L.parse(c),d=a.get(c);d?n.addBlock(l,d):u.sendDontHave&&n.addDontHave(l)}if(n.empty){e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks();return}try{e&&await this.network.sendMessage(e,n);for(let[c,u]of a.entries())e&&this.messageSent(e,L.parse(c),u)}catch(c){this._log.error(c)}e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks()}wantlistForPeer(e){let t=e.toB58String(),i=this.ledgerMap.get(t);return i?i.wantlist.sortedEntries():new Map}ledgerForPeer(e){let t=e.toB58String(),i=this.ledgerMap.get(t);return i?{peer:i.partner,value:i.debtRatio(),sent:i.accounting.bytesSent,recv:i.accounting.bytesRecv,exchanged:i.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){if(!!e.length){for(let t of this.ledgerMap.values())for(let i of e){let n=t.wantlistContains(i.cid);if(!n)continue;let s=i.data.length,o=this._sendAsBlock(n.wantType,s),a=s;o||(a=cr.blockPresenceSize(n.cid)),this._requestQueue.pushTasks(t.partner,[{topic:n.cid.toString(yt),priority:n.priority,size:a,data:{blockSize:s,isWantBlock:o,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,t){let i=this._findOrCreate(e);if(t.empty)return;if(t.full&&(i.wantlist=new kc),this._updateBlockAccounting(t.blocks,i),t.wantlist.size===0){this._scheduleProcessTasks();return}let n=[],s=[];t.wantlist.forEach(o=>{o.cancel?(i.cancelWant(o.cid),n.push(o.cid)):(i.wants(o.cid,o.priority,o.wantType),s.push(o))}),this._cancelWants(e,n),await this._addWants(e,s),this._scheduleProcessTasks()}_cancelWants(e,t){for(let i of t)this._requestQueue.remove(i.toString(yt),e)}async _addWants(e,t){let i=await this._getBlockSizes(t.map(s=>s.cid)),n=[];for(let s of t){let o=s.cid.toString(yt),a=i.get(o);if(a==null)s.sendDontHave&&n.push({topic:o,priority:s.priority,size:cr.blockPresenceSize(s.cid),data:{isWantBlock:s.wantType===l3e.Block,blockSize:0,haveBlock:!1,sendDontHave:s.sendDontHave}});else{let c=this._sendAsBlock(s.wantType,a),u=a;c||(u=cr.blockPresenceSize(s.cid)),n.push({topic:o,priority:s.priority,size:u,data:{isWantBlock:c,blockSize:a,haveBlock:!0,sendDontHave:s.sendDontHave}})}this._requestQueue.pushTasks(e,n)}}_sendAsBlock(e,t){return e===l3e.Block||t<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){let t=await this._getBlocks(e);return new Map([...t].map(([i,n])=>[i,n.length]))}async _getBlocks(e){let t=new Map;return await Promise.all(e.map(async i=>{try{let n=await this.blockstore.get(i);t.set(i.toString(yt),n)}catch(n){n.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",i,n)}})),t}_updateBlockAccounting(e,t){for(let i of e.values())this._log("got block (%s bytes)",i.length),t.receivedBytes(i.length)}messageSent(e,t,i){let n=this._findOrCreate(e);n.sentBytes(i.length),n.wantlist.remove(t)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){this.ledgerMap.delete(e.toB58String())}_findOrCreate(e){let t=e.toB58String(),i=this.ledgerMap.get(t);if(i)return i;let n=new PC(e);return this.ledgerMap.set(t,n),this._stats&&this._stats.push(t,"peerCount",1),n}start(){this._running=!0}stop(){this._running=!1}};f();var f3e=R(Ut());tt();var d3e=r=>`unwant:${$e(r.multihash.bytes,"base64")}`,h3e=r=>`block:${$e(r.multihash.bytes,"base64")}`,DC=class extends f3e.EventEmitter{constructor(e){super();this.setMaxListeners(e3e),this._log=No(e,"notif")}hasBlock(e,t){let i=h3e(e);this._log(i),this.emit(i,t)}wantBlock(e,t={}){if(!e)throw new Error("Not a valid cid");let i=h3e(e),n=d3e(e);return this._log(`wantBlock:${e}`),new Promise((s,o)=>{let a=()=>{this.removeListener(i,c),o(new Error(`Block for ${e} unwanted`))},c=u=>{this.removeListener(n,a),s(u)};this.once(n,a),this.once(i,c),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.removeListener(i,c),this.removeListener(n,a),o(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){let t=d3e(e);this._log(t),this.emit(t)}};f();var y3e=R(Ut());f();var p3e=R(Ut()),NC=R(VP()),R_=class extends p3e.EventEmitter{constructor(e,t){super();this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(i=>{this._stats[i]=BigInt(0),this._movingAverages[i]={},this._options.movingAverageIntervals.forEach(n=>{(this._movingAverages[i][n]=(0,NC.default)(n)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){let t=e=this._queue.shift();t&&this._applyOp(t)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let t=e-this._frequencyLastTime;t&&Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let s=n/t*1e3,o=this._movingAverages[e];o||(o=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(a=>{let c=o[a];c||(c=o[a]=(0,NC.default)(a)),c.push(i,s)})}_applyOp(e){let t=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(i),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=i}};var g3e=R(bh()),m3e={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]},BC=class extends y3e.EventEmitter{constructor(e,t=[],i=m3e){super();let n=Object.assign({},m3e,i);if(typeof n.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof n.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=t,this._options=n,this._enabled=this._options.enabled,this._global=new R_(t,n),this._global.on("update",s=>this.emit("update",s)),this._peers=(0,g3e.default)({system:"ipfs",component:"bitswap",metric:"stats-peers",metrics:e.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(let e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){let t=typeof e!="string"&&e.toB58String?e.toB58String():`${e}`;return this._peers.get(t)}push(e,t,i){if(this._enabled&&(this._global.push(t,i),e)){let n=this._peers.get(e);n||(n=new R_(this._initialCounters,this._options),this._peers.set(e,n)),n.push(t,i)}}disconnected(e){let t=e.toB58String(),i=this._peers.get(t);i&&(i.stop(),this._peers.delete(t))}};var b3e=R(Ho());we();var nJe={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},sJe=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"],LC=class extends mu{constructor(e,t,i={}){super();this._libp2p=e,this._log=No(this.peerId),this._options=Object.assign({},nJe,i),this._stats=new BC(e,sJe,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new TC(e,this,this._stats,{hashLoader:i.hashLoader}),this.blockstore=t,this.engine=new kC(this.peerId,t,this.network,this._stats,e),this.wm=new EC(this.peerId,this.network,this._stats,e),this.notifications=new DC(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,t){try{await this.engine.messageReceived(e,t)}catch(n){this._log("failed to receive message",t)}if(t.blocks.size===0)return;let i=[];for(let[n,s]of t.blocks.entries()){let o=L.parse(n);i.push({wasWanted:this.wm.wantlist.contains(o),cid:o,data:s})}this.wm.cancelWants(i.filter(({wasWanted:n})=>n).map(({cid:n})=>n)),await Promise.all(i.map(({cid:n,wasWanted:s,data:o})=>this._handleReceivedBlock(e,n,o,s)))}async _handleReceivedBlock(e,t,i,n){this._log("received block");let s=await this.blockstore.has(t);this._updateReceiveCounters(e.toB58String(),t,i,s),!!n&&await this.put(t,i)}_updateReceiveCounters(e,t,i,n){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",i.length),n&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",i.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,t={}){let i=(u,l)=>(this.wm.wantBlocks([u],l),this.notifications.wantBlock(u,l)),n=!1,s=async(u,l)=>{try{return await this.blockstore.get(u,l)}catch(d){if(d.code!=="ERR_NOT_FOUND")throw d;return n||(n=!0,this.network.findAndConnect(u).catch(h=>this._log.error(h))),i(u,l)}},o=new AbortController,a=t.signal?(0,b3e.anySignal)([t.signal,o.signal]):o.signal,c=await Promise.race([this.notifications.wantBlock(e,{signal:a}),s(e,{signal:a})]);return o.abort(),c}async*getMany(e,t={}){for await(let i of e)yield this.get(i,t)}unwant(e){let t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach(i=>this.notifications.unwantBlock(i))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,t,i){await this.blockstore.put(e,t),this._sendHaveBlockNotifications(e,t)}async*putMany(e,t){for await(let{key:i,value:n}of this.blockstore.putMany(e,t))this._sendHaveBlockNotifications(i,n),yield{key:i,value:n}}_sendHaveBlockNotifications(e,t){this.notifications.hasBlock(e,t),this.engine.receivedBlocks([{cid:e,data:t}]),this.network.provide(e).catch(i=>{this._log.error("Failed to provide: %s",i.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this._stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}};var w3e=(r,e,t={})=>new LC(r,e,t);var x3e=R(ft()),I3e=R(St());f();f();var jC={};Tt(jC,{abortedError:()=>aJe,notFoundError:()=>S3e});f();var MC=R(E3e());function S3e(r){return r=r||new Error("Not Found"),(0,MC.default)(r,"ERR_NOT_FOUND")}function aJe(r){return r=r||new Error("Aborted"),(0,MC.default)(r,"ERR_ABORTED")}f();en();Vs();we();Ji();var hNt={...jC};var R3e=R(Sl()),qC=R(Xa()),A3e=R(rs()),UC=class extends mu{constructor(e,t){super();this.child=e,this.bitswap=t}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(e,t,i={}){await this.has(e)||(this.bitswap.isStarted()?await this.bitswap.put(e,t,i):await this.child.put(e,t,i))}async*putMany(e,t={}){let i=(0,A3e.default)(e,async({key:n})=>!await this.has(n));this.bitswap.isStarted()?yield*this.bitswap.putMany(i,t):yield*this.child.putMany(i,t)}async get(e,t={}){return!await this.has(e)&&this.bitswap.isStarted()?this.bitswap.get(e,t):this.child.get(e,t)}async*getMany(e,t={}){let i=(0,qC.default)(),n=(0,qC.default)();Promise.resolve().then(async()=>{for await(let s of e)!await this.has(s)&&this.bitswap.isStarted()?i.push(s):n.push(s);i.end(),n.end()}),yield*(0,R3e.default)(this.bitswap.getMany(i,t),this.child.getMany(n,t))}async delete(e,t){await this.child.delete(e,t)}async*deleteMany(e,t){yield*this.child.deleteMany(e,t)}async has(e,t={}){return this.child.has(e,t)}async*query(e,t={}){yield*this.child.query(e,t)}async*queryKeys(e,t={}){yield*this.child.queryKeys(e,t)}};var e3=class{constructor(e,t,i,n,s){this.peerId=e,this.libp2p=t,this.bitswap=i,this.repo=n,this.blockstore=s}static async start({peerId:e,repo:t,print:i,hashers:n,options:s}){t.closed&&await t.open();let o=await t.config.getAll(),a=await Ym({options:s,repo:t,peerId:e,multiaddrs:cJe(e,o),config:o,keychainConfig:void 0});a.keychain&&await a.loadKeychain(),await a.start();for(let l of a.multiaddrs)i(`Swarm listening on ${l}/p2p/${e.toB58String()}`);let c=w3e(a,t.blocks,{statsEnabled:!0,hashLoader:n});await c.start();let u=new UC(t.blocks,c);return t.blocks=u,t.pins.blockstore=u,new e3(e,a,c,t,u)}static async stop(e){e.repo.blocks=e.blockstore.unwrap(),e.repo.pins.blockstore=e.blockstore.unwrap(),await e.bitswap.stop(),await e.libp2p.stop()}},cJe=(r,e)=>{let t=r.toB58String(),i=[],n=e.Addresses&&e.Addresses.Swarm||[];for(let s of n){let o=new x3e.Multiaddr(s);if(o.protoCodes().includes(uJe))throw(0,I3e.default)(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");let a=o.getPeerId();a&&a!==t&&(o=o.encapsulate(`/p2p/${t}`)),i.push(o)}return i},uJe=479;f();f();function T3e({network:r}){async function e(t={}){let i=[],{libp2p:n}=await r.use(t);for await(let s of n.peerStore.getPeers())i.push({id:s.id.toB58String(),addrs:s.addresses.map(o=>o.multiaddr)});return i}return Q(e)}f();function P3e({network:r}){async function e(t,i={}){let{libp2p:n}=await r.use(i);await n.dial(t,i)}return Q(e)}f();function C3e({network:r}){async function e(t,i={}){let{libp2p:n}=await r.use(i);await n.hangUp(t)}return Q(e)}f();function O3e({network:r}){async function e(t={}){let{libp2p:i}=await r.use(t);return i.multiaddrs}return Q(e)}f();function k3e({network:r}){async function e(t={}){let{libp2p:i}=await r.use(t),n=[];for(let[s,o]of i.connections)for(let a of o){let c={addr:a.remoteAddr,peer:s};(t.verbose||t.direction)&&(c.direction=a.stat.direction),t.verbose&&(c.muxer=a.stat.multiplexer,c.latency="n/a",c.streams=[]),n.push(c)}return n}return Q(e)}var FC=class{constructor({network:e}){this.addrs=T3e({network:e}),this.connect=P3e({network:e}),this.disconnect=C3e({network:e}),this.localAddrs=O3e({network:e}),this.peers=k3e({network:e})}};f();var D3e=R(ot());var t3={success:!0,time:0,text:""};function N3e({network:r}){async function*e(t,i={}){let{libp2p:n}=await r.use();i.count=i.count||10;let s=D3e.default.createFromB58String(t),o=await n.peerStore.get(s),a=o&&o.id;if(!a){yield{...t3,text:`Looking up peer ${t}`};let l=await n.peerRouting.findPeer(s);a=l&&l.id}if(!a)throw new Error("Peer was not found");yield{...t3,text:`PING ${a.toB58String()}`};let c=0,u=0;for(let l=0;l<i.count;l++)try{let d=await n.ping(a);u+=d,c++,yield{...t3,time:d}}catch(d){yield{...t3,success:!1,text:d.toString()}}if(c){let l=u/c;yield{...t3,text:`Average latency: ${l}ms`}}}return Q(e)}f();var KC=R(ot()),A_=R(St());var B3e=R(A2());var Oh=R(bn());we();di();Iy();Si();ct();var VC="/ipns/";function L3e(r){r.startsWith(VC)&&(r=r.substring(VC.length));let e;if((r[0]==="1"||r[0]==="Q")&&(r=`z${r}`),r[0]==="z"&&(e=yt.decode(r)),r[0]==="k"&&(e=np.decode(r)),!e)throw new Error("Could not parse string");if(e[0]!==1&&e[1]!==114&&(e=Ni([[1,114],e])),e.length!==40)throw new Error("Incorrect length "+e.length);return Ni([Qe(VC),e.subarray(2)])}function iy(r){if(r.name==="SENDING_QUERY")return{type:r.type,name:r.name,to:r.to.toB58String()};if(r.name==="PEER_RESPONSE")return{type:r.type,name:r.name,messageType:r.messageType,messageName:r.messageName,closer:r.closer.map(({id:e,multiaddrs:t})=>({id:e.toB58String(),multiaddrs:t})),providers:r.providers.map(({id:e,multiaddrs:t})=>({id:e.toB58String(),multiaddrs:t})),record:r.record,from:r.from.toB58String()};if(r.name==="FINAL_PEER")return{type:r.type,name:r.name,from:r.from.toB58String(),peer:{id:r.peer.id.toB58String(),multiaddrs:r.peer.multiaddrs}};if(r.name==="QUERY_ERROR")return{type:r.type,name:r.name,error:r.error,from:r.from.toB58String()};if(r.name==="PROVIDER")return{type:r.type,name:r.name,providers:r.providers.map(({id:e,multiaddrs:t})=>({id:e.toB58String(),multiaddrs:t})),from:r.from.toB58String()};if(r.name==="VALUE")return{type:r.type,name:r.name,value:r.value,from:r.from.toB58String()};if(r.name==="ADDING_PEER")return{type:r.type,name:r.name,peer:r.peer.toB58String()};if(r.name==="DIALING_PEER")return{type:r.type,name:r.name,peer:r.peer.toB58String()};throw(0,A_.default)(new Error("Unknown DHT event type"),"ERR_UNKNOWN_DHT_EVENT")}function M3e({network:r,repo:e,peerId:t}){let{get:i,put:n,findProvs:s,findPeer:o,provide:a,query:c}={async*get(u,l={}){let{libp2p:d}=await ny(r,t,l),h=u instanceof Uint8Array?u:L3e(u);yield*(0,Oh.default)(d._dht.get(h,l),iy)},async*put(u,l,d){let{libp2p:h}=await ny(r,t,d),p=u instanceof Uint8Array?u:L3e(u);yield*(0,Oh.default)(h._dht.put(p,l),iy)},async*findProvs(u,l={}){let{libp2p:d}=await ny(r,t,l);yield*(0,Oh.default)(d._dht.findProviders(u,{signal:l.signal}),iy)},async*findPeer(u,l={}){let{libp2p:d}=await ny(r,t,l);yield*(0,Oh.default)(d._dht.findPeer(KC.default.parse(u),{signal:l.signal}),iy)},async*provide(u,l={recursive:!1}){let{libp2p:d}=await ny(r,t,l);if(!await e.blocks.has(u))throw(0,A_.default)(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(l.recursive)throw(0,A_.default)(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");yield*(0,Oh.default)(d._dht.provide(u),iy)},async*query(u,l={}){let{libp2p:d}=await ny(r,t,l),h,p=L.asCID(u);p!=null?h=p.multihash.bytes:h=KC.default.parse(u.toString()).toBytes(),yield*(0,Oh.default)(d._dht.getClosestPeers(h,l),iy)}};return{get:Q(i),put:Q(n),findProvs:Q(s),findPeer:Q(o),provide:Q(a),query:Q(c)}}var ny=async(r,e,t)=>{let i=await r.use(t);if((0,B3e.default)(i.libp2p,"_config.dht.enabled",!1))return i;{let n=async function*(){yield{from:e,name:"QUERY_ERROR",type:3,error:new ka("dht not enabled")}};return{libp2p:{_dht:{get:n,put:n,findProvs:n,findPeer:n,provide:n,query:n}}}}};f();var j3e=R(St());var q3e=R(A2());function U3e({network:r,config:e}){let t=(0,q3e.default)(e||{},"Pubsub.Enabled",!0);return{subscribe:t?Q(i):r3,unsubscribe:t?Q(n):r3,publish:t?Q(s):r3,ls:t?Q(o):r3,peers:t?Q(a):r3};async function i(c,u,l={}){let{libp2p:d}=await r.use(l);return d.pubsub.subscribe(c,u,l)}async function n(c,u,l={}){let{libp2p:d}=await r.use(l);d.pubsub.unsubscribe(c,u,l)}async function s(c,u,l={}){let{libp2p:d}=await r.use(l);if(!u)throw(0,j3e.default)(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await d.pubsub.publish(c,u)}async function o(c={}){let{libp2p:u}=await r.use(c);return u.pubsub.getTopics()}async function a(c,u={}){let{libp2p:l}=await r.use(u);return l.pubsub.getSubscribers(c)}}var r3=async()=>{throw new ka("pubsub not enabled")};var fJe=Pt.bind({ignoreUndefined:!0}),Pf=Object.assign((0,zC.default)("ipfs"),{error:(0,zC.default)("ipfs:error")}),K3e=class{constructor({print:e,storage:t,codecs:i,options:n}){let{peerId:s,repo:o,keychain:a}=t,c=On.create(e3),u=KW(n.preload),l=yM(),d=gM({network:c}),h=new K9(n),p=Object.values(z3);(n.ipld&&n.ipld.hashers?n.ipld.hashers:[]).forEach(Le=>p.push(Le)),this.hashers=new Qg({hashers:p,loadHasher:n.ipld&&n.ipld.loadHasher});let y=Object.values(qf);(n.ipld&&n.ipld.bases?n.ipld.bases:[]).forEach(Le=>y.push(Le)),this.bases=new Yg({bases:y,loadBase:n.ipld&&n.ipld.loadBase});let g=new qE({repo:o,codecs:i}),w=new tS({codecs:i,hashers:this.hashers,preload:u,repo:o}),b=new Y9({dns:l,ipns:h,repo:o,codecs:i,peerId:s,isOnline:d,keychain:a,options:n}),v=PU({repo:o,codecs:i,bases:this.bases,name:b}),A=new AR({repo:o,codecs:i,hashers:this.hashers,preload:u}),k=Object.assign(YK({repo:o,codecs:i,resolve:v,preload:u}),{local:XK({repo:t.repo})}),{add:C,addAll:T,cat:D,get:j,ls:M}=new pR({preload:u,repo:o,options:n.EXPERIMENTAL,hashers:this.hashers}),se=pX({repo:o,preload:u,hashers:this.hashers,options:n}),ie=VW({files:se,preload:u,options:n.preload});this.preload=u,this.name=b,this.ipns=h,this.pin=g,this.resolve=v,this.block=w,this.refs=k,this.start=BL({network:c,peerId:s,repo:o,preload:u,ipns:h,mfsPreload:ie,print:e,keychain:a,hashers:this.hashers,options:n}),this.stop=LL({network:c,preload:u,mfsPreload:ie,ipns:h,repo:o}),this.dht=M3e({network:c,repo:o,peerId:s}),this.pubsub=U3e({network:c,config:n.config}),this.dns=l,this.isOnline=d,this.id=tW({network:c,peerId:s}),this.version=QG({repo:o}),this.bitswap=new Z9({network:c}),this.bootstrap=new J9({repo:o}),this.config=sW({repo:o}),this.ping=N3e({network:c}),this.add=C,this.addAll=T,this.cat=D,this.get=j,this.ls=M,this.dag=A,this.files=se,this.key=new VR({keychain:a}),this.object=new $R({preload:u,codecs:i,repo:o}),this.repo=new GR({repo:o,hashers:this.hashers}),this.stats=new WR({repo:o,network:c}),this.swarm=new FC({network:c}),Object.defineProperty(this,"libp2p",{get(){let Le=c.try();return Le?Le.libp2p:void 0}});let fe=()=>Promise.reject((0,HC.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),pe=async function*(){throw(0,HC.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=fe,this.diag={cmds:fe,net:fe,sys:fe},this.log={level:fe,ls:fe,tail:pe},this.mount=fe,this.codecs=i}async init(){throw new Oa}},dJe=async r=>{let e=lt({Data:new ht({type:"directory"}).marshal(),Links:[]}),t=await r.block.put(e,{mhtype:"sha2-256",format:"dag-pb"});return await r.pin.add(t),t},hJe=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!F3e.isTest,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}});async function V3e(r={}){r=fJe(hJe(),r);let e=r.init||{},t={name:ws.name,code:ws.code,encode:u=>u,decode:u=>u},i=Object.values(H3);[In,Sy,Ay,lJe,t].concat(r.ipld&&r.ipld.codecs||[]).forEach(u=>i.push(u));let n=new Xg({codecs:i,loadCodec:r.ipld&&r.ipld.loadCodec}),s=r.silent?Pf:console.log;Pf("creating repo");let o=await Qm.start(s,n,r);Pf("getting repo config");let a=await o.repo.config.getAll(),c=new K3e({storage:o,print:s,codecs:n,options:{...r,config:a}});if(Pf("starting preload"),await c.preload.start(),Pf("starting storage"),c.ipns.startOffline(o),o.isNew&&!e.emptyRepo){let u=await dJe(c);Pf("adding default assets"),await VN({addAll:c.addAll,print:s}),Pf("initializing IPNS keyspace"),await c.ipns.initializeKeyspace(o.peerId.privKey,Qe(`/ipfs/${u}`))}return r.start!==!1&&(Pf("starting node"),await c.start()),c}var z3e=R(Ya()),H3e=R(gp()),$3e=R(ot()),G3e=R(vI()),W3e=R(EI());we();var Y3e=R(ft()),pJe=V3e,yJe=z3e.default,gJe=H3e.default,mJe=$3e.default,bJe=G3e.default,wJe=W3e.default;return _Je;})();
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/**
 * Timestamp for 64-bit time_t, nanosecond precision and strftime
 *
 * @author Yusuke Kawasaki
 * @license MIT
 * @see https://github.com/kawanet/timestamp-nano
 */
return IpfsCore}));
