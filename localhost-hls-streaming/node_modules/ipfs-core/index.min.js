(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpfsCore = factory()}(typeof self !== 'undefined' ? self : this, function () {
var IpfsCore=(()=>{var V6e=Object.create;var v3=Object.defineProperty;var z6e=Object.getOwnPropertyDescriptor;var H6e=Object.getOwnPropertyNames;var $6e=Object.getPrototypeOf,G6e=Object.prototype.hasOwnProperty;var VO=r=>v3(r,"__esModule",{value:!0});var Aa=(r=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(r,{get:(e,t)=>(typeof require!="undefined"?require:e)[t]}):r)(function(r){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});var qe=(r,e)=>()=>(r&&(e=r(r=0)),e);var m=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Pt=(r,e)=>{VO(r);for(var t in e)v3(r,t,{get:e[t],enumerable:!0})},W6e=(r,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of H6e(e))!G6e.call(r,i)&&i!=="default"&&v3(r,i,{get:()=>e[i],enumerable:!(t=z6e(e,i))||t.enumerable});return r},A=r=>W6e(VO(v3(r!=null?V6e($6e(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var $O=m(E3=>{l();"use strict";E3.byteLength=X6e;E3.toByteArray=Z6e;E3.fromByteArray=t5e;var Ra=[],Ls=[],Y6e=typeof Uint8Array!="undefined"?Uint8Array:Array,J_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(kf=0,zO=J_.length;kf<zO;++kf)Ra[kf]=J_[kf],Ls[J_.charCodeAt(kf)]=kf;var kf,zO;Ls["-".charCodeAt(0)]=62;Ls["_".charCodeAt(0)]=63;function HO(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function X6e(r){var e=HO(r),t=e[0],i=e[1];return(t+i)*3/4-i}function Q6e(r,e,t){return(e+t)*3/4-t}function Z6e(r){var e,t=HO(r),i=t[0],n=t[1],s=new Y6e(Q6e(r,i,n)),o=0,a=n>0?i-4:i,c;for(c=0;c<a;c+=4)e=Ls[r.charCodeAt(c)]<<18|Ls[r.charCodeAt(c+1)]<<12|Ls[r.charCodeAt(c+2)]<<6|Ls[r.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return n===2&&(e=Ls[r.charCodeAt(c)]<<2|Ls[r.charCodeAt(c+1)]>>4,s[o++]=e&255),n===1&&(e=Ls[r.charCodeAt(c)]<<10|Ls[r.charCodeAt(c+1)]<<4|Ls[r.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function J6e(r){return Ra[r>>18&63]+Ra[r>>12&63]+Ra[r>>6&63]+Ra[r&63]}function e5e(r,e,t){for(var i,n=[],s=e;s<t;s+=3)i=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),n.push(J6e(i));return n.join("")}function t5e(r){for(var e,t=r.length,i=t%3,n=[],s=16383,o=0,a=t-i;o<a;o+=s)n.push(e5e(r,o,o+s>a?a:o+s));return i===1?(e=r[t-1],n.push(Ra[e>>2]+Ra[e<<4&63]+"==")):i===2&&(e=(r[t-2]<<8)+r[t-1],n.push(Ra[e>>10]+Ra[e>>4&63]+Ra[e<<2&63]+"=")),n.join("")}});var GO=m(ev=>{l();ev.read=function(r,e,t,i,n){var s,o,a=n*8-i-1,c=(1<<a)-1,u=c>>1,f=-7,d=t?n-1:0,h=t?-1:1,p=r[e+d];for(d+=h,s=p&(1<<-f)-1,p>>=-f,f+=a;f>0;s=s*256+r[e+d],d+=h,f-=8);for(o=s&(1<<-f)-1,s>>=-f,f+=i;f>0;o=o*256+r[e+d],d+=h,f-=8);if(s===0)s=1-u;else{if(s===c)return o?NaN:(p?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-u}return(p?-1:1)*o*Math.pow(2,s-i)};ev.write=function(r,e,t,i,n,s){var o,a,c,u=s*8-n-1,f=(1<<u)-1,d=f>>1,h=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,y=i?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=f):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+d>=1?e+=h/c:e+=h*Math.pow(2,1-d),e*c>=2&&(o++,c/=2),o+d>=f?(a=0,o=f):o+d>=1?(a=(e*c-1)*Math.pow(2,n),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,n),o=0));n>=8;r[t+p]=a&255,p+=y,a/=256,n-=8);for(o=o<<n|a,u+=n;u>0;r[t+p]=o&255,p+=y,o/=256,u-=8);r[t+p-y]|=g*128}});var ci=m(Vh=>{l();"use strict";var tv=$O(),Uh=GO(),WO=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Vh.Buffer=oe;Vh.SlowBuffer=a5e;Vh.INSPECT_MAX_BYTES=50;var S3=2147483647;Vh.kMaxLength=S3;oe.TYPED_ARRAY_SUPPORT=r5e();!oe.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function r5e(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch(r){return!1}}Object.defineProperty(oe.prototype,"parent",{enumerable:!0,get:function(){if(!!oe.isBuffer(this))return this.buffer}});Object.defineProperty(oe.prototype,"offset",{enumerable:!0,get:function(){if(!!oe.isBuffer(this))return this.byteOffset}});function Bc(r){if(r>S3)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,oe.prototype),e}function oe(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return rv(r)}return YO(r,e,t)}oe.poolSize=8192;function YO(r,e,t){if(typeof r=="string")return n5e(r,e);if(ArrayBuffer.isView(r))return s5e(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(xa(r,ArrayBuffer)||r&&xa(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(xa(r,SharedArrayBuffer)||r&&xa(r.buffer,SharedArrayBuffer)))return nv(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return oe.from(i,e,t);let n=o5e(r);if(n)return n;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return oe.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}oe.from=function(r,e,t){return YO(r,e,t)};Object.setPrototypeOf(oe.prototype,Uint8Array.prototype);Object.setPrototypeOf(oe,Uint8Array);function XO(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function i5e(r,e,t){return XO(r),r<=0?Bc(r):e!==void 0?typeof t=="string"?Bc(r).fill(e,t):Bc(r).fill(e):Bc(r)}oe.alloc=function(r,e,t){return i5e(r,e,t)};function rv(r){return XO(r),Bc(r<0?0:sv(r)|0)}oe.allocUnsafe=function(r){return rv(r)};oe.allocUnsafeSlow=function(r){return rv(r)};function n5e(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!oe.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=QO(r,e)|0,i=Bc(t),n=i.write(r,e);return n!==t&&(i=i.slice(0,n)),i}function iv(r){let e=r.length<0?0:sv(r.length)|0,t=Bc(e);for(let i=0;i<e;i+=1)t[i]=r[i]&255;return t}function s5e(r){if(xa(r,Uint8Array)){let e=new Uint8Array(r);return nv(e.buffer,e.byteOffset,e.byteLength)}return iv(r)}function nv(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,oe.prototype),i}function o5e(r){if(oe.isBuffer(r)){let e=sv(r.length)|0,t=Bc(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||cv(r.length)?Bc(0):iv(r);if(r.type==="Buffer"&&Array.isArray(r.data))return iv(r.data)}function sv(r){if(r>=S3)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+S3.toString(16)+" bytes");return r|0}function a5e(r){return+r!=r&&(r=0),oe.alloc(+r)}oe.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==oe.prototype};oe.compare=function(e,t){if(xa(e,Uint8Array)&&(e=oe.from(e,e.offset,e.byteLength)),xa(t,Uint8Array)&&(t=oe.from(t,t.offset,t.byteLength)),!oe.isBuffer(e)||!oe.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,n=t.length;for(let s=0,o=Math.min(i,n);s<o;++s)if(e[s]!==t[s]){i=e[s],n=t[s];break}return i<n?-1:n<i?1:0};oe.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};oe.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return oe.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;let n=oe.allocUnsafe(t),s=0;for(i=0;i<e.length;++i){let o=e[i];if(xa(o,Uint8Array))s+o.length>n.length?(oe.isBuffer(o)||(o=oe.from(o)),o.copy(n,s)):Uint8Array.prototype.set.call(n,o,s);else if(oe.isBuffer(o))o.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return n};function QO(r,e){if(oe.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||xa(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return av(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return uk(r).length;default:if(n)return i?-1:av(r).length;e=(""+e).toLowerCase(),n=!0}}oe.byteLength=QO;function c5e(r,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return b5e(this,e,t);case"utf8":case"utf-8":return ek(this,e,t);case"ascii":return g5e(this,e,t);case"latin1":case"binary":return m5e(this,e,t);case"base64":return p5e(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w5e(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}oe.prototype._isBuffer=!0;function Df(r,e,t){let i=r[e];r[e]=r[t],r[t]=i}oe.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)Df(this,t,t+1);return this};oe.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)Df(this,t,t+3),Df(this,t+1,t+2);return this};oe.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)Df(this,t,t+7),Df(this,t+1,t+6),Df(this,t+2,t+5),Df(this,t+3,t+4);return this};oe.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?ek(this,0,e):c5e.apply(this,arguments)};oe.prototype.toLocaleString=oe.prototype.toString;oe.prototype.equals=function(e){if(!oe.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:oe.compare(this,e)===0};oe.prototype.inspect=function(){let e="",t=Vh.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};WO&&(oe.prototype[WO]=oe.prototype.inspect);oe.prototype.compare=function(e,t,i,n,s){if(xa(e,Uint8Array)&&(e=oe.from(e,e.offset,e.byteLength)),!oe.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),t<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=i)return 0;if(n>=s)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;let o=s-n,a=i-t,c=Math.min(o,a),u=this.slice(n,s),f=e.slice(t,i);for(let d=0;d<c;++d)if(u[d]!==f[d]){o=u[d],a=f[d];break}return o<a?-1:a<o?1:0};function ZO(r,e,t,i,n){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,cv(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0)if(n)t=0;else return-1;if(typeof e=="string"&&(e=oe.from(e,i)),oe.isBuffer(e))return e.length===0?-1:JO(r,e,t,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):JO(r,[e],t,i,n);throw new TypeError("val must be string, number or Buffer")}function JO(r,e,t,i,n){let s=1,o=r.length,a=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;s=2,o/=2,a/=2,t/=2}function c(f,d){return s===1?f[d]:f.readUInt16BE(d*s)}let u;if(n){let f=-1;for(u=t;u<o;u++)if(c(r,u)===c(e,f===-1?0:u-f)){if(f===-1&&(f=u),u-f+1===a)return f*s}else f!==-1&&(u-=u-f),f=-1}else for(t+a>o&&(t=o-a),u=t;u>=0;u--){let f=!0;for(let d=0;d<a;d++)if(c(r,u+d)!==c(e,d)){f=!1;break}if(f)return u}return-1}oe.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1};oe.prototype.indexOf=function(e,t,i){return ZO(this,e,t,i,!0)};oe.prototype.lastIndexOf=function(e,t,i){return ZO(this,e,t,i,!1)};function u5e(r,e,t,i){t=Number(t)||0;let n=r.length-t;i?(i=Number(i),i>n&&(i=n)):i=n;let s=e.length;i>s/2&&(i=s/2);let o;for(o=0;o<i;++o){let a=parseInt(e.substr(o*2,2),16);if(cv(a))return o;r[t+o]=a}return o}function l5e(r,e,t,i){return A3(av(e,r.length-t),r,t,i)}function f5e(r,e,t,i){return A3(S5e(e),r,t,i)}function d5e(r,e,t,i){return A3(uk(e),r,t,i)}function h5e(r,e,t,i){return A3(A5e(e,r.length-t),r,t,i)}oe.prototype.write=function(e,t,i,n){if(t===void 0)n="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")n=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-t;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return u5e(this,e,t,i);case"utf8":case"utf-8":return l5e(this,e,t,i);case"ascii":case"latin1":case"binary":return f5e(this,e,t,i);case"base64":return d5e(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return h5e(this,e,t,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};oe.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function p5e(r,e,t){return e===0&&t===r.length?tv.fromByteArray(r):tv.fromByteArray(r.slice(e,t))}function ek(r,e,t){t=Math.min(r.length,t);let i=[],n=e;for(;n<t;){let s=r[n],o=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a<=t){let c,u,f,d;switch(a){case 1:s<128&&(o=s);break;case 2:c=r[n+1],(c&192)==128&&(d=(s&31)<<6|c&63,d>127&&(o=d));break;case 3:c=r[n+1],u=r[n+2],(c&192)==128&&(u&192)==128&&(d=(s&15)<<12|(c&63)<<6|u&63,d>2047&&(d<55296||d>57343)&&(o=d));break;case 4:c=r[n+1],u=r[n+2],f=r[n+3],(c&192)==128&&(u&192)==128&&(f&192)==128&&(d=(s&15)<<18|(c&63)<<12|(u&63)<<6|f&63,d>65535&&d<1114112&&(o=d))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),n+=a}return y5e(i)}var tk=4096;function y5e(r){let e=r.length;if(e<=tk)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=tk));return t}function g5e(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]&127);return i}function m5e(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]);return i}function b5e(r,e,t){let i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let n="";for(let s=e;s<t;++s)n+=R5e[r[s]];return n}function w5e(r,e,t){let i=r.slice(e,t),n="";for(let s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}oe.prototype.slice=function(e,t){let i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);let n=this.subarray(e,t);return Object.setPrototypeOf(n,oe.prototype),n};function zi(r,e,t){if(r%1!=0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}oe.prototype.readUintLE=oe.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||zi(e,t,this.length);let n=this[e],s=1,o=0;for(;++o<t&&(s*=256);)n+=this[e+o]*s;return n};oe.prototype.readUintBE=oe.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||zi(e,t,this.length);let n=this[e+--t],s=1;for(;t>0&&(s*=256);)n+=this[e+--t]*s;return n};oe.prototype.readUint8=oe.prototype.readUInt8=function(e,t){return e=e>>>0,t||zi(e,1,this.length),this[e]};oe.prototype.readUint16LE=oe.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||zi(e,2,this.length),this[e]|this[e+1]<<8};oe.prototype.readUint16BE=oe.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||zi(e,2,this.length),this[e]<<8|this[e+1]};oe.prototype.readUint32LE=oe.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||zi(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};oe.prototype.readUint32BE=oe.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||zi(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};oe.prototype.readBigUInt64LE=Fu(function(e){e=e>>>0,Kh(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&yy(e,this.length-8);let n=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))});oe.prototype.readBigUInt64BE=Fu(function(e){e=e>>>0,Kh(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&yy(e,this.length-8);let n=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(s)});oe.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||zi(e,t,this.length);let n=this[e],s=1,o=0;for(;++o<t&&(s*=256);)n+=this[e+o]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n};oe.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||zi(e,t,this.length);let n=t,s=1,o=this[e+--n];for(;n>0&&(s*=256);)o+=this[e+--n]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*t)),o};oe.prototype.readInt8=function(e,t){return e=e>>>0,t||zi(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};oe.prototype.readInt16LE=function(e,t){e=e>>>0,t||zi(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};oe.prototype.readInt16BE=function(e,t){e=e>>>0,t||zi(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};oe.prototype.readInt32LE=function(e,t){return e=e>>>0,t||zi(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};oe.prototype.readInt32BE=function(e,t){return e=e>>>0,t||zi(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};oe.prototype.readBigInt64LE=Fu(function(e){e=e>>>0,Kh(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&yy(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});oe.prototype.readBigInt64BE=Fu(function(e){e=e>>>0,Kh(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&yy(e,this.length-8);let n=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});oe.prototype.readFloatLE=function(e,t){return e=e>>>0,t||zi(e,4,this.length),Uh.read(this,e,!0,23,4)};oe.prototype.readFloatBE=function(e,t){return e=e>>>0,t||zi(e,4,this.length),Uh.read(this,e,!1,23,4)};oe.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||zi(e,8,this.length),Uh.read(this,e,!0,52,8)};oe.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||zi(e,8,this.length),Uh.read(this,e,!1,52,8)};function Hn(r,e,t,i,n,s){if(!oe.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}oe.prototype.writeUintLE=oe.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;Hn(this,e,t,i,a,0)}let s=1,o=0;for(this[t]=e&255;++o<i&&(s*=256);)this[t+o]=e/s&255;return t+i};oe.prototype.writeUintBE=oe.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;Hn(this,e,t,i,a,0)}let s=i-1,o=1;for(this[t+s]=e&255;--s>=0&&(o*=256);)this[t+s]=e/o&255;return t+i};oe.prototype.writeUint8=oe.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,1,255,0),this[t]=e&255,t+1};oe.prototype.writeUint16LE=oe.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};oe.prototype.writeUint16BE=oe.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};oe.prototype.writeUint32LE=oe.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};oe.prototype.writeUint32BE=oe.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function rk(r,e,t,i,n){ck(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,t}function ik(r,e,t,i,n){ck(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t+7]=s,s=s>>8,r[t+6]=s,s=s>>8,r[t+5]=s,s=s>>8,r[t+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=o,o=o>>8,r[t+2]=o,o=o>>8,r[t+1]=o,o=o>>8,r[t]=o,t+8}oe.prototype.writeBigUInt64LE=Fu(function(e,t=0){return rk(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});oe.prototype.writeBigUInt64BE=Fu(function(e,t=0){return ik(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});oe.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let c=Math.pow(2,8*i-1);Hn(this,e,t,i,c-1,-c)}let s=0,o=1,a=0;for(this[t]=e&255;++s<i&&(o*=256);)e<0&&a===0&&this[t+s-1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i};oe.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let c=Math.pow(2,8*i-1);Hn(this,e,t,i,c-1,-c)}let s=i-1,o=1,a=0;for(this[t+s]=e&255;--s>=0&&(o*=256);)e<0&&a===0&&this[t+s+1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i};oe.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};oe.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};oe.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};oe.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};oe.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||Hn(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};oe.prototype.writeBigInt64LE=Fu(function(e,t=0){return rk(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});oe.prototype.writeBigInt64BE=Fu(function(e,t=0){return ik(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function nk(r,e,t,i,n,s){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function sk(r,e,t,i,n){return e=+e,t=t>>>0,n||nk(r,e,t,4,34028234663852886e22,-34028234663852886e22),Uh.write(r,e,t,i,23,4),t+4}oe.prototype.writeFloatLE=function(e,t,i){return sk(this,e,t,!0,i)};oe.prototype.writeFloatBE=function(e,t,i){return sk(this,e,t,!1,i)};function ok(r,e,t,i,n){return e=+e,t=t>>>0,n||nk(r,e,t,8,17976931348623157e292,-17976931348623157e292),Uh.write(r,e,t,i,52,8),t+8}oe.prototype.writeDoubleLE=function(e,t,i){return ok(this,e,t,!0,i)};oe.prototype.writeDoubleBE=function(e,t,i){return ok(this,e,t,!1,i)};oe.prototype.copy=function(e,t,i,n){if(!oe.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);let s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),s};oe.prototype.fill=function(e,t,i,n){if(typeof e=="string"){if(typeof t=="string"?(n=t,t=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!oe.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let o=e.charCodeAt(0);(n==="utf8"&&o<128||n==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let s;if(typeof e=="number")for(s=t;s<i;++s)this[s]=e;else{let o=oe.isBuffer(e)?e:oe.from(e,n),a=o.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=o[s%a]}return this};var Fh={};function ov(r,e,t){Fh[r]=class extends t{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}ov("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);ov("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);ov("ERR_OUT_OF_RANGE",function(r,e,t){let i=`The value of "${r}" is out of range.`,n=t;return Number.isInteger(t)&&Math.abs(t)>2**32?n=ak(String(t)):typeof t=="bigint"&&(n=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(n=ak(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function ak(r){let e="",t=r.length,i=r[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function _5e(r,e,t){Kh(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&yy(e,r.length-(t+1))}function ck(r,e,t,i,n,s){if(r>t||r<e){let o=typeof e=="bigint"?"n":"",a;throw s>3?e===0||e===BigInt(0)?a=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:a=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:a=`>= ${e}${o} and <= ${t}${o}`,new Fh.ERR_OUT_OF_RANGE("value",a,r)}_5e(i,n,s)}function Kh(r,e){if(typeof r!="number")throw new Fh.ERR_INVALID_ARG_TYPE(e,"number",r)}function yy(r,e,t){throw Math.floor(r)!==r?(Kh(r,t),new Fh.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new Fh.ERR_BUFFER_OUT_OF_BOUNDS:new Fh.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}var v5e=/[^+/0-9A-Za-z-_]/g;function E5e(r){if(r=r.split("=")[0],r=r.trim().replace(v5e,""),r.length<2)return"";for(;r.length%4!=0;)r=r+"=";return r}function av(r,e){e=e||1/0;let t,i=r.length,n=null,s=[];for(let o=0;o<i;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function S5e(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function A5e(r,e){let t,i,n,s=[];for(let o=0;o<r.length&&!((e-=2)<0);++o)t=r.charCodeAt(o),i=t>>8,n=t%256,s.push(n),s.push(i);return s}function uk(r){return tv.toByteArray(E5e(r))}function A3(r,e,t,i){let n;for(n=0;n<i&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function xa(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function cv(r){return r!==r}var R5e=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let i=t*16;for(let n=0;n<16;++n)e[i+n]=r[t]+r[n]}return e}();function Fu(r){return typeof BigInt=="undefined"?x5e:r}function x5e(){throw new Error("BigInt not supported")}});var pk=m((Brt,hk)=>{l();var ui=hk.exports={},Ia,Ta;function uv(){throw new Error("setTimeout has not been defined")}function lv(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Ia=setTimeout:Ia=uv}catch(r){Ia=uv}try{typeof clearTimeout=="function"?Ta=clearTimeout:Ta=lv}catch(r){Ta=lv}})();function lk(r){if(Ia===setTimeout)return setTimeout(r,0);if((Ia===uv||!Ia)&&setTimeout)return Ia=setTimeout,setTimeout(r,0);try{return Ia(r,0)}catch(e){try{return Ia.call(null,r,0)}catch(t){return Ia.call(this,r,0)}}}function I5e(r){if(Ta===clearTimeout)return clearTimeout(r);if((Ta===lv||!Ta)&&clearTimeout)return Ta=clearTimeout,clearTimeout(r);try{return Ta(r)}catch(e){try{return Ta.call(null,r)}catch(t){return Ta.call(this,r)}}}var Lc=[],zh=!1,Nf,R3=-1;function T5e(){!zh||!Nf||(zh=!1,Nf.length?Lc=Nf.concat(Lc):R3=-1,Lc.length&&fk())}function fk(){if(!zh){var r=lk(T5e);zh=!0;for(var e=Lc.length;e;){for(Nf=Lc,Lc=[];++R3<e;)Nf&&Nf[R3].run();R3=-1,e=Lc.length}Nf=null,zh=!1,I5e(r)}}ui.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];Lc.push(new dk(r,e)),Lc.length===1&&!zh&&lk(fk)};function dk(r,e){this.fun=r,this.array=e}dk.prototype.run=function(){this.fun.apply(null,this.array)};ui.title="browser";ui.browser=!0;ui.env={};ui.argv=[];ui.version="";ui.versions={};function Mc(){}ui.on=Mc;ui.addListener=Mc;ui.once=Mc;ui.off=Mc;ui.removeListener=Mc;ui.removeAllListeners=Mc;ui.emit=Mc;ui.prependListener=Mc;ui.prependOnceListener=Mc;ui.listeners=function(r){return[]};ui.binding=function(r){throw new Error("process.binding is not supported")};ui.cwd=function(){return"/"};ui.chdir=function(r){throw new Error("process.chdir is not supported")};ui.umask=function(){return 0}});var Buffer,process,l=qe(()=>{({Buffer}=ci()),process=pk()});var gk=m((Mrt,yk)=>{l();"use strict";yk.exports=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;let e=Object.getPrototypeOf(r);return e===null||e===Object.prototype}});var Ku=m((_k,vk)=>{l();"use strict";var x3=gk(),{hasOwnProperty:mk}=Object.prototype,{propertyIsEnumerable:P5e}=Object,Hh=(r,e,t)=>Object.defineProperty(r,e,{value:t,writable:!0,enumerable:!0,configurable:!0}),C5e=_k,bk={concatArrays:!1,ignoreUndefined:!1},I3=r=>{let e=[];for(let t in r)mk.call(r,t)&&e.push(t);if(Object.getOwnPropertySymbols){let t=Object.getOwnPropertySymbols(r);for(let i of t)P5e.call(r,i)&&e.push(i)}return e};function $h(r){return Array.isArray(r)?O5e(r):x3(r)?k5e(r):r}function O5e(r){let e=r.slice(0,0);return I3(r).forEach(t=>{Hh(e,t,$h(r[t]))}),e}function k5e(r){let e=Object.getPrototypeOf(r)===null?Object.create(null):{};return I3(r).forEach(t=>{Hh(e,t,$h(r[t]))}),e}var wk=(r,e,t,i)=>(t.forEach(n=>{typeof e[n]=="undefined"&&i.ignoreUndefined||(n in r&&r[n]!==Object.getPrototypeOf(r)?Hh(r,n,fv(r[n],e[n],i)):Hh(r,n,$h(e[n])))}),r),D5e=(r,e,t)=>{let i=r.slice(0,0),n=0;return[r,e].forEach(s=>{let o=[];for(let a=0;a<s.length;a++)!mk.call(s,a)||(o.push(String(a)),s===r?Hh(i,n++,s[a]):Hh(i,n++,$h(s[a])));i=wk(i,s,I3(s).filter(a=>!o.includes(a)),t)}),i};function fv(r,e,t){return t.concatArrays&&Array.isArray(r)&&Array.isArray(e)?D5e(r,e,t):!x3(e)||!x3(r)?$h(e):wk(r,e,I3(e),t)}vk.exports=function(...r){let e=fv($h(bk),this!==C5e&&this||{},bk),t={_:{}};for(let i of r)if(i!==void 0){if(!x3(i))throw new TypeError("`"+i+"` is not an Option Object");t=fv(t,{_:i},e)}return t._}});var dv=m((qrt,Sk)=>{l();function N5e(){return typeof window!="undefined"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process!="undefined"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}Sk.exports=N5e});var my=m((Urt,Ak)=>{l();"use strict";var B5e=dv(),T3=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,gy=B5e(),L5e=T3&&!gy,M5e=gy&&!T3,j5e=gy&&T3,q5e=typeof Aa=="function"&&typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!gy,U5e=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,F5e=typeof process!="undefined"&&typeof process.env!="undefined"&&!1,K5e=typeof navigator!="undefined"&&navigator.product==="ReactNative";Ak.exports={isTest:F5e,isElectron:gy,isElectronMain:M5e,isElectronRenderer:j5e,isNode:q5e,isBrowser:L5e,isWebWorker:U5e,isEnvWithDom:T3,isReactNative:K5e}});var hv=m((Frt,Rk)=>{l();var Gh=1e3,Wh=Gh*60,Yh=Wh*60,Bf=Yh*24,V5e=Bf*7,z5e=Bf*365.25;Rk.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return H5e(r);if(t==="number"&&isFinite(r))return e.long?G5e(r):$5e(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function H5e(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!e){var t=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return t*z5e;case"weeks":case"week":case"w":return t*V5e;case"days":case"day":case"d":return t*Bf;case"hours":case"hour":case"hrs":case"hr":case"h":return t*Yh;case"minutes":case"minute":case"mins":case"min":case"m":return t*Wh;case"seconds":case"second":case"secs":case"sec":case"s":return t*Gh;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function $5e(r){var e=Math.abs(r);return e>=Bf?Math.round(r/Bf)+"d":e>=Yh?Math.round(r/Yh)+"h":e>=Wh?Math.round(r/Wh)+"m":e>=Gh?Math.round(r/Gh)+"s":r+"ms"}function G5e(r){var e=Math.abs(r);return e>=Bf?P3(r,e,Bf,"day"):e>=Yh?P3(r,e,Yh,"hour"):e>=Wh?P3(r,e,Wh,"minute"):e>=Gh?P3(r,e,Gh,"second"):r+" ms"}function P3(r,e,t,i){var n=e>=t*1.5;return Math.round(r/t)+" "+i+(n?"s":"")}});var Ik=m((Krt,xk)=>{l();function W5e(r){t.debug=t,t.default=t,t.coerce=c,t.disable=s,t.enable=n,t.enabled=o,t.humanize=hv(),t.destroy=u,Object.keys(r).forEach(f=>{t[f]=r[f]}),t.names=[],t.skips=[],t.formatters={};function e(f){let d=0;for(let h=0;h<f.length;h++)d=(d<<5)-d+f.charCodeAt(h),d|=0;return t.colors[Math.abs(d)%t.colors.length]}t.selectColor=e;function t(f){let d,h=null,p,y;function g(...w){if(!g.enabled)return;let b=g,v=Number(new Date),R=v-(d||v);b.diff=R,b.prev=d,b.curr=v,d=v,w[0]=t.coerce(w[0]),typeof w[0]!="string"&&w.unshift("%O");let k=0;w[0]=w[0].replace(/%([a-zA-Z%])/g,(T,D)=>{if(T==="%%")return"%";k++;let j=t.formatters[D];if(typeof j=="function"){let M=w[k];T=j.call(b,M),w.splice(k,1),k--}return T}),t.formatArgs.call(b,w),(b.log||t.log).apply(b,w)}return g.namespace=f,g.useColors=t.useColors(),g.color=t.selectColor(f),g.extend=i,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(p!==t.namespaces&&(p=t.namespaces,y=t.enabled(f)),y),set:w=>{h=w}}),typeof t.init=="function"&&t.init(g),g}function i(f,d){let h=t(this.namespace+(typeof d=="undefined"?":":d)+f);return h.log=this.log,h}function n(f){t.save(f),t.namespaces=f,t.names=[],t.skips=[];let d,h=(typeof f=="string"?f:"").split(/[\s,]+/),p=h.length;for(d=0;d<p;d++)!h[d]||(f=h[d].replace(/\*/g,".*?"),f[0]==="-"?t.skips.push(new RegExp("^"+f.substr(1)+"$")):t.names.push(new RegExp("^"+f+"$")))}function s(){let f=[...t.names.map(a),...t.skips.map(a).map(d=>"-"+d)].join(",");return t.enable(""),f}function o(f){if(f[f.length-1]==="*")return!0;let d,h;for(d=0,h=t.skips.length;d<h;d++)if(t.skips[d].test(f))return!1;for(d=0,h=t.names.length;d<h;d++)if(t.names[d].test(f))return!0;return!1}function a(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function c(f){return f instanceof Error?f.stack||f.message:f}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}xk.exports=W5e});var le=m((ds,C3)=>{l();ds.formatArgs=X5e;ds.save=Q5e;ds.load=Z5e;ds.useColors=Y5e;ds.storage=J5e();ds.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();ds.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Y5e(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function X5e(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+C3.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,i=0;r[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(t++,n==="%c"&&(i=t))}),r.splice(i,0,e)}ds.log=console.debug||console.log||(()=>{});function Q5e(r){try{r?ds.storage.setItem("debug",r):ds.storage.removeItem("debug")}catch(e){}}function Z5e(){let r;try{r=ds.storage.getItem("debug")}catch(e){}return!r&&typeof process!="undefined"&&"env"in process&&(r=process.env.DEBUG),r}function J5e(){try{return localStorage}catch(r){}}C3.exports=Ik()(ds);var{formatters:ewe}=C3.exports;ewe.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var St=m((Vrt,Pk)=>{l();"use strict";function Tk(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function twe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Tk(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Tk(new n,t)}}Pk.exports=twe});var kk=m((zrt,Ok)=>{l();"use strict";function Ck(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function rwe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Ck(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Ck(new n,t)}}Ok.exports=rwe});var Nk=m((Hrt,Dk)=>{l();"use strict";Dk.exports=iwe;function iwe(r,e){for(var t=new Array(arguments.length-1),i=0,n=2,s=!0;n<arguments.length;)t[i++]=arguments[n++];return new Promise(function(a,c){t[i]=function(f){if(s)if(s=!1,f)c(f);else{for(var d=new Array(arguments.length-1),h=0;h<d.length;)d[h++]=arguments[h];a.apply(null,d)}};try{r.apply(e||null,t)}catch(u){s&&(s=!1,c(u))}})}});var jk=m(Mk=>{l();"use strict";var O3=Mk;O3.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&e.charAt(t)==="=";)++i;return Math.ceil(e.length*3)/4-i};var Xh=new Array(64),Bk=new Array(123);for(qo=0;qo<64;)Bk[Xh[qo]=qo<26?qo+65:qo<52?qo+71:qo<62?qo-4:qo-59|43]=qo++;var qo;O3.encode=function(e,t,i){for(var n=null,s=[],o=0,a=0,c;t<i;){var u=e[t++];switch(a){case 0:s[o++]=Xh[u>>2],c=(u&3)<<4,a=1;break;case 1:s[o++]=Xh[c|u>>4],c=(u&15)<<2,a=2;break;case 2:s[o++]=Xh[c|u>>6],s[o++]=Xh[u&63],a=0;break}o>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=Xh[c],s[o++]=61,a===1&&(s[o++]=61)),n?(o&&n.push(String.fromCharCode.apply(String,s.slice(0,o))),n.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var Lk="invalid encoding";O3.decode=function(e,t,i){for(var n=i,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=Bk[c])===void 0)throw Error(Lk);switch(s){case 0:o=c,s=1;break;case 1:t[i++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:t[i++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:t[i++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(Lk);return i-n};O3.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Uk=m((Grt,qk)=>{l();"use strict";qk.exports=k3;function k3(){this._listeners={}}k3.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this};k3.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===t?i.splice(n,1):++n;return this};k3.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,i)}return this}});var Gk=m((Wrt,$k)=>{l();"use strict";$k.exports=Fk(Fk);function Fk(r){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),i=t[3]===128;function n(c,u,f){e[0]=c,u[f]=t[0],u[f+1]=t[1],u[f+2]=t[2],u[f+3]=t[3]}function s(c,u,f){e[0]=c,u[f]=t[3],u[f+1]=t[2],u[f+2]=t[1],u[f+3]=t[0]}r.writeFloatLE=i?n:s,r.writeFloatBE=i?s:n;function o(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],e[0]}function a(c,u){return t[3]=c[u],t[2]=c[u+1],t[1]=c[u+2],t[0]=c[u+3],e[0]}r.readFloatLE=i?o:a,r.readFloatBE=i?a:o}():function(){function e(i,n,s,o){var a=n<0?1:0;if(a&&(n=-n),n===0)i(1/n>0?0:2147483648,s,o);else if(isNaN(n))i(2143289344,s,o);else if(n>34028234663852886e22)i((a<<31|2139095040)>>>0,s,o);else if(n<11754943508222875e-54)i((a<<31|Math.round(n/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(n)/Math.LN2),u=Math.round(n*Math.pow(2,-c)*8388608)&8388607;i((a<<31|c+127<<23|u)>>>0,s,o)}}r.writeFloatLE=e.bind(null,Kk),r.writeFloatBE=e.bind(null,Vk);function t(i,n,s){var o=i(n,s),a=(o>>31)*2+1,c=o>>>23&255,u=o&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}r.readFloatLE=t.bind(null,zk),r.readFloatBE=t.bind(null,Hk)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),i=t[7]===128;function n(c,u,f){e[0]=c,u[f]=t[0],u[f+1]=t[1],u[f+2]=t[2],u[f+3]=t[3],u[f+4]=t[4],u[f+5]=t[5],u[f+6]=t[6],u[f+7]=t[7]}function s(c,u,f){e[0]=c,u[f]=t[7],u[f+1]=t[6],u[f+2]=t[5],u[f+3]=t[4],u[f+4]=t[3],u[f+5]=t[2],u[f+6]=t[1],u[f+7]=t[0]}r.writeDoubleLE=i?n:s,r.writeDoubleBE=i?s:n;function o(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],t[4]=c[u+4],t[5]=c[u+5],t[6]=c[u+6],t[7]=c[u+7],e[0]}function a(c,u){return t[7]=c[u],t[6]=c[u+1],t[5]=c[u+2],t[4]=c[u+3],t[3]=c[u+4],t[2]=c[u+5],t[1]=c[u+6],t[0]=c[u+7],e[0]}r.readDoubleLE=i?o:a,r.readDoubleBE=i?a:o}():function(){function e(i,n,s,o,a,c){var u=o<0?1:0;if(u&&(o=-o),o===0)i(0,a,c+n),i(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))i(0,a,c+n),i(2146959360,a,c+s);else if(o>17976931348623157e292)i(0,a,c+n),i((u<<31|2146435072)>>>0,a,c+s);else{var f;if(o<22250738585072014e-324)f=o/5e-324,i(f>>>0,a,c+n),i((u<<31|f/4294967296)>>>0,a,c+s);else{var d=Math.floor(Math.log(o)/Math.LN2);d===1024&&(d=1023),f=o*Math.pow(2,-d),i(f*4503599627370496>>>0,a,c+n),i((u<<31|d+1023<<20|f*1048576&1048575)>>>0,a,c+s)}}}r.writeDoubleLE=e.bind(null,Kk,0,4),r.writeDoubleBE=e.bind(null,Vk,4,0);function t(i,n,s,o,a){var c=i(o,a+n),u=i(o,a+s),f=(u>>31)*2+1,d=u>>>20&2047,h=4294967296*(u&1048575)+c;return d===2047?h?NaN:f*(1/0):d===0?f*5e-324*h:f*Math.pow(2,d-1075)*(h+4503599627370496)}r.readDoubleLE=t.bind(null,zk,0,4),r.readDoubleBE=t.bind(null,Hk,4,0)}(),r}function Kk(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}function Vk(r,e,t){e[t]=r>>>24,e[t+1]=r>>>16&255,e[t+2]=r>>>8&255,e[t+3]=r&255}function zk(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0}function Hk(r,e){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}});var Wk=m((exports,module)=>{l();"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var Xk=m(Yk=>{l();"use strict";var pv=Yk;pv.length=function(e){for(var t=0,i=0,n=0;n<e.length;++n)i=e.charCodeAt(n),i<128?t+=1:i<2048?t+=2:(i&64512)==55296&&(e.charCodeAt(n+1)&64512)==56320?(++n,t+=4):t+=3;return t};pv.read=function(e,t,i){var n=i-t;if(n<1)return"";for(var s=null,o=[],a=0,c;t<i;)c=e[t++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[t++]&63:c>239&&c<365?(c=((c&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};pv.write=function(e,t,i){for(var n=i,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=s&63|128):(s&64512)==55296&&((o=e.charCodeAt(a+1))&64512)==56320?(s=65536+((s&1023)<<10)+(o&1023),++a,t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=s&63|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=s&63|128);return i-n}});var Zk=m((Xrt,Qk)=>{l();"use strict";Qk.exports=nwe;function nwe(r,e,t){var i=t||8192,n=i>>>1,s=null,o=i;return function(c){if(c<1||c>n)return r(c);o+c>i&&(s=r(i),o=0);var u=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),u}}});var eD=m((Qrt,Jk)=>{l();"use strict";Jk.exports=Hi;var by=zu();function Hi(r,e){this.lo=r>>>0,this.hi=e>>>0}var Lf=Hi.zero=new Hi(0,0);Lf.toNumber=function(){return 0};Lf.zzEncode=Lf.zzDecode=function(){return this};Lf.length=function(){return 1};var swe=Hi.zeroHash="\0\0\0\0\0\0\0\0";Hi.fromNumber=function(e){if(e===0)return Lf;var t=e<0;t&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return t&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new Hi(i,n)};Hi.from=function(e){if(typeof e=="number")return Hi.fromNumber(e);if(by.isString(e))if(by.Long)e=by.Long.fromString(e);else return Hi.fromNumber(parseInt(e,10));return e.low||e.high?new Hi(e.low>>>0,e.high>>>0):Lf};Hi.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+i*4294967296)}return this.lo+this.hi*4294967296};Hi.prototype.toLong=function(e){return by.Long?new by.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Vu=String.prototype.charCodeAt;Hi.fromHash=function(e){return e===swe?Lf:new Hi((Vu.call(e,0)|Vu.call(e,1)<<8|Vu.call(e,2)<<16|Vu.call(e,3)<<24)>>>0,(Vu.call(e,4)|Vu.call(e,5)<<8|Vu.call(e,6)<<16|Vu.call(e,7)<<24)>>>0)};Hi.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Hi.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Hi.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Hi.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}});var zu=m(yv=>{l();"use strict";var Ge=yv;Ge.asPromise=Nk();Ge.base64=jk();Ge.EventEmitter=Uk();Ge.float=Gk();Ge.inquire=Wk();Ge.utf8=Xk();Ge.pool=Zk();Ge.LongBits=eD();Ge.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);Ge.global=Ge.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||yv;Ge.emptyArray=Object.freeze?Object.freeze([]):[];Ge.emptyObject=Object.freeze?Object.freeze({}):{};Ge.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};Ge.isString=function(e){return typeof e=="string"||e instanceof String};Ge.isObject=function(e){return e&&typeof e=="object"};Ge.isset=Ge.isSet=function(e,t){var i=e[t];return i!=null&&e.hasOwnProperty(t)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1};Ge.Buffer=function(){try{var r=Ge.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch(e){return null}}();Ge._Buffer_from=null;Ge._Buffer_allocUnsafe=null;Ge.newBuffer=function(e){return typeof e=="number"?Ge.Buffer?Ge._Buffer_allocUnsafe(e):new Ge.Array(e):Ge.Buffer?Ge._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};Ge.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;Ge.Long=Ge.global.dcodeIO&&Ge.global.dcodeIO.Long||Ge.global.Long||Ge.inquire("long");Ge.key2Re=/^true|false|0|1$/;Ge.key32Re=/^-?(?:0|[1-9][0-9]*)$/;Ge.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;Ge.longToHash=function(e){return e?Ge.LongBits.from(e).toHash():Ge.LongBits.zeroHash};Ge.longFromHash=function(e,t){var i=Ge.LongBits.fromHash(e);return Ge.Long?Ge.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))};function tD(r,e,t){for(var i=Object.keys(e),n=0;n<i.length;++n)(r[i[n]]===void 0||!t)&&(r[i[n]]=e[i[n]]);return r}Ge.merge=tD;Ge.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function rD(r){function e(t,i){if(!(this instanceof e))return new e(t,i);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),i&&tD(this,i)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return r}}),e.prototype.toString=function(){return this.name+": "+this.message},e}Ge.newError=rD;Ge.ProtocolError=rD("ProtocolError");Ge.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var n=Object.keys(this),s=n.length-1;s>-1;--s)if(t[n[s]]===1&&this[n[s]]!==void 0&&this[n[s]]!==null)return n[s]}};Ge.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}};Ge.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};Ge._configure=function(){var r=Ge.Buffer;if(!r){Ge._Buffer_from=Ge._Buffer_allocUnsafe=null;return}Ge._Buffer_from=r.from!==Uint8Array.from&&r.from||function(t,i){return new r(t,i)},Ge._Buffer_allocUnsafe=r.allocUnsafe||function(t){return new r(t)}}});var Ev=m((Jrt,oD)=>{l();"use strict";oD.exports=zt;var Ms=zu(),gv,D3=Ms.LongBits,iD=Ms.base64,nD=Ms.utf8;function wy(r,e,t){this.fn=r,this.len=e,this.next=void 0,this.val=t}function mv(){}function owe(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function zt(){this.len=0,this.head=new wy(mv,0,0),this.tail=this.head,this.states=null}var sD=function(){return Ms.Buffer?function(){return(zt.create=function(){return new gv})()}:function(){return new zt}};zt.create=sD();zt.alloc=function(e){return new Ms.Array(e)};Ms.Array!==Array&&(zt.alloc=Ms.pool(zt.alloc,Ms.Array.prototype.subarray));zt.prototype._push=function(e,t,i){return this.tail=this.tail.next=new wy(e,t,i),this.len+=t,this};function bv(r,e,t){e[t]=r&255}function awe(r,e,t){for(;r>127;)e[t++]=r&127|128,r>>>=7;e[t]=r}function wv(r,e){this.len=r,this.next=void 0,this.val=e}wv.prototype=Object.create(wy.prototype);wv.prototype.fn=awe;zt.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new wv((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};zt.prototype.int32=function(e){return e<0?this._push(_v,10,D3.fromNumber(e)):this.uint32(e)};zt.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function _v(r,e,t){for(;r.hi;)e[t++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)e[t++]=r.lo&127|128,r.lo=r.lo>>>7;e[t++]=r.lo}zt.prototype.uint64=function(e){var t=D3.from(e);return this._push(_v,t.length(),t)};zt.prototype.int64=zt.prototype.uint64;zt.prototype.sint64=function(e){var t=D3.from(e).zzEncode();return this._push(_v,t.length(),t)};zt.prototype.bool=function(e){return this._push(bv,1,e?1:0)};function vv(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}zt.prototype.fixed32=function(e){return this._push(vv,4,e>>>0)};zt.prototype.sfixed32=zt.prototype.fixed32;zt.prototype.fixed64=function(e){var t=D3.from(e);return this._push(vv,4,t.lo)._push(vv,4,t.hi)};zt.prototype.sfixed64=zt.prototype.fixed64;zt.prototype.float=function(e){return this._push(Ms.float.writeFloatLE,4,e)};zt.prototype.double=function(e){return this._push(Ms.float.writeDoubleLE,8,e)};var cwe=Ms.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var n=0;n<e.length;++n)t[i+n]=e[n]};zt.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(bv,1,0);if(Ms.isString(e)){var i=zt.alloc(t=iD.length(e));iD.decode(e,i,0),e=i}return this.uint32(t)._push(cwe,t,e)};zt.prototype.string=function(e){var t=nD.length(e);return t?this.uint32(t)._push(nD.write,t,e):this._push(bv,1,0)};zt.prototype.fork=function(){return this.states=new owe(this),this.head=this.tail=new wy(mv,0,0),this.len=0,this};zt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new wy(mv,0,0),this.len=0),this};zt.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this};zt.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t};zt._configure=function(r){gv=r,zt.create=sD(),gv._configure()}});var uD=m((eit,cD)=>{l();"use strict";cD.exports=Pa;var aD=Ev();(Pa.prototype=Object.create(aD.prototype)).constructor=Pa;var Hu=zu();function Pa(){aD.call(this)}Pa._configure=function(){Pa.alloc=Hu._Buffer_allocUnsafe,Pa.writeBytesBuffer=Hu.Buffer&&Hu.Buffer.prototype instanceof Uint8Array&&Hu.Buffer.prototype.set.name==="set"?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var n=0;n<e.length;)t[i++]=e[n++]}};Pa.prototype.bytes=function(e){Hu.isString(e)&&(e=Hu._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(Pa.writeBytesBuffer,t,e),this};function uwe(r,e,t){r.length<40?Hu.utf8.write(r,e,t):e.utf8Write?e.utf8Write(r,t):e.write(r,t)}Pa.prototype.string=function(e){var t=Hu.Buffer.byteLength(e);return this.uint32(t),t&&this._push(uwe,t,e),this};Pa._configure()});var Rv=m((tit,pD)=>{l();"use strict";pD.exports=li;var Ca=zu(),Sv,lD=Ca.LongBits,lwe=Ca.utf8;function Uo(r,e){return RangeError("index out of range: "+r.pos+" + "+(e||1)+" > "+r.len)}function li(r){this.buf=r,this.pos=0,this.len=r.length}var fD=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new li(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new li(e);throw Error("illegal buffer")},dD=function(){return Ca.Buffer?function(t){return(li.create=function(n){return Ca.Buffer.isBuffer(n)?new Sv(n):fD(n)})(t)}:fD};li.create=dD();li.prototype._slice=Ca.Array.prototype.subarray||Ca.Array.prototype.slice;li.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Uo(this,10);return e}}();li.prototype.int32=function(){return this.uint32()|0};li.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Av(){var r=new lD(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Uo(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,r}if(this.len-this.pos>4){for(;e<5;++e)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;e<5;++e){if(this.pos>=this.len)throw Uo(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}li.prototype.bool=function(){return this.uint32()!==0};function N3(r,e){return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0}li.prototype.fixed32=function(){if(this.pos+4>this.len)throw Uo(this,4);return N3(this.buf,this.pos+=4)};li.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Uo(this,4);return N3(this.buf,this.pos+=4)|0};function hD(){if(this.pos+8>this.len)throw Uo(this,8);return new lD(N3(this.buf,this.pos+=4),N3(this.buf,this.pos+=4))}li.prototype.float=function(){if(this.pos+4>this.len)throw Uo(this,4);var e=Ca.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};li.prototype.double=function(){if(this.pos+8>this.len)throw Uo(this,4);var e=Ca.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};li.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw Uo(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,i):t===i?new this.buf.constructor(0):this._slice.call(this.buf,t,i)};li.prototype.string=function(){var e=this.bytes();return lwe.read(e,0,e.length)};li.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Uo(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Uo(this);while(this.buf[this.pos++]&128);return this};li.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!=4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};li._configure=function(r){Sv=r,li.create=dD(),Sv._configure();var e=Ca.Long?"toLong":"toNumber";Ca.merge(li.prototype,{int64:function(){return Av.call(this)[e](!1)},uint64:function(){return Av.call(this)[e](!0)},sint64:function(){return Av.call(this).zzDecode()[e](!1)},fixed64:function(){return hD.call(this)[e](!0)},sfixed64:function(){return hD.call(this)[e](!1)}})}});var bD=m((rit,mD)=>{l();"use strict";mD.exports=Mf;var yD=Rv();(Mf.prototype=Object.create(yD.prototype)).constructor=Mf;var gD=zu();function Mf(r){yD.call(this,r)}Mf._configure=function(){gD.Buffer&&(Mf.prototype._slice=gD.Buffer.prototype.slice)};Mf.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Mf._configure()});var _D=m((iit,wD)=>{l();"use strict";wD.exports=_y;var xv=zu();(_y.prototype=Object.create(xv.EventEmitter.prototype)).constructor=_y;function _y(r,e,t){if(typeof r!="function")throw TypeError("rpcImpl must be a function");xv.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(t)}_y.prototype.rpcCall=function r(e,t,i,n,s){if(!n)throw TypeError("request must be specified");var o=this;if(!s)return xv.asPromise(r,o,e,t,i,n);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,t[o.requestDelimited?"encodeDelimited":"encode"](n).finish(),function(c,u){if(c)return o.emit("error",c,e),s(c);if(u===null){o.end(!0);return}if(!(u instanceof i))try{u=i[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(f){return o.emit("error",f,e),s(f)}return o.emit("data",u,e),s(null,u)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};_y.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var ED=m(vD=>{l();"use strict";var fwe=vD;fwe.Service=_D()});var AD=m((sit,SD)=>{l();"use strict";SD.exports={}});var ID=m(xD=>{l();"use strict";var $n=xD;$n.build="minimal";$n.Writer=Ev();$n.BufferWriter=uD();$n.Reader=Rv();$n.BufferReader=bD();$n.util=zu();$n.rpc=ED();$n.roots=AD();$n.configure=RD;function RD(){$n.util._configure(),$n.Writer._configure($n.BufferWriter),$n.Reader._configure($n.BufferReader)}RD()});var Br=m((ait,TD)=>{l();"use strict";TD.exports=ID()});function ND(r,e,t){e=e||[],t=t||0;for(var i=t;r>=gwe;)e[t++]=r&255|DD,r/=128;for(;r&ywe;)e[t++]=r&255|DD,r>>>=7;return e[t]=r|0,ND.bytes=t-i+1,e}function Tv(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o)throw Tv.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&BD)<<i:(s&BD)*Math.pow(2,i),i+=7}while(s>=bwe);return Tv.bytes=n-e,t}var hwe,DD,pwe,ywe,gwe,mwe,bwe,BD,wwe,_we,vwe,Ewe,Swe,Awe,Rwe,xwe,Iwe,Twe,Pwe,Cwe,vy,LD=qe(()=>{l();hwe=ND,DD=128,pwe=127,ywe=~pwe,gwe=Math.pow(2,31);mwe=Tv,bwe=128,BD=127;wwe=Math.pow(2,7),_we=Math.pow(2,14),vwe=Math.pow(2,21),Ewe=Math.pow(2,28),Swe=Math.pow(2,35),Awe=Math.pow(2,42),Rwe=Math.pow(2,49),xwe=Math.pow(2,56),Iwe=Math.pow(2,63),Twe=function(r){return r<wwe?1:r<_we?2:r<vwe?3:r<Ewe?4:r<Swe?5:r<Awe?6:r<Rwe?7:r<xwe?8:r<Iwe?9:10},Pwe={encode:hwe,decode:mwe,encodingLength:Twe},Cwe=Pwe,vy=Cwe});var Ey,Zh,Jh,L3=qe(()=>{l();LD();Ey=r=>[vy.decode(r),vy.decode.bytes],Zh=(r,e,t=0)=>(vy.encode(r,e,t),e),Jh=r=>vy.encodingLength(r)});var ep={};Pt(ep,{coerce:()=>js,empty:()=>jD,equals:()=>Pv,fromHex:()=>kwe,fromString:()=>Cv,isBinary:()=>Dwe,toHex:()=>Owe,toString:()=>Ov});var jD,Owe,kwe,Pv,js,Dwe,Cv,Ov,Gu=qe(()=>{l();jD=new Uint8Array(0),Owe=r=>r.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),""),kwe=r=>{let e=r.match(/../g);return e?new Uint8Array(e.map(t=>parseInt(t,16))):jD},Pv=(r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0},js=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},Dwe=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),Cv=r=>new TextEncoder().encode(r),Ov=r=>new TextDecoder().decode(r)});var rp={};Pt(rp,{Digest:()=>tp,create:()=>Wu,decode:()=>fi,equals:()=>kv});var Wu,fi,kv,tp,tn=qe(()=>{l();Gu();L3();Wu=(r,e)=>{let t=e.byteLength,i=Jh(r),n=i+Jh(t),s=new Uint8Array(n+t);return Zh(r,s,0),Zh(t,s,i),s.set(e,n),new tp(r,t,e,s)},fi=r=>{let e=js(r),[t,i]=Ey(e),[n,s]=Ey(e.subarray(i)),o=e.subarray(i+s);if(o.byteLength!==n)throw new Error("Incorrect length");return new tp(t,n,o,e)},kv=(r,e)=>r===e?!0:r.code===e.code&&r.size===e.size&&Pv(r.bytes,e.bytes),tp=class{constructor(e,t,i,n){this.code=e,this.size=t,this.digest=i,this.bytes=n}}});function Nwe(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var n=0;n<r.length;n++){var s=r.charAt(n),o=s.charCodeAt(0);if(t[o]!==255)throw new TypeError(s+" is ambiguous");t[o]=n}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function d(y){if(y instanceof Uint8Array||(ArrayBuffer.isView(y)?y=new Uint8Array(y.buffer,y.byteOffset,y.byteLength):Array.isArray(y)&&(y=Uint8Array.from(y))),!(y instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(y.length===0)return"";for(var g=0,w=0,b=0,v=y.length;b!==v&&y[b]===0;)b++,g++;for(var R=(v-b)*f+1>>>0,k=new Uint8Array(R);b!==v;){for(var C=y[b],T=0,D=R-1;(C!==0||T<w)&&D!==-1;D--,T++)C+=256*k[D]>>>0,k[D]=C%a>>>0,C=C/a>>>0;if(C!==0)throw new Error("Non-zero carry");w=T,b++}for(var j=R-w;j!==R&&k[j]===0;)j++;for(var M=c.repeat(g);j<R;++j)M+=r.charAt(k[j]);return M}function h(y){if(typeof y!="string")throw new TypeError("Expected String");if(y.length===0)return new Uint8Array;var g=0;if(y[g]!==" "){for(var w=0,b=0;y[g]===c;)w++,g++;for(var v=(y.length-g)*u+1>>>0,R=new Uint8Array(v);y[g];){var k=t[y.charCodeAt(g)];if(k===255)return;for(var C=0,T=v-1;(k!==0||C<b)&&T!==-1;T--,C++)k+=a*R[T]>>>0,R[T]=k%256>>>0,k=k/256>>>0;if(k!==0)throw new Error("Non-zero carry");b=C,g++}if(y[g]!==" "){for(var D=v-b;D!==v&&R[D]===0;)D++;for(var j=new Uint8Array(w+(v-D)),M=w;D!==v;)j[M++]=R[D++];return j}}}function p(y){var g=h(y);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var Bwe,Lwe,qD,UD=qe(()=>{l();Bwe=Nwe,Lwe=Bwe,qD=Lwe});var FD,KD,VD,zD,HD,M3,Yu,Mwe,jwe,Yr,Oa=qe(()=>{l();UD();Gu();FD=class{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},KD=class{constructor(e,t,i){this.name=e,this.prefix=t,this.baseDecode=i}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){return zD(this,e)}},VD=class{constructor(e){this.decoders=e}or(e){return zD(this,e)}decode(e){let t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},zD=(r,e)=>new VD({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}}),HD=class{constructor(e,t,i,n){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=n,this.encoder=new FD(e,t,i),this.decoder=new KD(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},M3=({name:r,prefix:e,encode:t,decode:i})=>new HD(r,e,t,i),Yu=({prefix:r,name:e,alphabet:t})=>{let{encode:i,decode:n}=qD(t,e);return M3({prefix:r,name:e,encode:i,decode:s=>js(n(s))})},Mwe=(r,e,t,i)=>{let n={};for(let f=0;f<e.length;++f)n[e[f]]=f;let s=r.length;for(;r[s-1]==="=";)--s;let o=new Uint8Array(s*t/8|0),a=0,c=0,u=0;for(let f=0;f<s;++f){let d=n[r[f]];if(d===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<t|d,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},jwe=(r,e,t)=>{let i=e[e.length-1]==="=",n=(1<<t)-1,s="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,s+=e[n&a>>o];if(o&&(s+=e[n&a<<t-o]),i)for(;s.length*t&7;)s+="=";return s},Yr=({name:r,prefix:e,bitsPerChar:t,alphabet:i})=>M3({prefix:e,name:r,encode(n){return jwe(n,i,t)},decode(n){return Mwe(n,i,t,r)}})});var Fo={};Pt(Fo,{base58btc:()=>yt,base58flickr:()=>qwe});var yt,qwe,di=qe(()=>{l();Oa();yt=Yu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),qwe=Yu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var Fc={};Pt(Fc,{base32:()=>lr,base32hex:()=>Fwe,base32hexpad:()=>Vwe,base32hexpadupper:()=>zwe,base32hexupper:()=>Kwe,base32pad:()=>Nv,base32padupper:()=>Uwe,base32upper:()=>Dv,base32z:()=>Hwe});var lr,Dv,Nv,Uwe,Fwe,Kwe,Vwe,zwe,Hwe,rn=qe(()=>{l();Oa();lr=Yr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Dv=Yr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Nv=Yr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Uwe=Yr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Fwe=Yr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Kwe=Yr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Vwe=Yr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),zwe=Yr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Hwe=Yr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var Kc={};Pt(Kc,{CID:()=>L});var L,$we,Gwe,Wwe,Sy,Ywe,$D,GD,j3,q3,Xwe,Qwe,Zwe,we=qe(()=>{l();L3();tn();di();rn();Gu();L=class{constructor(e,t,i,n){this.code=t,this.version=e,this.multihash=i,this.bytes=n,this.byteOffset=n.byteOffset,this.byteLength=n.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:q3,byteLength:q3,code:j3,version:j3,multihash:j3,bytes:j3,_baseCache:q3,asCID:q3})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:t}=this;if(e!==Sy)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Ywe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return L.createV0(t)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,i=Wu(e,t);return L.createV1(this.code,i)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&kv(this.multihash,e.multihash)}toString(e){let{bytes:t,version:i,_baseCache:n}=this;switch(i){case 0:return Gwe(t,n,e||yt.encoder);default:return Wwe(t,n,e||lr.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return Qwe(/^0\.0/,Zwe),!!(e&&(e[GD]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof L)return e;if(e!=null&&e.asCID===e){let{version:t,code:i,multihash:n,bytes:s}=e;return new L(t,i,n,s||$D(t,i,n.bytes))}else if(e!=null&&e[GD]===!0){let{version:t,multihash:i,code:n}=e,s=fi(i);return L.create(t,n,s)}else return null}static create(e,t,i){if(typeof t!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(t!==Sy)throw new Error(`Version 0 CID must use dag-pb (code: ${Sy}) block encoding`);return new L(e,t,i,i.bytes)}case 1:{let n=$D(e,t,i.bytes);return new L(e,t,i,n)}default:throw new Error("Invalid version")}}static createV0(e){return L.create(0,Sy,e)}static createV1(e,t){return L.create(1,e,t)}static decode(e){let[t,i]=L.decodeFirst(e);if(i.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=L.inspectBytes(e),i=t.size-t.multihashSize,n=js(e.subarray(i,i+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");let s=n.subarray(t.multihashSize-t.digestSize),o=new tp(t.multihashCode,t.digestSize,s,n);return[t.version===0?L.createV0(o):L.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0,i=()=>{let[d,h]=Ey(e.subarray(t));return t+=h,d},n=i(),s=Sy;if(n===18?(n=0,t=0):n===1&&(s=i()),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);let o=t,a=i(),c=i(),u=t+c,f=u-o;return{version:n,codec:s,multihashCode:a,digestSize:c,multihashSize:f,size:u}}static parse(e,t){let[i,n]=$we(e,t),s=L.decode(n);return s._baseCache.set(i,e),s}},$we=(r,e)=>{switch(r[0]){case"Q":{let t=e||yt;return[yt.prefix,t.decode(`${yt.prefix}${r}`)]}case yt.prefix:{let t=e||yt;return[yt.prefix,t.decode(r)]}case lr.prefix:{let t=e||lr;return[lr.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}},Gwe=(r,e,t)=>{let{prefix:i}=t;if(i!==yt.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let n=e.get(i);if(n==null){let s=t.encode(r).slice(1);return e.set(i,s),s}else return n},Wwe=(r,e,t)=>{let{prefix:i}=t,n=e.get(i);if(n==null){let s=t.encode(r);return e.set(i,s),s}else return n},Sy=112,Ywe=18,$D=(r,e,t)=>{let i=Jh(r),n=i+Jh(e),s=new Uint8Array(n+t.byteLength);return Zh(r,s,0),Zh(e,s,i),s.set(t,n),s},GD=Symbol.for("@ipld/js-cid/CID"),j3={writable:!1,configurable:!1,enumerable:!0},q3={writable:!1,enumerable:!1,configurable:!1},Xwe="0.0.0-dev",Qwe=(r,e)=>{if(r.test(Xwe))console.warn(e);else throw new Error(e)},Zwe=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});function nN(r){if(r===null)return"null";if(r===void 0)return"undefined";if(r===!0||r===!1)return"boolean";let e=typeof r;if(l8e.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(r))return"Array";if(d8e(r))return"Buffer";let t=h8e(r);return t||"Object"}function d8e(r){return r&&r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer.call(null,r)}function h8e(r){let e=Object.prototype.toString.call(r).slice(8,-1);if(f8e.includes(e))return e}var l8e,f8e,sN=qe(()=>{l();l8e=["string","number","bigint","symbol"],f8e=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"]});var $,ge,Pn=qe(()=>{l();$=class{constructor(e,t,i){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=i}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};$.uint=new $(0,"uint",!0);$.negint=new $(1,"negint",!0);$.bytes=new $(2,"bytes",!0);$.string=new $(3,"string",!0);$.array=new $(4,"array",!1);$.map=new $(5,"map",!1);$.tag=new $(6,"tag",!1);$.float=new $(7,"float",!0);$.false=new $(7,"false",!0);$.true=new $(7,"true",!0);$.null=new $(7,"null",!0);$.undefined=new $(7,"undefined",!0);$.break=new $(7,"break",!0);ge=class{constructor(e,t,i){this.type=e,this.value=t,this.encodedLength=i,this.encodedBytes=void 0}toString(){return`Token[${this.type}].${this.value}`}}});function F3(r){return np&&globalThis.Buffer.isBuffer(r)}function Ry(r){return r instanceof Uint8Array?F3(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r:Uint8Array.from(r)}function uN(r,e){if(F3(r)&&F3(e))return r.compare(e);for(let t=0;t<r.length;t++)if(r[t]!==e[t])return r[t]<e[t]?-1:1;return 0}function lN(r,e=1/0){let t,i=r.length,n=null,s=[];for(let o=0;o<i;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function fN(r,e,t){let i=[];for(;e<t;){let n=r[e],s=null,o=n>239?4:n>223?3:n>191?2:1;if(e+o<=t){let a,c,u,f;switch(o){case 1:n<128&&(s=n);break;case 2:a=r[e+1],(a&192)==128&&(f=(n&31)<<6|a&63,f>127&&(s=f));break;case 3:a=r[e+1],c=r[e+2],(a&192)==128&&(c&192)==128&&(f=(n&15)<<12|(a&63)<<6|c&63,f>2047&&(f<55296||f>57343)&&(s=f));break;case 4:a=r[e+1],c=r[e+2],u=r[e+3],(a&192)==128&&(c&192)==128&&(u&192)==128&&(f=(n&15)<<18|(a&63)<<12|(c&63)<<6|u&63,f>65535&&f<1114112&&(s=f))}}s===null?(s=65533,o=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|s&1023),i.push(s),e+=o}return jv(i)}function jv(r){let e=r.length;if(e<=dN)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=dN));return t}var np,p8e,y8e,oN,K3,ka,V3,aN,cN,dN,Xu=qe(()=>{l();np=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",p8e=new TextDecoder,y8e=new TextEncoder;oN=np?(r,e,t)=>t-e>64?globalThis.Buffer.from(r.subarray(e,t)).toString("utf8"):fN(r,e,t):(r,e,t)=>t-e>64?p8e.decode(r.subarray(e,t)):fN(r,e,t),K3=np?r=>r.length>64?globalThis.Buffer.from(r):lN(r):r=>r.length>64?y8e.encode(r):lN(r),ka=r=>Uint8Array.from(r),V3=np?(r,e,t)=>F3(r)?new Uint8Array(r.subarray(e,t)):r.slice(e,t):(r,e,t)=>r.slice(e,t),aN=np?(r,e)=>(r=r.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),Ry(globalThis.Buffer.concat(r,e))):(r,e)=>{let t=new Uint8Array(e),i=0;for(let n of r)i+n.length>t.length&&(n=n.subarray(0,t.length-i)),t.set(n,i),i+=n.length;return t},cN=np?r=>globalThis.Buffer.allocUnsafe(r):r=>new Uint8Array(r);dN=4096});var g8e,z3,hN=qe(()=>{l();Xu();g8e=256,z3=class{constructor(e=g8e){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.chunks=[],this.cursor=0,this.maxCursor=-1,this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let n=t.length-(this.maxCursor-this.cursor)-1;t.set(e,n)}else{if(t){let n=t.length-(this.maxCursor-this.cursor)-1;n<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,n),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=cN(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){let i=this.chunks[0];e&&this.cursor>i.length/2?(t=this.cursor===i.length?i:i.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=V3(i,0,this.cursor)}else t=aN(this.chunks,this.cursor);return e&&this.reset(),t}}});function zc(r,e,t){if(r.length-e<t)throw new Error(`${Ve} not enough data for type`)}var Ve,Vc,xy,hs=qe(()=>{l();Ve="CBOR decode error:",Vc="CBOR encode error:",xy=[];xy[23]=1;xy[24]=2;xy[25]=3;xy[26]=5;xy[27]=9});function ps(r,e,t){zc(r,e,1);let i=r[e];if(t.strict===!0&&i<Gi[0])throw new Error(`${Ve} integer encoded in more bytes than necessary (strict decode)`);return i}function ys(r,e,t){zc(r,e,2);let i=r[e]<<8|r[e+1];if(t.strict===!0&&i<Gi[1])throw new Error(`${Ve} integer encoded in more bytes than necessary (strict decode)`);return i}function gs(r,e,t){zc(r,e,4);let i=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];if(t.strict===!0&&i<Gi[2])throw new Error(`${Ve} integer encoded in more bytes than necessary (strict decode)`);return i}function ms(r,e,t){zc(r,e,8);let i=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3],n=r[e+4]*16777216+(r[e+5]<<16)+(r[e+6]<<8)+r[e+7],s=(BigInt(i)<<BigInt(32))+BigInt(n);if(t.strict===!0&&s<Gi[3])throw new Error(`${Ve} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(t.allowBigInt===!0)return s;throw new Error(`${Ve} integers outside of the safe integer range are not supported`)}function pN(r,e,t,i){return new ge($.uint,ps(r,e+1,i),2)}function yN(r,e,t,i){return new ge($.uint,ys(r,e+1,i),3)}function gN(r,e,t,i){return new ge($.uint,gs(r,e+1,i),5)}function mN(r,e,t,i){return new ge($.uint,ms(r,e+1,i),9)}function qs(r,e){return Gn(r,0,e.value)}function Gn(r,e,t){if(t<Gi[0]){let i=Number(t);r.push([e|i])}else if(t<Gi[1]){let i=Number(t);r.push([e|24,i])}else if(t<Gi[2]){let i=Number(t);r.push([e|25,i>>>8,i&255])}else if(t<Gi[3]){let i=Number(t);r.push([e|26,i>>>24&255,i>>>16&255,i>>>8&255,i&255])}else{let i=BigInt(t);if(i<Gi[4]){let n=[e|27,0,0,0,0,0,0,0],s=Number(i&BigInt(4294967295)),o=Number(i>>BigInt(32)&BigInt(4294967295));n[8]=s&255,s=s>>8,n[7]=s&255,s=s>>8,n[6]=s&255,s=s>>8,n[5]=s&255,n[4]=o&255,o=o>>8,n[3]=o&255,o=o>>8,n[2]=o&255,o=o>>8,n[1]=o&255,r.push(n)}else throw new Error(`${Ve} encountered BigInt larger than allowable range`)}}var Gi,Da=qe(()=>{l();Pn();hs();Gi=[24,256,65536,4294967296,BigInt("18446744073709551616")];qs.encodedSize=function(e){return Gn.encodedSize(e.value)};Gn.encodedSize=function(e){return e<Gi[0]?1:e<Gi[1]?2:e<Gi[2]?3:e<Gi[3]?5:9};qs.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}});function bN(r,e,t,i){return new ge($.negint,-1-ps(r,e+1,i),2)}function wN(r,e,t,i){return new ge($.negint,-1-ys(r,e+1,i),3)}function _N(r,e,t,i){return new ge($.negint,-1-gs(r,e+1,i),5)}function EN(r,e,t,i){let n=ms(r,e+1,i);if(typeof n!="bigint"){let s=-1-n;if(s>=Number.MIN_SAFE_INTEGER)return new ge($.negint,s,9)}if(i.allowBigInt!==!0)throw new Error(`${Ve} integers outside of the safe integer range are not supported`);return new ge($.negint,qv-BigInt(n),9)}function H3(r,e){let t=e.value,i=typeof t=="bigint"?t*qv-vN:t*-1-1;Gn(r,e.type.majorEncoded,i)}var qv,vN,Uv=qe(()=>{l();Pn();Da();hs();qv=BigInt(-1),vN=BigInt(1);H3.encodedSize=function(e){let t=e.value,i=typeof t=="bigint"?t*qv-vN:t*-1-1;return i<Gi[0]?1:i<Gi[1]?2:i<Gi[2]?3:i<Gi[3]?5:9};H3.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0}});function Iy(r,e,t,i){zc(r,e,t+i);let n=V3(r,e+t,e+t+i);return new ge($.bytes,n,t+i)}function SN(r,e,t,i){return Iy(r,e,1,t)}function AN(r,e,t,i){return Iy(r,e,2,ps(r,e+1,i))}function RN(r,e,t,i){return Iy(r,e,3,ys(r,e+1,i))}function xN(r,e,t,i){return Iy(r,e,5,gs(r,e+1,i))}function IN(r,e,t,i){let n=ms(r,e+1,i);if(typeof n=="bigint")throw new Error(`${Ve} 64-bit integer bytes lengths not supported`);return Iy(r,e,9,n)}function $3(r){return r.encodedBytes===void 0&&(r.encodedBytes=r.type===$.string?K3(r.value):r.value),r.encodedBytes}function sp(r,e){let t=$3(e);Gn(r,e.type.majorEncoded,t.length),r.push(t)}function m8e(r,e){return r.length<e.length?-1:r.length>e.length?1:uN(r,e)}var G3=qe(()=>{l();Pn();hs();Da();Xu();sp.encodedSize=function(e){let t=$3(e);return Gn.encodedSize(t.length)+t.length};sp.compareTokens=function(e,t){return m8e($3(e),$3(t))}});function Ty(r,e,t,i){let n=t+i;return zc(r,e,n),new ge($.string,oN(r,e+t,e+n),n)}function TN(r,e,t,i){return Ty(r,e,1,t)}function PN(r,e,t,i){return Ty(r,e,2,ps(r,e+1,i))}function CN(r,e,t,i){return Ty(r,e,3,ys(r,e+1,i))}function ON(r,e,t,i){return Ty(r,e,5,gs(r,e+1,i))}function kN(r,e,t,i){let n=ms(r,e+1,i);if(typeof n=="bigint")throw new Error(`${Ve} 64-bit integer string lengths not supported`);return Ty(r,e,9,n)}var DN,Fv=qe(()=>{l();Pn();hs();Da();G3();Xu();DN=sp});function op(r,e,t,i){return new ge($.array,i,t)}function NN(r,e,t,i){return op(r,e,1,t)}function BN(r,e,t,i){return op(r,e,2,ps(r,e+1,i))}function LN(r,e,t,i){return op(r,e,3,ys(r,e+1,i))}function MN(r,e,t,i){return op(r,e,5,gs(r,e+1,i))}function jN(r,e,t,i){let n=ms(r,e+1,i);if(typeof n=="bigint")throw new Error(`${Ve} 64-bit integer array lengths not supported`);return op(r,e,9,n)}function qN(r,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${Ve} indefinite length items not allowed`);return op(r,e,1,1/0)}function Kv(r,e){Gn(r,$.array.majorEncoded,e.value)}var Vv=qe(()=>{l();Pn();Da();hs();Kv.compareTokens=qs.compareTokens});function ap(r,e,t,i){return new ge($.map,i,t)}function UN(r,e,t,i){return ap(r,e,1,t)}function FN(r,e,t,i){return ap(r,e,2,ps(r,e+1,i))}function KN(r,e,t,i){return ap(r,e,3,ys(r,e+1,i))}function VN(r,e,t,i){return ap(r,e,5,gs(r,e+1,i))}function zN(r,e,t,i){let n=ms(r,e+1,i);if(typeof n=="bigint")throw new Error(`${Ve} 64-bit integer map lengths not supported`);return ap(r,e,9,n)}function HN(r,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${Ve} indefinite length items not allowed`);return ap(r,e,1,1/0)}function zv(r,e){Gn(r,$.map.majorEncoded,e.value)}var Hv=qe(()=>{l();Pn();Da();hs();zv.compareTokens=qs.compareTokens});function $N(r,e,t,i){return new ge($.tag,t,1)}function GN(r,e,t,i){return new ge($.tag,ps(r,e+1,i),2)}function WN(r,e,t,i){return new ge($.tag,ys(r,e+1,i),3)}function YN(r,e,t,i){return new ge($.tag,gs(r,e+1,i),5)}function XN(r,e,t,i){return new ge($.tag,ms(r,e+1,i),9)}function $v(r,e){Gn(r,$.tag.majorEncoded,e.value)}var Gv=qe(()=>{l();Pn();Da();$v.compareTokens=qs.compareTokens});function QN(r,e,t,i){if(i.allowUndefined===!1)throw new Error(`${Ve} undefined values are not supported`);return i.coerceUndefinedToNull===!0?new ge($.null,null,1):new ge($.undefined,void 0,1)}function ZN(r,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${Ve} indefinite length items not allowed`);return new ge($.break,void 0,1)}function Wv(r,e,t){if(t){if(t.allowNaN===!1&&Number.isNaN(r))throw new Error(`${Ve} NaN values are not supported`);if(t.allowInfinity===!1&&(r===1/0||r===-1/0))throw new Error(`${Ve} Infinity values are not supported`)}return new ge($.float,r,e)}function JN(r,e,t,i){return Wv(Yv(r,e+1),3,i)}function eB(r,e,t,i){return Wv(Xv(r,e+1),5,i)}function tB(r,e,t,i){return Wv(sB(r,e+1),9,i)}function W3(r,e,t){let i=e.value;if(i===!1)r.push([$.float.majorEncoded|b8e]);else if(i===!0)r.push([$.float.majorEncoded|w8e]);else if(i===null)r.push([$.float.majorEncoded|_8e]);else if(i===void 0)r.push([$.float.majorEncoded|v8e]);else{let n,s=!1;(!t||t.float64!==!0)&&(iB(i),n=Yv(Ko,1),i===n||Number.isNaN(i)?(Ko[0]=249,r.push(Ko.slice(0,3)),s=!0):(nB(i),n=Xv(Ko,1),i===n&&(Ko[0]=250,r.push(Ko.slice(0,5)),s=!0))),s||(E8e(i),n=sB(Ko,1),Ko[0]=251,r.push(Ko.slice(0,9)))}}function iB(r){if(r===1/0)Us.setUint16(0,31744,!1);else if(r===-1/0)Us.setUint16(0,64512,!1);else if(Number.isNaN(r))Us.setUint16(0,32256,!1);else{Us.setFloat32(0,r);let e=Us.getUint32(0),t=(e&2139095040)>>23,i=e&8388607;if(t===255)Us.setUint16(0,31744,!1);else if(t===0)Us.setUint16(0,(r&2147483648)>>16|i>>13,!1);else{let n=t-127;n<-24?Us.setUint16(0,0):n<-14?Us.setUint16(0,(e&2147483648)>>16|1<<24+n,!1):Us.setUint16(0,(e&2147483648)>>16|n+15<<10|i>>13,!1)}}}function Yv(r,e){if(r.length-e<2)throw new Error(`${Ve} not enough data for float16`);let t=(r[e]<<8)+r[e+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;let i=t>>10&31,n=t&1023,s;return i===0?s=n*2**-24:i!==31?s=(n+1024)*2**(i-25):s=n===0?1/0:NaN,t&32768?-s:s}function nB(r){Us.setFloat32(0,r,!1)}function Xv(r,e){if(r.length-e<4)throw new Error(`${Ve} not enough data for float32`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,4).getFloat32(0,!1)}function E8e(r){Us.setFloat64(0,r,!1)}function sB(r,e){if(r.length-e<8)throw new Error(`${Ve} not enough data for float64`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,8).getFloat64(0,!1)}var b8e,w8e,_8e,v8e,rB,Us,Ko,Qv=qe(()=>{l();Pn();hs();Da();b8e=20,w8e=21,_8e=22,v8e=23;W3.encodedSize=function(e,t){let i=e.value;if(i===!1||i===!0||i===null||i===void 0)return 1;let n;if(!t||t.float64!==!0){if(iB(i),n=Yv(Ko,1),i===n||Number.isNaN(i))return 3;if(nB(i),n=Xv(Ko,1),i===n)return 5}return 9};rB=new ArrayBuffer(9),Us=new DataView(rB,1),Ko=new Uint8Array(rB,0);W3.compareTokens=qs.compareTokens});function Yt(r,e,t){throw new Error(`${Ve} encountered invalid minor (${t}) for major ${r[e]>>>5}`)}function Y3(r){return()=>{throw new Error(`${Ve} ${r}`)}}function oB(r){switch(r.type){case $.false:return ka([244]);case $.true:return ka([245]);case $.null:return ka([246]);case $.bytes:return r.value.length?void 0:ka([64]);case $.string:return r.value===""?ka([96]):void 0;case $.array:return r.value===0?ka([128]):void 0;case $.map:return r.value===0?ka([160]):void 0;case $.uint:return r.value<24?ka([Number(r.value)]):void 0;case $.negint:if(r.value>=-24)return ka([31-Number(r.value)])}}var Re,Vo,Zv=qe(()=>{l();Pn();Da();Uv();G3();Fv();Vv();Hv();Gv();Qv();hs();Xu();Re=[];for(let r=0;r<=23;r++)Re[r]=Yt;Re[24]=pN;Re[25]=yN;Re[26]=gN;Re[27]=mN;Re[28]=Yt;Re[29]=Yt;Re[30]=Yt;Re[31]=Yt;for(let r=32;r<=55;r++)Re[r]=Yt;Re[56]=bN;Re[57]=wN;Re[58]=_N;Re[59]=EN;Re[60]=Yt;Re[61]=Yt;Re[62]=Yt;Re[63]=Yt;for(let r=64;r<=87;r++)Re[r]=SN;Re[88]=AN;Re[89]=RN;Re[90]=xN;Re[91]=IN;Re[92]=Yt;Re[93]=Yt;Re[94]=Yt;Re[95]=Y3("indefinite length bytes/strings are not supported");for(let r=96;r<=119;r++)Re[r]=TN;Re[120]=PN;Re[121]=CN;Re[122]=ON;Re[123]=kN;Re[124]=Yt;Re[125]=Yt;Re[126]=Yt;Re[127]=Y3("indefinite length bytes/strings are not supported");for(let r=128;r<=151;r++)Re[r]=NN;Re[152]=BN;Re[153]=LN;Re[154]=MN;Re[155]=jN;Re[156]=Yt;Re[157]=Yt;Re[158]=Yt;Re[159]=qN;for(let r=160;r<=183;r++)Re[r]=UN;Re[184]=FN;Re[185]=KN;Re[186]=VN;Re[187]=zN;Re[188]=Yt;Re[189]=Yt;Re[190]=Yt;Re[191]=HN;for(let r=192;r<=215;r++)Re[r]=$N;Re[216]=GN;Re[217]=WN;Re[218]=YN;Re[219]=XN;Re[220]=Yt;Re[221]=Yt;Re[222]=Yt;Re[223]=Yt;for(let r=224;r<=243;r++)Re[r]=Y3("simple values are not supported");Re[244]=Yt;Re[245]=Yt;Re[246]=Yt;Re[247]=QN;Re[248]=Y3("simple values are not supported");Re[249]=JN;Re[250]=eB;Re[251]=tB;Re[252]=Yt;Re[253]=Yt;Re[254]=Yt;Re[255]=ZN;Vo=[];for(let r=0;r<24;r++)Vo[r]=new ge($.uint,r,1);for(let r=-1;r>=-24;r--)Vo[31-r]=new ge($.negint,r,1);Vo[64]=new ge($.bytes,new Uint8Array(0),1);Vo[96]=new ge($.string,"",1);Vo[128]=new ge($.array,0,1);Vo[160]=new ge($.map,0,1);Vo[244]=new ge($.false,!1,1);Vo[245]=new ge($.true,!0,1);Vo[246]=new ge($.null,null,1)});function X3(r,e={},t){let i=nN(r),n=e&&e.typeEncoders&&e.typeEncoders[i]||Zu[i];if(typeof n=="function"){let o=n(r,i,e,t);if(o!=null)return o}let s=Zu[i];if(!s)throw new Error(`${Vc} unsupported type: ${i}`);return s(r,i,e,t)}function A8e(r,e){e.mapSorter&&r.sort(e.mapSorter)}function R8e(r,e){let t=Array.isArray(r[0])?r[0][0]:r[0],i=Array.isArray(e[0])?e[0][0]:e[0];if(t.type!==i.type)return t.type.compare(i.type);let n=t.type.major,s=Na[n].compareTokens(t,i);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function cB(r,e,t,i){if(Array.isArray(e))for(let n of e)cB(r,n,t,i);else t[e.type.major](r,e,i)}function Jv(r,e,t){let i=X3(r,t);if(!Array.isArray(i)&&t.quickEncodeToken){let n=t.quickEncodeToken(i);if(n)return n;let s=e[i.type.major];if(s.encodedSize){let o=s.encodedSize(i,t),a=new z3(o);if(s(a,i,t),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${i} was wrong`);return Ry(a.chunks[0])}}return cB(aB,i,e,t),aB.toBytes(!0)}function Wn(r,e){return e=Object.assign({},S8e,e),Jv(r,Na,e)}var S8e,Na,aB,Py,Qu,Zu,e7=qe(()=>{l();sN();Pn();hN();hs();Zv();Xu();Da();Uv();G3();Fv();Vv();Hv();Gv();Qv();S8e={float64:!1,mapSorter:R8e,quickEncodeToken:oB},Na=[];Na[$.uint.major]=qs;Na[$.negint.major]=H3;Na[$.bytes.major]=sp;Na[$.string.major]=DN;Na[$.array.major]=Kv;Na[$.map.major]=zv;Na[$.tag.major]=$v;Na[$.float.major]=W3;aB=new z3,Py=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${Vc} object contains circular references`);return new Py(t,e)}},Qu={null:new ge($.null,null),undefined:new ge($.undefined,void 0),true:new ge($.true,!0),false:new ge($.false,!1),emptyArray:new ge($.array,0),emptyMap:new ge($.map,0)},Zu={number(r,e,t,i){return!Number.isInteger(r)||!Number.isSafeInteger(r)?new ge($.float,r):r>=0?new ge($.uint,r):new ge($.negint,r)},bigint(r,e,t,i){return r>=BigInt(0)?new ge($.uint,r):new ge($.negint,r)},Uint8Array(r,e,t,i){return new ge($.bytes,r)},string(r,e,t,i){return new ge($.string,r)},boolean(r,e,t,i){return r?Qu.true:Qu.false},null(r,e,t,i){return Qu.null},undefined(r,e,t,i){return Qu.undefined},ArrayBuffer(r,e,t,i){return new ge($.bytes,new Uint8Array(r))},DataView(r,e,t,i){return new ge($.bytes,new Uint8Array(r.buffer,r.byteOffset,r.byteLength))},Array(r,e,t,i){if(!r.length)return t.addBreakTokens===!0?[Qu.emptyArray,new ge($.break)]:Qu.emptyArray;i=Py.createCheck(i,r);let n=[],s=0;for(let o of r)n[s++]=X3(o,t,i);return t.addBreakTokens?[new ge($.array,r.length),n,new ge($.break)]:[new ge($.array,r.length),n]},Object(r,e,t,i){let n=e!=="Object",s=n?r.keys():Object.keys(r),o=n?r.size:s.length;if(!o)return t.addBreakTokens===!0?[Qu.emptyMap,new ge($.break)]:Qu.emptyMap;i=Py.createCheck(i,r);let a=[],c=0;for(let u of s)a[c++]=[X3(u,t,i),X3(n?r.get(u):r[u],t,i)];return A8e(a,t),t.addBreakTokens?[new ge($.map,o),a,new ge($.break)]:[new ge($.map,o),a]}};Zu.Map=Zu.Object;Zu.Buffer=Zu.Uint8Array;for(let r of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Zu[`${r}Array`]=Zu.DataView});function I8e(r,e,t){let i=[];for(let n=0;n<r.value;n++){let s=Oy(e,t);if(s===Q3){if(r.value===1/0)break;throw new Error(`${Ve} got unexpected break to lengthed array`)}if(s===Cy)throw new Error(`${Ve} found array but not enough entries (got ${n}, expected ${r.value})`);i[n]=s}return i}function T8e(r,e,t){let i=t.useMaps===!0,n=i?void 0:{},s=i?new Map:void 0;for(let o=0;o<r.value;o++){let a=Oy(e,t);if(a===Q3){if(r.value===1/0)break;throw new Error(`${Ve} got unexpected break to lengthed map`)}if(a===Cy)throw new Error(`${Ve} found map but not enough entries (got ${o} [no key], expected ${r.value})`);if(i!==!0&&typeof a!="string")throw new Error(`${Ve} non-string keys not supported (got ${typeof a})`);let c=Oy(e,t);if(c===Cy)throw new Error(`${Ve} found map but not enough entries (got ${o} [no value], expected ${r.value})`);i?s.set(a,c):n[a]=c}return i?s:n}function Oy(r,e){if(r.done())return Cy;let t=r.next();if(t.type===$.break)return Q3;if(t.type.terminal)return t.value;if(t.type===$.array)return I8e(t,r,e);if(t.type===$.map)return T8e(t,r,e);if(t.type===$.tag){if(e.tags&&typeof e.tags[t.value]=="function"){let i=Oy(r,e);return e.tags[t.value](i)}throw new Error(`${Ve} tag not supported (${t.value})`)}throw new Error("unsupported")}function vi(r,e){if(!(r instanceof Uint8Array))throw new Error(`${Ve} data to decode must be a Uint8Array`);e=Object.assign({},x8e,e);let t=e.tokenizer||new uB(r,e),i=Oy(t,e);if(i===Cy)throw new Error(`${Ve} did not find any content to decode`);if(i===Q3)throw new Error(`${Ve} got unexpected break`);if(!t.done())throw new Error(`${Ve} too many terminals, data makes no sense`);return i}var x8e,uB,Cy,Q3,t7=qe(()=>{l();hs();Pn();Zv();x8e={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},uB=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=Vo[e];if(t===void 0){let i=Re[e];if(!i)throw new Error(`${Ve} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let n=e&31;t=i(this.data,this.pos,n,this.options)}return this.pos+=t.encodedLength,t}},Cy=Symbol.for("DONE"),Q3=Symbol.for("BREAK")});var Ju=qe(()=>{l();e7();t7();Pn()});var cp,dB,Z3=qe(()=>{l();tn();cp=({name:r,code:e,encode:t})=>new dB(r,e,t),dB=class{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?Wu(this.code,t):t.then(i=>Wu(this.code,i))}else throw Error("Unknown type, must be binary type")}}});var up=qe(()=>{l();we();L3();Gu();Z3();tn()});var jf={};Pt(jf,{base64:()=>J3,base64pad:()=>B8e,base64url:()=>e4,base64urlpad:()=>L8e});var J3,B8e,e4,L8e,el=qe(()=>{l();Oa();J3=Yr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),B8e=Yr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),e4=Yr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),L8e=Yr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var u7=m(lp=>{l();"use strict";Object.defineProperty(lp,"__esModule",{value:!0});lp.fromBase64url=lp.toBase64url=void 0;var mB=(el(),jf);function $8e(r){return mB.base64url.encode(r).slice(1)}lp.toBase64url=$8e;function G8e(r){return mB.base64url.decode(`u${r}`)}lp.fromBase64url=G8e});var bB=m(f7=>{l();"use strict";Object.defineProperty(f7,"__esModule",{value:!0});var qf=u7(),l7=(we(),Kc);function W8e(r){let[e,t,i]=r;return{payload:t,signatures:[{protected:e,signature:i}],link:l7.CID.decode(qf.fromBase64url(t))}}function Y8e(r){let e={signature:qf.fromBase64url(r.signature)};return r.header&&(e.header=r.header),r.protected&&(e.protected=qf.fromBase64url(r.protected)),e}function X8e(r){let e=qf.fromBase64url(r.payload);try{l7.CID.decode(e)}catch(i){throw new Error("Not a valid DagJWS")}return{payload:e,signatures:r.signatures.map(Y8e)}}function Q8e(r){let e={signature:qf.toBase64url(r.signature)};return r.header&&(e.header=r.header),r.protected&&(e.protected=qf.toBase64url(r.protected)),e}function Z8e(r){let e={payload:qf.toBase64url(r.payload),signatures:r.signatures.map(Q8e)};return e.link=l7.CID.decode(new Uint8Array(r.payload)),e}f7.default={fromSplit:W8e,encode:X8e,decode:Z8e}});var wB=m(d7=>{l();"use strict";Object.defineProperty(d7,"__esModule",{value:!0});var Fs=u7();function J8e(r){let[e,t,i,n,s]=r,o={ciphertext:n,iv:i,protected:e,tag:s};return t&&(o.recipients=[{encrypted_key:t}]),o}function e_e(r){let e={};return r.encrypted_key&&(e.encrypted_key=Fs.fromBase64url(r.encrypted_key)),r.header&&(e.header=r.header),e}function t_e(r){let e={ciphertext:Fs.fromBase64url(r.ciphertext),protected:Fs.fromBase64url(r.protected),iv:Fs.fromBase64url(r.iv),tag:Fs.fromBase64url(r.tag)};return r.aad&&(e.aad=Fs.fromBase64url(r.aad)),r.recipients&&(e.recipients=r.recipients.map(e_e)),r.unprotected&&(e.unprotected=r.unprotected),e}function r_e(r){let e={};return r.encrypted_key&&(e.encrypted_key=Fs.toBase64url(r.encrypted_key)),r.header&&(e.header=r.header),e}function i_e(r){let e={ciphertext:Fs.toBase64url(r.ciphertext),protected:Fs.toBase64url(r.protected),iv:Fs.toBase64url(r.iv),tag:Fs.toBase64url(r.tag)};return r.aad&&(e.aad=Fs.toBase64url(r.aad)),r.recipients&&(e.recipients=r.recipients.map(r_e)),r.unprotected&&(e.unprotected=r.unprotected),e}d7.default={fromSplit:J8e,decode:i_e,encode:t_e}});var EB={};Pt(EB,{code:()=>l_e,decode:()=>d_e,encode:()=>f_e,name:()=>u_e});function n_e(r){if(r.asCID!==r)return null;let e=L.asCID(r);if(!e)return null;let t=new Uint8Array(e.bytes.byteLength+1);return t.set(e.bytes,1),[new ge($.tag,_B),new ge($.bytes,t)]}function s_e(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function o_e(r){if(Number.isNaN(r))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(r===1/0||r===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}function c_e(r){if(r[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return L.decode(r.subarray(1))}var _B,a_e,vB,u_e,l_e,f_e,d_e,SB=qe(()=>{l();Ju();we();_B=42;a_e={float64:!0,typeEncoders:{Object:n_e,undefined:s_e,number:o_e}};vB={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};vB.tags[_B]=c_e;u_e="dag-cbor",l_e=113,f_e=r=>Wn(r,a_e),d_e=r=>vi(r,vB)});var y7=m(Ei=>{l();"use strict";var h_e=Ei&&Ei.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),p_e=Ei&&Ei.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),y_e=Ei&&Ei.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&h_e(e,r,t);return p_e(e,r),e},AB=Ei&&Ei.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ei,"__esModule",{value:!0});Ei.decode=Ei.encode=Ei.toGeneral=Ei.code=Ei.name=void 0;var h7=AB(bB()),p7=AB(wB()),RB=y_e((SB(),EB));Ei.name="dag-jose";Ei.code=133;function xB(r){return"payload"in r&&typeof r.payload=="string"&&"signatures"in r&&Array.isArray(r.signatures)}function g_e(r){return"payload"in r&&r.payload instanceof Uint8Array&&"signatures"in r&&Array.isArray(r.signatures)}function m_e(r){return"ciphertext"in r&&r.ciphertext instanceof Uint8Array&&"iv"in r&&r.iv instanceof Uint8Array&&"protected"in r&&r.protected instanceof Uint8Array&&"tag"in r&&r.tag instanceof Uint8Array}function IB(r){return"ciphertext"in r&&typeof r.ciphertext=="string"&&"iv"in r&&typeof r.iv=="string"&&"protected"in r&&typeof r.protected=="string"&&"tag"in r&&typeof r.tag=="string"}function TB(r){if(typeof r=="string"){let e=r.split(".");if(e.length===3)return h7.default.fromSplit(e);if(e.length===5)return p7.default.fromSplit(e);throw new Error("Not a valid JOSE string")}if(xB(r)||IB(r))return r;throw new Error("Not a valid unencoded JOSE object")}Ei.toGeneral=TB;function b_e(r){typeof r=="string"&&(r=TB(r));let e;if(xB(r))e=h7.default.encode(r);else if(IB(r))e=p7.default.encode(r);else throw new Error("Not a valid JOSE object");return new Uint8Array(RB.encode(e))}Ei.encode=b_e;function w_e(r){let e;try{e=RB.decode(r)}catch(t){throw new Error("Not a valid DAG-JOSE object")}if(g_e(e))return h7.default.decode(e);if(m_e(e))return p7.default.decode(e);throw new Error("Not a valid DAG-JOSE object")}Ei.decode=w_e});var By={};Pt(By,{identity:()=>bs});var PB,__e,CB,v_e,bs,Hc=qe(()=>{l();Gu();tn();PB=0,__e="identity",CB=js,v_e=r=>Wu(PB,CB(r)),bs={code:PB,name:__e,encode:CB,digest:v_e}});var g7={};Pt(g7,{identity:()=>E_e});var E_e,OB=qe(()=>{l();Oa();Gu();E_e=M3({prefix:"\0",name:"identity",encode:r=>Ov(r),decode:r=>Cv(r)})});var m7={};Pt(m7,{base2:()=>S_e});var S_e,kB=qe(()=>{l();Oa();S_e=Yr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var b7={};Pt(b7,{base8:()=>A_e});var A_e,DB=qe(()=>{l();Oa();A_e=Yr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var w7={};Pt(w7,{base10:()=>R_e});var R_e,NB=qe(()=>{l();Oa();R_e=Yu({prefix:"9",name:"base10",alphabet:"0123456789"})});var t4={};Pt(t4,{base16:()=>x_e,base16upper:()=>I_e});var x_e,I_e,_7=qe(()=>{l();Oa();x_e=Yr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),I_e=Yr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var r4={};Pt(r4,{base36:()=>fp,base36upper:()=>T_e});var fp,T_e,Ly=qe(()=>{l();Oa();fp=Yu({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),T_e=Yu({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var Ks={};Pt(Ks,{sha256:()=>Lr,sha512:()=>P_e});var BB,Lr,P_e,Si=qe(()=>{l();Z3();BB=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),Lr=cp({name:"sha2-256",code:18,encode:BB("SHA-256")}),P_e=cp({name:"sha2-512",code:19,encode:BB("SHA-512")})});var My={};Pt(My,{code:()=>Bi,decode:()=>k_e,encode:()=>O_e,name:()=>C_e});var C_e,Bi,O_e,k_e,Vs=qe(()=>{l();Gu();C_e="raw",Bi=85,O_e=r=>js(r),k_e=r=>js(r)});var E7={};Pt(E7,{code:()=>v7,decode:()=>M_e,encode:()=>L_e,name:()=>B_e});var D_e,N_e,B_e,v7,L_e,M_e,S7=qe(()=>{l();D_e=new TextEncoder,N_e=new TextDecoder,B_e="json",v7=512,L_e=r=>D_e.encode(JSON.stringify(r)),M_e=r=>JSON.parse(N_e.decode(r))});var Uf,i4,n4,s4=qe(()=>{l();OB();kB();DB();NB();_7();rn();Ly();di();el();Si();Hc();Vs();S7();up();Uf={...g7,...m7,...b7,...w7,...t4,...Fc,...r4,...Fo,...jf},i4={...Ks,...By},n4={raw:My,json:E7}});function jB(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}var qB,A7,j_e,o4,R7=qe(()=>{l();s4();qB=jB("utf8","u",r=>{let e=new TextDecoder("utf8");return"u"+e.decode(r)},r=>new TextEncoder().encode(r.substring(1))),A7=jB("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);let e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),j_e={utf8:qB,"utf-8":qB,hex:Uf.base16,latin1:A7,ascii:A7,binary:A7,...Uf},o4=j_e});var Xr={};Pt(Xr,{fromString:()=>Qe});function Qe(r,e="utf8"){let t=o4[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return t.decoder.decode(`${t.prefix}${r}`)}var at=qe(()=>{l();R7()});var I7=m((Yst,FB)=>{l();"use strict";var UB="[a-fA-F\\d:]",il=r=>r&&r.includeBoundaries?`(?:(?<=\\s|^)(?=${UB})|(?<=${UB})(?=\\s|$))`:"",zo="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",Ai="[a-fA-F\\d]{1,4}",a4=`
(?:
(?:${Ai}:){7}(?:${Ai}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${Ai}:){6}(?:${zo}|:${Ai}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${Ai}:){5}(?::${zo}|(?::${Ai}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${Ai}:){4}(?:(?::${Ai}){0,1}:${zo}|(?::${Ai}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${Ai}:){3}(?:(?::${Ai}){0,2}:${zo}|(?::${Ai}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${Ai}:){2}(?:(?::${Ai}){0,3}:${zo}|(?::${Ai}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${Ai}:){1}(?:(?::${Ai}){0,4}:${zo}|(?::${Ai}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${Ai}){0,5}:${zo}|(?::${Ai}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),q_e=new RegExp(`(?:^${zo}$)|(?:^${a4}$)`),U_e=new RegExp(`^${zo}$`),F_e=new RegExp(`^${a4}$`),x7=r=>r&&r.exact?q_e:new RegExp(`(?:${il(r)}${zo}${il(r)})|(?:${il(r)}${a4}${il(r)})`,"g");x7.v4=r=>r&&r.exact?U_e:new RegExp(`${il(r)}${zo}${il(r)}`,"g");x7.v6=r=>r&&r.exact?F_e:new RegExp(`${il(r)}${a4}${il(r)}`,"g");FB.exports=x7});var P7=m((Xst,KB)=>{l();"use strict";var T7=I7(),pp=r=>T7({exact:!0}).test(r);pp.v4=r=>T7.v4({exact:!0}).test(r);pp.v6=r=>T7.v6({exact:!0}).test(r);pp.version=r=>pp(r)?pp.v4(r)?4:6:void 0;KB.exports=pp});var or={};Pt(or,{toString:()=>$e});function $e(r,e="utf8"){let t=o4[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return t.encoder.encode(r).substring(1)}var et=qe(()=>{l();R7()});var GB=m((Zst,$B)=>{l();"use strict";var C7=P7(),{toString:VB}=(et(),or),K_e=C7,O7=C7.v4,zB=C7.v6,HB=function(r,e,t){t=~~t;let i;if(O7(r))i=e||new Uint8Array(t+4),r.split(/\./g).map(function(n){i[t++]=parseInt(n,10)&255});else if(zB(r)){let n=r.split(":",8),s;for(s=0;s<n.length;s++){let o=O7(n[s]),a;o&&(a=HB(n[s]),n[s]=VB(a.slice(0,2),"base16")),a&&++s<8&&n.splice(s,0,VB(a.slice(2,4),"base16"))}if(n[0]==="")for(;n.length<8;)n.unshift("0");else if(n[n.length-1]==="")for(;n.length<8;)n.push("0");else if(n.length<8){for(s=0;s<n.length&&n[s]!=="";s++);let o=[s,"1"];for(s=9-n.length;s>0;s--)o.push("0");n.splice.apply(n,o)}for(i=e||new Uint8Array(t+16),s=0;s<n.length;s++){let o=parseInt(n[s],16);i[t++]=o>>8&255,i[t++]=o&255}}if(!i)throw Error("Invalid ip address: "+r);return i},V_e=function(r,e,t){e=~~e,t=t||r.length-e;let i=[],n,s=new DataView(r.buffer);if(t===4){for(let o=0;o<t;o++)i.push(r[e+o]);n=i.join(".")}else if(t===16){for(let o=0;o<t;o+=2)i.push(s.getUint16(e+o).toString(16));n=i.join(":"),n=n.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),n=n.replace(/:{3,4}/,"::")}return n};$B.exports={isIP:K_e,isV4:O7,isV6:zB,toBytes:HB,toString:V_e}});var jy=m((Jst,YB)=>{l();"use strict";function Yn(r){if(typeof r=="number"){if(Yn.codes[r])return Yn.codes[r];throw new Error("no protocol with code: "+r)}else if(typeof r=="string"){if(Yn.names[r])return Yn.names[r];throw new Error("no protocol with name: "+r)}throw new Error("invalid protocol id type: "+r)}var zs=-1;Yn.lengthPrefixedVarSize=zs;Yn.V=zs;Yn.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,zs,"ip6zone"],[53,zs,"dns","resolvable"],[54,zs,"dns4","resolvable"],[55,zs,"dns6","resolvable"],[56,zs,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,zs,"unix",!1,"path"],[421,zs,"ipfs"],[421,zs,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,zs,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,zs,"memory"]];Yn.names={};Yn.codes={};Yn.table.map(r=>{let e=WB.apply(null,r);return Yn.codes[e.code]=e,Yn.names[e.name]=e,null});Yn.object=WB;function WB(r,e,t,i,n){return{code:r,size:e,name:t,resolvable:Boolean(i),path:Boolean(n)}}YB.exports=Yn});var ZB=m((eot,QB)=>{l();QB.exports=k7;var XB=128,z_e=127,H_e=~z_e,$_e=Math.pow(2,31);function k7(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw k7.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var i=t;r>=$_e;)e[t++]=r&255|XB,r/=128;for(;r&H_e;)e[t++]=r&255|XB,r>>>=7;return e[t]=r|0,k7.bytes=t-i+1,e}});var tL=m((tot,eL)=>{l();eL.exports=D7;var G_e=128,JB=127;function D7(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o||i>49)throw D7.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&JB)<<i:(s&JB)*Math.pow(2,i),i+=7}while(s>=G_e);return D7.bytes=n-e,t}});var iL=m((rot,rL)=>{l();var W_e=Math.pow(2,7),Y_e=Math.pow(2,14),X_e=Math.pow(2,21),Q_e=Math.pow(2,28),Z_e=Math.pow(2,35),J_e=Math.pow(2,42),eve=Math.pow(2,49),tve=Math.pow(2,56),rve=Math.pow(2,63);rL.exports=function(r){return r<W_e?1:r<Y_e?2:r<X_e?3:r<Q_e?4:r<Z_e?5:r<J_e?6:r<eve?7:r<tve?8:r<rve?9:10}});var Xn=m((iot,nL)=>{l();nL.exports={encode:ZB(),decode:tL(),encodingLength:iL()}});var Cn={};Pt(Cn,{concat:()=>Li});function Li(r,e){e||(e=r.reduce((n,s)=>n+s.length,0));let t=new Uint8Array(e),i=0;for(let n of r)t.set(n,i),i+=n.length;return t}var Ri=qe(()=>{l()});var dL=m((not,fL)=>{l();"use strict";var c4=GB(),sL=jy(),{CID:ive}=(we(),Kc),{base32:oL}=(rn(),Fc),{base58btc:nve}=(di(),Fo),sve=(tn(),rp),yp=Xn(),{toString:u4}=(et(),or),{fromString:aL}=(at(),Xr),{concat:l4}=(Ri(),Cn);fL.exports=qy;function qy(r,e){return e instanceof Uint8Array?qy.toString(r,e):qy.toBytes(r,e)}qy.toString=function(e,t){switch(sL(e).code){case 4:case 41:return ove(t);case 6:case 273:case 33:case 132:return uL(t).toString();case 53:case 54:case 55:case 56:case 400:case 777:return cve(t);case 421:return lve(t);case 444:return lL(t);case 445:return lL(t);default:return u4(t,"base16")}};qy.toBytes=function(e,t){switch(sL(e).code){case 4:return cL(t);case 41:return cL(t);case 6:case 273:case 33:case 132:return N7(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return ave(t);case 421:return uve(t);case 444:return fve(t);case 445:return dve(t);default:return aL(t,"base16")}};function cL(r){if(!c4.isIP(r))throw new Error("invalid ip address");return c4.toBytes(r)}function ove(r){let e=c4.toString(r);if(!e||!c4.isIP(e))throw new Error("invalid ip address");return e}function N7(r){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,r),new Uint8Array(e)}function uL(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function ave(r){let e=aL(r),t=Uint8Array.from(yp.encode(e.length));return l4([t,e],t.length+e.length)}function cve(r){let e=yp.decode(r);if(r=r.slice(yp.decode.bytes),r.length!==e)throw new Error("inconsistent lengths");return u4(r)}function uve(r){let e;r[0]==="Q"||r[0]==="1"?e=sve.decode(nve.decode(`z${r}`)).bytes:e=ive.parse(r).multihash.bytes;let t=Uint8Array.from(yp.encode(e.length));return l4([t,e],t.length+e.length)}function lve(r){let e=yp.decode(r),t=r.slice(yp.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return u4(t,"base58btc")}function fve(r){let e=r.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let t=oL.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=N7(i);return l4([t,n],t.length+n.length)}function dve(r){let e=r.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let t=oL.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=N7(i);return l4([t,n],t.length+n.length)}function lL(r){let e=r.slice(0,r.length-2),t=r.slice(r.length-2),i=u4(e,"base32"),n=uL(t);return i+":"+n}});var AL=m((sot,SL)=>{l();"use strict";var hL=dL(),B7=jy(),Uy=Xn(),{concat:pL}=(Ri(),Cn),{toString:hve}=(et(),or);SL.exports={stringToStringTuples:yL,stringTuplesToString:gL,tuplesToStringTuples:bL,stringTuplesToTuples:mL,bytesToTuples:L7,tuplesToBytes:wL,bytesToString:pve,stringToBytes:vL,fromString:yve,fromBytes:EL,validateBytes:M7,isValidBytes:gve,cleanPath:f4,ParseError:j7,protoFromTuple:Fy,sizeForAddr:_L};function yL(r){let e=[],t=r.split("/").slice(1);if(t.length===1&&t[0]==="")return[];for(let i=0;i<t.length;i++){let n=t[i],s=B7(n);if(s.size===0){e.push([n]);continue}if(i++,i>=t.length)throw j7("invalid address: "+r);if(s.path){e.push([n,f4(t.slice(i).join("/"))]);break}e.push([n,t[i]])}return e}function gL(r){let e=[];return r.map(t=>{let i=Fy(t);return e.push(i.name),t.length>1&&e.push(t[1]),null}),f4(e.join("/"))}function mL(r){return r.map(e=>{Array.isArray(e)||(e=[e]);let t=Fy(e);return e.length>1?[t.code,hL.toBytes(t.code,e[1])]:[t.code]})}function bL(r){return r.map(e=>{let t=Fy(e);return e[1]?[t.code,hL.toString(t.code,e[1])]:[t.code]})}function wL(r){return EL(pL(r.map(e=>{let t=Fy(e),i=Uint8Array.from(Uy.encode(t.code));return e.length>1&&(i=pL([i,e[1]])),i})))}function _L(r,e){return r.size>0?r.size/8:r.size===0?0:Uy.decode(e)+Uy.decode.bytes}function L7(r){let e=[],t=0;for(;t<r.length;){let i=Uy.decode(r,t),n=Uy.decode.bytes,s=B7(i),o=_L(s,r.slice(t+n));if(o===0){e.push([i]),t+=n;continue}let a=r.slice(t+n,t+n+o);if(t+=o+n,t>r.length)throw j7("Invalid address Uint8Array: "+hve(r,"base16"));e.push([i,a])}return e}function pve(r){let e=L7(r),t=bL(e);return gL(t)}function vL(r){r=f4(r);let e=yL(r),t=mL(e);return wL(t)}function yve(r){return vL(r)}function EL(r){let e=M7(r);if(e)throw e;return Uint8Array.from(r)}function M7(r){try{L7(r)}catch(e){return e}}function gve(r){return M7(r)===void 0}function f4(r){return"/"+r.trim().split("/").filter(e=>e).join("/")}function j7(r){return new Error("Error parsing address: "+r)}function Fy(r){return B7(r[0])}});var IL=m((oot,xL)=>{l();"use strict";function RL(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function mve(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return RL(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),RL(new n,t)}}xL.exports=mve});var hn={};Pt(hn,{equals:()=>Hs});function Hs(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}var hi=qe(()=>{l()});var lt=m((aot,CL)=>{l();"use strict";var Ho=AL(),gp=jy(),TL=Xn(),{CID:bve}=(we(),Kc),{base58btc:wve}=(di(),Fo),_ve=IL(),vve=Symbol.for("nodejs.util.inspect.custom"),{toString:d4}=(et(),or),{equals:Eve}=(hi(),hn),q7=new Map,PL=Symbol.for("@multiformats/js-multiaddr/multiaddr"),On=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,PL,{value:!0}),e instanceof Uint8Array)this.bytes=Ho.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=Ho.fromString(e)}else if(On.isMultiaddr(e))this.bytes=Ho.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return Ho.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},t=this.toString().split("/");return e.family=t[1]==="ip4"?4:6,e.host=t[2],e.transport=t[3],e.port=parseInt(t[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},gp(e)))}protoCodes(){let e=[],t=this.bytes,i=0;for(;i<t.length;){let n=TL.decode(t,i),s=TL.decode.bytes,o=gp(n);i+=Ho.sizeForAddr(o,t.slice(i+s))+s,e.push(n)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return Ho.bytesToTuples(this.bytes)}stringTuples(){let e=Ho.bytesToTuples(this.bytes);return Ho.tuplesToStringTuples(e)}encapsulate(e){return e=new On(e),new On(this.toString()+e.toString())}decapsulate(e){let t=e.toString(),i=this.toString(),n=i.lastIndexOf(t);if(n<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new On(i.slice(0,n))}decapsulateCode(e){let t=this.tuples();for(let i=t.length-1;i>=0;i--)if(t[i][0]===e)return new On(Ho.tuplesToBytes(t.slice(0,i)));return this}getPeerId(){try{let t=this.stringTuples().filter(i=>i[0]===gp.names.ipfs.code).pop();if(t&&t[1]){let i=t[1];return i[0]==="Q"||i[0]==="1"?d4(wve.decode(`z${i}`),"base58btc"):d4(bve.parse(i).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter(t=>!!gp(t[0]).path)[0][1],e||(e=null)}catch(t){e=null}return e}equals(e){return Eve(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(n=>n.resolvable);if(!e)return[this];let t=q7.get(e.name);if(!t)throw _ve(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await t(this)).map(n=>new On(n))}nodeAddress(){let e=this.protoCodes(),t=this.protoNames(),i=this.toString().split("/").slice(1);if(i.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${t[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(i[2]!=="tcp"&&i[2]!=="udp")throw new Error(`no protocol with name: "'${t[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:i[1],port:parseInt(i[3])}}isThinWaistAddress(e){let t=(e||this).protos();return!(t.length!==2||t[0].code!==4&&t[0].code!==41||t[1].code!==6&&t[1].code!==273)}static fromNodeAddress(e,t){if(!e)throw new Error("requires node address object");if(!t)throw new Error("requires transport protocol");let i;switch(e.family){case 4:i="ip4";break;case 6:i="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new On("/"+[i,e.address,t,e.port].join("/"))}static isName(e){return On.isMultiaddr(e)?e.protos().some(t=>t.resolvable):!1}static isMultiaddr(e){return e instanceof On||Boolean(e&&e[PL])}[vve](){return"<Multiaddr "+d4(this.bytes,"base16")+" - "+Ho.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+d4(this.bytes,"base16")+" - "+Ho.bytesToString(this.bytes)+">"}};On.protocols=gp;On.resolvers=q7;function Sve(r){return new On(r)}CL.exports={Multiaddr:On,multiaddr:Sve,protocols:gp,resolvers:q7}});var Kf=m((cot,UL)=>{l();"use strict";var{Multiaddr:U7}=lt(),OL=rt("dns4"),kL=rt("dns6"),DL=rt("dnsaddr"),Ff=pn(rt("dns"),DL,OL,kL),Ky=pn(rt("ip4"),rt("ip6")),mp=pn(bt(Ky,rt("tcp")),bt(Ff,rt("tcp"))),F7=bt(Ky,rt("udp")),NL=bt(F7,rt("utp")),BL=bt(F7,rt("quic")),bp=pn(bt(mp,rt("ws")),bt(Ff,rt("ws"))),wp=pn(bt(mp,rt("wss")),bt(Ff,rt("wss"))),h4=pn(bt(mp,rt("http")),bt(Ky,rt("http")),bt(Ff,rt("http"))),p4=pn(bt(mp,rt("https")),bt(Ky,rt("https")),bt(Ff,rt("https"))),K7=pn(bt(bp,rt("p2p-webrtc-star"),rt("p2p")),bt(wp,rt("p2p-webrtc-star"),rt("p2p")),bt(bp,rt("p2p-webrtc-star")),bt(wp,rt("p2p-webrtc-star"))),Ave=pn(bt(bp,rt("p2p-websocket-star"),rt("p2p")),bt(wp,rt("p2p-websocket-star"),rt("p2p")),bt(bp,rt("p2p-websocket-star")),bt(wp,rt("p2p-websocket-star"))),V7=pn(bt(h4,rt("p2p-webrtc-direct"),rt("p2p")),bt(p4,rt("p2p-webrtc-direct"),rt("p2p")),bt(h4,rt("p2p-webrtc-direct")),bt(p4,rt("p2p-webrtc-direct"))),_p=pn(bp,wp,h4,p4,K7,V7,mp,NL,BL,Ff),Rve=pn(bt(_p,rt("p2p-stardust"),rt("p2p")),bt(_p,rt("p2p-stardust"))),nl=pn(bt(_p,rt("p2p")),K7,V7,rt("p2p")),LL=pn(bt(nl,rt("p2p-circuit"),nl),bt(nl,rt("p2p-circuit")),bt(rt("p2p-circuit"),nl),bt(_p,rt("p2p-circuit")),bt(rt("p2p-circuit"),_p),rt("p2p-circuit")),ML=()=>pn(bt(LL,ML),LL),vp=ML(),jL=pn(bt(vp,nl,vp),bt(nl,vp),bt(vp,nl),vp,nl);UL.exports={DNS:Ff,DNS4:OL,DNS6:kL,DNSADDR:DL,IP:Ky,TCP:mp,UDP:F7,QUIC:BL,UTP:NL,HTTP:h4,HTTPS:p4,WebSockets:bp,WebSocketsSecure:wp,WebSocketStar:Ave,WebRTCStar:K7,WebRTCDirect:V7,Reliable:_p,Stardust:Rve,Circuit:vp,P2P:jL,IPFS:jL};function qL(r){function e(t){if(!U7.isMultiaddr(t))try{t=new U7(t)}catch(n){return!1}let i=r(t.protoNames());return i===null?!1:i===!0||i===!1?i:i.length===0}return e}function bt(...r){function e(t){if(t.length<r.length)return null;let i=t;return r.some(n=>(i=typeof n=="function"?n().partialMatch(t):n.partialMatch(t),Array.isArray(i)&&(t=i),i===null)),i}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:qL(e),partialMatch:e}}function pn(...r){function e(i){let n=null;return r.some(s=>{let o=typeof s=="function"?s().partialMatch(i):s.partialMatch(i);return o?(n=o,!0):!1}),n}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:qL(e),partialMatch:e}}function rt(r){let e=r;function t(n){let s;if(typeof n=="string"||n instanceof Uint8Array)try{s=new U7(n)}catch(a){return!1}else s=n;let o=s.protoNames();return o.length===1&&o[0]===e}function i(n){return n.length===0?null:n[0]===e?n.slice(1):null}return{toString:function(){return e},matches:t,partialMatch:i}}});var z7=m((uot,VL)=>{l();"use strict";var xve=typeof navigator!="undefined"&&navigator.product==="ReactNative";function Ive(){return xve?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}var Vy=self.URL,FL=Ive(),KL=class{constructor(e="",t=FL){this.super=new Vy(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return Vy.createObjectURL(e)}static revokeObjectURL(e){Vy.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function Tve(r){if(typeof r=="string")return new Vy(r).toString();if(!(r instanceof Vy)){let e=r.username&&r.password?`${r.username}:${r.password}@`:"",t=r.auth?r.auth+"@":"",i=r.port?":"+r.port:"",n=r.protocol?r.protocol+"//":"",s=r.host||"",o=r.hostname||"",a=r.search||(r.query?"?"+r.query:""),c=r.hash||"",u=r.pathname||"",f=r.path||u+a;return`${n}${e||t}${s||o+i}${f}${c}`}}VL.exports={URLWithLegacySupport:KL,URLSearchParams:self.URLSearchParams,defaultBase:FL,format:Tve}});var $L=m((lot,HL)=>{l();"use strict";var{URLWithLegacySupport:zL,format:Pve}=z7();HL.exports=(r,e={},t={},i)=>{let n=e.protocol?e.protocol.replace(":",""):"http";n=(t[n]||i||n)+":";let s;try{s=new zL(r)}catch(a){s={}}let o=Object.assign({},e,{protocol:n||s.protocol,host:e.host||s.host});return new zL(r,Pve(o)).toString()}});var y4=m((fot,GL)=>{l();"use strict";var{URLWithLegacySupport:Cve,format:Ove,URLSearchParams:kve,defaultBase:Dve}=z7(),Nve=$L();GL.exports={URL:Cve,URLSearchParams:kve,format:Ove,relative:Nve,defaultBase:Dve}});var Sp=m((dot,oM)=>{l();"use strict";var{base58btc:Bve}=(di(),Fo),{base32:Lve}=(rn(),Fc),Mve=(tn(),rp),{Multiaddr:WL}=lt(),jve=Kf(),{CID:H7}=(we(),Kc),{URL:qve}=y4(),{toString:Uve}=(et(),or),$7=/^https?:\/\/[^/]+\/(ip[fn]s)\/([^/?#]+)/,Ep=/^\/(ip[fn]s)\/([^/?#]+)/,YL=1,XL=2,zy=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,QL=1,ZL=2,Fve=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function Kve(r){let e=G7(r);try{Mve.decode(Bve.decode("z"+e))}catch{return!1}return!0}function Vve(r){try{Lve.decode(r)}catch{return!1}return!0}function Hy(r){try{return typeof r=="string"?Boolean(H7.parse(r)):r instanceof Uint8Array?Boolean(H7.decode(r)):Boolean(H7.asCID(r))}catch(e){return!1}}function JL(r){if(!r)return!1;if(WL.isMultiaddr(r))return!0;try{return new WL(r),!0}catch(e){return!1}}function zve(r){return JL(r)&&jve.P2P.matches(r)}function $y(r,e,t=YL,i=XL){let n=G7(r);if(!n)return!1;let s=n.match(e);if(!s||s[t]!=="ipfs")return!1;let o=s[i];return o&&e===zy&&(o=o.toLowerCase()),Hy(o)}function g4(r,e,t=YL,i=XL){let n=G7(r);if(!n)return!1;let s=n.match(e);if(!s||s[t]!=="ipns")return!1;let o=s[i];if(o&&e===zy){if(o=o.toLowerCase(),Hy(o))return!0;try{!o.includes(".")&&o.includes("-")&&(o=o.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));let{hostname:a}=new qve(`http://${o}`);return Fve.test(a)}catch(a){return!1}}return!0}function eM(r){return typeof r=="string"}function G7(r){return r instanceof Uint8Array?Uve(r,"base58btc"):eM(r)?r:!1}var W7=r=>$y(r,zy,ZL,QL),Y7=r=>g4(r,zy,ZL,QL),tM=r=>W7(r)||Y7(r),rM=r=>$y(r,$7)||W7(r),iM=r=>g4(r,$7)||Y7(r),nM=r=>rM(r)||iM(r)||tM(r),sM=r=>$y(r,Ep)||g4(r,Ep);oM.exports={multihash:Kve,multiaddr:JL,peerMultiaddr:zve,cid:Hy,base32cid:r=>Vve(r)&&Hy(r),ipfsSubdomain:W7,ipnsSubdomain:Y7,subdomain:tM,subdomainGatewayPattern:zy,ipfsUrl:rM,ipnsUrl:iM,url:nM,pathGatewayPattern:$7,ipfsPath:r=>$y(r,Ep),ipnsPath:r=>g4(r,Ep),path:sM,pathPattern:Ep,urlOrPath:r=>nM(r)||sM(r),cidPath:r=>eM(r)&&!Hy(r)&&$y(`/ipfs/${r}`,Ep)}});var aM,cM=qe(()=>{l();aM="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"});var Q7={};Pt(Q7,{customAlphabet:()=>Hve,customRandom:()=>lM,nanoid:()=>X7,random:()=>uM,urlAlphabet:()=>aM});var uM,lM,Hve,X7,m4=qe(()=>{l();cM();uM=r=>crypto.getRandomValues(new Uint8Array(r)),lM=(r,e,t)=>{let i=(2<<Math.log(r.length-1)/Math.LN2)-1,n=-~(1.6*i*e/r.length);return()=>{let s="";for(;;){let o=t(n),a=n;for(;a--;)if(s+=r[o[a]&i]||"",s.length===e)return s}}},Hve=(r,e)=>lM(r,e,uM),X7=(r=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(r));for(;r--;){let i=t[r]&63;i<36?e+=i.toString(36):i<62?e+=(i-26).toString(36).toUpperCase():i<63?e+="_":e+="-"}return e}});var Ap={};Pt(Ap,{Key:()=>xe});function $ve(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function Gve(r){let e=r.split(":");return e[e.length-1]}function Wve(r){return[].concat(...r)}var $c,fM,b4,xe,Mr=qe(()=>{l();m4();et();at();$c="/",fM=new TextEncoder().encode($c),b4=fM[0],xe=class{constructor(e,t){if(typeof e=="string")this._buf=Qe(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==b4)throw new Error("Invalid key")}toString(e="utf8"){return $e(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new xe(e.join($c))}static random(){return new xe(X7().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new xe(e):e.uint8Array?new xe(e.uint8Array()):null}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=fM),this._buf[0]!==b4){let e=new Uint8Array(this._buf.byteLength+1);e.fill(b4,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===b4;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),i=e.list();for(let n=0;n<t.length;n++){if(i.length<n+1)return!1;let s=t[n],o=i[n];if(s<o)return!0;if(s>o)return!1}return t.length<i.length}reverse(){return xe.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split($c).slice(1)}type(){return $ve(this.baseNamespace())}name(){return Gve(this.baseNamespace())}instance(e){return new xe(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith($c)||(e+=$c),e+=this.type(),new xe(e)}parent(){let e=this.list();return e.length===1?new xe($c):new xe(e.slice(0,-1).join($c))}child(e){return this.toString()===$c?e:e.toString()===$c?this:new xe(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return xe.withNamespaces([...this.namespaces(),...Wve(e.map(t=>t.namespaces()))])}}});var hM=m((bot,dM)=>{l();"use strict";dM.exports=function(){return Date.now()}});var Gy=m((wot,yM)=>{l();"use strict";var w4=hM(),pM=class{constructor(e,t,i){let n=this;this._started=w4(),this._rescheduled=0,this._scheduled=t,this._args=i,this._triggered=!1,this._timerWrapper=()=>{n._rescheduled>0?(n._scheduled=n._rescheduled-(w4()-n._started),n._schedule(n._scheduled)):(n._triggered=!0,e.apply(null,n._args))},this._timer=setTimeout(this._timerWrapper,t)}reschedule(e){e||(e=this._scheduled);let t=w4();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=w4(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function Yve(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let r;if(arguments.length>0){r=new Array(arguments.length-2);for(var e=0;e<r.length;e++)r[e]=arguments[e+2]}return new pM(arguments[0],arguments[1],r)}yM.exports=Yve});var Ma=m((_ot,mM)=>{l();"use strict";var{AbortController:Xve}=globalThis,gM=Gy(),_4=class extends Xve{constructor(e){super();this._ms=e,this._timer=gM(()=>this.abort(),e),Object.setPrototypeOf(this,_4.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=gM(()=>this.abort(),this._ms)}};mM.exports={TimeoutController:_4}});var $o=m((vot,Z7)=>{l();var{AbortController:Qve}=globalThis;function bM(r){let e=new Qve;function t(){e.abort();for(let i of r)!i||!i.removeEventListener||i.removeEventListener("abort",t)}for(let i of r)if(!(!i||!i.addEventListener)){if(i.aborted){t();break}i.addEventListener("abort",t)}return e.signal}Z7.exports=bM;Z7.exports.anySignal=bM});var Vf=m((Iot,SM)=>{l();"use strict";function EM(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function Jve(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return EM(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),EM(new n,t)}}SM.exports=Jve});var xp=m((Vot,CM)=>{l();CM.exports=function(r){if(!r)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,t=Object.create(null),i=Object.create(null);function n(s,o){t[s]=o,e++,e>=r&&(e=0,i=t,t=Object.create(null))}return{has:function(s){return t[s]!==void 0||i[s]!==void 0},remove:function(s){t[s]!==void 0&&(t[s]=void 0),i[s]!==void 0&&(i[s]=void 0)},get:function(s){var o=t[s];if(o!==void 0)return o;if((o=i[s])!==void 0)return n(s,o),o},set:function(s,o){t[s]!==void 0?t[s]=o:n(s,o)},clear:function(){t=Object.create(null),i=Object.create(null)}}}});var DM=m((Hot,rE)=>{l();"use strict";var t7e=Object.prototype.hasOwnProperty,Dn="~";function Xy(){}Object.create&&(Xy.prototype=Object.create(null),new Xy().__proto__||(Dn=!1));function r7e(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function kM(r,e,t,i,n){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new r7e(t,i||r,n),o=Dn?Dn+e:e;return r._events[o]?r._events[o].fn?r._events[o]=[r._events[o],s]:r._events[o].push(s):(r._events[o]=s,r._eventsCount++),r}function S4(r,e){--r._eventsCount==0?r._events=new Xy:delete r._events[e]}function yn(){this._events=new Xy,this._eventsCount=0}yn.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)t7e.call(t,i)&&e.push(Dn?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};yn.prototype.listeners=function(e){var t=Dn?Dn+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};yn.prototype.listenerCount=function(e){var t=Dn?Dn+e:e,i=this._events[t];return i?i.fn?1:i.length:0};yn.prototype.emit=function(e,t,i,n,s,o){var a=Dn?Dn+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,f,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,n),!0;case 5:return c.fn.call(c.context,t,i,n,s),!0;case 6:return c.fn.call(c.context,t,i,n,s,o),!0}for(d=1,f=new Array(u-1);d<u;d++)f[d-1]=arguments[d];c.fn.apply(c.context,f)}else{var h=c.length,p;for(d=0;d<h;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),u){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,i);break;case 4:c[d].fn.call(c[d].context,t,i,n);break;default:if(!f)for(p=1,f=new Array(u-1);p<u;p++)f[p-1]=arguments[p];c[d].fn.apply(c[d].context,f)}}return!0};yn.prototype.on=function(e,t,i){return kM(this,e,t,i,!1)};yn.prototype.once=function(e,t,i){return kM(this,e,t,i,!0)};yn.prototype.removeListener=function(e,t,i,n){var s=Dn?Dn+e:e;if(!this._events[s])return this;if(!t)return S4(this,s),this;var o=this._events[s];if(o.fn)o.fn===t&&(!n||o.once)&&(!i||o.context===i)&&S4(this,s);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==t||n&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:S4(this,s)}return this};yn.prototype.removeAllListeners=function(e){var t;return e?(t=Dn?Dn+e:e,this._events[t]&&S4(this,t)):(this._events=new Xy,this._eventsCount=0),this};yn.prototype.off=yn.prototype.removeListener;yn.prototype.addListener=yn.prototype.on;yn.prefixed=Dn;yn.EventEmitter=yn;typeof rE!="undefined"&&(rE.exports=yn)});var BM=m(($ot,NM)=>{l();"use strict";NM.exports=(r,e)=>(e=e||(()=>{}),r.then(t=>new Promise(i=>{i(e())}).then(()=>t),t=>new Promise(i=>{i(e())}).then(()=>{throw t})))});var MM=m((Got,A4)=>{l();"use strict";var i7e=BM(),iE=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},LM=(r,e,t)=>new Promise((i,n)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){i(r);return}let s=setTimeout(()=>{if(typeof t=="function"){try{i(t())}catch(c){n(c)}return}let o=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,a=t instanceof Error?t:new iE(o);typeof r.cancel=="function"&&r.cancel(),n(a)},e);i7e(r.then(i,n),()=>{clearTimeout(s)})});A4.exports=LM;A4.exports.default=LM;A4.exports.TimeoutError=iE});var jM=m(nE=>{l();"use strict";Object.defineProperty(nE,"__esModule",{value:!0});function n7e(r,e,t){let i=0,n=r.length;for(;n>0;){let s=n/2|0,o=i+s;t(r[o],e)<=0?(i=++o,n-=s+1):n=s}return i}nE.default=n7e});var UM=m(sE=>{l();"use strict";Object.defineProperty(sE,"__esModule",{value:!0});var s7e=jM(),qM=class{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);let i={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(i);return}let n=s7e.default(this._queue,i,(s,o)=>o.priority-s.priority);this._queue.splice(n,0,i)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}};sE.default=qM});var Go=m(oE=>{l();"use strict";Object.defineProperty(oE,"__esModule",{value:!0});var o7e=DM(),FM=MM(),a7e=UM(),R4=()=>{},c7e=new FM.TimeoutError,KM=class extends o7e{constructor(e){var t,i,n,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=R4,this._resolveIdle=R4,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:a7e.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=R4,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=R4,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((i,n)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&t.timeout===void 0?e():FM.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&n(c7e)});i(await o)}catch(o){n(o)}this._next()};this._queue.enqueue(s,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async i=>this.add(i,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};oE.default=KM});var aE=m(x4=>{l();"use strict";var VM=class extends Error{constructor(e="Request timed out"){super(e);this.name="TimeoutError"}};x4.TimeoutError=VM;var zM=class extends Error{constructor(e="The operation was aborted."){super(e);this.name="AbortError"}};x4.AbortError=zM;var HM=class extends Error{constructor(e){super(e.statusText);this.name="HTTPError",this.response=e}};x4.HTTPError=HM});var $M=m(()=>{l()});var Qy=m((Ip,GM)=>{l();"use strict";var u7e=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof Wc!="undefined")return Wc;throw new Error("unable to locate global object")},Wc=u7e();GM.exports=Ip=Wc.fetch;Wc.fetch&&(Ip.default=Wc.fetch.bind(Wc));Ip.Headers=Wc.Headers;Ip.Request=Wc.Request;Ip.Response=Wc.Response});var uE=m((eat,cE)=>{l();"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?cE.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:cE.exports={default:Qy().default,Headers:Qy().Headers,Request:Qy().Request,Response:Qy().Response}});var WM=m((tat,lE)=>{l();"use strict";var{isElectronMain:l7e}=my();l7e?lE.exports=$M():lE.exports=uE()});var ZM=m((rat,QM)=>{l();"use strict";var{TimeoutError:f7e,AbortError:d7e}=aE(),{Response:YM,Request:h7e,Headers:fE,default:p7e}=WM(),y7e=(r,e={})=>{let t=new XMLHttpRequest;t.open(e.method||"GET",r.toString(),!0);let{timeout:i,headers:n}=e;if(i&&i>0&&i<1/0&&(t.timeout=i),e.overrideMimeType!=null&&t.overrideMimeType(e.overrideMimeType),n)for(let[s,o]of new fE(n))t.setRequestHeader(s,o);return e.signal&&(e.signal.onabort=()=>t.abort()),e.onUploadProgress&&(t.upload.onprogress=e.onUploadProgress),t.responseType="arraybuffer",new Promise((s,o)=>{let a=c=>{switch(c.type){case"error":{s(YM.error());break}case"load":{s(new XM(t.responseURL,t.response,{status:t.status,statusText:t.statusText,headers:b7e(t.getAllResponseHeaders())}));break}case"timeout":{o(new f7e);break}case"abort":{o(new d7e);break}default:break}};t.onerror=a,t.onload=a,t.ontimeout=a,t.onabort=a,t.send(e.body)})},g7e=p7e,m7e=(r,e={})=>e.onUploadProgress!=null?y7e(r,e):g7e(r,e),b7e=r=>{let e=new fE;for(let t of r.trim().split(/[\r\n]+/)){let i=t.indexOf(": ");i>0&&e.set(t.slice(0,i),t.slice(i+1))}return e},XM=class extends YM{constructor(e,t,i){super(t,i);Object.defineProperty(this,"url",{value:e})}};QM.exports={fetch:m7e,Request:h7e,Headers:fE}});var Tp=m((iat,nj)=>{l();"use strict";var{fetch:w7e,Request:_7e,Headers:v7e}=ZM(),{TimeoutError:dE,HTTPError:JM}=aE(),ej=Ku().bind({ignoreUndefined:!0}),{URL:tj,URLSearchParams:rj}=y4(),E7e=$o(),S7e=(r,e,t)=>{if(e===void 0)return r;let i=Date.now(),n=()=>Date.now()-i>=e;return new Promise((s,o)=>{let a=setTimeout(()=>{n()&&(o(new dE),t.abort())},e),c=u=>d=>{if(clearTimeout(a),n()){o(new dE);return}u(d)};r.then(c(s),c(o))})},A7e={throwHttpErrors:!0,credentials:"same-origin"},Nn=class{constructor(e={}){this.opts=ej(A7e,e)}async fetch(e,t={}){let i=ej(this.opts,t),n=new v7e(i.headers);if(typeof e!="string"&&!(e instanceof tj||e instanceof _7e))throw new TypeError("`resource` must be a string, URL, or Request");let s=new tj(e.toString(),i.base),{searchParams:o,transformSearchParams:a,json:c}=i;o&&(typeof a=="function"?s.search=a(new rj(i.searchParams)):s.search=new rj(i.searchParams)),c&&(i.body=JSON.stringify(i.json),n.set("content-type","application/json"));let u=new AbortController,f=E7e([u.signal,i.signal]),d=await S7e(w7e(s.toString(),{...i,signal:f,timeout:void 0,headers:n}),i.timeout,u);if(!d.ok&&i.throwHttpErrors)throw i.handleError&&await i.handleError(d),new JM(d);return d.iterator=function(){return ij(d.body)},d.ndjson=async function*(){for await(let h of R7e(d.iterator()))t.transform?yield t.transform(h):yield h},d}post(e,t={}){return this.fetch(e,{...t,method:"POST"})}get(e,t={}){return this.fetch(e,{...t,method:"GET"})}put(e,t={}){return this.fetch(e,{...t,method:"PUT"})}delete(e,t={}){return this.fetch(e,{...t,method:"DELETE"})}options(e,t={}){return this.fetch(e,{...t,method:"OPTIONS"})}},R7e=async function*(r){let e=new TextDecoder,t="";for await(let i of r){t+=e.decode(i,{stream:!0});let n=t.split(/\r?\n/);for(let s=0;s<n.length-1;s++){let o=n[s].trim();o.length>0&&(yield JSON.parse(o))}t=n[n.length-1]}t+=e.decode(),t=t.trim(),t.length!==0&&(yield JSON.parse(t))},ij=r=>{if(T7e(r)){let e=r[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:e.next.bind(e),return(t){return r.destroy(),typeof e.return=="function"?e.return():Promise.resolve({done:!0,value:t})}}}}}if(I7e(r)){let e=r.getReader();return async function*(){try{for(;;){let{done:t,value:i}=await e.read();if(t)return;i&&(yield i)}}finally{e.releaseLock()}}()}if(x7e(r))return r;throw new TypeError("Body can't be converted to AsyncIterable")},x7e=r=>typeof r=="object"&&r!==null&&typeof r[Symbol.asyncIterator]=="function",I7e=r=>r&&typeof r.getReader=="function",T7e=r=>Object.prototype.hasOwnProperty.call(r,"readable")&&Object.prototype.hasOwnProperty.call(r,"writable");Nn.HTTPError=JM;Nn.TimeoutError=dE;Nn.streamToAsyncIterator=ij;Nn.post=(r,e)=>new Nn(e).post(r,e);Nn.get=(r,e)=>new Nn(e).get(r,e);Nn.put=(r,e)=>new Nn(e).put(r,e);Nn.delete=(r,e)=>new Nn(e).delete(r,e);Nn.options=(r,e)=>new Nn(e).options(r,e);nj.exports=Nn});var P4=m((lat,fj)=>{l();"use strict";var zf=Br(),T4=zf.Reader,lj=zf.Writer,gn=zf.util,$s=zf.roots["libp2p-crypto-keys"]||(zf.roots["libp2p-crypto-keys"]={});$s.KeyType=function(){var r={},e=Object.create(r);return e[r[0]="RSA"]=0,e[r[1]="Ed25519"]=1,e[r[2]="Secp256k1"]=2,e}();$s.PublicKey=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Type=0,r.prototype.Data=gn.newBuffer([]),r.encode=function(t,i){return i||(i=lj.create()),i.uint32(8).int32(t.Type),i.uint32(18).bytes(t.Data),i},r.decode=function(t,i){t instanceof T4||(t=T4.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new $s.PublicKey;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw gn.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw gn.ProtocolError("missing required 'Data'",{instance:s});return s},r.fromObject=function(t){if(t instanceof $s.PublicKey)return t;var i=new $s.PublicKey;switch(t.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return t.Data!=null&&(typeof t.Data=="string"?gn.base64.decode(t.Data,i.Data=gn.newBuffer(gn.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=gn.newBuffer(n.Data)))),t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=i.enums===String?$s.KeyType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?gn.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,zf.util.toJSONOptions)},r}();$s.PrivateKey=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Type=0,r.prototype.Data=gn.newBuffer([]),r.encode=function(t,i){return i||(i=lj.create()),i.uint32(8).int32(t.Type),i.uint32(18).bytes(t.Data),i},r.decode=function(t,i){t instanceof T4||(t=T4.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new $s.PrivateKey;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw gn.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw gn.ProtocolError("missing required 'Data'",{instance:s});return s},r.fromObject=function(t){if(t instanceof $s.PrivateKey)return t;var i=new $s.PrivateKey;switch(t.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return t.Data!=null&&(typeof t.Data=="string"?gn.base64.decode(t.Data,i.Data=gn.newBuffer(gn.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=gn.newBuffer(n.Data)))),t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=i.enums===String?$s.KeyType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?gn.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,zf.util.toJSONOptions)},r}();fj.exports=$s});var At=m((fat,dj)=>{l();dj.exports={options:{usePureJavaScript:!1}}});var yj=m((dat,pj)=>{l();var pE={};pj.exports=pE;var hj={};pE.encode=function(r,e,t){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(t!==void 0&&typeof t!="number")throw new TypeError('"maxline" must be a number.');var i="";if(!(r instanceof Uint8Array))i=D7e(r,e);else{var n=0,s=e.length,o=e.charAt(0),a=[0];for(n=0;n<r.length;++n){for(var c=0,u=r[n];c<a.length;++c)u+=a[c]<<8,a[c]=u%s,u=u/s|0;for(;u>0;)a.push(u%s),u=u/s|0}for(n=0;r[n]===0&&n<r.length-1;++n)i+=o;for(n=a.length-1;n>=0;--n)i+=e[a[n]]}if(t){var f=new RegExp(".{1,"+t+"}","g");i=i.match(f).join(`\r
`)}return i};pE.decode=function(r,e){if(typeof r!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var t=hj[e];if(!t){t=hj[e]=[];for(var i=0;i<e.length;++i)t[e.charCodeAt(i)]=i}r=r.replace(/\s/g,"");for(var n=e.length,s=e.charAt(0),o=[0],i=0;i<r.length;i++){var a=t[r.charCodeAt(i)];if(a===void 0)return;for(var c=0,u=a;c<o.length;++c)u+=o[c]*n,o[c]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var f=0;r[f]===s&&f<r.length-1;++f)o.push(0);return typeof Buffer!="undefined"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function D7e(r,e){var t=0,i=e.length,n=e.charAt(0),s=[0];for(t=0;t<r.length();++t){for(var o=0,a=r.at(t);o<s.length;++o)a+=s[o]<<8,s[o]=a%i,a=a/i|0;for(;a>0;)s.push(a%i),a=a/i|0}var c="";for(t=0;r.at(t)===0&&t<r.length()-1;++t)c+=n;for(t=s.length-1;t>=0;--t)c+=e[s[t]];return c}});var vr=m((hat,wj)=>{l();var gj=At(),mj=yj(),z=wj.exports=gj.util=gj.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){z.nextTick=process.nextTick,typeof setImmediate=="function"?z.setImmediate=setImmediate:z.setImmediate=z.nextTick;return}if(typeof setImmediate=="function"){z.setImmediate=function(){return setImmediate.apply(void 0,arguments)},z.nextTick=function(a){return setImmediate(a)};return}if(z.setImmediate=function(a){setTimeout(a,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===r){c.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(f){f()})}};var o=a,r="forge.setImmediate",e=[];z.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(r,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver!="undefined"){var t=Date.now(),i=!0,n=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(u){u()})}).observe(n,{attributes:!0});var s=z.setImmediate;z.setImmediate=function(c){Date.now()-t>15?(t=Date.now(),s(c)):(e.push(c),e.length===1&&n.setAttribute("a",i=!i))}}z.nextTick=z.setImmediate})();z.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;z.globalScope=function(){return z.isNodejs?globalThis:typeof self=="undefined"?window:self}();z.isArray=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};z.isArrayBuffer=function(r){return typeof ArrayBuffer!="undefined"&&r instanceof ArrayBuffer};z.isArrayBufferView=function(r){return r&&z.isArrayBuffer(r.buffer)&&r.byteLength!==void 0};function Zy(r){if(!(r===8||r===16||r===24||r===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+r)}z.ByteBuffer=yE;function yE(r){if(this.data="",this.read=0,typeof r=="string")this.data=r;else if(z.isArrayBuffer(r)||z.isArrayBufferView(r))if(typeof Buffer!="undefined"&&r instanceof Buffer)this.data=r.toString("binary");else{var e=new Uint8Array(r);try{this.data=String.fromCharCode.apply(null,e)}catch(i){for(var t=0;t<e.length;++t)this.putByte(e[t])}}else(r instanceof yE||typeof r=="object"&&typeof r.data=="string"&&typeof r.read=="number")&&(this.data=r.data,this.read=r.read);this._constructedStringLength=0}z.ByteStringBuffer=yE;var N7e=4096;z.ByteStringBuffer.prototype._optimizeConstructedString=function(r){this._constructedStringLength+=r,this._constructedStringLength>N7e&&(this.data.substr(0,1),this._constructedStringLength=0)};z.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};z.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};z.ByteStringBuffer.prototype.putByte=function(r){return this.putBytes(String.fromCharCode(r))};z.ByteStringBuffer.prototype.fillWithByte=function(r,e){r=String.fromCharCode(r);for(var t=this.data;e>0;)e&1&&(t+=r),e>>>=1,e>0&&(r+=r);return this.data=t,this._optimizeConstructedString(e),this};z.ByteStringBuffer.prototype.putBytes=function(r){return this.data+=r,this._optimizeConstructedString(r.length),this};z.ByteStringBuffer.prototype.putString=function(r){return this.putBytes(z.encodeUtf8(r))};z.ByteStringBuffer.prototype.putInt16=function(r){return this.putBytes(String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};z.ByteStringBuffer.prototype.putInt24=function(r){return this.putBytes(String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};z.ByteStringBuffer.prototype.putInt32=function(r){return this.putBytes(String.fromCharCode(r>>24&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};z.ByteStringBuffer.prototype.putInt16Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255))};z.ByteStringBuffer.prototype.putInt24Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r>>16&255))};z.ByteStringBuffer.prototype.putInt32Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>24&255))};z.ByteStringBuffer.prototype.putInt=function(r,e){Zy(e);var t="";do e-=8,t+=String.fromCharCode(r>>e&255);while(e>0);return this.putBytes(t)};z.ByteStringBuffer.prototype.putSignedInt=function(r,e){return r<0&&(r+=2<<e-1),this.putInt(r,e)};z.ByteStringBuffer.prototype.putBuffer=function(r){return this.putBytes(r.getBytes())};z.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};z.ByteStringBuffer.prototype.getInt16=function(){var r=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,r};z.ByteStringBuffer.prototype.getInt24=function(){var r=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,r};z.ByteStringBuffer.prototype.getInt32=function(){var r=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,r};z.ByteStringBuffer.prototype.getInt16Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,r};z.ByteStringBuffer.prototype.getInt24Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,r};z.ByteStringBuffer.prototype.getInt32Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,r};z.ByteStringBuffer.prototype.getInt=function(r){Zy(r);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),r-=8;while(r>0);return e};z.ByteStringBuffer.prototype.getSignedInt=function(r){var e=this.getInt(r),t=2<<r-2;return e>=t&&(e-=t<<1),e};z.ByteStringBuffer.prototype.getBytes=function(r){var e;return r?(r=Math.min(this.length(),r),e=this.data.slice(this.read,this.read+r),this.read+=r):r===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};z.ByteStringBuffer.prototype.bytes=function(r){return typeof r=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+r)};z.ByteStringBuffer.prototype.at=function(r){return this.data.charCodeAt(this.read+r)};z.ByteStringBuffer.prototype.setAt=function(r,e){return this.data=this.data.substr(0,this.read+r)+String.fromCharCode(e)+this.data.substr(this.read+r+1),this};z.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};z.ByteStringBuffer.prototype.copy=function(){var r=z.createBuffer(this.data);return r.read=this.read,r};z.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};z.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};z.ByteStringBuffer.prototype.truncate=function(r){var e=Math.max(0,this.length()-r);return this.data=this.data.substr(this.read,e),this.read=0,this};z.ByteStringBuffer.prototype.toHex=function(){for(var r="",e=this.read;e<this.data.length;++e){var t=this.data.charCodeAt(e);t<16&&(r+="0"),r+=t.toString(16)}return r};z.ByteStringBuffer.prototype.toString=function(){return z.decodeUtf8(this.bytes())};function B7e(r,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var t=z.isArrayBuffer(r),i=z.isArrayBufferView(r);if(t||i){t?this.data=new DataView(r):this.data=new DataView(r.buffer,r.byteOffset,r.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,r!=null&&this.putBytes(r),"writeOffset"in e&&(this.write=e.writeOffset)}z.DataBuffer=B7e;z.DataBuffer.prototype.length=function(){return this.write-this.read};z.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};z.DataBuffer.prototype.accommodate=function(r,e){if(this.length()>=r)return this;e=Math.max(e||this.growSize,r);var t=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),i=new Uint8Array(this.length()+e);return i.set(t),this.data=new DataView(i.buffer),this};z.DataBuffer.prototype.putByte=function(r){return this.accommodate(1),this.data.setUint8(this.write++,r),this};z.DataBuffer.prototype.fillWithByte=function(r,e){this.accommodate(e);for(var t=0;t<e;++t)this.data.setUint8(r);return this};z.DataBuffer.prototype.putBytes=function(r,e){if(z.isArrayBufferView(r)){var t=new Uint8Array(r.buffer,r.byteOffset,r.byteLength),i=t.byteLength-t.byteOffset;this.accommodate(i);var n=new Uint8Array(this.data.buffer,this.write);return n.set(t),this.write+=i,this}if(z.isArrayBuffer(r)){var t=new Uint8Array(r);this.accommodate(t.byteLength);var n=new Uint8Array(this.data.buffer);return n.set(t,this.write),this.write+=t.byteLength,this}if(r instanceof z.DataBuffer||typeof r=="object"&&typeof r.read=="number"&&typeof r.write=="number"&&z.isArrayBufferView(r.data)){var t=new Uint8Array(r.data.byteLength,r.read,r.length());this.accommodate(t.byteLength);var n=new Uint8Array(r.data.byteLength,this.write);return n.set(t),this.write+=t.byteLength,this}if(r instanceof z.ByteStringBuffer&&(r=r.data,e="binary"),e=e||"binary",typeof r=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(r.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=z.binary.hex.decode(r,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(r.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=z.binary.base64.decode(r,s,this.write),this;if(e==="utf8"&&(r=z.encodeUtf8(r),e="binary"),e==="binary"||e==="raw")return this.accommodate(r.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=z.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(r.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=z.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+r)};z.DataBuffer.prototype.putBuffer=function(r){return this.putBytes(r),r.clear(),this};z.DataBuffer.prototype.putString=function(r){return this.putBytes(r,"utf16")};z.DataBuffer.prototype.putInt16=function(r){return this.accommodate(2),this.data.setInt16(this.write,r),this.write+=2,this};z.DataBuffer.prototype.putInt24=function(r){return this.accommodate(3),this.data.setInt16(this.write,r>>8&65535),this.data.setInt8(this.write,r>>16&255),this.write+=3,this};z.DataBuffer.prototype.putInt32=function(r){return this.accommodate(4),this.data.setInt32(this.write,r),this.write+=4,this};z.DataBuffer.prototype.putInt16Le=function(r){return this.accommodate(2),this.data.setInt16(this.write,r,!0),this.write+=2,this};z.DataBuffer.prototype.putInt24Le=function(r){return this.accommodate(3),this.data.setInt8(this.write,r>>16&255),this.data.setInt16(this.write,r>>8&65535,!0),this.write+=3,this};z.DataBuffer.prototype.putInt32Le=function(r){return this.accommodate(4),this.data.setInt32(this.write,r,!0),this.write+=4,this};z.DataBuffer.prototype.putInt=function(r,e){Zy(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,r>>e&255);while(e>0);return this};z.DataBuffer.prototype.putSignedInt=function(r,e){return Zy(e),this.accommodate(e/8),r<0&&(r+=2<<e-1),this.putInt(r,e)};z.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};z.DataBuffer.prototype.getInt16=function(){var r=this.data.getInt16(this.read);return this.read+=2,r};z.DataBuffer.prototype.getInt24=function(){var r=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,r};z.DataBuffer.prototype.getInt32=function(){var r=this.data.getInt32(this.read);return this.read+=4,r};z.DataBuffer.prototype.getInt16Le=function(){var r=this.data.getInt16(this.read,!0);return this.read+=2,r};z.DataBuffer.prototype.getInt24Le=function(){var r=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,r};z.DataBuffer.prototype.getInt32Le=function(){var r=this.data.getInt32(this.read,!0);return this.read+=4,r};z.DataBuffer.prototype.getInt=function(r){Zy(r);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),r-=8;while(r>0);return e};z.DataBuffer.prototype.getSignedInt=function(r){var e=this.getInt(r),t=2<<r-2;return e>=t&&(e-=t<<1),e};z.DataBuffer.prototype.getBytes=function(r){var e;return r?(r=Math.min(this.length(),r),e=this.data.slice(this.read,this.read+r),this.read+=r):r===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};z.DataBuffer.prototype.bytes=function(r){return typeof r=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+r)};z.DataBuffer.prototype.at=function(r){return this.data.getUint8(this.read+r)};z.DataBuffer.prototype.setAt=function(r,e){return this.data.setUint8(r,e),this};z.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};z.DataBuffer.prototype.copy=function(){return new z.DataBuffer(this)};z.DataBuffer.prototype.compact=function(){if(this.read>0){var r=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(r.byteLength);e.set(r),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};z.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};z.DataBuffer.prototype.truncate=function(r){return this.write=Math.max(0,this.length()-r),this.read=Math.min(this.read,this.write),this};z.DataBuffer.prototype.toHex=function(){for(var r="",e=this.read;e<this.data.byteLength;++e){var t=this.data.getUint8(e);t<16&&(r+="0"),r+=t.toString(16)}return r};z.DataBuffer.prototype.toString=function(r){var e=new Uint8Array(this.data,this.read,this.length());if(r=r||"utf8",r==="binary"||r==="raw")return z.binary.raw.encode(e);if(r==="hex")return z.binary.hex.encode(e);if(r==="base64")return z.binary.base64.encode(e);if(r==="utf8")return z.text.utf8.decode(e);if(r==="utf16")return z.text.utf16.decode(e);throw new Error("Invalid encoding: "+r)};z.createBuffer=function(r,e){return e=e||"raw",r!==void 0&&e==="utf8"&&(r=z.encodeUtf8(r)),new z.ByteBuffer(r)};z.fillString=function(r,e){for(var t="";e>0;)e&1&&(t+=r),e>>>=1,e>0&&(r+=r);return t};z.xorBytes=function(r,e,t){for(var i="",n="",s="",o=0,a=0;t>0;--t,++o)n=r.charCodeAt(o)^e.charCodeAt(o),a>=10&&(i+=s,s="",a=0),s+=String.fromCharCode(n),++a;return i+=s,i};z.hexToBytes=function(r){var e="",t=0;for(r.length&!0&&(t=1,e+=String.fromCharCode(parseInt(r[0],16)));t<r.length;t+=2)e+=String.fromCharCode(parseInt(r.substr(t,2),16));return e};z.bytesToHex=function(r){return z.createBuffer(r).toHex()};z.int32ToBytes=function(r){return String.fromCharCode(r>>24&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255)};var ul="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ll=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],bj="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";z.encode64=function(r,e){for(var t="",i="",n,s,o,a=0;a<r.length;)n=r.charCodeAt(a++),s=r.charCodeAt(a++),o=r.charCodeAt(a++),t+=ul.charAt(n>>2),t+=ul.charAt((n&3)<<4|s>>4),isNaN(s)?t+="==":(t+=ul.charAt((s&15)<<2|o>>6),t+=isNaN(o)?"=":ul.charAt(o&63)),e&&t.length>e&&(i+=t.substr(0,e)+`\r
`,t=t.substr(e));return i+=t,i};z.decode64=function(r){r=r.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",t,i,n,s,o=0;o<r.length;)t=ll[r.charCodeAt(o++)-43],i=ll[r.charCodeAt(o++)-43],n=ll[r.charCodeAt(o++)-43],s=ll[r.charCodeAt(o++)-43],e+=String.fromCharCode(t<<2|i>>4),n!==64&&(e+=String.fromCharCode((i&15)<<4|n>>2),s!==64&&(e+=String.fromCharCode((n&3)<<6|s)));return e};z.encodeUtf8=function(r){return unescape(encodeURIComponent(r))};z.decodeUtf8=function(r){return decodeURIComponent(escape(r))};z.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:mj.encode,decode:mj.decode}};z.binary.raw.encode=function(r){return String.fromCharCode.apply(null,r)};z.binary.raw.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(r.length)),t=t||0;for(var n=t,s=0;s<r.length;++s)i[n++]=r.charCodeAt(s);return e?n-t:i};z.binary.hex.encode=z.bytesToHex;z.binary.hex.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(Math.ceil(r.length/2))),t=t||0;var n=0,s=t;for(r.length&1&&(n=1,i[s++]=parseInt(r[0],16));n<r.length;n+=2)i[s++]=parseInt(r.substr(n,2),16);return e?s-t:i};z.binary.base64.encode=function(r,e){for(var t="",i="",n,s,o,a=0;a<r.byteLength;)n=r[a++],s=r[a++],o=r[a++],t+=ul.charAt(n>>2),t+=ul.charAt((n&3)<<4|s>>4),isNaN(s)?t+="==":(t+=ul.charAt((s&15)<<2|o>>6),t+=isNaN(o)?"=":ul.charAt(o&63)),e&&t.length>e&&(i+=t.substr(0,e)+`\r
`,t=t.substr(e));return i+=t,i};z.binary.base64.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(Math.ceil(r.length/4)*3)),r=r.replace(/[^A-Za-z0-9\+\/\=]/g,""),t=t||0;for(var n,s,o,a,c=0,u=t;c<r.length;)n=ll[r.charCodeAt(c++)-43],s=ll[r.charCodeAt(c++)-43],o=ll[r.charCodeAt(c++)-43],a=ll[r.charCodeAt(c++)-43],i[u++]=n<<2|s>>4,o!==64&&(i[u++]=(s&15)<<4|o>>2,a!==64&&(i[u++]=(o&3)<<6|a));return e?u-t:i.subarray(0,u)};z.binary.base58.encode=function(r,e){return z.binary.baseN.encode(r,bj,e)};z.binary.base58.decode=function(r,e){return z.binary.baseN.decode(r,bj,e)};z.text={utf8:{},utf16:{}};z.text.utf8.encode=function(r,e,t){r=z.encodeUtf8(r);var i=e;i||(i=new Uint8Array(r.length)),t=t||0;for(var n=t,s=0;s<r.length;++s)i[n++]=r.charCodeAt(s);return e?n-t:i};z.text.utf8.decode=function(r){return z.decodeUtf8(String.fromCharCode.apply(null,r))};z.text.utf16.encode=function(r,e,t){var i=e;i||(i=new Uint8Array(r.length*2));var n=new Uint16Array(i.buffer);t=t||0;for(var s=t,o=t,a=0;a<r.length;++a)n[o++]=r.charCodeAt(a),s+=2;return e?s-t:i};z.text.utf16.decode=function(r){return String.fromCharCode.apply(null,new Uint16Array(r.buffer))};z.deflate=function(r,e,t){if(e=z.decode64(r.deflate(z.encode64(e)).rval),t){var i=2,n=e.charCodeAt(1);n&32&&(i=6),e=e.substring(i,e.length-4)}return e};z.inflate=function(r,e,t){var i=r.inflate(z.encode64(e)).rval;return i===null?null:z.decode64(i)};var gE=function(r,e,t){if(!r)throw new Error("WebStorage not available.");var i;if(t===null?i=r.removeItem(e):(t=z.encode64(JSON.stringify(t)),i=r.setItem(e,t)),typeof i!="undefined"&&i.rval!==!0){var n=new Error(i.error.message);throw n.id=i.error.id,n.name=i.error.name,n}},mE=function(r,e){if(!r)throw new Error("WebStorage not available.");var t=r.getItem(e);if(r.init)if(t.rval===null){if(t.error){var i=new Error(t.error.message);throw i.id=t.error.id,i.name=t.error.name,i}t=null}else t=t.rval;return t!==null&&(t=JSON.parse(z.decode64(t))),t},L7e=function(r,e,t,i){var n=mE(r,e);n===null&&(n={}),n[t]=i,gE(r,e,n)},M7e=function(r,e,t){var i=mE(r,e);return i!==null&&(i=t in i?i[t]:null),i},j7e=function(r,e,t){var i=mE(r,e);if(i!==null&&t in i){delete i[t];var n=!0;for(var s in i){n=!1;break}n&&(i=null),gE(r,e,i)}},q7e=function(r,e){gE(r,e,null)},C4=function(r,e,t){var i=null;typeof t=="undefined"&&(t=["web","flash"]);var n,s=!1,o=null;for(var a in t){n=t[a];try{if(n==="flash"||n==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");i=r.apply(this,e),s=n==="flash"}(n==="web"||n==="both")&&(e[0]=localStorage,i=r.apply(this,e),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return i};z.setItem=function(r,e,t,i,n){C4(L7e,arguments,n)};z.getItem=function(r,e,t,i){return C4(M7e,arguments,i)};z.removeItem=function(r,e,t,i){C4(j7e,arguments,i)};z.clearItems=function(r,e,t){C4(q7e,arguments,t)};z.isEmpty=function(r){for(var e in r)if(r.hasOwnProperty(e))return!1;return!0};z.format=function(r){for(var e=/%./g,t,i,n=0,s=[],o=0;t=e.exec(r);){i=r.substring(o,e.lastIndex-2),i.length>0&&s.push(i),o=e.lastIndex;var a=t[0][1];switch(a){case"s":case"o":n<arguments.length?s.push(arguments[n+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(r.substring(o)),s.join("")};z.formatNumber=function(r,e,t,i){var n=r,s=isNaN(e=Math.abs(e))?2:e,o=t===void 0?",":t,a=i===void 0?".":i,c=n<0?"-":"",u=parseInt(n=Math.abs(+n||0).toFixed(s),10)+"",f=u.length>3?u.length%3:0;return c+(f?u.substr(0,f)+a:"")+u.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(n-u).toFixed(s).slice(2):"")};z.formatSize=function(r){return r>=1073741824?r=z.formatNumber(r/1073741824,2,".","")+" GiB":r>=1048576?r=z.formatNumber(r/1048576,2,".","")+" MiB":r>=1024?r=z.formatNumber(r/1024,0)+" KiB":r=z.formatNumber(r,0)+" bytes",r};z.bytesFromIP=function(r){return r.indexOf(".")!==-1?z.bytesFromIPv4(r):r.indexOf(":")!==-1?z.bytesFromIPv6(r):null};z.bytesFromIPv4=function(r){if(r=r.split("."),r.length!==4)return null;for(var e=z.createBuffer(),t=0;t<r.length;++t){var i=parseInt(r[t],10);if(isNaN(i))return null;e.putByte(i)}return e.getBytes()};z.bytesFromIPv6=function(r){var e=0;r=r.split(":").filter(function(o){return o.length===0&&++e,!0});for(var t=(8-r.length+e)*2,i=z.createBuffer(),n=0;n<8;++n){if(!r[n]||r[n].length===0){i.fillWithByte(0,t),t=0;continue}var s=z.hexToBytes(r[n]);s.length<2&&i.putByte(0),i.putBytes(s)}return i.getBytes()};z.bytesToIP=function(r){return r.length===4?z.bytesToIPv4(r):r.length===16?z.bytesToIPv6(r):null};z.bytesToIPv4=function(r){if(r.length!==4)return null;for(var e=[],t=0;t<r.length;++t)e.push(r.charCodeAt(t));return e.join(".")};z.bytesToIPv6=function(r){if(r.length!==16)return null;for(var e=[],t=[],i=0,n=0;n<r.length;n+=2){for(var s=z.bytesToHex(r[n]+r[n+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=t[t.length-1],a=e.length;!o||a!==o.end+1?t.push({start:a,end:a}):(o.end=a,o.end-o.start>t[i].end-t[i].start&&(i=t.length-1))}e.push(s)}if(t.length>0){var c=t[i];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};z.estimateCores=function(r,e){if(typeof r=="function"&&(e=r,r={}),r=r||{},"cores"in z&&!r.update)return e(null,z.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return z.cores=navigator.hardwareConcurrency,e(null,z.cores);if(typeof Worker=="undefined")return z.cores=1,e(null,z.cores);if(typeof Blob=="undefined")return z.cores=2,e(null,z.cores);var t=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));i([],5,16);function i(o,a,c){if(a===0){var u=Math.floor(o.reduce(function(f,d){return f+d},0)/o.length);return z.cores=Math.max(1,u),URL.revokeObjectURL(t),e(null,z.cores)}n(c,function(f,d){o.push(s(c,d)),i(o,a-1,c)})}function n(o,a){for(var c=[],u=[],f=0;f<o;++f){var d=new Worker(t);d.addEventListener("message",function(h){if(u.push(h.data),u.length===o){for(var p=0;p<o;++p)c[p].terminate();a(null,u)}}),c.push(d)}for(var f=0;f<o;++f)c[f].postMessage(f)}function s(o,a){for(var c=[],u=0;u<o;++u)for(var f=a[u],d=c[u]=[],h=0;h<o;++h)if(u!==h){var p=a[h];(f.st>p.st&&f.st<p.et||p.st>f.st&&p.st<f.et)&&d.push(h)}return c.reduce(function(y,g){return Math.max(y,g.length)},0)}}});var Pp=m((pat,_j)=>{l();var Jy=At();Jy.pki=Jy.pki||{};var bE=_j.exports=Jy.pki.oids=Jy.oids=Jy.oids||{};function be(r,e){bE[r]=e,bE[e]=r}function Jt(r,e){bE[r]=e}be("1.2.840.113549.1.1.1","rsaEncryption");be("1.2.840.113549.1.1.4","md5WithRSAEncryption");be("1.2.840.113549.1.1.5","sha1WithRSAEncryption");be("1.2.840.113549.1.1.7","RSAES-OAEP");be("1.2.840.113549.1.1.8","mgf1");be("1.2.840.113549.1.1.9","pSpecified");be("1.2.840.113549.1.1.10","RSASSA-PSS");be("1.2.840.113549.1.1.11","sha256WithRSAEncryption");be("1.2.840.113549.1.1.12","sha384WithRSAEncryption");be("1.2.840.113549.1.1.13","sha512WithRSAEncryption");be("1.3.101.112","EdDSA25519");be("1.2.840.10040.4.3","dsa-with-sha1");be("1.3.14.3.2.7","desCBC");be("1.3.14.3.2.26","sha1");be("1.3.14.3.2.29","sha1WithRSASignature");be("2.16.840.1.101.3.4.2.1","sha256");be("2.16.840.1.101.3.4.2.2","sha384");be("2.16.840.1.101.3.4.2.3","sha512");be("1.2.840.113549.2.5","md5");be("1.2.840.113549.1.7.1","data");be("1.2.840.113549.1.7.2","signedData");be("1.2.840.113549.1.7.3","envelopedData");be("1.2.840.113549.1.7.4","signedAndEnvelopedData");be("1.2.840.113549.1.7.5","digestedData");be("1.2.840.113549.1.7.6","encryptedData");be("1.2.840.113549.1.9.1","emailAddress");be("1.2.840.113549.1.9.2","unstructuredName");be("1.2.840.113549.1.9.3","contentType");be("1.2.840.113549.1.9.4","messageDigest");be("1.2.840.113549.1.9.5","signingTime");be("1.2.840.113549.1.9.6","counterSignature");be("1.2.840.113549.1.9.7","challengePassword");be("1.2.840.113549.1.9.8","unstructuredAddress");be("1.2.840.113549.1.9.14","extensionRequest");be("1.2.840.113549.1.9.20","friendlyName");be("1.2.840.113549.1.9.21","localKeyId");be("1.2.840.113549.1.9.22.1","x509Certificate");be("1.2.840.113549.1.12.10.1.1","keyBag");be("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");be("1.2.840.113549.1.12.10.1.3","certBag");be("1.2.840.113549.1.12.10.1.4","crlBag");be("1.2.840.113549.1.12.10.1.5","secretBag");be("1.2.840.113549.1.12.10.1.6","safeContentsBag");be("1.2.840.113549.1.5.13","pkcs5PBES2");be("1.2.840.113549.1.5.12","pkcs5PBKDF2");be("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");be("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");be("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");be("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");be("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");be("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");be("1.2.840.113549.2.7","hmacWithSHA1");be("1.2.840.113549.2.8","hmacWithSHA224");be("1.2.840.113549.2.9","hmacWithSHA256");be("1.2.840.113549.2.10","hmacWithSHA384");be("1.2.840.113549.2.11","hmacWithSHA512");be("1.2.840.113549.3.7","des-EDE3-CBC");be("2.16.840.1.101.3.4.1.2","aes128-CBC");be("2.16.840.1.101.3.4.1.22","aes192-CBC");be("2.16.840.1.101.3.4.1.42","aes256-CBC");be("2.5.4.3","commonName");be("2.5.4.4","surname");be("2.5.4.5","serialNumber");be("2.5.4.6","countryName");be("2.5.4.7","localityName");be("2.5.4.8","stateOrProvinceName");be("2.5.4.9","streetAddress");be("2.5.4.10","organizationName");be("2.5.4.11","organizationalUnitName");be("2.5.4.12","title");be("2.5.4.13","description");be("2.5.4.15","businessCategory");be("2.5.4.17","postalCode");be("2.5.4.42","givenName");be("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");be("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");be("2.16.840.1.113730.1.1","nsCertType");be("2.16.840.1.113730.1.13","nsComment");Jt("2.5.29.1","authorityKeyIdentifier");Jt("2.5.29.2","keyAttributes");Jt("2.5.29.3","certificatePolicies");Jt("2.5.29.4","keyUsageRestriction");Jt("2.5.29.5","policyMapping");Jt("2.5.29.6","subtreesConstraint");Jt("2.5.29.7","subjectAltName");Jt("2.5.29.8","issuerAltName");Jt("2.5.29.9","subjectDirectoryAttributes");Jt("2.5.29.10","basicConstraints");Jt("2.5.29.11","nameConstraints");Jt("2.5.29.12","policyConstraints");Jt("2.5.29.13","basicConstraints");be("2.5.29.14","subjectKeyIdentifier");be("2.5.29.15","keyUsage");Jt("2.5.29.16","privateKeyUsagePeriod");be("2.5.29.17","subjectAltName");be("2.5.29.18","issuerAltName");be("2.5.29.19","basicConstraints");Jt("2.5.29.20","cRLNumber");Jt("2.5.29.21","cRLReason");Jt("2.5.29.22","expirationDate");Jt("2.5.29.23","instructionCode");Jt("2.5.29.24","invalidityDate");Jt("2.5.29.25","cRLDistributionPoints");Jt("2.5.29.26","issuingDistributionPoint");Jt("2.5.29.27","deltaCRLIndicator");Jt("2.5.29.28","issuingDistributionPoint");Jt("2.5.29.29","certificateIssuer");Jt("2.5.29.30","nameConstraints");be("2.5.29.31","cRLDistributionPoints");be("2.5.29.32","certificatePolicies");Jt("2.5.29.33","policyMappings");Jt("2.5.29.34","policyConstraints");be("2.5.29.35","authorityKeyIdentifier");Jt("2.5.29.36","policyConstraints");be("2.5.29.37","extKeyUsage");Jt("2.5.29.46","freshestCRL");Jt("2.5.29.54","inhibitAnyPolicy");be("1.3.6.1.4.1.11129.2.4.2","timestampList");be("1.3.6.1.5.5.7.1.1","authorityInfoAccess");be("1.3.6.1.5.5.7.3.1","serverAuth");be("1.3.6.1.5.5.7.3.2","clientAuth");be("1.3.6.1.5.5.7.3.3","codeSigning");be("1.3.6.1.5.5.7.3.4","emailProtection");be("1.3.6.1.5.5.7.3.8","timeStamping")});var fl=m((yat,Ej)=>{l();var jr=At();vr();Pp();var Ce=Ej.exports=jr.asn1=jr.asn1||{};Ce.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};Ce.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};Ce.create=function(r,e,t,i,n){if(jr.util.isArray(i)){for(var s=[],o=0;o<i.length;++o)i[o]!==void 0&&s.push(i[o]);i=s}var a={tagClass:r,type:e,constructed:t,composed:t||jr.util.isArray(i),value:i};return n&&"bitStringContents"in n&&(a.bitStringContents=n.bitStringContents,a.original=Ce.copy(a)),a};Ce.copy=function(r,e){var t;if(jr.util.isArray(r)){t=[];for(var i=0;i<r.length;++i)t.push(Ce.copy(r[i],e));return t}return typeof r=="string"?r:(t={tagClass:r.tagClass,type:r.type,constructed:r.constructed,composed:r.composed,value:Ce.copy(r.value,e)},e&&!e.excludeBitStringContents&&(t.bitStringContents=r.bitStringContents),t)};Ce.equals=function(r,e,t){if(jr.util.isArray(r)){if(!jr.util.isArray(e)||r.length!==e.length)return!1;for(var i=0;i<r.length;++i)if(!Ce.equals(r[i],e[i]))return!1;return!0}if(typeof r!=typeof e)return!1;if(typeof r=="string")return r===e;var n=r.tagClass===e.tagClass&&r.type===e.type&&r.constructed===e.constructed&&r.composed===e.composed&&Ce.equals(r.value,e.value);return t&&t.includeBitStringContents&&(n=n&&r.bitStringContents===e.bitStringContents),n};Ce.getBerValueLength=function(r){var e=r.getByte();if(e!==128){var t,i=e&128;return i?t=r.getInt((e&127)<<3):t=e,t}};function e2(r,e,t){if(t>e){var i=new Error("Too few bytes to parse DER.");throw i.available=r.length(),i.remaining=e,i.requested=t,i}}var U7e=function(r,e){var t=r.getByte();if(e--,t!==128){var i,n=t&128;if(!n)i=t;else{var s=t&127;e2(r,e,s),i=r.getInt(s<<3)}if(i<0)throw new Error("Negative length: "+i);return i}};Ce.fromDer=function(r,e){return e===void 0&&(e={strict:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof r=="string"&&(r=jr.util.createBuffer(r)),O4(r,r.length(),0,e)};function O4(r,e,t,i){var n;e2(r,e,2);var s=r.getByte();e--;var o=s&192,a=s&31;n=r.length();var c=U7e(r,e);if(e-=n-r.length(),c!==void 0&&c>e){if(i.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=r.length(),u.remaining=e,u.requested=c,u}c=e}var f,d,h=(s&32)==32;if(h)if(f=[],c===void 0)for(;;){if(e2(r,e,2),r.bytes(2)===String.fromCharCode(0,0)){r.getBytes(2),e-=2;break}n=r.length(),f.push(O4(r,e,t+1,i)),e-=n-r.length()}else for(;c>0;)n=r.length(),f.push(O4(r,c,t+1,i)),e-=n-r.length(),c-=n-r.length();if(f===void 0&&o===Ce.Class.UNIVERSAL&&a===Ce.Type.BITSTRING&&(d=r.bytes(c)),f===void 0&&i.decodeBitStrings&&o===Ce.Class.UNIVERSAL&&a===Ce.Type.BITSTRING&&c>1){var p=r.read,y=e,g=0;if(a===Ce.Type.BITSTRING&&(e2(r,e,1),g=r.getByte(),e--),g===0)try{n=r.length();var w={verbose:i.verbose,strict:!0,decodeBitStrings:!0},b=O4(r,e,t+1,w),v=n-r.length();e-=v,a==Ce.Type.BITSTRING&&v++;var R=b.tagClass;v===c&&(R===Ce.Class.UNIVERSAL||R===Ce.Class.CONTEXT_SPECIFIC)&&(f=[b])}catch(C){}f===void 0&&(r.read=p,e=y)}if(f===void 0){if(c===void 0){if(i.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===Ce.Type.BMPSTRING)for(f="";c>0;c-=2)e2(r,e,2),f+=String.fromCharCode(r.getInt16()),e-=2;else f=r.getBytes(c)}var k=d===void 0?null:{bitStringContents:d};return Ce.create(o,a,h,f,k)}Ce.toDer=function(r){var e=jr.util.createBuffer(),t=r.tagClass|r.type,i=jr.util.createBuffer(),n=!1;if("bitStringContents"in r&&(n=!0,r.original&&(n=Ce.equals(r,r.original))),n)i.putBytes(r.bitStringContents);else if(r.composed){r.constructed?t|=32:i.putByte(0);for(var s=0;s<r.value.length;++s)r.value[s]!==void 0&&i.putBuffer(Ce.toDer(r.value[s]))}else if(r.type===Ce.Type.BMPSTRING)for(var s=0;s<r.value.length;++s)i.putInt16(r.value.charCodeAt(s));else r.type===Ce.Type.INTEGER&&r.value.length>1&&(r.value.charCodeAt(0)===0&&(r.value.charCodeAt(1)&128)==0||r.value.charCodeAt(0)===255&&(r.value.charCodeAt(1)&128)==128)?i.putBytes(r.value.substr(1)):i.putBytes(r.value);if(e.putByte(t),i.length()<=127)e.putByte(i.length()&127);else{var o=i.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(i),e};Ce.oidToDer=function(r){var e=r.split("."),t=jr.util.createBuffer();t.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var i,n,s,o,a=2;a<e.length;++a){i=!0,n=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,i||(o|=128),n.push(o),i=!1;while(s>0);for(var c=n.length-1;c>=0;--c)t.putByte(n[c])}return t};Ce.derToOid=function(r){var e;typeof r=="string"&&(r=jr.util.createBuffer(r));var t=r.getByte();e=Math.floor(t/40)+"."+t%40;for(var i=0;r.length()>0;)t=r.getByte(),i=i<<7,t&128?i+=t&127:(e+="."+(i+t),i=0);return e};Ce.utcTimeToDate=function(r){var e=new Date,t=parseInt(r.substr(0,2),10);t=t>=50?1900+t:2e3+t;var i=parseInt(r.substr(2,2),10)-1,n=parseInt(r.substr(4,2),10),s=parseInt(r.substr(6,2),10),o=parseInt(r.substr(8,2),10),a=0;if(r.length>11){var c=r.charAt(10),u=10;c!=="+"&&c!=="-"&&(a=parseInt(r.substr(10,2),10),u+=2)}if(e.setUTCFullYear(t,i,n),e.setUTCHours(s,o,a,0),u&&(c=r.charAt(u),c==="+"||c==="-")){var f=parseInt(r.substr(u+1,2),10),d=parseInt(r.substr(u+4,2),10),h=f*60+d;h*=6e4,c==="+"?e.setTime(+e-h):e.setTime(+e+h)}return e};Ce.generalizedTimeToDate=function(r){var e=new Date,t=parseInt(r.substr(0,4),10),i=parseInt(r.substr(4,2),10)-1,n=parseInt(r.substr(6,2),10),s=parseInt(r.substr(8,2),10),o=parseInt(r.substr(10,2),10),a=parseInt(r.substr(12,2),10),c=0,u=0,f=!1;r.charAt(r.length-1)==="Z"&&(f=!0);var d=r.length-5,h=r.charAt(d);if(h==="+"||h==="-"){var p=parseInt(r.substr(d+1,2),10),y=parseInt(r.substr(d+4,2),10);u=p*60+y,u*=6e4,h==="+"&&(u*=-1),f=!0}return r.charAt(14)==="."&&(c=parseFloat(r.substr(14),10)*1e3),f?(e.setUTCFullYear(t,i,n),e.setUTCHours(s,o,a,c),e.setTime(+e+u)):(e.setFullYear(t,i,n),e.setHours(s,o,a,c)),e};Ce.dateToUtcTime=function(r){if(typeof r=="string")return r;var e="",t=[];t.push((""+r.getUTCFullYear()).substr(2)),t.push(""+(r.getUTCMonth()+1)),t.push(""+r.getUTCDate()),t.push(""+r.getUTCHours()),t.push(""+r.getUTCMinutes()),t.push(""+r.getUTCSeconds());for(var i=0;i<t.length;++i)t[i].length<2&&(e+="0"),e+=t[i];return e+="Z",e};Ce.dateToGeneralizedTime=function(r){if(typeof r=="string")return r;var e="",t=[];t.push(""+r.getUTCFullYear()),t.push(""+(r.getUTCMonth()+1)),t.push(""+r.getUTCDate()),t.push(""+r.getUTCHours()),t.push(""+r.getUTCMinutes()),t.push(""+r.getUTCSeconds());for(var i=0;i<t.length;++i)t[i].length<2&&(e+="0"),e+=t[i];return e+="Z",e};Ce.integerToDer=function(r){var e=jr.util.createBuffer();if(r>=-128&&r<128)return e.putSignedInt(r,8);if(r>=-32768&&r<32768)return e.putSignedInt(r,16);if(r>=-8388608&&r<8388608)return e.putSignedInt(r,24);if(r>=-2147483648&&r<2147483648)return e.putSignedInt(r,32);var t=new Error("Integer too large; max is 32-bits.");throw t.integer=r,t};Ce.derToInteger=function(r){typeof r=="string"&&(r=jr.util.createBuffer(r));var e=r.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return r.getSignedInt(e)};Ce.validate=function(r,e,t,i){var n=!1;if((r.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(r.type===e.type||typeof e.type=="undefined"))if(r.constructed===e.constructed||typeof e.constructed=="undefined"){if(n=!0,e.value&&jr.util.isArray(e.value))for(var s=0,o=0;n&&o<e.value.length;++o)n=e.value[o].optional||!1,r.value[s]&&(n=Ce.validate(r.value[s],e.value[o],t,i),n?++s:e.value[o].optional&&(n=!0)),!n&&i&&i.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+r.value.length+'"');if(n&&t&&(e.capture&&(t[e.capture]=r.value),e.captureAsn1&&(t[e.captureAsn1]=r),e.captureBitStringContents&&"bitStringContents"in r&&(t[e.captureBitStringContents]=r.bitStringContents),e.captureBitStringValue&&"bitStringContents"in r)){var a;if(r.bitStringContents.length<2)t[e.captureBitStringValue]="";else{var c=r.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");t[e.captureBitStringValue]=r.bitStringContents.slice(1)}}}else i&&i.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+r.constructed+'"');else i&&(r.tagClass!==e.tagClass&&i.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+r.tagClass+'"'),r.type!==e.type&&i.push("["+e.name+'] Expected type "'+e.type+'", got "'+r.type+'"'));return n};var vj=/[^\\u0000-\\u00ff]/;Ce.prettyPrint=function(r,e,t){var i="";e=e||0,t=t||2,e>0&&(i+=`
`);for(var n="",s=0;s<e*t;++s)n+=" ";switch(i+=n+"Tag: ",r.tagClass){case Ce.Class.UNIVERSAL:i+="Universal:";break;case Ce.Class.APPLICATION:i+="Application:";break;case Ce.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case Ce.Class.PRIVATE:i+="Private:";break}if(r.tagClass===Ce.Class.UNIVERSAL)switch(i+=r.type,r.type){case Ce.Type.NONE:i+=" (None)";break;case Ce.Type.BOOLEAN:i+=" (Boolean)";break;case Ce.Type.INTEGER:i+=" (Integer)";break;case Ce.Type.BITSTRING:i+=" (Bit string)";break;case Ce.Type.OCTETSTRING:i+=" (Octet string)";break;case Ce.Type.NULL:i+=" (Null)";break;case Ce.Type.OID:i+=" (Object Identifier)";break;case Ce.Type.ODESC:i+=" (Object Descriptor)";break;case Ce.Type.EXTERNAL:i+=" (External or Instance of)";break;case Ce.Type.REAL:i+=" (Real)";break;case Ce.Type.ENUMERATED:i+=" (Enumerated)";break;case Ce.Type.EMBEDDED:i+=" (Embedded PDV)";break;case Ce.Type.UTF8:i+=" (UTF8)";break;case Ce.Type.ROID:i+=" (Relative Object Identifier)";break;case Ce.Type.SEQUENCE:i+=" (Sequence)";break;case Ce.Type.SET:i+=" (Set)";break;case Ce.Type.PRINTABLESTRING:i+=" (Printable String)";break;case Ce.Type.IA5String:i+=" (IA5String (ASCII))";break;case Ce.Type.UTCTIME:i+=" (UTC time)";break;case Ce.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case Ce.Type.BMPSTRING:i+=" (BMP String)";break}else i+=r.type;if(i+=`
`,i+=n+"Constructed: "+r.constructed+`
`,r.composed){for(var o=0,a="",s=0;s<r.value.length;++s)r.value[s]!==void 0&&(o+=1,a+=Ce.prettyPrint(r.value[s],e+1,t),s+1<r.value.length&&(a+=","));i+=n+"Sub values: "+o+a}else{if(i+=n+"Value: ",r.type===Ce.Type.OID){var c=Ce.derToOid(r.value);i+=c,jr.pki&&jr.pki.oids&&c in jr.pki.oids&&(i+=" ("+jr.pki.oids[c]+") ")}if(r.type===Ce.Type.INTEGER)try{i+=Ce.derToInteger(r.value)}catch(f){i+="0x"+jr.util.bytesToHex(r.value)}else if(r.type===Ce.Type.BITSTRING){if(r.value.length>1?i+="0x"+jr.util.bytesToHex(r.value.slice(1)):i+="(none)",r.value.length>0){var u=r.value.charCodeAt(0);u==1?i+=" (1 unused bit shown)":u>1&&(i+=" ("+u+" unused bits shown)")}}else r.type===Ce.Type.OCTETSTRING?(vj.test(r.value)||(i+="("+r.value+") "),i+="0x"+jr.util.bytesToHex(r.value)):r.type===Ce.Type.UTF8?i+=jr.util.decodeUtf8(r.value):r.type===Ce.Type.PRINTABLESTRING||r.type===Ce.Type.IA5String?i+=r.value:vj.test(r.value)?i+="0x"+jr.util.bytesToHex(r.value):r.value.length===0?i+="[null]":i+=r.value}return i}});var _E=m((gat,Sj)=>{l();var Wi=At();vr();Sj.exports=Wi.cipher=Wi.cipher||{};Wi.cipher.algorithms=Wi.cipher.algorithms||{};Wi.cipher.createCipher=function(r,e){var t=r;if(typeof t=="string"&&(t=Wi.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+r);return new Wi.cipher.BlockCipher({algorithm:t,key:e,decrypt:!1})};Wi.cipher.createDecipher=function(r,e){var t=r;if(typeof t=="string"&&(t=Wi.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+r);return new Wi.cipher.BlockCipher({algorithm:t,key:e,decrypt:!0})};Wi.cipher.registerAlgorithm=function(r,e){r=r.toUpperCase(),Wi.cipher.algorithms[r]=e};Wi.cipher.getAlgorithm=function(r){return r=r.toUpperCase(),r in Wi.cipher.algorithms?Wi.cipher.algorithms[r]:null};var wE=Wi.cipher.BlockCipher=function(r){this.algorithm=r.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=r.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=r.decrypt,this.algorithm.initialize(r)};wE.prototype.start=function(r){r=r||{};var e={};for(var t in r)e[t]=r[t];e.decrypt=this._decrypt,this._finish=!1,this._input=Wi.util.createBuffer(),this.output=r.output||Wi.util.createBuffer(),this.mode.start(e)};wE.prototype.update=function(r){for(r&&this._input.putBuffer(r);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};wE.prototype.finish=function(r){r&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(t){return r(this.blockSize,t,!1)},this.mode.unpad=function(t){return r(this.blockSize,t,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var EE=m((mat,Aj)=>{l();var Yi=At();vr();Yi.cipher=Yi.cipher||{};var Rt=Aj.exports=Yi.cipher.modes=Yi.cipher.modes||{};Rt.ecb=function(r){r=r||{},this.name="ECB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Rt.ecb.prototype.start=function(r){};Rt.ecb.prototype.encrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};Rt.ecb.prototype.decrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};Rt.ecb.prototype.pad=function(r,e){var t=r.length()===this.blockSize?this.blockSize:this.blockSize-r.length();return r.fillWithByte(t,t),!0};Rt.ecb.prototype.unpad=function(r,e){if(e.overflow>0)return!1;var t=r.length(),i=r.at(t-1);return i>this.blockSize<<2?!1:(r.truncate(i),!0)};Rt.cbc=function(r){r=r||{},this.name="CBC",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Rt.cbc.prototype.start=function(r){if(r.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in r)this._iv=k4(r.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Rt.cbc.prototype.encrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=this._prev[i]^r.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]);this._prev=this._outBlock};Rt.cbc.prototype.decrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._prev[i]^this._outBlock[i]);this._prev=this._inBlock.slice(0)};Rt.cbc.prototype.pad=function(r,e){var t=r.length()===this.blockSize?this.blockSize:this.blockSize-r.length();return r.fillWithByte(t,t),!0};Rt.cbc.prototype.unpad=function(r,e){if(e.overflow>0)return!1;var t=r.length(),i=r.at(t-1);return i>this.blockSize<<2?!1:(r.truncate(i),!0)};Rt.cfb=function(r){r=r||{},this.name="CFB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Yi.util.createBuffer(),this._partialBytes=0};Rt.cfb.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=k4(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Rt.cfb.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=r.getInt32()^this._outBlock[n],e.putInt32(this._inBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=r.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};Rt.cfb.prototype.decrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=r.getInt32(),e.putInt32(this._inBlock[n]^this._outBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=r.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};Rt.ofb=function(r){r=r||{},this.name="OFB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Yi.util.createBuffer(),this._partialBytes=0};Rt.ofb.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=k4(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Rt.ofb.prototype.encrypt=function(r,e,t){var i=r.length();if(r.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(r.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};Rt.ofb.prototype.decrypt=Rt.ofb.prototype.encrypt;Rt.ctr=function(r){r=r||{},this.name="CTR",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Yi.util.createBuffer(),this._partialBytes=0};Rt.ctr.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=k4(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Rt.ctr.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize)for(var n=0;n<this._ints;++n)e.putInt32(r.getInt32()^this._outBlock[n]);else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s>0&&(r.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}D4(this._inBlock)};Rt.ctr.prototype.decrypt=Rt.ctr.prototype.encrypt;Rt.gcm=function(r){r=r||{},this.name="GCM",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Yi.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Rt.gcm.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");var e=Yi.util.createBuffer(r.iv);this._cipherLength=0;var t;if("additionalData"in r?t=Yi.util.createBuffer(r.additionalData):t=Yi.util.createBuffer(),"tagLength"in r?this._tagLength=r.tagLength:this._tagLength=128,this._tag=null,r.decrypt&&(this._tag=Yi.util.createBuffer(r.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=e.length();if(i===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(vE(i*8)))}this._inBlock=this._j0.slice(0),D4(this._inBlock),this._partialBytes=0,t=Yi.util.createBuffer(t),this._aDataLength=vE(t.length()*8);var n=t.length()%this.blockSize;for(n&&t.fillWithByte(0,this.blockSize-n),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])};Rt.gcm.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^=r.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s<=0||t){if(t){var o=i%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var n=0;n<this._ints;++n)this._outBlock[n]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return r.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),D4(this._inBlock)};Rt.gcm.prototype.decrypt=function(r,e,t){var i=r.length();if(i<this.blockSize&&!(t&&i>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),D4(this._inBlock),this._hashBlock[0]=r.getInt32(),this._hashBlock[1]=r.getInt32(),this._hashBlock[2]=r.getInt32(),this._hashBlock[3]=r.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^this._hashBlock[n]);i<this.blockSize?this._cipherLength+=i%this.blockSize:this._cipherLength+=this.blockSize};Rt.gcm.prototype.afterFinish=function(r,e){var t=!0;e.decrypt&&e.overflow&&r.truncate(this.blockSize-e.overflow),this.tag=Yi.util.createBuffer();var i=this._aDataLength.concat(vE(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,i);var n=[];this.cipher.encrypt(this._j0,n);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^n[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(t=!1),t};Rt.gcm.prototype.multiply=function(r,e){for(var t=[0,0,0,0],i=e.slice(0),n=0;n<128;++n){var s=r[n/32|0]&1<<31-n%32;s&&(t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]),this.pow(i,i)}return t};Rt.gcm.prototype.pow=function(r,e){for(var t=r[3]&1,i=3;i>0;--i)e[i]=r[i]>>>1|(r[i-1]&1)<<31;e[0]=r[0]>>>1,t&&(e[0]^=this._R)};Rt.gcm.prototype.tableMultiply=function(r){for(var e=[0,0,0,0],t=0;t<32;++t){var i=t/8|0,n=r[i]>>>(7-t%8)*4&15,s=this._m[t][n];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};Rt.gcm.prototype.ghash=function(r,e,t){return e[0]^=t[0],e[1]^=t[1],e[2]^=t[2],e[3]^=t[3],this.tableMultiply(e)};Rt.gcm.prototype.generateHashTable=function(r,e){for(var t=8/e,i=4*t,n=16*t,s=new Array(n),o=0;o<n;++o){var a=[0,0,0,0],c=o/i|0,u=(i-1-o%i)*e;a[c]=1<<e-1<<u,s[o]=this.generateSubHashTable(this.multiply(a,r),e)}return s};Rt.gcm.prototype.generateSubHashTable=function(r,e){var t=1<<e,i=t>>>1,n=new Array(t);n[i]=r.slice(0);for(var s=i>>>1;s>0;)this.pow(n[2*s],n[s]=[]),s>>=1;for(s=2;s<i;){for(var o=1;o<s;++o){var a=n[s],c=n[o];n[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(n[0]=[0,0,0,0],s=i+1;s<t;++s){var u=n[s^i];n[s]=[r[0]^u[0],r[1]^u[1],r[2]^u[2],r[3]^u[3]]}return n};function k4(r,e){if(typeof r=="string"&&(r=Yi.util.createBuffer(r)),Yi.util.isArray(r)&&r.length>4){var t=r;r=Yi.util.createBuffer();for(var i=0;i<t.length;++i)r.putByte(t[i])}if(r.length()<e)throw new Error("Invalid IV length; got "+r.length()+" bytes and expected "+e+" bytes.");if(!Yi.util.isArray(r)){for(var n=[],s=e/4,i=0;i<s;++i)n.push(r.getInt32());r=n}return r}function D4(r){r[r.length-1]=r[r.length-1]+1&4294967295}function vE(r){return[r/4294967296|0,r&4294967295]}});var kp=m((bat,Tj)=>{l();var Er=At();_E();EE();vr();Tj.exports=Er.aes=Er.aes||{};Er.aes.startEncrypting=function(r,e,t,i){var n=N4({key:r,output:t,decrypt:!1,mode:i});return n.start(e),n};Er.aes.createEncryptionCipher=function(r,e){return N4({key:r,output:null,decrypt:!1,mode:e})};Er.aes.startDecrypting=function(r,e,t,i){var n=N4({key:r,output:t,decrypt:!0,mode:i});return n.start(e),n};Er.aes.createDecryptionCipher=function(r,e){return N4({key:r,output:null,decrypt:!0,mode:e})};Er.aes.Algorithm=function(r,e){SE||xj();var t=this;t.name=r,t.mode=new e({blockSize:16,cipher:{encrypt:function(i,n){return RE(t._w,i,n,!1)},decrypt:function(i,n){return RE(t._w,i,n,!0)}}}),t._init=!1};Er.aes.Algorithm.prototype.initialize=function(r){if(!this._init){var e=r.key,t;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=Er.util.createBuffer(e);else if(Er.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){t=e,e=Er.util.createBuffer();for(var i=0;i<t.length;++i)e.putByte(t[i])}if(!Er.util.isArray(e)){t=e,e=[];var n=t.length();if(n===16||n===24||n===32){n=n>>>2;for(var i=0;i<n;++i)e.push(t.getInt32())}}if(!Er.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=Ij(e,r.decrypt&&!o),this._init=!0}};Er.aes._expandKey=function(r,e){return SE||xj(),Ij(r,e)};Er.aes._updateBlock=RE;Cp("AES-ECB",Er.cipher.modes.ecb);Cp("AES-CBC",Er.cipher.modes.cbc);Cp("AES-CFB",Er.cipher.modes.cfb);Cp("AES-OFB",Er.cipher.modes.ofb);Cp("AES-CTR",Er.cipher.modes.ctr);Cp("AES-GCM",Er.cipher.modes.gcm);function Cp(r,e){var t=function(){return new Er.aes.Algorithm(r,e)};Er.cipher.registerAlgorithm(r,t)}var SE=!1,Op=4,Bn,AE,Rj,Hf,Wo;function xj(){SE=!0,Rj=[0,1,2,4,8,16,32,64,128,27,54];for(var r=new Array(256),e=0;e<128;++e)r[e]=e<<1,r[e+128]=e+128<<1^283;Bn=new Array(256),AE=new Array(256),Hf=new Array(4),Wo=new Array(4);for(var e=0;e<4;++e)Hf[e]=new Array(256),Wo[e]=new Array(256);for(var t=0,i=0,n,s,o,a,c,u,f,e=0;e<256;++e){a=i^i<<1^i<<2^i<<3^i<<4,a=a>>8^a&255^99,Bn[t]=a,AE[a]=t,c=r[a],n=r[t],s=r[n],o=r[s],u=c<<24^a<<16^a<<8^(a^c),f=(n^s^o)<<24^(t^o)<<16^(t^s^o)<<8^(t^n^o);for(var d=0;d<4;++d)Hf[d][t]=u,Wo[d][a]=f,u=u<<24|u>>>8,f=f<<24|f>>>8;t===0?t=i=1:(t=n^r[r[r[n^o]]],i^=r[r[i]])}}function Ij(r,e){for(var t=r.slice(0),i,n=1,s=t.length,o=s+6+1,a=Op*o,c=s;c<a;++c)i=t[c-1],c%s==0?(i=Bn[i>>>16&255]<<24^Bn[i>>>8&255]<<16^Bn[i&255]<<8^Bn[i>>>24]^Rj[n]<<24,n++):s>6&&c%s==4&&(i=Bn[i>>>24]<<24^Bn[i>>>16&255]<<16^Bn[i>>>8&255]<<8^Bn[i&255]),t[c]=t[c-s]^i;if(e){var u,f=Wo[0],d=Wo[1],h=Wo[2],p=Wo[3],y=t.slice(0);a=t.length;for(var c=0,g=a-Op;c<a;c+=Op,g-=Op)if(c===0||c===a-Op)y[c]=t[g],y[c+1]=t[g+3],y[c+2]=t[g+2],y[c+3]=t[g+1];else for(var w=0;w<Op;++w)u=t[g+w],y[c+(3&-w)]=f[Bn[u>>>24]]^d[Bn[u>>>16&255]]^h[Bn[u>>>8&255]]^p[Bn[u&255]];t=y}return t}function RE(r,e,t,i){var n=r.length/4-1,s,o,a,c,u;i?(s=Wo[0],o=Wo[1],a=Wo[2],c=Wo[3],u=AE):(s=Hf[0],o=Hf[1],a=Hf[2],c=Hf[3],u=Bn);var f,d,h,p,y,g,w;f=e[0]^r[0],d=e[i?3:1]^r[1],h=e[2]^r[2],p=e[i?1:3]^r[3];for(var b=3,v=1;v<n;++v)y=s[f>>>24]^o[d>>>16&255]^a[h>>>8&255]^c[p&255]^r[++b],g=s[d>>>24]^o[h>>>16&255]^a[p>>>8&255]^c[f&255]^r[++b],w=s[h>>>24]^o[p>>>16&255]^a[f>>>8&255]^c[d&255]^r[++b],p=s[p>>>24]^o[f>>>16&255]^a[d>>>8&255]^c[h&255]^r[++b],f=y,d=g,h=w;t[0]=u[f>>>24]<<24^u[d>>>16&255]<<16^u[h>>>8&255]<<8^u[p&255]^r[++b],t[i?3:1]=u[d>>>24]<<24^u[h>>>16&255]<<16^u[p>>>8&255]<<8^u[f&255]^r[++b],t[2]=u[h>>>24]<<24^u[p>>>16&255]<<16^u[f>>>8&255]<<8^u[d&255]^r[++b],t[i?1:3]=u[p>>>24]<<24^u[f>>>16&255]<<16^u[d>>>8&255]<<8^u[h&255]^r[++b]}function N4(r){r=r||{};var e=(r.mode||"CBC").toUpperCase(),t="AES-"+e,i;r.decrypt?i=Er.cipher.createDecipher(t,r.key):i=Er.cipher.createCipher(t,r.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof Er.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var L4=m((wat,Cj)=>{l();var qr=At();_E();EE();vr();Cj.exports=qr.des=qr.des||{};qr.des.startEncrypting=function(r,e,t,i){var n=B4({key:r,output:t,decrypt:!1,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};qr.des.createEncryptionCipher=function(r,e){return B4({key:r,output:null,decrypt:!1,mode:e})};qr.des.startDecrypting=function(r,e,t,i){var n=B4({key:r,output:t,decrypt:!0,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};qr.des.createDecryptionCipher=function(r,e){return B4({key:r,output:null,decrypt:!0,mode:e})};qr.des.Algorithm=function(r,e){var t=this;t.name=r,t.mode=new e({blockSize:8,cipher:{encrypt:function(i,n){return Pj(t._keys,i,n,!1)},decrypt:function(i,n){return Pj(t._keys,i,n,!0)}}}),t._init=!1};qr.des.Algorithm.prototype.initialize=function(r){if(!this._init){var e=qr.util.createBuffer(r.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Y7e(e),this._init=!0}};ja("DES-ECB",qr.cipher.modes.ecb);ja("DES-CBC",qr.cipher.modes.cbc);ja("DES-CFB",qr.cipher.modes.cfb);ja("DES-OFB",qr.cipher.modes.ofb);ja("DES-CTR",qr.cipher.modes.ctr);ja("3DES-ECB",qr.cipher.modes.ecb);ja("3DES-CBC",qr.cipher.modes.cbc);ja("3DES-CFB",qr.cipher.modes.cfb);ja("3DES-OFB",qr.cipher.modes.ofb);ja("3DES-CTR",qr.cipher.modes.ctr);function ja(r,e){var t=function(){return new qr.des.Algorithm(r,e)};qr.cipher.registerAlgorithm(r,t)}var F7e=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],K7e=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],V7e=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],z7e=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],H7e=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],$7e=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],G7e=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],W7e=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Y7e(r){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],t=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],f=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],d=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],y=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=r.length()>8?3:1,w=[],b=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],v=0,R,k=0;k<g;k++){var C=r.getInt32(),T=r.getInt32();R=(C>>>4^T)&252645135,T^=R,C^=R<<4,R=(T>>>-16^C)&65535,C^=R,T^=R<<-16,R=(C>>>2^T)&858993459,T^=R,C^=R<<2,R=(T>>>-16^C)&65535,C^=R,T^=R<<-16,R=(C>>>1^T)&1431655765,T^=R,C^=R<<1,R=(T>>>8^C)&16711935,C^=R,T^=R<<8,R=(C>>>1^T)&1431655765,T^=R,C^=R<<1,R=C<<8|T>>>20&240,C=T<<24|T<<8&16711680|T>>>8&65280|T>>>24&240,T=R;for(var D=0;D<b.length;++D){b[D]?(C=C<<2|C>>>26,T=T<<2|T>>>26):(C=C<<1|C>>>27,T=T<<1|T>>>27),C&=-15,T&=-15;var j=e[C>>>28]|t[C>>>24&15]|i[C>>>20&15]|n[C>>>16&15]|s[C>>>12&15]|o[C>>>8&15]|a[C>>>4&15],M=c[T>>>28]|u[T>>>24&15]|f[T>>>20&15]|d[T>>>16&15]|h[T>>>12&15]|p[T>>>8&15]|y[T>>>4&15];R=(M>>>16^j)&65535,w[v++]=j^R,w[v++]=M^R<<16}}return w}function Pj(r,e,t,i){var n=r.length===32?3:9,s;n===3?s=i?[30,-2,-2]:[0,32,2]:s=i?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var u=0;u<n;u+=3){for(var f=s[u+1],d=s[u+2],h=s[u];h!=f;h+=d){var p=c^r[h],y=(c>>>4|c<<28)^r[h+1];o=a,a=c,c=o^(K7e[p>>>24&63]|z7e[p>>>16&63]|$7e[p>>>8&63]|W7e[p&63]|F7e[y>>>24&63]|V7e[y>>>16&63]|H7e[y>>>8&63]|G7e[y&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,t[0]=a,t[1]=c}function B4(r){r=r||{};var e=(r.mode||"CBC").toUpperCase(),t="DES-"+e,i;r.decrypt?i=qr.cipher.createDecipher(t,r.key):i=qr.cipher.createCipher(t,r.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof qr.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var dl=m((_at,Oj)=>{l();var M4=At();Oj.exports=M4.md=M4.md||{};M4.md.algorithms=M4.md.algorithms||{}});var Dj=m((vat,kj)=>{l();var Yc=At();dl();vr();var X7e=kj.exports=Yc.hmac=Yc.hmac||{};X7e.create=function(){var r=null,e=null,t=null,i=null,n={};return n.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Yc.md.algorithms)e=Yc.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=r;else{if(typeof o=="string")o=Yc.util.createBuffer(o);else if(Yc.util.isArray(o)){var a=o;o=Yc.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var u=o.length();u>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),t=Yc.util.createBuffer(),i=Yc.util.createBuffer(),u=o.length();for(var c=0;c<u;++c){var a=o.at(c);t.putByte(54^a),i.putByte(92^a)}if(u<e.blockLength)for(var a=e.blockLength-u,c=0;c<a;++c)t.putByte(54),i.putByte(92);r=o,t=t.bytes(),i=i.bytes()}e.start(),e.update(t)},n.update=function(s){e.update(s)},n.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(i),e.update(s),e.digest()},n.digest=n.getMac,n}});var $f=m(()=>{l()});var xE=m((Aat,Nj)=>{l();var Ln=At();Dj();dl();vr();var Q7e=Ln.pkcs5=Ln.pkcs5||{},Xc;Ln.util.isNodejs&&!Ln.options.usePureJavaScript&&(Xc=$f());Nj.exports=Ln.pbkdf2=Q7e.pbkdf2=function(r,e,t,i,n,s){if(typeof n=="function"&&(s=n,n=null),Ln.util.isNodejs&&!Ln.options.usePureJavaScript&&Xc.pbkdf2&&(n===null||typeof n!="object")&&(Xc.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),r=Buffer.from(r,"binary"),e=Buffer.from(e,"binary"),s?Xc.pbkdf2Sync.length===4?Xc.pbkdf2(r,e,t,i,function(R,k){if(R)return s(R);s(null,k.toString("binary"))}):Xc.pbkdf2(r,e,t,i,n,function(R,k){if(R)return s(R);s(null,k.toString("binary"))}):Xc.pbkdf2Sync.length===4?Xc.pbkdf2Sync(r,e,t,i).toString("binary"):Xc.pbkdf2Sync(r,e,t,i,n).toString("binary");if((typeof n=="undefined"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in Ln.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=Ln.md[n].create()}var o=n.digestLength;if(i>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(i/o),u=i-(c-1)*o,f=Ln.hmac.create();f.start(n,r);var d="",h,p,y;if(!s){for(var g=1;g<=c;++g){f.start(null,null),f.update(e),f.update(Ln.util.int32ToBytes(g)),h=y=f.digest().getBytes();for(var w=2;w<=t;++w)f.start(null,null),f.update(y),p=f.digest().getBytes(),h=Ln.util.xorBytes(h,p,o),y=p;d+=g<c?h:h.substr(0,u)}return d}var g=1,w;function b(){if(g>c)return s(null,d);f.start(null,null),f.update(e),f.update(Ln.util.int32ToBytes(g)),h=y=f.digest().getBytes(),w=2,v()}function v(){if(w<=t)return f.start(null,null),f.update(y),p=f.digest().getBytes(),h=Ln.util.xorBytes(h,p,o),y=p,++w,Ln.util.setImmediate(v);d+=g<c?h:h.substr(0,u),++g,b()}b()}});var U4=m((Rat,Lj)=>{l();var j4=At();vr();var Bj=Lj.exports=j4.pem=j4.pem||{};Bj.encode=function(r,e){e=e||{};var t="-----BEGIN "+r.type+`-----\r
`,i;if(r.procType&&(i={name:"Proc-Type",values:[String(r.procType.version),r.procType.type]},t+=q4(i)),r.contentDomain&&(i={name:"Content-Domain",values:[r.contentDomain]},t+=q4(i)),r.dekInfo&&(i={name:"DEK-Info",values:[r.dekInfo.algorithm]},r.dekInfo.parameters&&i.values.push(r.dekInfo.parameters),t+=q4(i)),r.headers)for(var n=0;n<r.headers.length;++n)t+=q4(r.headers[n]);return r.procType&&(t+=`\r
`),t+=j4.util.encode64(r.body,e.maxline||64)+`\r
`,t+="-----END "+r.type+`-----\r
`,t};Bj.decode=function(r){for(var e=[],t=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,n=/\r?\n/,s;s=t.exec(r),!!s;){var o=s[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:j4.util.decode64(s[3])};if(e.push(a),!!s[2]){for(var c=s[2].split(n),u=0;s&&u<c.length;){for(var f=c[u].replace(/\s+$/,""),d=u+1;d<c.length;++d){var h=c[d];if(!/\s/.test(h[0]))break;f+=h,u=d}if(s=f.match(i),s){for(var p={name:s[1],values:[]},y=s[2].split(","),g=0;g<y.length;++g)p.values.push(Z7e(y[g]));if(a.procType)if(!a.contentDomain&&p.name==="Content-Domain")a.contentDomain=y[0]||"";else if(!a.dekInfo&&p.name==="DEK-Info"){if(p.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:y[0],parameters:y[1]||null}}else a.headers.push(p);else{if(p.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(p.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:y[0],type:y[1]}}}++u}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function q4(r){for(var e=r.name+": ",t=[],i=function(c,u){return" "+u},n=0;n<r.values.length;++n)t.push(r.values[n].replace(/^(\S+\r\n)/,i));e+=t.join(",")+`\r
`;for(var s=0,o=-1,n=0;n<e.length;++n,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=n-o-1,o=-1,++n}else(e[n]===" "||e[n]==="	"||e[n]===",")&&(o=n);return e}function Z7e(r){return r.replace(/^\s+/,"")}});var Kj=m((xat,Fj)=>{l();var qa=At();dl();vr();var Mj=Fj.exports=qa.sha256=qa.sha256||{};qa.md.sha256=qa.md.algorithms.sha256=Mj;Mj.create=function(){jj||J7e();var r=null,e=qa.util.createBuffer(),t=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=qa.util.createBuffer(),r={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=qa.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),Uj(r,t,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=qa.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(IE.substr(0,i.blockLength-o));for(var a,c,u=i.fullMessageLength[0]*8,f=0;f<i.fullMessageLength.length-1;++f)a=i.fullMessageLength[f+1]*8,c=a/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=a>>>0;n.putInt32(u);var d={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3,h4:r.h4,h5:r.h5,h6:r.h6,h7:r.h7};Uj(d,t,n);var h=qa.util.createBuffer();return h.putInt32(d.h0),h.putInt32(d.h1),h.putInt32(d.h2),h.putInt32(d.h3),h.putInt32(d.h4),h.putInt32(d.h5),h.putInt32(d.h6),h.putInt32(d.h7),h},i};var IE=null,jj=!1,qj=null;function J7e(){IE=String.fromCharCode(128),IE+=qa.util.fillString(String.fromCharCode(0),64),qj=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],jj=!0}function Uj(r,e,t){for(var i,n,s,o,a,c,u,f,d,h,p,y,g,w,b,v=t.length();v>=64;){for(u=0;u<16;++u)e[u]=t.getInt32();for(;u<64;++u)i=e[u-2],i=(i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,n=e[u-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,e[u]=i+e[u-7]+n+e[u-16]|0;for(f=r.h0,d=r.h1,h=r.h2,p=r.h3,y=r.h4,g=r.h5,w=r.h6,b=r.h7,u=0;u<64;++u)o=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),a=w^y&(g^w),s=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),c=f&d|h&(f^d),i=b+o+a+qj[u]+e[u],n=s+c,b=w,w=g,g=y,y=p+i>>>0,p=h,h=d,d=f,f=i+n>>>0;r.h0=r.h0+f|0,r.h1=r.h1+d|0,r.h2=r.h2+h|0,r.h3=r.h3+p|0,r.h4=r.h4+y|0,r.h5=r.h5+g|0,r.h6=r.h6+w|0,r.h7=r.h7+b|0,v-=64}}});var zj=m((Iat,Vj)=>{l();var Ua=At();vr();var F4=null;Ua.util.isNodejs&&!Ua.options.usePureJavaScript&&!process.versions["node-webkit"]&&(F4=$f());var eEe=Vj.exports=Ua.prng=Ua.prng||{};eEe.create=function(r){for(var e={plugin:r,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},t=r.md,i=new Array(32),n=0;n<32;++n)i[n]=t.create();e.pools=i,e.pool=0,e.generate=function(u,f){if(!f)return e.generateSync(u);var d=e.plugin.cipher,h=e.plugin.increment,p=e.plugin.formatKey,y=e.plugin.formatSeed,g=Ua.util.createBuffer();e.key=null,w();function w(b){if(b)return f(b);if(g.length()>=u)return f(null,g.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return Ua.util.nextTick(function(){s(w)});var v=d(e.key,e.seed);e.generated+=v.length,g.putBytes(v),e.key=p(d(e.key,h(e.seed))),e.seed=y(d(e.key,e.seed)),Ua.util.setImmediate(w)}},e.generateSync=function(u){var f=e.plugin.cipher,d=e.plugin.increment,h=e.plugin.formatKey,p=e.plugin.formatSeed;e.key=null;for(var y=Ua.util.createBuffer();y.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&o();var g=f(e.key,e.seed);e.generated+=g.length,y.putBytes(g),e.key=h(f(e.key,d(e.seed))),e.seed=p(f(e.key,e.seed))}return y.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return a(),u();var f=32-e.pools[0].messageLength<<5;e.seedFile(f,function(d,h){if(d)return u(d);e.collect(h),a(),u()})}function o(){if(e.pools[0].messageLength>=32)return a();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var f=1,d=0;d<32;++d)e.reseeds%f==0&&(u.update(e.pools[d].digest().getBytes()),e.pools[d].start()),f=f<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var h=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(h),e.generated=0}function c(u){var f=null,d=Ua.util.globalScope,h=d.crypto||d.msCrypto;h&&h.getRandomValues&&(f=function(C){return h.getRandomValues(C)});var p=Ua.util.createBuffer();if(f)for(;p.length()<u;){var y=Math.max(1,Math.min(u-p.length(),65536)/4),g=new Uint32Array(Math.floor(y));try{f(g);for(var w=0;w<g.length;++w)p.putInt32(g[w])}catch(C){if(!(typeof QuotaExceededError!="undefined"&&C instanceof QuotaExceededError))throw C}}if(p.length()<u)for(var b,v,R,k=Math.floor(Math.random()*65536);p.length()<u;){v=16807*(k&65535),b=16807*(k>>16),v+=(b&32767)<<16,v+=b>>15,v=(v&2147483647)+(v>>31),k=v&4294967295;for(var w=0;w<3;++w)R=k>>>(w<<3),R^=Math.floor(Math.random()*256),p.putByte(R&255)}return p.getBytes(u)}return F4?(e.seedFile=function(u,f){F4.randomBytes(u,function(d,h){if(d)return f(d);f(null,h.toString())})},e.seedFileSync=function(u){return F4.randomBytes(u).toString()}):(e.seedFile=function(u,f){try{f(null,c(u))}catch(d){f(d)}},e.seedFileSync=c),e.collect=function(u){for(var f=u.length,d=0;d<f;++d)e.pools[e.pool].update(u.substr(d,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,f){for(var d="",h=0;h<f;h+=8)d+=String.fromCharCode(u>>h&255);e.collect(d)},e.registerWorker=function(u){if(u===self)e.seedFile=function(d,h){function p(y){var g=y.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",p),h(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",p),self.postMessage({forge:{prng:{needed:d}}})};else{var f=function(d){var h=d.data;h.forge&&h.forge.prng&&e.seedFile(h.forge.prng.needed,function(p,y){u.postMessage({forge:{prng:{err:p,bytes:y}}})})};u.addEventListener("message",f)}},e}});var Gf=m((Tat,TE)=>{l();var Xi=At();kp();Kj();zj();vr();(function(){if(Xi.random&&Xi.random.getBytes){TE.exports=Xi.random;return}(function(r){var e={},t=new Array(4),i=Xi.util.createBuffer();e.formatKey=function(d){var h=Xi.util.createBuffer(d);return d=new Array(4),d[0]=h.getInt32(),d[1]=h.getInt32(),d[2]=h.getInt32(),d[3]=h.getInt32(),Xi.aes._expandKey(d,!1)},e.formatSeed=function(d){var h=Xi.util.createBuffer(d);return d=new Array(4),d[0]=h.getInt32(),d[1]=h.getInt32(),d[2]=h.getInt32(),d[3]=h.getInt32(),d},e.cipher=function(d,h){return Xi.aes._updateBlock(d,h,t,!1),i.putInt32(t[0]),i.putInt32(t[1]),i.putInt32(t[2]),i.putInt32(t[3]),i.getBytes()},e.increment=function(d){return++d[3],d},e.md=Xi.md.sha256;function n(){var d=Xi.prng.create(e);return d.getBytes=function(h,p){return d.generate(h,p)},d.getBytesSync=function(h){return d.generate(h)},d}var s=n(),o=null,a=Xi.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(d){return c.getRandomValues(d)}),Xi.options.usePureJavaScript||!Xi.util.isNodejs&&!o){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var u="";for(var f in navigator)try{typeof navigator[f]=="string"&&(u+=navigator[f])}catch(d){}s.collect(u),u=null}r&&(r().mousemove(function(d){s.collectInt(d.clientX,16),s.collectInt(d.clientY,16)}),r().keypress(function(d){s.collectInt(d.charCode,8)}))}if(!Xi.random)Xi.random=s;else for(var f in s)Xi.random[f]=s[f];Xi.random.createInstance=n,TE.exports=Xi.random})(typeof jQuery!="undefined"?jQuery:null)})()});var Wj=m((Pat,Gj)=>{l();var Qn=At();vr();var PE=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Hj=[1,2,3,5],tEe=function(r,e){return r<<e&65535|(r&65535)>>16-e},rEe=function(r,e){return(r&65535)>>e|r<<16-e&65535};Gj.exports=Qn.rc2=Qn.rc2||{};Qn.rc2.expandKey=function(r,e){typeof r=="string"&&(r=Qn.util.createBuffer(r)),e=e||128;var t=r,i=r.length(),n=e,s=Math.ceil(n/8),o=255>>(n&7),a;for(a=i;a<128;a++)t.putByte(PE[t.at(a-1)+t.at(a-i)&255]);for(t.setAt(128-s,PE[t.at(128-s)&o]),a=127-s;a>=0;a--)t.setAt(a,PE[t.at(a+1)^t.at(a+s)]);return t};var $j=function(r,e,t){var i=!1,n=null,s=null,o=null,a,c,u,f,d=[];for(r=Qn.rc2.expandKey(r,e),u=0;u<64;u++)d.push(r.getInt16Le());t?(a=function(y){for(u=0;u<4;u++)y[u]+=d[f]+(y[(u+3)%4]&y[(u+2)%4])+(~y[(u+3)%4]&y[(u+1)%4]),y[u]=tEe(y[u],Hj[u]),f++},c=function(y){for(u=0;u<4;u++)y[u]+=d[y[(u+3)%4]&63]}):(a=function(y){for(u=3;u>=0;u--)y[u]=rEe(y[u],Hj[u]),y[u]-=d[f]+(y[(u+3)%4]&y[(u+2)%4])+(~y[(u+3)%4]&y[(u+1)%4]),f--},c=function(y){for(u=3;u>=0;u--)y[u]-=d[y[(u+3)%4]&63]});var h=function(y){var g=[];for(u=0;u<4;u++){var w=n.getInt16Le();o!==null&&(t?w^=o.getInt16Le():o.putInt16Le(w)),g.push(w&65535)}f=t?0:63;for(var b=0;b<y.length;b++)for(var v=0;v<y[b][0];v++)y[b][1](g);for(u=0;u<4;u++)o!==null&&(t?o.putInt16Le(g[u]):g[u]^=o.getInt16Le()),s.putInt16Le(g[u])},p=null;return p={start:function(y,g){y&&typeof y=="string"&&(y=Qn.util.createBuffer(y)),i=!1,n=Qn.util.createBuffer(),s=g||new Qn.util.createBuffer,o=y,p.output=s},update:function(y){for(i||n.putBuffer(y);n.length()>=8;)h([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(y){var g=!0;if(t)if(y)g=y(8,n,!t);else{var w=n.length()===8?8:8-n.length();n.fillWithByte(w,w)}if(g&&(i=!0,p.update()),!t&&(g=n.length()===0,g))if(y)g=y(8,s,!t);else{var b=s.length(),v=s.at(b-1);v>b?g=!1:s.truncate(v)}return g}},p};Qn.rc2.startEncrypting=function(r,e,t){var i=Qn.rc2.createEncryptionCipher(r,128);return i.start(e,t),i};Qn.rc2.createEncryptionCipher=function(r,e){return $j(r,e,!0)};Qn.rc2.startDecrypting=function(r,e,t){var i=Qn.rc2.createDecryptionCipher(r,128);return i.start(e,t),i};Qn.rc2.createDecryptionCipher=function(r,e){return $j(r,e,!1)}});var z4=m((Cat,rq)=>{l();var CE=At();rq.exports=CE.jsbn=CE.jsbn||{};var Qc,iEe=244837814094590,Yj=(iEe&16777215)==15715070;function ye(r,e,t){this.data=[],r!=null&&(typeof r=="number"?this.fromNumber(r,e,t):e==null&&typeof r!="string"?this.fromString(r,256):this.fromString(r,e))}CE.jsbn.BigInteger=ye;function Ht(){return new ye(null)}function nEe(r,e,t,i,n,s){for(;--s>=0;){var o=e*this.data[r++]+t.data[i]+n;n=Math.floor(o/67108864),t.data[i++]=o&67108863}return n}function sEe(r,e,t,i,n,s){for(var o=e&32767,a=e>>15;--s>=0;){var c=this.data[r]&32767,u=this.data[r++]>>15,f=a*c+u*o;c=o*c+((f&32767)<<15)+t.data[i]+(n&1073741823),n=(c>>>30)+(f>>>15)+a*u+(n>>>30),t.data[i++]=c&1073741823}return n}function Xj(r,e,t,i,n,s){for(var o=e&16383,a=e>>14;--s>=0;){var c=this.data[r]&16383,u=this.data[r++]>>14,f=a*c+u*o;c=o*c+((f&16383)<<14)+t.data[i]+n,n=(c>>28)+(f>>14)+a*u,t.data[i++]=c&268435455}return n}typeof navigator=="undefined"?(ye.prototype.am=Xj,Qc=28):Yj&&navigator.appName=="Microsoft Internet Explorer"?(ye.prototype.am=sEe,Qc=30):Yj&&navigator.appName!="Netscape"?(ye.prototype.am=nEe,Qc=26):(ye.prototype.am=Xj,Qc=28);ye.prototype.DB=Qc;ye.prototype.DM=(1<<Qc)-1;ye.prototype.DV=1<<Qc;var OE=52;ye.prototype.FV=Math.pow(2,OE);ye.prototype.F1=OE-Qc;ye.prototype.F2=2*Qc-OE;var oEe="0123456789abcdefghijklmnopqrstuvwxyz",K4=new Array,Dp,Gs;Dp="0".charCodeAt(0);for(Gs=0;Gs<=9;++Gs)K4[Dp++]=Gs;Dp="a".charCodeAt(0);for(Gs=10;Gs<36;++Gs)K4[Dp++]=Gs;Dp="A".charCodeAt(0);for(Gs=10;Gs<36;++Gs)K4[Dp++]=Gs;function Qj(r){return oEe.charAt(r)}function Zj(r,e){var t=K4[r.charCodeAt(e)];return t??-1}function aEe(r){for(var e=this.t-1;e>=0;--e)r.data[e]=this.data[e];r.t=this.t,r.s=this.s}function cEe(r){this.t=1,this.s=r<0?-1:0,r>0?this.data[0]=r:r<-1?this.data[0]=r+this.DV:this.t=0}function hl(r){var e=Ht();return e.fromInt(r),e}function uEe(r,e){var t;if(e==16)t=4;else if(e==8)t=3;else if(e==256)t=8;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else{this.fromRadix(r,e);return}this.t=0,this.s=0;for(var i=r.length,n=!1,s=0;--i>=0;){var o=t==8?r[i]&255:Zj(r,i);if(o<0){r.charAt(i)=="-"&&(n=!0);continue}n=!1,s==0?this.data[this.t++]=o:s+t>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=t,s>=this.DB&&(s-=this.DB)}t==8&&(r[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&ye.ZERO.subTo(this,this)}function lEe(){for(var r=this.s&this.DM;this.t>0&&this.data[this.t-1]==r;)--this.t}function fEe(r){if(this.s<0)return"-"+this.negate().toString(r);var e;if(r==16)e=4;else if(r==8)e=3;else if(r==2)e=1;else if(r==32)e=5;else if(r==4)e=2;else return this.toRadix(r);var t=(1<<e)-1,i,n=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(i=this.data[o]>>a)>0&&(n=!0,s=Qj(i));o>=0;)a<e?(i=(this.data[o]&(1<<a)-1)<<e-a,i|=this.data[--o]>>(a+=this.DB-e)):(i=this.data[o]>>(a-=e)&t,a<=0&&(a+=this.DB,--o)),i>0&&(n=!0),n&&(s+=Qj(i));return n?s:"0"}function dEe(){var r=Ht();return ye.ZERO.subTo(this,r),r}function hEe(){return this.s<0?this.negate():this}function pEe(r){var e=this.s-r.s;if(e!=0)return e;var t=this.t;if(e=t-r.t,e!=0)return this.s<0?-e:e;for(;--t>=0;)if((e=this.data[t]-r.data[t])!=0)return e;return 0}function V4(r){var e=1,t;return(t=r>>>16)!=0&&(r=t,e+=16),(t=r>>8)!=0&&(r=t,e+=8),(t=r>>4)!=0&&(r=t,e+=4),(t=r>>2)!=0&&(r=t,e+=2),(t=r>>1)!=0&&(r=t,e+=1),e}function yEe(){return this.t<=0?0:this.DB*(this.t-1)+V4(this.data[this.t-1]^this.s&this.DM)}function gEe(r,e){var t;for(t=this.t-1;t>=0;--t)e.data[t+r]=this.data[t];for(t=r-1;t>=0;--t)e.data[t]=0;e.t=this.t+r,e.s=this.s}function mEe(r,e){for(var t=r;t<this.t;++t)e.data[t-r]=this.data[t];e.t=Math.max(this.t-r,0),e.s=this.s}function bEe(r,e){var t=r%this.DB,i=this.DB-t,n=(1<<i)-1,s=Math.floor(r/this.DB),o=this.s<<t&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>i|o,o=(this.data[a]&n)<<t;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function wEe(r,e){e.s=this.s;var t=Math.floor(r/this.DB);if(t>=this.t){e.t=0;return}var i=r%this.DB,n=this.DB-i,s=(1<<i)-1;e.data[0]=this.data[t]>>i;for(var o=t+1;o<this.t;++o)e.data[o-t-1]|=(this.data[o]&s)<<n,e.data[o-t]=this.data[o]>>i;i>0&&(e.data[this.t-t-1]|=(this.s&s)<<n),e.t=this.t-t,e.clamp()}function _Ee(r,e){for(var t=0,i=0,n=Math.min(r.t,this.t);t<n;)i+=this.data[t]-r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;if(r.t<this.t){for(i-=r.s;t<this.t;)i+=this.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<r.t;)i-=r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i-=r.s}e.s=i<0?-1:0,i<-1?e.data[t++]=this.DV+i:i>0&&(e.data[t++]=i),e.t=t,e.clamp()}function vEe(r,e){var t=this.abs(),i=r.abs(),n=t.t;for(e.t=n+i.t;--n>=0;)e.data[n]=0;for(n=0;n<i.t;++n)e.data[n+t.t]=t.am(0,i.data[n],e,n,0,t.t);e.s=0,e.clamp(),this.s!=r.s&&ye.ZERO.subTo(e,e)}function EEe(r){for(var e=this.abs(),t=r.t=2*e.t;--t>=0;)r.data[t]=0;for(t=0;t<e.t-1;++t){var i=e.am(t,e.data[t],r,2*t,0,1);(r.data[t+e.t]+=e.am(t+1,2*e.data[t],r,2*t+1,i,e.t-t-1))>=e.DV&&(r.data[t+e.t]-=e.DV,r.data[t+e.t+1]=1)}r.t>0&&(r.data[r.t-1]+=e.am(t,e.data[t],r,2*t,0,1)),r.s=0,r.clamp()}function SEe(r,e,t){var i=r.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t){e!=null&&e.fromInt(0),t!=null&&this.copyTo(t);return}t==null&&(t=Ht());var s=Ht(),o=this.s,a=r.s,c=this.DB-V4(i.data[i.t-1]);c>0?(i.lShiftTo(c,s),n.lShiftTo(c,t)):(i.copyTo(s),n.copyTo(t));var u=s.t,f=s.data[u-1];if(f!=0){var d=f*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),h=this.FV/d,p=(1<<this.F1)/d,y=1<<this.F2,g=t.t,w=g-u,b=e??Ht();for(s.dlShiftTo(w,b),t.compareTo(b)>=0&&(t.data[t.t++]=1,t.subTo(b,t)),ye.ONE.dlShiftTo(u,b),b.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--w>=0;){var v=t.data[--g]==f?this.DM:Math.floor(t.data[g]*h+(t.data[g-1]+y)*p);if((t.data[g]+=s.am(0,v,t,w,0,u))<v)for(s.dlShiftTo(w,b),t.subTo(b,t);t.data[g]<--v;)t.subTo(b,t)}e!=null&&(t.drShiftTo(u,e),o!=a&&ye.ZERO.subTo(e,e)),t.t=u,t.clamp(),c>0&&t.rShiftTo(c,t),o<0&&ye.ZERO.subTo(t,t)}}}function AEe(r){var e=Ht();return this.abs().divRemTo(r,null,e),this.s<0&&e.compareTo(ye.ZERO)>0&&r.subTo(e,e),e}function Wf(r){this.m=r}function REe(r){return r.s<0||r.compareTo(this.m)>=0?r.mod(this.m):r}function xEe(r){return r}function IEe(r){r.divRemTo(this.m,null,r)}function TEe(r,e,t){r.multiplyTo(e,t),this.reduce(t)}function PEe(r,e){r.squareTo(e),this.reduce(e)}Wf.prototype.convert=REe;Wf.prototype.revert=xEe;Wf.prototype.reduce=IEe;Wf.prototype.mulTo=TEe;Wf.prototype.sqrTo=PEe;function CEe(){if(this.t<1)return 0;var r=this.data[0];if((r&1)==0)return 0;var e=r&3;return e=e*(2-(r&15)*e)&15,e=e*(2-(r&255)*e)&255,e=e*(2-((r&65535)*e&65535))&65535,e=e*(2-r*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Yf(r){this.m=r,this.mp=r.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<r.DB-15)-1,this.mt2=2*r.t}function OEe(r){var e=Ht();return r.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),r.s<0&&e.compareTo(ye.ZERO)>0&&this.m.subTo(e,e),e}function kEe(r){var e=Ht();return r.copyTo(e),this.reduce(e),e}function DEe(r){for(;r.t<=this.mt2;)r.data[r.t++]=0;for(var e=0;e<this.m.t;++e){var t=r.data[e]&32767,i=t*this.mpl+((t*this.mph+(r.data[e]>>15)*this.mpl&this.um)<<15)&r.DM;for(t=e+this.m.t,r.data[t]+=this.m.am(0,i,r,e,0,this.m.t);r.data[t]>=r.DV;)r.data[t]-=r.DV,r.data[++t]++}r.clamp(),r.drShiftTo(this.m.t,r),r.compareTo(this.m)>=0&&r.subTo(this.m,r)}function NEe(r,e){r.squareTo(e),this.reduce(e)}function BEe(r,e,t){r.multiplyTo(e,t),this.reduce(t)}Yf.prototype.convert=OEe;Yf.prototype.revert=kEe;Yf.prototype.reduce=DEe;Yf.prototype.mulTo=BEe;Yf.prototype.sqrTo=NEe;function LEe(){return(this.t>0?this.data[0]&1:this.s)==0}function MEe(r,e){if(r>4294967295||r<1)return ye.ONE;var t=Ht(),i=Ht(),n=e.convert(this),s=V4(r)-1;for(n.copyTo(t);--s>=0;)if(e.sqrTo(t,i),(r&1<<s)>0)e.mulTo(i,n,t);else{var o=t;t=i,i=o}return e.revert(t)}function jEe(r,e){var t;return r<256||e.isEven()?t=new Wf(e):t=new Yf(e),this.exp(r,t)}ye.prototype.copyTo=aEe;ye.prototype.fromInt=cEe;ye.prototype.fromString=uEe;ye.prototype.clamp=lEe;ye.prototype.dlShiftTo=gEe;ye.prototype.drShiftTo=mEe;ye.prototype.lShiftTo=bEe;ye.prototype.rShiftTo=wEe;ye.prototype.subTo=_Ee;ye.prototype.multiplyTo=vEe;ye.prototype.squareTo=EEe;ye.prototype.divRemTo=SEe;ye.prototype.invDigit=CEe;ye.prototype.isEven=LEe;ye.prototype.exp=MEe;ye.prototype.toString=fEe;ye.prototype.negate=dEe;ye.prototype.abs=hEe;ye.prototype.compareTo=pEe;ye.prototype.bitLength=yEe;ye.prototype.mod=AEe;ye.prototype.modPowInt=jEe;ye.ZERO=hl(0);ye.ONE=hl(1);function qEe(){var r=Ht();return this.copyTo(r),r}function UEe(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function FEe(){return this.t==0?this.s:this.data[0]<<24>>24}function KEe(){return this.t==0?this.s:this.data[0]<<16>>16}function VEe(r){return Math.floor(Math.LN2*this.DB/Math.log(r))}function zEe(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function HEe(r){if(r==null&&(r=10),this.signum()==0||r<2||r>36)return"0";var e=this.chunkSize(r),t=Math.pow(r,e),i=hl(t),n=Ht(),s=Ht(),o="";for(this.divRemTo(i,n,s);n.signum()>0;)o=(t+s.intValue()).toString(r).substr(1)+o,n.divRemTo(i,n,s);return s.intValue().toString(r)+o}function $Ee(r,e){this.fromInt(0),e==null&&(e=10);for(var t=this.chunkSize(e),i=Math.pow(e,t),n=!1,s=0,o=0,a=0;a<r.length;++a){var c=Zj(r,a);if(c<0){r.charAt(a)=="-"&&this.signum()==0&&(n=!0);continue}o=e*o+c,++s>=t&&(this.dMultiply(i),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),n&&ye.ZERO.subTo(this,this)}function GEe(r,e,t){if(typeof e=="number")if(r<2)this.fromInt(1);else for(this.fromNumber(r,t),this.testBit(r-1)||this.bitwiseTo(ye.ONE.shiftLeft(r-1),kE,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>r&&this.subTo(ye.ONE.shiftLeft(r-1),this);else{var i=new Array,n=r&7;i.length=(r>>3)+1,e.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}}function WEe(){var r=this.t,e=new Array;e[0]=this.s;var t=this.DB-r*this.DB%8,i,n=0;if(r-- >0)for(t<this.DB&&(i=this.data[r]>>t)!=(this.s&this.DM)>>t&&(e[n++]=i|this.s<<this.DB-t);r>=0;)t<8?(i=(this.data[r]&(1<<t)-1)<<8-t,i|=this.data[--r]>>(t+=this.DB-8)):(i=this.data[r]>>(t-=8)&255,t<=0&&(t+=this.DB,--r)),(i&128)!=0&&(i|=-256),n==0&&(this.s&128)!=(i&128)&&++n,(n>0||i!=this.s)&&(e[n++]=i);return e}function YEe(r){return this.compareTo(r)==0}function XEe(r){return this.compareTo(r)<0?this:r}function QEe(r){return this.compareTo(r)>0?this:r}function ZEe(r,e,t){var i,n,s=Math.min(r.t,this.t);for(i=0;i<s;++i)t.data[i]=e(this.data[i],r.data[i]);if(r.t<this.t){for(n=r.s&this.DM,i=s;i<this.t;++i)t.data[i]=e(this.data[i],n);t.t=this.t}else{for(n=this.s&this.DM,i=s;i<r.t;++i)t.data[i]=e(n,r.data[i]);t.t=r.t}t.s=e(this.s,r.s),t.clamp()}function JEe(r,e){return r&e}function e9e(r){var e=Ht();return this.bitwiseTo(r,JEe,e),e}function kE(r,e){return r|e}function t9e(r){var e=Ht();return this.bitwiseTo(r,kE,e),e}function Jj(r,e){return r^e}function r9e(r){var e=Ht();return this.bitwiseTo(r,Jj,e),e}function eq(r,e){return r&~e}function i9e(r){var e=Ht();return this.bitwiseTo(r,eq,e),e}function n9e(){for(var r=Ht(),e=0;e<this.t;++e)r.data[e]=this.DM&~this.data[e];return r.t=this.t,r.s=~this.s,r}function s9e(r){var e=Ht();return r<0?this.rShiftTo(-r,e):this.lShiftTo(r,e),e}function o9e(r){var e=Ht();return r<0?this.lShiftTo(-r,e):this.rShiftTo(r,e),e}function a9e(r){if(r==0)return-1;var e=0;return(r&65535)==0&&(r>>=16,e+=16),(r&255)==0&&(r>>=8,e+=8),(r&15)==0&&(r>>=4,e+=4),(r&3)==0&&(r>>=2,e+=2),(r&1)==0&&++e,e}function c9e(){for(var r=0;r<this.t;++r)if(this.data[r]!=0)return r*this.DB+a9e(this.data[r]);return this.s<0?this.t*this.DB:-1}function u9e(r){for(var e=0;r!=0;)r&=r-1,++e;return e}function l9e(){for(var r=0,e=this.s&this.DM,t=0;t<this.t;++t)r+=u9e(this.data[t]^e);return r}function f9e(r){var e=Math.floor(r/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<r%this.DB)!=0}function d9e(r,e){var t=ye.ONE.shiftLeft(r);return this.bitwiseTo(t,e,t),t}function h9e(r){return this.changeBit(r,kE)}function p9e(r){return this.changeBit(r,eq)}function y9e(r){return this.changeBit(r,Jj)}function g9e(r,e){for(var t=0,i=0,n=Math.min(r.t,this.t);t<n;)i+=this.data[t]+r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;if(r.t<this.t){for(i+=r.s;t<this.t;)i+=this.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<r.t;)i+=r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=r.s}e.s=i<0?-1:0,i>0?e.data[t++]=i:i<-1&&(e.data[t++]=this.DV+i),e.t=t,e.clamp()}function m9e(r){var e=Ht();return this.addTo(r,e),e}function b9e(r){var e=Ht();return this.subTo(r,e),e}function w9e(r){var e=Ht();return this.multiplyTo(r,e),e}function _9e(r){var e=Ht();return this.divRemTo(r,e,null),e}function v9e(r){var e=Ht();return this.divRemTo(r,null,e),e}function E9e(r){var e=Ht(),t=Ht();return this.divRemTo(r,e,t),new Array(e,t)}function S9e(r){this.data[this.t]=this.am(0,r-1,this,0,0,this.t),++this.t,this.clamp()}function A9e(r,e){if(r!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=r;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function t2(){}function tq(r){return r}function R9e(r,e,t){r.multiplyTo(e,t)}function x9e(r,e){r.squareTo(e)}t2.prototype.convert=tq;t2.prototype.revert=tq;t2.prototype.mulTo=R9e;t2.prototype.sqrTo=x9e;function I9e(r){return this.exp(r,new t2)}function T9e(r,e,t){var i=Math.min(this.t+r.t,e);for(t.s=0,t.t=i;i>0;)t.data[--i]=0;var n;for(n=t.t-this.t;i<n;++i)t.data[i+this.t]=this.am(0,r.data[i],t,i,0,this.t);for(n=Math.min(r.t,e);i<n;++i)this.am(0,r.data[i],t,i,0,e-i);t.clamp()}function P9e(r,e,t){--e;var i=t.t=this.t+r.t-e;for(t.s=0;--i>=0;)t.data[i]=0;for(i=Math.max(e-this.t,0);i<r.t;++i)t.data[this.t+i-e]=this.am(e-i,r.data[i],t,0,0,this.t+i-e);t.clamp(),t.drShiftTo(1,t)}function Np(r){this.r2=Ht(),this.q3=Ht(),ye.ONE.dlShiftTo(2*r.t,this.r2),this.mu=this.r2.divide(r),this.m=r}function C9e(r){if(r.s<0||r.t>2*this.m.t)return r.mod(this.m);if(r.compareTo(this.m)<0)return r;var e=Ht();return r.copyTo(e),this.reduce(e),e}function O9e(r){return r}function k9e(r){for(r.drShiftTo(this.m.t-1,this.r2),r.t>this.m.t+1&&(r.t=this.m.t+1,r.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);r.compareTo(this.r2)<0;)r.dAddOffset(1,this.m.t+1);for(r.subTo(this.r2,r);r.compareTo(this.m)>=0;)r.subTo(this.m,r)}function D9e(r,e){r.squareTo(e),this.reduce(e)}function N9e(r,e,t){r.multiplyTo(e,t),this.reduce(t)}Np.prototype.convert=C9e;Np.prototype.revert=O9e;Np.prototype.reduce=k9e;Np.prototype.mulTo=N9e;Np.prototype.sqrTo=D9e;function B9e(r,e){var t=r.bitLength(),i,n=hl(1),s;if(t<=0)return n;t<18?i=1:t<48?i=3:t<144?i=4:t<768?i=5:i=6,t<8?s=new Wf(e):e.isEven()?s=new Np(e):s=new Yf(e);var o=new Array,a=3,c=i-1,u=(1<<i)-1;if(o[1]=s.convert(this),i>1){var f=Ht();for(s.sqrTo(o[1],f);a<=u;)o[a]=Ht(),s.mulTo(f,o[a-2],o[a]),a+=2}var d=r.t-1,h,p=!0,y=Ht(),g;for(t=V4(r.data[d])-1;d>=0;){for(t>=c?h=r.data[d]>>t-c&u:(h=(r.data[d]&(1<<t+1)-1)<<c-t,d>0&&(h|=r.data[d-1]>>this.DB+t-c)),a=i;(h&1)==0;)h>>=1,--a;if((t-=a)<0&&(t+=this.DB,--d),p)o[h].copyTo(n),p=!1;else{for(;a>1;)s.sqrTo(n,y),s.sqrTo(y,n),a-=2;a>0?s.sqrTo(n,y):(g=n,n=y,y=g),s.mulTo(y,o[h],n)}for(;d>=0&&(r.data[d]&1<<t)==0;)s.sqrTo(n,y),g=n,n=y,y=g,--t<0&&(t=this.DB-1,--d)}return s.revert(n)}function L9e(r){var e=this.s<0?this.negate():this.clone(),t=r.s<0?r.negate():r.clone();if(e.compareTo(t)<0){var i=e;e=t,t=i}var n=e.getLowestSetBit(),s=t.getLowestSetBit();if(s<0)return e;for(n<s&&(s=n),s>0&&(e.rShiftTo(s,e),t.rShiftTo(s,t));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=t.getLowestSetBit())>0&&t.rShiftTo(n,t),e.compareTo(t)>=0?(e.subTo(t,e),e.rShiftTo(1,e)):(t.subTo(e,t),t.rShiftTo(1,t));return s>0&&t.lShiftTo(s,t),t}function M9e(r){if(r<=0)return 0;var e=this.DV%r,t=this.s<0?r-1:0;if(this.t>0)if(e==0)t=this.data[0]%r;else for(var i=this.t-1;i>=0;--i)t=(e*t+this.data[i])%r;return t}function j9e(r){var e=r.isEven();if(this.isEven()&&e||r.signum()==0)return ye.ZERO;for(var t=r.clone(),i=this.clone(),n=hl(1),s=hl(0),o=hl(0),a=hl(1);t.signum()!=0;){for(;t.isEven();)t.rShiftTo(1,t),e?((!n.isEven()||!s.isEven())&&(n.addTo(this,n),s.subTo(r,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(r,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(r,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(r,a),a.rShiftTo(1,a);t.compareTo(i)>=0?(t.subTo(i,t),e&&n.subTo(o,n),s.subTo(a,s)):(i.subTo(t,i),e&&o.subTo(n,o),a.subTo(s,a))}if(i.compareTo(ye.ONE)!=0)return ye.ZERO;if(a.compareTo(r)>=0)return a.subtract(r);if(a.signum()<0)a.addTo(r,a);else return a;return a.signum()<0?a.add(r):a}var Yo=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],q9e=(1<<26)/Yo[Yo.length-1];function U9e(r){var e,t=this.abs();if(t.t==1&&t.data[0]<=Yo[Yo.length-1]){for(e=0;e<Yo.length;++e)if(t.data[0]==Yo[e])return!0;return!1}if(t.isEven())return!1;for(e=1;e<Yo.length;){for(var i=Yo[e],n=e+1;n<Yo.length&&i<q9e;)i*=Yo[n++];for(i=t.modInt(i);e<n;)if(i%Yo[e++]==0)return!1}return t.millerRabin(r)}function F9e(r){var e=this.subtract(ye.ONE),t=e.getLowestSetBit();if(t<=0)return!1;for(var i=e.shiftRight(t),n=K9e(),s,o=0;o<r;++o){do s=new ye(this.bitLength(),n);while(s.compareTo(ye.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(i,this);if(a.compareTo(ye.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<t&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(ye.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function K9e(){return{nextBytes:function(r){for(var e=0;e<r.length;++e)r[e]=Math.floor(Math.random()*256)}}}ye.prototype.chunkSize=VEe;ye.prototype.toRadix=HEe;ye.prototype.fromRadix=$Ee;ye.prototype.fromNumber=GEe;ye.prototype.bitwiseTo=ZEe;ye.prototype.changeBit=d9e;ye.prototype.addTo=g9e;ye.prototype.dMultiply=S9e;ye.prototype.dAddOffset=A9e;ye.prototype.multiplyLowerTo=T9e;ye.prototype.multiplyUpperTo=P9e;ye.prototype.modInt=M9e;ye.prototype.millerRabin=F9e;ye.prototype.clone=qEe;ye.prototype.intValue=UEe;ye.prototype.byteValue=FEe;ye.prototype.shortValue=KEe;ye.prototype.signum=zEe;ye.prototype.toByteArray=WEe;ye.prototype.equals=YEe;ye.prototype.min=XEe;ye.prototype.max=QEe;ye.prototype.and=e9e;ye.prototype.or=t9e;ye.prototype.xor=r9e;ye.prototype.andNot=i9e;ye.prototype.not=n9e;ye.prototype.shiftLeft=s9e;ye.prototype.shiftRight=o9e;ye.prototype.getLowestSetBit=c9e;ye.prototype.bitCount=l9e;ye.prototype.testBit=f9e;ye.prototype.setBit=h9e;ye.prototype.clearBit=p9e;ye.prototype.flipBit=y9e;ye.prototype.add=m9e;ye.prototype.subtract=b9e;ye.prototype.multiply=w9e;ye.prototype.divide=_9e;ye.prototype.remainder=v9e;ye.prototype.divideAndRemainder=E9e;ye.prototype.modPow=B9e;ye.prototype.modInverse=j9e;ye.prototype.pow=I9e;ye.prototype.gcd=L9e;ye.prototype.isProbablePrime=U9e});var aq=m((Oat,oq)=>{l();var Fa=At();dl();vr();var iq=oq.exports=Fa.sha1=Fa.sha1||{};Fa.md.sha1=Fa.md.algorithms.sha1=iq;iq.create=function(){nq||V9e();var r=null,e=Fa.util.createBuffer(),t=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=Fa.util.createBuffer(),r={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=Fa.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),sq(r,t,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=Fa.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(DE.substr(0,i.blockLength-o));for(var a,c,u=i.fullMessageLength[0]*8,f=0;f<i.fullMessageLength.length-1;++f)a=i.fullMessageLength[f+1]*8,c=a/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=a>>>0;n.putInt32(u);var d={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3,h4:r.h4};sq(d,t,n);var h=Fa.util.createBuffer();return h.putInt32(d.h0),h.putInt32(d.h1),h.putInt32(d.h2),h.putInt32(d.h3),h.putInt32(d.h4),h},i};var DE=null,nq=!1;function V9e(){DE=String.fromCharCode(128),DE+=Fa.util.fillString(String.fromCharCode(0),64),nq=!0}function sq(r,e,t){for(var i,n,s,o,a,c,u,f,d=t.length();d>=64;){for(n=r.h0,s=r.h1,o=r.h2,a=r.h3,c=r.h4,f=0;f<16;++f)i=t.getInt32(),e[f]=i,u=a^s&(o^a),i=(n<<5|n>>>27)+u+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;f<20;++f)i=e[f-3]^e[f-8]^e[f-14]^e[f-16],i=i<<1|i>>>31,e[f]=i,u=a^s&(o^a),i=(n<<5|n>>>27)+u+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;f<32;++f)i=e[f-3]^e[f-8]^e[f-14]^e[f-16],i=i<<1|i>>>31,e[f]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;f<40;++f)i=e[f-6]^e[f-16]^e[f-28]^e[f-32],i=i<<2|i>>>30,e[f]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;f<60;++f)i=e[f-6]^e[f-16]^e[f-28]^e[f-32],i=i<<2|i>>>30,e[f]=i,u=s&o|a&(s^o),i=(n<<5|n>>>27)+u+c+2400959708+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;f<80;++f)i=e[f-6]^e[f-16]^e[f-28]^e[f-32],i=i<<2|i>>>30,e[f]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+3395469782+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;r.h0=r.h0+n|0,r.h1=r.h1+s|0,r.h2=r.h2+o|0,r.h3=r.h3+a|0,r.h4=r.h4+c|0,d-=64}}});var lq=m((kat,uq)=>{l();var Ka=At();vr();Gf();aq();var cq=uq.exports=Ka.pkcs1=Ka.pkcs1||{};cq.encode_rsa_oaep=function(r,e,t){var i,n,s,o;typeof t=="string"?(i=t,n=arguments[3]||void 0,s=arguments[4]||void 0):t&&(i=t.label||void 0,n=t.seed||void 0,s=t.md||void 0,t.mgf1&&t.mgf1.md&&(o=t.mgf1.md)),s?s.start():s=Ka.md.sha1.create(),o||(o=s);var a=Math.ceil(r.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=c,u}i||(i=""),s.update(i,"raw");for(var f=s.digest(),d="",h=c-e.length,p=0;p<h;p++)d+="\0";var y=f.getBytes()+d+""+e;if(!n)n=Ka.random.getBytes(s.digestLength);else if(n.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=n.length,u.digestLength=s.digestLength,u}var g=H4(n,a-s.digestLength-1,o),w=Ka.util.xorBytes(y,g,y.length),b=H4(w,s.digestLength,o),v=Ka.util.xorBytes(n,b,n.length);return"\0"+v+w};cq.decode_rsa_oaep=function(r,e,t){var i,n,s;typeof t=="string"?(i=t,n=arguments[3]||void 0):t&&(i=t.label||void 0,n=t.md||void 0,t.mgf1&&t.mgf1.md&&(s=t.mgf1.md));var o=Math.ceil(r.n.bitLength()/8);if(e.length!==o){var w=new Error("RSAES-OAEP encoded message length is invalid.");throw w.length=e.length,w.expectedLength=o,w}if(n===void 0?n=Ka.md.sha1.create():n.start(),s||(s=n),o<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),n.update(i,"raw");for(var a=n.digest().getBytes(),c=e.charAt(0),u=e.substring(1,n.digestLength+1),f=e.substring(1+n.digestLength),d=H4(f,n.digestLength,s),h=Ka.util.xorBytes(u,d,u.length),p=H4(h,o-n.digestLength-1,s),y=Ka.util.xorBytes(f,p,f.length),g=y.substring(0,n.digestLength),w=c!=="\0",b=0;b<n.digestLength;++b)w|=a.charAt(b)!==g.charAt(b);for(var v=1,R=n.digestLength,k=n.digestLength;k<y.length;k++){var C=y.charCodeAt(k),T=C&1^1,D=v?65534:0;w|=C&D,v=v&T,R+=v}if(w||y.charCodeAt(R)!==1)throw new Error("Invalid RSAES-OAEP padding.");return y.substring(R+1)};function H4(r,e,t){t||(t=Ka.md.sha1.create());for(var i="",n=Math.ceil(e/t.digestLength),s=0;s<n;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);t.start(),t.update(r+o),i+=t.digest().getBytes()}return i.substring(0,e)}});var fq=m((Dat,NE)=>{l();var pl=At();vr();z4();Gf();(function(){if(pl.prime){NE.exports=pl.prime;return}var r=NE.exports=pl.prime=pl.prime||{},e=pl.jsbn.BigInteger,t=[6,4,2,4,2,4,6,2],i=new e(null);i.fromInt(30);var n=function(d,h){return d|h};r.generateProbablePrime=function(d,h,p){typeof h=="function"&&(p=h,h={}),h=h||{};var y=h.algorithm||"PRIMEINC";typeof y=="string"&&(y={name:y}),y.options=y.options||{};var g=h.prng||pl.random,w={nextBytes:function(b){for(var v=g.getBytesSync(b.length),R=0;R<b.length;++R)b[R]=v.charCodeAt(R)}};if(y.name==="PRIMEINC")return s(d,w,y.options,p);throw new Error("Invalid prime generation algorithm: "+y.name)};function s(d,h,p,y){return"workers"in p?c(d,h,p,y):o(d,h,p,y)}function o(d,h,p,y){var g=u(d,h),w=0,b=f(g.bitLength());"millerRabinTests"in p&&(b=p.millerRabinTests);var v=10;"maxBlockTime"in p&&(v=p.maxBlockTime),a(g,d,h,w,b,v,y)}function a(d,h,p,y,g,w,b){var v=+new Date;do{if(d.bitLength()>h&&(d=u(h,p)),d.isProbablePrime(g))return b(null,d);d.dAddOffset(t[y++%8],0)}while(w<0||+new Date-v<w);pl.util.setImmediate(function(){a(d,h,p,y,g,w,b)})}function c(d,h,p,y){if(typeof Worker=="undefined")return o(d,h,p,y);var g=u(d,h),w=p.workers,b=p.workLoad||100,v=b*30/8,R=p.workerScript||"forge/prime.worker.js";if(w===-1)return pl.util.estimateCores(function(C,T){C&&(T=2),w=T-1,k()});k();function k(){w=Math.max(1,w);for(var C=[],T=0;T<w;++T)C[T]=new Worker(R);for(var D=w,T=0;T<w;++T)C[T].addEventListener("message",M);var j=!1;function M(se){if(!j){--D;var ie=se.data;if(ie.found){for(var fe=0;fe<C.length;++fe)C[fe].terminate();return j=!0,y(null,new e(ie.prime,16))}g.bitLength()>d&&(g=u(d,h));var pe=g.toString(16);se.target.postMessage({hex:pe,workLoad:b}),g.dAddOffset(v,0)}}}}function u(d,h){var p=new e(d,h),y=d-1;return p.testBit(y)||p.bitwiseTo(e.ONE.shiftLeft(y),n,p),p.dAddOffset(31-p.mod(i).byteValue(),0),p}function f(d){return d<=100?27:d<=150?18:d<=200?15:d<=250?12:d<=300?9:d<=350?8:d<=400?7:d<=500?6:d<=600?5:d<=800?4:d<=1250?3:2}})()});var r2=m((Nat,bq)=>{l();var ht=At();fl();z4();Pp();lq();fq();Gf();vr();typeof jt=="undefined"&&(jt=ht.jsbn.BigInteger);var jt,BE=ht.util.isNodejs?$f():null,re=ht.asn1,Ws=ht.util;ht.pki=ht.pki||{};bq.exports=ht.pki.rsa=ht.rsa=ht.rsa||{};var pt=ht.pki,z9e=[6,4,2,4,2,4,6,2],H9e={name:"PrivateKeyInfo",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:re.Class.UNIVERSAL,type:re.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:re.Class.UNIVERSAL,type:re.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:re.Class.UNIVERSAL,type:re.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},$9e={name:"RSAPrivateKey",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:re.Class.UNIVERSAL,type:re.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:re.Class.UNIVERSAL,type:re.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:re.Class.UNIVERSAL,type:re.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:re.Class.UNIVERSAL,type:re.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:re.Class.UNIVERSAL,type:re.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:re.Class.UNIVERSAL,type:re.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:re.Class.UNIVERSAL,type:re.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:re.Class.UNIVERSAL,type:re.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:re.Class.UNIVERSAL,type:re.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},G9e={name:"RSAPublicKey",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:re.Class.UNIVERSAL,type:re.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:re.Class.UNIVERSAL,type:re.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},W9e=ht.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:re.Class.UNIVERSAL,type:re.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:re.Class.UNIVERSAL,type:re.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Y9e=function(r){var e;if(r.algorithm in pt.oids)e=pt.oids[r.algorithm];else{var t=new Error("Unknown message digest algorithm.");throw t.algorithm=r.algorithm,t}var i=re.oidToDer(e).getBytes(),n=re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[]),s=re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[]);s.value.push(re.create(re.Class.UNIVERSAL,re.Type.OID,!1,i)),s.value.push(re.create(re.Class.UNIVERSAL,re.Type.NULL,!1,""));var o=re.create(re.Class.UNIVERSAL,re.Type.OCTETSTRING,!1,r.digest().getBytes());return n.value.push(s),n.value.push(o),re.toDer(n).getBytes()},dq=function(r,e,t){if(t)return r.modPow(e.e,e.n);if(!e.p||!e.q)return r.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(jt.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(jt.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var i;do i=new jt(ht.util.bytesToHex(ht.random.getBytes(e.n.bitLength()/8)),16);while(i.compareTo(e.n)>=0||!i.gcd(e.n).equals(jt.ONE));r=r.multiply(i.modPow(e.e,e.n)).mod(e.n);for(var n=r.mod(e.p).modPow(e.dP,e.p),s=r.mod(e.q).modPow(e.dQ,e.q);n.compareTo(s)<0;)n=n.add(e.p);var o=n.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(i.modInverse(e.n)).mod(e.n),o};pt.rsa.encrypt=function(r,e,t){var i=t,n,s=Math.ceil(e.n.bitLength()/8);t!==!1&&t!==!0?(i=t===2,n=hq(r,e,t)):(n=ht.util.createBuffer(),n.putBytes(r));for(var o=new jt(n.toHex(),16),a=dq(o,e,i),c=a.toString(16),u=ht.util.createBuffer(),f=s-Math.ceil(c.length/2);f>0;)u.putByte(0),--f;return u.putBytes(ht.util.hexToBytes(c)),u.getBytes()};pt.rsa.decrypt=function(r,e,t,i){var n=Math.ceil(e.n.bitLength()/8);if(r.length!==n){var s=new Error("Encrypted message length is invalid.");throw s.length=r.length,s.expected=n,s}var o=new jt(ht.util.createBuffer(r).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=dq(o,e,t),c=a.toString(16),u=ht.util.createBuffer(),f=n-Math.ceil(c.length/2);f>0;)u.putByte(0),--f;return u.putBytes(ht.util.hexToBytes(c)),i!==!1?$4(u.getBytes(),e,t):u.getBytes()};pt.rsa.createKeyPairGenerationState=function(r,e,t){typeof r=="string"&&(r=parseInt(r,10)),r=r||2048,t=t||{};var i=t.prng||ht.random,n={nextBytes:function(a){for(var c=i.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=c.charCodeAt(u)}},s=t.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:r,rng:n,eInt:e||65537,e:new jt(null),p:null,q:null,qBits:r>>1,pBits:r-(r>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};pt.rsa.stepKeyPairGenerationState=function(r,e){"algorithm"in r||(r.algorithm="PRIMEINC");var t=new jt(null);t.fromInt(30);for(var i=0,n=function(d,h){return d|h},s=+new Date,o,a=0;r.keys===null&&(e<=0||a<e);){if(r.state===0){var c=r.p===null?r.pBits:r.qBits,u=c-1;r.pqState===0?(r.num=new jt(c,r.rng),r.num.testBit(u)||r.num.bitwiseTo(jt.ONE.shiftLeft(u),n,r.num),r.num.dAddOffset(31-r.num.mod(t).byteValue(),0),i=0,++r.pqState):r.pqState===1?r.num.bitLength()>c?r.pqState=0:r.num.isProbablePrime(Q9e(r.num.bitLength()))?++r.pqState:r.num.dAddOffset(z9e[i++%8],0):r.pqState===2?r.pqState=r.num.subtract(jt.ONE).gcd(r.e).compareTo(jt.ONE)===0?3:0:r.pqState===3&&(r.pqState=0,r.p===null?r.p=r.num:r.q=r.num,r.p!==null&&r.q!==null&&++r.state,r.num=null)}else if(r.state===1)r.p.compareTo(r.q)<0&&(r.num=r.p,r.p=r.q,r.q=r.num),++r.state;else if(r.state===2)r.p1=r.p.subtract(jt.ONE),r.q1=r.q.subtract(jt.ONE),r.phi=r.p1.multiply(r.q1),++r.state;else if(r.state===3)r.phi.gcd(r.e).compareTo(jt.ONE)===0?++r.state:(r.p=null,r.q=null,r.state=0);else if(r.state===4)r.n=r.p.multiply(r.q),r.n.bitLength()===r.bits?++r.state:(r.q=null,r.state=0);else if(r.state===5){var f=r.e.modInverse(r.phi);r.keys={privateKey:pt.rsa.setPrivateKey(r.n,r.e,f,r.p,r.q,f.mod(r.p1),f.mod(r.q1),r.q.modInverse(r.p)),publicKey:pt.rsa.setPublicKey(r.n,r.e)}}o=+new Date,a+=o-s,s=o}return r.keys!==null};pt.rsa.generateKeyPair=function(r,e,t,i){if(arguments.length===1?typeof r=="object"?(t=r,r=void 0):typeof r=="function"&&(i=r,r=void 0):arguments.length===2?typeof r=="number"?typeof e=="function"?(i=e,e=void 0):typeof e!="number"&&(t=e,e=void 0):(t=r,i=e,r=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof t=="function"&&(i=t,t=void 0):(i=t,t=e,e=void 0)),t=t||{},r===void 0&&(r=t.bits||2048),e===void 0&&(e=t.e||65537),!ht.options.usePureJavaScript&&!t.prng&&r>=256&&r<=16384&&(e===65537||e===3)){if(i){if(pq("generateKeyPair"))return BE.generateKeyPair("rsa",{modulusLength:r,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,u){if(a)return i(a);i(null,{privateKey:pt.privateKeyFromPem(u),publicKey:pt.publicKeyFromPem(c)})});if(yq("generateKey")&&yq("exportKey"))return Ws.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:mq(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Ws.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){i(a)}).then(function(a){if(a){var c=pt.privateKeyFromAsn1(re.fromDer(ht.util.createBuffer(a)));i(null,{privateKey:c,publicKey:pt.setRsaPublicKey(c.n,c.e)})}});if(gq("generateKey")&&gq("exportKey")){var n=Ws.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:mq(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);n.oncomplete=function(a){var c=a.target.result,u=Ws.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(f){var d=f.target.result,h=pt.privateKeyFromAsn1(re.fromDer(ht.util.createBuffer(d)));i(null,{privateKey:h,publicKey:pt.setRsaPublicKey(h.n,h.e)})},u.onerror=function(f){i(f)}},n.onerror=function(a){i(a)};return}}else if(pq("generateKeyPairSync")){var s=BE.generateKeyPairSync("rsa",{modulusLength:r,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:pt.privateKeyFromPem(s.privateKey),publicKey:pt.publicKeyFromPem(s.publicKey)}}}var o=pt.rsa.createKeyPairGenerationState(r,e,t);if(!i)return pt.rsa.stepKeyPairGenerationState(o,0),o.keys;X9e(o,t,i)};pt.setRsaPublicKey=pt.rsa.setPublicKey=function(r,e){var t={n:r,e};return t.encrypt=function(i,n,s){if(typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSAES-PKCS1-V1_5"),n==="RSAES-PKCS1-V1_5")n={encode:function(a,c,u){return hq(a,c,2).getBytes()}};else if(n==="RSA-OAEP"||n==="RSAES-OAEP")n={encode:function(a,c){return ht.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(n)!==-1)n={encode:function(a){return a}};else if(typeof n=="string")throw new Error('Unsupported encryption scheme: "'+n+'".');var o=n.encode(i,t,!0);return pt.rsa.encrypt(o,t,!0)},t.verify=function(i,n,s){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),s==="RSASSA-PKCS1-V1_5"?s={verify:function(a,c){c=$4(c,t,!0);var u=re.fromDer(c);return a===u.value[1].value}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(a,c){return c=$4(c,t,!0),a===c}});var o=pt.rsa.decrypt(n,t,!0,!1);return s.verify(i,o,t.n.bitLength())},t};pt.setRsaPrivateKey=pt.rsa.setPrivateKey=function(r,e,t,i,n,s,o,a){var c={n:r,e,d:t,p:i,q:n,dP:s,dQ:o,qInv:a};return c.decrypt=function(u,f,d){typeof f=="string"?f=f.toUpperCase():f===void 0&&(f="RSAES-PKCS1-V1_5");var h=pt.rsa.decrypt(u,c,!1,!1);if(f==="RSAES-PKCS1-V1_5")f={decode:$4};else if(f==="RSA-OAEP"||f==="RSAES-OAEP")f={decode:function(p,y){return ht.pkcs1.decode_rsa_oaep(y,p,d)}};else if(["RAW","NONE","NULL",null].indexOf(f)!==-1)f={decode:function(p){return p}};else throw new Error('Unsupported encryption scheme: "'+f+'".');return f.decode(h,c,!1)},c.sign=function(u,f){var d=!1;typeof f=="string"&&(f=f.toUpperCase()),f===void 0||f==="RSASSA-PKCS1-V1_5"?(f={encode:Y9e},d=1):(f==="NONE"||f==="NULL"||f===null)&&(f={encode:function(){return u}},d=1);var h=f.encode(u,c.n.bitLength());return pt.rsa.encrypt(h,c,d)},c};pt.wrapRsaPrivateKey=function(r){return re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[re.create(re.Class.UNIVERSAL,re.Type.INTEGER,!1,re.integerToDer(0).getBytes()),re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[re.create(re.Class.UNIVERSAL,re.Type.OID,!1,re.oidToDer(pt.oids.rsaEncryption).getBytes()),re.create(re.Class.UNIVERSAL,re.Type.NULL,!1,"")]),re.create(re.Class.UNIVERSAL,re.Type.OCTETSTRING,!1,re.toDer(r).getBytes())])};pt.privateKeyFromAsn1=function(r){var e={},t=[];if(re.validate(r,H9e,e,t)&&(r=re.fromDer(ht.util.createBuffer(e.privateKey))),e={},t=[],!re.validate(r,$9e,e,t)){var i=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw i.errors=t,i}var n,s,o,a,c,u,f,d;return n=ht.util.createBuffer(e.privateKeyModulus).toHex(),s=ht.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=ht.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=ht.util.createBuffer(e.privateKeyPrime1).toHex(),c=ht.util.createBuffer(e.privateKeyPrime2).toHex(),u=ht.util.createBuffer(e.privateKeyExponent1).toHex(),f=ht.util.createBuffer(e.privateKeyExponent2).toHex(),d=ht.util.createBuffer(e.privateKeyCoefficient).toHex(),pt.setRsaPrivateKey(new jt(n,16),new jt(s,16),new jt(o,16),new jt(a,16),new jt(c,16),new jt(u,16),new jt(f,16),new jt(d,16))};pt.privateKeyToAsn1=pt.privateKeyToRSAPrivateKey=function(r){return re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[re.create(re.Class.UNIVERSAL,re.Type.INTEGER,!1,re.integerToDer(0).getBytes()),re.create(re.Class.UNIVERSAL,re.Type.INTEGER,!1,Va(r.n)),re.create(re.Class.UNIVERSAL,re.Type.INTEGER,!1,Va(r.e)),re.create(re.Class.UNIVERSAL,re.Type.INTEGER,!1,Va(r.d)),re.create(re.Class.UNIVERSAL,re.Type.INTEGER,!1,Va(r.p)),re.create(re.Class.UNIVERSAL,re.Type.INTEGER,!1,Va(r.q)),re.create(re.Class.UNIVERSAL,re.Type.INTEGER,!1,Va(r.dP)),re.create(re.Class.UNIVERSAL,re.Type.INTEGER,!1,Va(r.dQ)),re.create(re.Class.UNIVERSAL,re.Type.INTEGER,!1,Va(r.qInv))])};pt.publicKeyFromAsn1=function(r){var e={},t=[];if(re.validate(r,W9e,e,t)){var i=re.derToOid(e.publicKeyOid);if(i!==pt.oids.rsaEncryption){var n=new Error("Cannot read public key. Unknown OID.");throw n.oid=i,n}r=e.rsaPublicKey}if(t=[],!re.validate(r,G9e,e,t)){var n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw n.errors=t,n}var s=ht.util.createBuffer(e.publicKeyModulus).toHex(),o=ht.util.createBuffer(e.publicKeyExponent).toHex();return pt.setRsaPublicKey(new jt(s,16),new jt(o,16))};pt.publicKeyToAsn1=pt.publicKeyToSubjectPublicKeyInfo=function(r){return re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[re.create(re.Class.UNIVERSAL,re.Type.OID,!1,re.oidToDer(pt.oids.rsaEncryption).getBytes()),re.create(re.Class.UNIVERSAL,re.Type.NULL,!1,"")]),re.create(re.Class.UNIVERSAL,re.Type.BITSTRING,!1,[pt.publicKeyToRSAPublicKey(r)])])};pt.publicKeyToRSAPublicKey=function(r){return re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[re.create(re.Class.UNIVERSAL,re.Type.INTEGER,!1,Va(r.n)),re.create(re.Class.UNIVERSAL,re.Type.INTEGER,!1,Va(r.e))])};function hq(r,e,t){var i=ht.util.createBuffer(),n=Math.ceil(e.n.bitLength()/8);if(r.length>n-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=r.length,s.max=n-11,s}i.putByte(0),i.putByte(t);var o=n-3-r.length,a;if(t===0||t===1){a=t===0?0:255;for(var c=0;c<o;++c)i.putByte(a)}else for(;o>0;){for(var u=0,f=ht.random.getBytes(o),c=0;c<o;++c)a=f.charCodeAt(c),a===0?++u:i.putByte(a);o=u}return i.putByte(0),i.putBytes(r),i}function $4(r,e,t,i){var n=Math.ceil(e.n.bitLength()/8),s=ht.util.createBuffer(r),o=s.getByte(),a=s.getByte();if(o!==0||t&&a!==0&&a!==1||!t&&a!=2||t&&a===0&&typeof i=="undefined")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=n-3-i;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var f=s.getByte();if(f!==0||c!==n-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function X9e(r,e,t){typeof e=="function"&&(t=e,e={}),e=e||{};var i={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(i.prng=e.prng),n();function n(){s(r.pBits,function(a,c){if(a)return t(a);if(r.p=c,r.q!==null)return o(a,r.q);s(r.qBits,o)})}function s(a,c){ht.prime.generateProbablePrime(a,i,c)}function o(a,c){if(a)return t(a);if(r.q=c,r.p.compareTo(r.q)<0){var u=r.p;r.p=r.q,r.q=u}if(r.p.subtract(jt.ONE).gcd(r.e).compareTo(jt.ONE)!==0){r.p=null,n();return}if(r.q.subtract(jt.ONE).gcd(r.e).compareTo(jt.ONE)!==0){r.q=null,s(r.qBits,o);return}if(r.p1=r.p.subtract(jt.ONE),r.q1=r.q.subtract(jt.ONE),r.phi=r.p1.multiply(r.q1),r.phi.gcd(r.e).compareTo(jt.ONE)!==0){r.p=r.q=null,n();return}if(r.n=r.p.multiply(r.q),r.n.bitLength()!==r.bits){r.q=null,s(r.qBits,o);return}var f=r.e.modInverse(r.phi);r.keys={privateKey:pt.rsa.setPrivateKey(r.n,r.e,f,r.p,r.q,f.mod(r.p1),f.mod(r.q1),r.q.modInverse(r.p)),publicKey:pt.rsa.setPublicKey(r.n,r.e)},t(null,r.keys)}}function Va(r){var e=r.toString(16);e[0]>="8"&&(e="00"+e);var t=ht.util.hexToBytes(e);return t.length>1&&(t.charCodeAt(0)===0&&(t.charCodeAt(1)&128)==0||t.charCodeAt(0)===255&&(t.charCodeAt(1)&128)==128)?t.substr(1):t}function Q9e(r){return r<=100?27:r<=150?18:r<=200?15:r<=250?12:r<=300?9:r<=350?8:r<=400?7:r<=500?6:r<=600?5:r<=800?4:r<=1250?3:2}function pq(r){return ht.util.isNodejs&&typeof BE[r]=="function"}function yq(r){return typeof Ws.globalScope!="undefined"&&typeof Ws.globalScope.crypto=="object"&&typeof Ws.globalScope.crypto.subtle=="object"&&typeof Ws.globalScope.crypto.subtle[r]=="function"}function gq(r){return typeof Ws.globalScope!="undefined"&&typeof Ws.globalScope.msCrypto=="object"&&typeof Ws.globalScope.msCrypto.subtle=="object"&&typeof Ws.globalScope.msCrypto.subtle[r]=="function"}function mq(r){for(var e=ht.util.hexToBytes(r.toString(16)),t=new Uint8Array(e.length),i=0;i<e.length;++i)t[i]=e.charCodeAt(i);return t}});var LE=m((Bat,Sq)=>{l();var De=At();kp();fl();L4();dl();Pp();xE();U4();Gf();Wj();r2();vr();typeof wq=="undefined"&&(wq=De.jsbn.BigInteger);var wq,ae=De.asn1,gt=De.pki=De.pki||{};Sq.exports=gt.pbe=De.pbe=De.pbe||{};var Xf=gt.oids,Z9e={name:"EncryptedPrivateKeyInfo",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},J9e={name:"PBES2Algorithms",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:ae.Class.UNIVERSAL,type:ae.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:ae.Class.UNIVERSAL,type:ae.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},eSe={name:"pkcs-12PbeParams",tagClass:ae.Class.UNIVERSAL,type:ae.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:ae.Class.UNIVERSAL,type:ae.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:ae.Class.UNIVERSAL,type:ae.Type.INTEGER,constructed:!1,capture:"iterations"}]};gt.encryptPrivateKeyInfo=function(r,e,t){t=t||{},t.saltSize=t.saltSize||8,t.count=t.count||2048,t.algorithm=t.algorithm||"aes128",t.prfAlgorithm=t.prfAlgorithm||"sha1";var i=De.random.getBytesSync(t.saltSize),n=t.count,s=ae.integerToDer(n),o,a,c;if(t.algorithm.indexOf("aes")===0||t.algorithm==="des"){var u,f,d;switch(t.algorithm){case"aes128":o=16,u=16,f=Xf["aes128-CBC"],d=De.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,f=Xf["aes192-CBC"],d=De.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,f=Xf["aes256-CBC"],d=De.aes.createEncryptionCipher;break;case"des":o=8,u=8,f=Xf.desCBC,d=De.des.createEncryptionCipher;break;default:var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=t.algorithm,h}var p="hmacWith"+t.prfAlgorithm.toUpperCase(),y=Eq(p),g=De.pkcs5.pbkdf2(e,i,n,o,y),w=De.random.getBytesSync(u),b=d(g);b.start(w),b.update(ae.toDer(r)),b.finish(),c=b.output.getBytes();var v=tSe(i,s,o,p);a=ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.OID,!1,ae.oidToDer(Xf.pkcs5PBES2).getBytes()),ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.OID,!1,ae.oidToDer(Xf.pkcs5PBKDF2).getBytes()),v]),ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.OID,!1,ae.oidToDer(f).getBytes()),ae.create(ae.Class.UNIVERSAL,ae.Type.OCTETSTRING,!1,w)])])])}else if(t.algorithm==="3des"){o=24;var R=new De.util.ByteBuffer(i),g=gt.pbe.generatePkcs12Key(e,R,1,n,o),w=gt.pbe.generatePkcs12Key(e,R,2,n,o),b=De.des.createEncryptionCipher(g);b.start(w),b.update(ae.toDer(r)),b.finish(),c=b.output.getBytes(),a=ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.OID,!1,ae.oidToDer(Xf["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.OCTETSTRING,!1,i),ae.create(ae.Class.UNIVERSAL,ae.Type.INTEGER,!1,s.getBytes())])])}else{var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=t.algorithm,h}var k=ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[a,ae.create(ae.Class.UNIVERSAL,ae.Type.OCTETSTRING,!1,c)]);return k};gt.decryptPrivateKeyInfo=function(r,e){var t=null,i={},n=[];if(!ae.validate(r,Z9e,i,n)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=ae.derToOid(i.encryptionOid),a=gt.pbe.getCipher(o,i.encryptionParams,e),c=De.util.createBuffer(i.encryptedData);return a.update(c),a.finish()&&(t=ae.fromDer(a.output)),t};gt.encryptedPrivateKeyToPem=function(r,e){var t={type:"ENCRYPTED PRIVATE KEY",body:ae.toDer(r).getBytes()};return De.pem.encode(t,{maxline:e})};gt.encryptedPrivateKeyFromPem=function(r){var e=De.pem.decode(r)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var t=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return ae.fromDer(e.body)};gt.encryptRsaPrivateKey=function(r,e,t){if(t=t||{},!t.legacy){var i=gt.wrapRsaPrivateKey(gt.privateKeyToAsn1(r));return i=gt.encryptPrivateKeyInfo(i,e,t),gt.encryptedPrivateKeyToPem(i)}var n,s,o,a;switch(t.algorithm){case"aes128":n="AES-128-CBC",o=16,s=De.random.getBytesSync(16),a=De.aes.createEncryptionCipher;break;case"aes192":n="AES-192-CBC",o=24,s=De.random.getBytesSync(16),a=De.aes.createEncryptionCipher;break;case"aes256":n="AES-256-CBC",o=32,s=De.random.getBytesSync(16),a=De.aes.createEncryptionCipher;break;case"3des":n="DES-EDE3-CBC",o=24,s=De.random.getBytesSync(8),a=De.des.createEncryptionCipher;break;case"des":n="DES-CBC",o=8,s=De.random.getBytesSync(8),a=De.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+t.algorithm+'".');throw c.algorithm=t.algorithm,c}var u=De.pbe.opensslDeriveBytes(e,s.substr(0,8),o),f=a(u);f.start(s),f.update(ae.toDer(gt.privateKeyToAsn1(r))),f.finish();var d={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:n,parameters:De.util.bytesToHex(s).toUpperCase()},body:f.output.getBytes()};return De.pem.encode(d)};gt.decryptRsaPrivateKey=function(r,e){var t=null,i=De.pem.decode(r)[0];if(i.type!=="ENCRYPTED PRIVATE KEY"&&i.type!=="PRIVATE KEY"&&i.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw n.headerType=n,n}if(i.procType&&i.procType.type==="ENCRYPTED"){var s,o;switch(i.dekInfo.algorithm){case"DES-CBC":s=8,o=De.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=De.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=De.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=De.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=De.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(d){return De.rc2.createDecryptionCipher(d,40)};break;case"RC2-64-CBC":s=8,o=function(d){return De.rc2.createDecryptionCipher(d,64)};break;case"RC2-128-CBC":s=16,o=function(d){return De.rc2.createDecryptionCipher(d,128)};break;default:var n=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".');throw n.algorithm=i.dekInfo.algorithm,n}var a=De.util.hexToBytes(i.dekInfo.parameters),c=De.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);if(u.start(a),u.update(De.util.createBuffer(i.body)),u.finish())t=u.output.getBytes();else return t}else t=i.body;return i.type==="ENCRYPTED PRIVATE KEY"?t=gt.decryptPrivateKeyInfo(ae.fromDer(t),e):t=ae.fromDer(t),t!==null&&(t=gt.privateKeyFromAsn1(t)),t};gt.pbe.generatePkcs12Key=function(r,e,t,i,n,s){var o,a;if(typeof s=="undefined"||s===null){if(!("sha1"in De.md))throw new Error('"sha1" hash algorithm unavailable.');s=De.md.sha1.create()}var c=s.digestLength,u=s.blockLength,f=new De.util.ByteBuffer,d=new De.util.ByteBuffer;if(r!=null){for(a=0;a<r.length;a++)d.putInt16(r.charCodeAt(a));d.putInt16(0)}var h=d.length(),p=e.length(),y=new De.util.ByteBuffer;y.fillWithByte(t,u);var g=u*Math.ceil(p/u),w=new De.util.ByteBuffer;for(a=0;a<g;a++)w.putByte(e.at(a%p));var b=u*Math.ceil(h/u),v=new De.util.ByteBuffer;for(a=0;a<b;a++)v.putByte(d.at(a%h));var R=w;R.putBuffer(v);for(var k=Math.ceil(n/c),C=1;C<=k;C++){var T=new De.util.ByteBuffer;T.putBytes(y.bytes()),T.putBytes(R.bytes());for(var D=0;D<i;D++)s.start(),s.update(T.getBytes()),T=s.digest();var j=new De.util.ByteBuffer;for(a=0;a<u;a++)j.putByte(T.at(a%c));var M=Math.ceil(p/u)+Math.ceil(h/u),se=new De.util.ByteBuffer;for(o=0;o<M;o++){var ie=new De.util.ByteBuffer(R.getBytes(u)),fe=511;for(a=j.length()-1;a>=0;a--)fe=fe>>8,fe+=j.at(a)+ie.at(a),ie.setAt(a,fe&255);se.putBuffer(ie)}R=se,f.putBuffer(T)}return f.truncate(f.length()-n),f};gt.pbe.getCipher=function(r,e,t){switch(r){case gt.oids.pkcs5PBES2:return gt.pbe.getCipherForPBES2(r,e,t);case gt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case gt.oids["pbewithSHAAnd40BitRC2-CBC"]:return gt.pbe.getCipherForPKCS12PBE(r,e,t);default:var i=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw i.oid=r,i.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],i}};gt.pbe.getCipherForPBES2=function(r,e,t){var i={},n=[];if(!ae.validate(e,J9e,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}if(r=ae.derToOid(i.kdfOid),r!==gt.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=r,s.supportedOids=["pkcs5PBKDF2"],s}if(r=ae.derToOid(i.encOid),r!==gt.oids["aes128-CBC"]&&r!==gt.oids["aes192-CBC"]&&r!==gt.oids["aes256-CBC"]&&r!==gt.oids["des-EDE3-CBC"]&&r!==gt.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=r,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=i.kdfSalt,a=De.util.createBuffer(i.kdfIterationCount);a=a.getInt(a.length()<<3);var c,u;switch(gt.oids[r]){case"aes128-CBC":c=16,u=De.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=De.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=De.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=De.des.createDecryptionCipher;break;case"desCBC":c=8,u=De.des.createDecryptionCipher;break}var f=vq(i.prfOid),d=De.pkcs5.pbkdf2(t,o,a,c,f),h=i.encIv,p=u(d);return p.start(h),p};gt.pbe.getCipherForPKCS12PBE=function(r,e,t){var i={},n=[];if(!ae.validate(e,eSe,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=De.util.createBuffer(i.salt),a=De.util.createBuffer(i.iterations);a=a.getInt(a.length()<<3);var c,u,f;switch(r){case gt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,f=De.des.startDecrypting;break;case gt.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,f=function(g,w){var b=De.rc2.createDecryptionCipher(g,40);return b.start(w,null),b};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=r,s}var d=vq(i.prfOid),h=gt.pbe.generatePkcs12Key(t,o,1,a,c,d);d.start();var p=gt.pbe.generatePkcs12Key(t,o,2,a,u,d);return f(h,p)};gt.pbe.opensslDeriveBytes=function(r,e,t,i){if(typeof i=="undefined"||i===null){if(!("md5"in De.md))throw new Error('"md5" hash algorithm unavailable.');i=De.md.md5.create()}e===null&&(e="");for(var n=[_q(i,r+e)],s=16,o=1;s<t;++o,s+=16)n.push(_q(i,n[o-1]+r+e));return n.join("").substr(0,t)};function _q(r,e){return r.start().update(e).digest().getBytes()}function vq(r){var e;if(!r)e="hmacWithSHA1";else if(e=gt.oids[ae.derToOid(r)],!e){var t=new Error("Unsupported PRF OID.");throw t.oid=r,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}return Eq(e)}function Eq(r){var e=De.md;switch(r){case"hmacWithSHA224":e=De.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":r=r.substr(8).toLowerCase();break;default:var t=new Error("Unsupported PRF algorithm.");throw t.algorithm=r,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}if(!e||!(r in e))throw new Error("Unknown hash algorithm: "+r);return e[r].create()}function tSe(r,e,t,i){var n=ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.OCTETSTRING,!1,r),ae.create(ae.Class.UNIVERSAL,ae.Type.INTEGER,!1,e.getBytes())]);return i!=="hmacWithSHA1"&&n.value.push(ae.create(ae.Class.UNIVERSAL,ae.Type.INTEGER,!1,De.util.hexToBytes(t.toString(16))),ae.create(ae.Class.UNIVERSAL,ae.Type.SEQUENCE,!0,[ae.create(ae.Class.UNIVERSAL,ae.Type.OID,!1,ae.oidToDer(gt.oids[i]).getBytes()),ae.create(ae.Class.UNIVERSAL,ae.Type.NULL,!1,"")])),n}});var Ys=m((Lat,Rq)=>{l();"use strict";function Aq(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function rSe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Aq(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Aq(new n,t)}}Rq.exports=rSe});var i2=m(xq=>{l();"use strict";xq.get=(r=globalThis)=>{let e=r.crypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var ME=m((jat,Tq)=>{l();"use strict";var{concat:iSe}=(Ri(),Cn),{fromString:Iq}=(at(),Xr),nSe=i2();function sSe({algorithm:r="AES-GCM",nonceLength:e=12,keyLength:t=16,digest:i="SHA-256",saltLength:n=16,iterations:s=32767}={}){let o=nSe.get();t*=8;async function a(u,f){let d=o.getRandomValues(new Uint8Array(n)),h=o.getRandomValues(new Uint8Array(e)),p={name:r,iv:h},y={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},g=await o.subtle.importKey("raw",Iq(f),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),w=await o.subtle.deriveKey(y,g,{name:r,length:t},!0,["encrypt"]),b=await o.subtle.encrypt(p,w,u);return iSe([d,p.iv,new Uint8Array(b)])}async function c(u,f){let d=u.slice(0,n),h=u.slice(n,n+e),p=u.slice(n+e),y={name:r,iv:h},g={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},w=await o.subtle.importKey("raw",Iq(f),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),b=await o.subtle.deriveKey(g,w,{name:r,length:t},!0,["decrypt"]),v=await o.subtle.decrypt(y,b,p);return new Uint8Array(v)}return{encrypt:a,decrypt:c}}Tq.exports={create:sSe}});var Cq=m((qat,Pq)=>{l();"use strict";var{base64:oSe}=(el(),jf),aSe=ME();Pq.exports={import:async function(r,e){let t=oSe.decode(r);return await aSe.create().decrypt(t,e)}}});var UE=m((Uat,Nq)=>{l();var kr=At();dl();vr();var n2=Nq.exports=kr.sha512=kr.sha512||{};kr.md.sha512=kr.md.algorithms.sha512=n2;var Oq=kr.sha384=kr.sha512.sha384=kr.sha512.sha384||{};Oq.create=function(){return n2.create("SHA-384")};kr.md.sha384=kr.md.algorithms.sha384=Oq;kr.sha512.sha256=kr.sha512.sha256||{create:function(){return n2.create("SHA-512/256")}};kr.md["sha512/256"]=kr.md.algorithms["sha512/256"]=kr.sha512.sha256;kr.sha512.sha224=kr.sha512.sha224||{create:function(){return n2.create("SHA-512/224")}};kr.md["sha512/224"]=kr.md.algorithms["sha512/224"]=kr.sha512.sha224;n2.create=function(r){if(kq||cSe(),typeof r=="undefined"&&(r="SHA-512"),!(r in Qf))throw new Error("Invalid SHA-512 algorithm: "+r);for(var e=Qf[r],t=null,i=kr.util.createBuffer(),n=new Array(80),s=0;s<80;++s)n[s]=new Array(2);var o=64;switch(r){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:r.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,u=0;u<c;++u)a.fullMessageLength.push(0);i=kr.util.createBuffer(),t=new Array(e.length);for(var u=0;u<e.length;++u)t[u]=e[u].slice(0);return a},a.start(),a.update=function(c,u){u==="utf8"&&(c=kr.util.encodeUtf8(c));var f=c.length;a.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var d=a.fullMessageLength.length-1;d>=0;--d)a.fullMessageLength[d]+=f[1],f[1]=f[0]+(a.fullMessageLength[d]/4294967296>>>0),a.fullMessageLength[d]=a.fullMessageLength[d]>>>0,f[0]=f[1]/4294967296>>>0;return i.putBytes(c),Dq(t,n,i),(i.read>2048||i.length()===0)&&i.compact(),a},a.digest=function(){var c=kr.util.createBuffer();c.putBytes(i.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,f=u&a.blockLength-1;c.putBytes(jE.substr(0,a.blockLength-f));for(var d,h,p=a.fullMessageLength[0]*8,y=0;y<a.fullMessageLength.length-1;++y)d=a.fullMessageLength[y+1]*8,h=d/4294967296>>>0,p+=h,c.putInt32(p>>>0),p=d>>>0;c.putInt32(p);for(var g=new Array(t.length),y=0;y<t.length;++y)g[y]=t[y].slice(0);Dq(g,n,c);var w=kr.util.createBuffer(),b;r==="SHA-512"?b=g.length:r==="SHA-384"?b=g.length-2:b=g.length-4;for(var y=0;y<b;++y)w.putInt32(g[y][0]),(y!==b-1||r!=="SHA-512/224")&&w.putInt32(g[y][1]);return w},a};var jE=null,kq=!1,qE=null,Qf=null;function cSe(){jE=String.fromCharCode(128),jE+=kr.util.fillString(String.fromCharCode(0),128),qE=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Qf={},Qf["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Qf["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Qf["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Qf["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],kq=!0}function Dq(r,e,t){for(var i,n,s,o,a,c,u,f,d,h,p,y,g,w,b,v,R,k,C,T,D,j,M,se,ie,fe,pe,Be,Ae,ke,ne,Me,ct,Ye,Xe,de=t.length();de>=128;){for(Ae=0;Ae<16;++Ae)e[Ae][0]=t.getInt32()>>>0,e[Ae][1]=t.getInt32()>>>0;for(;Ae<80;++Ae)Me=e[Ae-2],ke=Me[0],ne=Me[1],i=((ke>>>19|ne<<13)^(ne>>>29|ke<<3)^ke>>>6)>>>0,n=((ke<<13|ne>>>19)^(ne<<3|ke>>>29)^(ke<<26|ne>>>6))>>>0,Ye=e[Ae-15],ke=Ye[0],ne=Ye[1],s=((ke>>>1|ne<<31)^(ke>>>8|ne<<24)^ke>>>7)>>>0,o=((ke<<31|ne>>>1)^(ke<<24|ne>>>8)^(ke<<25|ne>>>7))>>>0,ct=e[Ae-7],Xe=e[Ae-16],ne=n+ct[1]+o+Xe[1],e[Ae][0]=i+ct[0]+s+Xe[0]+(ne/4294967296>>>0)>>>0,e[Ae][1]=ne>>>0;for(g=r[0][0],w=r[0][1],b=r[1][0],v=r[1][1],R=r[2][0],k=r[2][1],C=r[3][0],T=r[3][1],D=r[4][0],j=r[4][1],M=r[5][0],se=r[5][1],ie=r[6][0],fe=r[6][1],pe=r[7][0],Be=r[7][1],Ae=0;Ae<80;++Ae)u=((D>>>14|j<<18)^(D>>>18|j<<14)^(j>>>9|D<<23))>>>0,f=((D<<18|j>>>14)^(D<<14|j>>>18)^(j<<23|D>>>9))>>>0,d=(ie^D&(M^ie))>>>0,h=(fe^j&(se^fe))>>>0,a=((g>>>28|w<<4)^(w>>>2|g<<30)^(w>>>7|g<<25))>>>0,c=((g<<4|w>>>28)^(w<<30|g>>>2)^(w<<25|g>>>7))>>>0,p=(g&b|R&(g^b))>>>0,y=(w&v|k&(w^v))>>>0,ne=Be+f+h+qE[Ae][1]+e[Ae][1],i=pe+u+d+qE[Ae][0]+e[Ae][0]+(ne/4294967296>>>0)>>>0,n=ne>>>0,ne=c+y,s=a+p+(ne/4294967296>>>0)>>>0,o=ne>>>0,pe=ie,Be=fe,ie=M,fe=se,M=D,se=j,ne=T+n,D=C+i+(ne/4294967296>>>0)>>>0,j=ne>>>0,C=R,T=k,R=b,k=v,b=g,v=w,ne=n+o,g=i+s+(ne/4294967296>>>0)>>>0,w=ne>>>0;ne=r[0][1]+w,r[0][0]=r[0][0]+g+(ne/4294967296>>>0)>>>0,r[0][1]=ne>>>0,ne=r[1][1]+v,r[1][0]=r[1][0]+b+(ne/4294967296>>>0)>>>0,r[1][1]=ne>>>0,ne=r[2][1]+k,r[2][0]=r[2][0]+R+(ne/4294967296>>>0)>>>0,r[2][1]=ne>>>0,ne=r[3][1]+T,r[3][0]=r[3][0]+C+(ne/4294967296>>>0)>>>0,r[3][1]=ne>>>0,ne=r[4][1]+j,r[4][0]=r[4][0]+D+(ne/4294967296>>>0)>>>0,r[4][1]=ne>>>0,ne=r[5][1]+se,r[5][0]=r[5][0]+M+(ne/4294967296>>>0)>>>0,r[5][1]=ne>>>0,ne=r[6][1]+fe,r[6][0]=r[6][0]+ie+(ne/4294967296>>>0)>>>0,r[6][1]=ne>>>0,ne=r[7][1]+Be,r[7][0]=r[7][0]+pe+(ne/4294967296>>>0)>>>0,r[7][1]=ne>>>0,de-=128}}});var Lq=m((Fat,Bq)=>{l();"use strict";var G4=65536;function uSe(r){let e=new Uint8Array(r),t=0;if(r>0)if(r>G4)for(;t<r;)t+G4>r?(crypto.getRandomValues(e.subarray(t,t+(r-t))),t+=r-t):(crypto.getRandomValues(e.subarray(t,t+G4)),t+=G4);else crypto.getRandomValues(e);return e}Bq.exports=uSe});var s2=m((Kat,Mq)=>{l();"use strict";var lSe=Lq(),fSe=Ys();Mq.exports=function(r){if(isNaN(r)||r<=0)throw fSe(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return lSe(r)}});var W4=m(o2=>{l();"use strict";vr();z4();var dSe=At(),{fromString:hSe}=(at(),Xr),{toString:jq}=(et(),or),{concat:qq}=(Ri(),Cn);o2.bigIntegerToUintBase64url=(r,e)=>{let t=Uint8Array.from(r.abs().toByteArray());if(t=t[0]===0?t.slice(1):t,e!=null){if(t.length>e)throw new Error("byte array longer than desired length");t=qq([new Uint8Array(e-t.length),t])}return jq(t,"base64url")};o2.base64urlToBigInteger=r=>{let e=o2.base64urlToBuffer(r);return new dSe.jsbn.BigInteger(jq(e,"base16"),16)};o2.base64urlToBuffer=(r,e)=>{let t=hSe(r,"base64urlpad");if(e!=null){if(t.length>e)throw new Error("byte array longer than desired length");t=qq([new Uint8Array(e-t.length),t])}return t}});var Kq=m(a2=>{l();"use strict";fl();r2();var yl=At(),{bigIntegerToUintBase64url:za,base64urlToBigInteger:Ha}=W4(),{fromString:Uq}=(at(),Xr),{toString:Fq}=(et(),or);a2.pkcs1ToJwk=function(r){let e=yl.asn1.fromDer(Fq(r,"ascii")),t=yl.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:za(t.n),e:za(t.e),d:za(t.d),p:za(t.p),q:za(t.q),dp:za(t.dP),dq:za(t.dQ),qi:za(t.qInv),alg:"RS256",kid:"2011-04-29"}};a2.jwkToPkcs1=function(r){let e=yl.pki.privateKeyToAsn1({n:Ha(r.n),e:Ha(r.e),d:Ha(r.d),p:Ha(r.p),q:Ha(r.q),dP:Ha(r.dp),dQ:Ha(r.dq),qInv:Ha(r.qi)});return Uq(yl.asn1.toDer(e).getBytes(),"ascii")};a2.pkixToJwk=function(r){let e=yl.asn1.fromDer(Fq(r,"ascii")),t=yl.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:za(t.n),e:za(t.e),alg:"RS256",kid:"2011-04-29"}};a2.jwkToPkix=function(r){let e=yl.pki.publicKeyToAsn1({n:Ha(r.n),e:Ha(r.e)});return Uq(yl.asn1.toDer(e).getBytes(),"ascii")}});var $q=m((Hat,Hq)=>{l();"use strict";r2();var Vq=At(),{base64urlToBigInteger:pSe}=W4();function zq(r,e){return e.map(t=>pSe(r[t]))}function ySe(r){return Vq.pki.setRsaPrivateKey(...zq(r,["n","e","d","p","q","dp","dq","qi"]))}function gSe(r){return Vq.pki.setRsaPublicKey(...zq(r,["n","e"]))}Hq.exports={jwk2pub:gSe,jwk2priv:ySe}});var Yq=m(Jc=>{l();"use strict";var Zc=i2(),mSe=s2(),{toString:bSe}=(et(),or),{fromString:wSe}=(at(),Xr);Jc.utils=Kq();Jc.generateKey=async function(r){let e=await Zc.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),t=await Gq(e);return{privateKey:t[0],publicKey:t[1]}};Jc.unmarshalPrivateKey=async function(r){let t=[await Zc.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await _Se(r)],i=await Gq({privateKey:t[0],publicKey:t[1]});return{privateKey:i[0],publicKey:i[1]}};Jc.getRandomValues=mSe;Jc.hashAndSign=async function(r,e){let t=await Zc.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),i=await Zc.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},t,Uint8Array.from(e));return new Uint8Array(i,i.byteOffset,i.byteLength)};Jc.hashAndVerify=async function(r,e,t){let i=await Zc.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Zc.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},i,e,t)};function Gq(r){return Promise.all([Zc.get().subtle.exportKey("jwk",r.privateKey),Zc.get().subtle.exportKey("jwk",r.publicKey)])}function _Se(r){return Zc.get().subtle.importKey("jwk",{kty:r.kty,n:r.n,e:r.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:vSe,jwk2priv:ESe}=$q();function Wq(r,e,t,i){let n=e?vSe(r):ESe(r),s=bSe(Uint8Array.from(t),"ascii"),o=i(s,n);return wSe(o,"ascii")}Jc.encrypt=function(r,e){return Wq(r,!0,e,(t,i)=>i.encrypt(t))};Jc.decrypt=function(r,e){return Wq(r,!1,e,(t,i)=>i.decrypt(t))}});var Y4=m((Gat,Xq)=>{l();"use strict";var{base64:SSe}=(el(),jf),ASe=ME();Xq.exports={export:async function(r,e){let i=await ASe.create().encrypt(r,e);return SSe.encode(i)}}});var tU=m((Wat,eU)=>{l();"use strict";var{sha256:Qq}=(Si(),Ks),Zq=Ys(),{equals:Jq}=(hi(),hn),{toString:RSe}=(et(),or);UE();var X4=At(),Xs=Yq(),Q4=P4(),xSe=Y4(),Z4=class{constructor(e){this._key=e}async verify(e,t){return Xs.hashAndVerify(this._key,t,e)}marshal(){return Xs.utils.jwkToPkix(this._key)}get bytes(){return Q4.PublicKey.encode({Type:Q4.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return Xs.encrypt(this._key,e)}equals(e){return Jq(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Qq.digest(this.bytes);return e}},c2=class{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return Xs.getRandomValues(16)}async sign(e){return Xs.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw Zq(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new Z4(this._publicKey)}decrypt(e){return Xs.decrypt(this._key,e)}marshal(){return Xs.utils.jwkToPkcs1(this._key)}get bytes(){return Q4.PrivateKey.encode({Type:Q4.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return Jq(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Qq.digest(this.bytes);return e}async id(){let e=await this.public.hash();return RSe(e,"base58btc")}async export(e,t="pkcs-8"){if(t==="pkcs-8"){let i=new X4.util.ByteBuffer(this.marshal()),n=X4.asn1.fromDer(i),s=X4.pki.privateKeyFromAsn1(n),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return X4.pki.encryptRsaPrivateKey(s,e,o)}else{if(t==="libp2p-key")return xSe.export(this.bytes,e);throw Zq(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function ISe(r){let e=Xs.utils.pkcs1ToJwk(r),t=await Xs.unmarshalPrivateKey(e);return new c2(t.privateKey,t.publicKey)}function TSe(r){let e=Xs.utils.pkixToJwk(r);return new Z4(e)}async function PSe(r){let e=await Xs.unmarshalPrivateKey(r);return new c2(e.privateKey,e.publicKey)}async function CSe(r){let e=await Xs.generateKey(r);return new c2(e.privateKey,e.publicKey)}eU.exports={RsaPublicKey:Z4,RsaPrivateKey:c2,unmarshalRsaPublicKey:TSe,unmarshalRsaPrivateKey:ISe,generateKeyPair:CSe,fromJwk:PSe}});var uU=m(er=>{l();"use strict";var OSe=er&&er.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(er,"__esModule",{value:!0});er.utils=er.curve25519=er.getSharedSecret=er.verify=er.sign=er.getPublicKey=er.Signature=er.Point=er.ExtendedPoint=er.CURVE=void 0;var kSe=OSe($f()),pi=BigInt(0),Bt=BigInt(1),nn=BigInt(2),rU=BigInt(255),iU=nn**BigInt(252)+BigInt("27742317777372353535851937790883648493"),Sr={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:nn**rU-BigInt(19),l:iU,n:iU,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")};er.CURVE=Sr;var FE=nn**BigInt(256),u2=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Yat=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),DSe=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),NSe=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),BSe=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),LSe=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),fr=class{constructor(e,t,i,n){this.x=e,this.y=t,this.z=i,this.t=n}static fromAffine(e){if(!(e instanceof Ur))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(Ur.ZERO)?fr.ZERO:new fr(e.x,e.y,Bt,ce(e.x*e.y))}static toAffineBatch(e){let t=qSe(e.map(i=>i.z));return e.map((i,n)=>i.toAffine(t[n]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}static fromRistrettoHash(e){e=eu(e,64);let t=VE(e.slice(0,32)),i=this.calcElligatorRistrettoMap(t),n=VE(e.slice(32,64)),s=this.calcElligatorRistrettoMap(n);return i.add(s)}static calcElligatorRistrettoMap(e){let{d:t}=Sr,i=ce(u2*e*e),n=ce((i+Bt)*BSe),s=BigInt(-1),o=ce((s-t*i)*ce(i+t)),{isValid:a,value:c}=HE(n,o),u=ce(c*e);gl(u)||(u=ce(-u)),a||(c=u),a||(s=i);let f=ce(s*(i-Bt)*LSe-o),d=c*c,h=ce((c+c)*o),p=ce(f*DSe),y=ce(Bt-d),g=ce(Bt+d);return new fr(ce(h*g),ce(y*p),ce(p*g),ce(h*y))}static fromRistrettoBytes(e){e=eu(e,32);let{a:t,d:i}=Sr,n="ExtendedPoint.fromRistrettoBytes: Cannot convert bytes to Ristretto Point",s=VE(e);if(!USe(Bp(s,32),e)||gl(s))throw new Error(n);let o=ce(s*s),a=ce(Bt+t*o),c=ce(Bt-t*o),u=ce(a*a),f=ce(c*c),d=ce(t*i*u-f),{isValid:h,value:p}=aU(ce(d*f)),y=ce(p*c),g=ce(p*y*d),w=ce((s+s)*y);gl(w)&&(w=ce(-w));let b=ce(a*g),v=ce(w*b);if(!h||gl(v)||b===pi)throw new Error(n);return new fr(w,b,Bt,v)}toRistrettoBytes(){let{x:e,y:t,z:i,t:n}=this,s=ce(ce(i+t)*ce(i-t)),o=ce(e*t),{value:a}=aU(ce(s*o**nn)),c=ce(a*s),u=ce(a*o),f=ce(c*u*n),d;if(gl(n*f)){let p=ce(t*u2),y=ce(e*u2);e=p,t=y,d=ce(c*NSe)}else d=u;gl(e*f)&&(t=ce(-t));let h=ce((i-t)*d);return gl(h)&&(h=ce(-h)),Bp(h,32)}equals(e){let t=this,i=e;return ce(t.t*i.z)===ce(i.t*t.z)}negate(){return new fr(ce(-this.x),this.y,this.z,ce(-this.t))}double(){let e=this.x,t=this.y,i=this.z,{a:n}=Sr,s=ce(e**nn),o=ce(t**nn),a=ce(nn*i**nn),c=ce(n*s),u=ce((e+t)**nn-s-o),f=ce(c+o),d=ce(f-a),h=ce(c-o),p=ce(u*d),y=ce(f*h),g=ce(u*h),w=ce(d*f);return new fr(p,y,w,g)}add(e){let t=this.x,i=this.y,n=this.z,s=this.t,o=e.x,a=e.y,c=e.z,u=e.t,f=ce((i-t)*(a+o)),d=ce((i+t)*(a-o)),h=ce(d-f);if(h===pi)return this.double();let p=ce(n*nn*u),y=ce(s*nn*c),g=ce(y+p),w=ce(d+f),b=ce(y-p),v=ce(g*h),R=ce(w*b),k=ce(g*b),C=ce(h*w);return new fr(v,R,C,k)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let t=ed(e,Sr.n),i=fr.ZERO;if(this.equals(i)||t===Bt)return this;let n=i,s=this;for(;t>pi;)t&Bt&&(n=n.add(s)),s=s.double(),t>>=Bt;return n}precomputeWindow(e){let t=256/e+1,i=[],n=this,s=n;for(let o=0;o<t;o++){s=n,i.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(n),i.push(s);n=s.double()}return i}wNAF(e,t){!t&&this.equals(fr.BASE)&&(t=Ur.BASE);let i=t&&t._WINDOW_SIZE||1;if(256%i)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=t&&KE.get(t);n||(n=this.precomputeWindow(i),t&&i!==1&&(n=fr.normalizeZ(n),KE.set(t,n)));let s=fr.ZERO,o=fr.ZERO,a=256/i+1,c=2**(i-1),u=BigInt(2**i-1),f=2**i,d=BigInt(i);for(let h=0;h<a;h++){let p=h*c,y=Number(e&u);if(e>>=d,y>c&&(y-=f,e+=Bt),y===0){let g=n[p];h%2&&(g=g.negate()),o=o.add(g)}else{let g=n[p+Math.abs(y)-1];y<0&&(g=g.negate()),s=s.add(g)}}return[s,o]}multiply(e,t){let i=ed(e,Sr.n);return fr.normalizeZ(this.wNAF(i,t))[0]}multiplyForVerification(e){let t=ed(e,Sr.n,!1);return fr.normalizeZ(this.wNAF(t))[0]}toAffine(e=zE(this.z)){let t=ce(this.x*e),i=ce(this.y*e);return new Ur(t,i)}};er.ExtendedPoint=fr;fr.BASE=new fr(Sr.Gx,Sr.Gy,Bt,ce(Sr.Gx*Sr.Gy));fr.ZERO=new fr(pi,Bt,Bt,pi);var KE=new WeakMap,Ur=class{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,KE.delete(this)}static fromHex(e,t=!0){let{d:i,P:n}=Sr;e=eu(e,32);let s=e.slice();s[31]=e[31]&~128;let o=Jf(s);if(t&&o>=n||!t&&o>=FE)throw new Error("Point.fromHex expects hex <= Fp");let a=ce(o*o),c=ce(a-Bt),u=ce(i*a+Bt),{isValid:f,value:d}=HE(c,u);if(!f)throw new Error("Point.fromHex: invalid y coordinate");let h=(d&Bt)===Bt;return(e[31]&128)!=0!==h&&(d=ce(-d)),new Ur(d,o)}static async fromPrivateKey(e){return(await l2(e)).point}toRawBytes(){let e=Bp(this.y,32);return e[31]|=this.x&Bt?128:0,e}toHex(){return J4(this.toRawBytes())}toX25519(){let{y:e}=this,t=ce((Bt+e)*zE(Bt-e));return Bp(t,32)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Ur(ce(-this.x),this.y)}add(e){return fr.fromAffine(this).add(fr.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return fr.fromAffine(this).multiply(e,this).toAffine()}};er.Point=Ur;Ur.BASE=new Ur(Sr.Gx,Sr.Gy);Ur.ZERO=new Ur(pi,Bt);var Zf=class{constructor(e,t,i=!0){if(this.r=e,!(e instanceof Ur))throw new Error("Expected Point instance");this.s=ed(t,Sr.n,i)}static fromHex(e,t=!0){let i=eu(e,64),n=Ur.fromHex(i.slice(0,32),t),s=Jf(i.slice(32,64));return new Zf(n,s,t)}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(Bp(this.s,32),32),e}toHex(){return J4(this.toRawBytes())}};er.Signature=Zf;function MSe(...r){if(!r.every(i=>i instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(r.length===1)return r[0];let e=r.reduce((i,n)=>i+n.length,0),t=new Uint8Array(e);for(let i=0,n=0;i<r.length;i++){let s=r[i];t.set(s,n),n+=s.length}return t}var jSe=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function J4(r){if(!(r instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let t=0;t<r.length;t++)e+=jSe[r[t]];return e}function nU(r){if(typeof r!="string")throw new TypeError("hexToBytes: expected string, got "+typeof r);if(r.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(r.length/2);for(let t=0;t<e.length;t++){let i=t*2,n=r.slice(i,i+2),s=Number.parseInt(n,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[t]=s}return e}function sU(r,e){let t=r.toString(16).padStart(e*2,"0");return nU(t)}function Bp(r,e){return sU(r,e).reverse()}function gl(r){return(ce(r)&Bt)===Bt}function Jf(r){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+J4(Uint8Array.from(r).reverse()))}function VE(r){return ce(Jf(r)&nn**rU-Bt)}function ce(r,e=Sr.P){let t=r%e;return t>=pi?t:e+t}function zE(r,e=Sr.P){if(r===pi||e<=pi)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=ce(r,e),i=e,n=pi,s=Bt,o=Bt,a=pi;for(;t!==pi;){let u=i/t,f=i%t,d=n-o*u,h=s-a*u;i=t,t=f,n=o,s=a,o=d,a=h}if(i!==Bt)throw new Error("invert: does not exist");return ce(n,e)}function qSe(r,e=Sr.P){let t=r.length,i=new Array(t),n=Bt;for(let s=0;s<t;s++)r[s]!==pi&&(i[s]=n,n=ce(n*r[s],e));n=zE(n,e);for(let s=t-1;s>=0;s--){if(r[s]===pi)continue;let o=ce(n*r[s],e);r[s]=ce(n*i[s],e),n=o}return r}function Xo(r,e){let{P:t}=Sr,i=r;for(;e-- >pi;)i*=i,i%=t;return i}function oU(r){let{P:e}=Sr,t=BigInt(5),i=BigInt(10),n=BigInt(20),s=BigInt(40),o=BigInt(80),c=r*r%e*r%e,u=Xo(c,nn)*c%e,f=Xo(u,Bt)*r%e,d=Xo(f,t)*f%e,h=Xo(d,i)*d%e,p=Xo(h,n)*h%e,y=Xo(p,s)*p%e,g=Xo(y,o)*y%e,w=Xo(g,o)*y%e,b=Xo(w,i)*d%e;return{pow_p_5_8:Xo(b,nn)*r%e,b2:c}}function HE(r,e){let t=ce(e*e*e),i=ce(t*t*e),n=oU(r*i).pow_p_5_8,s=ce(r*t*n),o=ce(e*s*s),a=s,c=ce(s*u2),u=o===r,f=o===ce(-r),d=o===ce(-r*u2);return u&&(s=a),(f||d)&&(s=c),gl(s)&&(s=ce(-s)),{isValid:u||f,value:s}}function aU(r){return HE(Bt,r)}async function $E(...r){let e=MSe(...r),t=await er.utils.sha512(e),i=Jf(t);return ce(i,Sr.n)}function USe(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function eu(r,e){let t=r instanceof Uint8Array?Uint8Array.from(r):nU(r);if(typeof e=="number"&&t.length!==e)throw new Error(`Expected ${e} bytes`);return t}function ed(r,e,t=!0){if(!e)throw new TypeError("Specify max value");if(typeof r=="bigint"){if(t){if(pi<r&&r<e)return r}else if(pi<=r&&r<FE)return r}if(typeof r=="number"&&Number.isSafeInteger(r)){if(t){if(0<r)return BigInt(r)}else if(0<=r)return BigInt(r)}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function cU(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function FSe(r){return Jf(cU(eu(r,32)))}async function l2(r){if(r=typeof r=="bigint"||typeof r=="number"?sU(ed(r,FE),32):eu(r),r.length!==32)throw new Error("Expected 32 bytes");let e=await er.utils.sha512(r),t=cU(e.slice(0,32)),i=e.slice(32,64),n=ce(Jf(t),Sr.n),s=Ur.BASE.multiply(n),o=s.toRawBytes();return{head:t,prefix:i,scalar:n,point:s,pointBytes:o}}async function KSe(r){return(await l2(r)).pointBytes}er.getPublicKey=KSe;async function VSe(r,e){r=eu(r);let{prefix:t,scalar:i,pointBytes:n}=await l2(e),s=await $E(t,r),o=Ur.BASE.multiply(s),a=await $E(o.toRawBytes(),n,r),c=ce(s+a*i,Sr.n);return new Zf(o,c).toRawBytes()}er.sign=VSe;async function zSe(r,e,t){e=eu(e),t instanceof Ur||(t=Ur.fromHex(t,!1)),r instanceof Zf||(r=Zf.fromHex(r,!1));let i=fr.BASE.multiplyForVerification(r.s),n=await $E(r.r.toRawBytes(),t.toRawBytes(),e),s=fr.fromAffine(t).multiplyUnsafe(n);return fr.fromAffine(r.r).add(s).subtract(i).multiplyUnsafe(Sr.h).equals(fr.ZERO)}er.verify=zSe;async function HSe(r,e){let{head:t}=await l2(r),i=Ur.fromHex(e).toX25519();return er.curve25519.scalarMult(t,i)}er.getSharedSecret=HSe;Ur.BASE._setWindowSize(8);function eb(r,e,t){let i=ce(r*(e-t));return e=ce(e-i),t=ce(t+i),[e,t]}function $Se(r,e){let{P:t}=Sr,i=ed(r,t),n=ed(e,t),s=BigInt(121665),o=i,a=Bt,c=pi,u=i,f=Bt,d=pi,h;for(let w=BigInt(255-1);w>=pi;w--){let b=n>>w&Bt;d^=b,h=eb(d,a,u),a=h[0],u=h[1],h=eb(d,c,f),c=h[0],f=h[1],d=b;let v=a+c,R=ce(v*v),k=a-c,C=ce(k*k),T=R-C,D=u+f,j=u-f,M=ce(j*v),se=ce(D*k);u=ce((M+se)**nn),f=ce(o*(M-se)**nn),a=ce(R*C),c=ce(T*(R+ce(s*T)))}h=eb(d,a,u),a=h[0],u=h[1],h=eb(d,c,f),c=h[0],f=h[1];let{pow_p_5_8:p,b2:y}=oU(c),g=ce(Xo(p,BigInt(3))*y);return ce(a*g)}function GSe(r){return Bp(ce(r,Sr.P),32)}function WSe(r){let e=eu(r,32);return e[31]&=127,Jf(e)}er.curve25519={BASE_POINT_U:"0900000000000000000000000000000000000000000000000000000000000000",scalarMult(r,e){let t=WSe(e),i=FSe(r),n=$Se(t,i);if(n===pi)throw new Error("Invalid private or public key received");return GSe(n)},scalarMultBase(r){return er.curve25519.scalarMult(r,er.curve25519.BASE_POINT_U)}};var ml={node:kSe.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};er.utils={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],bytesToHex:J4,getExtendedPublicKey:l2,mod:ce,randomBytes:(r=32)=>{if(ml.web)return ml.web.getRandomValues(new Uint8Array(r));if(ml.node){let{randomBytes:e}=ml.node;return new Uint8Array(e(r).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>er.utils.randomBytes(32),sha512:async r=>{if(ml.web){let e=await ml.web.subtle.digest("SHA-512",r.buffer);return new Uint8Array(e)}else{if(ml.node)return Uint8Array.from(ml.node.createHash("sha512").update(r).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(r=8,e=Ur.BASE){let t=e.equals(Ur.BASE)?e:new Ur(e.x,e.y);return t._setWindowSize(r),t.multiply(nn),t}}});var fU=m(bl=>{l();"use strict";var f2=uU(),YSe=32,XSe=64,tb=32;bl.publicKeyLength=YSe;bl.privateKeyLength=XSe;bl.generateKey=async function(){let r=f2.utils.randomPrivateKey(),e=await f2.getPublicKey(r);return{privateKey:lU(r,e),publicKey:e}};bl.generateKeyFromSeed=async function(r){if(r.length!==tb)throw new TypeError('"seed" must be 32 bytes in length.');if(!(r instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=r,t=await f2.getPublicKey(e);return{privateKey:lU(e,t),publicKey:t}};bl.hashAndSign=function(r,e){let t=r.slice(0,tb);return f2.sign(e,t)};bl.hashAndVerify=function(r,e,t){return f2.verify(e,t,r)};function lU(r,e){let t=new Uint8Array(bl.privateKeyLength);for(let i=0;i<tb;i++)t[i]=r[i],t[tb+i]=e[i];return t}});var gU=m((Zat,yU)=>{l();"use strict";var dU=Ys(),{equals:hU}=(hi(),hn),{sha256:pU}=(Si(),Ks),{base58btc:QSe}=(di(),Fo),{identity:ZSe}=(Hc(),By),mn=fU(),rb=P4(),JSe=Y4(),ib=class{constructor(e){this._key=Mp(e,mn.publicKeyLength)}async verify(e,t){return mn.hashAndVerify(this._key,t,e)}marshal(){return this._key}get bytes(){return rb.PublicKey.encode({Type:rb.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return hU(this.bytes,e.bytes)}async hash(){let{bytes:e}=await pU.digest(this.bytes);return e}},Lp=class{constructor(e,t){this._key=Mp(e,mn.privateKeyLength),this._publicKey=Mp(t,mn.publicKeyLength)}async sign(e){return mn.hashAndSign(this._key,e)}get public(){return new ib(this._publicKey)}marshal(){return this._key}get bytes(){return rb.PrivateKey.encode({Type:rb.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return hU(this.bytes,e.bytes)}async hash(){let{bytes:e}=await pU.digest(this.bytes);return e}async id(){let e=await ZSe.digest(this.public.bytes);return QSe.encode(e.bytes).substring(1)}async export(e,t="libp2p-key"){if(t==="libp2p-key")return JSe.export(this.bytes,e);throw dU(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function eAe(r){if(r.length>mn.privateKeyLength){r=Mp(r,mn.privateKeyLength+mn.publicKeyLength);let i=r.slice(0,mn.privateKeyLength),n=r.slice(mn.privateKeyLength,r.length);return new Lp(i,n)}r=Mp(r,mn.privateKeyLength);let e=r.slice(0,mn.privateKeyLength),t=r.slice(mn.publicKeyLength);return new Lp(e,t)}function tAe(r){return r=Mp(r,mn.publicKeyLength),new ib(r)}async function rAe(){let{privateKey:r,publicKey:e}=await mn.generateKey();return new Lp(r,e)}async function iAe(r){let{privateKey:e,publicKey:t}=await mn.generateKeyFromSeed(r);return new Lp(e,t)}function Mp(r,e){if(r=Uint8Array.from(r||[]),r.length!==e)throw dU(new Error(`Key must be a Uint8Array of length ${e}, got ${r.length}`),"ERR_INVALID_KEY_TYPE");return r}yU.exports={Ed25519PublicKey:ib,Ed25519PrivateKey:Lp,unmarshalEd25519PrivateKey:eAe,unmarshalEd25519PublicKey:tAe,generateKeyPair:rAe,generateKeyPairFromSeed:iAe}});var NU=m(qt=>{l();"use strict";var nAe=qt&&qt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(qt,"__esModule",{value:!0});qt.utils=qt.schnorr=qt.verify=qt.signSync=qt.sign=qt.getSharedSecret=qt.recoverPublicKey=qt.getPublicKey=qt.Signature=qt.Point=qt.CURVE=void 0;var sAe=nAe($f()),$t=BigInt(0),Qr=BigInt(1),yi=BigInt(2),d2=BigInt(3),oAe=BigInt(8),GE=yi**BigInt(256),Ar={a:$t,b:BigInt(7),P:GE-yi**BigInt(32)-BigInt(977),n:GE-BigInt("432420386565659656852420866394968145599"),h:Qr,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};qt.CURVE=Ar;function mU(r){let{a:e,b:t}=Ar,i=Ue(r*r),n=Ue(i*r);return Ue(n+e*r+t)}var nb=Ar.a===$t,Xt=class{constructor(e,t,i){this.x=e,this.y=t,this.z=i}static fromAffine(e){if(!(e instanceof tr))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new Xt(e.x,e.y,Qr)}static toAffineBatch(e){let t=lAe(e.map(i=>i.z));return e.map((i,n)=>i.toAffine(t[n]))}static normalizeZ(e){return Xt.toAffineBatch(e).map(Xt.fromAffine)}equals(e){let t=this,i=e,n=Ue(t.z*t.z),s=Ue(t.z*n),o=Ue(i.z*i.z),a=Ue(i.z*o);return Ue(t.x*o)===Ue(n*i.x)&&Ue(t.y*a)===Ue(s*i.y)}negate(){return new Xt(this.x,Ue(-this.y),this.z)}double(){let e=this.x,t=this.y,i=this.z,n=Ue(e**yi),s=Ue(t**yi),o=Ue(s**yi),a=Ue(yi*(Ue(Ue((e+s)**yi))-n-o)),c=Ue(d2*n),u=Ue(c**yi),f=Ue(u-yi*a),d=Ue(c*(a-f)-oAe*o),h=Ue(yi*t*i);return new Xt(f,d,h)}add(e){if(!(e instanceof Xt))throw new TypeError("JacobianPoint#add: expected JacobianPoint");let t=this.x,i=this.y,n=this.z,s=e.x,o=e.y,a=e.z;if(s===$t||o===$t)return this;if(t===$t||i===$t)return e;let c=Ue(n**yi),u=Ue(a**yi),f=Ue(t*u),d=Ue(s*c),h=Ue(i*a*u),p=Ue(Ue(o*n)*c),y=Ue(d-f),g=Ue(p-h);if(y===$t)return g===$t?this.double():Xt.ZERO;let w=Ue(y**yi),b=Ue(y*w),v=Ue(f*w),R=Ue(g**yi-b-yi*v),k=Ue(g*(v-R)-h*b),C=Ue(n*a*y);return new Xt(R,k,C)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let t=vU(e);if(!nb){let f=Xt.ZERO,d=this;for(;t>$t;)t&Qr&&(f=f.add(d)),d=d.double(),t>>=Qr;return f}let{k1neg:i,k1:n,k2neg:s,k2:o}=SU(t),a=Xt.ZERO,c=Xt.ZERO,u=this;for(;n>$t||o>$t;)n&Qr&&(a=a.add(u)),o&Qr&&(c=c.add(u)),u=u.double(),n>>=Qr,o>>=Qr;return i&&(a=a.negate()),s&&(c=c.negate()),c=new Xt(Ue(c.x*Ar.beta),c.y,c.z),a.add(c)}precomputeWindow(e){let t=nb?128/e+1:256/e+1,i=[],n=this,s=n;for(let o=0;o<t;o++){s=n,i.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(n),i.push(s);n=s.double()}return i}wNAF(e,t){!t&&this.equals(Xt.BASE)&&(t=tr.BASE);let i=t&&t._WINDOW_SIZE||1;if(256%i)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=t&&WE.get(t);n||(n=this.precomputeWindow(i),t&&i!==1&&(n=Xt.normalizeZ(n),WE.set(t,n)));let s=Xt.ZERO,o=Xt.ZERO,a=nb?128/i+1:256/i+1,c=2**(i-1),u=BigInt(2**i-1),f=2**i,d=BigInt(i);for(let h=0;h<a;h++){let p=h*c,y=Number(e&u);if(e>>=d,y>c&&(y-=f,e+=Qr),y===0){let g=n[p];h%2&&(g=g.negate()),o=o.add(g)}else{let g=n[p+Math.abs(y)-1];y<0&&(g=g.negate()),s=s.add(g)}}return{p:s,f:o}}multiply(e,t){let i=vU(e),n,s;if(nb){let{k1neg:o,k1:a,k2neg:c,k2:u}=SU(i),{p:f,f:d}=this.wNAF(a,t),{p:h,f:p}=this.wNAF(u,t);o&&(f=f.negate()),c&&(h=h.negate()),h=new Xt(Ue(h.x*Ar.beta),h.y,h.z),n=f.add(h),s=d.add(p)}else{let{p:o,f:a}=this.wNAF(i,t);n=o,s=a}return Xt.normalizeZ([n,s])[0]}toAffine(e=y2(this.z)){let t=e**yi,i=Ue(this.x*t),n=Ue(this.y*t*e);return new tr(i,n)}};Xt.BASE=new Xt(Ar.Gx,Ar.Gy,Qr);Xt.ZERO=new Xt($t,Qr,$t);var WE=new WeakMap,tr=class{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,WE.delete(this)}static fromCompressedHex(e){let t=e.length===32,i=Qs(t?e:e.slice(1));if(!ab(i))throw new Error("Point is not on curve");let n=mU(i),s=uAe(n),o=(s&Qr)===Qr;t?o&&(s=Ue(-s)):(e[0]&1)==1!==o&&(s=Ue(-s));let a=new tr(i,s);return a.assertValidity(),a}static fromUncompressedHex(e){let t=Qs(e.slice(1,33)),i=Qs(e.slice(33)),n=new tr(t,i);return n.assertValidity(),n}static fromHex(e){let t=ru(e),i=t[0];if(t.length===32||t.length===33&&(i===2||i===3))return this.fromCompressedHex(t);if(t.length===65&&i===4)return this.fromUncompressedHex(t);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${t.length}`)}static fromPrivateKey(e){return tr.BASE.multiply(g2(e))}static fromSignature(e,t,i){e=ru(e);let n=AU(e),{r:s,s:o}=xU(t);if(i!==0&&i!==1)throw new Error("Cannot recover signature: invalid recovery bit");if(n===$t)throw new Error("Cannot recover signature: msgHash cannot be 0");let a=2+(i&1),c=tr.fromHex(`0${a}${tu(s)}`),u=Xt.fromAffine(c).multiplyUnsafe(o),f=Xt.BASE.multiply(n),d=y2(s,Ar.n),p=u.subtract(f).multiplyUnsafe(d).toAffine();return p.assertValidity(),p}toRawBytes(e=!1){return wl(this.toHex(e))}toHex(e=!1){let t=tu(this.x);return e?`${this.y&Qr?"03":"02"}${t}`:`04${t}${tu(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:t,y:i}=this;if(!ab(t)||!ab(i))throw new Error(e);let n=Ue(i*i),s=mU(t);if(Ue(n-s)!==$t)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new tr(this.x,Ue(-this.y))}double(){return Xt.fromAffine(this).double().toAffine()}add(e){return Xt.fromAffine(this).add(Xt.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Xt.fromAffine(this).multiply(e,this).toAffine()}};qt.Point=tr;tr.BASE=new tr(Ar.Gx,Ar.Gy);tr.ZERO=new tr($t,$t);function bU(r){return Number.parseInt(r[0],16)>=8?"00"+r:r}function wU(r){if(r.length<2||r[0]!==2)throw new Error(`Invalid signature integer tag: ${jp(r)}`);let e=r[1],t=r.subarray(2,e+2);if(!e||t.length!==e)throw new Error("Invalid signature integer: wrong length");if(t[0]===0&&t[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Qs(t),left:r.subarray(e+2)}}function aAe(r){if(r.length<2||r[0]!=48)throw new Error(`Invalid signature tag: ${jp(r)}`);if(r[1]!==r.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:t}=wU(r.subarray(2)),{data:i,left:n}=wU(t);if(n.length)throw new Error(`Invalid signature: left bytes after parsing: ${jp(n)}`);return{r:e,s:i}}var $a=class{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromCompact(e){let t=h2(e),i="Signature.fromCompact";if(typeof e!="string"&&!t)throw new TypeError(`${i}: Expected string or Uint8Array`);let n=t?jp(e):e;if(n.length!==128)throw new Error(`${i}: Expected 64-byte hex`);return new $a(sb(n.slice(0,64)),sb(n.slice(64,128)))}static fromDER(e){let t=h2(e);if(typeof e!="string"&&!t)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:i,s:n}=aAe(t?e:wl(e));return new $a(i,n)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:t}=this;if(!td(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!td(t))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=Ar.n>>Qr;return this.s>e}normalizeS(){return this.hasHighS()?new $a(this.r,Ar.n-this.s):this}toDERRawBytes(e=!1){return wl(this.toDERHex(e))}toDERHex(e=!1){let t=bU(p2(this.s));if(e)return t;let i=bU(p2(this.r)),n=p2(i.length/2),s=p2(t.length/2);return`30${p2(i.length/2+t.length/2+4)}02${n}${i}02${s}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return wl(this.toCompactHex())}toCompactHex(){return tu(this.r)+tu(this.s)}};qt.Signature=$a;function YE(...r){if(!r.every(h2))throw new Error("Uint8Array list expected");if(r.length===1)return r[0];let e=r.reduce((i,n)=>i+n.length,0),t=new Uint8Array(e);for(let i=0,n=0;i<r.length;i++){let s=r[i];t.set(s,n),n+=s.length}return t}function h2(r){return r instanceof Uint8Array}var cAe=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function jp(r){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let t=0;t<r.length;t++)e+=cAe[r[t]];return e}function tu(r){if(r>GE)throw new Error("Expected number < 2^256");return r.toString(16).padStart(64,"0")}function _U(r){return wl(tu(r))}function p2(r){let e=r.toString(16);return e.length&1?`0${e}`:e}function sb(r){if(typeof r!="string")throw new TypeError("hexToNumber: expected string, got "+typeof r);return BigInt(`0x${r}`)}function wl(r){if(typeof r!="string")throw new TypeError("hexToBytes: expected string, got "+typeof r);if(r.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+r.length);let e=new Uint8Array(r.length/2);for(let t=0;t<e.length;t++){let i=t*2,n=r.slice(i,i+2),s=Number.parseInt(n,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[t]=s}return e}function Qs(r){return sb(jp(r))}function ru(r){return r instanceof Uint8Array?Uint8Array.from(r):wl(r)}function vU(r){if(typeof r=="number"&&Number.isSafeInteger(r)&&r>0)return BigInt(r);if(typeof r=="bigint"&&td(r))return r;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function Ue(r,e=Ar.P){let t=r%e;return t>=0?t:e+t}function Zs(r,e){let{P:t}=Ar,i=r;for(;e-- >$t;)i*=i,i%=t;return i}function uAe(r){let{P:e}=Ar,t=BigInt(6),i=BigInt(11),n=BigInt(22),s=BigInt(23),o=BigInt(44),a=BigInt(88),c=r*r*r%e,u=c*c*r%e,f=Zs(u,d2)*u%e,d=Zs(f,d2)*u%e,h=Zs(d,yi)*c%e,p=Zs(h,i)*h%e,y=Zs(p,n)*p%e,g=Zs(y,o)*y%e,w=Zs(g,a)*g%e,b=Zs(w,o)*y%e,v=Zs(b,d2)*u%e,R=Zs(v,s)*p%e,k=Zs(R,t)*c%e;return Zs(k,yi)}function y2(r,e=Ar.P){if(r===$t||e<=$t)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=Ue(r,e),i=e,n=$t,s=Qr,o=Qr,a=$t;for(;t!==$t;){let u=i/t,f=i%t,d=n-o*u,h=s-a*u;i=t,t=f,n=o,s=a,o=d,a=h}if(i!==Qr)throw new Error("invert: does not exist");return Ue(n,e)}function lAe(r,e=Ar.P){let t=r.length,i=new Array(t),n=Qr;for(let s=0;s<t;s++)r[s]!==$t&&(i[s]=n,n=Ue(n*r[s],e));n=y2(n,e);for(let s=t-1;s>=0;s--){if(r[s]===$t)continue;let o=Ue(n*r[s],e);r[s]=Ue(n*i[s],e),n=o}return r}var EU=(r,e)=>(r+e/yi)/e,ob=yi**BigInt(128);function SU(r){let{n:e}=Ar,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),i=-Qr*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=t,o=EU(s*r,e),a=EU(-i*r,e),c=Ue(r-o*t-a*n,e),u=Ue(-o*i-a*s,e),f=c>ob,d=u>ob;if(f&&(c=e-c),d&&(u=e-u),c>ob||u>ob)throw new Error("splitScalarEndo: Endomorphism failed");return{k1neg:f,k1:c,k2neg:d,k2:u}}function AU(r){let{n:e}=Ar,i=r.length*8-256,n=Qs(r);return i>0&&(n=n>>BigInt(i)),n>=e&&(n-=e),n}var XE=class{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return qt.utils.hmacSha256(this.k,...e)}hmacSync(...e){if(typeof qt.utils.hmacSha256Sync!="function")throw new Error("utils.hmacSha256Sync is undefined, you need to set it");let t=qt.utils.hmacSha256Sync(this.k,...e);if(t instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");return t}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.incr(),this.v=this.hmacSync(this.v),this.v}};function td(r){return $t<r&&r<Ar.n}function ab(r){return $t<r&&r<Ar.P}function RU(r,e,t){let i=Qs(r);if(!td(i))return;let{n}=Ar,s=tr.BASE.multiply(i),o=Ue(s.x,n);if(o===$t)return;let a=Ue(y2(i,n)*Ue(e+t*o,n),n);if(a===$t)return;let c=new $a(o,a),u=(s.x===c.r?0:2)|Number(s.y&Qr);return{sig:c,recovery:u}}function g2(r){let e;if(typeof r=="bigint")e=r;else if(typeof r=="number"&&Number.isSafeInteger(r)&&r>0)e=BigInt(r);else if(typeof r=="string"){if(r.length!==64)throw new Error("Expected 32 bytes of private key");e=sb(r)}else if(h2(r)){if(r.length!==32)throw new Error("Expected 32 bytes of private key");e=Qs(r)}else throw new TypeError("Expected valid private key");if(!td(e))throw new Error("Expected private key: 0 < key < n");return e}function QE(r){return r instanceof tr?(r.assertValidity(),r):tr.fromHex(r)}function xU(r){if(r instanceof $a)return r.assertValidity(),r;try{return $a.fromDER(r)}catch(e){return $a.fromCompact(r)}}function fAe(r,e=!1){return tr.fromPrivateKey(r).toRawBytes(e)}qt.getPublicKey=fAe;function dAe(r,e,t){return tr.fromSignature(r,e,t).toRawBytes()}qt.recoverPublicKey=dAe;function IU(r){let e=h2(r),t=typeof r=="string",i=(e||t)&&r.length;return e?i===33||i===65:t?i===66||i===130:r instanceof tr}function hAe(r,e,t=!1){if(IU(r))throw new TypeError("getSharedSecret: first arg must be private key");if(!IU(e))throw new TypeError("getSharedSecret: second arg must be public key");let i=QE(e);return i.assertValidity(),i.multiply(g2(r)).toRawBytes(t)}qt.getSharedSecret=hAe;function TU(r){let e=r.length>32?r.slice(0,32):r;return Qs(e)}function pAe(r){let e=TU(r),t=Ue(e,Ar.n);return PU(t<$t?e:t)}function PU(r){if(typeof r!="bigint")throw new Error("Expected bigint");let e=tu(r);return wl(e)}function CU(r,e,t){if(r==null)throw new Error(`sign: expected valid message hash, not "${r}"`);let i=ru(r),n=g2(e),s=[PU(n),pAe(i)];if(t!=null){t===!0&&(t=qt.utils.randomBytes(32));let c=ru(t);if(c.length!==32)throw new Error("sign: Expected 32 bytes of extra data");s.push(c)}let o=YE(...s),a=TU(i);return{seed:o,m:a,d:n}}function OU(r,e){let{sig:t,recovery:i}=r,{canonical:n,der:s,recovered:o}=Object.assign({canonical:!0,der:!0},e);n&&t.hasHighS()&&(t=t.normalizeS(),i^=1);let a=s?t.toDERRawBytes():t.toCompactRawBytes();return o?[a,i]:a}async function yAe(r,e,t={}){let{seed:i,m:n,d:s}=CU(r,e,t.extraEntropy),o,a=new XE;for(await a.reseed(i);!(o=RU(await a.generate(),n,s));)await a.reseed();return OU(o,t)}qt.sign=yAe;function gAe(r,e,t={}){let{seed:i,m:n,d:s}=CU(r,e,t.extraEntropy),o,a=new XE;for(a.reseedSync(i);!(o=RU(a.generateSync(),n,s));)a.reseedSync();return OU(o,t)}qt.signSync=gAe;var mAe={strict:!0};function bAe(r,e,t,i=mAe){let n;try{n=xU(r),e=ru(e)}catch(b){return!1}let{r:s,s:o}=n;if(i.strict&&n.hasHighS())return!1;let a=AU(e);if(a===$t)return!1;let c;try{c=Xt.fromAffine(QE(t))}catch(b){return!1}let{n:u}=Ar,f=y2(o,u),d=Ue(a*f,u),h=Ue(s*f,u),p=Xt.BASE.multiply(d),y=c.multiplyUnsafe(h),g=p.add(y).toAffine();return Ue(g.x,u)===s}qt.verify=bAe;async function ZE(r,...e){let t=new Uint8Array(r.split("").map(s=>s.charCodeAt(0))),i=await qt.utils.sha256(t),n=await qt.utils.sha256(YE(i,i,...e));return Qs(n)}async function kU(r,e,t){let i=_U(r),n=await ZE("BIP0340/challenge",i,e.toRawX(),t);return Ue(n,Ar.n)}function JE(r){return Ue(r.y,yi)===$t}var rd=class{constructor(e,t){if(this.r=e,this.s=t,!ab(e)||!td(t))throw new Error("Invalid signature")}static fromHex(e){let t=ru(e);if(t.length!==64)throw new TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${t.length}`);let i=Qs(t.slice(0,32)),n=Qs(t.slice(32,64));return new rd(i,n)}toHex(){return tu(this.r)+tu(this.s)}toRawBytes(){return wl(this.toHex())}};function wAe(r){return tr.fromPrivateKey(r).toRawX()}async function _Ae(r,e,t=qt.utils.randomBytes()){if(r==null)throw new TypeError(`sign: Expected valid message, not "${r}"`);let{n:i}=Ar,n=ru(r),s=g2(e),o=ru(t);if(o.length!==32)throw new TypeError("sign: Expected 32 bytes of aux randomness");let a=tr.fromPrivateKey(s),c=JE(a)?s:i-s,u=await ZE("BIP0340/aux",o),f=c^u,d=await ZE("BIP0340/nonce",_U(f),a.toRawX(),n),h=Ue(d,i);if(h===$t)throw new Error("sign: Creation of signature failed. k is zero");let p=tr.fromPrivateKey(h),y=JE(p)?h:i-h,g=await kU(p.x,a,n),w=new rd(p.x,Ue(y+g*c,i));if(!await DU(w.toRawBytes(),n,a.toRawX()))throw new Error("sign: Invalid signature produced");return w.toRawBytes()}async function DU(r,e,t){let i=r instanceof rd?r:rd.fromHex(r),n=ru(e),s=QE(t),o=await kU(i.r,s,n),a=tr.fromPrivateKey(i.s),c=s.multiply(o),u=a.subtract(c);return!(u.equals(tr.BASE)||!JE(u)||u.x!==i.r)}qt.schnorr={Signature:rd,getPublicKey:wAe,sign:_Ae,verify:DU};tr.BASE._setWindowSize(8);var ws={node:sAe.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};qt.utils={isValidPrivateKey(r){try{return g2(r),!0}catch(e){return!1}},randomBytes:(r=32)=>{if(ws.web)return ws.web.getRandomValues(new Uint8Array(r));if(ws.node){let{randomBytes:e}=ws.node;return Uint8Array.from(e(r))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let r=8;for(;r--;){let e=qt.utils.randomBytes(32),t=Qs(e);if(td(t)&&t!==Qr)return e}throw new Error("Valid private key was not found in 8 iterations. PRNG is broken")},bytesToHex:jp,mod:Ue,sha256:async r=>{if(ws.web){let e=await ws.web.subtle.digest("SHA-256",r.buffer);return new Uint8Array(e)}else if(ws.node){let{createHash:e}=ws.node;return Uint8Array.from(e("sha256").update(r).digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(r,...e)=>{if(ws.web){let t=await ws.web.subtle.importKey("raw",r,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),i=YE(...e),n=await ws.web.subtle.sign("HMAC",t,i);return new Uint8Array(n)}else if(ws.node){let{createHmac:t}=ws.node,i=t("sha256",r);return e.forEach(n=>i.update(n)),Uint8Array.from(i.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,precompute(r=8,e=tr.BASE){let t=e===tr.BASE?e:new tr(e.x,e.y);return t._setWindowSize(r),t.multiply(d2),t}}});var MU=m((ect,LU)=>{l();"use strict";var m2=Ys(),_l=NU(),{sha256:BU}=(Si(),Ks);LU.exports=()=>{let r=32;function e(){return _l.utils.randomPrivateKey()}async function t(u,f){let{digest:d}=await BU.digest(f);try{return await _l.sign(d,u)}catch(h){throw m2(h,"ERR_INVALID_INPUT")}}async function i(u,f,d){try{let{digest:h}=await BU.digest(d);return _l.verify(f,h,u)}catch(h){throw m2(h,"ERR_INVALID_INPUT")}}function n(u){return _l.Point.fromHex(u).toRawBytes(!0)}function s(u){return _l.Point.fromHex(u).toRawBytes(!1)}function o(u){try{_l.getPublicKey(u,!0)}catch(f){throw m2(f,"ERR_INVALID_PRIVATE_KEY")}}function a(u){try{_l.Point.fromHex(u)}catch(f){throw m2(f,"ERR_INVALID_PUBLIC_KEY")}}function c(u){try{return _l.getPublicKey(u,!0)}catch(f){throw m2(f,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:e,privateKeyLength:r,hashAndSign:t,hashAndVerify:i,compressPublicKey:n,decompressPublicKey:s,validatePrivateKey:o,validatePublicKey:a,computePublicKey:c}}});var FU=m((tct,UU)=>{l();"use strict";var{sha256:jU}=(Si(),Ks),vAe=Ys(),{equals:qU}=(hi(),hn),{toString:EAe}=(et(),or),SAe=Y4();UU.exports=(r,e,t)=>{t=t||MU()();class i{constructor(u){t.validatePublicKey(u),this._key=u}verify(u,f){return t.hashAndVerify(this._key,f,u)}marshal(){return t.compressPublicKey(this._key)}get bytes(){return r.PublicKey.encode({Type:r.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return qU(this.bytes,u.bytes)}async hash(){let{bytes:u}=await jU.digest(this.bytes);return u}}class n{constructor(u,f){this._key=u,this._publicKey=f||t.computePublicKey(u),t.validatePrivateKey(this._key),t.validatePublicKey(this._publicKey)}sign(u){return t.hashAndSign(this._key,u)}get public(){return new i(this._publicKey)}marshal(){return this._key}get bytes(){return r.PrivateKey.encode({Type:r.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return qU(this.bytes,u.bytes)}async hash(){let{bytes:u}=await jU.digest(this.bytes);return u}async id(){let u=await this.public.hash();return EAe(u,"base58btc")}async export(u,f="libp2p-key"){if(f==="libp2p-key")return SAe.export(this.bytes,u);throw vAe(new Error(`export format '${f}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(c){return new n(c)}function o(c){return new i(c)}async function a(){let c=await t.generateKey();return new n(c)}return{Secp256k1PublicKey:i,Secp256k1PrivateKey:n,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:a}}});var VU=m((rct,KU)=>{l();"use strict";KU.exports={SHA1:20,SHA256:32,SHA512:64}});var e9=m(HU=>{l();"use strict";var zU=i2(),AAe=VU(),RAe={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},xAe=async(r,e)=>{let t=await zU.get().subtle.sign({name:"HMAC"},r,e);return new Uint8Array(t,t.byteOffset,t.byteLength)};HU.create=async function(r,e){let t=RAe[r],i=await zU.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:t}},!1,["sign"]);return{async digest(n){return xAe(i,n)},length:AAe[r]}}});var XU=m((nct,YU)=>{l();"use strict";var $U=Ys(),{concat:GU}=(Ri(),Cn),{fromString:IAe}=(at(),Xr),TAe=e9(),WU={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};YU.exports=async(r,e,t)=>{let i=WU[r];if(!i){let v=Object.keys(WU).join(" / ");throw $U(new Error(`unknown cipher type '${r}'. Must be ${v}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw $U(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let n=i.keySize,s=i.ivSize,o=20,a=IAe("key expansion"),c=2*(s+n+o),u=await TAe.create(e,t),f=await u.digest(a),d=[],h=0;for(;h<c;){let v=await u.digest(GU([f,a])),R=v.length;h+R>c&&(R=c-h),d.push(v),h+=R,f=await u.digest(f)}let p=c/2,y=GU(d),g=y.slice(0,p),w=y.slice(p,c),b=v=>({iv:v.slice(0,s),cipherKey:v.slice(s,s+n),macKey:v.slice(s+n)});return{k1:b(g),k2:b(w)}}});var ZU=m((sct,QU)=>{l();"use strict";var PAe=Ys();QU.exports=function(r,e){if(!r.includes(e)){let t=r.join(" / ");throw PAe(new Error(`Unknown curve: ${e}. Must be ${t}`),"ERR_INVALID_CURVE")}}});var nF=m(iF=>{l();"use strict";var CAe=Ys(),b2=i2(),{base64urlToBuffer:JU}=W4(),OAe=ZU(),{toString:t9}=(et(),or),{concat:kAe}=(Ri(),Cn),{equals:DAe}=(hi(),hn),eF={"P-256":256,"P-384":384,"P-521":521};iF.generateEphmeralKeyPair=async function(r){OAe(Object.keys(eF),r);let e=await b2.get().subtle.generateKey({name:"ECDH",namedCurve:r},!0,["deriveBits"]),t=async(n,s)=>{let o;s?o=await b2.get().subtle.importKey("jwk",BAe(r,s),{name:"ECDH",namedCurve:r},!1,["deriveBits"]):o=e.privateKey;let a=[await b2.get().subtle.importKey("jwk",rF(r,n),{name:"ECDH",namedCurve:r},!1,[]),o],c=await b2.get().subtle.deriveBits({name:"ECDH",namedCurve:r,public:a[0]},a[1],eF[r]);return new Uint8Array(c,c.byteOffset,c.byteLength)},i=await b2.get().subtle.exportKey("jwk",e.publicKey);return{key:NAe(i),genSharedKey:t}};var tF={"P-256":32,"P-384":48,"P-521":66};function NAe(r){let e=tF[r.crv];return kAe([Uint8Array.from([4]),JU(r.x,e),JU(r.y,e)],1+e*2)}function rF(r,e){let t=tF[r];if(DAe(!e.slice(0,1),Uint8Array.from([4])))throw CAe(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:r,x:t9(e.slice(1,t+1),"base64url"),y:t9(e.slice(1+t),"base64url"),ext:!0}}var BAe=(r,e)=>({...rF(r,e.public),d:t9(e.private,"base64url")})});var oF=m((act,sF)=>{l();"use strict";var LAe=nF();sF.exports=async r=>LAe.generateEphmeralKeyPair(r)});var ub=m((cct,cF)=>{l();"use strict";var Ga=P4();fl();LE();var r9=At(),w2=Ys(),{fromString:MAe}=(at(),Xr),jAe=Cq(),Js={rsa:tU(),ed25519:gU(),secp256k1:FU()(Ga,s2())},cb={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function qp(r){let e=Js[r.toLowerCase()];if(!e){let t=Object.keys(Js).join(" / ");throw w2(new Error(`invalid or unsupported key type ${r}. Must be ${t}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var qAe=async(r,e)=>qp(r).generateKeyPair(e),UAe=async(r,e,t)=>{let i=qp(r);if(r.toLowerCase()!=="ed25519")throw w2(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return i.generateKeyPairFromSeed(e,t)},FAe=r=>{let e=Ga.PublicKey.decode(r),t=e.Data;switch(e.Type){case Ga.KeyType.RSA:return Js.rsa.unmarshalRsaPublicKey(t);case Ga.KeyType.Ed25519:return Js.ed25519.unmarshalEd25519PublicKey(t);case Ga.KeyType.Secp256k1:if(Js.secp256k1)return Js.secp256k1.unmarshalSecp256k1PublicKey(t);throw w2(new Error(cb.message),cb.code);default:qp(e.Type)}},KAe=(r,e)=>(e=(e||"rsa").toLowerCase(),qp(e),r.bytes),aF=async r=>{let e=Ga.PrivateKey.decode(r),t=e.Data;switch(e.Type){case Ga.KeyType.RSA:return Js.rsa.unmarshalRsaPrivateKey(t);case Ga.KeyType.Ed25519:return Js.ed25519.unmarshalEd25519PrivateKey(t);case Ga.KeyType.Secp256k1:if(Js.secp256k1)return Js.secp256k1.unmarshalSecp256k1PrivateKey(t);throw w2(new Error(cb.message),cb.code);default:qp(e.Type)}},VAe=(r,e)=>(e=(e||"rsa").toLowerCase(),qp(e),r.bytes),zAe=async(r,e)=>{try{let n=await jAe.import(r,e);return aF(n)}catch(n){}let t=r9.pki.decryptRsaPrivateKey(r,e);if(t===null)throw w2(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let i=r9.asn1.toDer(r9.pki.privateKeyToAsn1(t));return i=MAe(i.getBytes(),"ascii"),Js.rsa.unmarshalRsaPrivateKey(i)};cF.exports={supportedKeys:Js,keysPBM:Ga,keyStretcher:XU(),generateEphemeralKeyPair:oF(),generateKeyPair:qAe,generateKeyPairFromSeed:UAe,unmarshalPublicKey:FAe,marshalPublicKey:KAe,unmarshalPrivateKey:aF,marshalPrivateKey:VAe,import:zAe}});var lb=m((uct,i9)=>{l();"use strict";function HAe(r,{className:e,symbolName:t}){let i=Symbol.for(t),n={[e]:class extends r{constructor(...s){super(...s);Object.defineProperty(this,i,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return n[`is${e}`]=s=>!!(s&&s[i]),n}function $Ae(r,{className:e,symbolName:t,withoutNew:i}){let n=Symbol.for(t),s={[e]:function(...o){if(i&&!(this instanceof s))return new s(...o);let a=r.call(this,...o)||this;return a&&!a[n]&&Object.defineProperty(a,n,{value:!0}),a}}[e];return s.prototype=Object.create(r.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=o=>!!(o&&o[n]),s}i9.exports=HAe;i9.exports.proto=$Ae});var fF=m((lct,lF)=>{l();"use strict";var Up=Br(),uF=Up.Reader,GAe=Up.Writer,Mi=Up.util,_2=Up.roots["libp2p-peer-id"]||(Up.roots["libp2p-peer-id"]={});_2.PeerIdProto=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.id=Mi.newBuffer([]),r.prototype.pubKey=Mi.newBuffer([]),r.prototype.privKey=Mi.newBuffer([]),r.encode=function(t,i){return i||(i=GAe.create()),i.uint32(10).bytes(t.id),t.pubKey!=null&&Object.hasOwnProperty.call(t,"pubKey")&&i.uint32(18).bytes(t.pubKey),t.privKey!=null&&Object.hasOwnProperty.call(t,"privKey")&&i.uint32(26).bytes(t.privKey),i},r.decode=function(t,i){t instanceof uF||(t=uF.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new _2.PeerIdProto;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.id=t.bytes();break;case 2:s.pubKey=t.bytes();break;case 3:s.privKey=t.bytes();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("id"))throw Mi.ProtocolError("missing required 'id'",{instance:s});return s},r.fromObject=function(t){if(t instanceof _2.PeerIdProto)return t;var i=new _2.PeerIdProto;return t.id!=null&&(typeof t.id=="string"?Mi.base64.decode(t.id,i.id=Mi.newBuffer(Mi.base64.length(t.id)),0):t.id.length&&(i.id=t.id)),t.pubKey!=null&&(typeof t.pubKey=="string"?Mi.base64.decode(t.pubKey,i.pubKey=Mi.newBuffer(Mi.base64.length(t.pubKey)),0):t.pubKey.length&&(i.pubKey=t.pubKey)),t.privKey!=null&&(typeof t.privKey=="string"?Mi.base64.decode(t.privKey,i.privKey=Mi.newBuffer(Mi.base64.length(t.privKey)),0):t.privKey.length&&(i.privKey=t.privKey)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.id="":(n.id=[],i.bytes!==Array&&(n.id=Mi.newBuffer(n.id))),i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=Mi.newBuffer(n.pubKey))),i.bytes===String?n.privKey="":(n.privKey=[],i.bytes!==Array&&(n.privKey=Mi.newBuffer(n.privKey)))),t.id!=null&&t.hasOwnProperty("id")&&(n.id=i.bytes===String?Mi.base64.encode(t.id,0,t.id.length):i.bytes===Array?Array.prototype.slice.call(t.id):t.id),t.pubKey!=null&&t.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?Mi.base64.encode(t.pubKey,0,t.pubKey.length):i.bytes===Array?Array.prototype.slice.call(t.pubKey):t.pubKey),t.privKey!=null&&t.hasOwnProperty("privKey")&&(n.privKey=i.bytes===String?Mi.base64.encode(t.privKey,0,t.privKey.length):i.bytes===Array?Array.prototype.slice.call(t.privKey):t.privKey),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Up.util.toJSONOptions)},r}();lF.exports=_2});var st=m((bn,wF)=>{l();"use strict";var{CID:n9}=(we(),Kc),WAe=(rn(),Fc),YAe=(Ly(),r4),XAe=(di(),Fo),QAe=(el(),jf),{base58btc:s9}=(di(),Fo),{base32:ZAe}=(rn(),Fc),{base16:dF}=(_7(),t4),v2=(tn(),rp),Wa=ub(),JAe=lb(),{PeerIdProto:hF}=fF(),{equals:id}=(hi(),hn),{fromString:E2}=(at(),Xr),{toString:eRe}=(et(),or),{identity:fb}=(Hc(),By),pF={...WAe,...YAe,...XAe,...QAe},tRe=Object.keys(pF).reduce((r,e)=>r.or(pF[e]),ZAe.decoder),rRe=112,yF=114,gF=class{constructor(e,t,i){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(t&&i&&!id(t.public.bytes,i.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=s9.encode(this.id).substring(1),this._privKey=t,this._pubKey=i}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=v2.decode(this.id);e.code===fb.code&&(this._pubKey=Wa.unmarshalPublicKey(e.digest))}catch(e){}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return Wa.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return Wa.marshalPrivateKey(this.privKey)}marshal(e){return hF.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()}).finish()}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let t=6;return e.length<t&&(t=e.length),"<peer.ID "+e.substr(0,t)+">"}toJSON(){return{id:this.toB58String(),privKey:bF(this.marshalPrivKey()),pubKey:bF(this.marshalPubKey())}}toHexString(){return dF.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=n9.createV1(yF,v2.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:e.toString(),enumerable:!1})}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return id(this.id,e);if(e.id)return id(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&id(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(v2.decode(this.id).code===fb.code)return!0}catch(e){}return!1}},Ya=JAe(gF,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});bn=wF.exports=Ya;var S2=r=>r.bytes.length<=42?v2.create(fb.code,r.bytes).bytes:r.hash(),o9=async(r,e)=>{let t=await S2(e);return new Ya(t,r,e)};bn.create=async r=>{r=r||{},r.bits=r.bits||2048,r.keyType=r.keyType||"RSA";let e=await Wa.generateKeyPair(r.keyType,r.bits);return o9(e,e.public)};bn.createFromHexString=r=>new Ya(dF.decode("f"+r));bn.createFromBytes=r=>{try{let e=n9.decode(r);if(!mF(e))throw new Error("Supplied PeerID CID is invalid");return bn.createFromCID(e)}catch{if(v2.decode(r).code!==fb.code)throw new Error("Supplied PeerID CID is invalid");return new Ya(r)}};bn.createFromB58String=r=>bn.createFromBytes(s9.decode("z"+r));var mF=r=>r.code===yF||r.code===rRe;bn.createFromCID=r=>{if(r=n9.asCID(r),!r||!mF(r))throw new Error("Supplied PeerID CID is invalid");return new Ya(r.multihash.bytes)};bn.createFromPubKey=async r=>{let e=r;if(typeof e=="string"&&(e=E2(r,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let t=await Wa.unmarshalPublicKey(e);return o9(void 0,t)};bn.createFromPrivKey=async r=>{if(typeof r=="string"&&(r=E2(r,"base64pad")),!(r instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await Wa.unmarshalPrivateKey(r);return o9(e,e.public)};bn.createFromJSON=async r=>{let e=s9.decode("z"+r.id),t=r.privKey&&E2(r.privKey,"base64pad"),i=r.pubKey&&E2(r.pubKey,"base64pad"),n=i&&await Wa.unmarshalPublicKey(i);if(!t)return new Ya(e,void 0,n);let s=await Wa.unmarshalPrivateKey(t),o=await S2(s.public),a;if(n&&(a=await S2(n)),n&&!id(o,a))throw new Error("Public and private key do not match");if(e&&!id(o,e))throw new Error("Id and private key do not match");return new Ya(e,s,n)};bn.createFromProtobuf=async r=>{typeof r=="string"&&(r=E2(r,"base16"));let{id:e,privKey:t,pubKey:i}=hF.decode(r);t=t?await Wa.unmarshalPrivateKey(t):!1,i=i?await Wa.unmarshalPublicKey(i):!1;let n,s;if(t&&(s=await S2(t.public)),i&&(n=await S2(i)),t){if(i&&!id(s,n))throw new Error("Public and private key do not match");return new Ya(s,t,t.public)}if(i)return new Ya(n,void 0,i);if(e)return new Ya(e);throw new Error("Protobuf did not contain any usable key material")};bn.parse=r=>((r.charAt(0)==="1"||r.charAt(0)==="Q")&&(r=`z${r}`),bn.createFromBytes(tRe.decode(r)));bn.isPeerId=r=>Boolean(typeof r=="object"&&r._id&&r._idB58String);function bF(r){if(r)return eRe(r,"base64pad")}});var Zn=m((yct,EF)=>{l();"use strict";var nRe=async r=>{let e;for await(let t of r)e=t;return e};EF.exports=nRe});var kF=m((Vct,OF)=>{l();"use strict";function CF(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function sRe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return CF(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),CF(new n,t)}}OF.exports=sRe});var l9={};Pt(l9,{abortedError:()=>oRe,dbDeleteFailedError:()=>x2,dbOpenFailedError:()=>R2,dbWriteFailedError:()=>I2,notFoundError:()=>xi});function R2(r){return r=r||new Error("Cannot open database"),(0,Kp.default)(r,"ERR_DB_OPEN_FAILED")}function x2(r){return r=r||new Error("Delete failed"),(0,Kp.default)(r,"ERR_DB_DELETE_FAILED")}function I2(r){return r=r||new Error("Write failed"),(0,Kp.default)(r,"ERR_DB_WRITE_FAILED")}function xi(r){return r=r||new Error("Not Found"),(0,Kp.default)(r,"ERR_NOT_FOUND")}function oRe(r){return r=r||new Error("Aborted"),(0,Kp.default)(r,"ERR_ABORTED")}var Kp,eo=qe(()=>{l();Kp=A(kF())});var DF=m((Hct,f9)=>{l();var zct=function(){typeof f9!="undefined"&&(f9.exports=b);var r=24*3600,e=3200,t=(365*400+97)*e/400,i=r*t,n=i*1e3,s=1e3*1e4*1e4*r,o=16777216,a=65536*65536,c=1e3*1e3,u=1e3*1e3*1e3,f="000000000",d=Math.trunc||Me,h=b.prototype;b.fromDate=M,b.fromInt64BE=ke(0,1,2,3,0,4),b.fromInt64LE=ke(3,2,1,0,4,0),b.fromString=j,b.fromTimeT=se,h.year=0,h.time=0,h.nano=0,h.addNano=T,h.getNano=D,h.getTimeT=fe,h.getYear=v,h.toDate=k,h.toJSON=pe,h.toString=Be,h.writeInt64BE=Ae(0,1,2,3,0,4),h.writeInt64LE=Ae(3,2,1,0,4,0);var p="%Y-%m-%dT%H:%M:%S.%NZ",y=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],w={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return b;function b(de,J,Ee){var je=this;if(!(je instanceof b))return new b(de,J,Ee);je.time=+de||0,je.nano=+J||0,je.year=+Ee||0,R(je)}function v(){var de=this.toDate().getUTCFullYear();return de+this.year}function R(de){var J=de.year,Ee=de.time,je=de.nano,ze,Te;if(je<0||c<=je){var ot=Math.floor(je/c);je-=ot*c,Ee+=ot,ze=1}var I=J%e;if(Ee<-s||s<Ee||I){Te=d(Ee/n),Te&&(J+=Te*e,Ee-=Te*n);var O=C(Ee);O.setUTCFullYear(I+O.getUTCFullYear()),J-=I,Ee=+O,Te=d(J/e);var N=Ee+Te*n;Te&&-s<=N&&N<=s&&(J-=Te*e,Ee=N),ze=1}return ze&&(de.year=J,de.time=Ee,de.nano=je),de}function k(){var de=R(this);return C(de.time)}function C(de){var J=new Date(0);return J.setTime(de),J}function T(de){return this.nano+=+de||0,this}function D(){var de=R(this);return(de.time%1e3*c+ +de.nano+u)%u}function j(de){var J,Ee=new b;de+="";var je=de.replace(/^\s*[+\-]?\d+/,function(ze){var Te=+ze,ot=1970+(Te-1970)%400;return Ee.year=Te-ot,ot}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(ze,Te,ot){return Te<0&&(ot*=-1),J=(+Te*60+ +ot)*6e4,""}).replace(/\.\d+$/,function(ze){return Ee.nano=+(ze+f).substr(1,9),""}).split(/\D+/);if(je.length>1?je[1]--:je[1]=0,Ee.time=J=Date.UTC.apply(Date,je)-(J||0),isNaN(J))throw new TypeError("Invalid Date");return R(Ee)}function M(de){return new b(+de)}function se(de){return ie(de,0)}function ie(de,J){J|=0,J*=a,de=+de||0;var Ee=d(J/i)+d(de/i),je=J%i+de%i,ze=d(je/i);return ze&&(Ee+=ze,je-=ze*i),new b(je*1e3,0,Ee*e)}function fe(){var de=R(this),J=Math.floor(de.time/1e3),Ee=de.year;return Ee&&(J+=Ee*t*r/e),J}function pe(){return this.toString().replace(/0{1,6}Z$/,"Z")}function Be(de){var J=this,Ee=J.toDate(),je={H:N,L:W,M:Y,N:ee,S:F,Y:Te,a:V,b:X,d:I,e:O,m:ot};return ze(de||p);function ze(te){return te.replace(/%./g,function(x){var B=x[1],G=w[B],Z=je[B];return G?ze(G):Z?Z():x})}function Te(){var te=J.getYear();return te>999999?"+"+te:te>9999?"+"+Xe(te,6):te>=0?Xe(te,4):te>=-999999?"-"+Xe(-te,6):te}function ot(){return Ye(Ee.getUTCMonth()+1)}function I(){return Ye(Ee.getUTCDate())}function O(){return ct(Ee.getUTCDate())}function N(){return Ye(Ee.getUTCHours())}function Y(){return Ye(Ee.getUTCMinutes())}function F(){return Ye(Ee.getUTCSeconds())}function W(){return Xe(Ee.getUTCMilliseconds(),3)}function ee(){return Xe(J.getNano(),9)}function V(){return g[Ee.getUTCDay()]}function X(){return y[Ee.getUTCMonth()]}}function Ae(de,J,Ee,je,ze,Te){return ot;function ot(O,N){var Y=R(this);O||(O=new Array(8)),ne(O,N|=0);var F=Math.floor(Y.time/1e3),W=Y.year*(t*r/e),ee=d(W/a)+d(F/a),V=W%a+F%a,X=Math.floor(V/a);return X&&(ee+=X,V-=X*a),I(O,N+ze,ee),I(O,N+Te,V),O}function I(O,N,Y){O[N+de]=Y>>24&255,O[N+J]=Y>>16&255,O[N+Ee]=Y>>8&255,O[N+je]=Y&255}}function ke(de,J,Ee,je,ze,Te){return ot;function ot(O,N){ne(O,N|=0);var Y=I(O,N+ze),F=I(O,N+Te);return ie(F,Y)}function I(O,N){return O[N+de]*o+(O[N+J]<<16|O[N+Ee]<<8|O[N+je])}}function ne(de,J){var Ee=de&&de.length;if(Ee==null)throw new TypeError("Invalid Buffer");if(Ee<J+8)throw new RangeError("Out of range")}function Me(de){var J=de-de%1;return J===0&&(de<0||de===0&&1/de!=1/0)?-0:J}function ct(de){return(de>9?"":" ")+(de|0)}function Ye(de){return(de>9?"":"0")+(de|0)}function Xe(de,J){return(f+(de|0)).substr(-J)}}()});var LF=m(($ct,BF)=>{l();"use strict";kp();var db=At(),{toString:Vp}=(et(),or),{fromString:NF}=(at(),Xr);BF.exports={createCipheriv:(r,e,t)=>{let i=db.cipher.createCipher("AES-CTR",Vp(e,"ascii"));return i.start({iv:Vp(t,"ascii")}),{update:n=>(i.update(db.util.createBuffer(Vp(n,"ascii"))),NF(i.output.getBytes(),"ascii"))}},createDecipheriv:(r,e,t)=>{let i=db.cipher.createDecipher("AES-CTR",Vp(e,"ascii"));return i.start({iv:Vp(t,"ascii")}),{update:n=>(i.update(db.util.createBuffer(Vp(n,"ascii"))),NF(i.output.getBytes(),"ascii"))}}}});var qF=m((Gct,jF)=>{l();"use strict";var aRe=Ys(),MF={16:"aes-128-ctr",32:"aes-256-ctr"};jF.exports=function(r){let e=MF[r.length];if(!e){let t=Object.entries(MF).map(([i,n])=>`${i} (${n})`).join(" / ");throw aRe(new Error(`Invalid key length ${r.length} bytes. Must be ${t}`),"ERR_INVALID_KEY_LENGTH")}return e}});var KF=m(FF=>{l();"use strict";var UF=LF(),cRe=qF();FF.create=async function(r,e){let t=cRe(r),i=UF.createCipheriv(t,r,e),n=UF.createDecipheriv(t,r,e);return{async encrypt(o){return i.update(o)},async decrypt(o){return n.update(o)}}}});var HF=m((Yct,zF)=>{l();"use strict";var uRe=xE(),lRe=vr(),fRe=Ys(),VF={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function dRe(r,e,t,i,n){let s=VF[n];if(!s){let a=Object.keys(VF).join(" / ");throw fRe(new Error(`Hash '${n}' is unknown or not supported. Must be ${a}`),"ERR_UNSUPPORTED_HASH_TYPE")}let o=uRe(r,e,t,i,s);return lRe.encode64(o)}zF.exports=dRe});var Qa=m(zp=>{l();"use strict";var hRe=e9(),pRe=KF(),yRe=ub();zp.aes=pRe;zp.hmac=hRe;zp.keys=yRe;zp.randomBytes=s2();zp.pbkdf2=HF()});var WF=m((Qct,GF)=>{l();"use strict";function $F(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function gRe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return $F(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),$F(new n,t)}}GF.exports=gRe});var sK=m((Zct,nK)=>{l();nK.exports=Rr;var to=null;try{to=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(r){}function Rr(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}Rr.prototype.__isLong__;Object.defineProperty(Rr.prototype,"__isLong__",{value:!0});function Jn(r){return(r&&r.__isLong__)===!0}Rr.isLong=Jn;var YF={},XF={};function nd(r,e){var t,i,n;return e?(r>>>=0,(n=0<=r&&r<256)&&(i=XF[r],i)?i:(t=xr(r,(r|0)<0?-1:0,!0),n&&(XF[r]=t),t)):(r|=0,(n=-128<=r&&r<128)&&(i=YF[r],i)?i:(t=xr(r,r<0?-1:0,!1),n&&(YF[r]=t),t))}Rr.fromInt=nd;function ro(r,e){if(isNaN(r))return e?sd:io;if(e){if(r<0)return sd;if(r>=ZF)return iK}else{if(r<=-JF)return es;if(r+1>=JF)return rK}return r<0?ro(-r,e).neg():xr(r%Hp|0,r/Hp|0,e)}Rr.fromNumber=ro;function xr(r,e,t){return new Rr(r,e,t)}Rr.fromBits=xr;var hb=Math.pow;function d9(r,e,t){if(r.length===0)throw Error("empty string");if(r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return io;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var i;if((i=r.indexOf("-"))>0)throw Error("interior hyphen");if(i===0)return d9(r.substring(1),e,t).neg();for(var n=ro(hb(t,8)),s=io,o=0;o<r.length;o+=8){var a=Math.min(8,r.length-o),c=parseInt(r.substring(o,o+a),t);if(a<8){var u=ro(hb(t,a));s=s.mul(u).add(ro(c))}else s=s.mul(n),s=s.add(ro(c))}return s.unsigned=e,s}Rr.fromString=d9;function Zo(r,e){return typeof r=="number"?ro(r,e):typeof r=="string"?d9(r,e):xr(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}Rr.fromValue=Zo;var QF=1<<16,mRe=1<<24,Hp=QF*QF,ZF=Hp*Hp,JF=ZF/2,eK=nd(mRe),io=nd(0);Rr.ZERO=io;var sd=nd(0,!0);Rr.UZERO=sd;var $p=nd(1);Rr.ONE=$p;var tK=nd(1,!0);Rr.UONE=tK;var h9=nd(-1);Rr.NEG_ONE=h9;var rK=xr(4294967295|0,2147483647|0,!1);Rr.MAX_VALUE=rK;var iK=xr(4294967295|0,4294967295|0,!0);Rr.MAX_UNSIGNED_VALUE=iK;var es=xr(0,2147483648|0,!1);Rr.MIN_VALUE=es;var Se=Rr.prototype;Se.toInt=function(){return this.unsigned?this.low>>>0:this.low};Se.toNumber=function(){return this.unsigned?(this.high>>>0)*Hp+(this.low>>>0):this.high*Hp+(this.low>>>0)};Se.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(es)){var t=ro(e),i=this.div(t),n=i.mul(t).sub(this);return i.toString(e)+n.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=ro(hb(e,6),this.unsigned),o=this,a="";;){var c=o.div(s),u=o.sub(c.mul(s)).toInt()>>>0,f=u.toString(e);if(o=c,o.isZero())return f+a;for(;f.length<6;)f="0"+f;a=""+f+a}};Se.getHighBits=function(){return this.high};Se.getHighBitsUnsigned=function(){return this.high>>>0};Se.getLowBits=function(){return this.low};Se.getLowBitsUnsigned=function(){return this.low>>>0};Se.getNumBitsAbs=function(){if(this.isNegative())return this.eq(es)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return this.high!=0?t+33:t+1};Se.isZero=function(){return this.high===0&&this.low===0};Se.eqz=Se.isZero;Se.isNegative=function(){return!this.unsigned&&this.high<0};Se.isPositive=function(){return this.unsigned||this.high>=0};Se.isOdd=function(){return(this.low&1)==1};Se.isEven=function(){return(this.low&1)==0};Se.equals=function(e){return Jn(e)||(e=Zo(e)),this.unsigned!==e.unsigned&&this.high>>>31==1&&e.high>>>31==1?!1:this.high===e.high&&this.low===e.low};Se.eq=Se.equals;Se.notEquals=function(e){return!this.eq(e)};Se.neq=Se.notEquals;Se.ne=Se.notEquals;Se.lessThan=function(e){return this.comp(e)<0};Se.lt=Se.lessThan;Se.lessThanOrEqual=function(e){return this.comp(e)<=0};Se.lte=Se.lessThanOrEqual;Se.le=Se.lessThanOrEqual;Se.greaterThan=function(e){return this.comp(e)>0};Se.gt=Se.greaterThan;Se.greaterThanOrEqual=function(e){return this.comp(e)>=0};Se.gte=Se.greaterThanOrEqual;Se.ge=Se.greaterThanOrEqual;Se.compare=function(e){if(Jn(e)||(e=Zo(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Se.comp=Se.compare;Se.negate=function(){return!this.unsigned&&this.eq(es)?es:this.not().add($p)};Se.neg=Se.negate;Se.add=function(e){Jn(e)||(e=Zo(e));var t=this.high>>>16,i=this.high&65535,n=this.low>>>16,s=this.low&65535,o=e.high>>>16,a=e.high&65535,c=e.low>>>16,u=e.low&65535,f=0,d=0,h=0,p=0;return p+=s+u,h+=p>>>16,p&=65535,h+=n+c,d+=h>>>16,h&=65535,d+=i+a,f+=d>>>16,d&=65535,f+=t+o,f&=65535,xr(h<<16|p,f<<16|d,this.unsigned)};Se.subtract=function(e){return Jn(e)||(e=Zo(e)),this.add(e.neg())};Se.sub=Se.subtract;Se.multiply=function(e){if(this.isZero())return io;if(Jn(e)||(e=Zo(e)),to){var t=to.mul(this.low,this.high,e.low,e.high);return xr(t,to.get_high(),this.unsigned)}if(e.isZero())return io;if(this.eq(es))return e.isOdd()?es:io;if(e.eq(es))return this.isOdd()?es:io;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(eK)&&e.lt(eK))return ro(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,n=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,c=e.high&65535,u=e.low>>>16,f=e.low&65535,d=0,h=0,p=0,y=0;return y+=o*f,p+=y>>>16,y&=65535,p+=s*f,h+=p>>>16,p&=65535,p+=o*u,h+=p>>>16,p&=65535,h+=n*f,d+=h>>>16,h&=65535,h+=s*u,d+=h>>>16,h&=65535,h+=o*c,d+=h>>>16,h&=65535,d+=i*f+n*u+s*c+o*a,d&=65535,xr(p<<16|y,d<<16|h,this.unsigned)};Se.mul=Se.multiply;Se.divide=function(e){if(Jn(e)||(e=Zo(e)),e.isZero())throw Error("division by zero");if(to){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?to.div_u:to.div_s)(this.low,this.high,e.low,e.high);return xr(t,to.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?sd:io;var i,n,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return sd;if(e.gt(this.shru(1)))return tK;s=sd}else{if(this.eq(es)){if(e.eq($p)||e.eq(h9))return es;if(e.eq(es))return $p;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(io)?e.isNegative()?$p:h9:(n=this.sub(e.mul(i)),s=i.add(n.div(e)),s)}else if(e.eq(es))return this.unsigned?sd:io;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=io}for(n=this;n.gte(e);){i=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),c=a<=48?1:hb(2,a-48),u=ro(i),f=u.mul(e);f.isNegative()||f.gt(n);)i-=c,u=ro(i,this.unsigned),f=u.mul(e);u.isZero()&&(u=$p),s=s.add(u),n=n.sub(f)}return s};Se.div=Se.divide;Se.modulo=function(e){if(Jn(e)||(e=Zo(e)),to){var t=(this.unsigned?to.rem_u:to.rem_s)(this.low,this.high,e.low,e.high);return xr(t,to.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Se.mod=Se.modulo;Se.rem=Se.modulo;Se.not=function(){return xr(~this.low,~this.high,this.unsigned)};Se.and=function(e){return Jn(e)||(e=Zo(e)),xr(this.low&e.low,this.high&e.high,this.unsigned)};Se.or=function(e){return Jn(e)||(e=Zo(e)),xr(this.low|e.low,this.high|e.high,this.unsigned)};Se.xor=function(e){return Jn(e)||(e=Zo(e)),xr(this.low^e.low,this.high^e.high,this.unsigned)};Se.shiftLeft=function(e){return Jn(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?xr(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):xr(0,this.low<<e-32,this.unsigned)};Se.shl=Se.shiftLeft;Se.shiftRight=function(e){return Jn(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?xr(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):xr(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Se.shr=Se.shiftRight;Se.shiftRightUnsigned=function(e){if(Jn(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var i=this.low;return xr(i>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?xr(t,0,this.unsigned):xr(t>>>e-32,0,this.unsigned)};Se.shru=Se.shiftRightUnsigned;Se.shr_u=Se.shiftRightUnsigned;Se.toSigned=function(){return this.unsigned?xr(this.low,this.high,!1):this};Se.toUnsigned=function(){return this.unsigned?this:xr(this.low,this.high,!0)};Se.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Se.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Se.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Rr.fromBytes=function(e,t,i){return i?Rr.fromBytesLE(e,t):Rr.fromBytesBE(e,t)};Rr.fromBytesLE=function(e,t){return new Rr(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Rr.fromBytesBE=function(e,t){return new Rr(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}});var Jo=m((Nut,CK)=>{l();"use strict";var CRe=async r=>{let e=[];for await(let t of r)e.push(t);return e};CK.exports=CRe});var OK,Yp,P9=qe(()=>{l();OK=A(Jo()),Yp=(r,e)=>async function*(){yield*(await(0,OK.default)(r)).sort(e)}()});var rs=m((Lut,kK)=>{l();"use strict";var ORe=async r=>{for await(let e of r);};kK.exports=ORe});var is=m((Mut,DK)=>{l();"use strict";var kRe=async function*(r,e){for await(let t of r)await e(t)&&(yield t)};DK.exports=kRe});var fd=m((jut,NK)=>{l();"use strict";var DRe=async function*(r,e){let t=0;if(!(e<1)){for await(let i of r)if(yield i,t++,t===e)return}};NK.exports=DRe});var C9,dd,O9,sn,hd=qe(()=>{l();P9();C9=A(rs()),dd=A(is()),O9=A(fd()),sn=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,i){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:i,value:n}of e)await this.put(i,n,t),yield{key:i,value:n}}async*getMany(e,t={}){for await(let i of e)yield this.get(i,t)}async*deleteMany(e,t={}){for await(let i of e)await this.delete(i,t),yield i}batch(){let e=[],t=[];return{put(i,n){e.push({key:i,value:n})},delete(i){t.push(i)},commit:async i=>{await(0,C9.default)(this.putMany(e,i)),e=[],await(0,C9.default)(this.deleteMany(t,i)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let i=this._all(e,t);if(e.prefix!=null&&(i=(0,dd.default)(i,n=>n.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>(0,dd.default)(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>Yp(n,s),i)),e.offset!=null){let n=0;i=(0,dd.default)(i,()=>n++>=e.offset)}return e.limit!=null&&(i=(0,O9.default)(i,e.limit)),i}queryKeys(e,t){let i=this._allKeys(e,t);if(e.prefix!=null&&(i=(0,dd.default)(i,n=>n.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>(0,dd.default)(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>Yp(n,s),i)),e.offset!=null){let n=0;i=(0,dd.default)(i,()=>n++>=e.offset)}return e.limit!=null&&(i=(0,O9.default)(i,e.limit)),i}}});var LK=m((Kut,BK)=>{l();BK.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}});var k9=m((zut,jK)=>{l();var MK=LK();jK.exports=class{constructor(e){this.hwm=e||16,this.head=new MK(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let t=this.head;this.head=t.next=new MK(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let t=this.tail.next;return this.tail.next=null,this.tail=t,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}});var Za=m((Hut,qK)=>{l();var D9=k9();qK.exports=r=>{r=r||{};let e;typeof r=="function"?(e=r,r={}):e=r.onEnd;let t=new D9,i,n,s,o=()=>{if(!t.isEmpty()){if(r.writev){let g,w=[];for(;!t.isEmpty();){if(g=t.shift(),g.error)throw g.error;w.push(g.value)}return{done:g.done,value:w}}let y=t.shift();if(y.error)throw y.error;return y}return s?{done:!0}:new Promise((y,g)=>{n=w=>(n=null,w.error?g(w.error):r.writev&&!w.done?y({done:w.done,value:[w.value]}):y(w),i)})},a=y=>n?n(y):(t.push(y),i),c=y=>(t=new D9,n?n({error:y}):(t.push({error:y}),i)),u=y=>s?i:a({done:!1,value:y}),f=y=>s?i:(s=!0,y?c(y):a({done:!0})),d=()=>(t=new D9,f(),{done:!0}),h=y=>(f(y),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:o,return:d,throw:h,push:u,end:f},!e)return i;let p=i;return i={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(y){return p.throw(y),e&&(e(y),e=null),{done:!0}},return(){return p.return(),e&&(e(),e=null),{done:!0}},push:u,end(y){return p.end(y),e&&(e(y),e=null),i}},i}});var UK,N9,B9,NRe,D2,L9=qe(()=>{l();hd();eo();UK=A(le()),N9=A(Za()),B9=A(rs()),NRe=(0,UK.default)("datastore:core:tiered"),D2=class extends sn{constructor(e){super();this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map(e=>e.open()))}catch(e){throw R2()}}async put(e,t){try{await Promise.all(this.stores.map(i=>i.put(e,t)))}catch(i){throw I2()}}async get(e,t){for(let i of this.stores)try{let n=await i.get(e,t);if(n)return n}catch(n){NRe(n)}throw xi()}async has(e,t){for(let i of this.stores)if(await i.has(e,t))return!0;return!1}async delete(e,t){try{await Promise.all(this.stores.map(i=>i.delete(e,t)))}catch(i){throw x2()}}async*putMany(e,t={}){let i,n=this.stores.map(s=>{let o=(0,N9.default)();return(0,B9.default)(s.putMany(o,t)).catch(a=>{i=a}),o});try{for await(let s of e){if(i)throw i;n.forEach(o=>o.push(s)),yield s}}finally{n.forEach(s=>s.end())}}async*deleteMany(e,t={}){let i,n=this.stores.map(s=>{let o=(0,N9.default)();return(0,B9.default)(s.deleteMany(o,t)).catch(a=>{i=a}),o});try{for await(let s of e){if(i)throw i;n.forEach(o=>o.push(s)),yield s}}finally{n.forEach(s=>s.end())}}async close(){await Promise.all(this.stores.map(e=>e.close()))}batch(){let e=this.stores.map(t=>t.batch());return{put:(t,i)=>{e.forEach(n=>n.put(t,i))},delete:t=>{e.forEach(i=>i.delete(t))},commit:async t=>{for(let i of e)await i.commit(t)}}}query(e,t){return this.stores[this.stores.length-1].query(e,t)}queryKeys(e,t){return this.stores[this.stores.length-1].queryKeys(e,t)}}});var N2=m((M9,j9)=>{l();(function(r,e){typeof M9=="object"&&typeof j9!="undefined"?j9.exports=function(t,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)t=t?t[i[s]]:o;return t===o?n:t}:typeof define=="function"&&define.amd?define(function(){return function(t,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)t=t?t[i[s]]:o;return t===o?n:t}}):r.dlv=function(t,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)t=t?t[i[s]]:o;return t===o?n:t}})(M9)});var Xp=qe(()=>{l();Mr()});var Eb,q9=qe(()=>{l();Eb=`This is a repository of IPLD objects. Each IPLD object is in a single file,
named <base32 encoding of cid>.data. Where <base32 encoding of cid> is the
"base32" encoding of the CID (as specified in
https://github.com/multiformats/multibase) without the 'B' prefix.
All the object files are placed in a tree of directories, based on a
function of the CID. This is a form of sharding similar to
the objects directory in git repositories. Previously, we used
prefixes, we now use the next-to-last two charters.
    func NextToLast(base32cid string) {
      nextToLastLen := 2
      offset := len(base32cid) - nextToLastLen - 1
      return str[offset : offset+nextToLastLen]
    }
For example, an object with a base58 CIDv1 of
    zb2rhYSxw4ZjuzgCnWSt19Q94ERaeFhu9uSqRgjSdx9bsgM6f
has a base32 CIDv1 of
    BAFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA
and will be placed at
    SC/AFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA.data
with 'SC' being the last-to-next two characters and the 'B' at the
beginning of the CIDv1 string is the multibase prefix that is not
stored in the filename.
`});var z9={};Pt(z9,{NextToLast:()=>V9,PREFIX:()=>Sb,Prefix:()=>F9,README_FN:()=>U9,SHARDING_FN:()=>Ab,ShardBase:()=>B2,Suffix:()=>K9,parseShardFun:()=>FK,readShardFun:()=>Rb,readme:()=>Eb});function FK(r){if(r=r.trim(),r.length===0)throw new Error("empty shard string");if(!r.startsWith(Sb))throw new Error(`invalid or no path prefix: ${r}`);let e=r.slice(Sb.length).split("/"),t=e[0];if(t!=="v1")throw new Error(`expect 'v1' version, got '${t}'`);let i=e[1];if(!e[2])throw new Error("missing param");let n=parseInt(e[2],10);switch(i){case"prefix":return new F9(n);case"suffix":return new K9(n);case"next-to-last":return new V9(n);default:throw new Error(`unkown sharding function: ${i}`)}}var Sb,Ab,U9,B2,F9,K9,V9,Rb,H9=qe(()=>{l();Mr();q9();q9();Sb="/repo/flatfs/shard/",Ab="SHARDING",U9="_README",B2=class{constructor(e){this.param=e,this.name="base",this._padding=""}fun(e){return"implement me"}toString(){return`${Sb}v1/${this.name}/${this.param}`}},F9=class extends B2{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="prefix"}fun(e){return(e+this._padding).slice(0,this.param)}},K9=class extends B2{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="suffix"}fun(e){let t=this._padding+e;return t.slice(t.length-this.param)}},V9=class extends B2{constructor(e){super(e);this._padding="".padStart(e+1,"_"),this.name="next-to-last"}fun(e){let t=this._padding+e,i=t.length-this.param-1;return t.slice(i,i+this.param)}};Rb=async(r,e)=>{let t=new xe(r).child(new xe(Ab)),n=await(typeof e.getRaw=="function"?e.getRaw.bind(e):e.get.bind(e))(t);return FK(new TextDecoder().decode(n||"").trim())}});var $9={};Pt($9,{MemoryDatastore:()=>xb});var xb,Ib=qe(()=>{l();hd();Mr();eo();xb=class extends sn{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[e.toString()]=t}async get(e){if(!await this.has(e))throw xi();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,t])=>({key:new xe(e),value:t}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new xe(e))}}});var wn=m((slt,KK)=>{l();"use strict";var BRe=async function*(r,e){for await(let t of r)yield e(t)};KK.exports=BRe});var dr=m((olt,Qp)=>{l();var VK=(...r)=>{let e;for(;r.length;)e=r.shift()(e);return e},G9=r=>r&&(typeof r[Symbol.asyncIterator]=="function"||typeof r[Symbol.iterator]=="function"||typeof r.next=="function"),Tb=r=>r&&typeof r.sink=="function"&&G9(r.source),LRe=r=>e=>(r.sink(e),r.source),zK=(...r)=>{if(Tb(r[0])){let e=r[0];r[0]=()=>e.source}else if(G9(r[0])){let e=r[0];r[0]=()=>e}if(r.length>1&&Tb(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let e=1;e<r.length-1;e++)Tb(r[e])&&(r[e]=LRe(r[e]));return VK(...r)};Qp.exports=zK;Qp.exports.pipe=zK;Qp.exports.rawPipe=VK;Qp.exports.isIterable=G9;Qp.exports.isDuplex=Tb});var El,Pb,pd,Cb=qe(()=>{l();hd();El=A(wn()),Pb=A(dr()),pd=class extends sn{constructor(e,t){super();this.child=e,this.transform=t}open(){return this.child.open()}put(e,t,i){return this.child.put(this.transform.convert(e),t,i)}get(e,t){return this.child.get(this.transform.convert(e),t)}has(e,t){return this.child.has(this.transform.convert(e),t)}delete(e,t){return this.child.delete(this.transform.convert(e),t)}async*putMany(e,t={}){let i=this.transform,n=this.child;yield*(0,Pb.pipe)(e,async function*(s){yield*(0,El.default)(s,({key:o,value:a})=>({key:i.convert(o),value:a}))},async function*(s){yield*n.putMany(s,t)},async function*(s){yield*(0,El.default)(s,({key:o,value:a})=>({key:i.invert(o),value:a}))})}async*getMany(e,t={}){let i=this.transform,n=this.child;yield*(0,Pb.pipe)(e,async function*(s){yield*(0,El.default)(s,o=>i.convert(o))},async function*(s){yield*n.getMany(s,t)})}async*deleteMany(e,t={}){let i=this.transform,n=this.child;yield*(0,Pb.pipe)(e,async function*(s){yield*(0,El.default)(s,o=>i.convert(o))},async function*(s){yield*n.deleteMany(s,t)},async function*(s){yield*(0,El.default)(s,o=>i.invert(o))})}batch(){let e=this.child.batch();return{put:(t,i)=>{e.put(this.transform.convert(t),i)},delete:t=>{e.delete(this.transform.convert(t))},commit:t=>e.commit(t)}}query(e,t){let i={...e};i.filters=(i.filters||[]).map(s=>({key:o,value:a})=>s({key:this.transform.convert(o),value:a}));let{prefix:n}=e;return n!=null&&n!=="/"&&(delete i.prefix,i.filters.push(({key:s})=>this.transform.invert(s).toString().startsWith(n))),i.orders&&(i.orders=i.orders.map(s=>(o,a)=>s({key:this.transform.invert(o.key),value:o.value},{key:this.transform.invert(a.key),value:a.value}))),(0,El.default)(this.child.query(i,t),({key:s,value:o})=>({key:this.transform.invert(s),value:o}))}queryKeys(e,t){let i={...e};i.filters=(i.filters||[]).map(s=>o=>s(this.transform.convert(o)));let{prefix:n}=e;return n!=null&&n!=="/"&&(delete i.prefix,i.filters.push(s=>this.transform.invert(s).toString().startsWith(n))),i.orders&&(i.orders=i.orders.map(s=>(o,a)=>s(this.transform.invert(o),this.transform.invert(a)))),(0,El.default)(this.child.queryKeys(i,t),s=>this.transform.invert(s))}close(){return this.child.close()}}});var Zp,L2,Sl,HK=qe(()=>{l();Xp();H9();hd();Cb();eo();Zp=new xe(Ab),L2=new xe(U9),Sl=class extends sn{constructor(e,t){super();this.child=new pd(e,{convert:this._convertKey.bind(this),invert:this._invertKey.bind(this)}),this.shard=t}async open(){await this.child.open(),this.shard=await Sl.create(this.child,this.shard)}_convertKey(e){let t=e.toString();return t===Zp.toString()||t===L2.toString()?e:new xe(this.shard.fun(t)).child(e)}_invertKey(e){let t=e.toString();return t===Zp.toString()||t===L2.toString()?e:xe.withNamespaces(e.list().slice(1))}static async createOrOpen(e,t){try{await Sl.create(e,t)}catch(i){if(i&&i.message!=="datastore exists")throw i}return Sl.open(e)}static async open(e){let t=await Rb("/",e);return new Sl(e,t)}static async create(e,t){let i=await e.has(Zp);if(!i&&!t)throw R2(Error("Shard is required when datastore doesn't have a shard key already."));if(!i){let a=typeof e.putRaw=="function"?e.putRaw.bind(e):e.put.bind(e);return await Promise.all([a(Zp,new TextEncoder().encode(t.toString()+`
`)),a(L2,new TextEncoder().encode(Eb))]),t}let n=await Rb("/",e),s=(n||"").toString(),o=t.toString();if(s!==o)throw new Error(`specified fun ${o} does not match repo shard fun ${s}`);return n}put(e,t,i){return this.child.put(e,t,i)}get(e,t){return this.child.get(e,t)}has(e,t){return this.child.has(e,t)}delete(e,t){return this.child.delete(e,t)}async*putMany(e,t={}){yield*this.child.putMany(e,t)}async*getMany(e,t={}){yield*this.child.getMany(e,t)}async*deleteMany(e,t={}){yield*this.child.deleteMany(e,t)}batch(){return this.child.batch()}query(e,t){let i={...e,filters:[({key:n})=>n.toString()!==Zp.toString(),({key:n})=>n.toString()!==L2.toString()].concat(e.filters||[])};return this.child.query(i,t)}queryKeys(e,t){let i={...e,filters:[n=>n.toString()!==Zp.toString(),n=>n.toString()!==L2.toString()].concat(e.filters||[])};return this.child.queryKeys(i,t)}close(){return this.child.close()}}});var Al=m((ylt,$K)=>{l();"use strict";var MRe=Za(),jRe=async function*(...r){let e=MRe();setTimeout(async()=>{try{await Promise.all(r.map(async t=>{for await(let i of t)e.push(i)})),e.end()}catch(t){e.end(t)}},0),yield*e};$K.exports=jRe});var M2,W9,Y9,X9,GK=qe(()=>{l();M2=A(is()),W9=A(fd()),Y9=A(Al());hd();eo();P9();X9=class extends sn{constructor(e){super();this.mounts=e.slice()}async open(){await Promise.all(this.mounts.map(e=>e.datastore.open()))}_lookup(e){for(let t of this.mounts)if(t.prefix.toString()===e.toString()||t.prefix.isAncestorOf(e))return{datastore:t.datastore,mountpoint:t.prefix}}put(e,t,i){let n=this._lookup(e);if(n==null)throw I2(new Error("No datastore mounted for this key"));return n.datastore.put(e,t,i)}get(e,t){let i=this._lookup(e);if(i==null)throw xi(new Error("No datastore mounted for this key"));return i.datastore.get(e,t)}has(e,t){let i=this._lookup(e);return i==null?Promise.resolve(!1):i.datastore.has(e,t)}delete(e,t){let i=this._lookup(e);if(i==null)throw x2(new Error("No datastore mounted for this key"));return i.datastore.delete(e,t)}async close(){await Promise.all(this.mounts.map(e=>e.datastore.close()))}batch(){let e={},t=i=>{let n=this._lookup(i);if(n==null)throw new Error("No datastore mounted for this key");let s=n.mountpoint.toString();return e[s]==null&&(e[s]=n.datastore.batch()),{batch:e[s]}};return{put:(i,n)=>{t(i).batch.put(i,n)},delete:i=>{t(i).batch.delete(i)},commit:async i=>{await Promise.all(Object.keys(e).map(n=>e[n].commit(i)))}}}query(e,t){let i=this.mounts.map(s=>s.datastore.query({prefix:e.prefix,filters:e.filters},t)),n=(0,Y9.default)(...i);if(e.filters&&e.filters.forEach(s=>{n=(0,M2.default)(n,s)}),e.orders&&e.orders.forEach(s=>{n=Yp(n,s)}),e.offset!=null){let s=0;n=(0,M2.default)(n,()=>s++>=e.offset)}return e.limit!=null&&(n=(0,W9.default)(n,e.limit)),n}queryKeys(e,t){let i=this.mounts.map(s=>s.datastore.queryKeys({prefix:e.prefix,filters:e.filters},t)),n=(0,Y9.default)(...i);if(e.filters&&e.filters.forEach(s=>{n=(0,M2.default)(n,s)}),e.orders&&e.orders.forEach(s=>{n=Yp(n,s)}),e.offset!=null){let s=0;n=(0,M2.default)(n,()=>s++>=e.offset)}return e.limit!=null&&(n=(0,W9.default)(n,e.limit)),n}}});var Q9,WK=qe(()=>{l();Xp();Cb();Q9=class extends pd{constructor(e,t){super(e,{convert(i){return t.child(i)},invert(i){if(t.toString()==="/")return i;if(!t.isAncestorOf(i))throw new Error(`Expected prefix: (${t.toString()}) in key: ${i.toString()}`);return new xe(i.toString().slice(t.toString().length),!1)}})}}});var YK={};Pt(YK,{BaseDatastore:()=>sn,Errors:()=>yd,KeyTransformDatastore:()=>pd,MemoryDatastore:()=>xb,MountDatastore:()=>X9,NamespaceDatastore:()=>Q9,ShardingDatastore:()=>Sl,TieredDatastore:()=>D2,shard:()=>qRe});var yd,qRe,Ob=qe(()=>{l();eo();H9();hd();Ib();Cb();HK();GK();L9();WK();yd=l9,qRe=z9});var Z9=m((Clt,QK)=>{l();"use strict";function XK(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function URe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return XK(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),XK(new n,t)}}QK.exports=URe});var rV=m((Hlt,tV)=>{l();"use strict";var e0=Br(),eV=e0.Reader,FRe=e0.Writer,no=e0.util,q2=e0.roots["libp2p-record"]||(e0.roots["libp2p-record"]={});q2.Record=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.key=no.newBuffer([]),r.prototype.value=no.newBuffer([]),r.prototype.timeReceived="",r.encode=function(t,i){return i||(i=FRe.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&i.uint32(10).bytes(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(18).bytes(t.value),t.timeReceived!=null&&Object.hasOwnProperty.call(t,"timeReceived")&&i.uint32(42).string(t.timeReceived),i},r.decode=function(t,i){t instanceof eV||(t=eV.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new q2.Record;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.key=t.bytes();break;case 2:s.value=t.bytes();break;case 5:s.timeReceived=t.string();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof q2.Record)return t;var i=new q2.Record;return t.key!=null&&(typeof t.key=="string"?no.base64.decode(t.key,i.key=no.newBuffer(no.base64.length(t.key)),0):t.key.length&&(i.key=t.key)),t.value!=null&&(typeof t.value=="string"?no.base64.decode(t.value,i.value=no.newBuffer(no.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),t.timeReceived!=null&&(i.timeReceived=String(t.timeReceived)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.key="":(n.key=[],i.bytes!==Array&&(n.key=no.newBuffer(n.key))),i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=no.newBuffer(n.value))),n.timeReceived=""),t.key!=null&&t.hasOwnProperty("key")&&(n.key=i.bytes===String?no.base64.encode(t.key,0,t.key.length):i.bytes===Array?Array.prototype.slice.call(t.key):t.key),t.value!=null&&t.hasOwnProperty("value")&&(n.value=i.bytes===String?no.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),t.timeReceived!=null&&t.hasOwnProperty("timeReceived")&&(n.timeReceived=t.timeReceived),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,e0.util.toJSONOptions)},r}();tV.exports=q2});var iV=m(($lt,nS)=>{l();"use strict";nS.exports.toRFC3339=r=>{let e=r.getUTCFullYear(),t=String(r.getUTCMonth()+1).padStart(2,"0"),i=String(r.getUTCDate()).padStart(2,"0"),n=String(r.getUTCHours()).padStart(2,"0"),s=String(r.getUTCMinutes()).padStart(2,"0"),o=String(r.getUTCSeconds()).padStart(2,"0"),c=r.getUTCMilliseconds()*1e3*1e3;return`${e}-${t}-${i}T${n}:${s}:${o}.${c}Z`};nS.exports.parseRFC3339=r=>{let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),t=String(r).trim().match(e);if(!t)throw new Error("Invalid format");let i=parseInt(t[1],10),n=parseInt(t[2],10)-1,s=parseInt(t[3],10),o=parseInt(t[4],10),a=parseInt(t[5],10),c=parseInt(t[6],10),u=parseInt(t[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,u))}});var oV=m((Glt,sV)=>{l();"use strict";var{Record:sS}=rV(),nV=iV(),U2=class{constructor(e,t,i){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=i}serialize(){return sS.encode(this.prepareSerialize()).finish()}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:this.timeReceived&&nV.toRFC3339(this.timeReceived)}}static deserialize(e){let t=sS.decode(e);return U2.fromDeserialized(sS.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}))}static fromDeserialized(e){let t;return e.timeReceived&&(t=nV.parseRFC3339(e.timeReceived)),new U2(e.key,e.value,t)}};sV.exports=U2});var Nb=m((Wlt,cV)=>{l();"use strict";function aV(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function KRe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return aV(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),aV(new n,t)}}cV.exports=KRe});var lV=m((Ylt,uV)=>{l();"use strict";var{sha256:VRe}=(Si(),Ks),Bb=Nb(),{toString:zRe}=(et(),or),{equals:HRe}=(hi(),hn),$Re=async(r,e)=>{if(!(r instanceof Uint8Array))throw Bb(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(r.byteLength<5)throw Bb(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if(zRe(r.subarray(0,4))!=="/pk/")throw Bb(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");let i=r.slice(4),n=await VRe.digest(e);if(!HRe(i,n.bytes))throw Bb(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")};uV.exports={func:$Re,sign:!1}});var dV=m((Xlt,fV)=>{l();"use strict";fV.exports={pk:lV()}});var pV=m((Qlt,hV)=>{l();"use strict";var GRe=Nb(),{toString:WRe}=(et(),or),YRe=(r,e)=>{let t=e.key,n=WRe(t).split("/");if(n.length<3)return;let s=r[n[1].toString()];if(!s){let o="Invalid record keytype";throw GRe(new Error(o),"ERR_INVALID_RECORD_KEY_TYPE")}return s.func(t,e.value)};hV.exports={verifyRecord:YRe,validators:dV()}});var gV=m((Zlt,yV)=>{l();"use strict";var XRe=(r,e)=>0;yV.exports=XRe});var bV=m((Jlt,mV)=>{l();"use strict";mV.exports={pk:gV()}});var _V=m((eft,wV)=>{l();"use strict";var oS=Nb(),{toString:QRe}=(et(),or),ZRe=(r,e,t)=>{if(t.length===0){let o="No records given";throw oS(new Error(o),"ERR_NO_RECORDS_RECEIVED")}let n=QRe(e).split("/");if(n.length<3){let o="Record key does not have a selector function";throw oS(new Error(o),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}let s=r[n[1].toString()];if(!s){let o=`Unrecognized key prefix: ${n[1]}`;throw oS(new Error(o),"ERR_UNRECOGNIZED_KEY_PREFIX")}return t.length===1?0:s(e,t)};wV.exports={bestRecord:ZRe,selectors:bV()}});var Ja=m((tft,vV)=>{l();"use strict";vV.exports={Record:oV(),validator:pV(),selection:_V()}});var OV=m((Ift,CV)=>{l();"use strict";var txe=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;CV.exports=function(e,t){if(t==null&&(t=!1),e.length<2||e.length>255)return!1;var i=e[e.length-1];if(t){if(i!==".")return!1}else if(i===".")return!1;return txe.test(e)}});var ec=m((Gdt,nz)=>{l();"use strict";var lxe=()=>{let r={};return r.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),r};nz.exports=lxe});var Ut=m((Wdt,AS)=>{l();"use strict";var i0=typeof Reflect=="object"?Reflect:null,sz=i0&&typeof i0.apply=="function"?i0.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},Ub;i0&&typeof i0.ownKeys=="function"?Ub=i0.ownKeys:Object.getOwnPropertySymbols?Ub=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Ub=function(e){return Object.getOwnPropertyNames(e)};function fxe(r){console&&console.warn&&console.warn(r)}var oz=Number.isNaN||function(e){return e!==e};function hr(){hr.init.call(this)}AS.exports=hr;AS.exports.once=yxe;hr.EventEmitter=hr;hr.prototype._events=void 0;hr.prototype._eventsCount=0;hr.prototype._maxListeners=void 0;var az=10;function Fb(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(hr,"defaultMaxListeners",{enumerable:!0,get:function(){return az},set:function(r){if(typeof r!="number"||r<0||oz(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");az=r}});hr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};hr.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||oz(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function cz(r){return r._maxListeners===void 0?hr.defaultMaxListeners:r._maxListeners}hr.prototype.getMaxListeners=function(){return cz(this)};hr.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")sz(c,this,t);else for(var u=c.length,f=hz(c,u),i=0;i<u;++i)sz(f[i],this,t);return!0};function uz(r,e,t,i){var n,s,o;if(Fb(t),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),s=r._events),o=s[e]),o===void 0)o=s[e]=t,++r._eventsCount;else if(typeof o=="function"?o=s[e]=i?[t,o]:[o,t]:i?o.unshift(t):o.push(t),n=cz(r),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=o.length,fxe(a)}return r}hr.prototype.addListener=function(e,t){return uz(this,e,t,!1)};hr.prototype.on=hr.prototype.addListener;hr.prototype.prependListener=function(e,t){return uz(this,e,t,!0)};function dxe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function lz(r,e,t){var i={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},n=dxe.bind(i);return n.listener=t,i.wrapFn=n,n}hr.prototype.once=function(e,t){return Fb(t),this.on(e,lz(this,e,t)),this};hr.prototype.prependOnceListener=function(e,t){return Fb(t),this.prependListener(e,lz(this,e,t)),this};hr.prototype.removeListener=function(e,t){var i,n,s,o,a;if(Fb(t),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount==0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===t||i[o].listener===t){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():hxe(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};hr.prototype.off=hr.prototype.removeListener;hr.prototype.removeAllListeners=function(e){var t,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this};function fz(r,e,t){var i=r._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?t?[n.listener||n]:[n]:t?pxe(n):hz(n,n.length)}hr.prototype.listeners=function(e){return fz(this,e,!0)};hr.prototype.rawListeners=function(e){return fz(this,e,!1)};hr.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):dz.call(r,e)};hr.prototype.listenerCount=dz;function dz(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}hr.prototype.eventNames=function(){return this._eventsCount>0?Ub(this._events):[]};function hz(r,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=r[i];return t}function hxe(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function pxe(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function yxe(r,e){return new Promise(function(t,i){function n(o){r.removeListener(e,s),i(o)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",n),t([].slice.call(arguments))}pz(r,e,s,{once:!0}),e!=="error"&&gxe(r,n,{once:!0})})}function gxe(r,e,t){typeof r.on=="function"&&pz(r,"error",e,t)}function pz(r,e,t,i){if(typeof r.on=="function")i.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function n(s){i.once&&r.removeEventListener(e,n),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var Vb=m((Ydt,yz)=>{l();"use strict";var Kb=ec(),mxe=Ut().EventEmitter;async function*bxe(r,e={}){let t=e.concurrency||1/0;t<1&&(t=1/0);let i=e.ordered==null?!1:e.ordered,n=new mxe,s=[],o=Kb(),a=Kb(),c=!1,u,f=!1;n.on("task-complete",()=>{a.resolve()}),Promise.resolve().then(async()=>{try{for await(let y of r){if(s.length===t&&(o=Kb(),await o.promise),f)break;let g={done:!1};s.push(g),y().then(w=>{g.done=!0,g.ok=!0,g.value=w,n.emit("task-complete")},w=>{g.done=!0,g.err=w,n.emit("task-complete")})}c=!0,n.emit("task-complete")}catch(y){u=y,n.emit("task-complete")}});function d(){return Boolean(i?s[0]&&s[0].done:s.find(y=>y.done))}function*h(){for(;s.length&&s[0].done;){let y=s[0];if(s.shift(),y.ok)yield y.value;else throw f=!0,o.resolve(),y.err;o.resolve()}}function*p(){for(;d();)for(let y=0;y<s.length;y++)if(s[y].done){let g=s[y];if(s.splice(y,1),y--,g.ok)yield g.value;else throw f=!0,o.resolve(),g.err;o.resolve()}}for(;;){if(d()||(a=Kb(),await a.promise),u)throw u;if(i?yield*h():yield*p(),c&&s.length===0)break}}yz.exports=bxe});var n0=m((uht,Sz)=>{l();"use strict";async function*_xe(r,e={}){let t=r.getReader();try{for(;;){let i=await t.read();if(i.done)return;yield i.value}}finally{e.preventCancel!==!0&&t.cancel(),t.releaseLock()}}Sz.exports=_xe});var xz=m((lht,Rz)=>{l();"use strict";var Az=n0();function vxe(r){return typeof r.stream=="function"?Az(r.stream()):Az(new Response(r).body)}Rz.exports=vxe});var s0=m((fht,Iz)=>{l();"use strict";function Exe(r){let[e,t]=r[Symbol.asyncIterator]?[r[Symbol.asyncIterator](),Symbol.asyncIterator]:[r[Symbol.iterator](),Symbol.iterator],i=[];return{peek:()=>e.next(),push:n=>{i.push(n)},next:()=>i.length?{done:!1,value:i.shift()}:e.next(),[t](){return this}}}Iz.exports=Exe});var Xb=m((Aht,qz)=>{l();"use strict";async function*Sxe(r,e=1){let t=[];e<1&&(e=1);for await(let i of r)for(t.push(i);t.length>=e;)yield t.slice(0,e),t=t.slice(e);for(;t.length;)yield t.slice(0,e),t=t.slice(e)}qz.exports=Sxe});var Qb=m((Rht,Uz)=>{l();"use strict";var Axe=Xb();async function*Rxe(r,e=1){for await(let t of Axe(r,e)){let i=t.map(n=>n().then(s=>({ok:!0,value:s}),s=>({ok:!1,err:s})));for(let n=0;n<i.length;n++){let s=await i[n];if(s.ok)yield s.value;else throw s.err}}}Uz.exports=Rxe});var Fz=m((V2,Zb)=>{l();(function(r,e){"use strict";var t={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function i(p){if(!Array.isArray(p)&&!ArrayBuffer.isView(p))return!1;for(var y=0;y<p.length;y++)if(!Number.isInteger(p[y])||p[y]<0||p[y]>255)return!1;return!0}function n(p,y){return(p&65535)*y+(((p>>>16)*y&65535)<<16)}function s(p,y){return p<<y|p>>>32-y}function o(p){return p^=p>>>16,p=n(p,2246822507),p^=p>>>13,p=n(p,3266489909),p^=p>>>16,p}function a(p,y){p=[p[0]>>>16,p[0]&65535,p[1]>>>16,p[1]&65535],y=[y[0]>>>16,y[0]&65535,y[1]>>>16,y[1]&65535];var g=[0,0,0,0];return g[3]+=p[3]+y[3],g[2]+=g[3]>>>16,g[3]&=65535,g[2]+=p[2]+y[2],g[1]+=g[2]>>>16,g[2]&=65535,g[1]+=p[1]+y[1],g[0]+=g[1]>>>16,g[1]&=65535,g[0]+=p[0]+y[0],g[0]&=65535,[g[0]<<16|g[1],g[2]<<16|g[3]]}function c(p,y){p=[p[0]>>>16,p[0]&65535,p[1]>>>16,p[1]&65535],y=[y[0]>>>16,y[0]&65535,y[1]>>>16,y[1]&65535];var g=[0,0,0,0];return g[3]+=p[3]*y[3],g[2]+=g[3]>>>16,g[3]&=65535,g[2]+=p[2]*y[3],g[1]+=g[2]>>>16,g[2]&=65535,g[2]+=p[3]*y[2],g[1]+=g[2]>>>16,g[2]&=65535,g[1]+=p[1]*y[3],g[0]+=g[1]>>>16,g[1]&=65535,g[1]+=p[2]*y[2],g[0]+=g[1]>>>16,g[1]&=65535,g[1]+=p[3]*y[1],g[0]+=g[1]>>>16,g[1]&=65535,g[0]+=p[0]*y[3]+p[1]*y[2]+p[2]*y[1]+p[3]*y[0],g[0]&=65535,[g[0]<<16|g[1],g[2]<<16|g[3]]}function u(p,y){return y%=64,y===32?[p[1],p[0]]:y<32?[p[0]<<y|p[1]>>>32-y,p[1]<<y|p[0]>>>32-y]:(y-=32,[p[1]<<y|p[0]>>>32-y,p[0]<<y|p[1]>>>32-y])}function f(p,y){return y%=64,y===0?p:y<32?[p[0]<<y|p[1]>>>32-y,p[1]<<y]:[p[1]<<y-32,0]}function d(p,y){return[p[0]^y[0],p[1]^y[1]]}function h(p){return p=d(p,[0,p[0]>>>1]),p=c(p,[4283543511,3981806797]),p=d(p,[0,p[0]>>>1]),p=c(p,[3301882366,444984403]),p=d(p,[0,p[0]>>>1]),p}t.x86.hash32=function(p,y){if(t.inputValidation&&!i(p))return e;y=y||0;for(var g=p.length%4,w=p.length-g,b=y,v=0,R=3432918353,k=461845907,C=0;C<w;C=C+4)v=p[C]|p[C+1]<<8|p[C+2]<<16|p[C+3]<<24,v=n(v,R),v=s(v,15),v=n(v,k),b^=v,b=s(b,13),b=n(b,5)+3864292196;switch(v=0,g){case 3:v^=p[C+2]<<16;case 2:v^=p[C+1]<<8;case 1:v^=p[C],v=n(v,R),v=s(v,15),v=n(v,k),b^=v}return b^=p.length,b=o(b),b>>>0},t.x86.hash128=function(p,y){if(t.inputValidation&&!i(p))return e;y=y||0;for(var g=p.length%16,w=p.length-g,b=y,v=y,R=y,k=y,C=0,T=0,D=0,j=0,M=597399067,se=2869860233,ie=951274213,fe=2716044179,pe=0;pe<w;pe=pe+16)C=p[pe]|p[pe+1]<<8|p[pe+2]<<16|p[pe+3]<<24,T=p[pe+4]|p[pe+5]<<8|p[pe+6]<<16|p[pe+7]<<24,D=p[pe+8]|p[pe+9]<<8|p[pe+10]<<16|p[pe+11]<<24,j=p[pe+12]|p[pe+13]<<8|p[pe+14]<<16|p[pe+15]<<24,C=n(C,M),C=s(C,15),C=n(C,se),b^=C,b=s(b,19),b+=v,b=n(b,5)+1444728091,T=n(T,se),T=s(T,16),T=n(T,ie),v^=T,v=s(v,17),v+=R,v=n(v,5)+197830471,D=n(D,ie),D=s(D,17),D=n(D,fe),R^=D,R=s(R,15),R+=k,R=n(R,5)+2530024501,j=n(j,fe),j=s(j,18),j=n(j,M),k^=j,k=s(k,13),k+=b,k=n(k,5)+850148119;switch(C=0,T=0,D=0,j=0,g){case 15:j^=p[pe+14]<<16;case 14:j^=p[pe+13]<<8;case 13:j^=p[pe+12],j=n(j,fe),j=s(j,18),j=n(j,M),k^=j;case 12:D^=p[pe+11]<<24;case 11:D^=p[pe+10]<<16;case 10:D^=p[pe+9]<<8;case 9:D^=p[pe+8],D=n(D,ie),D=s(D,17),D=n(D,fe),R^=D;case 8:T^=p[pe+7]<<24;case 7:T^=p[pe+6]<<16;case 6:T^=p[pe+5]<<8;case 5:T^=p[pe+4],T=n(T,se),T=s(T,16),T=n(T,ie),v^=T;case 4:C^=p[pe+3]<<24;case 3:C^=p[pe+2]<<16;case 2:C^=p[pe+1]<<8;case 1:C^=p[pe],C=n(C,M),C=s(C,15),C=n(C,se),b^=C}return b^=p.length,v^=p.length,R^=p.length,k^=p.length,b+=v,b+=R,b+=k,v+=b,R+=b,k+=b,b=o(b),v=o(v),R=o(R),k=o(k),b+=v,b+=R,b+=k,v+=b,R+=b,k+=b,("00000000"+(b>>>0).toString(16)).slice(-8)+("00000000"+(v>>>0).toString(16)).slice(-8)+("00000000"+(R>>>0).toString(16)).slice(-8)+("00000000"+(k>>>0).toString(16)).slice(-8)},t.x64.hash128=function(p,y){if(t.inputValidation&&!i(p))return e;y=y||0;for(var g=p.length%16,w=p.length-g,b=[0,y],v=[0,y],R=[0,0],k=[0,0],C=[2277735313,289559509],T=[1291169091,658871167],D=0;D<w;D=D+16)R=[p[D+4]|p[D+5]<<8|p[D+6]<<16|p[D+7]<<24,p[D]|p[D+1]<<8|p[D+2]<<16|p[D+3]<<24],k=[p[D+12]|p[D+13]<<8|p[D+14]<<16|p[D+15]<<24,p[D+8]|p[D+9]<<8|p[D+10]<<16|p[D+11]<<24],R=c(R,C),R=u(R,31),R=c(R,T),b=d(b,R),b=u(b,27),b=a(b,v),b=a(c(b,[0,5]),[0,1390208809]),k=c(k,T),k=u(k,33),k=c(k,C),v=d(v,k),v=u(v,31),v=a(v,b),v=a(c(v,[0,5]),[0,944331445]);switch(R=[0,0],k=[0,0],g){case 15:k=d(k,f([0,p[D+14]],48));case 14:k=d(k,f([0,p[D+13]],40));case 13:k=d(k,f([0,p[D+12]],32));case 12:k=d(k,f([0,p[D+11]],24));case 11:k=d(k,f([0,p[D+10]],16));case 10:k=d(k,f([0,p[D+9]],8));case 9:k=d(k,[0,p[D+8]]),k=c(k,T),k=u(k,33),k=c(k,C),v=d(v,k);case 8:R=d(R,f([0,p[D+7]],56));case 7:R=d(R,f([0,p[D+6]],48));case 6:R=d(R,f([0,p[D+5]],40));case 5:R=d(R,f([0,p[D+4]],32));case 4:R=d(R,f([0,p[D+3]],24));case 3:R=d(R,f([0,p[D+2]],16));case 2:R=d(R,f([0,p[D+1]],8));case 1:R=d(R,[0,p[D]]),R=c(R,C),R=u(R,31),R=c(R,T),b=d(b,R)}return b=d(b,[0,p.length]),v=d(v,[0,p.length]),b=a(b,v),v=a(v,b),b=h(b),v=h(v),b=a(b,v),v=a(v,b),("00000000"+(b[0]>>>0).toString(16)).slice(-8)+("00000000"+(b[1]>>>0).toString(16)).slice(-8)+("00000000"+(v[0]>>>0).toString(16)).slice(-8)+("00000000"+(v[1]>>>0).toString(16)).slice(-8)},typeof V2!="undefined"?(typeof Zb!="undefined"&&Zb.exports&&(V2=Zb.exports=t),V2.murmurHash3=t):typeof define=="function"&&define.amd?define([],function(){return t}):(t._murmurHash3=r.murmurHash3,t.noConflict=function(){return r.murmurHash3=t._murmurHash3,t._murmurHash3=e,t.noConflict=e,t},r.murmurHash3=t)})(V2)});var Vz=m((xht,Kz)=>{l();Kz.exports=Fz()});var z2=m((Kht,Gz)=>{l();"use strict";function $z(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function Oxe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return $z(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),$z(new n,t)}}Gz.exports=Oxe});var on=m((npt,aH)=>{l();"use strict";var{Buffer:ta}=ci(),oH=Symbol.for("BufferList");function Ir(r){if(!(this instanceof Ir))return new Ir(r);Ir._init.call(this,r)}Ir._init=function(e){Object.defineProperty(this,oH,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};Ir.prototype._new=function(e){return new Ir(e)};Ir.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};Ir.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};Ir.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};Ir.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};Ir.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||ta.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,u=s&&t||0,f=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:ta.concat(this._bufs,this.length);for(let d=0;d<this._bufs.length;d++)this._bufs[d].copy(e,u),u+=this._bufs[d].length;return e}if(c<=this._bufs[o[0]].length-f)return s?this._bufs[o[0]].copy(e,t,f,f+c):this._bufs[o[0]].slice(f,f+c);s||(e=ta.allocUnsafe(a));for(let d=o[0];d<this._bufs.length;d++){let h=this._bufs[d].length-f;if(c>h)this._bufs[d].copy(e,u,f),u+=h;else{this._bufs[d].copy(e,u,f,f+c),u+=h;break}c-=h,f&&(f=0)}return e.length>u?e.slice(0,u):e};Ir.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};Ir.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};Ir.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};Ir.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};Ir.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(ta.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(ta.from(e));return this};Ir.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};Ir.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=ta.from([r]):typeof r=="string"?r=ta.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=ta.from(r.buffer,r.byteOffset,r.byteLength):ta.isBuffer(r)||(r=ta.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};Ir.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?Ir.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:Ir.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();Ir.prototype._isBufferList=function(e){return e instanceof Ir||Ir.isBufferList(e)};Ir.isBufferList=function(e){return e!=null&&e[oH]};aH.exports=Ir});var lH=m((spt,uH)=>{l();var cH=class{constructor(e,t=12,i=8*1024,n=32*1024,s=64,o){this.bits=t,this.min=i,this.max=n,this.asModule=e,this.rabin=new e.Rabin(t,i,n,s,o),this.polynomial=o}fingerprint(e){let{__retain:t,__release:i,__allocArray:n,__getInt32Array:s,Int32Array_ID:o,Uint8Array_ID:a}=this.asModule,c=new Int32Array(Math.ceil(e.length/this.min)),u=t(n(o,c)),f=t(n(a,e)),d=this.rabin.fingerprint(f,u),h=s(d);i(f),i(u);let p=h.indexOf(0);return p>=0?h.subarray(0,p):h}};uH.exports=cH});var SH=m(G2=>{l();"use strict";var PS=-8,Jb=-4,Uxe=0,fH=1,dH=1<<0,e6=1<<1,opt=1<<2,apt=1<<3,hH=5,cpt=1<<hH,pH=1<<10,yH=1<<11,upt=1<<12,Fxe=1<<13,gH=14,lpt=1<<gH,fpt=1<<19,dpt=1<<20,hpt=1<<21,ppt=1<<22,Kxe=0,CS=4,Vxe=8,zxe=12,mH=12,Hxe=16,$xe=typeof BigUint64Array!="undefined",H2=Symbol(),$2=1024;function bH(r,e){let t=new Uint32Array(r),i=new Uint16Array(r);var n=t[e+Jb>>>2]>>>1,s=e>>>1;if(n<=$2)return String.fromCharCode.apply(String,i.subarray(s,s+n));let o=[];do{let a=i[s+$2-1],c=a>=55296&&a<56320?$2-1:$2;o.push(String.fromCharCode.apply(String,i.subarray(s,s+=c))),n-=c}while(n>$2);return o.join("")+String.fromCharCode.apply(String,i.subarray(s,s+n))}function OS(r){let e={};function t(n,s){return n?bH(n.buffer,s):"<yet unknown>"}let i=r.env=r.env||{};return i.abort=i.abort||function(s,o,a,c){let u=e.memory||i.memory;throw Error("abort: "+t(u,s)+" at "+t(u,o)+":"+a+":"+c)},i.trace=i.trace||function(s,o){let a=e.memory||i.memory;console.log("trace: "+t(a,s)+(o?" ":"")+Array.prototype.slice.call(arguments,2,2+o).join(", "))},r.Math=r.Math||Math,r.Date=r.Date||Date,e}function kS(r,e){let t=e.exports,i=t.memory,n=t.table,s=t.__alloc,o=t.__retain,a=t.__rtti_base||~0;function c(T){let D=new Uint32Array(i.buffer),j=D[a>>>2];if((T>>>=0)>=j)throw Error("invalid id: "+T);return D[(a+4>>>2)+T*2]}function u(T){let D=new Uint32Array(i.buffer),j=D[a>>>2];if((T>>>=0)>=j)throw Error("invalid id: "+T);return D[(a+4>>>2)+T*2+1]}function f(T){return 31-Math.clz32(T>>>hH&31)}function d(T){return 31-Math.clz32(T>>>gH&31)}function h(T){let D=T.length,j=s(D<<1,fH),M=new Uint16Array(i.buffer);for(var se=0,ie=j>>>1;se<D;++se)M[ie+se]=T.charCodeAt(se);return j}r.__allocString=h;function p(T){let D=i.buffer;if(new Uint32Array(D)[T+PS>>>2]!==fH)throw Error("not a string: "+T);return bH(D,T)}r.__getString=p;function y(T,D,j){let M=i.buffer;if(j)switch(T){case 2:return new Float32Array(M);case 3:return new Float64Array(M)}else switch(T){case 0:return new(D?Int8Array:Uint8Array)(M);case 1:return new(D?Int16Array:Uint16Array)(M);case 2:return new(D?Int32Array:Uint32Array)(M);case 3:return new(D?BigInt64Array:BigUint64Array)(M)}throw Error("unsupported align: "+T)}function g(T,D){let j=c(T);if(!(j&(dH|e6)))throw Error("not an array: "+T+" @ "+j);let M=f(j),se=D.length,ie=s(se<<M,Uxe),fe=s(j&e6?Hxe:zxe,T),pe=new Uint32Array(i.buffer);pe[fe+Kxe>>>2]=o(ie),pe[fe+CS>>>2]=ie,pe[fe+Vxe>>>2]=se<<M,j&e6&&(pe[fe+mH>>>2]=se);let Be=y(M,j&pH,j&yH);if(j&Fxe)for(let Ae=0;Ae<se;++Ae)Be[(ie>>>M)+Ae]=o(D[Ae]);else Be.set(D,ie>>>M);return fe}r.__allocArray=g;function w(T){let D=new Uint32Array(i.buffer),j=D[T+PS>>>2],M=c(j);if(!(M&dH))throw Error("not an array: "+j);let se=f(M);var ie=D[T+CS>>>2];let fe=M&e6?D[T+mH>>>2]:D[ie+Jb>>>2]>>>se;return y(se,M&pH,M&yH).subarray(ie>>>=se,ie+fe)}r.__getArrayView=w;function b(T){let D=w(T),j=D.length,M=new Array(j);for(let se=0;se<j;se++)M[se]=D[se];return M}r.__getArray=b;function v(T){let D=i.buffer,j=new Uint32Array(D)[T+Jb>>>2];return D.slice(T,T+j)}r.__getArrayBuffer=v;function R(T,D,j){return new T(k(T,D,j))}function k(T,D,j){let M=i.buffer,se=new Uint32Array(M),ie=se[j+CS>>>2];return new T(M,ie,se[ie+Jb>>>2]>>>D)}r.__getInt8Array=R.bind(null,Int8Array,0),r.__getInt8ArrayView=k.bind(null,Int8Array,0),r.__getUint8Array=R.bind(null,Uint8Array,0),r.__getUint8ArrayView=k.bind(null,Uint8Array,0),r.__getUint8ClampedArray=R.bind(null,Uint8ClampedArray,0),r.__getUint8ClampedArrayView=k.bind(null,Uint8ClampedArray,0),r.__getInt16Array=R.bind(null,Int16Array,1),r.__getInt16ArrayView=k.bind(null,Int16Array,1),r.__getUint16Array=R.bind(null,Uint16Array,1),r.__getUint16ArrayView=k.bind(null,Uint16Array,1),r.__getInt32Array=R.bind(null,Int32Array,2),r.__getInt32ArrayView=k.bind(null,Int32Array,2),r.__getUint32Array=R.bind(null,Uint32Array,2),r.__getUint32ArrayView=k.bind(null,Uint32Array,2),$xe&&(r.__getInt64Array=R.bind(null,BigInt64Array,3),r.__getInt64ArrayView=k.bind(null,BigInt64Array,3),r.__getUint64Array=R.bind(null,BigUint64Array,3),r.__getUint64ArrayView=k.bind(null,BigUint64Array,3)),r.__getFloat32Array=R.bind(null,Float32Array,2),r.__getFloat32ArrayView=k.bind(null,Float32Array,2),r.__getFloat64Array=R.bind(null,Float64Array,3),r.__getFloat64ArrayView=k.bind(null,Float64Array,3);function C(T,D){let j=new Uint32Array(i.buffer);var M=j[T+PS>>>2];if(M<=j[a>>>2])do if(M==D)return!0;while(M=u(M));return!1}return r.__instanceof=C,r.memory=r.memory||i,r.table=r.table||n,EH(t,r)}function wH(r){return typeof Response!="undefined"&&r instanceof Response}async function _H(r,e){return wH(r=await r)?vH(r,e):kS(OS(e||(e={})),await WebAssembly.instantiate(r instanceof WebAssembly.Module?r:await WebAssembly.compile(r),e))}G2.instantiate=_H;function Gxe(r,e){return kS(OS(e||(e={})),new WebAssembly.Instance(r instanceof WebAssembly.Module?r:new WebAssembly.Module(r),e))}G2.instantiateSync=Gxe;async function vH(r,e){return WebAssembly.instantiateStreaming?kS(OS(e||(e={})),(await WebAssembly.instantiateStreaming(r,e)).instance):_H(wH(r=await r)?r.arrayBuffer():r,e)}G2.instantiateStreaming=vH;function EH(r,e){var t=e?Object.create(e):{},i=r.__argumentsLength?function(n){r.__argumentsLength.value=n}:r.__setArgumentsLength||r.__setargc||function(){};for(let n in r){if(!Object.prototype.hasOwnProperty.call(r,n))continue;let s=r[n],o=n.split("."),a=t;for(;o.length>1;){let f=o.shift();Object.prototype.hasOwnProperty.call(a,f)||(a[f]={}),a=a[f]}let c=o[0],u=c.indexOf("#");if(u>=0){let f=c.substring(0,u),d=a[f];if(typeof d=="undefined"||!d.prototype){let h=function(...p){return h.wrap(h.prototype.constructor(0,...p))};h.prototype={valueOf:function(){return this[H2]}},h.wrap=function(p){return Object.create(h.prototype,{[H2]:{value:p,writable:!1}})},d&&Object.getOwnPropertyNames(d).forEach(p=>Object.defineProperty(h,p,Object.getOwnPropertyDescriptor(d,p))),a[f]=h}if(c=c.substring(u+1),a=a[f].prototype,/^(get|set):/.test(c)){if(!Object.prototype.hasOwnProperty.call(a,c=c.substring(4))){let h=r[n.replace("set:","get:")],p=r[n.replace("get:","set:")];Object.defineProperty(a,c,{get:function(){return h(this[H2])},set:function(y){p(this[H2],y)},enumerable:!0})}}else c==="constructor"?(a[c]=(...h)=>(i(h.length),s(...h))).original=s:(a[c]=function(...h){return i(h.length),s(this[H2],...h)}).original=s}else/^(get|set):/.test(c)?Object.prototype.hasOwnProperty.call(a,c=c.substring(4))||Object.defineProperty(a,c,{get:r[n.replace("set:","get:")],set:r[n.replace("get:","set:")],enumerable:!0}):typeof s=="function"&&s!==i?(a[c]=(...f)=>(i(f.length),s(...f))).original=s:a[c]=s}return t}G2.demangle=EH});var RH=m((gpt,AH)=>{l();var{instantiate:Wxe}=SH();DS.supported=typeof WebAssembly!="undefined";function DS(r={}){if(!DS.supported)return null;var e=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return Wxe(new Response(new Blob([e],{type:"application/wasm"})),r)}AH.exports=DS});var TH=m((mpt,IH)=>{l();var xH=lH(),Yxe=RH(),Xxe=async(r,e,t,i,n)=>{let s=await Yxe();return new xH(s,r,e,t,i,n)};IH.exports={Rabin:xH,create:Xxe}});var qH=m((Bpt,jH)=>{l();"use strict";var r6=7;jH.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,t){let i=this._internalPositionFor(e,!1);if(t===void 0)i!==-1&&(this._unsetInternalPos(i),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let n=!1;i===-1?(i=this._data.length,this._setBit(e),this._changedData=!0):n=!0,this._setInternalPos(i,e,t,n),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();let t=this._internalPositionFor(e,!0);if(t!==-1)return this._data[t][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){let e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let t=0;for(;t<this.length;)e(this.get(t),t,this),t++}map(e){let t=0,i=new Array(this.length);for(;t<this.length;)i[t]=e(this.get(t),t,this),t++;return i}reduce(e,t){let i=0,n=t;for(;i<this.length;){let s=this.get(i);n=e(n,s,i),i++}return n}find(e){let t=0,i,n;for(;t<this.length&&!i;)n=this.get(t),i=e(n),t++;return i?n:void 0}_internalPositionFor(e,t){let i=this._bytePosFor(e,t);if(i>=this._bitArrays.length)return-1;let n=this._bitArrays[i],s=e-i*r6;if(!((n&1<<s)>0))return-1;let a=this._bitArrays.slice(0,i).reduce(sIe,0),c=~(4294967295<<s+1),u=MH(n&c);return a+u-1}_bytePosFor(e,t){let i=Math.floor(e/r6),n=i+1;for(;!t&&this._bitArrays.length<n;)this._bitArrays.push(0);return i}_setBit(e){let t=this._bytePosFor(e,!1);this._bitArrays[t]|=1<<e-t*r6}_unsetBit(e){let t=this._bytePosFor(e,!1);this._bitArrays[t]&=~(1<<e-t*r6)}_setInternalPos(e,t,i,n){let s=this._data,o=[t,i];if(n)this._sortData(),s[e]=o;else{if(s.length)if(s[s.length-1][0]>=t)s.push(o);else if(s[0][0]<=t)s.unshift(o);else{let a=Math.round(s.length/2);this._data=s.slice(0,a).concat(o).concat(s.slice(a))}else this._data.push(o);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(oIe),this._changedData=!1}bitField(){let e=[],t=8,i=0,n=0,s,o=this._bitArrays.slice();for(;o.length||i;){i===0&&(s=o.shift(),i=7);let c=Math.min(i,t),u=~(255<<c);n|=(s&u)<<8-t,s=s>>>c,i-=c,t-=c,(!t||!i&&!o.length)&&(e.push(n),n=0,t=8)}for(var a=e.length-1;a>0&&e[a]===0;a--)e.pop();return e}compactArray(){return this._sortData(),this._data.map(aIe)}};function sIe(r,e){return r+MH(e)}function MH(r){let e=r;return e=e-(e>>1&1431655765),e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>24}function oIe(r,e){return r[0]-e[0]}function aIe(r){return r[1]}});var KH=m((Lpt,FH)=>{l();"use strict";var cIe=qH(),{fromString:uIe}=(at(),Xr),ra=class{constructor(e,t,i=0){this._options=e,this._popCount=0,this._parent=t,this._posAtParent=i,this._children=new cIe,this.key=null}async put(e,t){let i=await this._findNewBucketAndPos(e);await i.bucket._putAt(i,e,t)}async get(e){let t=await this._findChild(e);if(t)return t.value}async del(e){let t=await this._findPlace(e),i=t.bucket._at(t.pos);i&&i.key===e&&t.bucket._delAt(t.pos)}leafCount(){return this._children.compactArray().reduce((t,i)=>i instanceof ra?t+i.leafCount():t+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let e=this._children.compactArray();for(let t of e)t instanceof ra?yield*t.eachLeafSeries():yield t;return[]}serialize(e,t){let i=[];return t(this._children.reduce((n,s,o)=>(s&&(s instanceof ra?n.push(s.serialize(e,t)):n.push(e(s,o))),n),i))}asyncTransform(e,t){return UH(this,e,t)}toJSON(){return this.serialize(fIe,dIe)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){let t=await this._findPlace(e),i=t.bucket._at(t.pos);if(!(i instanceof ra)&&i&&i.key===e)return i}async _findPlace(e){let t=this._options.hash(typeof e=="string"?uIe(e):e),i=await t.take(this._options.bits),n=this._children.get(i);return n instanceof ra?n._findPlace(t):{bucket:this,pos:i,hash:t,existingChild:n}}async _findNewBucketAndPos(e){let t=await this._findPlace(e);if(t.existingChild&&t.existingChild.key!==e){let i=new ra(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,i);let n=await i._findPlace(t.existingChild.hash);return n.bucket._putAt(n,t.existingChild.key,t.existingChild.value),i._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,i){this._putObjectAt(e.pos,{key:t,value:i,hash:e.hash})}_putObjectAt(e,t){this._children.get(e)||this._popCount++,this._children.set(e,t)}_delAt(e){if(e===-1)throw new Error("Invalid position");this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(this._parent&&this._popCount<=1)if(this._popCount===1){let e=this._children.find(lIe);if(e&&!(e instanceof ra)){let t=e.hash;t.untake(this._options.bits);let i={pos:this._posAtParent,hash:t,bucket:this._parent};this._parent._putAt(i,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}};function lIe(r){return Boolean(r)}function fIe(r,e){return r.key}function dIe(r){return r}async function UH(r,e,t){let i=[];for(let n of r._children.compactArray())if(n instanceof ra)await UH(n,e,t);else{let s=await e(n);i.push({bitField:r._children.bitField(),children:s})}return t(i)}FH.exports=ra});var zH=m((jpt,VH)=>{l();"use strict";var hIe=[255,254,252,248,240,224,192,128],pIe=[1,3,7,15,31,63,127,255];VH.exports=class{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(e){let t=e,i=0;for(;t&&this._haveBits();){let n=this._value[this._currentBytePos],s=this._currentBitPos+1,o=Math.min(s,t),a=yIe(n,s-o,o);i=(i<<o)+a,t-=o,this._currentBitPos-=o,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return i}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function yIe(r,e,t){let i=gIe(e,t);return(r&i)>>>e}function gIe(r,e){return hIe[r]&pIe[Math.min(e+r-1,7)]}});var HH=m((qpt,MS)=>{l();"use strict";var mIe=zH(),{concat:bIe}=(Ri(),Cn);function wIe(r){function e(t){return t instanceof i6?t:new i6(t,r)}return e}var i6=class{constructor(e,t){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let i=0;for(;t>0;){let n=this._buffers[this._currentBufferIndex],s=Math.min(n.availableBits(),t),o=n.take(s);i=(i<<s)+o,t-=s,this._availableBits-=s,n.availableBits()===0&&this._currentBufferIndex++}return i}untake(e){let t=e;for(;t>0;){let i=this._buffers[this._currentBufferIndex],n=Math.min(i.totalBits()-i.availableBits(),t);i.untake(n),t-=n,this._availableBits+=n,this._currentBufferIndex>0&&i.totalBits()===i.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let e=this._depth?bIe([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),i=new mIe(t);this._buffers.push(i),this._availableBits+=i.availableBits()}};MS.exports=wIe;MS.exports.InfiniteHash=i6});var Y2=m((Upt,GH)=>{l();"use strict";var $H=KH(),_Ie=HH();function vIe(r){if(!r||!r.hashFn)throw new Error("please define an options.hashFn");let e={bits:r.bits||8,hash:_Ie(r.hashFn)};return new $H(e)}GH.exports={createHAMT:vIe,Bucket:$H}});var au=m((b0t,l$)=>{l();"use strict";function u$(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function OIe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return u$(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),u$(new n,t)}}l$.exports=OIe});var D$=m(y6=>{l();var{Buffer:VS}=ci(),c0=on(),JIe="0".charCodeAt(0),eTe=VS.from("ustar\0","binary"),tTe=VS.from("ustar ","binary"),rTe=VS.from(" \0","binary"),p6=257,O$=263,iTe=function(r,e,t){return typeof r!="number"?t:(r=~~r,r>=e?e:r>=0||(r+=e,r>=0)?r:0)},nTe=function(r){switch(r){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null},k$=function(r,e,t,i){for(;t<i;t++)if(r.get(t)===e)return t;return i},sTe=function(r){let e=8*32;for(let t=0;t<148;t++)e+=r.get(t);for(let t=156;t<512;t++)e+=r.get(t);return e};function oTe(r){let e;if(r.get(0)===128)e=!0;else if(r.get(0)===255)e=!1;else return null;let t=!1,i=[];for(let o=r.length-1;o>0;o--){let a=r.get(o);e?i.push(a):t&&a===0?i.push(0):t?(t=!1,i.push(256-a)):i.push(255-a)}let n=0,s=i.length;for(let o=0;o<s;o++)n+=i[o]*Math.pow(256,o);return e?n:-1*n}var xl=function(r,e,t){if(r=r.shallowSlice(e,e+t),e=0,r.get(e)&128)return oTe(r);{for(;e<r.length&&r.get(e)===32;)e++;let i=iTe(k$(r,32,e,r.length),r.length,r.length);for(;e<i&&r.get(e)===0;)e++;return i===e?0:parseInt(r.shallowSlice(e,i).toString(),8)}},u0=function(r,e,t,i){return r.shallowSlice(e,k$(r,0,e,e+t)).toString(i)};y6.decodeLongPath=function(r,e){return r=c0.isBufferList(r)?r:new c0(r),u0(r,0,r.length,e)};y6.decodePax=function(r){r=c0.isBufferList(r)?r:new c0(r);let e={};for(;r.length;){let t=0;for(;t<r.length&&r.get(t)!==32;)t++;let i=parseInt(r.shallowSlice(0,t).toString(),10);if(!i)return e;let n=r.shallowSlice(t+1,i-1).toString(),s=n.indexOf("=");if(s===-1)return e;e[n.slice(0,s)]=n.slice(s+1),r=r.shallowSlice(i)}return e};y6.decode=function(r,e){r=c0.isBufferList(r)?r:new c0(r);let t=r.get(156)===0?0:r.get(156)-JIe,i=u0(r,0,100,e),n=xl(r,100,8),s=xl(r,108,8),o=xl(r,116,8),a=xl(r,124,12),c=xl(r,136,12),u=nTe(t),f=r.get(157)===0?null:u0(r,157,100,e),d=u0(r,265,32),h=u0(r,297,32),p=xl(r,329,8),y=xl(r,337,8),g=sTe(r);if(g===8*32)return null;if(g!==xl(r,148,8))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if(eTe.compare(r.slice(p6,p6+6))===0)r.get(345)&&(i=u0(r,345,155,e)+"/"+i);else if(!(tTe.compare(r.slice(p6,p6+6))===0&&rTe.compare(r.slice(O$,O$+2))===0))throw new Error("Invalid tar header: unknown format.");return t===0&&i&&i[i.length-1]==="/"&&(t=5),{name:i,mode:n,uid:s,gid:o,size:a,mtime:new Date(1e3*c),type:u,linkname:f,uname:d,gname:h,devmajor:p,devminor:y}}});var g6=m((b1t,N$)=>{l();var zS=on();N$.exports=r=>{let e=async function*(){let t=yield,i=new zS;for await(let n of r){if(!t){t=yield i.append(n),i=new zS;continue}for(i.append(n);i.length>=t;){let s=i.shallowSlice(0,t);if(i.consume(t),t=yield s,!t){i.length&&(t=yield i,i=new zS);break}}}if(t)throw Object.assign(new Error(`stream ended before ${t} bytes became available`),{code:"ERR_UNDER_READ",buffer:i})}();return e.next(),e}});var L$=m((w1t,B$)=>{l();var HS=on(),aTe=g6();B$.exports=function(e){let t=aTe(e),i,n={[Symbol.asyncIterator]:()=>n,async next(s){if(i){let o;if(s==null||i.length===s)o=i,i=null;else if(i.length>s)o=i.shallowSlice(0,s),i=i.shallowSlice(s);else if(i.length<s){let{value:a,done:c}=await t.next(s-i.length);if(c)throw Object.assign(new Error(`stream ended before ${s-i.length} bytes became available`),{code:"ERR_UNDER_READ"});o=new HS([i,a]),i=null}return{value:o}}return t.next(s)},async nextLte(s){let{done:o,value:a}=await n.next();return o?{done:o}:a.length<=s?{value:a}:(a=HS.isBufferList(a)?a:new HS(a),i?i.append(a.shallowSlice(s)):i=a.shallowSlice(s),{value:a.shallowSlice(0,s)})},return(){return t.return()}};return n}});var j$=m((_1t,M$)=>{l();var cTe=ec(),Q2=D$(),uTe=L$();function lTe(r){return r&=511,r&&512-r}async function Z2(r,e){let t=lTe(e);t&&await r.next(t)}M$.exports=r=>(r=r||{},r.highWaterMark=r.highWaterMark||1024*16,e=>async function*(){let t=uTe(e),i,n,s,o;try{for(;;){let a;try{let{done:p,value:y}=await t.next(512);if(p)return;a=y}catch(p){if(p.code==="ERR_UNDER_READ")return;throw p}let c=Q2.decode(a,r.filenameEncoding);if(!c)continue;if(c.type==="gnu-long-path"){let{done:p,value:y}=await t.next(c.size);if(p)return;i=Q2.decodeLongPath(y,r.filenameEncoding),await Z2(t,c.size);continue}if(c.type==="gnu-long-link-path"){let{done:p,value:y}=await t.next(c.size);if(p)return;n=Q2.decodeLongPath(y,r.filenameEncoding),await Z2(t,c.size);continue}if(c.type==="pax-global-header"){let{done:p,value:y}=await t.next(c.size);if(p)return;s=Q2.decodePax(y,r.filenameEncoding),await Z2(t,c.size);continue}if(c.type==="pax-header"){let{done:p,value:y}=await t.next(c.size);if(p)return;o=Q2.decodePax(y,r.filenameEncoding),s&&(o={...s,...o}),await Z2(t,c.size);continue}if(i&&(c.name=i,i=null),n&&(c.linkname=n,n=null),o&&(o.path&&(c.name=o.path),o.linkpath&&(c.linkname=o.linkpath),o.size&&(c.size=parseInt(o.size,10)),c.pax=o,o=null),!c.size||c.type==="directory"){yield{header:c,body:async function*(){}()};continue}let u=c.size,f=cTe(),d=await t.nextLte(Math.min(u,r.highWaterMark));u-=d.value.length,u||f.resolve();let h=async function*(){try{for(yield d.value;u;){let{done:p,value:y}=await t.nextLte(u);if(p){u=0;return}u-=y.length,yield y}}finally{f.resolve()}}();if(yield{header:c,body:h},await f.promise,u)for await(let p of h);await Z2(t,c.size)}}finally{await t.return()}}())});var U$=m((v1t,q$)=>{l();"use strict";q$.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:256,RTLD_LOCAL:0,RTLD_DEEPBIND:8,E2BIG:7,EACCES:13,EADDRINUSE:98,EADDRNOTAVAIL:99,EAFNOSUPPORT:97,EAGAIN:11,EALREADY:114,EBADF:9,EBADMSG:74,EBUSY:16,ECANCELED:125,ECHILD:10,ECONNABORTED:103,ECONNREFUSED:111,ECONNRESET:104,EDEADLK:35,EDESTADDRREQ:89,EDOM:33,EDQUOT:122,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:113,EIDRM:43,EILSEQ:84,EINPROGRESS:115,EINTR:4,EINVAL:22,EIO:5,EISCONN:106,EISDIR:21,ELOOP:40,EMFILE:24,EMLINK:31,EMSGSIZE:90,EMULTIHOP:72,ENAMETOOLONG:36,ENETDOWN:100,ENETRESET:102,ENETUNREACH:101,ENFILE:23,ENOBUFS:105,ENODATA:61,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:37,ENOLINK:67,ENOMEM:12,ENOMSG:42,ENOPROTOOPT:92,ENOSPC:28,ENOSR:63,ENOSTR:60,ENOSYS:38,ENOTCONN:107,ENOTDIR:20,ENOTEMPTY:39,ENOTSOCK:88,ENOTSUP:95,ENOTTY:25,ENXIO:6,EOPNOTSUPP:95,EOVERFLOW:75,EPERM:1,EPIPE:32,EPROTO:71,EPROTONOSUPPORT:93,EPROTOTYPE:91,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:116,ETIME:62,ETIMEDOUT:110,ETXTBSY:26,EWOULDBLOCK:11,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:7,SIGFPE:8,SIGKILL:9,SIGUSR1:10,SIGSEGV:11,SIGUSR2:12,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:17,SIGSTKFLT:16,SIGCONT:18,SIGSTOP:19,SIGTSTP:20,SIGTTIN:21,SIGTTOU:22,SIGURG:23,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:29,SIGPOLL:29,SIGPWR:30,SIGSYS:31,SIGUNUSED:31,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,UV_FS_O_FILEMAP:0,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DSYNC:4096,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488335,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}});var K$=m((E1t,F$)=>{l();var fTe=on(),$S={string:()=>"",buffer:()=>fTe()};F$.exports=async(r,e)=>{if(e=e||{},e.type&&!$S[e.type])throw new Error(`invalid type "${e.type}"`);let t,i;for await(let n of r)t||(i=e.type||(typeof n=="string"?"string":"buffer"),t=$S[i]()),i==="string"?t+=n:t.append(n);return t||$S[e.type||"buffer"]()}});var V$=m(WS=>{l();var{Buffer:tc}=ci(),dTe=tc.alloc,hTe="0000000000000000000",pTe="7777777777777777777",yTe="0".charCodeAt(0),gTe=tc.from("ustar\0","binary"),mTe=tc.from("00","binary"),bTe=parseInt("7777",8),wTe=257,_Te=263,vTe=function(r){switch(r){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0},ETe=function(r){let e=8*32;for(let t=0;t<148;t++)e+=r[t];for(let t=156;t<512;t++)e+=r[t];return e},Il=function(r,e){return r=r.toString(8),r.length>e?pTe.slice(0,e)+" ":hTe.slice(0,e-r.length)+r+" "},GS=function(r){let e=tc.byteLength(r),t=Math.floor(Math.log(e)/Math.log(10))+1;return e+t>=Math.pow(10,t)&&t++,e+t+r};WS.encodePax=function(r){let e="";r.name&&(e+=GS(" path="+r.name+`
`)),r.linkname&&(e+=GS(" linkpath="+r.linkname+`
`));let t=r.pax;if(t)for(let i in t)e+=GS(" "+i+"="+t[i]+`
`);return tc.from(e)};WS.encode=function(r){let e=dTe(512),t=r.name,i="";if(r.typeflag===5&&t[t.length-1]!=="/"&&(t+="/"),tc.byteLength(t)!==t.length)return null;for(;tc.byteLength(t)>100;){let n=t.indexOf("/");if(n===-1)return null;i+=i?"/"+t.slice(0,n):t.slice(0,n),t=t.slice(n+1)}return tc.byteLength(t)>100||tc.byteLength(i)>155||r.linkname&&tc.byteLength(r.linkname)>100?null:(e.write(t),e.write(Il(r.mode&bTe,6),100),e.write(Il(r.uid,6),108),e.write(Il(r.gid,6),116),e.write(Il(r.size,11),124),e.write(Il(r.mtime.getTime()/1e3|0,11),136),e[156]=yTe+vTe(r.type),r.linkname&&e.write(r.linkname,157),gTe.copy(e,wTe),mTe.copy(e,_Te),r.uname&&e.write(r.uname,265),r.gname&&e.write(r.gname,297),e.write(Il(r.devmajor||0,6),329),e.write(Il(r.devminor||0,6),337),i&&e.write(i,345),e.write(Il(ETe(e),6),148),e)}});var $$=m((A1t,H$)=>{l();var{Buffer:YS}=ci(),bd=on(),{S_IFMT:STe,S_IFBLK:ATe,S_IFCHR:RTe,S_IFDIR:xTe,S_IFIFO:ITe,S_IFLNK:TTe}=U$(),PTe=K$(),m6=V$(),CTe=parseInt("755",8),OTe=parseInt("644",8),z$=YS.alloc(1024);function kTe(r){switch(r&STe){case ATe:return"block-device";case RTe:return"character-device";case xTe:return"directory";case ITe:return"fifo";case TTe:return"symlink"}return"file"}function XS(r){if(r&=511,r)return new bd(z$.slice(0,512-r))}function QS(r){if(!r.pax){let e=m6.encode(r);if(e)return e}return DTe(r)}function DTe(r){let e=m6.encodePax({name:r.name,linkname:r.linkname,pax:r.pax}),t={name:"PaxHeader",mode:r.mode,uid:r.uid,gid:r.gid,size:e.length,mtime:r.mtime,type:"pax-header",linkname:r.linkname&&"PaxHeader",uname:r.uname,gname:r.gname,devmajor:r.devmajor,devminor:r.devminor};return new bd([m6.encode(t),e,XS(e.length),m6.encode({...t,size:r.size,type:r.type})])}H$.exports=()=>async function*(r){for await(let{header:e,body:t}of r){if((!e.size||e.type==="symlink")&&(e.size=0),e.type||(e.type=kTe(e.mode)),e.mode||(e.mode=e.type==="directory"?CTe:OTe),e.uid||(e.uid=0),e.gid||(e.gid=0),e.mtime||(e.mtime=new Date),typeof t=="string"&&(t=YS.from(t)),YS.isBuffer(t)||bd.isBufferList(t)){e.size=t.length,yield new bd([QS(e),t,XS(e.size)]);continue}if(e.type==="symlink"&&!e.linkname){e.linkname=(await PTe(t)).toString(),yield QS(e);continue}if(yield QS(e),e.type!=="file"&&e.type!=="contiguous-file")continue;let i=0;for await(let s of t)i+=s.length,yield bd.isBufferList(s)?s:new bd(s);if(i!==e.size)throw new Error("size mismatch");let n=XS(e.size);n&&(yield n)}yield new bd(z$)}});var G$=m(ZS=>{l();ZS.extract=j$();ZS.pack=$$()});var cu=m(Mn=>{l();"use strict";var NTe=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function BTe(r,e){return Object.prototype.hasOwnProperty.call(r,e)}Mn.assign=function(r){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var t=e.shift();if(!!t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(var i in t)BTe(t,i)&&(r[i]=t[i])}}return r};Mn.shrinkBuf=function(r,e){return r.length===e?r:r.subarray?r.subarray(0,e):(r.length=e,r)};var LTe={arraySet:function(r,e,t,i,n){if(e.subarray&&r.subarray){r.set(e.subarray(t,t+i),n);return}for(var s=0;s<i;s++)r[n+s]=e[t+s]},flattenChunks:function(r){var e,t,i,n,s,o;for(i=0,e=0,t=r.length;e<t;e++)i+=r[e].length;for(o=new Uint8Array(i),n=0,e=0,t=r.length;e<t;e++)s=r[e],o.set(s,n),n+=s.length;return o}},MTe={arraySet:function(r,e,t,i,n){for(var s=0;s<i;s++)r[n+s]=e[t+s]},flattenChunks:function(r){return[].concat.apply([],r)}};Mn.setTyped=function(r){r?(Mn.Buf8=Uint8Array,Mn.Buf16=Uint16Array,Mn.Buf32=Int32Array,Mn.assign(Mn,LTe)):(Mn.Buf8=Array,Mn.Buf16=Array,Mn.Buf32=Array,Mn.assign(Mn,MTe))};Mn.setTyped(NTe)});var gG=m(d0=>{l();"use strict";var jTe=cu(),qTe=4,W$=0,Y$=1,UTe=2;function l0(r){for(var e=r.length;--e>=0;)r[e]=0}var FTe=0,X$=1,KTe=2,VTe=3,zTe=258,JS=29,J2=256,eg=J2+1+JS,f0=30,eA=19,Q$=2*eg+1,wd=15,tA=16,HTe=7,rA=256,Z$=16,J$=17,eG=18,iA=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],b6=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],$Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],tG=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],GTe=512,uu=new Array((eg+2)*2);l0(uu);var tg=new Array(f0*2);l0(tg);var rg=new Array(GTe);l0(rg);var ig=new Array(zTe-VTe+1);l0(ig);var nA=new Array(JS);l0(nA);var w6=new Array(f0);l0(w6);function sA(r,e,t,i,n){this.static_tree=r,this.extra_bits=e,this.extra_base=t,this.elems=i,this.max_length=n,this.has_stree=r&&r.length}var rG,iG,nG;function oA(r,e){this.dyn_tree=r,this.max_code=0,this.stat_desc=e}function sG(r){return r<256?rg[r]:rg[256+(r>>>7)]}function ng(r,e){r.pending_buf[r.pending++]=e&255,r.pending_buf[r.pending++]=e>>>8&255}function ns(r,e,t){r.bi_valid>tA-t?(r.bi_buf|=e<<r.bi_valid&65535,ng(r,r.bi_buf),r.bi_buf=e>>tA-r.bi_valid,r.bi_valid+=t-tA):(r.bi_buf|=e<<r.bi_valid&65535,r.bi_valid+=t)}function rc(r,e,t){ns(r,t[e*2],t[e*2+1])}function oG(r,e){var t=0;do t|=r&1,r>>>=1,t<<=1;while(--e>0);return t>>>1}function WTe(r){r.bi_valid===16?(ng(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):r.bi_valid>=8&&(r.pending_buf[r.pending++]=r.bi_buf&255,r.bi_buf>>=8,r.bi_valid-=8)}function YTe(r,e){var t=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,c=e.stat_desc.max_length,u,f,d,h,p,y,g=0;for(h=0;h<=wd;h++)r.bl_count[h]=0;for(t[r.heap[r.heap_max]*2+1]=0,u=r.heap_max+1;u<Q$;u++)f=r.heap[u],h=t[t[f*2+1]*2+1]+1,h>c&&(h=c,g++),t[f*2+1]=h,!(f>i)&&(r.bl_count[h]++,p=0,f>=a&&(p=o[f-a]),y=t[f*2],r.opt_len+=y*(h+p),s&&(r.static_len+=y*(n[f*2+1]+p)));if(g!==0){do{for(h=c-1;r.bl_count[h]===0;)h--;r.bl_count[h]--,r.bl_count[h+1]+=2,r.bl_count[c]--,g-=2}while(g>0);for(h=c;h!==0;h--)for(f=r.bl_count[h];f!==0;)d=r.heap[--u],!(d>i)&&(t[d*2+1]!==h&&(r.opt_len+=(h-t[d*2+1])*t[d*2],t[d*2+1]=h),f--)}}function aG(r,e,t){var i=new Array(wd+1),n=0,s,o;for(s=1;s<=wd;s++)i[s]=n=n+t[s-1]<<1;for(o=0;o<=e;o++){var a=r[o*2+1];a!==0&&(r[o*2]=oG(i[a]++,a))}}function XTe(){var r,e,t,i,n,s=new Array(wd+1);for(t=0,i=0;i<JS-1;i++)for(nA[i]=t,r=0;r<1<<iA[i];r++)ig[t++]=i;for(ig[t-1]=i,n=0,i=0;i<16;i++)for(w6[i]=n,r=0;r<1<<b6[i];r++)rg[n++]=i;for(n>>=7;i<f0;i++)for(w6[i]=n<<7,r=0;r<1<<b6[i]-7;r++)rg[256+n++]=i;for(e=0;e<=wd;e++)s[e]=0;for(r=0;r<=143;)uu[r*2+1]=8,r++,s[8]++;for(;r<=255;)uu[r*2+1]=9,r++,s[9]++;for(;r<=279;)uu[r*2+1]=7,r++,s[7]++;for(;r<=287;)uu[r*2+1]=8,r++,s[8]++;for(aG(uu,eg+1,s),r=0;r<f0;r++)tg[r*2+1]=5,tg[r*2]=oG(r,5);rG=new sA(uu,iA,J2+1,eg,wd),iG=new sA(tg,b6,0,f0,wd),nG=new sA(new Array(0),$Te,0,eA,HTe)}function cG(r){var e;for(e=0;e<eg;e++)r.dyn_ltree[e*2]=0;for(e=0;e<f0;e++)r.dyn_dtree[e*2]=0;for(e=0;e<eA;e++)r.bl_tree[e*2]=0;r.dyn_ltree[rA*2]=1,r.opt_len=r.static_len=0,r.last_lit=r.matches=0}function uG(r){r.bi_valid>8?ng(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0}function QTe(r,e,t,i){uG(r),i&&(ng(r,t),ng(r,~t)),jTe.arraySet(r.pending_buf,r.window,e,t,r.pending),r.pending+=t}function lG(r,e,t,i){var n=e*2,s=t*2;return r[n]<r[s]||r[n]===r[s]&&i[e]<=i[t]}function aA(r,e,t){for(var i=r.heap[t],n=t<<1;n<=r.heap_len&&(n<r.heap_len&&lG(e,r.heap[n+1],r.heap[n],r.depth)&&n++,!lG(e,i,r.heap[n],r.depth));)r.heap[t]=r.heap[n],t=n,n<<=1;r.heap[t]=i}function fG(r,e,t){var i,n,s=0,o,a;if(r.last_lit!==0)do i=r.pending_buf[r.d_buf+s*2]<<8|r.pending_buf[r.d_buf+s*2+1],n=r.pending_buf[r.l_buf+s],s++,i===0?rc(r,n,e):(o=ig[n],rc(r,o+J2+1,e),a=iA[o],a!==0&&(n-=nA[o],ns(r,n,a)),i--,o=sG(i),rc(r,o,t),a=b6[o],a!==0&&(i-=w6[o],ns(r,i,a)));while(s<r.last_lit);rc(r,rA,e)}function cA(r,e){var t=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems,o,a,c=-1,u;for(r.heap_len=0,r.heap_max=Q$,o=0;o<s;o++)t[o*2]!==0?(r.heap[++r.heap_len]=c=o,r.depth[o]=0):t[o*2+1]=0;for(;r.heap_len<2;)u=r.heap[++r.heap_len]=c<2?++c:0,t[u*2]=1,r.depth[u]=0,r.opt_len--,n&&(r.static_len-=i[u*2+1]);for(e.max_code=c,o=r.heap_len>>1;o>=1;o--)aA(r,t,o);u=s;do o=r.heap[1],r.heap[1]=r.heap[r.heap_len--],aA(r,t,1),a=r.heap[1],r.heap[--r.heap_max]=o,r.heap[--r.heap_max]=a,t[u*2]=t[o*2]+t[a*2],r.depth[u]=(r.depth[o]>=r.depth[a]?r.depth[o]:r.depth[a])+1,t[o*2+1]=t[a*2+1]=u,r.heap[1]=u++,aA(r,t,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],YTe(r,e),aG(t,c,r.bl_count)}function dG(r,e,t){var i,n=-1,s,o=e[0*2+1],a=0,c=7,u=4;for(o===0&&(c=138,u=3),e[(t+1)*2+1]=65535,i=0;i<=t;i++)s=o,o=e[(i+1)*2+1],!(++a<c&&s===o)&&(a<u?r.bl_tree[s*2]+=a:s!==0?(s!==n&&r.bl_tree[s*2]++,r.bl_tree[Z$*2]++):a<=10?r.bl_tree[J$*2]++:r.bl_tree[eG*2]++,a=0,n=s,o===0?(c=138,u=3):s===o?(c=6,u=3):(c=7,u=4))}function hG(r,e,t){var i,n=-1,s,o=e[0*2+1],a=0,c=7,u=4;for(o===0&&(c=138,u=3),i=0;i<=t;i++)if(s=o,o=e[(i+1)*2+1],!(++a<c&&s===o)){if(a<u)do rc(r,s,r.bl_tree);while(--a!=0);else s!==0?(s!==n&&(rc(r,s,r.bl_tree),a--),rc(r,Z$,r.bl_tree),ns(r,a-3,2)):a<=10?(rc(r,J$,r.bl_tree),ns(r,a-3,3)):(rc(r,eG,r.bl_tree),ns(r,a-11,7));a=0,n=s,o===0?(c=138,u=3):s===o?(c=6,u=3):(c=7,u=4)}}function ZTe(r){var e;for(dG(r,r.dyn_ltree,r.l_desc.max_code),dG(r,r.dyn_dtree,r.d_desc.max_code),cA(r,r.bl_desc),e=eA-1;e>=3&&r.bl_tree[tG[e]*2+1]===0;e--);return r.opt_len+=3*(e+1)+5+5+4,e}function JTe(r,e,t,i){var n;for(ns(r,e-257,5),ns(r,t-1,5),ns(r,i-4,4),n=0;n<i;n++)ns(r,r.bl_tree[tG[n]*2+1],3);hG(r,r.dyn_ltree,e-1),hG(r,r.dyn_dtree,t-1)}function ePe(r){var e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&r.dyn_ltree[t*2]!==0)return W$;if(r.dyn_ltree[9*2]!==0||r.dyn_ltree[10*2]!==0||r.dyn_ltree[13*2]!==0)return Y$;for(t=32;t<J2;t++)if(r.dyn_ltree[t*2]!==0)return Y$;return W$}var pG=!1;function tPe(r){pG||(XTe(),pG=!0),r.l_desc=new oA(r.dyn_ltree,rG),r.d_desc=new oA(r.dyn_dtree,iG),r.bl_desc=new oA(r.bl_tree,nG),r.bi_buf=0,r.bi_valid=0,cG(r)}function yG(r,e,t,i){ns(r,(FTe<<1)+(i?1:0),3),QTe(r,e,t,!0)}function rPe(r){ns(r,X$<<1,3),rc(r,rA,uu),WTe(r)}function iPe(r,e,t,i){var n,s,o=0;r.level>0?(r.strm.data_type===UTe&&(r.strm.data_type=ePe(r)),cA(r,r.l_desc),cA(r,r.d_desc),o=ZTe(r),n=r.opt_len+3+7>>>3,s=r.static_len+3+7>>>3,s<=n&&(n=s)):n=s=t+5,t+4<=n&&e!==-1?yG(r,e,t,i):r.strategy===qTe||s===n?(ns(r,(X$<<1)+(i?1:0),3),fG(r,uu,tg)):(ns(r,(KTe<<1)+(i?1:0),3),JTe(r,r.l_desc.max_code+1,r.d_desc.max_code+1,o+1),fG(r,r.dyn_ltree,r.dyn_dtree)),cG(r),i&&uG(r)}function nPe(r,e,t){return r.pending_buf[r.d_buf+r.last_lit*2]=e>>>8&255,r.pending_buf[r.d_buf+r.last_lit*2+1]=e&255,r.pending_buf[r.l_buf+r.last_lit]=t&255,r.last_lit++,e===0?r.dyn_ltree[t*2]++:(r.matches++,e--,r.dyn_ltree[(ig[t]+J2+1)*2]++,r.dyn_dtree[sG(e)*2]++),r.last_lit===r.lit_bufsize-1}d0._tr_init=tPe;d0._tr_stored_block=yG;d0._tr_flush_block=iPe;d0._tr_tally=nPe;d0._tr_align=rPe});var uA=m((T1t,mG)=>{l();"use strict";function sPe(r,e,t,i){for(var n=r&65535|0,s=r>>>16&65535|0,o=0;t!==0;){o=t>2e3?2e3:t,t-=o;do n=n+e[i++]|0,s=s+n|0;while(--o);n%=65521,s%=65521}return n|s<<16|0}mG.exports=sPe});var lA=m((P1t,bG)=>{l();"use strict";function oPe(){for(var r,e=[],t=0;t<256;t++){r=t;for(var i=0;i<8;i++)r=r&1?3988292384^r>>>1:r>>>1;e[t]=r}return e}var aPe=oPe();function cPe(r,e,t,i){var n=aPe,s=i+t;r^=-1;for(var o=i;o<s;o++)r=r>>>8^n[(r^e[o])&255];return r^-1}bG.exports=cPe});var _6=m((C1t,wG)=>{l();"use strict";wG.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var TG=m(sc=>{l();"use strict";var jn=cu(),oo=gG(),_G=uA(),Tl=lA(),uPe=_6(),_d=0,lPe=1,fPe=3,Pl=4,vG=5,ic=0,EG=1,ao=-2,dPe=-3,fA=-5,hPe=-1,pPe=1,v6=2,yPe=3,gPe=4,mPe=0,bPe=2,E6=8,wPe=9,_Pe=15,vPe=8,EPe=29,SPe=256,dA=SPe+1+EPe,APe=30,RPe=19,xPe=2*dA+1,IPe=15,Lt=3,Cl=258,ia=Cl+Lt+1,TPe=32,S6=42,hA=69,A6=73,R6=91,x6=103,vd=113,sg=666,qi=1,og=2,Ed=3,h0=4,PPe=3;function Ol(r,e){return r.msg=uPe[e],e}function SG(r){return(r<<1)-(r>4?9:0)}function kl(r){for(var e=r.length;--e>=0;)r[e]=0}function Dl(r){var e=r.state,t=e.pending;t>r.avail_out&&(t=r.avail_out),t!==0&&(jn.arraySet(r.output,e.pending_buf,e.pending_out,t,r.next_out),r.next_out+=t,e.pending_out+=t,r.total_out+=t,r.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))}function cn(r,e){oo._tr_flush_block(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,e),r.block_start=r.strstart,Dl(r.strm)}function Qt(r,e){r.pending_buf[r.pending++]=e}function ag(r,e){r.pending_buf[r.pending++]=e>>>8&255,r.pending_buf[r.pending++]=e&255}function CPe(r,e,t,i){var n=r.avail_in;return n>i&&(n=i),n===0?0:(r.avail_in-=n,jn.arraySet(e,r.input,r.next_in,n,t),r.state.wrap===1?r.adler=_G(r.adler,e,n,t):r.state.wrap===2&&(r.adler=Tl(r.adler,e,n,t)),r.next_in+=n,r.total_in+=n,n)}function AG(r,e){var t=r.max_chain_length,i=r.strstart,n,s,o=r.prev_length,a=r.nice_match,c=r.strstart>r.w_size-ia?r.strstart-(r.w_size-ia):0,u=r.window,f=r.w_mask,d=r.prev,h=r.strstart+Cl,p=u[i+o-1],y=u[i+o];r.prev_length>=r.good_match&&(t>>=2),a>r.lookahead&&(a=r.lookahead);do if(n=e,!(u[n+o]!==y||u[n+o-1]!==p||u[n]!==u[i]||u[++n]!==u[i+1])){i+=2,n++;do;while(u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&i<h);if(s=Cl-(h-i),i=h-Cl,s>o){if(r.match_start=e,o=s,s>=a)break;p=u[i+o-1],y=u[i+o]}}while((e=d[e&f])>c&&--t!=0);return o<=r.lookahead?o:r.lookahead}function Sd(r){var e=r.w_size,t,i,n,s,o;do{if(s=r.window_size-r.lookahead-r.strstart,r.strstart>=e+(e-ia)){jn.arraySet(r.window,r.window,e,e,0),r.match_start-=e,r.strstart-=e,r.block_start-=e,i=r.hash_size,t=i;do n=r.head[--t],r.head[t]=n>=e?n-e:0;while(--i);i=e,t=i;do n=r.prev[--t],r.prev[t]=n>=e?n-e:0;while(--i);s+=e}if(r.strm.avail_in===0)break;if(i=CPe(r.strm,r.window,r.strstart+r.lookahead,s),r.lookahead+=i,r.lookahead+r.insert>=Lt)for(o=r.strstart-r.insert,r.ins_h=r.window[o],r.ins_h=(r.ins_h<<r.hash_shift^r.window[o+1])&r.hash_mask;r.insert&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[o+Lt-1])&r.hash_mask,r.prev[o&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=o,o++,r.insert--,!(r.lookahead+r.insert<Lt)););}while(r.lookahead<ia&&r.strm.avail_in!==0)}function OPe(r,e){var t=65535;for(t>r.pending_buf_size-5&&(t=r.pending_buf_size-5);;){if(r.lookahead<=1){if(Sd(r),r.lookahead===0&&e===_d)return qi;if(r.lookahead===0)break}r.strstart+=r.lookahead,r.lookahead=0;var i=r.block_start+t;if((r.strstart===0||r.strstart>=i)&&(r.lookahead=r.strstart-i,r.strstart=i,cn(r,!1),r.strm.avail_out===0)||r.strstart-r.block_start>=r.w_size-ia&&(cn(r,!1),r.strm.avail_out===0))return qi}return r.insert=0,e===Pl?(cn(r,!0),r.strm.avail_out===0?Ed:h0):(r.strstart>r.block_start&&(cn(r,!1),r.strm.avail_out===0),qi)}function pA(r,e){for(var t,i;;){if(r.lookahead<ia){if(Sd(r),r.lookahead<ia&&e===_d)return qi;if(r.lookahead===0)break}if(t=0,r.lookahead>=Lt&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Lt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),t!==0&&r.strstart-t<=r.w_size-ia&&(r.match_length=AG(r,t)),r.match_length>=Lt)if(i=oo._tr_tally(r,r.strstart-r.match_start,r.match_length-Lt),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=Lt){r.match_length--;do r.strstart++,r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Lt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!=0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+1])&r.hash_mask;else i=oo._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(i&&(cn(r,!1),r.strm.avail_out===0))return qi}return r.insert=r.strstart<Lt-1?r.strstart:Lt-1,e===Pl?(cn(r,!0),r.strm.avail_out===0?Ed:h0):r.last_lit&&(cn(r,!1),r.strm.avail_out===0)?qi:og}function p0(r,e){for(var t,i,n;;){if(r.lookahead<ia){if(Sd(r),r.lookahead<ia&&e===_d)return qi;if(r.lookahead===0)break}if(t=0,r.lookahead>=Lt&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Lt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=Lt-1,t!==0&&r.prev_length<r.max_lazy_match&&r.strstart-t<=r.w_size-ia&&(r.match_length=AG(r,t),r.match_length<=5&&(r.strategy===pPe||r.match_length===Lt&&r.strstart-r.match_start>4096)&&(r.match_length=Lt-1)),r.prev_length>=Lt&&r.match_length<=r.prev_length){n=r.strstart+r.lookahead-Lt,i=oo._tr_tally(r,r.strstart-1-r.prev_match,r.prev_length-Lt),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=n&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Lt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!=0);if(r.match_available=0,r.match_length=Lt-1,r.strstart++,i&&(cn(r,!1),r.strm.avail_out===0))return qi}else if(r.match_available){if(i=oo._tr_tally(r,0,r.window[r.strstart-1]),i&&cn(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return qi}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(i=oo._tr_tally(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<Lt-1?r.strstart:Lt-1,e===Pl?(cn(r,!0),r.strm.avail_out===0?Ed:h0):r.last_lit&&(cn(r,!1),r.strm.avail_out===0)?qi:og}function kPe(r,e){for(var t,i,n,s,o=r.window;;){if(r.lookahead<=Cl){if(Sd(r),r.lookahead<=Cl&&e===_d)return qi;if(r.lookahead===0)break}if(r.match_length=0,r.lookahead>=Lt&&r.strstart>0&&(n=r.strstart-1,i=o[n],i===o[++n]&&i===o[++n]&&i===o[++n])){s=r.strstart+Cl;do;while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<s);r.match_length=Cl-(s-n),r.match_length>r.lookahead&&(r.match_length=r.lookahead)}if(r.match_length>=Lt?(t=oo._tr_tally(r,1,r.match_length-Lt),r.lookahead-=r.match_length,r.strstart+=r.match_length,r.match_length=0):(t=oo._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++),t&&(cn(r,!1),r.strm.avail_out===0))return qi}return r.insert=0,e===Pl?(cn(r,!0),r.strm.avail_out===0?Ed:h0):r.last_lit&&(cn(r,!1),r.strm.avail_out===0)?qi:og}function DPe(r,e){for(var t;;){if(r.lookahead===0&&(Sd(r),r.lookahead===0)){if(e===_d)return qi;break}if(r.match_length=0,t=oo._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++,t&&(cn(r,!1),r.strm.avail_out===0))return qi}return r.insert=0,e===Pl?(cn(r,!0),r.strm.avail_out===0?Ed:h0):r.last_lit&&(cn(r,!1),r.strm.avail_out===0)?qi:og}function nc(r,e,t,i,n){this.good_length=r,this.max_lazy=e,this.nice_length=t,this.max_chain=i,this.func=n}var y0;y0=[new nc(0,0,0,0,OPe),new nc(4,4,8,4,pA),new nc(4,5,16,8,pA),new nc(4,6,32,32,pA),new nc(4,4,16,16,p0),new nc(8,16,32,32,p0),new nc(8,16,128,128,p0),new nc(8,32,128,256,p0),new nc(32,128,258,1024,p0),new nc(32,258,258,4096,p0)];function NPe(r){r.window_size=2*r.w_size,kl(r.head),r.max_lazy_match=y0[r.level].max_lazy,r.good_match=y0[r.level].good_length,r.nice_match=y0[r.level].nice_length,r.max_chain_length=y0[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=Lt-1,r.match_available=0,r.ins_h=0}function BPe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=E6,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new jn.Buf16(xPe*2),this.dyn_dtree=new jn.Buf16((2*APe+1)*2),this.bl_tree=new jn.Buf16((2*RPe+1)*2),kl(this.dyn_ltree),kl(this.dyn_dtree),kl(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new jn.Buf16(IPe+1),this.heap=new jn.Buf16(2*dA+1),kl(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new jn.Buf16(2*dA+1),kl(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function RG(r){var e;return!r||!r.state?Ol(r,ao):(r.total_in=r.total_out=0,r.data_type=bPe,e=r.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?S6:vd,r.adler=e.wrap===2?0:1,e.last_flush=_d,oo._tr_init(e),ic)}function xG(r){var e=RG(r);return e===ic&&NPe(r.state),e}function LPe(r,e){return!r||!r.state||r.state.wrap!==2?ao:(r.state.gzhead=e,ic)}function IG(r,e,t,i,n,s){if(!r)return ao;var o=1;if(e===hPe&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),n<1||n>wPe||t!==E6||i<8||i>15||e<0||e>9||s<0||s>gPe)return Ol(r,ao);i===8&&(i=9);var a=new BPe;return r.state=a,a.strm=r,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=n+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+Lt-1)/Lt),a.window=new jn.Buf8(a.w_size*2),a.head=new jn.Buf16(a.hash_size),a.prev=new jn.Buf16(a.w_size),a.lit_bufsize=1<<n+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new jn.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=(1+2)*a.lit_bufsize,a.level=e,a.strategy=s,a.method=t,xG(r)}function MPe(r,e){return IG(r,e,E6,_Pe,vPe,mPe)}function jPe(r,e){var t,i,n,s;if(!r||!r.state||e>vG||e<0)return r?Ol(r,ao):ao;if(i=r.state,!r.output||!r.input&&r.avail_in!==0||i.status===sg&&e!==Pl)return Ol(r,r.avail_out===0?fA:ao);if(i.strm=r,t=i.last_flush,i.last_flush=e,i.status===S6)if(i.wrap===2)r.adler=0,Qt(i,31),Qt(i,139),Qt(i,8),i.gzhead?(Qt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Qt(i,i.gzhead.time&255),Qt(i,i.gzhead.time>>8&255),Qt(i,i.gzhead.time>>16&255),Qt(i,i.gzhead.time>>24&255),Qt(i,i.level===9?2:i.strategy>=v6||i.level<2?4:0),Qt(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(Qt(i,i.gzhead.extra.length&255),Qt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(r.adler=Tl(r.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=hA):(Qt(i,0),Qt(i,0),Qt(i,0),Qt(i,0),Qt(i,0),Qt(i,i.level===9?2:i.strategy>=v6||i.level<2?4:0),Qt(i,PPe),i.status=vd);else{var o=E6+(i.w_bits-8<<4)<<8,a=-1;i.strategy>=v6||i.level<2?a=0:i.level<6?a=1:i.level===6?a=2:a=3,o|=a<<6,i.strstart!==0&&(o|=TPe),o+=31-o%31,i.status=vd,ag(i,o),i.strstart!==0&&(ag(i,r.adler>>>16),ag(i,r.adler&65535)),r.adler=1}if(i.status===hA)if(i.gzhead.extra){for(n=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(r.adler=Tl(r.adler,i.pending_buf,i.pending-n,n)),Dl(r),n=i.pending,i.pending===i.pending_buf_size));)Qt(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>n&&(r.adler=Tl(r.adler,i.pending_buf,i.pending-n,n)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=A6)}else i.status=A6;if(i.status===A6)if(i.gzhead.name){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(r.adler=Tl(r.adler,i.pending_buf,i.pending-n,n)),Dl(r),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.name.length?s=i.gzhead.name.charCodeAt(i.gzindex++)&255:s=0,Qt(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(r.adler=Tl(r.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.gzindex=0,i.status=R6)}else i.status=R6;if(i.status===R6)if(i.gzhead.comment){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(r.adler=Tl(r.adler,i.pending_buf,i.pending-n,n)),Dl(r),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.comment.length?s=i.gzhead.comment.charCodeAt(i.gzindex++)&255:s=0,Qt(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(r.adler=Tl(r.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.status=x6)}else i.status=x6;if(i.status===x6&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&Dl(r),i.pending+2<=i.pending_buf_size&&(Qt(i,r.adler&255),Qt(i,r.adler>>8&255),r.adler=0,i.status=vd)):i.status=vd),i.pending!==0){if(Dl(r),r.avail_out===0)return i.last_flush=-1,ic}else if(r.avail_in===0&&SG(e)<=SG(t)&&e!==Pl)return Ol(r,fA);if(i.status===sg&&r.avail_in!==0)return Ol(r,fA);if(r.avail_in!==0||i.lookahead!==0||e!==_d&&i.status!==sg){var c=i.strategy===v6?DPe(i,e):i.strategy===yPe?kPe(i,e):y0[i.level].func(i,e);if((c===Ed||c===h0)&&(i.status=sg),c===qi||c===Ed)return r.avail_out===0&&(i.last_flush=-1),ic;if(c===og&&(e===lPe?oo._tr_align(i):e!==vG&&(oo._tr_stored_block(i,0,0,!1),e===fPe&&(kl(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Dl(r),r.avail_out===0))return i.last_flush=-1,ic}return e!==Pl?ic:i.wrap<=0?EG:(i.wrap===2?(Qt(i,r.adler&255),Qt(i,r.adler>>8&255),Qt(i,r.adler>>16&255),Qt(i,r.adler>>24&255),Qt(i,r.total_in&255),Qt(i,r.total_in>>8&255),Qt(i,r.total_in>>16&255),Qt(i,r.total_in>>24&255)):(ag(i,r.adler>>>16),ag(i,r.adler&65535)),Dl(r),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?ic:EG)}function qPe(r){var e;return!r||!r.state?ao:(e=r.state.status,e!==S6&&e!==hA&&e!==A6&&e!==R6&&e!==x6&&e!==vd&&e!==sg?Ol(r,ao):(r.state=null,e===vd?Ol(r,dPe):ic))}function UPe(r,e){var t=e.length,i,n,s,o,a,c,u,f;if(!r||!r.state||(i=r.state,o=i.wrap,o===2||o===1&&i.status!==S6||i.lookahead))return ao;for(o===1&&(r.adler=_G(r.adler,e,t,0)),i.wrap=0,t>=i.w_size&&(o===0&&(kl(i.head),i.strstart=0,i.block_start=0,i.insert=0),f=new jn.Buf8(i.w_size),jn.arraySet(f,e,t-i.w_size,i.w_size,0),e=f,t=i.w_size),a=r.avail_in,c=r.next_in,u=r.input,r.avail_in=t,r.next_in=0,r.input=e,Sd(i);i.lookahead>=Lt;){n=i.strstart,s=i.lookahead-(Lt-1);do i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+Lt-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++;while(--s);i.strstart=n,i.lookahead=Lt-1,Sd(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=Lt-1,i.match_available=0,r.next_in=c,r.input=u,r.avail_in=a,i.wrap=o,ic}sc.deflateInit=MPe;sc.deflateInit2=IG;sc.deflateReset=xG;sc.deflateResetKeep=RG;sc.deflateSetHeader=LPe;sc.deflate=jPe;sc.deflateEnd=qPe;sc.deflateSetDictionary=UPe;sc.deflateInfo="pako deflate (from Nodeca project)"});var yA=m(g0=>{l();"use strict";var I6=cu(),PG=!0,CG=!0;try{String.fromCharCode.apply(null,[0])}catch(r){PG=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(r){CG=!1}var cg=new I6.Buf8(256);for(lu=0;lu<256;lu++)cg[lu]=lu>=252?6:lu>=248?5:lu>=240?4:lu>=224?3:lu>=192?2:1;var lu;cg[254]=cg[254]=1;g0.string2buf=function(r){var e,t,i,n,s,o=r.length,a=0;for(n=0;n<o;n++)t=r.charCodeAt(n),(t&64512)==55296&&n+1<o&&(i=r.charCodeAt(n+1),(i&64512)==56320&&(t=65536+(t-55296<<10)+(i-56320),n++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new I6.Buf8(a),s=0,n=0;s<a;n++)t=r.charCodeAt(n),(t&64512)==55296&&n+1<o&&(i=r.charCodeAt(n+1),(i&64512)==56320&&(t=65536+(t-55296<<10)+(i-56320),n++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e};function OG(r,e){if(e<65534&&(r.subarray&&CG||!r.subarray&&PG))return String.fromCharCode.apply(null,I6.shrinkBuf(r,e));for(var t="",i=0;i<e;i++)t+=String.fromCharCode(r[i]);return t}g0.buf2binstring=function(r){return OG(r,r.length)};g0.binstring2buf=function(r){for(var e=new I6.Buf8(r.length),t=0,i=e.length;t<i;t++)e[t]=r.charCodeAt(t);return e};g0.buf2string=function(r,e){var t,i,n,s,o=e||r.length,a=new Array(o*2);for(i=0,t=0;t<o;){if(n=r[t++],n<128){a[i++]=n;continue}if(s=cg[n],s>4){a[i++]=65533,t+=s-1;continue}for(n&=s===2?31:s===3?15:7;s>1&&t<o;)n=n<<6|r[t++]&63,s--;if(s>1){a[i++]=65533;continue}n<65536?a[i++]=n:(n-=65536,a[i++]=55296|n>>10&1023,a[i++]=56320|n&1023)}return OG(a,i)};g0.utf8border=function(r,e){var t;for(e=e||r.length,e>r.length&&(e=r.length),t=e-1;t>=0&&(r[t]&192)==128;)t--;return t<0||t===0?e:t+cg[r[t]]>e?t:e}});var gA=m((D1t,kG)=>{l();"use strict";function FPe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}kG.exports=FPe});var LG=m(fg=>{l();"use strict";var ug=TG(),lg=cu(),mA=yA(),bA=_6(),KPe=gA(),DG=Object.prototype.toString,VPe=0,wA=4,m0=0,NG=1,BG=2,zPe=-1,HPe=0,$Pe=8;function Ad(r){if(!(this instanceof Ad))return new Ad(r);this.options=lg.assign({level:zPe,method:$Pe,chunkSize:16384,windowBits:15,memLevel:8,strategy:HPe,to:""},r||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new KPe,this.strm.avail_out=0;var t=ug.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==m0)throw new Error(bA[t]);if(e.header&&ug.deflateSetHeader(this.strm,e.header),e.dictionary){var i;if(typeof e.dictionary=="string"?i=mA.string2buf(e.dictionary):DG.call(e.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(e.dictionary):i=e.dictionary,t=ug.deflateSetDictionary(this.strm,i),t!==m0)throw new Error(bA[t]);this._dict_set=!0}}Ad.prototype.push=function(r,e){var t=this.strm,i=this.options.chunkSize,n,s;if(this.ended)return!1;s=e===~~e?e:e===!0?wA:VPe,typeof r=="string"?t.input=mA.string2buf(r):DG.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new lg.Buf8(i),t.next_out=0,t.avail_out=i),n=ug.deflate(t,s),n!==NG&&n!==m0)return this.onEnd(n),this.ended=!0,!1;(t.avail_out===0||t.avail_in===0&&(s===wA||s===BG))&&(this.options.to==="string"?this.onData(mA.buf2binstring(lg.shrinkBuf(t.output,t.next_out))):this.onData(lg.shrinkBuf(t.output,t.next_out)))}while((t.avail_in>0||t.avail_out===0)&&n!==NG);return s===wA?(n=ug.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===m0):(s===BG&&(this.onEnd(m0),t.avail_out=0),!0)};Ad.prototype.onData=function(r){this.chunks.push(r)};Ad.prototype.onEnd=function(r){r===m0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=lg.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function _A(r,e){var t=new Ad(e);if(t.push(r,!0),t.err)throw t.msg||bA[t.err];return t.result}function GPe(r,e){return e=e||{},e.raw=!0,_A(r,e)}function WPe(r,e){return e=e||{},e.gzip=!0,_A(r,e)}fg.Deflate=Ad;fg.deflate=_A;fg.deflateRaw=GPe;fg.gzip=WPe});var jG=m((B1t,MG)=>{l();"use strict";var T6=30,YPe=12;MG.exports=function(e,t){var i,n,s,o,a,c,u,f,d,h,p,y,g,w,b,v,R,k,C,T,D,j,M,se,ie;i=e.state,n=e.next_in,se=e.input,s=n+(e.avail_in-5),o=e.next_out,ie=e.output,a=o-(t-e.avail_out),c=o+(e.avail_out-257),u=i.dmax,f=i.wsize,d=i.whave,h=i.wnext,p=i.window,y=i.hold,g=i.bits,w=i.lencode,b=i.distcode,v=(1<<i.lenbits)-1,R=(1<<i.distbits)-1;e:do{g<15&&(y+=se[n++]<<g,g+=8,y+=se[n++]<<g,g+=8),k=w[y&v];t:for(;;){if(C=k>>>24,y>>>=C,g-=C,C=k>>>16&255,C===0)ie[o++]=k&65535;else if(C&16){T=k&65535,C&=15,C&&(g<C&&(y+=se[n++]<<g,g+=8),T+=y&(1<<C)-1,y>>>=C,g-=C),g<15&&(y+=se[n++]<<g,g+=8,y+=se[n++]<<g,g+=8),k=b[y&R];r:for(;;){if(C=k>>>24,y>>>=C,g-=C,C=k>>>16&255,C&16){if(D=k&65535,C&=15,g<C&&(y+=se[n++]<<g,g+=8,g<C&&(y+=se[n++]<<g,g+=8)),D+=y&(1<<C)-1,D>u){e.msg="invalid distance too far back",i.mode=T6;break e}if(y>>>=C,g-=C,C=o-a,D>C){if(C=D-C,C>d&&i.sane){e.msg="invalid distance too far back",i.mode=T6;break e}if(j=0,M=p,h===0){if(j+=f-C,C<T){T-=C;do ie[o++]=p[j++];while(--C);j=o-D,M=ie}}else if(h<C){if(j+=f+h-C,C-=h,C<T){T-=C;do ie[o++]=p[j++];while(--C);if(j=0,h<T){C=h,T-=C;do ie[o++]=p[j++];while(--C);j=o-D,M=ie}}}else if(j+=h-C,C<T){T-=C;do ie[o++]=p[j++];while(--C);j=o-D,M=ie}for(;T>2;)ie[o++]=M[j++],ie[o++]=M[j++],ie[o++]=M[j++],T-=3;T&&(ie[o++]=M[j++],T>1&&(ie[o++]=M[j++]))}else{j=o-D;do ie[o++]=ie[j++],ie[o++]=ie[j++],ie[o++]=ie[j++],T-=3;while(T>2);T&&(ie[o++]=ie[j++],T>1&&(ie[o++]=ie[j++]))}}else if((C&64)==0){k=b[(k&65535)+(y&(1<<C)-1)];continue r}else{e.msg="invalid distance code",i.mode=T6;break e}break}}else if((C&64)==0){k=w[(k&65535)+(y&(1<<C)-1)];continue t}else if(C&32){i.mode=YPe;break e}else{e.msg="invalid literal/length code",i.mode=T6;break e}break}}while(n<s&&o<c);T=g>>3,n-=T,g-=T<<3,y&=(1<<g)-1,e.next_in=n,e.next_out=o,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=o<c?257+(c-o):257-(o-c),i.hold=y,i.bits=g}});var HG=m((L1t,zG)=>{l();"use strict";var qG=cu(),b0=15,UG=852,FG=592,KG=0,vA=1,VG=2,XPe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],QPe=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],ZPe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],JPe=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];zG.exports=function(e,t,i,n,s,o,a,c){var u=c.bits,f=0,d=0,h=0,p=0,y=0,g=0,w=0,b=0,v=0,R=0,k,C,T,D,j,M=null,se=0,ie,fe=new qG.Buf16(b0+1),pe=new qG.Buf16(b0+1),Be=null,Ae=0,ke,ne,Me;for(f=0;f<=b0;f++)fe[f]=0;for(d=0;d<n;d++)fe[t[i+d]]++;for(y=u,p=b0;p>=1&&fe[p]===0;p--);if(y>p&&(y=p),p===0)return s[o++]=1<<24|64<<16|0,s[o++]=1<<24|64<<16|0,c.bits=1,0;for(h=1;h<p&&fe[h]===0;h++);for(y<h&&(y=h),b=1,f=1;f<=b0;f++)if(b<<=1,b-=fe[f],b<0)return-1;if(b>0&&(e===KG||p!==1))return-1;for(pe[1]=0,f=1;f<b0;f++)pe[f+1]=pe[f]+fe[f];for(d=0;d<n;d++)t[i+d]!==0&&(a[pe[t[i+d]]++]=d);if(e===KG?(M=Be=a,ie=19):e===vA?(M=XPe,se-=257,Be=QPe,Ae-=257,ie=256):(M=ZPe,Be=JPe,ie=-1),R=0,d=0,f=h,j=o,g=y,w=0,T=-1,v=1<<y,D=v-1,e===vA&&v>UG||e===VG&&v>FG)return 1;for(;;){ke=f-w,a[d]<ie?(ne=0,Me=a[d]):a[d]>ie?(ne=Be[Ae+a[d]],Me=M[se+a[d]]):(ne=32+64,Me=0),k=1<<f-w,C=1<<g,h=C;do C-=k,s[j+(R>>w)+C]=ke<<24|ne<<16|Me|0;while(C!==0);for(k=1<<f-1;R&k;)k>>=1;if(k!==0?(R&=k-1,R+=k):R=0,d++,--fe[f]==0){if(f===p)break;f=t[i+a[d]]}if(f>y&&(R&D)!==T){for(w===0&&(w=y),j+=h,g=f-w,b=1<<g;g+w<p&&(b-=fe[g+w],!(b<=0));)g++,b<<=1;if(v+=1<<g,e===vA&&v>UG||e===VG&&v>FG)return 1;T=R&D,s[T]=y<<24|g<<16|j-o|0}}return R!==0&&(s[j+R]=f-w<<24|64<<16|0),c.bits=y,0}});var xW=m(na=>{l();"use strict";var Ss=cu(),EA=uA(),oc=lA(),eCe=jG(),dg=HG(),tCe=0,$G=1,GG=2,WG=4,rCe=5,P6=6,Rd=0,iCe=1,nCe=2,co=-2,YG=-3,SA=-4,sCe=-5,XG=8,QG=1,ZG=2,JG=3,eW=4,tW=5,rW=6,iW=7,nW=8,sW=9,oW=10,C6=11,fu=12,AA=13,aW=14,RA=15,cW=16,uW=17,lW=18,fW=19,O6=20,k6=21,dW=22,hW=23,pW=24,yW=25,gW=26,xA=27,mW=28,bW=29,Fr=30,IA=31,oCe=32,aCe=852,cCe=592,uCe=15,lCe=uCe;function wW(r){return(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24)}function fCe(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Ss.Buf16(320),this.work=new Ss.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _W(r){var e;return!r||!r.state?co:(e=r.state,r.total_in=r.total_out=e.total=0,r.msg="",e.wrap&&(r.adler=e.wrap&1),e.mode=QG,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Ss.Buf32(aCe),e.distcode=e.distdyn=new Ss.Buf32(cCe),e.sane=1,e.back=-1,Rd)}function vW(r){var e;return!r||!r.state?co:(e=r.state,e.wsize=0,e.whave=0,e.wnext=0,_W(r))}function EW(r,e){var t,i;return!r||!r.state||(i=r.state,e<0?(t=0,e=-e):(t=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15))?co:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=t,i.wbits=e,vW(r))}function SW(r,e){var t,i;return r?(i=new fCe,r.state=i,i.window=null,t=EW(r,e),t!==Rd&&(r.state=null),t):co}function dCe(r){return SW(r,lCe)}var AW=!0,TA,PA;function hCe(r){if(AW){var e;for(TA=new Ss.Buf32(512),PA=new Ss.Buf32(32),e=0;e<144;)r.lens[e++]=8;for(;e<256;)r.lens[e++]=9;for(;e<280;)r.lens[e++]=7;for(;e<288;)r.lens[e++]=8;for(dg($G,r.lens,0,288,TA,0,r.work,{bits:9}),e=0;e<32;)r.lens[e++]=5;dg(GG,r.lens,0,32,PA,0,r.work,{bits:5}),AW=!1}r.lencode=TA,r.lenbits=9,r.distcode=PA,r.distbits=5}function RW(r,e,t,i){var n,s=r.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Ss.Buf8(s.wsize)),i>=s.wsize?(Ss.arraySet(s.window,e,t-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),Ss.arraySet(s.window,e,t-i,n,s.wnext),i-=n,i?(Ss.arraySet(s.window,e,t-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0}function pCe(r,e){var t,i,n,s,o,a,c,u,f,d,h,p,y,g,w=0,b,v,R,k,C,T,D,j,M=new Ss.Buf8(4),se,ie,fe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!r||!r.state||!r.output||!r.input&&r.avail_in!==0)return co;t=r.state,t.mode===fu&&(t.mode=AA),o=r.next_out,n=r.output,c=r.avail_out,s=r.next_in,i=r.input,a=r.avail_in,u=t.hold,f=t.bits,d=a,h=c,j=Rd;e:for(;;)switch(t.mode){case QG:if(t.wrap===0){t.mode=AA;break}for(;f<16;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}if(t.wrap&2&&u===35615){t.check=0,M[0]=u&255,M[1]=u>>>8&255,t.check=oc(t.check,M,2,0),u=0,f=0,t.mode=ZG;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((u&255)<<8)+(u>>8))%31){r.msg="incorrect header check",t.mode=Fr;break}if((u&15)!==XG){r.msg="unknown compression method",t.mode=Fr;break}if(u>>>=4,f-=4,D=(u&15)+8,t.wbits===0)t.wbits=D;else if(D>t.wbits){r.msg="invalid window size",t.mode=Fr;break}t.dmax=1<<D,r.adler=t.check=1,t.mode=u&512?oW:fu,u=0,f=0;break;case ZG:for(;f<16;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}if(t.flags=u,(t.flags&255)!==XG){r.msg="unknown compression method",t.mode=Fr;break}if(t.flags&57344){r.msg="unknown header flags set",t.mode=Fr;break}t.head&&(t.head.text=u>>8&1),t.flags&512&&(M[0]=u&255,M[1]=u>>>8&255,t.check=oc(t.check,M,2,0)),u=0,f=0,t.mode=JG;case JG:for(;f<32;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}t.head&&(t.head.time=u),t.flags&512&&(M[0]=u&255,M[1]=u>>>8&255,M[2]=u>>>16&255,M[3]=u>>>24&255,t.check=oc(t.check,M,4,0)),u=0,f=0,t.mode=eW;case eW:for(;f<16;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}t.head&&(t.head.xflags=u&255,t.head.os=u>>8),t.flags&512&&(M[0]=u&255,M[1]=u>>>8&255,t.check=oc(t.check,M,2,0)),u=0,f=0,t.mode=tW;case tW:if(t.flags&1024){for(;f<16;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}t.length=u,t.head&&(t.head.extra_len=u),t.flags&512&&(M[0]=u&255,M[1]=u>>>8&255,t.check=oc(t.check,M,2,0)),u=0,f=0}else t.head&&(t.head.extra=null);t.mode=rW;case rW:if(t.flags&1024&&(p=t.length,p>a&&(p=a),p&&(t.head&&(D=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),Ss.arraySet(t.head.extra,i,s,p,D)),t.flags&512&&(t.check=oc(t.check,i,p,s)),a-=p,s+=p,t.length-=p),t.length))break e;t.length=0,t.mode=iW;case iW:if(t.flags&2048){if(a===0)break e;p=0;do D=i[s+p++],t.head&&D&&t.length<65536&&(t.head.name+=String.fromCharCode(D));while(D&&p<a);if(t.flags&512&&(t.check=oc(t.check,i,p,s)),a-=p,s+=p,D)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=nW;case nW:if(t.flags&4096){if(a===0)break e;p=0;do D=i[s+p++],t.head&&D&&t.length<65536&&(t.head.comment+=String.fromCharCode(D));while(D&&p<a);if(t.flags&512&&(t.check=oc(t.check,i,p,s)),a-=p,s+=p,D)break e}else t.head&&(t.head.comment=null);t.mode=sW;case sW:if(t.flags&512){for(;f<16;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}if(u!==(t.check&65535)){r.msg="header crc mismatch",t.mode=Fr;break}u=0,f=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),r.adler=t.check=0,t.mode=fu;break;case oW:for(;f<32;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}r.adler=t.check=wW(u),u=0,f=0,t.mode=C6;case C6:if(t.havedict===0)return r.next_out=o,r.avail_out=c,r.next_in=s,r.avail_in=a,t.hold=u,t.bits=f,nCe;r.adler=t.check=1,t.mode=fu;case fu:if(e===rCe||e===P6)break e;case AA:if(t.last){u>>>=f&7,f-=f&7,t.mode=xA;break}for(;f<3;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}switch(t.last=u&1,u>>>=1,f-=1,u&3){case 0:t.mode=aW;break;case 1:if(hCe(t),t.mode=O6,e===P6){u>>>=2,f-=2;break e}break;case 2:t.mode=uW;break;case 3:r.msg="invalid block type",t.mode=Fr}u>>>=2,f-=2;break;case aW:for(u>>>=f&7,f-=f&7;f<32;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}if((u&65535)!=(u>>>16^65535)){r.msg="invalid stored block lengths",t.mode=Fr;break}if(t.length=u&65535,u=0,f=0,t.mode=RA,e===P6)break e;case RA:t.mode=cW;case cW:if(p=t.length,p){if(p>a&&(p=a),p>c&&(p=c),p===0)break e;Ss.arraySet(n,i,s,p,o),a-=p,s+=p,c-=p,o+=p,t.length-=p;break}t.mode=fu;break;case uW:for(;f<14;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}if(t.nlen=(u&31)+257,u>>>=5,f-=5,t.ndist=(u&31)+1,u>>>=5,f-=5,t.ncode=(u&15)+4,u>>>=4,f-=4,t.nlen>286||t.ndist>30){r.msg="too many length or distance symbols",t.mode=Fr;break}t.have=0,t.mode=lW;case lW:for(;t.have<t.ncode;){for(;f<3;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}t.lens[fe[t.have++]]=u&7,u>>>=3,f-=3}for(;t.have<19;)t.lens[fe[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,se={bits:t.lenbits},j=dg(tCe,t.lens,0,19,t.lencode,0,t.work,se),t.lenbits=se.bits,j){r.msg="invalid code lengths set",t.mode=Fr;break}t.have=0,t.mode=fW;case fW:for(;t.have<t.nlen+t.ndist;){for(;w=t.lencode[u&(1<<t.lenbits)-1],b=w>>>24,v=w>>>16&255,R=w&65535,!(b<=f);){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}if(R<16)u>>>=b,f-=b,t.lens[t.have++]=R;else{if(R===16){for(ie=b+2;f<ie;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}if(u>>>=b,f-=b,t.have===0){r.msg="invalid bit length repeat",t.mode=Fr;break}D=t.lens[t.have-1],p=3+(u&3),u>>>=2,f-=2}else if(R===17){for(ie=b+3;f<ie;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}u>>>=b,f-=b,D=0,p=3+(u&7),u>>>=3,f-=3}else{for(ie=b+7;f<ie;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}u>>>=b,f-=b,D=0,p=11+(u&127),u>>>=7,f-=7}if(t.have+p>t.nlen+t.ndist){r.msg="invalid bit length repeat",t.mode=Fr;break}for(;p--;)t.lens[t.have++]=D}}if(t.mode===Fr)break;if(t.lens[256]===0){r.msg="invalid code -- missing end-of-block",t.mode=Fr;break}if(t.lenbits=9,se={bits:t.lenbits},j=dg($G,t.lens,0,t.nlen,t.lencode,0,t.work,se),t.lenbits=se.bits,j){r.msg="invalid literal/lengths set",t.mode=Fr;break}if(t.distbits=6,t.distcode=t.distdyn,se={bits:t.distbits},j=dg(GG,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,se),t.distbits=se.bits,j){r.msg="invalid distances set",t.mode=Fr;break}if(t.mode=O6,e===P6)break e;case O6:t.mode=k6;case k6:if(a>=6&&c>=258){r.next_out=o,r.avail_out=c,r.next_in=s,r.avail_in=a,t.hold=u,t.bits=f,eCe(r,h),o=r.next_out,n=r.output,c=r.avail_out,s=r.next_in,i=r.input,a=r.avail_in,u=t.hold,f=t.bits,t.mode===fu&&(t.back=-1);break}for(t.back=0;w=t.lencode[u&(1<<t.lenbits)-1],b=w>>>24,v=w>>>16&255,R=w&65535,!(b<=f);){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}if(v&&(v&240)==0){for(k=b,C=v,T=R;w=t.lencode[T+((u&(1<<k+C)-1)>>k)],b=w>>>24,v=w>>>16&255,R=w&65535,!(k+b<=f);){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}u>>>=k,f-=k,t.back+=k}if(u>>>=b,f-=b,t.back+=b,t.length=R,v===0){t.mode=gW;break}if(v&32){t.back=-1,t.mode=fu;break}if(v&64){r.msg="invalid literal/length code",t.mode=Fr;break}t.extra=v&15,t.mode=dW;case dW:if(t.extra){for(ie=t.extra;f<ie;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}t.length+=u&(1<<t.extra)-1,u>>>=t.extra,f-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=hW;case hW:for(;w=t.distcode[u&(1<<t.distbits)-1],b=w>>>24,v=w>>>16&255,R=w&65535,!(b<=f);){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}if((v&240)==0){for(k=b,C=v,T=R;w=t.distcode[T+((u&(1<<k+C)-1)>>k)],b=w>>>24,v=w>>>16&255,R=w&65535,!(k+b<=f);){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}u>>>=k,f-=k,t.back+=k}if(u>>>=b,f-=b,t.back+=b,v&64){r.msg="invalid distance code",t.mode=Fr;break}t.offset=R,t.extra=v&15,t.mode=pW;case pW:if(t.extra){for(ie=t.extra;f<ie;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}t.offset+=u&(1<<t.extra)-1,u>>>=t.extra,f-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){r.msg="invalid distance too far back",t.mode=Fr;break}t.mode=yW;case yW:if(c===0)break e;if(p=h-c,t.offset>p){if(p=t.offset-p,p>t.whave&&t.sane){r.msg="invalid distance too far back",t.mode=Fr;break}p>t.wnext?(p-=t.wnext,y=t.wsize-p):y=t.wnext-p,p>t.length&&(p=t.length),g=t.window}else g=n,y=o-t.offset,p=t.length;p>c&&(p=c),c-=p,t.length-=p;do n[o++]=g[y++];while(--p);t.length===0&&(t.mode=k6);break;case gW:if(c===0)break e;n[o++]=t.length,c--,t.mode=k6;break;case xA:if(t.wrap){for(;f<32;){if(a===0)break e;a--,u|=i[s++]<<f,f+=8}if(h-=c,r.total_out+=h,t.total+=h,h&&(r.adler=t.check=t.flags?oc(t.check,n,h,o-h):EA(t.check,n,h,o-h)),h=c,(t.flags?u:wW(u))!==t.check){r.msg="incorrect data check",t.mode=Fr;break}u=0,f=0}t.mode=mW;case mW:if(t.wrap&&t.flags){for(;f<32;){if(a===0)break e;a--,u+=i[s++]<<f,f+=8}if(u!==(t.total&4294967295)){r.msg="incorrect length check",t.mode=Fr;break}u=0,f=0}t.mode=bW;case bW:j=iCe;break e;case Fr:j=YG;break e;case IA:return SA;case oCe:default:return co}return r.next_out=o,r.avail_out=c,r.next_in=s,r.avail_in=a,t.hold=u,t.bits=f,(t.wsize||h!==r.avail_out&&t.mode<Fr&&(t.mode<xA||e!==WG))&&RW(r,r.output,r.next_out,h-r.avail_out)?(t.mode=IA,SA):(d-=r.avail_in,h-=r.avail_out,r.total_in+=d,r.total_out+=h,t.total+=h,t.wrap&&h&&(r.adler=t.check=t.flags?oc(t.check,n,h,r.next_out-h):EA(t.check,n,h,r.next_out-h)),r.data_type=t.bits+(t.last?64:0)+(t.mode===fu?128:0)+(t.mode===O6||t.mode===RA?256:0),(d===0&&h===0||e===WG)&&j===Rd&&(j=sCe),j)}function yCe(r){if(!r||!r.state)return co;var e=r.state;return e.window&&(e.window=null),r.state=null,Rd}function gCe(r,e){var t;return!r||!r.state||(t=r.state,(t.wrap&2)==0)?co:(t.head=e,e.done=!1,Rd)}function mCe(r,e){var t=e.length,i,n,s;return!r||!r.state||(i=r.state,i.wrap!==0&&i.mode!==C6)?co:i.mode===C6&&(n=1,n=EA(n,e,t,0),n!==i.check)?YG:(s=RW(r,e,t,t),s?(i.mode=IA,SA):(i.havedict=1,Rd))}na.inflateReset=vW;na.inflateReset2=EW;na.inflateResetKeep=_W;na.inflateInit=dCe;na.inflateInit2=SW;na.inflate=pCe;na.inflateEnd=yCe;na.inflateGetHeader=gCe;na.inflateSetDictionary=mCe;na.inflateInfo="pako inflate (from Nodeca project)"});var CA=m((j1t,IW)=>{l();"use strict";IW.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var PW=m((q1t,TW)=>{l();"use strict";function bCe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}TW.exports=bCe});var OW=m(pg=>{l();"use strict";var w0=xW(),hg=cu(),D6=yA(),gi=CA(),OA=_6(),wCe=gA(),_Ce=PW(),CW=Object.prototype.toString;function xd(r){if(!(this instanceof xd))return new xd(r);this.options=hg.assign({chunkSize:16384,windowBits:0,to:""},r||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(r&&r.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)==0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new wCe,this.strm.avail_out=0;var t=w0.inflateInit2(this.strm,e.windowBits);if(t!==gi.Z_OK)throw new Error(OA[t]);if(this.header=new _Ce,w0.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=D6.string2buf(e.dictionary):CW.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=w0.inflateSetDictionary(this.strm,e.dictionary),t!==gi.Z_OK)))throw new Error(OA[t])}xd.prototype.push=function(r,e){var t=this.strm,i=this.options.chunkSize,n=this.options.dictionary,s,o,a,c,u,f=!1;if(this.ended)return!1;o=e===~~e?e:e===!0?gi.Z_FINISH:gi.Z_NO_FLUSH,typeof r=="string"?t.input=D6.binstring2buf(r):CW.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new hg.Buf8(i),t.next_out=0,t.avail_out=i),s=w0.inflate(t,gi.Z_NO_FLUSH),s===gi.Z_NEED_DICT&&n&&(s=w0.inflateSetDictionary(this.strm,n)),s===gi.Z_BUF_ERROR&&f===!0&&(s=gi.Z_OK,f=!1),s!==gi.Z_STREAM_END&&s!==gi.Z_OK)return this.onEnd(s),this.ended=!0,!1;t.next_out&&(t.avail_out===0||s===gi.Z_STREAM_END||t.avail_in===0&&(o===gi.Z_FINISH||o===gi.Z_SYNC_FLUSH))&&(this.options.to==="string"?(a=D6.utf8border(t.output,t.next_out),c=t.next_out-a,u=D6.buf2string(t.output,a),t.next_out=c,t.avail_out=i-c,c&&hg.arraySet(t.output,t.output,a,c,0),this.onData(u)):this.onData(hg.shrinkBuf(t.output,t.next_out))),t.avail_in===0&&t.avail_out===0&&(f=!0)}while((t.avail_in>0||t.avail_out===0)&&s!==gi.Z_STREAM_END);return s===gi.Z_STREAM_END&&(o=gi.Z_FINISH),o===gi.Z_FINISH?(s=w0.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===gi.Z_OK):(o===gi.Z_SYNC_FLUSH&&(this.onEnd(gi.Z_OK),t.avail_out=0),!0)};xd.prototype.onData=function(r){this.chunks.push(r)};xd.prototype.onEnd=function(r){r===gi.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=hg.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function kA(r,e){var t=new xd(e);if(t.push(r,!0),t.err)throw t.msg||OA[t.err];return t.result}function vCe(r,e){return e=e||{},e.raw=!0,kA(r,e)}pg.Inflate=xd;pg.inflate=kA;pg.inflateRaw=vCe;pg.ungzip=kA});var NW=m((F1t,DW)=>{l();"use strict";var ECe=cu().assign,SCe=LG(),ACe=OW(),RCe=CA(),kW={};ECe(kW,SCe,ACe,RCe);DW.exports=kW});var LW=m((K1t,BW)=>{l();"use strict";var{concat:xCe}=(Ri(),Cn);async function ICe(r){let e=new Uint8Array(0);for await(let t of r)e=xCe([e,t],e.length+t.length);return e}BW.exports=ICe});var UA=m((pyt,YW)=>{l();YW.exports=OCe;function OCe(r,e,t){var i,n;if(Array.isArray(e)&&(i=e.slice(0)),typeof e=="string"&&(i=e.split(".")),typeof e=="symbol"&&(i=[e]),!Array.isArray(i))throw new Error("props arg must be an array, a string or a symbol");if(n=i.pop(),!n)return!1;WW(n);for(var s;s=i.shift();)if(WW(s),typeof r[s]=="undefined"&&(r[s]={}),r=r[s],!r||typeof r!="object")return!1;return r[n]=t,!0}function WW(r){if(r==="__proto__"||r==="constructor"||r==="prototype")throw new Error("setting of prototype values not supported")}});var Td=m((zyt,cY)=>{l();"use strict";var VCe=async r=>{for await(let e of r)return e};cY.exports=VCe});var U6=m((d2t,AY)=>{l();var{Multiaddr:HCe}=lt(),q6=(r,e)=>e,$Ce=(r,e,t,i)=>{if(i&&i.assumeHttp===!1)return`tcp://${r}:${e}`;let n="tcp",s=`:${e}`;return t[t.length-1].protocol==="tcp"&&(n=e==="443"?"https":"http",s=e==="443"||e==="80"?"":s),`${n}://${r}${s}`},GCe={ip4:q6,ip6:(r,e,t,i)=>i.length===1&&i[0].protocol==="ip6"?e:`[${e}]`,tcp:(r,e,t,i,n)=>i.some(s=>["http","https","ws","wss"].includes(s.protocol))?`${r}:${e}`:$Ce(r,e,i,n),udp:(r,e)=>`udp://${r}:${e}`,dnsaddr:q6,dns4:q6,dns6:q6,ipfs:(r,e)=>`${r}/ipfs/${e}`,p2p:(r,e)=>`${r}/p2p/${e}`,http:r=>`http://${r}`,https:r=>`https://${r}`,ws:r=>`ws://${r}`,wss:r=>`wss://${r}`,"p2p-websocket-star":r=>`${r}/p2p-websocket-star`,"p2p-webrtc-star":r=>`${r}/p2p-webrtc-star`,"p2p-webrtc-direct":r=>`${r}/p2p-webrtc-direct`};AY.exports=(r,e)=>{let t=new HCe(r),i=r.toString().split("/").slice(1);return t.tuples().map(n=>({protocol:i.shift(),content:n[1]?i.shift():null})).reduce((n,s,o,a)=>{let c=GCe[s.protocol];if(!c)throw new Error(`Unsupported protocol ${s.protocol}`);return c(n,s.content,o,a,e)},"")}});var xY=m((h2t,RY)=>{l();"use strict";RY.exports=r=>{if(!Array.isArray(r))throw new TypeError(`Expected an array, got ${typeof r}`);r=[...r];for(let e=r.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[r[e],r[t]]=[r[t],r[e]]}return r}});var eR=m((b2t,NY)=>{l();NY.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}});var BY=m(()=>{l()});var HY=m((v2t,zY)=>{l();var QCe=Ut().EventEmitter,{nanoid:ZCe}=(m4(),Q7),{WORKER_REQUEST_READ_LOCK:LY,WORKER_RELEASE_READ_LOCK:MY,MASTER_GRANT_READ_LOCK:jY,WORKER_REQUEST_WRITE_LOCK:qY,WORKER_RELEASE_WRITE_LOCK:UY,MASTER_GRANT_WRITE_LOCK:FY}=eR(),gg,KY=(r,e,t,i,n)=>(s,o)=>{o&&o.type===t&&r.emit(e,o.name,()=>(s.send({type:n,name:o.name,identifier:o.identifier}),new Promise(a=>{let c=u=>{u&&u.type===i&&u.identifier===o.identifier&&(s.removeListener("message",c),a())};s.on("message",c)})))},VY=(r,e,t,i)=>()=>{let n=ZCe();return process.send({type:e,identifier:n,name:r}),new Promise(s=>{let o=a=>{a&&a.type===t&&a.identifier===n&&(process.removeListener("message",o),s(()=>{process.send({type:i,identifier:n,name:r})}))};process.on("message",o)})};zY.exports=r=>{try{if(gg=BY(),!Object.keys(gg).length)return}catch(e){return}if(gg.isMaster||r.singleProcess){let e=new QCe;return gg.on("message",KY(e,"requestReadLock",LY,MY,jY)),gg.on("message",KY(e,"requestWriteLock",qY,UY,FY)),e}return{isWorker:!0,readLock:e=>VY(e,LY,jY,MY),writeLock:e=>VY(e,qY,FY,UY)}}});var tR=m((E2t,$Y)=>{l();var Bl={},R0=r=>{r.addEventListener("message",e=>{R0.dispatchEvent("message",r,e)}),r.port&&r.port.addEventListener("message",e=>{R0.dispatchEvent("message",r,e)})};R0.addEventListener=(r,e)=>{Bl[r]||(Bl[r]=[]),Bl[r].push(e)};R0.removeEventListener=(r,e)=>{!Bl[r]||(Bl[r]=Bl[r].filter(t=>t===e))};R0.dispatchEvent=function(){let r=Array.prototype.slice.call(arguments),e=r.shift();!Bl[e]||Bl[e].forEach(t=>t.apply(null,r))};$Y.exports=R0});var iX=m((S2t,rX)=>{l();var JCe=Ut().EventEmitter,{nanoid:eOe}=(m4(),Q7),{WORKER_REQUEST_READ_LOCK:GY,WORKER_RELEASE_READ_LOCK:WY,MASTER_GRANT_READ_LOCK:YY,WORKER_REQUEST_WRITE_LOCK:XY,WORKER_RELEASE_WRITE_LOCK:QY,MASTER_GRANT_WRITE_LOCK:ZY}=eR(),JY=tR(),eX=(r,e,t,i,n)=>(s,o)=>{if(!o||!o.data||o.data.type!==t)return;let a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};r.emit(e,a.name,()=>(s.postMessage({type:n,name:a.name,identifier:a.identifier}),new Promise(c=>{let u=f=>{if(!f||!f.data)return;let d={type:f.data.type,name:f.data.name,identifier:f.data.identifier};d&&d.type===i&&d.identifier===a.identifier&&(s.removeEventListener("message",u),c())};s.addEventListener("message",u)})))},tX=(r,e,t,i)=>()=>{let n=eOe();return globalThis.postMessage({type:e,identifier:n,name:r}),new Promise(s=>{let o=a=>{if(!a||!a.data)return;let c={type:a.data.type,identifier:a.data.identifier};c&&c.type===t&&c.identifier===n&&(globalThis.removeEventListener("message",o),s(()=>{globalThis.postMessage({type:i,identifier:n,name:r})}))};globalThis.addEventListener("message",o)})},tOe={singleProcess:!1};rX.exports=r=>{if(r=Object.assign({},tOe,r),!!globalThis.document||r.singleProcess){let t=new JCe;return JY.addEventListener("message",eX(t,"requestReadLock",GY,WY,YY)),JY.addEventListener("message",eX(t,"requestWriteLock",XY,QY,ZY)),t}return{isWorker:!0,readLock:t=>tX(t,GY,YY,WY),writeLock:t=>tX(t,XY,ZY,QY)}}});var nX=m((R2t,rR)=>{l();"use strict";var V6,A2t=rR.exports.timeout=function(r,e){var t=new V6,i;return Promise.race([r,new Promise(function(n,s){i=setTimeout(function(){s(t)},e)})]).then(function(n){return clearTimeout(i),n},function(n){throw clearTimeout(i),n})};V6=rR.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"};V6.prototype=Object.create(Error.prototype);V6.prototype.name="TimeoutError"});var z6=m((x2t,nR)=>{l();var rOe=HY(),iOe=iX(),{default:sX}=Go(),{timeout:nOe}=nX(),sOe=tR(),Pd={},Ll;function iR(r,e){let t,i=new Promise(n=>{t=n});return r.add(()=>nOe((()=>new Promise(n=>{t(()=>{n()})}))(),e.timeout)),i}var oOe=(r,e)=>{if(Ll.isWorker)return{readLock:Ll.readLock(r,e),writeLock:Ll.writeLock(r,e)};let t=new sX({concurrency:1}),i=null;return{readLock:()=>{if(i)return iR(i,e);i=new sX({concurrency:e.concurrency,autoStart:!1});let n=i,s=iR(i,e);return t.add(()=>(n.start(),n.onIdle().then(()=>{i===n&&(i=null)}))),s},writeLock:()=>(i=null,iR(t,e))}},aOe={concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};nR.exports=(r,e)=>(e||(e={}),typeof r=="object"&&(e=r,r="lock"),r||(r="lock"),e=Object.assign({},aOe,e),Ll||(Ll=rOe(e)||iOe(e),Ll.isWorker||(Ll.on("requestReadLock",(t,i)=>{!Pd[t]||Pd[t].readLock().then(n=>i().finally(()=>n()))}),Ll.on("requestWriteLock",async(t,i)=>{!Pd[t]||Pd[t].writeLock().then(n=>i().finally(()=>n()))}))),Pd[r]||(Pd[r]=oOe(r,e)),Pd[r]);nR.exports.Worker=function(r,e){e=e||globalThis.Worker;let t;try{t=new e(r)}catch(i){i.message.includes("not a constructor")&&(t=e(r))}if(!t)throw new Error("Could not create Worker from",e);return sOe(t),t}});var _R=m((_bt,PQ)=>{l();PQ.exports=ike;function ike(r,e,t){if(!r)return t;var i,n;if(Array.isArray(e)&&(i=e.slice(0)),typeof e=="string"&&(i=e.split(".")),typeof e=="symbol"&&(i=[e]),!Array.isArray(i))throw new Error("props arg must be an array, a string or a symbol");for(;i.length;)if(n=i.shift(),!r||(r=r[n],r===void 0))return t;return r}});var Dd=m((vbt,OQ)=>{l();"use strict";function CQ(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function nke(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return CQ(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),CQ(new n,t)}}OQ.exports=nke});var Sg=m((Ebt,kQ)=>{l();"use strict";var ske=async r=>{let e=0;for await(let t of r)e++;return e};kQ.exports=ske});var FQ=m((Obt,UQ)=>{l();vR.BASE=2166136261;function vR(r){for(var e=vR.BASE,t=0,i=r.length;t<i;t++)e^=r.charCodeAt(t),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0}UQ.exports=vR});var VQ={};Pt(VQ,{compare:()=>Rg});function Rg(r,e){for(let t=0;t<r.byteLength;t++){if(r[t]<e[t])return-1;if(r[t]>e[t])return 1}return r.byteLength>e.byteLength?1:r.byteLength<e.byteLength?-1:0}var t5=qe(()=>{l()});var pZ=m((V6t,u5)=>{l();"use strict";u5.exports=Cke;u5.exports.format=dZ;u5.exports.parse=hZ;var Ike=/\B(?=(\d{3})+(?!\d))/g,Tke=/(?:\.0*|(\.[^0]+)0+)$/,Vl={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},Pke=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function Cke(r,e){return typeof r=="string"?hZ(r):typeof r=="number"?dZ(r,e):null}function dZ(r,e){if(!Number.isFinite(r))return null;var t=Math.abs(r),i=e&&e.thousandsSeparator||"",n=e&&e.unitSeparator||"",s=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,o=Boolean(e&&e.fixedDecimals),a=e&&e.unit||"";(!a||!Vl[a.toLowerCase()])&&(t>=Vl.pb?a="PB":t>=Vl.tb?a="TB":t>=Vl.gb?a="GB":t>=Vl.mb?a="MB":t>=Vl.kb?a="KB":a="B");var c=r/Vl[a.toLowerCase()],u=c.toFixed(s);return o||(u=u.replace(Tke,"$1")),i&&(u=u.split(".").map(function(f,d){return d===0?f.replace(Ike,i):f}).join(".")),u+n+a}function hZ(r){if(typeof r=="number"&&!isNaN(r))return r;if(typeof r!="string")return null;var e=Pke.exec(r),t,i="b";return e?(t=parseFloat(e[1]),i=e[4].toLowerCase()):(t=parseInt(r,10),i="b"),isNaN(t)?null:Math.floor(Vl[i]*t)}});var AZ=m((n5t,SZ)=>{l();"use strict";SZ.exports=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;let e=Object.getPrototypeOf(r);return e===null||e===Object.prototype}});var xZ=m((s5t,RZ)=>{l();"use strict";var qR=AZ();RZ.exports=(r,e={})=>{if(!qR(r)&&!Array.isArray(r))throw new TypeError("Expected a plain object or array");let{deep:t}=e,i=[],n=[],s=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let u=[];return i.push(a),n.push(u),u.push(...a.map(f=>Array.isArray(f)?s(f):qR(f)?o(f):f)),u},o=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let u={},f=Object.keys(a).sort(e.compare);i.push(a),n.push(u);for(let d of f){let h=a[d],p;t&&Array.isArray(h)?p=s(h):p=t&&qR(h)?o(h):h,Object.defineProperty(u,d,{...Object.getOwnPropertyDescriptor(a,d),value:p})}return u};return Array.isArray(r)?t?s(r):r.slice():o(r)}});var WR=m((owt,nJ)=>{l();"use strict";var $ke=Jo(),Gke=async function*(r,e){yield*(await $ke(r)).sort(e)};nJ.exports=Gke});var YR=m((awt,sJ)=>{l();"use strict";sJ.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),i=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var n=42;e[t]=n;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==n||o.enumerable!==!0)return!1}return!0}});var Lg=m((cwt,oJ)=>{l();"use strict";var Wke=YR();oJ.exports=function(){return Wke()&&!!Symbol.toStringTag}});var uJ=m((uwt,cJ)=>{l();"use strict";var aJ=typeof Symbol!="undefined"&&Symbol,Yke=YR();cJ.exports=function(){return typeof aJ!="function"||typeof Symbol!="function"||typeof aJ("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Yke()}});var fJ=m((lwt,lJ)=>{l();"use strict";var Xke="Function.prototype.bind called on incompatible ",XR=Array.prototype.slice,Qke=Object.prototype.toString,Zke="[object Function]";lJ.exports=function(e){var t=this;if(typeof t!="function"||Qke.call(t)!==Zke)throw new TypeError(Xke+t);for(var i=XR.call(arguments,1),n,s=function(){if(this instanceof n){var f=t.apply(this,i.concat(XR.call(arguments)));return Object(f)===f?f:this}else return t.apply(e,i.concat(XR.call(arguments)))},o=Math.max(0,t.length-i.length),a=[],c=0;c<o;c++)a.push("$"+c);if(n=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n}});var g5=m((fwt,dJ)=>{l();"use strict";var Jke=fJ();dJ.exports=Function.prototype.bind||Jke});var pJ=m((dwt,hJ)=>{l();"use strict";var eDe=g5();hJ.exports=eDe.call(Function.call,Object.prototype.hasOwnProperty)});var _5=m((hwt,bJ)=>{l();"use strict";var Ft,Mg=SyntaxError,yJ=Function,q0=TypeError,QR=function(r){try{return yJ('"use strict"; return ('+r+").constructor;")()}catch(e){}},Kd=Object.getOwnPropertyDescriptor;if(Kd)try{Kd({},"")}catch(r){Kd=null}var ZR=function(){throw new q0},tDe=Kd?function(){try{return arguments.callee,ZR}catch(r){try{return Kd(arguments,"callee").get}catch(e){return ZR}}}():ZR,U0=uJ()(),Hl=Object.getPrototypeOf||function(r){return r.__proto__},F0={},rDe=typeof Uint8Array=="undefined"?Ft:Hl(Uint8Array),K0={"%AggregateError%":typeof AggregateError=="undefined"?Ft:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?Ft:ArrayBuffer,"%ArrayIteratorPrototype%":U0?Hl([][Symbol.iterator]()):Ft,"%AsyncFromSyncIteratorPrototype%":Ft,"%AsyncFunction%":F0,"%AsyncGenerator%":F0,"%AsyncGeneratorFunction%":F0,"%AsyncIteratorPrototype%":F0,"%Atomics%":typeof Atomics=="undefined"?Ft:Atomics,"%BigInt%":typeof BigInt=="undefined"?Ft:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?Ft:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?Ft:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?Ft:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?Ft:FinalizationRegistry,"%Function%":yJ,"%GeneratorFunction%":F0,"%Int8Array%":typeof Int8Array=="undefined"?Ft:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?Ft:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?Ft:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":U0?Hl(Hl([][Symbol.iterator]())):Ft,"%JSON%":typeof JSON=="object"?JSON:Ft,"%Map%":typeof Map=="undefined"?Ft:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!U0?Ft:Hl(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?Ft:Promise,"%Proxy%":typeof Proxy=="undefined"?Ft:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?Ft:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?Ft:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!U0?Ft:Hl(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?Ft:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":U0?Hl(""[Symbol.iterator]()):Ft,"%Symbol%":U0?Symbol:Ft,"%SyntaxError%":Mg,"%ThrowTypeError%":tDe,"%TypedArray%":rDe,"%TypeError%":q0,"%Uint8Array%":typeof Uint8Array=="undefined"?Ft:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?Ft:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?Ft:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?Ft:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?Ft:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?Ft:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?Ft:WeakSet},iDe=function r(e){var t;if(e==="%AsyncFunction%")t=QR("async function () {}");else if(e==="%GeneratorFunction%")t=QR("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=QR("async function* () {}");else if(e==="%AsyncGenerator%"){var i=r("%AsyncGeneratorFunction%");i&&(t=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var n=r("%AsyncGenerator%");n&&(t=Hl(n.prototype))}return K0[e]=t,t},gJ={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},m5=g5(),b5=pJ(),nDe=m5.call(Function.call,Array.prototype.concat),sDe=m5.call(Function.apply,Array.prototype.splice),mJ=m5.call(Function.call,String.prototype.replace),w5=m5.call(Function.call,String.prototype.slice),oDe=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,aDe=/\\(\\)?/g,cDe=function(e){var t=w5(e,0,1),i=w5(e,-1);if(t==="%"&&i!=="%")throw new Mg("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&t!=="%")throw new Mg("invalid intrinsic syntax, expected opening `%`");var n=[];return mJ(e,oDe,function(s,o,a,c){n[n.length]=a?mJ(c,aDe,"$1"):o||s}),n},uDe=function(e,t){var i=e,n;if(b5(gJ,i)&&(n=gJ[i],i="%"+n[0]+"%"),b5(K0,i)){var s=K0[i];if(s===F0&&(s=iDe(i)),typeof s=="undefined"&&!t)throw new q0("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:s}}throw new Mg("intrinsic "+e+" does not exist!")};bJ.exports=function(e,t){if(typeof e!="string"||e.length===0)throw new q0("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new q0('"allowMissing" argument must be a boolean');var i=cDe(e),n=i.length>0?i[0]:"",s=uDe("%"+n+"%",t),o=s.name,a=s.value,c=!1,u=s.alias;u&&(n=u[0],sDe(i,nDe([0,1],u)));for(var f=1,d=!0;f<i.length;f+=1){var h=i[f],p=w5(h,0,1),y=w5(h,-1);if((p==='"'||p==="'"||p==="`"||y==='"'||y==="'"||y==="`")&&p!==y)throw new Mg("property names with quotes must have matching quotes");if((h==="constructor"||!d)&&(c=!0),n+="."+h,o="%"+n+"%",b5(K0,o))a=K0[o];else if(a!=null){if(!(h in a)){if(!t)throw new q0("base intrinsic for "+e+" exists, but the property is not available.");return}if(Kd&&f+1>=i.length){var g=Kd(a,h);d=!!g,d&&"get"in g&&!("originalValue"in g.get)?a=g.get:a=a[h]}else d=b5(a,h),a=a[h];d&&!c&&(K0[o]=a)}}return a}});var AJ=m((pwt,v5)=>{l();"use strict";var JR=g5(),V0=_5(),wJ=V0("%Function.prototype.apply%"),_J=V0("%Function.prototype.call%"),vJ=V0("%Reflect.apply%",!0)||JR.call(_J,wJ),EJ=V0("%Object.getOwnPropertyDescriptor%",!0),Vd=V0("%Object.defineProperty%",!0),lDe=V0("%Math.max%");if(Vd)try{Vd({},"a",{value:1})}catch(r){Vd=null}v5.exports=function(e){var t=vJ(JR,_J,arguments);if(EJ&&Vd){var i=EJ(t,"length");i.configurable&&Vd(t,"length",{value:1+lDe(0,e.length-(arguments.length-1))})}return t};var SJ=function(){return vJ(JR,wJ,arguments)};Vd?Vd(v5.exports,"apply",{value:SJ}):v5.exports.apply=SJ});var E5=m((ywt,IJ)=>{l();"use strict";var RJ=_5(),xJ=AJ(),fDe=xJ(RJ("String.prototype.indexOf"));IJ.exports=function(e,t){var i=RJ(e,!!t);return typeof i=="function"&&fDe(e,".prototype.")>-1?xJ(i):i}});var CJ=m((gwt,PJ)=>{l();"use strict";var dDe=Lg()(),hDe=E5(),ex=hDe("Object.prototype.toString"),S5=function(e){return dDe&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:ex(e)==="[object Arguments]"},TJ=function(e){return S5(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&ex(e)!=="[object Array]"&&ex(e.callee)==="[object Function]"},pDe=function(){return S5(arguments)}();S5.isLegacyArguments=TJ;PJ.exports=pDe?S5:TJ});var DJ=m((mwt,kJ)=>{l();"use strict";var yDe=Object.prototype.toString,gDe=Function.prototype.toString,mDe=/^\s*(?:function)?\*/,OJ=Lg()(),tx=Object.getPrototypeOf,bDe=function(){if(!OJ)return!1;try{return Function("return function*() {}")()}catch(r){}},rx;kJ.exports=function(e){if(typeof e!="function")return!1;if(mDe.test(gDe.call(e)))return!0;if(!OJ){var t=yDe.call(e);return t==="[object GeneratorFunction]"}if(!tx)return!1;if(typeof rx=="undefined"){var i=bDe();rx=i?tx(i):!1}return tx(e)===rx}});var ix=m((bwt,NJ)=>{l();var wDe=Object.prototype.hasOwnProperty,_De=Object.prototype.toString;NJ.exports=function(e,t,i){if(_De.call(t)!=="[object Function]")throw new TypeError("iterator must be a function");var n=e.length;if(n===+n)for(var s=0;s<n;s++)t.call(i,e[s],s,e);else for(var o in e)wDe.call(e,o)&&t.call(i,e[o],o,e)}});var sx=m((wwt,BJ)=>{l();"use strict";var nx=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],vDe=globalThis;BJ.exports=function(){for(var e=[],t=0;t<nx.length;t++)typeof vDe[nx[t]]=="function"&&(e[e.length]=nx[t]);return e}});var ox=m((_wt,LJ)=>{l();"use strict";var EDe=_5(),A5=EDe("%Object.getOwnPropertyDescriptor%",!0);if(A5)try{A5([],"length")}catch(r){A5=null}LJ.exports=A5});var ux=m((vwt,FJ)=>{l();"use strict";var MJ=ix(),SDe=sx(),ax=E5(),ADe=ax("Object.prototype.toString"),jJ=Lg()(),RDe=globalThis,qJ=SDe(),xDe=ax("Array.prototype.indexOf",!0)||function(e,t){for(var i=0;i<e.length;i+=1)if(e[i]===t)return i;return-1},IDe=ax("String.prototype.slice"),UJ={},R5=ox(),cx=Object.getPrototypeOf;jJ&&R5&&cx&&MJ(qJ,function(r){var e=new RDe[r];if(Symbol.toStringTag in e){var t=cx(e),i=R5(t,Symbol.toStringTag);if(!i){var n=cx(t);i=R5(n,Symbol.toStringTag)}UJ[r]=i.get}});var TDe=function(e){var t=!1;return MJ(UJ,function(i,n){if(!t)try{t=i.call(e)===n}catch(s){}}),t};FJ.exports=function(e){if(!e||typeof e!="object")return!1;if(!jJ||!(Symbol.toStringTag in e)){var t=IDe(ADe(e),8,-1);return xDe(qJ,t)>-1}return R5?TDe(e):!1}});var WJ=m((Ewt,GJ)=>{l();"use strict";var KJ=ix(),PDe=sx(),VJ=E5(),CDe=VJ("Object.prototype.toString"),zJ=Lg()(),HJ=globalThis,ODe=PDe(),kDe=VJ("String.prototype.slice"),$J={},lx=ox(),fx=Object.getPrototypeOf;zJ&&lx&&fx&&KJ(ODe,function(r){if(typeof HJ[r]=="function"){var e=new HJ[r];if(Symbol.toStringTag in e){var t=fx(e),i=lx(t,Symbol.toStringTag);if(!i){var n=fx(t);i=lx(n,Symbol.toStringTag)}$J[r]=i.get}}});var DDe=function(e){var t=!1;return KJ($J,function(i,n){if(!t)try{var s=i.call(e);s===n&&(t=s)}catch(o){}}),t},NDe=ux();GJ.exports=function(e){return NDe(e)?!zJ||!(Symbol.toStringTag in e)?kDe(CDe(e),8,-1):DDe(e):!1}});var cee=m(xt=>{l();"use strict";var BDe=CJ(),LDe=DJ(),aa=WJ(),YJ=ux();function z0(r){return r.call.bind(r)}var XJ=typeof BigInt!="undefined",QJ=typeof Symbol!="undefined",ho=z0(Object.prototype.toString),MDe=z0(Number.prototype.valueOf),jDe=z0(String.prototype.valueOf),qDe=z0(Boolean.prototype.valueOf);XJ&&(ZJ=z0(BigInt.prototype.valueOf));var ZJ;QJ&&(JJ=z0(Symbol.prototype.valueOf));var JJ;function jg(r,e){if(typeof r!="object")return!1;try{return e(r),!0}catch(t){return!1}}xt.isArgumentsObject=BDe;xt.isGeneratorFunction=LDe;xt.isTypedArray=YJ;function UDe(r){return typeof Promise!="undefined"&&r instanceof Promise||r!==null&&typeof r=="object"&&typeof r.then=="function"&&typeof r.catch=="function"}xt.isPromise=UDe;function FDe(r){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(r):YJ(r)||tee(r)}xt.isArrayBufferView=FDe;function KDe(r){return aa(r)==="Uint8Array"}xt.isUint8Array=KDe;function VDe(r){return aa(r)==="Uint8ClampedArray"}xt.isUint8ClampedArray=VDe;function zDe(r){return aa(r)==="Uint16Array"}xt.isUint16Array=zDe;function HDe(r){return aa(r)==="Uint32Array"}xt.isUint32Array=HDe;function $De(r){return aa(r)==="Int8Array"}xt.isInt8Array=$De;function GDe(r){return aa(r)==="Int16Array"}xt.isInt16Array=GDe;function WDe(r){return aa(r)==="Int32Array"}xt.isInt32Array=WDe;function YDe(r){return aa(r)==="Float32Array"}xt.isFloat32Array=YDe;function XDe(r){return aa(r)==="Float64Array"}xt.isFloat64Array=XDe;function QDe(r){return aa(r)==="BigInt64Array"}xt.isBigInt64Array=QDe;function ZDe(r){return aa(r)==="BigUint64Array"}xt.isBigUint64Array=ZDe;function x5(r){return ho(r)==="[object Map]"}x5.working=typeof Map!="undefined"&&x5(new Map);function JDe(r){return typeof Map=="undefined"?!1:x5.working?x5(r):r instanceof Map}xt.isMap=JDe;function I5(r){return ho(r)==="[object Set]"}I5.working=typeof Set!="undefined"&&I5(new Set);function eNe(r){return typeof Set=="undefined"?!1:I5.working?I5(r):r instanceof Set}xt.isSet=eNe;function T5(r){return ho(r)==="[object WeakMap]"}T5.working=typeof WeakMap!="undefined"&&T5(new WeakMap);function tNe(r){return typeof WeakMap=="undefined"?!1:T5.working?T5(r):r instanceof WeakMap}xt.isWeakMap=tNe;function dx(r){return ho(r)==="[object WeakSet]"}dx.working=typeof WeakSet!="undefined"&&dx(new WeakSet);function rNe(r){return dx(r)}xt.isWeakSet=rNe;function P5(r){return ho(r)==="[object ArrayBuffer]"}P5.working=typeof ArrayBuffer!="undefined"&&P5(new ArrayBuffer);function eee(r){return typeof ArrayBuffer=="undefined"?!1:P5.working?P5(r):r instanceof ArrayBuffer}xt.isArrayBuffer=eee;function C5(r){return ho(r)==="[object DataView]"}C5.working=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined"&&C5(new DataView(new ArrayBuffer(1),0,1));function tee(r){return typeof DataView=="undefined"?!1:C5.working?C5(r):r instanceof DataView}xt.isDataView=tee;var hx=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:void 0;function qg(r){return ho(r)==="[object SharedArrayBuffer]"}function ree(r){return typeof hx=="undefined"?!1:(typeof qg.working=="undefined"&&(qg.working=qg(new hx)),qg.working?qg(r):r instanceof hx)}xt.isSharedArrayBuffer=ree;function iNe(r){return ho(r)==="[object AsyncFunction]"}xt.isAsyncFunction=iNe;function nNe(r){return ho(r)==="[object Map Iterator]"}xt.isMapIterator=nNe;function sNe(r){return ho(r)==="[object Set Iterator]"}xt.isSetIterator=sNe;function oNe(r){return ho(r)==="[object Generator]"}xt.isGeneratorObject=oNe;function aNe(r){return ho(r)==="[object WebAssembly.Module]"}xt.isWebAssemblyCompiledModule=aNe;function iee(r){return jg(r,MDe)}xt.isNumberObject=iee;function nee(r){return jg(r,jDe)}xt.isStringObject=nee;function see(r){return jg(r,qDe)}xt.isBooleanObject=see;function oee(r){return XJ&&jg(r,ZJ)}xt.isBigIntObject=oee;function aee(r){return QJ&&jg(r,JJ)}xt.isSymbolObject=aee;function cNe(r){return iee(r)||nee(r)||see(r)||oee(r)||aee(r)}xt.isBoxedPrimitive=cNe;function uNe(r){return typeof Uint8Array!="undefined"&&(eee(r)||ree(r))}xt.isAnyArrayBuffer=uNe;["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(r){Object.defineProperty(xt,r,{enumerable:!1,value:function(){throw new Error(r+" is not supported in userland")}})})});var lee=m((Awt,uee)=>{l();uee.exports=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}});var xs=m((Rwt,px)=>{l();typeof Object.create=="function"?px.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:px.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}});var gee=m(It=>{l();var fee=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),i={},n=0;n<t.length;n++)i[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return i},lNe=/%[sdj%]/g;It.format=function(r){if(!B5(r)){for(var e=[],t=0;t<arguments.length;t++)e.push($l(arguments[t]));return e.join(" ")}for(var t=1,i=arguments,n=i.length,s=String(r).replace(lNe,function(a){if(a==="%%")return"%";if(t>=n)return a;switch(a){case"%s":return String(i[t++]);case"%d":return Number(i[t++]);case"%j":try{return JSON.stringify(i[t++])}catch(c){return"[Circular]"}default:return a}}),o=i[t];t<n;o=i[++t])N5(o)||!H0(o)?s+=" "+o:s+=" "+$l(o);return s};It.deprecate=function(r,e){if(typeof process!="undefined"&&process.noDeprecation===!0)return r;if(typeof process=="undefined")return function(){return It.deprecate(r,e).apply(this,arguments)};var t=!1;function i(){if(!t){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),t=!0}return r.apply(this,arguments)}return i};var O5={},dee=/^$/;process.env.NODE_DEBUG&&(k5=process.env.NODE_DEBUG,k5=k5.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),dee=new RegExp("^"+k5+"$","i"));var k5;It.debuglog=function(r){if(r=r.toUpperCase(),!O5[r])if(dee.test(r)){var e=process.pid;O5[r]=function(){var t=It.format.apply(It,arguments);console.error("%s %d: %s",r,e,t)}}else O5[r]=function(){};return O5[r]};function $l(r,e){var t={seen:[],stylize:dNe};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),mx(e)?t.showHidden=e:e&&It._extend(t,e),zd(t.showHidden)&&(t.showHidden=!1),zd(t.depth)&&(t.depth=2),zd(t.colors)&&(t.colors=!1),zd(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=fNe),D5(t,r,t.depth)}It.inspect=$l;$l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};$l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function fNe(r,e){var t=$l.styles[e];return t?"["+$l.colors[t][0]+"m"+r+"["+$l.colors[t][1]+"m":r}function dNe(r,e){return r}function hNe(r){var e={};return r.forEach(function(t,i){e[t]=!0}),e}function D5(r,e,t){if(r.customInspect&&e&&M5(e.inspect)&&e.inspect!==It.inspect&&!(e.constructor&&e.constructor.prototype===e)){var i=e.inspect(t,r);return B5(i)||(i=D5(r,i,t)),i}var n=pNe(r,e);if(n)return n;var s=Object.keys(e),o=hNe(s);if(r.showHidden&&(s=Object.getOwnPropertyNames(e)),Fg(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return yx(e);if(s.length===0){if(M5(e)){var a=e.name?": "+e.name:"";return r.stylize("[Function"+a+"]","special")}if(Ug(e))return r.stylize(RegExp.prototype.toString.call(e),"regexp");if(L5(e))return r.stylize(Date.prototype.toString.call(e),"date");if(Fg(e))return yx(e)}var c="",u=!1,f=["{","}"];if(hee(e)&&(u=!0,f=["[","]"]),M5(e)){var d=e.name?": "+e.name:"";c=" [Function"+d+"]"}if(Ug(e)&&(c=" "+RegExp.prototype.toString.call(e)),L5(e)&&(c=" "+Date.prototype.toUTCString.call(e)),Fg(e)&&(c=" "+yx(e)),s.length===0&&(!u||e.length==0))return f[0]+c+f[1];if(t<0)return Ug(e)?r.stylize(RegExp.prototype.toString.call(e),"regexp"):r.stylize("[Object]","special");r.seen.push(e);var h;return u?h=yNe(r,e,t,o,s):h=s.map(function(p){return gx(r,e,t,o,p,u)}),r.seen.pop(),gNe(h,c,f)}function pNe(r,e){if(zd(e))return r.stylize("undefined","undefined");if(B5(e)){var t="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(t,"string")}if(pee(e))return r.stylize(""+e,"number");if(mx(e))return r.stylize(""+e,"boolean");if(N5(e))return r.stylize("null","null")}function yx(r){return"["+Error.prototype.toString.call(r)+"]"}function yNe(r,e,t,i,n){for(var s=[],o=0,a=e.length;o<a;++o)yee(e,String(o))?s.push(gx(r,e,t,i,String(o),!0)):s.push("");return n.forEach(function(c){c.match(/^\d+$/)||s.push(gx(r,e,t,i,c,!0))}),s}function gx(r,e,t,i,n,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]},c.get?c.set?a=r.stylize("[Getter/Setter]","special"):a=r.stylize("[Getter]","special"):c.set&&(a=r.stylize("[Setter]","special")),yee(i,n)||(o="["+n+"]"),a||(r.seen.indexOf(c.value)<0?(N5(t)?a=D5(r,c.value,null):a=D5(r,c.value,t-1),a.indexOf(`
`)>-1&&(s?a=a.split(`
`).map(function(u){return"  "+u}).join(`
`).substr(2):a=`
`+a.split(`
`).map(function(u){return"   "+u}).join(`
`))):a=r.stylize("[Circular]","special")),zd(o)){if(s&&n.match(/^\d+$/))return a;o=JSON.stringify(""+n),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=r.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=r.stylize(o,"string"))}return o+": "+a}function gNe(r,e,t){var i=0,n=r.reduce(function(s,o){return i++,o.indexOf(`
`)>=0&&i++,s+o.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?t[0]+(e===""?"":e+`
 `)+" "+r.join(`,
  `)+" "+t[1]:t[0]+e+" "+r.join(", ")+" "+t[1]}It.types=cee();function hee(r){return Array.isArray(r)}It.isArray=hee;function mx(r){return typeof r=="boolean"}It.isBoolean=mx;function N5(r){return r===null}It.isNull=N5;function mNe(r){return r==null}It.isNullOrUndefined=mNe;function pee(r){return typeof r=="number"}It.isNumber=pee;function B5(r){return typeof r=="string"}It.isString=B5;function bNe(r){return typeof r=="symbol"}It.isSymbol=bNe;function zd(r){return r===void 0}It.isUndefined=zd;function Ug(r){return H0(r)&&bx(r)==="[object RegExp]"}It.isRegExp=Ug;It.types.isRegExp=Ug;function H0(r){return typeof r=="object"&&r!==null}It.isObject=H0;function L5(r){return H0(r)&&bx(r)==="[object Date]"}It.isDate=L5;It.types.isDate=L5;function Fg(r){return H0(r)&&(bx(r)==="[object Error]"||r instanceof Error)}It.isError=Fg;It.types.isNativeError=Fg;function M5(r){return typeof r=="function"}It.isFunction=M5;function wNe(r){return r===null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||typeof r=="symbol"||typeof r=="undefined"}It.isPrimitive=wNe;It.isBuffer=lee();function bx(r){return Object.prototype.toString.call(r)}function wx(r){return r<10?"0"+r.toString(10):r.toString(10)}var _Ne=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function vNe(){var r=new Date,e=[wx(r.getHours()),wx(r.getMinutes()),wx(r.getSeconds())].join(":");return[r.getDate(),_Ne[r.getMonth()],e].join(" ")}It.log=function(){console.log("%s - %s",vNe(),It.format.apply(It,arguments))};It.inherits=xs();It._extend=function(r,e){if(!e||!H0(e))return r;for(var t=Object.keys(e),i=t.length;i--;)r[t[i]]=e[t[i]];return r};function yee(r,e){return Object.prototype.hasOwnProperty.call(r,e)}var Hd=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;It.promisify=function(e){if(typeof e!="function")throw new TypeError('The "original" argument must be of type Function');if(Hd&&e[Hd]){var t=e[Hd];if(typeof t!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,Hd,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var i,n,s=new Promise(function(c,u){i=c,n=u}),o=[],a=0;a<arguments.length;a++)o.push(arguments[a]);o.push(function(c,u){c?n(c):i(u)});try{e.apply(this,o)}catch(c){n(c)}return s}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Hd&&Object.defineProperty(t,Hd,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,fee(e))};It.promisify.custom=Hd;function ENe(r,e){if(!r){var t=new Error("Promise was rejected with a falsy value");t.reason=r,r=t}return e(r)}function SNe(r){if(typeof r!="function")throw new TypeError('The "original" argument must be of type Function');function e(){for(var t=[],i=0;i<arguments.length;i++)t.push(arguments[i]);var n=t.pop();if(typeof n!="function")throw new TypeError("The last argument must be of type Function");var s=this,o=function(){return n.apply(s,arguments)};r.apply(this,t).then(function(a){process.nextTick(o.bind(null,null,a))},function(a){process.nextTick(ENe.bind(null,a,o))})}return Object.setPrototypeOf(e,Object.getPrototypeOf(r)),Object.defineProperties(e,fee(r)),e}It.callbackify=SNe});var _x=m((Iwt,bee)=>{l();"use strict";bee.exports=function(...e){let t=e.reduce((i,n)=>Object.assign(i,n),{});return Object.assign(t,{bufferKeys:t.bufferKeys||!1,snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,getMany:t.getMany||!1,keyIterator:t.keyIterator||!1,valueIterator:t.valueIterator||!1,iteratorNextv:t.iteratorNextv||!1,iteratorAll:t.iteratorAll||!1,status:t.status||!1,idempotentOpen:t.idempotentOpen||!1,passiveOpen:t.passiveOpen||!1,serialize:t.serialize||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,openCallback:t.openCallback||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:mee(t.encodings),events:mee(t.events),additionalMethods:Object.assign({},t.additionalMethods)})};function mee(r){return r?Object.assign({},r):!1}});var _ee=m((Twt,wee)=>{l();wee.exports=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}});var Eee=m((Pwt,vee)=>{l();vee.exports=typeof queueMicrotask=="function"?queueMicrotask:r=>Promise.resolve().then(r)});var j5=m(vx=>{l();"use strict";var See=Eee();vx.fromCallback=function(r,e){if(r===void 0){var t=new Promise(function(i,n){r=function(s,o){s?n(s):i(o)}});r[e!==void 0?e:"promise"]=t}else if(typeof r!="function")throw new TypeError("Callback must be a function");return r};vx.fromPromise=function(r,e){if(e===void 0)return r;r.then(function(t){See(()=>e(null,t))}).catch(function(t){See(()=>e(t))})}});var Kg=m((Owt,Ree)=>{l();var Aee;Ree.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window!="undefined"?window:globalThis):r=>(Aee||(Aee=Promise.resolve())).then(r).catch(e=>setTimeout(()=>{throw e},0))});var q5=m((kwt,Iee)=>{l();"use strict";var xee=Kg();Iee.exports=function(r,...e){e.length===0?xee(r):xee(()=>r(...e))}});var Ex=m((Dwt,Tee)=>{l();"use strict";function yu(r){if(typeof r!="object"||r===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=r,this._ended=!1,this._nexting=!1}yu.prototype.next=function(r){let e=this;if(r===void 0)e=new Promise(function(t,i){r=function(n,s,o){n?i(n):s===void 0&&o===void 0?t():t([s,o])}});else if(typeof r!="function")throw new Error("next() requires a callback argument");return this._ended?(this._nextTick(r,new Error("cannot call next() after end()")),e):this._nexting?(this._nextTick(r,new Error("cannot call next() before previous next() has completed")),e):(this._nexting=!0,this._next((t,...i)=>{this._nexting=!1,r(t,...i)}),e)};yu.prototype._next=function(r){this._nextTick(r)};yu.prototype.seek=function(r){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");r=this.db._serializeKey(r),this._seek(r)};yu.prototype._seek=function(r){};yu.prototype.end=function(r){let e;if(r===void 0)e=new Promise(function(t,i){r=function(n){n?i(n):t()}});else if(typeof r!="function")throw new Error("end() requires a callback argument");return this._ended?(this._nextTick(r,new Error("end() already called on iterator")),e):(this._ended=!0,this._end(r),e)};yu.prototype._end=function(r){this._nextTick(r)};yu.prototype[Symbol.asyncIterator]=async function*(){try{let r;for(;(r=await this.next())!==void 0;)yield r}finally{this._ended||await this.end()}};yu.prototype._nextTick=q5();Tee.exports=yu});var Sx=m((Nwt,Cee)=>{l();"use strict";var Pee=Object.freeze({});function ca(r){if(typeof r!="object"||r===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=r,this._operations=[],this._written=!1}ca.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")};ca.prototype.put=function(r,e,t){this._checkWritten();let i=this.db._checkKey(r)||this.db._checkValue(e);if(i)throw i;return r=this.db._serializeKey(r),e=this.db._serializeValue(e),this._put(r,e,t??Pee),this};ca.prototype._put=function(r,e,t){this._operations.push({...t,type:"put",key:r,value:e})};ca.prototype.del=function(r,e){this._checkWritten();let t=this.db._checkKey(r);if(t)throw t;return r=this.db._serializeKey(r),this._del(r,e??Pee),this};ca.prototype._del=function(r,e){this._operations.push({...e,type:"del",key:r})};ca.prototype.clear=function(){return this._checkWritten(),this._clear(),this};ca.prototype._clear=function(){this._operations=[]};ca.prototype.write=function(r,e){if(this._checkWritten(),typeof r=="function"&&(e=r),typeof e!="function")throw new Error("write() requires a callback argument");(typeof r!="object"||r===null)&&(r={}),this._written=!0,this._write(r,e)};ca.prototype._write=function(r,e){this.db._batch(this._operations,r,e)};ca.prototype._nextTick=q5();Cee.exports=ca});var Rx=m(Ax=>{l();"use strict";Ax.getCallback=function(r,e){return typeof r=="function"?r:e};Ax.getOptions=function(r){return typeof r=="object"&&r!==null?r:{}}});var Dee=m((Lwt,kee)=>{l();"use strict";var ANe=_x(),RNe=_ee(),xNe=j5(),INe=Ex(),TNe=Sx(),PNe=Rx().getCallback,CNe=Rx().getOptions,ONe=Object.prototype.hasOwnProperty,kNe=["lt","lte","gt","gte"];function pr(r){this.status="new",this.supports=ANe(r,{status:!0})}pr.prototype.open=function(r,e){let t=this.status;if(typeof r=="function"&&(e=r),typeof e!="function")throw new Error("open() requires a callback argument");(typeof r!="object"||r===null)&&(r={}),r.createIfMissing=r.createIfMissing!==!1,r.errorIfExists=!!r.errorIfExists,this.status="opening",this._open(r,i=>{if(i)return this.status=t,e(i);this.status="open",e()})};pr.prototype._open=function(r,e){this._nextTick(e)};pr.prototype.close=function(r){let e=this.status;if(typeof r!="function")throw new Error("close() requires a callback argument");this.status="closing",this._close(t=>{if(t)return this.status=e,r(t);this.status="closed",r()})};pr.prototype._close=function(r){this._nextTick(r)};pr.prototype.get=function(r,e,t){if(typeof e=="function"&&(t=e),typeof t!="function")throw new Error("get() requires a callback argument");let i=this._checkKey(r);if(i)return this._nextTick(t,i);r=this._serializeKey(r),(typeof e!="object"||e===null)&&(e={}),e.asBuffer=e.asBuffer!==!1,this._get(r,e,t)};pr.prototype._get=function(r,e,t){this._nextTick(function(){t(new Error("NotFound"))})};pr.prototype.getMany=function(r,e,t){if(t=PNe(e,t),t=xNe.fromCallback(t),e=CNe(e),NNe(this,t))return t.promise;if(!Array.isArray(r))return this._nextTick(t,new Error("getMany() requires an array argument")),t.promise;if(r.length===0)return this._nextTick(t,null,[]),t.promise;typeof e.asBuffer!="boolean"&&(e={...e,asBuffer:!0});let i=new Array(r.length);for(let n=0;n<r.length;n++){let s=r[n],o=this._checkKey(s);if(o)return this._nextTick(t,o),t.promise;i[n]=this._serializeKey(s)}return this._getMany(i,e,t),t.promise};pr.prototype._getMany=function(r,e,t){this._nextTick(t,null,new Array(r.length).fill(void 0))};pr.prototype.put=function(r,e,t,i){if(typeof t=="function"&&(i=t),typeof i!="function")throw new Error("put() requires a callback argument");let n=this._checkKey(r)||this._checkValue(e);if(n)return this._nextTick(i,n);r=this._serializeKey(r),e=this._serializeValue(e),(typeof t!="object"||t===null)&&(t={}),this._put(r,e,t,i)};pr.prototype._put=function(r,e,t,i){this._nextTick(i)};pr.prototype.del=function(r,e,t){if(typeof e=="function"&&(t=e),typeof t!="function")throw new Error("del() requires a callback argument");let i=this._checkKey(r);if(i)return this._nextTick(t,i);r=this._serializeKey(r),(typeof e!="object"||e===null)&&(e={}),this._del(r,e,t)};pr.prototype._del=function(r,e,t){this._nextTick(t)};pr.prototype.batch=function(r,e,t){if(!arguments.length)return this._chainedBatch();if(typeof e=="function"&&(t=e),typeof r=="function"&&(t=r),typeof t!="function")throw new Error("batch(array) requires a callback argument");if(!Array.isArray(r))return this._nextTick(t,new Error("batch(array) requires an array argument"));if(r.length===0)return this._nextTick(t);(typeof e!="object"||e===null)&&(e={});let i=new Array(r.length);for(let n=0;n<r.length;n++){if(typeof r[n]!="object"||r[n]===null)return this._nextTick(t,new Error("batch(array) element must be an object and not `null`"));let s=Object.assign({},r[n]);if(s.type!=="put"&&s.type!=="del")return this._nextTick(t,new Error("`type` must be 'put' or 'del'"));let o=this._checkKey(s.key);if(o)return this._nextTick(t,o);if(s.key=this._serializeKey(s.key),s.type==="put"){let a=this._checkValue(s.value);if(a)return this._nextTick(t,a);s.value=this._serializeValue(s.value)}i[n]=s}this._batch(i,e,t)};pr.prototype._batch=function(r,e,t){this._nextTick(t)};pr.prototype.clear=function(r,e){if(typeof r=="function")e=r;else if(typeof e!="function")throw new Error("clear() requires a callback argument");r=Oee(this,r),r.reverse=!!r.reverse,r.limit="limit"in r?r.limit:-1,this._clear(r,e)};pr.prototype._clear=function(r,e){r.keys=!0,r.values=!1,r.keyAsBuffer=!0,r.valueAsBuffer=!0;let t=this._iterator(r),i={},n=s=>{if(s)return t.end(function(){e(s)});t.next((o,a)=>{if(o)return n(o);if(a===void 0)return t.end(e);this._del(a,i,n)})};n()};pr.prototype._setupIteratorOptions=function(r){return r=Oee(this,r),r.reverse=!!r.reverse,r.keys=r.keys!==!1,r.values=r.values!==!1,r.limit="limit"in r?r.limit:-1,r.keyAsBuffer=r.keyAsBuffer!==!1,r.valueAsBuffer=r.valueAsBuffer!==!1,r};function Oee(r,e){let t={};for(let i in e){if(!ONe.call(e,i))continue;if(i==="start"||i==="end")throw new Error('Legacy range options ("start" and "end") have been removed');let n=e[i];DNe(i)&&(n=r._serializeKey(n)),t[i]=n}return t}function DNe(r){return kNe.indexOf(r)!==-1}pr.prototype.iterator=function(r){return(typeof r!="object"||r===null)&&(r={}),r=this._setupIteratorOptions(r),this._iterator(r)};pr.prototype._iterator=function(r){return new INe(this)};pr.prototype._chainedBatch=function(){return new TNe(this)};pr.prototype._serializeKey=function(r){return r};pr.prototype._serializeValue=function(r){return r};pr.prototype._checkKey=function(r){if(r==null)return new Error("key cannot be `null` or `undefined`");if(RNe(r)&&r.length===0)return new Error("key cannot be an empty Buffer");if(r==="")return new Error("key cannot be an empty String");if(Array.isArray(r)&&r.length===0)return new Error("key cannot be an empty Array")};pr.prototype._checkValue=function(r){if(r==null)return new Error("value cannot be `null` or `undefined`")};pr.prototype.isOperational=function(){return this.status==="open"||this._isOperational()};pr.prototype._isOperational=function(){return!1};pr.prototype._nextTick=q5();kee.exports=pr;function NNe(r,e){return r.isOperational()?!1:(r._nextTick(e,new Error("Database is not open")),!0)}});var gu=m(U5=>{l();"use strict";U5.AbstractLevelDOWN=Dee();U5.AbstractIterator=Ex();U5.AbstractChainedBatch=Sx()});var xx=m(Nee=>{l();"use strict";Nee.getCallback=function(r,e,t){let i=r[r.length-1];if(typeof i!="function"){let n=new Promise((s,o)=>{r.push(i=function(a,...c){a?o(a):s(t?t(...c):c[0])})});i[e]=n}return i}});var qee=m((qwt,jee)=>{l();"use strict";var{AbstractIterator:Bee}=gu(),BNe=xs(),Lee=xx().getCallback,Mee=Symbol("options"),$0=Symbol("iterator"),G0=Symbol("operations"),F5=Symbol("promise");function $d(r,e){Bee.call(this,r),this[Mee]=e,this[$0]=null,this[G0]=[]}BNe($d,Bee);$d.prototype.setDb=function(r){this[$0]=r.iterator(this[Mee]);for(let e of this[G0].splice(0,this[G0].length))this[$0][e.method](...e.args)};$d.prototype.next=function(...r){if(this.db.status==="open")return this[$0].next(...r);let e=Lee(r,F5,function(i,n){if(!(i===void 0&&n===void 0))return[i,n]});return this.db.status==="opening"?this[G0].push({method:"next",args:r}):this._nextTick(e,new Error("Database is not open")),e[F5]||this};$d.prototype.seek=function(...r){if(this.db.status==="open")this[$0].seek(...r);else if(this.db.status==="opening")this[G0].push({method:"seek",args:r});else throw new Error("Database is not open")};$d.prototype.end=function(...r){if(this.db.status==="open")return this[$0].end(...r);let e=Lee(r,F5);return this.db.status==="opening"?this[G0].push({method:"end",args:r}):this._nextTick(e,new Error("Database is not open")),e[F5]||this};for(let r of["next","seek","end"])$d.prototype["_"+r]=function(){throw new Error("Did not expect private method to be called: "+r)};jee.exports=$d});var Fee=m((Fwt,Uee)=>{l();"use strict";var{AbstractChainedBatch:LNe}=gu(),Vg=Symbol("operations");Uee.exports=class extends LNe{constructor(e){super(e);this[Vg]=[]}_put(e,t,i){this[Vg].push({...i,type:"put",key:e,value:t})}_del(e,t){this[Vg].push({...t,type:"del",key:e})}_clear(){this[Vg]=[]}_write(e,t){this.db.batch(this[Vg],e,t)}}});var $ee=m((Kwt,Ix)=>{l();"use strict";var{AbstractLevelDOWN:Kee}=gu(),MNe=xs(),Vee=qee(),jNe=Fee(),qNe=xx().getCallback,zee=["put","get","getMany","del","batch","clear"],UNe=["approximateSize","compactRange"],ua=Symbol("innerDb"),W0=Symbol("operations"),Hee=Symbol("promise");function Gd(r){Kee.call(this,r.supports||{});for(let e of UNe)typeof r[e]=="function"&&!this.supports.additionalMethods[e]&&(this.supports.additionalMethods[e]=!0);this[ua]=r,this[W0]=[],FNe(this)}MNe(Gd,Kee);Gd.prototype.type="deferred-leveldown";Object.defineProperty(Gd.prototype,"_db",{enumerable:!0,get(){return this[ua]}});Gd.prototype._open=function(r,e){let t=i=>{if(i||this[ua].status!=="open")return e(i||new Error("Database is not open"));let n=this[W0];this[W0]=[];for(let s of n)s.iterator?s.iterator.setDb(this[ua]):this[ua][s.method](...s.args);if(this[W0].length>0)throw new Error("Did not expect further operations");e()};this[ua].status==="new"||this[ua].status==="closed"?this[ua].open(r,t):this._nextTick(t)};Gd.prototype._close=function(r){this[ua].close(r)};Gd.prototype._isOperational=function(){return this.status==="opening"};function FNe(r){let e=Object.keys(r.supports.additionalMethods);for(let t of zee.concat(e))r[t]=function(...i){if(t==="batch"&&i.length===0)return new jNe(this);if(this.status==="open")return this[ua][t](...i);let n=qNe(i,Hee);return this.status==="opening"?this[W0].push({method:t,args:i}):this._nextTick(n,new Error("Database is not open")),n[Hee]};r.iterator=function(t){if(this.status==="open")return this[ua].iterator(t);if(this.status==="opening"){let i=new Vee(this,t);return this[W0].push({iterator:i}),i}else throw new Error("Database is not open")};for(let t of zee.concat(["iterator"]))r["_"+t]=function(){throw new Error("Did not expect private method to be called: "+t)}}Ix.exports=Gd;Ix.exports.DeferredIterator=Vee});var Tx=m((Vwt,Gee)=>{l();Gee.exports=Ut().EventEmitter});var Px=m(()=>{l()});var Qee=m(($wt,Xee)=>{l();"use strict";function Wee(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,i)}return t}function KNe(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Wee(Object(t),!0).forEach(function(i){VNe(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Wee(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}function VNe(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function zNe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Yee(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function HNe(r,e,t){return e&&Yee(r.prototype,e),t&&Yee(r,t),r}var $Ne=ci(),K5=$Ne.Buffer,GNe=Px(),Cx=GNe.inspect,WNe=Cx&&Cx.custom||"inspect";function YNe(r,e,t){K5.prototype.copy.call(r,e,t)}Xee.exports=function(){function r(){zNe(this,r),this.head=null,this.tail=null,this.length=0}return HNe(r,[{key:"push",value:function(t){var i={data:t,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length}},{key:"unshift",value:function(t){var i={data:t,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length}},{key:"shift",value:function(){if(this.length!==0){var t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(this.length===0)return"";for(var i=this.head,n=""+i.data;i=i.next;)n+=t+i.data;return n}},{key:"concat",value:function(t){if(this.length===0)return K5.alloc(0);for(var i=K5.allocUnsafe(t>>>0),n=this.head,s=0;n;)YNe(n.data,i,s),s+=n.data.length,n=n.next;return i}},{key:"consume",value:function(t,i){var n;return t<this.head.data.length?(n=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):t===this.head.data.length?n=this.shift():n=i?this._getString(t):this._getBuffer(t),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var i=this.head,n=1,s=i.data;for(t-=s.length;i=i.next;){var o=i.data,a=t>o.length?o.length:t;if(a===o.length?s+=o:s+=o.slice(0,t),t-=a,t===0){a===o.length?(++n,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=o.slice(a));break}++n}return this.length-=n,s}},{key:"_getBuffer",value:function(t){var i=K5.allocUnsafe(t),n=this.head,s=1;for(n.data.copy(i),t-=n.data.length;n=n.next;){var o=n.data,a=t>o.length?o.length:t;if(o.copy(i,i.length-t,0,a),t-=a,t===0){a===o.length?(++s,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=o.slice(a));break}++s}return this.length-=s,i}},{key:WNe,value:function(t,i){return Cx(this,KNe({},i,{depth:0,customInspect:!1}))}}]),r}()});var kx=m((Gwt,Jee)=>{l();"use strict";function XNe(r,e){var t=this,i=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return i||n?(e?e(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(Ox,this,r)):process.nextTick(Ox,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(s){!e&&s?t._writableState?t._writableState.errorEmitted?process.nextTick(V5,t):(t._writableState.errorEmitted=!0,process.nextTick(Zee,t,s)):process.nextTick(Zee,t,s):e?(process.nextTick(V5,t),e(s)):process.nextTick(V5,t)}),this)}function Zee(r,e){Ox(r,e),V5(r)}function V5(r){r._writableState&&!r._writableState.emitClose||r._readableState&&!r._readableState.emitClose||r.emit("close")}function QNe(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Ox(r,e){r.emit("error",e)}function ZNe(r,e){var t=r._readableState,i=r._writableState;t&&t.autoDestroy||i&&i.autoDestroy?r.destroy(e):r.emit("error",e)}Jee.exports={destroy:XNe,undestroy:QNe,errorOrDestroy:ZNe}});var Wd=m((Wwt,rte)=>{l();"use strict";function JNe(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}var ete={};function po(r,e,t){t||(t=Error);function i(s,o,a){return typeof e=="string"?e:e(s,o,a)}var n=function(s){JNe(o,s);function o(a,c,u){return s.call(this,i(a,c,u))||this}return o}(t);n.prototype.name=t.name,n.prototype.code=r,ete[r]=n}function tte(r,e){if(Array.isArray(r)){var t=r.length;return r=r.map(function(i){return String(i)}),t>2?"one of ".concat(e," ").concat(r.slice(0,t-1).join(", "),", or ")+r[t-1]:t===2?"one of ".concat(e," ").concat(r[0]," or ").concat(r[1]):"of ".concat(e," ").concat(r[0])}else return"of ".concat(e," ").concat(String(r))}function eBe(r,e,t){return r.substr(!t||t<0?0:+t,e.length)===e}function tBe(r,e,t){return(t===void 0||t>r.length)&&(t=r.length),r.substring(t-e.length,t)===e}function rBe(r,e,t){return typeof t!="number"&&(t=0),t+e.length>r.length?!1:r.indexOf(e,t)!==-1}po("ERR_INVALID_OPT_VALUE",function(r,e){return'The value "'+e+'" is invalid for option "'+r+'"'},TypeError);po("ERR_INVALID_ARG_TYPE",function(r,e,t){var i;typeof e=="string"&&eBe(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";var n;if(tBe(r," argument"))n="The ".concat(r," ").concat(i," ").concat(tte(e,"type"));else{var s=rBe(r,".")?"property":"argument";n='The "'.concat(r,'" ').concat(s," ").concat(i," ").concat(tte(e,"type"))}return n+=". Received type ".concat(typeof t),n},TypeError);po("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");po("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"});po("ERR_STREAM_PREMATURE_CLOSE","Premature close");po("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"});po("ERR_MULTIPLE_CALLBACK","Callback called multiple times");po("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");po("ERR_STREAM_WRITE_AFTER_END","write after end");po("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);po("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError);po("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");rte.exports.codes=ete});var Dx=m((Ywt,ite)=>{l();"use strict";var iBe=Wd().codes.ERR_INVALID_OPT_VALUE;function nBe(r,e,t){return r.highWaterMark!=null?r.highWaterMark:e?r[t]:null}function sBe(r,e,t,i){var n=nBe(e,i,t);if(n!=null){if(!(isFinite(n)&&Math.floor(n)===n)||n<0){var s=i?t:"highWaterMark";throw new iBe(s,n)}return Math.floor(n)}return r.objectMode?16:16*1024}ite.exports={getHighWaterMark:sBe}});var ste=m((Xwt,nte)=>{l();nte.exports=oBe;function oBe(r,e){if(Nx("noDeprecation"))return r;var t=!1;function i(){if(!t){if(Nx("throwDeprecation"))throw new Error(e);Nx("traceDeprecation")?console.trace(e):console.warn(e),t=!0}return r.apply(this,arguments)}return i}function Nx(r){try{if(!globalThis.localStorage)return!1}catch(t){return!1}var e=globalThis.localStorage[r];return e==null?!1:String(e).toLowerCase()==="true"}});var Mx=m((Qwt,fte)=>{l();"use strict";fte.exports=ti;function ote(r){var e=this;this.next=null,this.entry=null,this.finish=function(){DBe(e,r)}}var Y0;ti.WritableState=zg;var aBe={deprecate:ste()},ate=Tx(),z5=ci().Buffer,cBe=globalThis.Uint8Array||function(){};function uBe(r){return z5.from(r)}function lBe(r){return z5.isBuffer(r)||r instanceof cBe}var Bx=kx(),fBe=Dx(),dBe=fBe.getHighWaterMark,Gl=Wd().codes,hBe=Gl.ERR_INVALID_ARG_TYPE,pBe=Gl.ERR_METHOD_NOT_IMPLEMENTED,yBe=Gl.ERR_MULTIPLE_CALLBACK,gBe=Gl.ERR_STREAM_CANNOT_PIPE,mBe=Gl.ERR_STREAM_DESTROYED,bBe=Gl.ERR_STREAM_NULL_VALUES,wBe=Gl.ERR_STREAM_WRITE_AFTER_END,_Be=Gl.ERR_UNKNOWN_ENCODING,X0=Bx.errorOrDestroy;xs()(ti,ate);function vBe(){}function zg(r,e,t){Y0=Y0||Yd(),r=r||{},typeof t!="boolean"&&(t=e instanceof Y0),this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.writableObjectMode),this.highWaterMark=dBe(this,r,"writableHighWaterMark",t),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=r.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=r.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(n){TBe(e,n)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=r.emitClose!==!1,this.autoDestroy=!!r.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new ote(this)}zg.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};(function(){try{Object.defineProperty(zg.prototype,"buffer",{get:aBe.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(r){}})();var H5;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(H5=Function.prototype[Symbol.hasInstance],Object.defineProperty(ti,Symbol.hasInstance,{value:function(e){return H5.call(this,e)?!0:this!==ti?!1:e&&e._writableState instanceof zg}})):H5=function(e){return e instanceof this};function ti(r){Y0=Y0||Yd();var e=this instanceof Y0;if(!e&&!H5.call(ti,this))return new ti(r);this._writableState=new zg(r,this,e),this.writable=!0,r&&(typeof r.write=="function"&&(this._write=r.write),typeof r.writev=="function"&&(this._writev=r.writev),typeof r.destroy=="function"&&(this._destroy=r.destroy),typeof r.final=="function"&&(this._final=r.final)),ate.call(this)}ti.prototype.pipe=function(){X0(this,new gBe)};function EBe(r,e){var t=new wBe;X0(r,t),process.nextTick(e,t)}function SBe(r,e,t,i){var n;return t===null?n=new bBe:typeof t!="string"&&!e.objectMode&&(n=new hBe("chunk",["string","Buffer"],t)),n?(X0(r,n),process.nextTick(i,n),!1):!0}ti.prototype.write=function(r,e,t){var i=this._writableState,n=!1,s=!i.objectMode&&lBe(r);return s&&!z5.isBuffer(r)&&(r=uBe(r)),typeof e=="function"&&(t=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),typeof t!="function"&&(t=vBe),i.ending?EBe(this,t):(s||SBe(this,i,r,t))&&(i.pendingcb++,n=RBe(this,i,s,r,e,t)),n};ti.prototype.cork=function(){this._writableState.corked++};ti.prototype.uncork=function(){var r=this._writableState;r.corked&&(r.corked--,!r.writing&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&ute(this,r))};ti.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new _Be(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(ti.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function ABe(r,e,t){return!r.objectMode&&r.decodeStrings!==!1&&typeof e=="string"&&(e=z5.from(e,t)),e}Object.defineProperty(ti.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function RBe(r,e,t,i,n,s){if(!t){var o=ABe(e,i,n);i!==o&&(t=!0,n="buffer",i=o)}var a=e.objectMode?1:i.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:t,callback:s,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else Lx(r,e,!1,a,i,n,s);return c}function Lx(r,e,t,i,n,s,o){e.writelen=i,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new mBe("write")):t?r._writev(n,e.onwrite):r._write(n,s,e.onwrite),e.sync=!1}function xBe(r,e,t,i,n){--e.pendingcb,t?(process.nextTick(n,i),process.nextTick(Hg,r,e),r._writableState.errorEmitted=!0,X0(r,i)):(n(i),r._writableState.errorEmitted=!0,X0(r,i),Hg(r,e))}function IBe(r){r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0}function TBe(r,e){var t=r._writableState,i=t.sync,n=t.writecb;if(typeof n!="function")throw new yBe;if(IBe(t),e)xBe(r,t,i,e,n);else{var s=lte(t)||r.destroyed;!s&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&ute(r,t),i?process.nextTick(cte,r,t,s,n):cte(r,t,s,n)}}function cte(r,e,t,i){t||PBe(r,e),e.pendingcb--,i(),Hg(r,e)}function PBe(r,e){e.length===0&&e.needDrain&&(e.needDrain=!1,r.emit("drain"))}function ute(r,e){e.bufferProcessing=!0;var t=e.bufferedRequest;if(r._writev&&t&&t.next){var i=e.bufferedRequestCount,n=new Array(i),s=e.corkedRequestsFree;s.entry=t;for(var o=0,a=!0;t;)n[o]=t,t.isBuf||(a=!1),t=t.next,o+=1;n.allBuffers=a,Lx(r,e,!0,e.length,n,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new ote(e),e.bufferedRequestCount=0}else{for(;t;){var c=t.chunk,u=t.encoding,f=t.callback,d=e.objectMode?1:c.length;if(Lx(r,e,!1,d,c,u,f),t=t.next,e.bufferedRequestCount--,e.writing)break}t===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=t,e.bufferProcessing=!1}ti.prototype._write=function(r,e,t){t(new pBe("_write()"))};ti.prototype._writev=null;ti.prototype.end=function(r,e,t){var i=this._writableState;return typeof r=="function"?(t=r,r=null,e=null):typeof e=="function"&&(t=e,e=null),r!=null&&this.write(r,e),i.corked&&(i.corked=1,this.uncork()),i.ending||kBe(this,i,t),this};Object.defineProperty(ti.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function lte(r){return r.ending&&r.length===0&&r.bufferedRequest===null&&!r.finished&&!r.writing}function CBe(r,e){r._final(function(t){e.pendingcb--,t&&X0(r,t),e.prefinished=!0,r.emit("prefinish"),Hg(r,e)})}function OBe(r,e){!e.prefinished&&!e.finalCalled&&(typeof r._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(CBe,r,e)):(e.prefinished=!0,r.emit("prefinish")))}function Hg(r,e){var t=lte(e);if(t&&(OBe(r,e),e.pendingcb===0&&(e.finished=!0,r.emit("finish"),e.autoDestroy))){var i=r._readableState;(!i||i.autoDestroy&&i.endEmitted)&&r.destroy()}return t}function kBe(r,e,t){e.ending=!0,Hg(r,e),t&&(e.finished?process.nextTick(t):r.once("finish",t)),e.ended=!0,r.writable=!1}function DBe(r,e,t){var i=r.entry;for(r.entry=null;i;){var n=i.callback;e.pendingcb--,n(t),i=i.next}e.corkedRequestsFree.next=r}Object.defineProperty(ti.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});ti.prototype.destroy=Bx.destroy;ti.prototype._undestroy=Bx.undestroy;ti.prototype._destroy=function(r,e){e(r)}});var Yd=m((Zwt,hte)=>{l();"use strict";var NBe=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};hte.exports=hc;var dte=Ux(),jx=Mx();xs()(hc,dte);for(qx=NBe(jx.prototype),$5=0;$5<qx.length;$5++)G5=qx[$5],hc.prototype[G5]||(hc.prototype[G5]=jx.prototype[G5]);var qx,G5,$5;function hc(r){if(!(this instanceof hc))return new hc(r);dte.call(this,r),jx.call(this,r),this.allowHalfOpen=!0,r&&(r.readable===!1&&(this.readable=!1),r.writable===!1&&(this.writable=!1),r.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",BBe)))}Object.defineProperty(hc.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(hc.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(hc.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function BBe(){this._writableState.ended||process.nextTick(LBe,this)}function LBe(r){r.end()}Object.defineProperty(hc.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var Kx=m((Fx,yte)=>{l();var W5=ci(),pc=W5.Buffer;function pte(r,e){for(var t in r)e[t]=r[t]}pc.from&&pc.alloc&&pc.allocUnsafe&&pc.allocUnsafeSlow?yte.exports=W5:(pte(W5,Fx),Fx.Buffer=Xd);function Xd(r,e,t){return pc(r,e,t)}Xd.prototype=Object.create(pc.prototype);pte(pc,Xd);Xd.from=function(r,e,t){if(typeof r=="number")throw new TypeError("Argument must not be a number");return pc(r,e,t)};Xd.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError("Argument must be a number");var i=pc(r);return e!==void 0?typeof t=="string"?i.fill(e,t):i.fill(e):i.fill(0),i};Xd.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return pc(r)};Xd.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return W5.SlowBuffer(r)}});var Hx=m(mte=>{l();"use strict";var Vx=Kx().Buffer,gte=Vx.isEncoding||function(r){switch(r=""+r,r&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function MBe(r){if(!r)return"utf8";for(var e;;)switch(r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:if(e)return;r=(""+r).toLowerCase(),e=!0}}function jBe(r){var e=MBe(r);if(typeof e!="string"&&(Vx.isEncoding===gte||!gte(r)))throw new Error("Unknown encoding: "+r);return e||r}mte.StringDecoder=$g;function $g(r){this.encoding=jBe(r);var e;switch(this.encoding){case"utf16le":this.text=zBe,this.end=HBe,e=4;break;case"utf8":this.fillLast=FBe,e=4;break;case"base64":this.text=$Be,this.end=GBe,e=3;break;default:this.write=WBe,this.end=YBe;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Vx.allocUnsafe(e)}$g.prototype.write=function(r){if(r.length===0)return"";var e,t;if(this.lastNeed){if(e=this.fillLast(r),e===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<r.length?e?e+this.text(r,t):this.text(r,t):e||""};$g.prototype.end=VBe;$g.prototype.text=KBe;$g.prototype.fillLast=function(r){if(this.lastNeed<=r.length)return r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,r.length),this.lastNeed-=r.length};function zx(r){return r<=127?0:r>>5==6?2:r>>4==14?3:r>>3==30?4:r>>6==2?-1:-2}function qBe(r,e,t){var i=e.length-1;if(i<t)return 0;var n=zx(e[i]);return n>=0?(n>0&&(r.lastNeed=n-1),n):--i<t||n===-2?0:(n=zx(e[i]),n>=0?(n>0&&(r.lastNeed=n-2),n):--i<t||n===-2?0:(n=zx(e[i]),n>=0?(n>0&&(n===2?n=0:r.lastNeed=n-3),n):0))}function UBe(r,e,t){if((e[0]&192)!=128)return r.lastNeed=0,"\uFFFD";if(r.lastNeed>1&&e.length>1){if((e[1]&192)!=128)return r.lastNeed=1,"\uFFFD";if(r.lastNeed>2&&e.length>2&&(e[2]&192)!=128)return r.lastNeed=2,"\uFFFD"}}function FBe(r){var e=this.lastTotal-this.lastNeed,t=UBe(this,r,e);if(t!==void 0)return t;if(this.lastNeed<=r.length)return r.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,e,0,r.length),this.lastNeed-=r.length}function KBe(r,e){var t=qBe(this,r,e);if(!this.lastNeed)return r.toString("utf8",e);this.lastTotal=t;var i=r.length-(t-this.lastNeed);return r.copy(this.lastChar,0,i),r.toString("utf8",e,i)}function VBe(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+"\uFFFD":e}function zBe(r,e){if((r.length-e)%2==0){var t=r.toString("utf16le",e);if(t){var i=t.charCodeAt(t.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=r[r.length-1],r.toString("utf16le",e,r.length-1)}function HBe(r){var e=r&&r.length?this.write(r):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function $Be(r,e){var t=(r.length-e)%3;return t===0?r.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",e,r.length-t))}function GBe(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function WBe(r){return r.toString(this.encoding)}function YBe(r){return r&&r.length?this.write(r):""}});var Y5=m((e8t,_te)=>{l();"use strict";var bte=Wd().codes.ERR_STREAM_PREMATURE_CLOSE;function XBe(r){var e=!1;return function(){if(!e){e=!0;for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];r.apply(this,i)}}}function QBe(){}function ZBe(r){return r.setHeader&&typeof r.abort=="function"}function wte(r,e,t){if(typeof e=="function")return wte(r,null,e);e||(e={}),t=XBe(t||QBe);var i=e.readable||e.readable!==!1&&r.readable,n=e.writable||e.writable!==!1&&r.writable,s=function(){r.writable||a()},o=r._writableState&&r._writableState.finished,a=function(){n=!1,o=!0,i||t.call(r)},c=r._readableState&&r._readableState.endEmitted,u=function(){i=!1,c=!0,n||t.call(r)},f=function(y){t.call(r,y)},d=function(){var y;if(i&&!c)return(!r._readableState||!r._readableState.ended)&&(y=new bte),t.call(r,y);if(n&&!o)return(!r._writableState||!r._writableState.ended)&&(y=new bte),t.call(r,y)},h=function(){r.req.on("finish",a)};return ZBe(r)?(r.on("complete",a),r.on("abort",d),r.req?h():r.on("request",h)):n&&!r._writableState&&(r.on("end",s),r.on("close",s)),r.on("end",u),r.on("finish",a),e.error!==!1&&r.on("error",f),r.on("close",d),function(){r.removeListener("complete",a),r.removeListener("abort",d),r.removeListener("request",h),r.req&&r.req.removeListener("finish",a),r.removeListener("end",s),r.removeListener("close",s),r.removeListener("finish",a),r.removeListener("end",u),r.removeListener("error",f),r.removeListener("close",d)}}_te.exports=wte});var Ete=m((t8t,vte)=>{l();"use strict";var X5;function Wl(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var JBe=Y5(),Yl=Symbol("lastResolve"),Qd=Symbol("lastReject"),Gg=Symbol("error"),Q5=Symbol("ended"),Zd=Symbol("lastPromise"),$x=Symbol("handlePromise"),Jd=Symbol("stream");function Xl(r,e){return{value:r,done:e}}function eLe(r){var e=r[Yl];if(e!==null){var t=r[Jd].read();t!==null&&(r[Zd]=null,r[Yl]=null,r[Qd]=null,e(Xl(t,!1)))}}function tLe(r){process.nextTick(eLe,r)}function rLe(r,e){return function(t,i){r.then(function(){if(e[Q5]){t(Xl(void 0,!0));return}e[$x](t,i)},i)}}var iLe=Object.getPrototypeOf(function(){}),nLe=Object.setPrototypeOf((X5={get stream(){return this[Jd]},next:function(){var e=this,t=this[Gg];if(t!==null)return Promise.reject(t);if(this[Q5])return Promise.resolve(Xl(void 0,!0));if(this[Jd].destroyed)return new Promise(function(o,a){process.nextTick(function(){e[Gg]?a(e[Gg]):o(Xl(void 0,!0))})});var i=this[Zd],n;if(i)n=new Promise(rLe(i,this));else{var s=this[Jd].read();if(s!==null)return Promise.resolve(Xl(s,!1));n=new Promise(this[$x])}return this[Zd]=n,n}},Wl(X5,Symbol.asyncIterator,function(){return this}),Wl(X5,"return",function(){var e=this;return new Promise(function(t,i){e[Jd].destroy(null,function(n){if(n){i(n);return}t(Xl(void 0,!0))})})}),X5),iLe),sLe=function(e){var t,i=Object.create(nLe,(t={},Wl(t,Jd,{value:e,writable:!0}),Wl(t,Yl,{value:null,writable:!0}),Wl(t,Qd,{value:null,writable:!0}),Wl(t,Gg,{value:null,writable:!0}),Wl(t,Q5,{value:e._readableState.endEmitted,writable:!0}),Wl(t,$x,{value:function(s,o){var a=i[Jd].read();a?(i[Zd]=null,i[Yl]=null,i[Qd]=null,s(Xl(a,!1))):(i[Yl]=s,i[Qd]=o)},writable:!0}),t));return i[Zd]=null,JBe(e,function(n){if(n&&n.code!=="ERR_STREAM_PREMATURE_CLOSE"){var s=i[Qd];s!==null&&(i[Zd]=null,i[Yl]=null,i[Qd]=null,s(n)),i[Gg]=n;return}var o=i[Yl];o!==null&&(i[Zd]=null,i[Yl]=null,i[Qd]=null,o(Xl(void 0,!0))),i[Q5]=!0}),e.on("readable",tLe.bind(null,i)),i};vte.exports=sLe});var Ate=m((r8t,Ste)=>{l();Ste.exports=function(){throw new Error("Readable.from is not available in the browser")}});var Ux=m((n8t,Nte)=>{l();"use strict";Nte.exports=Gt;var Q0;Gt.ReadableState=xte;var i8t=Ut().EventEmitter,Rte=function(e,t){return e.listeners(t).length},Wg=Tx(),Z5=ci().Buffer,oLe=globalThis.Uint8Array||function(){};function aLe(r){return Z5.from(r)}function cLe(r){return Z5.isBuffer(r)||r instanceof oLe}var Gx=Px(),vt;Gx&&Gx.debuglog?vt=Gx.debuglog("stream"):vt=function(){};var uLe=Qee(),Wx=kx(),lLe=Dx(),fLe=lLe.getHighWaterMark,J5=Wd().codes,dLe=J5.ERR_INVALID_ARG_TYPE,hLe=J5.ERR_STREAM_PUSH_AFTER_EOF,pLe=J5.ERR_METHOD_NOT_IMPLEMENTED,yLe=J5.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,Z0,Yx,Xx;xs()(Gt,Wg);var Yg=Wx.errorOrDestroy,Qx=["error","close","destroy","pause","resume"];function gLe(r,e,t){if(typeof r.prependListener=="function")return r.prependListener(e,t);!r._events||!r._events[e]?r.on(e,t):Array.isArray(r._events[e])?r._events[e].unshift(t):r._events[e]=[t,r._events[e]]}function xte(r,e,t){Q0=Q0||Yd(),r=r||{},typeof t!="boolean"&&(t=e instanceof Q0),this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.readableObjectMode),this.highWaterMark=fLe(this,r,"readableHighWaterMark",t),this.buffer=new uLe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=r.emitClose!==!1,this.autoDestroy=!!r.autoDestroy,this.destroyed=!1,this.defaultEncoding=r.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,r.encoding&&(Z0||(Z0=Hx().StringDecoder),this.decoder=new Z0(r.encoding),this.encoding=r.encoding)}function Gt(r){if(Q0=Q0||Yd(),!(this instanceof Gt))return new Gt(r);var e=this instanceof Q0;this._readableState=new xte(r,this,e),this.readable=!0,r&&(typeof r.read=="function"&&(this._read=r.read),typeof r.destroy=="function"&&(this._destroy=r.destroy)),Wg.call(this)}Object.defineProperty(Gt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});Gt.prototype.destroy=Wx.destroy;Gt.prototype._undestroy=Wx.undestroy;Gt.prototype._destroy=function(r,e){e(r)};Gt.prototype.push=function(r,e){var t=this._readableState,i;return t.objectMode?i=!0:typeof r=="string"&&(e=e||t.defaultEncoding,e!==t.encoding&&(r=Z5.from(r,e),e=""),i=!0),Ite(this,r,e,!1,i)};Gt.prototype.unshift=function(r){return Ite(this,r,null,!0,!1)};function Ite(r,e,t,i,n){vt("readableAddChunk",e);var s=r._readableState;if(e===null)s.reading=!1,wLe(r,s);else{var o;if(n||(o=mLe(s,e)),o)Yg(r,o);else if(s.objectMode||e&&e.length>0)if(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==Z5.prototype&&(e=aLe(e)),i)s.endEmitted?Yg(r,new yLe):Zx(r,s,e,!0);else if(s.ended)Yg(r,new hLe);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!t?(e=s.decoder.write(e),s.objectMode||e.length!==0?Zx(r,s,e,!1):Jx(r,s)):Zx(r,s,e,!1)}else i||(s.reading=!1,Jx(r,s))}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function Zx(r,e,t,i){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,r.emit("data",t)):(e.length+=e.objectMode?1:t.length,i?e.buffer.unshift(t):e.buffer.push(t),e.needReadable&&ew(r)),Jx(r,e)}function mLe(r,e){var t;return!cLe(e)&&typeof e!="string"&&e!==void 0&&!r.objectMode&&(t=new dLe("chunk",["string","Buffer","Uint8Array"],e)),t}Gt.prototype.isPaused=function(){return this._readableState.flowing===!1};Gt.prototype.setEncoding=function(r){Z0||(Z0=Hx().StringDecoder);var e=new Z0(r);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var t=this._readableState.buffer.head,i="";t!==null;)i+=e.write(t.data),t=t.next;return this._readableState.buffer.clear(),i!==""&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var Tte=1073741824;function bLe(r){return r>=Tte?r=Tte:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r}function Pte(r,e){return r<=0||e.length===0&&e.ended?0:e.objectMode?1:r!==r?e.flowing&&e.length?e.buffer.head.data.length:e.length:(r>e.highWaterMark&&(e.highWaterMark=bLe(r)),r<=e.length?r:e.ended?e.length:(e.needReadable=!0,0))}Gt.prototype.read=function(r){vt("read",r),r=parseInt(r,10);var e=this._readableState,t=r;if(r!==0&&(e.emittedReadable=!1),r===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return vt("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?tI(this):ew(this),null;if(r=Pte(r,e),r===0&&e.ended)return e.length===0&&tI(this),null;var i=e.needReadable;vt("need readable",i),(e.length===0||e.length-r<e.highWaterMark)&&(i=!0,vt("length less than watermark",i)),e.ended||e.reading?(i=!1,vt("reading or ended",i)):i&&(vt("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(r=Pte(t,e)));var n;return r>0?n=kte(r,e):n=null,n===null?(e.needReadable=e.length<=e.highWaterMark,r=0):(e.length-=r,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),t!==r&&e.ended&&tI(this)),n!==null&&this.emit("data",n),n};function wLe(r,e){if(vt("onEofChunk"),!e.ended){if(e.decoder){var t=e.decoder.end();t&&t.length&&(e.buffer.push(t),e.length+=e.objectMode?1:t.length)}e.ended=!0,e.sync?ew(r):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,Cte(r)))}}function ew(r){var e=r._readableState;vt("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(vt("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(Cte,r))}function Cte(r){var e=r._readableState;vt("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(r.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,eI(r)}function Jx(r,e){e.readingMore||(e.readingMore=!0,process.nextTick(_Le,r,e))}function _Le(r,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var t=e.length;if(vt("maybeReadMore read 0"),r.read(0),t===e.length)break}e.readingMore=!1}Gt.prototype._read=function(r){Yg(this,new pLe("_read()"))};Gt.prototype.pipe=function(r,e){var t=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=r;break;case 1:i.pipes=[i.pipes,r];break;default:i.pipes.push(r);break}i.pipesCount+=1,vt("pipe count=%d opts=%j",i.pipesCount,e);var n=(!e||e.end!==!1)&&r!==process.stdout&&r!==process.stderr,s=n?a:g;i.endEmitted?process.nextTick(s):t.once("end",s),r.on("unpipe",o);function o(w,b){vt("onunpipe"),w===t&&b&&b.hasUnpiped===!1&&(b.hasUnpiped=!0,f())}function a(){vt("onend"),r.end()}var c=vLe(t);r.on("drain",c);var u=!1;function f(){vt("cleanup"),r.removeListener("close",p),r.removeListener("finish",y),r.removeListener("drain",c),r.removeListener("error",h),r.removeListener("unpipe",o),t.removeListener("end",a),t.removeListener("end",g),t.removeListener("data",d),u=!0,i.awaitDrain&&(!r._writableState||r._writableState.needDrain)&&c()}t.on("data",d);function d(w){vt("ondata");var b=r.write(w);vt("dest.write",b),b===!1&&((i.pipesCount===1&&i.pipes===r||i.pipesCount>1&&Dte(i.pipes,r)!==-1)&&!u&&(vt("false write response, pause",i.awaitDrain),i.awaitDrain++),t.pause())}function h(w){vt("onerror",w),g(),r.removeListener("error",h),Rte(r,"error")===0&&Yg(r,w)}gLe(r,"error",h);function p(){r.removeListener("finish",y),g()}r.once("close",p);function y(){vt("onfinish"),r.removeListener("close",p),g()}r.once("finish",y);function g(){vt("unpipe"),t.unpipe(r)}return r.emit("pipe",t),i.flowing||(vt("pipe resume"),t.resume()),r};function vLe(r){return function(){var t=r._readableState;vt("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,t.awaitDrain===0&&Rte(r,"data")&&(t.flowing=!0,eI(r))}}Gt.prototype.unpipe=function(r){var e=this._readableState,t={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return r&&r!==e.pipes?this:(r||(r=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,r&&r.emit("unpipe",this,t),this);if(!r){var i=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=Dte(e.pipes,r);return o===-1?this:(e.pipes.splice(o,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),r.emit("unpipe",this,t),this)};Gt.prototype.on=function(r,e){var t=Wg.prototype.on.call(this,r,e),i=this._readableState;return r==="data"?(i.readableListening=this.listenerCount("readable")>0,i.flowing!==!1&&this.resume()):r==="readable"&&!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,vt("on readable",i.length,i.reading),i.length?ew(this):i.reading||process.nextTick(ELe,this)),t};Gt.prototype.addListener=Gt.prototype.on;Gt.prototype.removeListener=function(r,e){var t=Wg.prototype.removeListener.call(this,r,e);return r==="readable"&&process.nextTick(Ote,this),t};Gt.prototype.removeAllListeners=function(r){var e=Wg.prototype.removeAllListeners.apply(this,arguments);return(r==="readable"||r===void 0)&&process.nextTick(Ote,this),e};function Ote(r){var e=r._readableState;e.readableListening=r.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:r.listenerCount("data")>0&&r.resume()}function ELe(r){vt("readable nexttick read 0"),r.read(0)}Gt.prototype.resume=function(){var r=this._readableState;return r.flowing||(vt("resume"),r.flowing=!r.readableListening,SLe(this,r)),r.paused=!1,this};function SLe(r,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(ALe,r,e))}function ALe(r,e){vt("resume",e.reading),e.reading||r.read(0),e.resumeScheduled=!1,r.emit("resume"),eI(r),e.flowing&&!e.reading&&r.read(0)}Gt.prototype.pause=function(){return vt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(vt("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function eI(r){var e=r._readableState;for(vt("flow",e.flowing);e.flowing&&r.read()!==null;);}Gt.prototype.wrap=function(r){var e=this,t=this._readableState,i=!1;r.on("end",function(){if(vt("wrapped end"),t.decoder&&!t.ended){var o=t.decoder.end();o&&o.length&&e.push(o)}e.push(null)}),r.on("data",function(o){if(vt("wrapped data"),t.decoder&&(o=t.decoder.write(o)),!(t.objectMode&&o==null)&&!(!t.objectMode&&(!o||!o.length))){var a=e.push(o);a||(i=!0,r.pause())}});for(var n in r)this[n]===void 0&&typeof r[n]=="function"&&(this[n]=function(a){return function(){return r[a].apply(r,arguments)}}(n));for(var s=0;s<Qx.length;s++)r.on(Qx[s],this.emit.bind(this,Qx[s]));return this._read=function(o){vt("wrapped _read",o),i&&(i=!1,r.resume())},this};typeof Symbol=="function"&&(Gt.prototype[Symbol.asyncIterator]=function(){return Yx===void 0&&(Yx=Ete()),Yx(this)});Object.defineProperty(Gt.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(Gt.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Gt.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});Gt._fromList=kte;Object.defineProperty(Gt.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function kte(r,e){if(e.length===0)return null;var t;return e.objectMode?t=e.buffer.shift():!r||r>=e.length?(e.decoder?t=e.buffer.join(""):e.buffer.length===1?t=e.buffer.first():t=e.buffer.concat(e.length),e.buffer.clear()):t=e.buffer.consume(r,e.decoder),t}function tI(r){var e=r._readableState;vt("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(RLe,e,r))}function RLe(r,e){if(vt("endReadableNT",r.endEmitted,r.length),!r.endEmitted&&r.length===0&&(r.endEmitted=!0,e.readable=!1,e.emit("end"),r.autoDestroy)){var t=e._writableState;(!t||t.autoDestroy&&t.finished)&&e.destroy()}}typeof Symbol=="function"&&(Gt.from=function(r,e){return Xx===void 0&&(Xx=Ate()),Xx(Gt,r,e)});function Dte(r,e){for(var t=0,i=r.length;t<i;t++)if(r[t]===e)return t;return-1}});var rI=m((s8t,Lte)=>{l();"use strict";Lte.exports=mu;var tw=Wd().codes,xLe=tw.ERR_METHOD_NOT_IMPLEMENTED,ILe=tw.ERR_MULTIPLE_CALLBACK,TLe=tw.ERR_TRANSFORM_ALREADY_TRANSFORMING,PLe=tw.ERR_TRANSFORM_WITH_LENGTH_0,rw=Yd();xs()(mu,rw);function CLe(r,e){var t=this._transformState;t.transforming=!1;var i=t.writecb;if(i===null)return this.emit("error",new ILe);t.writechunk=null,t.writecb=null,e!=null&&this.push(e),i(r);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function mu(r){if(!(this instanceof mu))return new mu(r);rw.call(this,r),this._transformState={afterTransform:CLe.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&(typeof r.transform=="function"&&(this._transform=r.transform),typeof r.flush=="function"&&(this._flush=r.flush)),this.on("prefinish",OLe)}function OLe(){var r=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,t){Bte(r,e,t)}):Bte(this,null,null)}mu.prototype.push=function(r,e){return this._transformState.needTransform=!1,rw.prototype.push.call(this,r,e)};mu.prototype._transform=function(r,e,t){t(new xLe("_transform()"))};mu.prototype._write=function(r,e,t){var i=this._transformState;if(i.writecb=t,i.writechunk=r,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};mu.prototype._read=function(r){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};mu.prototype._destroy=function(r,e){rw.prototype._destroy.call(this,r,function(t){e(t)})};function Bte(r,e,t){if(e)return r.emit("error",e);if(t!=null&&r.push(t),r._writableState.length)throw new PLe;if(r._transformState.transforming)throw new TLe;return r.push(null)}});var qte=m((o8t,jte)=>{l();"use strict";jte.exports=Xg;var Mte=rI();xs()(Xg,Mte);function Xg(r){if(!(this instanceof Xg))return new Xg(r);Mte.call(this,r)}Xg.prototype._transform=function(r,e,t){t(null,r)}});var zte=m((a8t,Vte)=>{l();"use strict";var iI;function kLe(r){var e=!1;return function(){e||(e=!0,r.apply(void 0,arguments))}}var Ute=Wd().codes,DLe=Ute.ERR_MISSING_ARGS,NLe=Ute.ERR_STREAM_DESTROYED;function Fte(r){if(r)throw r}function BLe(r){return r.setHeader&&typeof r.abort=="function"}function LLe(r,e,t,i){i=kLe(i);var n=!1;r.on("close",function(){n=!0}),iI===void 0&&(iI=Y5()),iI(r,{readable:e,writable:t},function(o){if(o)return i(o);n=!0,i()});var s=!1;return function(o){if(!n&&!s){if(s=!0,BLe(r))return r.abort();if(typeof r.destroy=="function")return r.destroy();i(o||new NLe("pipe"))}}}function Kte(r){r()}function MLe(r,e){return r.pipe(e)}function jLe(r){return!r.length||typeof r[r.length-1]!="function"?Fte:r.pop()}function qLe(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var i=jLe(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new DLe("streams");var n,s=e.map(function(o,a){var c=a<e.length-1,u=a>0;return LLe(o,c,u,function(f){n||(n=f),f&&s.forEach(Kte),!c&&(s.forEach(Kte),i(n))})});return e.reduce(MLe)}Vte.exports=qLe});var nI=m((yo,Hte)=>{l();yo=Hte.exports=Ux();yo.Stream=yo;yo.Readable=yo;yo.Writable=Mx();yo.Duplex=Yd();yo.Transform=rI();yo.PassThrough=qte();yo.finished=Y5();yo.pipeline=zte()});var Wte=m((c8t,Gte)=>{l();"use strict";var ULe=xs(),{Readable:$te}=nI();Gte.exports=J0;ULe(J0,$te);function J0(r,e){if(!(this instanceof J0))return new J0(r,e);e=e||{},$te.call(this,Object.assign({},e,{objectMode:!0})),this._iterator=r,this._options=e,this.on("end",this.destroy.bind(this,null,null))}J0.prototype._read=function(){this.destroyed||this._iterator.next((r,e,t)=>{if(!this.destroyed){if(r)return this.destroy(r);e===void 0&&t===void 0?this.push(null):this._options.keys!==!1&&this._options.values===!1?this.push(e):this._options.keys===!1&&this._options.values!==!1?this.push(t):this.push({key:e,value:t})}})};J0.prototype._destroy=function(r,e){this._iterator.end(function(t){e(r||t)})}});var nw=m((u8t,iw)=>{l();"use strict";function eh(r,e){let t=function(i,n){if(typeof i=="object"&&i!==null&&(n=n||i,i=i.message||i.name),i=i||"",n=n||void 0,typeof n=="object"&&n.type===r&&n.message===i)return n;Object.defineProperty(this,"type",{value:r,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"name",{value:r,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"cause",{value:n,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"message",{value:i,enumerable:!1,writable:!0,configurable:!0}),Error.call(this),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,t)};return t.prototype=new e,t}var th=eh("LevelUPError",Error);iw.exports={LevelUPError:th,InitializationError:eh("InitializationError",th),OpenError:eh("OpenError",th),ReadError:eh("ReadError",th),WriteError:eh("WriteError",th),NotFoundError:eh("NotFoundError",th),EncodingError:eh("EncodingError",th)};iw.exports.NotFoundError.prototype.notFound=!0;iw.exports.NotFoundError.prototype.status=404});var Qg=m(sI=>{l();"use strict";sI.getCallback=function(r,e){return typeof r=="function"?r:e};sI.getOptions=function(r){return typeof r=="object"&&r!==null?r:{}}});var Xte=m((f8t,Yte)=>{l();"use strict";var Zg=nw().WriteError,FLe=j5(),KLe=Qg().getCallback,VLe=Qg().getOptions;function Jg(r){this.db=r,this.batch=r.db.batch(),this.ops=[],this.length=0}Jg.prototype.put=function(r,e,t){try{this.batch.put(r,e,t)}catch(i){throw new Zg(i)}return this.ops.push({...t,type:"put",key:r,value:e}),this.length++,this};Jg.prototype.del=function(r,e){try{this.batch.del(r,e)}catch(t){throw new Zg(t)}return this.ops.push({...e,type:"del",key:r}),this.length++,this};Jg.prototype.clear=function(){try{this.batch.clear()}catch(r){throw new Zg(r)}return this.ops=[],this.length=0,this};Jg.prototype.write=function(r,e){let t=this.db,i=this.ops;e=KLe(r,e),e=FLe.fromCallback(e),r=VLe(r);try{this.batch.write(r,function(n){if(n)return e(new Zg(n));t.emit("batch",i),e()})}catch(n){throw new Zg(n)}return e.promise};Yte.exports=Jg});var Jte=m((d8t,Zte)=>{l();"use strict";var Qte=Kg();Zte.exports=function(r,...e){e.length===0?Qte(r):Qte(()=>r(...e))}});var rre=m((h8t,tre)=>{l();"use strict";var sw=Ut().EventEmitter,zLe=gee().inherits,HLe=$ee(),$Le=Wte(),GLe=Xte(),e1=nw(),WLe=_x(),rh=j5(),em=Qg().getCallback,t1=Qg().getOptions,tm=Jte(),ow=e1.WriteError,ere=e1.ReadError,YLe=e1.NotFoundError,XLe=e1.OpenError,QLe=e1.InitializationError;function rr(r,e,t){if(!(this instanceof rr))return new rr(r,e,t);let i;if(sw.call(this),this.setMaxListeners(1/0),typeof e=="function"&&(t=e,e={}),e=e||{},!r||typeof r!="object"){if(i=new QLe("First argument must be an abstract-leveldown compliant store"),typeof t=="function")return tm(t,i);throw i}if(typeof r.status!="string")throw new Error(".status required, old abstract-leveldown");this.options=t1(e),this._db=r,this.db=null,this.open(t||(n=>{n&&this.emit("error",n)})),this.supports=WLe(this.db.supports,{status:!0,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0});for(let n of Object.keys(this.supports.additionalMethods))this[n]==null&&(this[n]=function(...s){return this.db[n](...s)})}rr.prototype.emit=sw.prototype.emit;rr.prototype.once=sw.prototype.once;zLe(rr,sw);Object.defineProperty(rr.prototype,"status",{enumerable:!0,get(){return this.db.status}});rr.prototype.isOperational=function(){return this.db.status==="open"||this.db.status==="opening"};rr.prototype.open=function(r,e){return typeof r=="function"&&(e=r,r=null),e=rh.fromCallback(e),r||(r=this.options),this.db&&this.isOpen()?(tm(e,null,this),e.promise):this.db&&this._isOpening()?(this.once("open",()=>{e(null,this)}),e.promise):(this.db=new HLe(this._db),this.emit("opening"),this.db.open(r,t=>{if(t)return e(new XLe(t));this.db=this._db,e(null,this),this.emit("open"),this.emit("ready")}),e.promise)};rr.prototype.close=function(r){return r=rh.fromCallback(r),this.isOpen()?(this.db.close((e,...t)=>{this.emit("closed"),r(e,...t)}),this.emit("closing")):this.isClosed()?tm(r):this.db.status==="closing"?this.once("closed",r):this._isOpening()&&this.once("open",()=>{this.close(r)}),r.promise};rr.prototype.isOpen=function(){return this.db.status==="open"};rr.prototype._isOpening=function(){return this.db.status==="opening"};rr.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)};rr.prototype.get=function(r,e,t){return t=em(e,t),t=rh.fromCallback(t),rm(this,t)||(e=t1(e),this.db.get(r,e,function(i,n){if(i)return/notfound/i.test(i)||i.notFound?i=new YLe("Key not found in database ["+r+"]",i):i=new ere(i),t(i);t(null,n)})),t.promise};rr.prototype.getMany=function(r,e,t){return this.db.getMany(r,e,t)};rr.prototype.put=function(r,e,t,i){return i=em(t,i),i=rh.fromCallback(i),rm(this,i)||(t=t1(t),this.db.put(r,e,t,n=>{if(n)return i(new ow(n));this.emit("put",r,e),i()})),i.promise};rr.prototype.del=function(r,e,t){return t=em(e,t),t=rh.fromCallback(t),rm(this,t)||(e=t1(e),this.db.del(r,e,i=>{if(i)return t(new ow(i));this.emit("del",r),t()})),t.promise};rr.prototype.batch=function(r,e,t){return arguments.length?(typeof r=="function"?t=r:t=em(e,t),t=rh.fromCallback(t),rm(this,t)||(e=t1(e),this.db.batch(r,e,i=>{if(i)return t(new ow(i));this.emit("batch",r),t()})),t.promise):new GLe(this)};rr.prototype.iterator=function(r){return this.db.iterator(r)};rr.prototype.clear=function(r,e){return e=em(r,e),r=t1(r),e=rh.fromCallback(e),rm(this,e)||this.db.clear(r,t=>{if(t)return e(new ow(t));this.emit("clear",r),e()}),e.promise};rr.prototype.readStream=rr.prototype.createReadStream=function(r){return r=Object.assign({keys:!0,values:!0},r),typeof r.limit!="number"&&(r.limit=-1),new $Le(this.db.iterator(r),r)};rr.prototype.keyStream=rr.prototype.createKeyStream=function(r){return this.createReadStream(Object.assign({},r,{keys:!0,values:!1}))};rr.prototype.valueStream=rr.prototype.createValueStream=function(r){return this.createReadStream(Object.assign({},r,{keys:!1,values:!0}))};rr.prototype.toString=function(){return"LevelUP"};rr.prototype.type="levelup";rr.prototype._nextTick=tm;function rm(r,e){return r.isOperational()?!1:(tm(e,new ere("Database is not open")),!0)}rr.errors=e1;tre.exports=rr});var ire=m(bu=>{l();"use strict";var{Buffer:oI}=ci();bu.utf8=bu["utf-8"]={encode:function(r){return aI(r)?r:String(r)},decode:aw,buffer:!1,type:"utf8"};bu.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"};bu.binary={encode:function(r){return aI(r)?r:oI.from(r)},decode:aw,buffer:!0,type:"binary"};bu.none={encode:aw,decode:aw,buffer:!1,type:"id"};bu.id=bu.none;var ZLe=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];for(let r of ZLe)bu[r]={encode:function(e){return aI(e)?e:oI.from(e,r)},decode:function(e){return e.toString(r)},buffer:!0,type:r};function aw(r){return r}function aI(r){return r==null||oI.isBuffer(r)}});var sre=m((y8t,nre)=>{l();"use strict";var cI=ire(),JLe=new Set(["lt","gt","lte","gte"]);nre.exports=qn;function qn(r){if(!(this instanceof qn))return new qn(r);this.opts=r||{},this.encodings=cI}qn.prototype._encoding=function(r){return typeof r=="string"&&(r=cI[r]),r||(r=cI.id),r};qn.prototype._keyEncoding=function(r,e){return this._encoding(e&&e.keyEncoding||r&&r.keyEncoding||this.opts.keyEncoding)};qn.prototype._valueEncoding=function(r,e){return this._encoding(e&&(e.valueEncoding||e.encoding)||r&&(r.valueEncoding||r.encoding)||this.opts.valueEncoding||this.opts.encoding)};qn.prototype.encodeKey=function(r,e,t){return this._keyEncoding(e,t).encode(r)};qn.prototype.encodeValue=function(r,e,t){return this._valueEncoding(e,t).encode(r)};qn.prototype.decodeKey=function(r,e){return this._keyEncoding(e).decode(r)};qn.prototype.decodeValue=function(r,e){return this._valueEncoding(e).decode(r)};qn.prototype.encodeBatch=function(r,e){return r.map(t=>{let i={type:t.type,key:this.encodeKey(t.key,e,t)};return this.keyAsBuffer(e,t)&&(i.keyEncoding="binary"),t.prefix&&(i.prefix=t.prefix),"value"in t&&(i.value=this.encodeValue(t.value,e,t),this.valueAsBuffer(e,t)&&(i.valueEncoding="binary")),i})};qn.prototype.encodeLtgt=function(r){let e={};for(let t of Object.keys(r)){if(t==="start"||t==="end")throw new Error('Legacy range options ("start" and "end") have been removed');e[t]=JLe.has(t)?this.encodeKey(r[t],r):r[t]}return e};qn.prototype.createStreamDecoder=function(r){return r.keys&&r.values?(e,t)=>({key:this.decodeKey(e,r),value:this.decodeValue(t,r)}):r.keys?e=>this.decodeKey(e,r):r.values?(e,t)=>this.decodeValue(t,r):function(){}};qn.prototype.keyAsBuffer=function(r){return this._keyEncoding(r).buffer};qn.prototype.valueAsBuffer=function(r){return this._valueEncoding(r).buffer}});var lre=m((g8t,ure)=>{l();"use strict";var ore=gu().AbstractLevelDOWN,are=gu().AbstractChainedBatch,cre=gu().AbstractIterator,uI=xs(),eMe=sre(),lI=nw().EncodingError,tMe=["approximateSize","compactRange"];ure.exports=un;function un(r,e){if(!(this instanceof un))return new un(r,e);let t=r.supports||{},i=t.additionalMethods||{};ore.call(this,t),this.supports.encodings=!0,this.supports.additionalMethods={},tMe.forEach(function(n){let s=typeof r[n]=="function";(i[n]||s)&&(this.supports.additionalMethods[n]=!0,this[n]=function(o,a,c,u){return o=this.codec.encodeKey(o,c),a=this.codec.encodeKey(a,c),this.db[n](o,a,c,u)})},this),e=e||{},typeof e.keyEncoding=="undefined"&&(e.keyEncoding="utf8"),typeof e.valueEncoding=="undefined"&&(e.valueEncoding="utf8"),this.db=r,this.codec=new eMe(e)}uI(un,ore);un.prototype.type="encoding-down";un.prototype._serializeKey=un.prototype._serializeValue=function(r){return r};un.prototype._open=function(r,e){this.db.open(r,e)};un.prototype._close=function(r){this.db.close(r)};un.prototype._put=function(r,e,t,i){r=this.codec.encodeKey(r,t),e=this.codec.encodeValue(e,t),this.db.put(r,e,t,i)};un.prototype._get=function(r,e,t){r=this.codec.encodeKey(r,e),e.asBuffer=this.codec.valueAsBuffer(e),this.db.get(r,e,(i,n)=>{if(i)return t(i);try{n=this.codec.decodeValue(n,e)}catch(s){return t(new lI(s))}t(null,n)})};un.prototype._getMany=function(r,e,t){r=r.map(i=>this.codec.encodeKey(i,e)),e.asBuffer=this.codec.valueAsBuffer(e),this.db.getMany(r,e,(i,n)=>{if(i)return t(i);let s=new Array(n.length);for(let o=0;o<n.length;o++){if(n[o]===void 0){s[o]=void 0;continue}try{s[o]=this.codec.decodeValue(n[o],e)}catch(a){return t(new lI(a))}}t(null,s)})};un.prototype._del=function(r,e,t){r=this.codec.encodeKey(r,e),this.db.del(r,e,t)};un.prototype._chainedBatch=function(){return new r1(this)};un.prototype._batch=function(r,e,t){r=this.codec.encodeBatch(r,e),this.db.batch(r,e,t)};un.prototype._iterator=function(r){return r.keyAsBuffer=this.codec.keyAsBuffer(r),r.valueAsBuffer=this.codec.valueAsBuffer(r),new im(this,r)};un.prototype._clear=function(r,e){r=this.codec.encodeLtgt(r),this.db.clear(r,e)};function im(r,e){cre.call(this,r),this.codec=r.codec,this.keys=e.keys,this.values=e.values,this.opts=this.codec.encodeLtgt(e),this.it=r.db.iterator(this.opts)}uI(im,cre);im.prototype._next=function(r){this.it.next((e,t,i)=>{if(e)return r(e);try{this.keys&&typeof t!="undefined"?t=this.codec.decodeKey(t,this.opts):t=void 0,this.values&&typeof i!="undefined"?i=this.codec.decodeValue(i,this.opts):i=void 0}catch(n){return r(new lI(n))}r(null,t,i)})};im.prototype._seek=function(r){r=this.codec.encodeKey(r,this.opts),this.it.seek(r)};im.prototype._end=function(r){this.it.end(r)};function r1(r,e){are.call(this,r),this.codec=r.codec,this.batch=r.db.batch()}uI(r1,are);r1.prototype._put=function(r,e,t){r=this.codec.encodeKey(r,t),e=this.codec.encodeValue(e,t),this.batch.put(r,e)};r1.prototype._del=function(r,e){r=this.codec.encodeKey(r,e),this.batch.del(r)};r1.prototype._clear=function(){this.batch.clear()};r1.prototype._write=function(r,e){this.batch.write(r,e)}});var hre=m((m8t,dre)=>{l();"use strict";var fre=rre(),rMe=lre();function iMe(r){function e(i,n,s){return typeof i=="function"?s=i:typeof n=="function"&&(s=n),t(n)||(n=t(i)?i:{}),fre(rMe(r(i,n),n),n,s)}function t(i){return typeof i=="object"&&i!==null}for(let i of["destroy","repair"])typeof r[i]=="function"&&(e[i]=function(...n){r[i](...n)});return e.errors=fre.errors,e}dre.exports=iMe});var yre=m((b8t,pre)=>{l();pre.exports=sMe;var nMe=Kg();function sMe(r,e,t){if(typeof e!="number")throw new Error("second argument must be a Number");let i,n,s,o,a,c=!0,u;Array.isArray(r)?(i=[],s=n=r.length):(o=Object.keys(r),i={},s=n=o.length);function f(h){function p(){t&&t(h,i),t=null}c?nMe(p):p()}function d(h,p,y){if(i[h]=y,p&&(a=!0),--s==0||p)f(p);else if(!a&&u<n){let g;o?(g=o[u],u+=1,r[g](function(w,b){d(g,w,b)})):(g=u,u+=1,r[g](function(w,b){d(g,w,b)}))}}u=e,s?o?o.some(function(h,p){return r[h](function(y,g){d(h,y,g)}),p===e-1}):r.some(function(h,p){return h(function(y,g){d(p,y,g)}),p===e-1}):f(null),c=!1}});var mre=m(mi=>{l();mi.compare=function(r,e){if(Buffer.isBuffer(r)){for(var t=Math.min(r.length,e.length),i=0;i<t;i++){var n=r[i]-e[i];if(n)return n}return r.length-e.length}return r<e?-1:r>e?1:0};function gre(r){return r!==void 0&&r!==""}function i1(r,e){return Object.hasOwnProperty.call(r,e)}function yc(r,e){return Object.hasOwnProperty.call(r,e)&&e}var oMe=mi.lowerBoundKey=function(r){return yc(r,"gt")||yc(r,"gte")||yc(r,"min")||(r.reverse?yc(r,"end"):yc(r,"start"))||void 0},fI=mi.lowerBound=function(r,e){var t=oMe(r);return t?r[t]:e},dI=mi.lowerBoundInclusive=function(r){return!i1(r,"gt")},hI=mi.upperBoundInclusive=function(r){return!i1(r,"lt")},aMe=mi.lowerBoundExclusive=function(r){return!dI(r)},cMe=mi.upperBoundExclusive=function(r){return!hI(r)},uMe=mi.upperBoundKey=function(r){return yc(r,"lt")||yc(r,"lte")||yc(r,"max")||(r.reverse?yc(r,"start"):yc(r,"end"))||void 0},pI=mi.upperBound=function(r,e){var t=uMe(r);return t?r[t]:e};mi.start=function(r,e){return r.reverse?pI(r,e):fI(r,e)};mi.end=function(r,e){return r.reverse?fI(r,e):pI(r,e)};mi.startInclusive=function(r){return r.reverse?hI(r):dI(r)};mi.endInclusive=function(r){return r.reverse?dI(r):hI(r)};function lMe(r){return r}mi.toLtgt=function(r,e,t,i,n){e=e||{},t=t||lMe;var s=arguments.length>3,o=mi.lowerBoundKey(r),a=mi.upperBoundKey(r);return o?o==="gt"?e.gt=t(r.gt,!1):e.gte=t(r[o],!1):s&&(e.gte=t(i,!1)),a?a==="lt"?e.lt=t(r.lt,!0):e.lte=t(r[a],!0):s&&(e.lte=t(n,!0)),r.reverse!=null&&(e.reverse=!!r.reverse),i1(e,"max")&&delete e.max,i1(e,"min")&&delete e.min,i1(e,"start")&&delete e.start,i1(e,"end")&&delete e.end,e};mi.contains=function(r,e,t){t=t||mi.compare;var i=fI(r);if(gre(i)){var n=t(e,i);if(n<0||n===0&&aMe(r))return!1}var s=pI(r);if(gre(s)){var n=t(e,s);if(n>0||n===0&&cMe(r))return!1}return!0};mi.filter=function(r,e){return function(t){return mi.contains(r,t,e)}}});var yI=m((_8t,bre)=>{l();"use strict";var cw=mre(),Ql=Symbol("none");bre.exports=function(e){let t=cw.lowerBound(e,Ql),i=cw.upperBound(e,Ql),n=cw.lowerBoundExclusive(e,Ql),s=cw.upperBoundExclusive(e,Ql);return t!==Ql&&i!==Ql?IDBKeyRange.bound(t,i,n,s):t!==Ql?IDBKeyRange.lowerBound(t,n):i!==Ql?IDBKeyRange.upperBound(i,s):null}});var gI=m((v8t,_re)=>{l();"use strict";var uw=ci().Buffer,fMe=function(){if(globalThis.TextDecoder){let r=new TextDecoder("utf-8");return r.decode.bind(r)}else return function(e){return wre(e).toString()}}(),dMe=function(){if(globalThis.TextDecoder){let r=new TextDecoder("utf-8");return r.decode.bind(r)}else return function(e){return uw.from(e).toString()}}();function wre(r){let e=uw.from(r.buffer);return r.byteLength===r.buffer.byteLength?e:e.slice(r.byteOffset,r.byteOffset+r.byteLength)}_re.exports=function(r,e){return r instanceof Uint8Array?e?wre(r):fMe(r):r instanceof ArrayBuffer?e?uw.from(r):dMe(r):e?uw.from(String(r)):String(r)}});var Are=m((E8t,Sre)=>{l();"use strict";var hMe=xs(),vre=gu().AbstractIterator,pMe=yI(),Ere=gI(),yMe=function(){};Sre.exports=la;function la(r,e,t){if(vre.call(this,r),this._limit=t.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keys=t.keys,this._values=t.values,this._keyAsBuffer=t.keyAsBuffer,this._valueAsBuffer=t.valueAsBuffer,this._limit===0){this._completed=!0;return}let i;try{i=pMe(t)}catch(n){this._completed=!0;return}this.createIterator(e,i,t.reverse)}hMe(la,vre);la.prototype.createIterator=function(r,e,t){let i=this.db.db.transaction([r],"readonly"),s=i.objectStore(r).openCursor(e,t?"prev":"next");s.onsuccess=o=>{let a=o.target.result;a&&this.onItem(a)},this._transaction=i,i.onabort=()=>{this.onAbort(this._transaction.error||new Error("aborted by user"))},i.oncomplete=()=>{this.onComplete()}};la.prototype.onItem=function(r){this._cache.push(r.key,r.value),(this._limit<=0||++this._count<this._limit)&&r.continue(),this.maybeNext()};la.prototype.onAbort=function(r){this._aborted=!0,this._error=r,this.maybeNext()};la.prototype.onComplete=function(){this._completed=!0,this.maybeNext()};la.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)};la.prototype._next=function(r){if(this._aborted){let e=this._error;this._error=null,this._nextTick(r,e)}else if(this._cache.length>0){let e=this._cache.shift(),t=this._cache.shift();this._keys&&e!==void 0?e=this._deserializeKey(e,this._keyAsBuffer):e=void 0,this._values&&t!==void 0?t=this._deserializeValue(t,this._valueAsBuffer):t=void 0,this._nextTick(r,null,e,t)}else this._completed?this._nextTick(r):this._callback=r};la.prototype._deserializeKey=Ere;la.prototype._deserializeValue=Ere;la.prototype._end=function(r){if(this._aborted||this._completed)return this._nextTick(r,this._error);this.onItem=yMe,this.onAbort=r,this.onComplete=r}});var Ire=m((S8t,xre)=>{l();"use strict";var Rre=ci().Buffer,gMe=function(){if(globalThis.TextEncoder){let r=new TextEncoder("utf-8");return r.encode.bind(r)}else return Rre.from}();xre.exports=function(r,e){return e?Rre.isBuffer(r)?r:gMe(String(r)):String(r)}});var Tre=m(lw=>{l();"use strict";var mMe=ci().Buffer;lw.test=function(r){return function(t){try{return t.cmp(r,0),!0}catch(i){return!1}}};lw.bufferKeys=lw.test(mMe.alloc(0))});var Cre=m((R8t,Pre)=>{l();"use strict";Pre.exports=function(e,t,i,n,s){if(n.limit===0)return e._nextTick(s);let o=e.db.transaction([t],"readwrite"),a=o.objectStore(t),c=0;o.oncomplete=function(){s()},o.onabort=function(){s(o.error||new Error("aborted by user"))};let u=a.openKeyCursor?"openKeyCursor":"openCursor",f=n.reverse?"prev":"next";a[u](i,f).onsuccess=function(d){let h=d.target.result;h&&(a.delete(h.key).onsuccess=function(){(n.limit<=0||++c<n.limit)&&h.continue()})}}});var Bre=m((x8t,Nre)=>{l();"use strict";Nre.exports=Ti;var Ore=gu().AbstractLevelDOWN,bMe=xs(),wMe=yre(),_Me=Are(),kre=Ire(),fw=gI(),vMe=Tre(),EMe=Cre(),SMe=yI(),Dre="level-js-";function Ti(r,e){if(!(this instanceof Ti))return new Ti(r,e);if(Ore.call(this,{bufferKeys:vMe.bufferKeys(indexedDB),snapshots:!0,permanence:!0,clear:!0,getMany:!0}),e=e||{},typeof r!="string")throw new Error("constructor requires a location string argument");this.location=r,this.prefix=e.prefix==null?Dre:e.prefix,this.version=parseInt(e.version||1,10)}bMe(Ti,Ore);Ti.prototype.type="level-js";Ti.prototype._open=function(r,e){let t=indexedDB.open(this.prefix+this.location,this.version);t.onerror=function(){e(t.error||new Error("unknown error"))},t.onsuccess=()=>{this.db=t.result,e()},t.onupgradeneeded=i=>{let n=i.target.result;n.objectStoreNames.contains(this.location)||n.createObjectStore(this.location)}};Ti.prototype.store=function(r){return this.db.transaction([this.location],r).objectStore(this.location)};Ti.prototype.await=function(r,e){let t=r.transaction;t.onabort=function(){e(t.error||new Error("aborted by user"))},t.oncomplete=function(){e(null,r.result)}};Ti.prototype._get=function(r,e,t){let i=this.store("readonly"),n;try{n=i.get(r)}catch(s){return this._nextTick(t,s)}this.await(n,function(s,o){if(s)return t(s);if(o===void 0)return t(new Error("NotFound"));t(null,fw(o,e.asBuffer))})};Ti.prototype._getMany=function(r,e,t){let i=e.asBuffer,n=this.store("readonly"),s=r.map(o=>a=>{let c;try{c=n.get(o)}catch(u){return a(u)}c.onsuccess=()=>{let u=c.result;a(null,u===void 0?u:fw(u,i))},c.onerror=u=>{u.stopPropagation(),a(c.error)}});wMe(s,16,t)};Ti.prototype._del=function(r,e,t){let i=this.store("readwrite"),n;try{n=i.delete(r)}catch(s){return this._nextTick(t,s)}this.await(n,t)};Ti.prototype._put=function(r,e,t,i){let n=this.store("readwrite"),s;try{s=n.put(e,r)}catch(o){return this._nextTick(i,o)}this.await(s,i)};Ti.prototype._serializeKey=function(r){return kre(r,this.supports.bufferKeys)};Ti.prototype._serializeValue=function(r){return kre(r,!0)};Ti.prototype._iterator=function(r){return new _Me(this,this.location,r)};Ti.prototype._batch=function(r,e,t){if(r.length===0)return this._nextTick(t);let i=this.store("readwrite"),n=i.transaction,s=0,o;n.onabort=function(){t(o||n.error||new Error("aborted by user"))},n.oncomplete=function(){t()};function a(){let c=r[s++],u=c.key,f;try{f=c.type==="del"?i.delete(u):i.put(c.value,u)}catch(d){o=d,n.abort();return}s<r.length&&(f.onsuccess=a)}a()};Ti.prototype._clear=function(r,e){let t,i;try{t=SMe(r)}catch(n){return this._nextTick(e)}if(r.limit>=0)return EMe(this,this.location,t,r,e);try{let n=this.store("readwrite");i=t?n.delete(t):n.clear()}catch(n){return this._nextTick(e,n)}this.await(i,e)};Ti.prototype._close=function(r){this.db.close(),this._nextTick(r)};Ti.prototype.upgrade=function(r){if(this.status!=="open")return this._nextTick(r,new Error("cannot upgrade() before open()"));let e=this.iterator(),t={},i=this;e._deserializeKey=e._deserializeValue=a,n();function n(c){if(c)return o(c);e.next(s)}function s(c,u,f){if(c||u===void 0)return o(c);let d=i._serializeKey(fw(u,!0)),h=i._serializeValue(fw(f,!0));i._batch([{type:"del",key:u},{type:"put",key:d,value:h}],t,n)}function o(c){e.end(function(u){r(c||u)})}function a(c){return c}};Ti.destroy=function(r,e,t){typeof e=="function"&&(t=e,e=Dre);let i=indexedDB.deleteDatabase(e+r);i.onsuccess=function(){t()},i.onerror=function(n){t(n)}}});var Mre=m((I8t,Lre)=>{l();Lre.exports=hre()(Bre())});var Kre=m((O8t,Fre)=>{l();"use strict";function Ure(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function RMe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Ure(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Ure(new n,t)}}Fre.exports=RMe});var RI=m(($8t,Wre)=>{l();"use strict";function Gre(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function TMe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Gre(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Gre(new n,t)}}Wre.exports=TMe});var xI=m((G8t,Zre)=>{l();"use strict";var Yre=()=>{},Xre=Symbol.for("@libp2p/js-interfaces/topology"),Qre=class{constructor({min:e=0,max:t=1/0,handlers:i={}}){this.min=e,this.max=t,this._onConnect=i.onConnect||Yre,this._onDisconnect=i.onDisconnect||Yre,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[Xre](){return!0}static isTopology(e){return Boolean(e&&e[Xre])}async setRegistrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};Zre.exports=Qre});var dw=m((W8t,iie)=>{l();"use strict";var PMe=xI(),Jre=Symbol.for("@libp2p/js-interfaces/topology/multicodec-topology"),eie=le(),tie=Object.assign(eie("libp2p:topology:multicodec-topology"),{error:eie("libp2p:topology:multicodec-topology:error")}),rie=class extends PMe{constructor({min:e,max:t,multicodecs:i,handlers:n}){super({min:e,max:t,handlers:n});if(!i)throw new Error("one or more multicodec should be provided");if(!n)throw new Error("the handlers should be provided");if(typeof n.onConnect!="function")throw new Error("the 'onConnect' handler must be provided");if(typeof n.onDisconnect!="function")throw new Error("the 'onDisconnect' handler must be provided");this.multicodecs=Array.isArray(i)?i:[i],this._registrar=void 0,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerConnect=this._onPeerConnect.bind(this)}get[Symbol.toStringTag](){return"Topology"}get[Jre](){return!0}static isMulticodecTopology(e){return Boolean(e&&e[Jre])}async setRegistrar(e){this._registrar=e,this._registrar.peerStore.on("change:protocols",this._onProtocolChange),this._registrar.connectionManager.on("peer:connect",this._onPeerConnect),await this._updatePeers(this._registrar.peerStore.getPeers())}async _updatePeers(e){for await(let{id:t,protocols:i}of e)if(this.multicodecs.filter(n=>i.includes(n)).length){this.peers.add(t.toB58String());let n=this._registrar.getConnection(t);n&&this._onConnect(t,n)}else this.peers.delete(t.toB58String())}async _onProtocolChange({peerId:e,protocols:t}){try{let i=this.peers.has(e.toB58String()),n=t.filter(s=>this.multicodecs.includes(s));i&&n.length===0&&this._onDisconnect(e);for(let s of t)if(this.multicodecs.includes(s)){let o=await this._registrar.peerStore.get(e);await this._updatePeers([o]);return}}catch(i){tie.error(i)}}async _onPeerConnect(e){try{let t=e.remotePeer,i=await this._registrar.peerStore.protoBook.get(t);if(!i)return;this.multicodecs.find(n=>i.includes(n))&&(this.peers.add(t.toB58String()),this._onConnect(t,e))}catch(t){tie.error(t)}}};iie.exports=rie});var hw=m(nie=>{l();"use strict";nie.codes={ERR_INVALID_SIGNATURE_POLICY:"ERR_INVALID_SIGNATURE_POLICY",ERR_UNHANDLED_SIGNATURE_POLICY:"ERR_UNHANDLED_SIGNATURE_POLICY",ERR_MISSING_SIGNATURE:"ERR_MISSING_SIGNATURE",ERR_MISSING_SEQNO:"ERR_MISSING_SEQNO",ERR_INVALID_SIGNATURE:"ERR_INVALID_SIGNATURE",ERR_UNEXPECTED_FROM:"ERR_UNEXPECTED_FROM",ERR_UNEXPECTED_SIGNATURE:"ERR_UNEXPECTED_SIGNATURE",ERR_UNEXPECTED_KEY:"ERR_UNEXPECTED_KEY",ERR_UNEXPECTED_SEQNO:"ERR_UNEXPECTED_SEQNO"}});var TI=m((X8t,sie)=>{l();"use strict";var Jl=Br(),s1=Jl.Reader,II=Jl.Writer,Tt=Jl.util,Ui=Jl.roots["libp2p-pubsub-rpc"]||(Jl.roots["libp2p-pubsub-rpc"]={});Ui.RPC=function(){function r(e){if(this.subscriptions=[],this.msgs=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.subscriptions=Tt.emptyArray,r.prototype.msgs=Tt.emptyArray,r.encode=function(t,i){if(i||(i=II.create()),t.subscriptions!=null&&t.subscriptions.length)for(var n=0;n<t.subscriptions.length;++n)Ui.RPC.SubOpts.encode(t.subscriptions[n],i.uint32(10).fork()).ldelim();if(t.msgs!=null&&t.msgs.length)for(var n=0;n<t.msgs.length;++n)Ui.RPC.Message.encode(t.msgs[n],i.uint32(18).fork()).ldelim();return i},r.decode=function(t,i){t instanceof s1||(t=s1.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Ui.RPC;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.subscriptions&&s.subscriptions.length||(s.subscriptions=[]),s.subscriptions.push(Ui.RPC.SubOpts.decode(t,t.uint32()));break;case 2:s.msgs&&s.msgs.length||(s.msgs=[]),s.msgs.push(Ui.RPC.Message.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Ui.RPC)return t;var i=new Ui.RPC;if(t.subscriptions){if(!Array.isArray(t.subscriptions))throw TypeError(".RPC.subscriptions: array expected");i.subscriptions=[];for(var n=0;n<t.subscriptions.length;++n){if(typeof t.subscriptions[n]!="object")throw TypeError(".RPC.subscriptions: object expected");i.subscriptions[n]=Ui.RPC.SubOpts.fromObject(t.subscriptions[n])}}if(t.msgs){if(!Array.isArray(t.msgs))throw TypeError(".RPC.msgs: array expected");i.msgs=[];for(var n=0;n<t.msgs.length;++n){if(typeof t.msgs[n]!="object")throw TypeError(".RPC.msgs: object expected");i.msgs[n]=Ui.RPC.Message.fromObject(t.msgs[n])}}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.subscriptions=[],n.msgs=[]),t.subscriptions&&t.subscriptions.length){n.subscriptions=[];for(var s=0;s<t.subscriptions.length;++s)n.subscriptions[s]=Ui.RPC.SubOpts.toObject(t.subscriptions[s],i)}if(t.msgs&&t.msgs.length){n.msgs=[];for(var s=0;s<t.msgs.length;++s)n.msgs[s]=Ui.RPC.Message.toObject(t.msgs[s],i)}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Jl.util.toJSONOptions)},r.SubOpts=function(){function e(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.subscribe=null,e.prototype.topicID=null;var t;return Object.defineProperty(e.prototype,"_subscribe",{get:Tt.oneOfGetter(t=["subscribe"]),set:Tt.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_topicID",{get:Tt.oneOfGetter(t=["topicID"]),set:Tt.oneOfSetter(t)}),e.encode=function(n,s){return s||(s=II.create()),n.subscribe!=null&&Object.hasOwnProperty.call(n,"subscribe")&&s.uint32(8).bool(n.subscribe),n.topicID!=null&&Object.hasOwnProperty.call(n,"topicID")&&s.uint32(18).string(n.topicID),s},e.decode=function(n,s){n instanceof s1||(n=s1.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new Ui.RPC.SubOpts;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.subscribe=n.bool();break;case 2:a.topicID=n.string();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof Ui.RPC.SubOpts)return n;var s=new Ui.RPC.SubOpts;return n.subscribe!=null&&(s.subscribe=Boolean(n.subscribe)),n.topicID!=null&&(s.topicID=String(n.topicID)),s},e.toObject=function(n,s){s||(s={});var o={};return n.subscribe!=null&&n.hasOwnProperty("subscribe")&&(o.subscribe=n.subscribe,s.oneofs&&(o._subscribe="subscribe")),n.topicID!=null&&n.hasOwnProperty("topicID")&&(o.topicID=n.topicID,s.oneofs&&(o._topicID="topicID")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,Jl.util.toJSONOptions)},e}(),r.Message=function(){function e(i){if(this.topicIDs=[],i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.from=null,e.prototype.data=null,e.prototype.seqno=null,e.prototype.topicIDs=Tt.emptyArray,e.prototype.signature=null,e.prototype.key=null;var t;return Object.defineProperty(e.prototype,"_from",{get:Tt.oneOfGetter(t=["from"]),set:Tt.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_data",{get:Tt.oneOfGetter(t=["data"]),set:Tt.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_seqno",{get:Tt.oneOfGetter(t=["seqno"]),set:Tt.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_signature",{get:Tt.oneOfGetter(t=["signature"]),set:Tt.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_key",{get:Tt.oneOfGetter(t=["key"]),set:Tt.oneOfSetter(t)}),e.encode=function(n,s){if(s||(s=II.create()),n.from!=null&&Object.hasOwnProperty.call(n,"from")&&s.uint32(10).bytes(n.from),n.data!=null&&Object.hasOwnProperty.call(n,"data")&&s.uint32(18).bytes(n.data),n.seqno!=null&&Object.hasOwnProperty.call(n,"seqno")&&s.uint32(26).bytes(n.seqno),n.topicIDs!=null&&n.topicIDs.length)for(var o=0;o<n.topicIDs.length;++o)s.uint32(34).string(n.topicIDs[o]);return n.signature!=null&&Object.hasOwnProperty.call(n,"signature")&&s.uint32(42).bytes(n.signature),n.key!=null&&Object.hasOwnProperty.call(n,"key")&&s.uint32(50).bytes(n.key),s},e.decode=function(n,s){n instanceof s1||(n=s1.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new Ui.RPC.Message;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.from=n.bytes();break;case 2:a.data=n.bytes();break;case 3:a.seqno=n.bytes();break;case 4:a.topicIDs&&a.topicIDs.length||(a.topicIDs=[]),a.topicIDs.push(n.string());break;case 5:a.signature=n.bytes();break;case 6:a.key=n.bytes();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof Ui.RPC.Message)return n;var s=new Ui.RPC.Message;if(n.from!=null&&(typeof n.from=="string"?Tt.base64.decode(n.from,s.from=Tt.newBuffer(Tt.base64.length(n.from)),0):n.from.length&&(s.from=n.from)),n.data!=null&&(typeof n.data=="string"?Tt.base64.decode(n.data,s.data=Tt.newBuffer(Tt.base64.length(n.data)),0):n.data.length&&(s.data=n.data)),n.seqno!=null&&(typeof n.seqno=="string"?Tt.base64.decode(n.seqno,s.seqno=Tt.newBuffer(Tt.base64.length(n.seqno)),0):n.seqno.length&&(s.seqno=n.seqno)),n.topicIDs){if(!Array.isArray(n.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");s.topicIDs=[];for(var o=0;o<n.topicIDs.length;++o)s.topicIDs[o]=String(n.topicIDs[o])}return n.signature!=null&&(typeof n.signature=="string"?Tt.base64.decode(n.signature,s.signature=Tt.newBuffer(Tt.base64.length(n.signature)),0):n.signature.length&&(s.signature=n.signature)),n.key!=null&&(typeof n.key=="string"?Tt.base64.decode(n.key,s.key=Tt.newBuffer(Tt.base64.length(n.key)),0):n.key.length&&(s.key=n.key)),s},e.toObject=function(n,s){s||(s={});var o={};if((s.arrays||s.defaults)&&(o.topicIDs=[]),n.from!=null&&n.hasOwnProperty("from")&&(o.from=s.bytes===String?Tt.base64.encode(n.from,0,n.from.length):s.bytes===Array?Array.prototype.slice.call(n.from):n.from,s.oneofs&&(o._from="from")),n.data!=null&&n.hasOwnProperty("data")&&(o.data=s.bytes===String?Tt.base64.encode(n.data,0,n.data.length):s.bytes===Array?Array.prototype.slice.call(n.data):n.data,s.oneofs&&(o._data="data")),n.seqno!=null&&n.hasOwnProperty("seqno")&&(o.seqno=s.bytes===String?Tt.base64.encode(n.seqno,0,n.seqno.length):s.bytes===Array?Array.prototype.slice.call(n.seqno):n.seqno,s.oneofs&&(o._seqno="seqno")),n.topicIDs&&n.topicIDs.length){o.topicIDs=[];for(var a=0;a<n.topicIDs.length;++a)o.topicIDs[a]=n.topicIDs[a]}return n.signature!=null&&n.hasOwnProperty("signature")&&(o.signature=s.bytes===String?Tt.base64.encode(n.signature,0,n.signature.length):s.bytes===Array?Array.prototype.slice.call(n.signature):n.signature,s.oneofs&&(o._signature="signature")),n.key!=null&&n.hasOwnProperty("key")&&(o.key=s.bytes===String?Tt.base64.encode(n.key,0,n.key.length):s.bytes===Array?Array.prototype.slice.call(n.key):n.key,s.oneofs&&(o._key="key")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,Jl.util.toJSONOptions)},e}(),r}();sie.exports=Ui});var PI=m((Q8t,cie)=>{l();"use strict";var oie=Xn(),{Buffer:CMe}=ci(),aie=(r,e,t)=>{let i=oie.encode(r,e,t);return aie.bytes=oie.encode.bytes,e||CMe.from(i)};cie.exports=aie});var pie=m((Z8t,pw)=>{l();"use strict";var{Buffer:uie}=ci(),lie=on(),fie=PI(),CI=8,die=10*1024;function hie(r){r=r||{};let e=Math.max(r.poolSize||die,r.minPoolSize||CI),t=r.lengthEncoder||fie;return async function*(n){let s=uie.alloc(e),o=0;for await(let a of n){t(a.length,s,o);let c=s.slice(o,o+t.bytes);o+=t.bytes,s.length-o<CI&&(s=uie.alloc(e),o=0),yield new lie().append(c).append(a)}}}hie.single=(r,e)=>{e=e||{};let t=e.lengthEncoder||fie;return new lie([t(r.length),r.slice()])};pw.exports=hie;pw.exports.MIN_POOL_SIZE=CI;pw.exports.DEFAULT_POOL_SIZE=die});var OI=m((J8t,mie)=>{l();"use strict";var yie=Xn(),{Buffer:OMe}=ci(),kMe=r=>new Proxy({},{get:(e,t)=>t[0]==="l"?r[t]:r.get(parseInt(t))}),gie=r=>{let e=yie.decode(OMe.isBuffer(r)?r:kMe(r));return gie.bytes=yie.decode.bytes,e};mie.exports=gie});var vie=m((e_t,yw)=>{l();"use strict";var{Buffer:DMe}=ci(),kI=on(),NMe=OI(),bie=8,wie=1024*1024*4,_ie=DMe.alloc(0),ef={LENGTH:"readLength",DATA:"readData"},BMe={[ef.LENGTH]:(r,e,t,i)=>{e=e.append(r);let n;try{n=i.lengthDecoder(e)}catch(s){if(e.length>i.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:ef.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw s}if(n>i.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return r=e.shallowSlice(i.lengthDecoder.bytes),e=new kI,i.onLength&&i.onLength(n),n<=0?(i.onData&&i.onData(_ie),{mode:ef.LENGTH,chunk:r,buffer:e,data:_ie}):{mode:ef.DATA,chunk:r,buffer:e,state:{dataLength:n},data:void 0}},[ef.DATA]:(r,e,t,i)=>{if(e=e.append(r),!t)throw new Error("state is required");if(e.length<t.dataLength)return{mode:ef.DATA,buffer:e,state:t,chunk:void 0,data:void 0};let{dataLength:n}=t,s=e.shallowSlice(0,n),o=e.length>n?e.shallowSlice(n):void 0;return e=new kI,i.onData&&i.onData(s),{mode:ef.LENGTH,chunk:o,buffer:e,state:void 0,data:s}}};function DI(r){r=r||{};let e={lengthDecoder:r.lengthDecoder||NMe,maxLengthLength:r.maxLengthLength||bie,maxDataLength:r.maxDataLength||wie,onLength:r.onLength,onData:r.onData};return async function*(i){let n=new kI,s=ef.LENGTH,o;for await(let a of i){let c=a;for(;c;){let u=BMe[s](c,n,o,e);s=u.mode,c=u.chunk,n=u.buffer,o=u.state,u.data&&(yield u.data)}}if(n.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}DI.fromReader=(r,e)=>{let t=1,i={[Symbol.asyncIterator](){return this},next:async()=>{try{return await r.next(t)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{t=1}}};return DI({...e||{},onLength:s=>{t=s}})(i)};yw.exports=DI;yw.exports.MAX_LENGTH_LENGTH=bie;yw.exports.MAX_DATA_LENGTH=wie});var Aie=m((t_t,Sie)=>{l();"use strict";var{Buffer:LMe}=ci(),Eie=(r,e,t)=>(e=e||LMe.allocUnsafe(4),e.writeInt32BE(r,t),e);Eie.bytes=4;Sie.exports=Eie});var Iie=m((r_t,xie)=>{l();"use strict";var Rie=r=>{if(r.length<4)throw RangeError("Could not decode int32BE");return r.readInt32BE(0)};Rie.bytes=4;xie.exports=Rie});var go=m(sh=>{l();"use strict";sh.encode=pie();sh.decode=vie();sh.varintEncode=PI();sh.varintDecode=OI();sh.int32BEEncode=Aie();sh.int32BEDecode=Iie()});var gw=m((n_t,Tie)=>{l();Tie.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var Cie=m((o_t,Pie)=>{l();Pie.exports=class extends Error{constructor(e,t){super(e||"The operation was aborted");this.type="aborted",this.code=t||"ABORT_ERR"}}});var fa=m((a_t,oh)=>{l();var MMe=gw(),NI=Cie(),Oie=(r,e,t)=>BI(r,Array.isArray(e)?e:[{signal:e,options:t}]),BI=(r,e)=>{r=MMe(r),e=e.map(({signal:i,options:n})=>({signal:i,options:n||{}}));async function*t(){let i,n=()=>{i&&i()};for(let{signal:s}of e)s.addEventListener("abort",n);for(;;){let s;try{for(let{signal:a,options:c}of e)if(a.aborted){let{abortMessage:u,abortCode:f}=c;throw new NI(u,f)}let o=new Promise((a,c)=>{i=()=>{let{options:u}=e.find(({signal:h})=>h.aborted),{abortMessage:f,abortCode:d}=u;c(new NI(f,d))}});s=await Promise.race([o,r.next()]),i=null}catch(o){for(let{signal:u}of e)u.removeEventListener("abort",n);let a=e.find(({signal:u})=>u.aborted),c=o.type==="aborted"&&a;if(c&&a.options.onAbort&&await a.options.onAbort(r),typeof r.return=="function")try{let u=r.return();u instanceof Promise&&u.catch(f=>{a.options.onReturnError!=null&&a.options.onReturnError(f)})}catch(u){a.options.onReturnError!=null&&a.options.onReturnError(u)}if(c&&a.options.returnOnAbort)return;throw o}if(s.done)break;yield s.value}for(let{signal:s}of e)s.removeEventListener("abort",n)}return t()},kie=(r,e,t)=>Die(r,Array.isArray(e)?e:[{signal:e,options:t}]),Die=(r,e)=>t=>r(BI(t,e)),jMe=(r,e,t)=>qMe(r,Array.isArray(e)?e:[{signal:e,options:t}]),qMe=(r,e)=>({sink:Die(r.sink,e),source:BI(r.source,e)});oh.exports=Oie;oh.exports.AbortError=NI;oh.exports.source=Oie;oh.exports.sink=kie;oh.exports.transform=kie;oh.exports.duplex=jMe});var qie=m((c_t,jie)=>{l();"use strict";var Nie=le(),UMe=Object.assign(Nie("libp2p-pubsub:peer-streams"),{error:Nie("libp2p-pubsub:peer-streams:err")}),{EventEmitter:FMe}=Ut(),Bie=go(),KMe=Za(),{pipe:Lie}=dr(),{source:VMe}=fa(),Mie=class extends FMe{constructor({id:e,protocol:t}){super();this.id=e,this.protocol=t,this._rawOutboundStream=null,this._rawInboundStream=null,this._inboundAbortController=new AbortController,this.outboundStream=null,this.inboundStream=null}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(e){if(!this.outboundStream){let t=this.id.toB58String();throw new Error("No writable connection to "+t)}this.outboundStream.push(e)}attachInboundStream(e){return this._rawInboundStream=e,this.inboundStream=VMe(Lie(this._rawInboundStream,Bie.decode()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.emit("stream:inbound"),this.inboundStream}async attachOutboundStream(e){let t=this.outboundStream;this.outboundStream&&await this.outboundStream.end(),this._rawOutboundStream=e,this.outboundStream=KMe({onEnd:i=>{this._rawOutboundStream&&this._rawOutboundStream.reset&&this._rawOutboundStream.reset(),this._rawOutboundStream=null,this.outboundStream=null,i&&this.emit("close")}}),Lie(this.outboundStream,Bie.encode(),this._rawOutboundStream).catch(i=>{UMe.error(i)}),t||this.emit("stream:outbound")}close(){this.outboundStream&&this.outboundStream.end(),this.inboundStream&&this._inboundAbortController.abort(),this._rawOutboundStream=null,this.outboundStream=null,this._rawInboundStream=null,this.inboundStream=null,this.emit("close")}};jie.exports=Mie});var Fie=m(Uie=>{l();"use strict";var zMe={StrictSign:"StrictSign",StrictNoSign:"StrictNoSign"};Uie.SignaturePolicy=zMe});var LI=m((l_t,zie)=>{l();"use strict";var HMe=s2(),{toString:$Me}=(et(),or),{fromString:Kie}=(at(),Xr),Vie=st(),{sha256:GMe}=(Si(),Ks),WMe=()=>HMe(8),YMe=(r,e)=>{let t;r instanceof Uint8Array?t=Vie.createFromBytes(r).id:t=Vie.parse(r).id;let i=new Uint8Array(t.length+e.length);return i.set(t,0),i.set(e,t.length),i},XMe=r=>GMe.encode(r),QMe=(r,e)=>{let t;Array.isArray(e)?t=i=>e.indexOf(i)>-1:t=i=>e.has(i);for(let i of r)if(t(i))return!0;return!1},ZMe=r=>Array.isArray(r)?r:[r],JMe=(r,e)=>{let t=Object.assign({},r);return r.from instanceof Uint8Array&&(t.from=$Me(r.from,"base58btc")),e&&(t.receivedFrom=e),t},eje=r=>{let e=Object.assign({},r);return typeof r.from=="string"&&(e.from=Kie(r.from,"base58btc")),typeof r.data=="string"&&(e.data=Kie(r.data)),e};zie.exports={randomSeqno:WMe,msgId:YMe,noSignMsgId:XMe,anyMatch:QMe,ensureArray:ZMe,normalizeInRpcMessage:JMe,normalizeOutRpcMessage:eje}});var Yie=m((f_t,Wie)=>{l();"use strict";var MI=st(),{RPC:Hie}=TI(),{concat:$ie}=(Ri(),Cn),{fromString:tje}=(at(),Xr),jI=tje("libp2p-pubsub:"),{normalizeOutRpcMessage:rje}=LI();async function ije(r,e){let t=$ie([jI,Hie.Message.encode(rje(e)).finish()]),i=await r.privKey.sign(t);return{...e,signature:i,key:r.pubKey.bytes}}async function nje(r){if(!r.signature)throw new Error("Message must contain a signature to be verified");if(!r.from)throw new Error("Message must contain a from property to be verified");let e=$ie([jI,Hie.Message.encode({...r,from:MI.createFromB58String(r.from).toBytes(),signature:void 0,key:void 0}).finish()]);return(await Gie(r)).verify(e,r.signature)}async function Gie(r){if(!r.from)throw new Error("Could not get the public key from the originator id");let e=MI.createFromB58String(r.from);if(r.key){let t=await MI.createFromPubKey(r.key);if(t.equals(e))return t.pubKey;throw new Error("Public Key does not match the originator")}else{if(e.pubKey)return e.pubKey;throw new Error("Could not get the public key from the originator id")}}Wie.exports={messagePublicKey:Gie,signMessage:ije,SignPrefix:jI,verifySignature:nje}});var Jie=m((d_t,Zie)=>{l();"use strict";var Xie=le(),{EventEmitter:sje}=Ut(),as=RI(),{pipe:oje}=dr(),{default:aje}=Go(),cje=dw(),{codes:da}=hw(),{RPC:Qie}=TI(),uje=qie(),{SignaturePolicy:_u}=Fie(),tf=LI(),{signMessage:lje,verifySignature:fje}=Yie(),mw=class extends sje{constructor({debugName:e,multicodecs:t,libp2p:i,globalSignaturePolicy:n=_u.StrictSign,canRelayMessage:s=!1,emitSelf:o=!1,messageProcessingConcurrency:a=10}){if(typeof e!="string")throw new Error("a debugname `string` is required");if(!t)throw new Error("multicodecs are required");if(!i)throw new Error("libp2p is required");super();if(this.log=Object.assign(Xie(e),{err:Xie(`${e}:error`)}),this.multicodecs=tf.ensureArray(t),this._libp2p=i,this.registrar=i.registrar,this.peerId=i.peerId,this.started=!1,this.topics=new Map,this.subscriptions=new Set,this.peers=new Map,!_u[n])throw as(new Error("Invalid global signature policy"),da.ERR_INVALID_SIGNATURE_POLICY);this.globalSignaturePolicy=n,this.canRelayMessage=s,this.emitSelf=o,this.topicValidators=new Map,this.queue=new aje({concurrency:a}),this._registrarId=void 0,this._onIncomingStream=this._onIncomingStream.bind(this),this._onPeerConnected=this._onPeerConnected.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this)}async start(){if(this.started)return;this.log("starting"),this.registrar.handle(this.multicodecs,this._onIncomingStream);let e=new cje({multicodecs:this.multicodecs,handlers:{onConnect:this._onPeerConnected,onDisconnect:this._onPeerDisconnected}});this._registrarId=await this.registrar.register(e),this.log("started"),this.started=!0}async stop(){!this.started||(this.registrar.unregister(this._registrarId),this.log("stopping"),this.peers.forEach(e=>e.close()),this.peers=new Map,this.subscriptions=new Set,this.started=!1,this.log("stopped"))}_onIncomingStream({protocol:e,stream:t,connection:i}){let n=i.remotePeer,s=n.toB58String(),o=this._addPeer(n,e),a=o.attachInboundStream(t);this._processMessages(s,a,o)}async _onPeerConnected(e,t){let i=e.toB58String();this.log("connected",i);try{let{stream:n,protocol:s}=await t.newStream(this.multicodecs);await this._addPeer(e,s).attachOutboundStream(n)}catch(n){this.log.err(n)}this._sendSubscriptions(i,Array.from(this.subscriptions),!0)}_onPeerDisconnected(e,t){let i=e.toB58String();this.log("connection ended",i,t?t.message:""),this._removePeer(e)}_addPeer(e,t){let i=e.toB58String(),n=this.peers.get(i);if(n)return n;this.log("new peer",i);let s=new uje({id:e,protocol:t});return this.peers.set(i,s),s.once("close",()=>this._removePeer(e)),s}_removePeer(e){if(!e)return;let t=e.toB58String(),i=this.peers.get(t);if(!!i){i.removeAllListeners(),i.close(),this.log("delete peer",t),this.peers.delete(t);for(let n of this.topics.values())n.delete(t);return i}}async _processMessages(e,t,i){try{await oje(t,async n=>{for await(let s of n){let o=s instanceof Uint8Array?s:s.slice(),a=this._decodeRpc(o);(async()=>{try{await this._processRpc(e,i,a)}catch(c){this.log.err(c)}})()}})}catch(n){this._onPeerDisconnected(i.id,n)}}async _processRpc(e,t,i){this.log("rpc from",e);let n=i.subscriptions,s=i.msgs;return n.length&&(n.forEach(o=>{this._processRpcSubOpt(e,o)}),this.emit("pubsub:subscription-change",t.id,n)),this._acceptFrom(e)?(s.length&&this.queue.addAll(s.map(o=>async()=>{if(!(this.canRelayMessage||o.topicIDs&&o.topicIDs.some(a=>this.subscriptions.has(a)))){this.log("received message we didn't subscribe to. Dropping.");return}try{let a=tf.normalizeInRpcMessage(o,e);await this._processRpcMessage(a)}catch(a){this.log.err(a)}})),!0):(this.log("received message from unacceptable peer %s",e),!1)}_processRpcSubOpt(e,t){let i=t.topicID;if(!i)return;let n=this.topics.get(i);n||(n=new Set,this.topics.set(i,n)),t.subscribe?n.add(e):n.delete(e)}async _processRpcMessage(e){if(!(this.peerId.toB58String()===e.from&&!this.emitSelf)){try{await this.validate(e)}catch(t){this.log("Message is invalid, dropping it. %O",t);return}return this._emitMessage(e),this._publish(tf.normalizeOutRpcMessage(e))}}_emitMessage(e){e.topicIDs.forEach(t=>{this.subscriptions.has(t)&&this.emit(t,e)})}getMsgId(e){let t=this.globalSignaturePolicy;switch(t){case _u.StrictSign:return tf.msgId(e.from,e.seqno);case _u.StrictNoSign:return tf.noSignMsgId(e.data);default:throw as(new Error("Cannot get message id: unhandled signature policy: "+t),da.ERR_UNHANDLED_SIGNATURE_POLICY)}}_acceptFrom(e){return!0}_decodeRpc(e){return Qie.decode(e)}_encodeRpc(e){return Qie.encode(e).finish()}_sendRpc(e,t){let i=this.peers.get(e);if(!i||!i.isWritable){let n=`Cannot send RPC to ${e} as there is no open stream to it available`;this.log.err(n);return}i.write(this._encodeRpc(t))}_sendSubscriptions(e,t,i){return this._sendRpc(e,{subscriptions:t.map(n=>({topicID:n,subscribe:i}))})}async validate(e){let t=this.globalSignaturePolicy;switch(t){case _u.StrictNoSign:if(e.from)throw as(new Error("StrictNoSigning: from should not be present"),da.ERR_UNEXPECTED_FROM);if(e.signature)throw as(new Error("StrictNoSigning: signature should not be present"),da.ERR_UNEXPECTED_SIGNATURE);if(e.key)throw as(new Error("StrictNoSigning: key should not be present"),da.ERR_UNEXPECTED_KEY);if(e.seqno)throw as(new Error("StrictNoSigning: seqno should not be present"),da.ERR_UNEXPECTED_SEQNO);break;case _u.StrictSign:if(!e.signature)throw as(new Error("StrictSigning: Signing required and no signature was present"),da.ERR_MISSING_SIGNATURE);if(!e.seqno)throw as(new Error("StrictSigning: Signing required and no seqno was present"),da.ERR_MISSING_SEQNO);if(!await fje(e))throw as(new Error("StrictSigning: Invalid message signature"),da.ERR_INVALID_SIGNATURE);break;default:throw as(new Error("Cannot validate message: unhandled signature policy: "+t),da.ERR_UNHANDLED_SIGNATURE_POLICY)}for(let i of e.topicIDs){let n=this.topicValidators.get(i);n&&await n(i,e)}}_buildMessage(e){let t=this.globalSignaturePolicy;switch(t){case _u.StrictSign:return e.from=this.peerId.toB58String(),e.seqno=tf.randomSeqno(),lje(this.peerId,e);case _u.StrictNoSign:return Promise.resolve(e);default:throw as(new Error("Cannot build message: unhandled signature policy: "+t),da.ERR_UNHANDLED_SIGNATURE_POLICY)}}getSubscribers(e){if(!this.started)throw as(new Error("not started yet"),"ERR_NOT_STARTED_YET");if(!e||typeof e!="string")throw as(new Error("a string topic must be provided"),"ERR_NOT_VALID_TOPIC");let t=this.topics.get(e);return t?Array.from(t):[]}async publish(e,t){if(!this.started)throw new Error("Pubsub has not started");this.log("publish",e,t);let n={receivedFrom:this.peerId.toB58String(),data:t,topicIDs:[e]},s=await this._buildMessage(n),o=tf.normalizeInRpcMessage(s);this.emitSelf&&this._emitMessage(o),await this._publish(o)}_publish(e){throw as(new Error("publish must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}subscribe(e){if(!this.started)throw new Error("Pubsub has not started");this.subscriptions.has(e)||(this.subscriptions.add(e),this.peers.forEach((t,i)=>this._sendSubscriptions(i,[e],!0)))}unsubscribe(e){if(!this.started)throw new Error("Pubsub is not started");this.subscriptions.has(e)&&this.listenerCount(e)===0&&(this.subscriptions.delete(e),this.peers.forEach((t,i)=>this._sendSubscriptions(i,[e],!1)))}getTopics(){if(!this.started)throw new Error("Pubsub is not started");return Array.from(this.subscriptions)}};mw.utils=tf;mw.SignaturePolicy=_u;Zie.exports=mw});var ene=m(bw=>{l();"use strict";Object.defineProperty(bw,"__esModule",{value:!0});bw.createGossipRpc=void 0;function dje(r=[],e={}){return{subscriptions:[],msgs:r,control:Object.assign({ihave:[],iwant:[],graft:[],prune:[]},e)}}bw.createGossipRpc=dje});var tne=m(ww=>{l();"use strict";Object.defineProperty(ww,"__esModule",{value:!0});ww.shuffle=void 0;function hje(r){if(r.length<=1)return r;let e=()=>Math.floor(Math.random()*Math.floor(r.length));for(let t=0;t<r.length;t++){let i=e(),n=r[t];r[t]=r[i],r[i]=n}return r}ww.shuffle=hje});var rf=m(_e=>{l();"use strict";Object.defineProperty(_e,"__esModule",{value:!0});_e.ACCEPT_FROM_WHITELIST_DURATION_MS=_e.ACCEPT_FROM_WHITELIST_MAX_MESSAGES=_e.ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE=_e.ERR_TOPIC_VALIDATOR_IGNORE=_e.ERR_TOPIC_VALIDATOR_REJECT=_e.TimeCacheDuration=_e.GossipsubSeenTTL=_e.GossipsubIWantFollowupTime=_e.GossipsubMaxIHaveMessages=_e.GossipsubMaxIHaveLength=_e.GossipsubGraftFloodThreshold=_e.GossipsubOpportunisticGraftPeers=_e.GossipsubOpportunisticGraftTicks=_e.GossipsubDirectConnectInitialDelay=_e.GossipsubDirectConnectTicks=_e.GossipsubConnectionTimeout=_e.GossipsubMaxPendingConnections=_e.GossipsubConnectors=_e.GossipsubPruneBackoffTicks=_e.GossipsubPruneBackoff=_e.GossipsubPrunePeers=_e.GossipsubFanoutTTL=_e.GossipsubHeartbeatInterval=_e.GossipsubHeartbeatInitialDelay=_e.GossipsubGossipRetransmission=_e.GossipsubGossipFactor=_e.GossipsubDlazy=_e.GossipsubHistoryGossip=_e.GossipsubHistoryLength=_e.GossipsubDout=_e.GossipsubDscore=_e.GossipsubDhi=_e.GossipsubDlo=_e.GossipsubD=_e.GossipsubIDv11=_e.GossipsubIDv10=_e.FloodsubID=_e.minute=_e.second=void 0;_e.second=1e3;_e.minute=60*_e.second;_e.FloodsubID="/floodsub/1.0.0";_e.GossipsubIDv10="/meshsub/1.0.0";_e.GossipsubIDv11="/meshsub/1.1.0";_e.GossipsubD=6;_e.GossipsubDlo=4;_e.GossipsubDhi=12;_e.GossipsubDscore=4;_e.GossipsubDout=2;_e.GossipsubHistoryLength=5;_e.GossipsubHistoryGossip=3;_e.GossipsubDlazy=6;_e.GossipsubGossipFactor=.25;_e.GossipsubGossipRetransmission=3;_e.GossipsubHeartbeatInitialDelay=100;_e.GossipsubHeartbeatInterval=_e.second;_e.GossipsubFanoutTTL=_e.minute;_e.GossipsubPrunePeers=16;_e.GossipsubPruneBackoff=_e.minute;_e.GossipsubPruneBackoffTicks=15;_e.GossipsubConnectors=8;_e.GossipsubMaxPendingConnections=128;_e.GossipsubConnectionTimeout=30*_e.second;_e.GossipsubDirectConnectTicks=300;_e.GossipsubDirectConnectInitialDelay=_e.second;_e.GossipsubOpportunisticGraftTicks=60;_e.GossipsubOpportunisticGraftPeers=2;_e.GossipsubGraftFloodThreshold=10*_e.second;_e.GossipsubMaxIHaveLength=5e3;_e.GossipsubMaxIHaveMessages=10;_e.GossipsubIWantFollowupTime=3*_e.second;_e.GossipsubSeenTTL=30*_e.second;_e.TimeCacheDuration=120*1e3;_e.ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT";_e.ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE";_e.ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE=0;_e.ACCEPT_FROM_WHITELIST_MAX_MESSAGES=128;_e.ACCEPT_FROM_WHITELIST_DURATION_MS=1e3});var ine=m(_w=>{l();"use strict";Object.defineProperty(_w,"__esModule",{value:!0});_w.hasGossipProtocol=void 0;var rne=rf();function pje(r){return r===rne.GossipsubIDv10||r===rne.GossipsubIDv11}_w.hasGossipProtocol=pje});var nne=m(o1=>{l();"use strict";Object.defineProperty(o1,"__esModule",{value:!0});o1.messageIdFromString=o1.messageIdToString=void 0;var yje=(at(),Xr),gje=(et(),or);function mje(r){return gje.toString(r,"base64")}o1.messageIdToString=mje;function bje(r){return yje.fromString(r,"base64")}o1.messageIdFromString=bje});var a1=m(gc=>{l();"use strict";var wje=gc&&gc.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),vw=gc&&gc.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&wje(e,r,t)};Object.defineProperty(gc,"__esModule",{value:!0});vw(ene(),gc);vw(tne(),gc);vw(ine(),gc);vw(nne(),gc)});var one=m(c1=>{l();"use strict";var _je=c1&&c1.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(f){try{u(i.next(f))}catch(d){o(d)}}function c(f){try{u(i.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):n(f.value).then(a,c)}u((i=i.apply(r,e||[])).next())})};Object.defineProperty(c1,"__esModule",{value:!0});c1.MessageCache=void 0;var qI=a1(),sne=class{constructor(e,t){this.msgs=new Map,this.peertx=new Map,this.history=[];for(let i=0;i<t;i++)this.history[i]=[];this.gossip=e}put(e,t){return _je(this,void 0,void 0,function*(){this.msgs.set(t,e);let i=qI.messageIdFromString(t);this.history[0].push({msgId:i,topics:e.topicIDs})})}get(e){return this.msgs.get(qI.messageIdToString(e))}getForPeer(e,t){let i=this.msgs.get(e);if(!i)return[void 0,0];let n=this.peertx.get(e);n||(n=new Map,this.peertx.set(e,n));let s=(n.get(t)||0)+1;return n.set(t,s),[i,s]}getGossipIDs(e){let t=[];for(let i=0;i<this.gossip;i++)this.history[i].forEach(n=>{for(let s of n.topics)if(s===e){t.push(n.msgId);break}});return t}shift(){this.history[this.history.length-1].forEach(t=>{let i=qI.messageIdToString(t.msgId);this.msgs.delete(i),this.peertx.delete(i)}),this.history.pop(),this.history.unshift([])}};c1.MessageCache=sne});var cne=m((ane,sm)=>{l();(function(r,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof Aa=="function"&&typeof sm=="object"&&sm&&sm.exports&&(sm.exports=e(Br()))})(ane,function(r){"use strict";var e=r.Reader,t=r.Writer,i=r.util,n=r.roots.default||(r.roots.default={});return n.RPC=function(){function s(a){if(this.subscriptions=[],this.msgs=[],a)for(var c=Object.keys(a),u=0;u<c.length;++u)a[c[u]]!=null&&(this[c[u]]=a[c[u]])}s.prototype.subscriptions=i.emptyArray,s.prototype.msgs=i.emptyArray,s.prototype.control=null;var o;return Object.defineProperty(s.prototype,"_control",{get:i.oneOfGetter(o=["control"]),set:i.oneOfSetter(o)}),s.encode=function(c,u){if(u||(u=t.create()),c.subscriptions!=null&&c.subscriptions.length)for(var f=0;f<c.subscriptions.length;++f)n.RPC.SubOpts.encode(c.subscriptions[f],u.uint32(10).fork()).ldelim();if(c.msgs!=null&&c.msgs.length)for(var f=0;f<c.msgs.length;++f)n.RPC.Message.encode(c.msgs[f],u.uint32(18).fork()).ldelim();return c.control!=null&&Object.hasOwnProperty.call(c,"control")&&n.RPC.ControlMessage.encode(c.control,u.uint32(26).fork()).ldelim(),u},s.decode=function(c,u){c instanceof e||(c=e.create(c));for(var f=u===void 0?c.len:c.pos+u,d=new n.RPC;c.pos<f;){var h=c.uint32();switch(h>>>3){case 1:d.subscriptions&&d.subscriptions.length||(d.subscriptions=[]),d.subscriptions.push(n.RPC.SubOpts.decode(c,c.uint32()));break;case 2:d.msgs&&d.msgs.length||(d.msgs=[]),d.msgs.push(n.RPC.Message.decode(c,c.uint32()));break;case 3:d.control=n.RPC.ControlMessage.decode(c,c.uint32());break;default:c.skipType(h&7);break}}return d},s.fromObject=function(c){if(c instanceof n.RPC)return c;var u=new n.RPC;if(c.subscriptions){if(!Array.isArray(c.subscriptions))throw TypeError(".RPC.subscriptions: array expected");u.subscriptions=[];for(var f=0;f<c.subscriptions.length;++f){if(typeof c.subscriptions[f]!="object")throw TypeError(".RPC.subscriptions: object expected");u.subscriptions[f]=n.RPC.SubOpts.fromObject(c.subscriptions[f])}}if(c.msgs){if(!Array.isArray(c.msgs))throw TypeError(".RPC.msgs: array expected");u.msgs=[];for(var f=0;f<c.msgs.length;++f){if(typeof c.msgs[f]!="object")throw TypeError(".RPC.msgs: object expected");u.msgs[f]=n.RPC.Message.fromObject(c.msgs[f])}}if(c.control!=null){if(typeof c.control!="object")throw TypeError(".RPC.control: object expected");u.control=n.RPC.ControlMessage.fromObject(c.control)}return u},s.toObject=function(c,u){u||(u={});var f={};if((u.arrays||u.defaults)&&(f.subscriptions=[],f.msgs=[]),c.subscriptions&&c.subscriptions.length){f.subscriptions=[];for(var d=0;d<c.subscriptions.length;++d)f.subscriptions[d]=n.RPC.SubOpts.toObject(c.subscriptions[d],u)}if(c.msgs&&c.msgs.length){f.msgs=[];for(var d=0;d<c.msgs.length;++d)f.msgs[d]=n.RPC.Message.toObject(c.msgs[d],u)}return c.control!=null&&c.hasOwnProperty("control")&&(f.control=n.RPC.ControlMessage.toObject(c.control,u),u.oneofs&&(f._control="control")),f},s.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},s.SubOpts=function(){function a(u){if(u)for(var f=Object.keys(u),d=0;d<f.length;++d)u[f[d]]!=null&&(this[f[d]]=u[f[d]])}a.prototype.subscribe=null,a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_subscribe",{get:i.oneOfGetter(c=["subscribe"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(f,d){return d||(d=t.create()),f.subscribe!=null&&Object.hasOwnProperty.call(f,"subscribe")&&d.uint32(8).bool(f.subscribe),f.topicID!=null&&Object.hasOwnProperty.call(f,"topicID")&&d.uint32(18).string(f.topicID),d},a.decode=function(f,d){f instanceof e||(f=e.create(f));for(var h=d===void 0?f.len:f.pos+d,p=new n.RPC.SubOpts;f.pos<h;){var y=f.uint32();switch(y>>>3){case 1:p.subscribe=f.bool();break;case 2:p.topicID=f.string();break;default:f.skipType(y&7);break}}return p},a.fromObject=function(f){if(f instanceof n.RPC.SubOpts)return f;var d=new n.RPC.SubOpts;return f.subscribe!=null&&(d.subscribe=Boolean(f.subscribe)),f.topicID!=null&&(d.topicID=String(f.topicID)),d},a.toObject=function(f,d){d||(d={});var h={};return f.subscribe!=null&&f.hasOwnProperty("subscribe")&&(h.subscribe=f.subscribe,d.oneofs&&(h._subscribe="subscribe")),f.topicID!=null&&f.hasOwnProperty("topicID")&&(h.topicID=f.topicID,d.oneofs&&(h._topicID="topicID")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.Message=function(){function a(u){if(this.topicIDs=[],u)for(var f=Object.keys(u),d=0;d<f.length;++d)u[f[d]]!=null&&(this[f[d]]=u[f[d]])}a.prototype.from=null,a.prototype.data=null,a.prototype.seqno=null,a.prototype.topicIDs=i.emptyArray,a.prototype.signature=null,a.prototype.key=null;var c;return Object.defineProperty(a.prototype,"_from",{get:i.oneOfGetter(c=["from"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_data",{get:i.oneOfGetter(c=["data"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_seqno",{get:i.oneOfGetter(c=["seqno"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signature",{get:i.oneOfGetter(c=["signature"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_key",{get:i.oneOfGetter(c=["key"]),set:i.oneOfSetter(c)}),a.encode=function(f,d){if(d||(d=t.create()),f.from!=null&&Object.hasOwnProperty.call(f,"from")&&d.uint32(10).bytes(f.from),f.data!=null&&Object.hasOwnProperty.call(f,"data")&&d.uint32(18).bytes(f.data),f.seqno!=null&&Object.hasOwnProperty.call(f,"seqno")&&d.uint32(26).bytes(f.seqno),f.topicIDs!=null&&f.topicIDs.length)for(var h=0;h<f.topicIDs.length;++h)d.uint32(34).string(f.topicIDs[h]);return f.signature!=null&&Object.hasOwnProperty.call(f,"signature")&&d.uint32(42).bytes(f.signature),f.key!=null&&Object.hasOwnProperty.call(f,"key")&&d.uint32(50).bytes(f.key),d},a.decode=function(f,d){f instanceof e||(f=e.create(f));for(var h=d===void 0?f.len:f.pos+d,p=new n.RPC.Message;f.pos<h;){var y=f.uint32();switch(y>>>3){case 1:p.from=f.bytes();break;case 2:p.data=f.bytes();break;case 3:p.seqno=f.bytes();break;case 4:p.topicIDs&&p.topicIDs.length||(p.topicIDs=[]),p.topicIDs.push(f.string());break;case 5:p.signature=f.bytes();break;case 6:p.key=f.bytes();break;default:f.skipType(y&7);break}}return p},a.fromObject=function(f){if(f instanceof n.RPC.Message)return f;var d=new n.RPC.Message;if(f.from!=null&&(typeof f.from=="string"?i.base64.decode(f.from,d.from=i.newBuffer(i.base64.length(f.from)),0):f.from.length&&(d.from=f.from)),f.data!=null&&(typeof f.data=="string"?i.base64.decode(f.data,d.data=i.newBuffer(i.base64.length(f.data)),0):f.data.length&&(d.data=f.data)),f.seqno!=null&&(typeof f.seqno=="string"?i.base64.decode(f.seqno,d.seqno=i.newBuffer(i.base64.length(f.seqno)),0):f.seqno.length&&(d.seqno=f.seqno)),f.topicIDs){if(!Array.isArray(f.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");d.topicIDs=[];for(var h=0;h<f.topicIDs.length;++h)d.topicIDs[h]=String(f.topicIDs[h])}return f.signature!=null&&(typeof f.signature=="string"?i.base64.decode(f.signature,d.signature=i.newBuffer(i.base64.length(f.signature)),0):f.signature.length&&(d.signature=f.signature)),f.key!=null&&(typeof f.key=="string"?i.base64.decode(f.key,d.key=i.newBuffer(i.base64.length(f.key)),0):f.key.length&&(d.key=f.key)),d},a.toObject=function(f,d){d||(d={});var h={};if((d.arrays||d.defaults)&&(h.topicIDs=[]),f.from!=null&&f.hasOwnProperty("from")&&(h.from=d.bytes===String?i.base64.encode(f.from,0,f.from.length):d.bytes===Array?Array.prototype.slice.call(f.from):f.from,d.oneofs&&(h._from="from")),f.data!=null&&f.hasOwnProperty("data")&&(h.data=d.bytes===String?i.base64.encode(f.data,0,f.data.length):d.bytes===Array?Array.prototype.slice.call(f.data):f.data,d.oneofs&&(h._data="data")),f.seqno!=null&&f.hasOwnProperty("seqno")&&(h.seqno=d.bytes===String?i.base64.encode(f.seqno,0,f.seqno.length):d.bytes===Array?Array.prototype.slice.call(f.seqno):f.seqno,d.oneofs&&(h._seqno="seqno")),f.topicIDs&&f.topicIDs.length){h.topicIDs=[];for(var p=0;p<f.topicIDs.length;++p)h.topicIDs[p]=f.topicIDs[p]}return f.signature!=null&&f.hasOwnProperty("signature")&&(h.signature=d.bytes===String?i.base64.encode(f.signature,0,f.signature.length):d.bytes===Array?Array.prototype.slice.call(f.signature):f.signature,d.oneofs&&(h._signature="signature")),f.key!=null&&f.hasOwnProperty("key")&&(h.key=d.bytes===String?i.base64.encode(f.key,0,f.key.length):d.bytes===Array?Array.prototype.slice.call(f.key):f.key,d.oneofs&&(h._key="key")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlMessage=function(){function a(c){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],c)for(var u=Object.keys(c),f=0;f<u.length;++f)c[u[f]]!=null&&(this[u[f]]=c[u[f]])}return a.prototype.ihave=i.emptyArray,a.prototype.iwant=i.emptyArray,a.prototype.graft=i.emptyArray,a.prototype.prune=i.emptyArray,a.encode=function(u,f){if(f||(f=t.create()),u.ihave!=null&&u.ihave.length)for(var d=0;d<u.ihave.length;++d)n.RPC.ControlIHave.encode(u.ihave[d],f.uint32(10).fork()).ldelim();if(u.iwant!=null&&u.iwant.length)for(var d=0;d<u.iwant.length;++d)n.RPC.ControlIWant.encode(u.iwant[d],f.uint32(18).fork()).ldelim();if(u.graft!=null&&u.graft.length)for(var d=0;d<u.graft.length;++d)n.RPC.ControlGraft.encode(u.graft[d],f.uint32(26).fork()).ldelim();if(u.prune!=null&&u.prune.length)for(var d=0;d<u.prune.length;++d)n.RPC.ControlPrune.encode(u.prune[d],f.uint32(34).fork()).ldelim();return f},a.decode=function(u,f){u instanceof e||(u=e.create(u));for(var d=f===void 0?u.len:u.pos+f,h=new n.RPC.ControlMessage;u.pos<d;){var p=u.uint32();switch(p>>>3){case 1:h.ihave&&h.ihave.length||(h.ihave=[]),h.ihave.push(n.RPC.ControlIHave.decode(u,u.uint32()));break;case 2:h.iwant&&h.iwant.length||(h.iwant=[]),h.iwant.push(n.RPC.ControlIWant.decode(u,u.uint32()));break;case 3:h.graft&&h.graft.length||(h.graft=[]),h.graft.push(n.RPC.ControlGraft.decode(u,u.uint32()));break;case 4:h.prune&&h.prune.length||(h.prune=[]),h.prune.push(n.RPC.ControlPrune.decode(u,u.uint32()));break;default:u.skipType(p&7);break}}return h},a.fromObject=function(u){if(u instanceof n.RPC.ControlMessage)return u;var f=new n.RPC.ControlMessage;if(u.ihave){if(!Array.isArray(u.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");f.ihave=[];for(var d=0;d<u.ihave.length;++d){if(typeof u.ihave[d]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");f.ihave[d]=n.RPC.ControlIHave.fromObject(u.ihave[d])}}if(u.iwant){if(!Array.isArray(u.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");f.iwant=[];for(var d=0;d<u.iwant.length;++d){if(typeof u.iwant[d]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");f.iwant[d]=n.RPC.ControlIWant.fromObject(u.iwant[d])}}if(u.graft){if(!Array.isArray(u.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");f.graft=[];for(var d=0;d<u.graft.length;++d){if(typeof u.graft[d]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");f.graft[d]=n.RPC.ControlGraft.fromObject(u.graft[d])}}if(u.prune){if(!Array.isArray(u.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");f.prune=[];for(var d=0;d<u.prune.length;++d){if(typeof u.prune[d]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");f.prune[d]=n.RPC.ControlPrune.fromObject(u.prune[d])}}return f},a.toObject=function(u,f){f||(f={});var d={};if((f.arrays||f.defaults)&&(d.ihave=[],d.iwant=[],d.graft=[],d.prune=[]),u.ihave&&u.ihave.length){d.ihave=[];for(var h=0;h<u.ihave.length;++h)d.ihave[h]=n.RPC.ControlIHave.toObject(u.ihave[h],f)}if(u.iwant&&u.iwant.length){d.iwant=[];for(var h=0;h<u.iwant.length;++h)d.iwant[h]=n.RPC.ControlIWant.toObject(u.iwant[h],f)}if(u.graft&&u.graft.length){d.graft=[];for(var h=0;h<u.graft.length;++h)d.graft[h]=n.RPC.ControlGraft.toObject(u.graft[h],f)}if(u.prune&&u.prune.length){d.prune=[];for(var h=0;h<u.prune.length;++h)d.prune[h]=n.RPC.ControlPrune.toObject(u.prune[h],f)}return d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlIHave=function(){function a(u){if(this.messageIDs=[],u)for(var f=Object.keys(u),d=0;d<f.length;++d)u[f[d]]!=null&&(this[f[d]]=u[f[d]])}a.prototype.topicID=null,a.prototype.messageIDs=i.emptyArray;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(f,d){if(d||(d=t.create()),f.topicID!=null&&Object.hasOwnProperty.call(f,"topicID")&&d.uint32(10).string(f.topicID),f.messageIDs!=null&&f.messageIDs.length)for(var h=0;h<f.messageIDs.length;++h)d.uint32(18).bytes(f.messageIDs[h]);return d},a.decode=function(f,d){f instanceof e||(f=e.create(f));for(var h=d===void 0?f.len:f.pos+d,p=new n.RPC.ControlIHave;f.pos<h;){var y=f.uint32();switch(y>>>3){case 1:p.topicID=f.string();break;case 2:p.messageIDs&&p.messageIDs.length||(p.messageIDs=[]),p.messageIDs.push(f.bytes());break;default:f.skipType(y&7);break}}return p},a.fromObject=function(f){if(f instanceof n.RPC.ControlIHave)return f;var d=new n.RPC.ControlIHave;if(f.topicID!=null&&(d.topicID=String(f.topicID)),f.messageIDs){if(!Array.isArray(f.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");d.messageIDs=[];for(var h=0;h<f.messageIDs.length;++h)typeof f.messageIDs[h]=="string"?i.base64.decode(f.messageIDs[h],d.messageIDs[h]=i.newBuffer(i.base64.length(f.messageIDs[h])),0):f.messageIDs[h].length&&(d.messageIDs[h]=f.messageIDs[h])}return d},a.toObject=function(f,d){d||(d={});var h={};if((d.arrays||d.defaults)&&(h.messageIDs=[]),f.topicID!=null&&f.hasOwnProperty("topicID")&&(h.topicID=f.topicID,d.oneofs&&(h._topicID="topicID")),f.messageIDs&&f.messageIDs.length){h.messageIDs=[];for(var p=0;p<f.messageIDs.length;++p)h.messageIDs[p]=d.bytes===String?i.base64.encode(f.messageIDs[p],0,f.messageIDs[p].length):d.bytes===Array?Array.prototype.slice.call(f.messageIDs[p]):f.messageIDs[p]}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlIWant=function(){function a(c){if(this.messageIDs=[],c)for(var u=Object.keys(c),f=0;f<u.length;++f)c[u[f]]!=null&&(this[u[f]]=c[u[f]])}return a.prototype.messageIDs=i.emptyArray,a.encode=function(u,f){if(f||(f=t.create()),u.messageIDs!=null&&u.messageIDs.length)for(var d=0;d<u.messageIDs.length;++d)f.uint32(10).bytes(u.messageIDs[d]);return f},a.decode=function(u,f){u instanceof e||(u=e.create(u));for(var d=f===void 0?u.len:u.pos+f,h=new n.RPC.ControlIWant;u.pos<d;){var p=u.uint32();switch(p>>>3){case 1:h.messageIDs&&h.messageIDs.length||(h.messageIDs=[]),h.messageIDs.push(u.bytes());break;default:u.skipType(p&7);break}}return h},a.fromObject=function(u){if(u instanceof n.RPC.ControlIWant)return u;var f=new n.RPC.ControlIWant;if(u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");f.messageIDs=[];for(var d=0;d<u.messageIDs.length;++d)typeof u.messageIDs[d]=="string"?i.base64.decode(u.messageIDs[d],f.messageIDs[d]=i.newBuffer(i.base64.length(u.messageIDs[d])),0):u.messageIDs[d].length&&(f.messageIDs[d]=u.messageIDs[d])}return f},a.toObject=function(u,f){f||(f={});var d={};if((f.arrays||f.defaults)&&(d.messageIDs=[]),u.messageIDs&&u.messageIDs.length){d.messageIDs=[];for(var h=0;h<u.messageIDs.length;++h)d.messageIDs[h]=f.bytes===String?i.base64.encode(u.messageIDs[h],0,u.messageIDs[h].length):f.bytes===Array?Array.prototype.slice.call(u.messageIDs[h]):u.messageIDs[h]}return d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlGraft=function(){function a(u){if(u)for(var f=Object.keys(u),d=0;d<f.length;++d)u[f[d]]!=null&&(this[f[d]]=u[f[d]])}a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(f,d){return d||(d=t.create()),f.topicID!=null&&Object.hasOwnProperty.call(f,"topicID")&&d.uint32(10).string(f.topicID),d},a.decode=function(f,d){f instanceof e||(f=e.create(f));for(var h=d===void 0?f.len:f.pos+d,p=new n.RPC.ControlGraft;f.pos<h;){var y=f.uint32();switch(y>>>3){case 1:p.topicID=f.string();break;default:f.skipType(y&7);break}}return p},a.fromObject=function(f){if(f instanceof n.RPC.ControlGraft)return f;var d=new n.RPC.ControlGraft;return f.topicID!=null&&(d.topicID=String(f.topicID)),d},a.toObject=function(f,d){d||(d={});var h={};return f.topicID!=null&&f.hasOwnProperty("topicID")&&(h.topicID=f.topicID,d.oneofs&&(h._topicID="topicID")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlPrune=function(){function a(u){if(this.peers=[],u)for(var f=Object.keys(u),d=0;d<f.length;++d)u[f[d]]!=null&&(this[f[d]]=u[f[d]])}a.prototype.topicID=null,a.prototype.peers=i.emptyArray,a.prototype.backoff=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_backoff",{get:i.oneOfGetter(c=["backoff"]),set:i.oneOfSetter(c)}),a.encode=function(f,d){if(d||(d=t.create()),f.topicID!=null&&Object.hasOwnProperty.call(f,"topicID")&&d.uint32(10).string(f.topicID),f.peers!=null&&f.peers.length)for(var h=0;h<f.peers.length;++h)n.RPC.PeerInfo.encode(f.peers[h],d.uint32(18).fork()).ldelim();return f.backoff!=null&&Object.hasOwnProperty.call(f,"backoff")&&d.uint32(24).uint64(f.backoff),d},a.decode=function(f,d){f instanceof e||(f=e.create(f));for(var h=d===void 0?f.len:f.pos+d,p=new n.RPC.ControlPrune;f.pos<h;){var y=f.uint32();switch(y>>>3){case 1:p.topicID=f.string();break;case 2:p.peers&&p.peers.length||(p.peers=[]),p.peers.push(n.RPC.PeerInfo.decode(f,f.uint32()));break;case 3:p.backoff=f.uint64();break;default:f.skipType(y&7);break}}return p},a.fromObject=function(f){if(f instanceof n.RPC.ControlPrune)return f;var d=new n.RPC.ControlPrune;if(f.topicID!=null&&(d.topicID=String(f.topicID)),f.peers){if(!Array.isArray(f.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");d.peers=[];for(var h=0;h<f.peers.length;++h){if(typeof f.peers[h]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");d.peers[h]=n.RPC.PeerInfo.fromObject(f.peers[h])}}return f.backoff!=null&&(i.Long?(d.backoff=i.Long.fromValue(f.backoff)).unsigned=!0:typeof f.backoff=="string"?d.backoff=parseInt(f.backoff,10):typeof f.backoff=="number"?d.backoff=f.backoff:typeof f.backoff=="object"&&(d.backoff=new i.LongBits(f.backoff.low>>>0,f.backoff.high>>>0).toNumber(!0))),d},a.toObject=function(f,d){d||(d={});var h={};if((d.arrays||d.defaults)&&(h.peers=[]),f.topicID!=null&&f.hasOwnProperty("topicID")&&(h.topicID=f.topicID,d.oneofs&&(h._topicID="topicID")),f.peers&&f.peers.length){h.peers=[];for(var p=0;p<f.peers.length;++p)h.peers[p]=n.RPC.PeerInfo.toObject(f.peers[p],d)}return f.backoff!=null&&f.hasOwnProperty("backoff")&&(typeof f.backoff=="number"?h.backoff=d.longs===String?String(f.backoff):f.backoff:h.backoff=d.longs===String?i.Long.prototype.toString.call(f.backoff):d.longs===Number?new i.LongBits(f.backoff.low>>>0,f.backoff.high>>>0).toNumber(!0):f.backoff,d.oneofs&&(h._backoff="backoff")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.PeerInfo=function(){function a(u){if(u)for(var f=Object.keys(u),d=0;d<f.length;++d)u[f[d]]!=null&&(this[f[d]]=u[f[d]])}a.prototype.peerID=null,a.prototype.signedPeerRecord=null;var c;return Object.defineProperty(a.prototype,"_peerID",{get:i.oneOfGetter(c=["peerID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signedPeerRecord",{get:i.oneOfGetter(c=["signedPeerRecord"]),set:i.oneOfSetter(c)}),a.encode=function(f,d){return d||(d=t.create()),f.peerID!=null&&Object.hasOwnProperty.call(f,"peerID")&&d.uint32(10).bytes(f.peerID),f.signedPeerRecord!=null&&Object.hasOwnProperty.call(f,"signedPeerRecord")&&d.uint32(18).bytes(f.signedPeerRecord),d},a.decode=function(f,d){f instanceof e||(f=e.create(f));for(var h=d===void 0?f.len:f.pos+d,p=new n.RPC.PeerInfo;f.pos<h;){var y=f.uint32();switch(y>>>3){case 1:p.peerID=f.bytes();break;case 2:p.signedPeerRecord=f.bytes();break;default:f.skipType(y&7);break}}return p},a.fromObject=function(f){if(f instanceof n.RPC.PeerInfo)return f;var d=new n.RPC.PeerInfo;return f.peerID!=null&&(typeof f.peerID=="string"?i.base64.decode(f.peerID,d.peerID=i.newBuffer(i.base64.length(f.peerID)),0):f.peerID.length&&(d.peerID=f.peerID)),f.signedPeerRecord!=null&&(typeof f.signedPeerRecord=="string"?i.base64.decode(f.signedPeerRecord,d.signedPeerRecord=i.newBuffer(i.base64.length(f.signedPeerRecord)),0):f.signedPeerRecord.length&&(d.signedPeerRecord=f.signedPeerRecord)),d},a.toObject=function(f,d){d||(d={});var h={};return f.peerID!=null&&f.hasOwnProperty("peerID")&&(h.peerID=d.bytes===String?i.base64.encode(f.peerID,0,f.peerID.length):d.bytes===Array?Array.prototype.slice.call(f.peerID):f.peerID,d.oneofs&&(h._peerID="peerID")),f.signedPeerRecord!=null&&f.hasOwnProperty("signedPeerRecord")&&(h.signedPeerRecord=d.bytes===String?i.base64.encode(f.signedPeerRecord,0,f.signedPeerRecord.length):d.bytes===Array?Array.prototype.slice.call(f.signedPeerRecord):f.signedPeerRecord,d.oneofs&&(h._signedPeerRecord="signedPeerRecord")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s}(),n})});var UI=m(Ew=>{l();"use strict";Object.defineProperty(Ew,"__esModule",{value:!0});Ew.getGossipPeers=void 0;var une=a1();function vje(r,e,t,i=()=>!0){let n=r.topics.get(e);if(!n)return new Set;let s=[];return n.forEach(o=>{let a=r.peers.get(o);!a||une.hasGossipProtocol(a.protocol)&&i(o)&&s.push(o)}),s=une.shuffle(s),t>0&&s.length>t&&(s=s.slice(0,t)),new Set(s)}Ew.getGossipPeers=vje});var fne=m(mc=>{l();"use strict";var Eje=mc&&mc.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Sje=mc&&mc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Aje=mc&&mc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Eje(e,r,t);return Sje(e,r),e};Object.defineProperty(mc,"__esModule",{value:!0});mc.Heartbeat=void 0;var FI=Aje(rf()),Sw=UI(),Rje=a1(),lne=class{constructor(e){this.gossipsub=e}start(){if(this._heartbeatTimer)return;let e=this._heartbeat.bind(this),t=setTimeout(()=>{e(),this._heartbeatTimer.runPeriodically(e,this.gossipsub._options.heartbeatInterval)},FI.GossipsubHeartbeatInitialDelay);this._heartbeatTimer={_intervalId:void 0,runPeriodically:(i,n)=>{this._heartbeatTimer._intervalId=setInterval(i,n)},cancel:()=>{clearTimeout(t),clearInterval(this._heartbeatTimer._intervalId)}}}stop(){!this._heartbeatTimer||(this._heartbeatTimer.cancel(),this._heartbeatTimer=null)}_heartbeat(){let{D:e,Dlo:t,Dhi:i,Dscore:n,Dout:s,fanoutTTL:o}=this.gossipsub._options;this.gossipsub.heartbeatTicks++;let a=new Map,c=p=>{let y=a.get(p);return y===void 0&&(y=this.gossipsub.score.score(p),a.set(p,y)),y},u=new Map,f=new Map,d=new Map;this.gossipsub._clearBackoff(),this.gossipsub.peerhave.clear(),this.gossipsub.iasked.clear(),this.gossipsub._applyIwantPenalties(),this.gossipsub._directConnect(),this.gossipsub.mesh.forEach((p,y)=>{let g=b=>{this.gossipsub.log("HEARTBEAT: Remove mesh link to %s in %s",b,y),this.gossipsub.score.prune(b,y),this.gossipsub._addBackoff(b,y),p.delete(b);let v=f.get(b);v?v.push(y):f.set(b,[y])},w=b=>{this.gossipsub.log("HEARTBEAT: Add mesh link to %s in %s",b,y),this.gossipsub.score.graft(b,y),p.add(b);let v=u.get(b);v?v.push(y):u.set(b,[y])};if(p.forEach(b=>{let v=c(b);v<0&&(this.gossipsub.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",b,v,y),g(b),d.set(b,!0))}),p.size<t){let b=this.gossipsub.backoff.get(y),v=e-p.size;Sw.getGossipPeers(this.gossipsub,y,v,k=>!p.has(k)&&!this.gossipsub.direct.has(k)&&(!b||!b.has(k))&&c(k)>=0).forEach(w)}if(p.size>i){let b=Array.from(p);b.sort((R,k)=>c(k)-c(R)),b=b.slice(0,n).concat(Rje.shuffle(b.slice(n)));let v=0;if(b.slice(0,e).forEach(R=>{this.gossipsub.outbound.get(R)&&v++}),v<s){let R=C=>{let T=b[C];for(let D=C;D>0;D--)b[D]=b[D-1];b[0]=T};if(v>0){let C=v;for(let T=1;T<e&&C>0;T++)this.gossipsub.outbound.get(b[T])&&(R(T),C--)}let k=e-v;for(let C=e;C<b.length&&k>0;C++)this.gossipsub.outbound.get(b[C])&&(R(C),k--)}b.slice(e).forEach(g)}if(p.size>=t){let b=0;if(p.forEach(v=>{this.gossipsub.outbound.get(v)&&b++}),b<s){let v=s-b,R=this.gossipsub.backoff.get(y);Sw.getGossipPeers(this.gossipsub,y,v,k=>!p.has(k)&&!this.gossipsub.direct.has(k)&&(!R||!R.has(k))&&c(k)>=0).forEach(w)}}if(this.gossipsub.heartbeatTicks%FI.GossipsubOpportunisticGraftTicks==0&&p.size>1){let b=Array.from(p).sort((k,C)=>c(k)-c(C)),v=Math.floor(p.size/2),R=c(b[v]);if(R<this.gossipsub._options.scoreThresholds.opportunisticGraftThreshold){let k=this.gossipsub.backoff.get(y);Sw.getGossipPeers(this.gossipsub,y,FI.GossipsubOpportunisticGraftPeers,T=>p.has(T)&&!this.gossipsub.direct.has(T)&&(!k||!k.has(T))&&c(T)>R).forEach(T=>{this.gossipsub.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",T,y),w(T)})}}this.gossipsub._emitGossip(y,p)});let h=this.gossipsub._now();this.gossipsub.lastpub.forEach((p,y)=>{p+o<h&&(this.gossipsub.fanout.delete(y),this.gossipsub.lastpub.delete(y))}),this.gossipsub.fanout.forEach((p,y)=>{let g=this.gossipsub.topics.get(y);if(p.forEach(w=>{(!g.has(w)||c(w)<this.gossipsub._options.scoreThresholds.publishThreshold)&&p.delete(w)}),p.size<e){let w=e-p.size;Sw.getGossipPeers(this.gossipsub,y,w,v=>!p.has(v)&&!this.gossipsub.direct.has(v)&&c(v)>=this.gossipsub._options.scoreThresholds.publishThreshold).forEach(v=>{p.add(v)})}this.gossipsub._emitGossip(y,p)}),this.gossipsub._sendGraftPrune(u,f,d),this.gossipsub._flush(),this.gossipsub.messageCache.shift(),this.gossipsub.emit("gossipsub:heartbeat")}};mc.Heartbeat=lne});var KI=m(u1=>{l();"use strict";Object.defineProperty(u1,"__esModule",{value:!0});u1.ERR_INVALID_PEER_SCORE_THRESHOLDS=u1.ERR_INVALID_PEER_SCORE_PARAMS=void 0;u1.ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS";u1.ERR_INVALID_PEER_SCORE_THRESHOLDS="ERR_INVALID_PEER_SCORE_THRESHOLDS"});var VI=m((S_t,hne)=>{l();"use strict";function dne(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function xje(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return dne(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),dne(new n,t)}}hne.exports=xje});var zI=m(vn=>{l();"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.validateTopicScoreParams=vn.validatePeerScoreParams=vn.createTopicScoreParams=vn.createPeerScoreParams=vn.defaultTopicScoreParams=vn.defaultPeerScoreParams=void 0;var gr=KI(),mr=VI();vn.defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3};vn.defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function Ije(r={}){return Object.assign(Object.assign(Object.assign({},vn.defaultPeerScoreParams),r),{topics:r.topics?Object.entries(r.topics).reduce((e,[t,i])=>(e[t]=pne(i),e),{}):{}})}vn.createPeerScoreParams=Ije;function pne(r={}){return Object.assign(Object.assign({},vn.defaultTopicScoreParams),r)}vn.createTopicScoreParams=pne;function Tje(r){for(let[e,t]of Object.entries(r.topics))try{yne(t)}catch(i){throw mr(new Error(`invalid score parameters for topic ${e}: ${i.message}`),gr.ERR_INVALID_PEER_SCORE_PARAMS)}if(r.topicScoreCap<0)throw mr(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.appSpecificScore===null||r.appSpecificScore===void 0)throw mr(new Error("missing application specific score function"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.IPColocationFactorWeight>0)throw mr(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.IPColocationFactorWeight!==0&&r.IPColocationFactorThreshold<1)throw mr(new Error("invalid IPColocationFactorThreshold; must be at least 1"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.behaviourPenaltyWeight>0)throw mr(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.behaviourPenaltyWeight!==0&&(r.behaviourPenaltyDecay<=0||r.behaviourPenaltyDecay>=1))throw mr(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.decayInterval<1e3)throw mr(new Error("invalid DecayInterval; must be at least 1s"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.decayToZero<=0||r.decayToZero>=1)throw mr(new Error("invalid DecayToZero; must be between 0 and 1"),gr.ERR_INVALID_PEER_SCORE_PARAMS)}vn.validatePeerScoreParams=Tje;function yne(r){if(r.topicWeight<0)throw mr(new Error("invalid topic weight; must be >= 0"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshQuantum===0)throw mr(new Error("invalid TimeInMeshQuantum; must be non zero"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshWeight<0)throw mr(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshWeight!==0&&r.timeInMeshQuantum<=0)throw mr(new Error("invalid TimeInMeshQuantum; must be positive"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshWeight!==0&&r.timeInMeshCap<=0)throw mr(new Error("invalid TimeInMeshCap; must be positive"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.firstMessageDeliveriesWeight<0)throw mr(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.firstMessageDeliveriesWeight!==0&&(r.firstMessageDeliveriesDecay<=0||r.firstMessageDeliveriesDecay>=1))throw mr(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.firstMessageDeliveriesWeight!==0&&r.firstMessageDeliveriesCap<=0)throw mr(new Error("invalid FirstMessageDeliveriesCap; must be positive"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight>0)throw mr(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&(r.meshMessageDeliveriesDecay<=0||r.meshMessageDeliveriesDecay>=1))throw mr(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&r.meshMessageDeliveriesCap<=0)throw mr(new Error("invalid MeshMessageDeliveriesCap; must be positive"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&r.meshMessageDeliveriesThreshold<=0)throw mr(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWindow<0)throw mr(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&r.meshMessageDeliveriesActivation<1e3)throw mr(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshFailurePenaltyWeight>0)throw mr(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshFailurePenaltyWeight!==0&&(r.meshFailurePenaltyDecay<=0||r.meshFailurePenaltyDecay>=1))throw mr(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.invalidMessageDeliveriesWeight>0)throw mr(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),gr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.invalidMessageDeliveriesDecay<=0||r.invalidMessageDeliveriesDecay>=1)throw mr(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),gr.ERR_INVALID_PEER_SCORE_PARAMS)}vn.validateTopicScoreParams=yne});var gne=m(vu=>{l();"use strict";Object.defineProperty(vu,"__esModule",{value:!0});vu.validatePeerScoreThresholds=vu.createPeerScoreThresholds=vu.defaultPeerScoreThresholds=void 0;var om=KI(),am=VI();vu.defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function Pje(r={}){return Object.assign(Object.assign({},vu.defaultPeerScoreThresholds),r)}vu.createPeerScoreThresholds=Pje;function Cje(r){if(r.gossipThreshold>0)throw am(new Error("invalid gossip threshold; it must be <= 0"),om.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.publishThreshold>0||r.publishThreshold>r.gossipThreshold)throw am(new Error("invalid publish threshold; it must be <= 0 and <= gossip threshold"),om.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.graylistThreshold>0||r.graylistThreshold>r.publishThreshold)throw am(new Error("invalid graylist threshold; it must be <= 0 and <= publish threshold"),om.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.acceptPXThreshold<0)throw am(new Error("invalid accept PX threshold; it must be >= 0"),om.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.opportunisticGraftThreshold<0)throw am(new Error("invalid opportunistic grafting threshold; it must be >= 0"),om.ERR_INVALID_PEER_SCORE_THRESHOLDS)}vu.validatePeerScoreThresholds=Cje});var mne=m(nf=>{l();"use strict";Object.defineProperty(nf,"__esModule",{value:!0});nf.ensureTopicStats=nf.createTopicStats=nf.createPeerStats=void 0;function Oje(r={}){return Object.assign(Object.assign({connected:!1,expire:0,ips:[],behaviourPenalty:0},r),{topics:r.topics?Object.entries(r.topics).reduce((e,[t,i])=>(e[t]=HI(i),e),{}):{}})}nf.createPeerStats=Oje;function HI(r={}){return Object.assign({inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},r)}nf.createTopicStats=HI;function kje(r,e,t){let i=e.topics[r];if(i)return i;if(!!t.topics[r])return e.topics[r]=i=HI(),i}nf.ensureTopicStats=kje});var bne=m(Aw=>{l();"use strict";Object.defineProperty(Aw,"__esModule",{value:!0});Aw.computeScore=void 0;function Dje(r,e,t,i){let n=0;return Object.entries(e.topics).forEach(([a,c])=>{let u=t.topics[a];if(!u)return;let f=0;if(c.inMesh){let y=c.meshTime/u.timeInMeshQuantum;y>u.timeInMeshCap&&(y=u.timeInMeshCap),f+=y*u.timeInMeshWeight}if(f+=c.firstMessageDeliveries*u.firstMessageDeliveriesWeight,c.meshMessageDeliveriesActive&&c.meshMessageDeliveries<u.meshMessageDeliveriesThreshold){let y=u.meshMessageDeliveriesThreshold-c.meshMessageDeliveries;f+=y*y*u.meshMessageDeliveriesWeight}f+=c.meshFailurePenalty*u.meshFailurePenaltyWeight,f+=c.invalidMessageDeliveries*c.invalidMessageDeliveries*u.invalidMessageDeliveriesWeight,n+=f*u.topicWeight}),t.topicScoreCap>0&&n>t.topicScoreCap&&(n=t.topicScoreCap),n+=t.appSpecificScore(r)*t.appSpecificWeight,e.ips.forEach(a=>{if(t.IPColocationFactorWhitelist.has(a))return;let c=i.get(a),u=c?c.size:0;if(u>t.IPColocationFactorThreshold){let f=u-t.IPColocationFactorThreshold;n+=f*f*t.IPColocationFactorWeight}}),n+=e.behaviourPenalty*e.behaviourPenalty*t.behaviourPenaltyWeight,n}Aw.computeScore=Dje});var _ne=m((T_t,wne)=>{l();"use strict";function ri(r,e){var e=e||{};this._head=0,this._tail=0,this._capacity=e.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(r)&&this._fromArray(r)}ri.prototype.peekAt=function(e){var t=e;if(t===(t|0)){var i=this.size();if(!(t>=i||t<-i))return t<0&&(t+=i),t=this._head+t&this._capacityMask,this._list[t]}};ri.prototype.get=function(e){return this.peekAt(e)};ri.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};ri.prototype.peekFront=function(){return this.peek()};ri.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(ri.prototype,"length",{get:function(){return this.size()}});ri.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};ri.prototype.unshift=function(e){if(e===void 0)return this.size();var t=this._list.length;return this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};ri.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}};ri.prototype.push=function(e){if(e===void 0)return this.size();var t=this._tail;return this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};ri.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var i=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),i}};ri.prototype.removeOne=function(e){var t=e;if(t===(t|0)&&this._head!==this._tail){var i=this.size(),n=this._list.length;if(!(t>=i||t<-i)){t<0&&(t+=i),t=this._head+t&this._capacityMask;var s=this._list[t],o;if(e<i/2){for(o=e;o>0;o--)this._list[t]=this._list[t=t-1+n&this._capacityMask];this._list[t]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(o=i-1-e;o>0;o--)this._list[t]=this._list[t=t+1+n&this._capacityMask];this._list[t]=void 0,this._tail=this._tail-1+n&this._capacityMask}return s}}};ri.prototype.remove=function(e,t){var i=e,n,s=t;if(i===(i|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(i>=o||i<-o||t<1)){if(i<0&&(i+=o),t===1||!t)return n=new Array(1),n[0]=this.removeOne(i),n;if(i===0&&i+t>=o)return n=this.toArray(),this.clear(),n;i+t>o&&(t=o-i);var c;for(n=new Array(t),c=0;c<t;c++)n[c]=this._list[this._head+i+c&this._capacityMask];if(i=this._head+i&this._capacityMask,e+t===o){for(this._tail=this._tail-t+a&this._capacityMask,c=t;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(e===0){for(this._head=this._head+t+a&this._capacityMask,c=t-1;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(i<o/2){for(this._head=this._head+e+t+a&this._capacityMask,c=e;c>0;c--)this.unshift(this._list[i=i-1+a&this._capacityMask]);for(i=this._head-1+a&this._capacityMask;s>0;)this._list[i=i-1+a&this._capacityMask]=void 0,s--;e<0&&(this._tail=i)}else{for(this._tail=i,i=i+t+a&this._capacityMask,c=o-(t+e);c>0;c--)this.push(this._list[i++]);for(i=this._tail;s>0;)this._list[i=i+1+a&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),n}}};ri.prototype.splice=function(e,t){var i=e;if(i===(i|0)){var n=this.size();if(i<0&&(i+=n),!(i>n))if(arguments.length>2){var s,o,a,c=arguments.length,u=this._list.length,f=2;if(!n||i<n/2){for(o=new Array(i),s=0;s<i;s++)o[s]=this._list[this._head+s&this._capacityMask];for(t===0?(a=[],i>0&&(this._head=this._head+i+u&this._capacityMask)):(a=this.remove(i,t),this._head=this._head+i+u&this._capacityMask);c>f;)this.unshift(arguments[--c]);for(s=i;s>0;s--)this.unshift(o[s-1])}else{o=new Array(n-(i+t));var d=o.length;for(s=0;s<d;s++)o[s]=this._list[this._head+i+t+s&this._capacityMask];for(t===0?(a=[],i!=n&&(this._tail=this._head+i+u&this._capacityMask)):(a=this.remove(i,t),this._tail=this._tail-d+u&this._capacityMask);f<c;)this.push(arguments[f++]);for(s=0;s<d;s++)this.push(o[s])}return a}else return this.remove(i,t)}};ri.prototype.clear=function(){this._head=0,this._tail=0};ri.prototype.isEmpty=function(){return this._head===this._tail};ri.prototype.toArray=function(){return this._copyArray(!1)};ri.prototype._fromArray=function(e){for(var t=0;t<e.length;t++)this.push(e[t])};ri.prototype._copyArray=function(e){var t=[],i=this._list,n=i.length,s;if(e||this._head>this._tail){for(s=this._head;s<n;s++)t.push(i[s]);for(s=0;s<this._tail;s++)t.push(i[s])}else for(s=this._head;s<this._tail;s++)t.push(i[s]);return t};ri.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1};ri.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};wne.exports=ri});var Sne=m(Eu=>{l();"use strict";var Nje=Eu&&Eu.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Eu,"__esModule",{value:!0});Eu.MessageDeliveries=Eu.DeliveryRecordStatus=void 0;var Bje=rf(),Lje=Nje(_ne()),vne;(function(r){r[r.unknown=0]="unknown",r[r.valid=1]="valid",r[r.invalid=2]="invalid",r[r.ignored=3]="ignored"})(vne=Eu.DeliveryRecordStatus||(Eu.DeliveryRecordStatus={}));var Ene=class{constructor(){this.records=new Map,this.queue=new Lje.default}ensureRecord(e){let t=this.records.get(e);if(t)return t;t={status:vne.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(e,t);let i={msgId:e,expire:Date.now()+Bje.TimeCacheDuration};return this.queue.push(i),t}gc(){let e=Date.now(),t=this.queue.peekFront();for(;t&&t.expire<e;)this.records.delete(t.msgId),this.queue.shift(),t=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};Eu.MessageDeliveries=Ene});var Rne=m(sf=>{l();"use strict";var Rw=sf&&sf.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(f){try{u(i.next(f))}catch(d){o(d)}}function c(f){try{u(i.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):n(f.value).then(a,c)}u((i=i.apply(r,e||[])).next())})},Mje=sf&&sf.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(sf,"__esModule",{value:!0});sf.PeerScore=void 0;var jje=zI(),l1=mne(),qje=bne(),ha=Sne(),Uje=rf(),Fje=Mje(st()),Kje=le(),Vje=hw(),{ERR_INVALID_SIGNATURE:zje,ERR_MISSING_SIGNATURE:Hje}=Vje.codes,f1=Kje("libp2p:gossipsub:score"),Ane=class{constructor(e,t){jje.validatePeerScoreParams(e),this.params=e,this._connectionManager=t,this.peerStats=new Map,this.peerIPs=new Map,this.scoreCache=new Map,this.deliveryRecords=new ha.MessageDeliveries}start(){if(this._backgroundInterval){f1("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),f1("started")}stop(){if(!this._backgroundInterval){f1("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),f1("stopped")}background(){this._refreshScores(),this._updateIPs(),this.deliveryRecords.gc()}_refreshScores(){let e=Date.now(),t=this.params.decayToZero;this.peerStats.forEach((i,n)=>{if(!i.connected){e>i.expire&&(this._removeIPs(n,i.ips),this.peerStats.delete(n));return}Object.entries(i.topics).forEach(([s,o])=>{let a=this.params.topics[s];!a||(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<t&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<t&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<t&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<t&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),i.behaviourPenalty*=this.params.behaviourPenaltyDecay,i.behaviourPenalty<t&&(i.behaviourPenalty=0),this.scoreCache.set(n,{score:null,cacheUntil:0})})}score(e){let t=this.peerStats.get(e);if(!t)return 0;let i=Date.now(),n=this.scoreCache.get(e);n===void 0&&(n={score:null,cacheUntil:0},this.scoreCache.set(e,n));let{score:s,cacheUntil:o}=n;return o>i&&s!==null?s:(n.score=qje.computeScore(e,t,this.params,this.peerIPs),n.cacheUntil=i+this.params.decayInterval,n.score)}addPenalty(e,t){let i=this.peerStats.get(e);!i||(i.behaviourPenalty+=t,this.scoreCache.set(e,{score:null,cacheUntil:0}))}addPeer(e){let t=l1.createPeerStats({connected:!0});this.peerStats.set(e,t);let i=this._getIPs(e);this._setIPs(e,i,t.ips),t.ips=i}removePeer(e){let t=this.peerStats.get(e);if(!!t){if(this.score(e)>0){this._removeIPs(e,t.ips),this.peerStats.delete(e);return}this.scoreCache.delete(e),Object.entries(t.topics).forEach(([i,n])=>{n.firstMessageDeliveries=0;let s=this.params.topics[i].meshMessageDeliveriesThreshold;if(n.inMesh&&n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1}),t.connected=!1,t.expire=Date.now()+this.params.retainScore}}graft(e,t){let i=this.peerStats.get(e);if(!i)return;let n=l1.ensureTopicStats(t,i,this.params);!n||(n.inMesh=!0,n.graftTime=Date.now(),n.meshTime=0,n.meshMessageDeliveriesActive=!1,this.scoreCache.set(e,{score:null,cacheUntil:0}))}prune(e,t){let i=this.peerStats.get(e);if(!i)return;let n=l1.ensureTopicStats(t,i,this.params);if(!n)return;let s=this.params.topics[t].meshMessageDeliveriesThreshold;if(n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1,this.scoreCache.set(e,{score:null,cacheUntil:0})}validateMessage(e){return Rw(this,void 0,void 0,function*(){this.deliveryRecords.ensureRecord(e)})}deliverMessage(e,t){return Rw(this,void 0,void 0,function*(){let i=e.receivedFrom;this._markFirstMessageDelivery(i,e);let n=this.deliveryRecords.ensureRecord(t),s=Date.now();if(n.status!==ha.DeliveryRecordStatus.unknown){f1("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",i,s-n.firstSeen,ha.DeliveryRecordStatus[n.status]);return}n.status=ha.DeliveryRecordStatus.valid,n.validated=s,n.peers.forEach(o=>{o!==i&&this._markDuplicateMessageDelivery(o,e)})})}rejectMessage(e,t,i){return Rw(this,void 0,void 0,function*(){let n=e.receivedFrom;switch(i){case Hje:case zje:this._markInvalidMessageDelivery(n,e);return}let s=this.deliveryRecords.ensureRecord(t);if(s.status!==ha.DeliveryRecordStatus.unknown){f1("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",n,Date.now()-s.firstSeen,ha.DeliveryRecordStatus[s.status]);return}switch(i){case Uje.ERR_TOPIC_VALIDATOR_IGNORE:s.status=ha.DeliveryRecordStatus.ignored;return}s.status=ha.DeliveryRecordStatus.invalid,this._markInvalidMessageDelivery(n,e),s.peers.forEach(o=>{this._markInvalidMessageDelivery(o,e)})})}duplicateMessage(e,t){return Rw(this,void 0,void 0,function*(){let i=e.receivedFrom,n=this.deliveryRecords.ensureRecord(t);if(!n.peers.has(i))switch(n.status){case ha.DeliveryRecordStatus.unknown:n.peers.add(i);break;case ha.DeliveryRecordStatus.valid:n.peers.add(i),this._markDuplicateMessageDelivery(i,e,n.validated);break;case ha.DeliveryRecordStatus.invalid:this._markInvalidMessageDelivery(i,e);break}})}_markInvalidMessageDelivery(e,t){let i=this.peerStats.get(e);!i||(t.topicIDs.forEach(n=>{let s=l1.ensureTopicStats(n,i,this.params);!s||(s.invalidMessageDeliveries+=1)}),this.scoreCache.set(e,{score:null,cacheUntil:0}))}_markFirstMessageDelivery(e,t){let i=this.peerStats.get(e);!i||(t.topicIDs.forEach(n=>{let s=l1.ensureTopicStats(n,i,this.params);if(!s)return;let o=this.params.topics[n].firstMessageDeliveriesCap;s.firstMessageDeliveries+=1,s.firstMessageDeliveries>o&&(s.firstMessageDeliveries=o),!!s.inMesh&&(o=this.params.topics[n].meshMessageDeliveriesCap,s.meshMessageDeliveries+=1,s.meshMessageDeliveries>o&&(s.meshMessageDeliveries=o))}),this.scoreCache.set(e,{score:null,cacheUntil:0}))}_markDuplicateMessageDelivery(e,t,i=0){let n=this.peerStats.get(e);if(!n)return;let s=i?Date.now():0;t.topicIDs.forEach(o=>{let a=l1.ensureTopicStats(o,n,this.params);if(!a||!a.inMesh)return;let c=this.params.topics[o];if(i&&s>i+c.meshMessageDeliveriesWindow)return;let u=c.meshMessageDeliveriesCap;a.meshMessageDeliveries+=1,a.meshMessageDeliveries>u&&(a.meshMessageDeliveries=u)}),this.scoreCache.set(e,{score:null,cacheUntil:0})}_getIPs(e){return this._connectionManager.getAll(Fje.default.createFromB58String(e)).map(t=>t.remoteAddr.toOptions().host)}_setIPs(e,t,i){e:for(let n of t){for(let o of i)if(n===o)continue e;let s=this.peerIPs.get(n);s||(s=new Set,this.peerIPs.set(n,s)),s.add(e)}e:for(let n of i){for(let o of t)if(n===o)continue e;let s=this.peerIPs.get(n);!s||(s.delete(e),s.size||this.peerIPs.delete(n))}this.scoreCache.set(e,{score:null,cacheUntil:0})}_removeIPs(e,t){t.forEach(i=>{let n=this.peerIPs.get(i);!n||(n.delete(e),n.size||this.peerIPs.delete(i))}),this.scoreCache.set(e,{score:null,cacheUntil:0})}_updateIPs(){this.peerStats.forEach((e,t)=>{let i=this._getIPs(t);this._setIPs(t,i,e.ips),e.ips=i,this.scoreCache.set(t,{score:null,cacheUntil:0})})}};sf.PeerScore=Ane});var xne=m(Su=>{l();"use strict";var $je=Su&&Su.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),$I=Su&&Su.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&$je(e,r,t)};Object.defineProperty(Su,"__esModule",{value:!0});$I(zI(),Su);$I(gne(),Su);$I(Rne(),Su)});var Pne=m(d1=>{l();"use strict";var Ine=d1&&d1.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(f){try{u(i.next(f))}catch(d){o(d)}}function c(f){try{u(i.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):n(f.value).then(a,c)}u((i=i.apply(r,e||[])).next())})};Object.defineProperty(d1,"__esModule",{value:!0});d1.IWantTracer=void 0;var Gje=rf(),Wje=a1(),Yje=hw(),{ERR_INVALID_SIGNATURE:Xje,ERR_MISSING_SIGNATURE:Qje}=Yje.codes,Tne=class{constructor(){this.promises=new Map}addPromise(e,t){let i=Math.floor(Math.random()*t.length),n=t[i],s=Wje.messageIdToString(n),o=this.promises.get(s);o||(o=new Map,this.promises.set(s,o)),o.has(e)||o.set(e,Date.now()+Gje.GossipsubIWantFollowupTime)}getBrokenPromises(){let e=Date.now(),t=new Map;return this.promises.forEach((i,n)=>{i.forEach((s,o)=>{s<e&&(t.set(o,(t.get(o)||0)+1),i.delete(o))}),i.size||this.promises.delete(n)}),t}deliverMessage(e){return Ine(this,void 0,void 0,function*(){this.promises.delete(e)})}rejectMessage(e,t){return Ine(this,void 0,void 0,function*(){switch(t){case Xje:case Qje:return}this.promises.delete(e)})}clear(){this.promises.clear()}};d1.IWantTracer=Tne});var One=m(xw=>{l();"use strict";Object.defineProperty(xw,"__esModule",{value:!0});xw.SimpleTimeCache=void 0;var Cne=class{constructor(e){this.lastPruneTime=0,this.entries=new Map,this.validityMs=e.validityMs}put(e,t){this.entries.set(e,{value:t,validUntilMs:Date.now()+this.validityMs}),this.prune()}prune(){let e=Date.now();if(!(e-this.lastPruneTime<200)){this.lastPruneTime=e;for(let[t,i]of this.entries.entries())if(i.validUntilMs<e)this.entries.delete(t);else break}}has(e){return this.entries.has(e)}get(e){let t=this.entries.get(e);return t&&t.validUntilMs>=Date.now()?t.value:void 0}clear(){this.entries=new Map,this.lastPruneTime=0}};xw.SimpleTimeCache=Cne});var br=m((N_t,Dne)=>{l();"use strict";function kne(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function Zje(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return kne(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),kne(new n,t)}}Dne.exports=Zje});var wr=m(GI=>{l();"use strict";GI.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required",NOT_FOUND:"Not found"};GI.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_PEER_DIAL_INTERCEPTED:"ERR_PEER_DIAL_INTERCEPTED",ERR_CONNECTION_INTERCEPTED:"ERR_CONNECTION_INTERCEPTED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_TOO_MANY_ADDRESSES:"ERR_TOO_MANY_ADDRESSES",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_NOT_FOUND:"ERR_NOT_FOUND",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID",ERR_FIND_SELF:"ERR_FIND_SELF",ERR_NO_ROUTERS_AVAILABLE:"ERR_NO_ROUTERS_AVAILABLE",ERR_CONNECTION_NOT_MULTIPLEXED:"ERR_CONNECTION_NOT_MULTIPLEXED",ERR_NO_DIAL_TOKENS:"ERR_NO_DIAL_TOKENS",ERR_KEYCHAIN_REQUIRED:"ERR_KEYCHAIN_REQUIRED",ERR_INVALID_CMS:"ERR_INVALID_CMS",ERR_MISSING_KEYS:"ERR_MISSING_KEYS",ERR_NO_KEY:"ERR_NO_KEY",ERR_INVALID_KEY_NAME:"ERR_INVALID_KEY_NAME",ERR_INVALID_KEY_TYPE:"ERR_INVALID_KEY_TYPE",ERR_KEY_ALREADY_EXISTS:"ERR_KEY_ALREADY_EXISTS",ERR_INVALID_KEY_SIZE:"ERR_INVALID_KEY_SIZE",ERR_KEY_NOT_FOUND:"ERR_KEY_NOT_FOUND",ERR_OLD_KEY_NAME_INVALID:"ERR_OLD_KEY_NAME_INVALID",ERR_NEW_KEY_NAME_INVALID:"ERR_NEW_KEY_NAME_INVALID",ERR_PASSWORD_REQUIRED:"ERR_PASSWORD_REQUIRED",ERR_PEM_REQUIRED:"ERR_PEM_REQUIRED",ERR_CANNOT_READ_KEY:"ERR_CANNOT_READ_KEY",ERR_MISSING_PRIVATE_KEY:"ERR_MISSING_PRIVATE_KEY",ERR_INVALID_OLD_PASS_TYPE:"ERR_INVALID_OLD_PASS_TYPE",ERR_INVALID_NEW_PASS_TYPE:"ERR_INVALID_NEW_PASS_TYPE",ERR_INVALID_PASS_LENGTH:"ERR_INVALID_PASS_LENGTH",ERR_NOT_IMPLEMENTED:"ERR_NOT_IMPLEMENTED",ERR_WRONG_PING_ACK:"ERR_WRONG_PING_ACK"}});var Lne=m((L_t,Bne)=>{l();"use strict";var h1=Br(),Nne=h1.Reader,Jje=h1.Writer,zr=h1.util,cm=h1.roots["libp2p-envelope"]||(h1.roots["libp2p-envelope"]={});cm.Envelope=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.publicKey=zr.newBuffer([]),r.prototype.payloadType=zr.newBuffer([]),r.prototype.payload=zr.newBuffer([]),r.prototype.signature=zr.newBuffer([]),r.encode=function(t,i){return i||(i=Jje.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&i.uint32(10).bytes(t.publicKey),t.payloadType!=null&&Object.hasOwnProperty.call(t,"payloadType")&&i.uint32(18).bytes(t.payloadType),t.payload!=null&&Object.hasOwnProperty.call(t,"payload")&&i.uint32(26).bytes(t.payload),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&i.uint32(42).bytes(t.signature),i},r.decode=function(t,i){t instanceof Nne||(t=Nne.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new cm.Envelope;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.publicKey=t.bytes();break;case 2:s.payloadType=t.bytes();break;case 3:s.payload=t.bytes();break;case 5:s.signature=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof cm.Envelope)return t;var i=new cm.Envelope;return t.publicKey!=null&&(typeof t.publicKey=="string"?zr.base64.decode(t.publicKey,i.publicKey=zr.newBuffer(zr.base64.length(t.publicKey)),0):t.publicKey.length&&(i.publicKey=t.publicKey)),t.payloadType!=null&&(typeof t.payloadType=="string"?zr.base64.decode(t.payloadType,i.payloadType=zr.newBuffer(zr.base64.length(t.payloadType)),0):t.payloadType.length&&(i.payloadType=t.payloadType)),t.payload!=null&&(typeof t.payload=="string"?zr.base64.decode(t.payload,i.payload=zr.newBuffer(zr.base64.length(t.payload)),0):t.payload.length&&(i.payload=t.payload)),t.signature!=null&&(typeof t.signature=="string"?zr.base64.decode(t.signature,i.signature=zr.newBuffer(zr.base64.length(t.signature)),0):t.signature.length&&(i.signature=t.signature)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=zr.newBuffer(n.publicKey))),i.bytes===String?n.payloadType="":(n.payloadType=[],i.bytes!==Array&&(n.payloadType=zr.newBuffer(n.payloadType))),i.bytes===String?n.payload="":(n.payload=[],i.bytes!==Array&&(n.payload=zr.newBuffer(n.payload))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=zr.newBuffer(n.signature)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?zr.base64.encode(t.publicKey,0,t.publicKey.length):i.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.payloadType!=null&&t.hasOwnProperty("payloadType")&&(n.payloadType=i.bytes===String?zr.base64.encode(t.payloadType,0,t.payloadType.length):i.bytes===Array?Array.prototype.slice.call(t.payloadType):t.payloadType),t.payload!=null&&t.hasOwnProperty("payload")&&(n.payload=i.bytes===String?zr.base64.encode(t.payload,0,t.payload.length):i.bytes===Array?Array.prototype.slice.call(t.payload):t.payload),t.signature!=null&&t.hasOwnProperty("signature")&&(n.signature=i.bytes===String?zr.base64.encode(t.signature,0,t.signature.length):i.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,h1.util.toJSONOptions)},r}();Bne.exports=cm});var um=m((M_t,qne)=>{l();"use strict";var eqe=br(),{concat:tqe}=(Ri(),Cn),{fromString:rqe}=(at(),Xr),iqe=ub(),nqe=st(),WI=Xn(),{equals:Iw}=(hi(),hn),{codes:sqe}=wr(),{Envelope:Mne}=Lne(),of=class{constructor({peerId:e,payloadType:t,payload:i,signature:n}){this.peerId=e,this.payloadType=t,this.payload=i,this.signature=n,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;let e=iqe.marshalPublicKey(this.peerId.pubKey);return this._marshal=Mne.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return Iw(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&Iw(this.payloadType,e.payloadType)&&Iw(this.payload,e.payload)&&Iw(this.signature,e.signature)}validate(e){let t=jne(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(t,this.signature)}},jne=(r,e,t)=>{let i=rqe(r),n=WI.encode(i.byteLength),s=WI.encode(e.length),o=WI.encode(t.length);return tqe([new Uint8Array(n),i,new Uint8Array(s),e,new Uint8Array(o),t])};of.createFromProtobuf=async r=>{let e=Mne.decode(r),t=await nqe.createFromPubKey(e.publicKey);return new of({peerId:t,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};of.seal=async(r,e)=>{let t=r.domain,i=r.codec,n=r.marshal(),s=jne(t,i,n),o=await e.privKey.sign(s);return new of({peerId:e,payloadType:i,payload:n,signature:o})};of.openAndCertify=async(r,e)=>{let t=await of.createFromProtobuf(r);if(!await t.validate(e))throw eqe(new Error("envelope signature is not valid for the given domain"),sqe.ERR_SIGNATURE_NOT_VALID);return t};qne.exports=of});var tT=m((Au,Kne)=>{l();"use strict";var oqe=Au&&Au.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),aqe=Au&&Au.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Une=Au&&Au.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&oqe(e,r,t);return aqe(e,r),e},Un=Au&&Au.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(f){try{u(i.next(f))}catch(d){o(d)}}function c(f){try{u(i.throw(f))}catch(d){o(d)}}function u(f){f.done?s(f.value):n(f.value).then(a,c)}u((i=i.apply(r,e||[])).next())})},YI=Une(Jie()),cqe=one(),XI=cne(),kt=Une(rf()),uqe=fne(),Tw=UI(),Pi=a1(),QI=xne(),lqe=Pne(),Fne=One(),ZI=st(),fqe=um(),JI=rf(),eT=class extends YI.default{constructor(e,t={}){var i;let n=[kt.GossipsubIDv11,kt.GossipsubIDv10],s=Object.assign(Object.assign({gossipIncoming:!0,fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:kt.GossipsubD,Dlo:kt.GossipsubDlo,Dhi:kt.GossipsubDhi,Dscore:kt.GossipsubDscore,Dout:kt.GossipsubDout,Dlazy:kt.GossipsubDlazy,heartbeatInterval:kt.GossipsubHeartbeatInterval,fanoutTTL:kt.GossipsubFanoutTTL,mcacheLength:kt.GossipsubHistoryLength,mcacheGossip:kt.GossipsubHistoryGossip,seenTTL:kt.GossipsubSeenTTL},t),{scoreParams:QI.createPeerScoreParams(t.scoreParams),scoreThresholds:QI.createPeerScoreThresholds(t.scoreThresholds)});s.fallbackToFloodsub&&n.push(kt.FloodsubID);super(Object.assign({debugName:"libp2p:gossipsub",multicodecs:n,libp2p:e},s));this._options=s,this.direct=new Set(s.directPeers.map(o=>o.id.toB58String())),this.acceptFromWhitelist=new Map,s.directPeers.forEach(o=>{e.peerStore.addressBook.add(o.id,o.addrs)}),this.seenCache=new Fne.SimpleTimeCache({validityMs:s.seenTTL}),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.messageCache=t.messageCache||new cqe.MessageCache(s.mcacheGossip,s.mcacheLength),this.getFastMsgIdStr=(i=t.fastMsgIdFn)!==null&&i!==void 0?i:void 0,this.fastMsgIdCache=t.fastMsgIdFn?new Fne.SimpleTimeCache({validityMs:s.seenTTL}):void 0,this.heartbeat=new uqe.Heartbeat(this),this.heartbeatTicks=0,this.gossipTracer=new lqe.IWantTracer,this._libp2p=e,this.score=new QI.PeerScore(this._options.scoreParams,e.connectionManager)}_decodeRpc(e){return XI.RPC.decode(e)}_encodeRpc(e){return XI.RPC.encode(e).finish()}_addPeer(e,t){let i=super._addPeer(e,t);this.score.addPeer(e.toB58String());let n=!1;for(let s of this._libp2p.connectionManager.getAll(e))if(s.stat.direction==="outbound"&&Array.from(s.registry.values()).some(o=>t===o.protocol)){n=!0;break}return this.outbound.set(i.id.toB58String(),n),i}_removePeer(e){let t=super._removePeer(e),i=e.toB58String();for(let n of this.mesh.values())n.delete(i);for(let n of this.fanout.values())n.delete(i);return this.gossip.delete(i),this.control.delete(i),this.outbound.delete(i),this.score.removePeer(i),this.acceptFromWhitelist.delete(i),t}_processRpc(e,t,i){let n=Object.create(null,{_processRpc:{get:()=>super._processRpc}});return Un(this,void 0,void 0,function*(){return(yield n._processRpc.call(this,e,t,i))?(i.control&&(yield this._processRpcControlMessage(e,i.control)),!0):!1})}_processRpcControlMessage(e,t){return Un(this,void 0,void 0,function*(){if(!t)return;let i=t.ihave?this._handleIHave(e,t.ihave):[],n=t.iwant?this._handleIWant(e,t.iwant):[],s=t.graft?yield this._handleGraft(e,t.graft):[];if(t.prune&&this._handlePrune(e,t.prune),!i.length&&!n.length&&!s.length)return;let o=Pi.createGossipRpc(n,{iwant:i,prune:s});this._sendRpc(e,o)})}_processRpcMessage(e){let t=Object.create(null,{_processRpcMessage:{get:()=>super._processRpcMessage}});return Un(this,void 0,void 0,function*(){let i;if(this.getFastMsgIdStr&&this.fastMsgIdCache){let n=yield this.getFastMsgIdStr(e);if(i=this.fastMsgIdCache.get(n),i!==void 0){this.score.duplicateMessage(e,i);return}i=Pi.messageIdToString(yield this.getMsgId(e)),this.fastMsgIdCache.put(n,i)}else if(i=Pi.messageIdToString(yield this.getMsgId(e)),this.seenCache.has(i)){this.score.duplicateMessage(e,i);return}this.seenCache.put(i),yield this.score.validateMessage(i),yield t._processRpcMessage.call(this,e)})}_acceptFrom(e){if(this.direct.has(e))return!0;let t=Date.now(),i=this.acceptFromWhitelist.get(e);if(i&&i.messagesAccepted<JI.ACCEPT_FROM_WHITELIST_MAX_MESSAGES&&i.acceptUntil>=t)return i.messagesAccepted+=1,!0;let n=this.score.score(e);return n>=JI.ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:t+JI.ACCEPT_FROM_WHITELIST_DURATION_MS}):this.acceptFromWhitelist.delete(e),n>=this._options.scoreThresholds.graylistThreshold}validate(e){let t=Object.create(null,{validate:{get:()=>super.validate}});return Un(this,void 0,void 0,function*(){try{yield t.validate.call(this,e)}catch(i){let n=yield this.getCanonicalMsgIdStr(e);throw this.score.rejectMessage(e,n,i.code),this.gossipTracer.rejectMessage(n,i.code),i}})}_handleIHave(e,t){if(!t.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,i),[];let n=(this.peerhave.get(e)||0)+1;if(this.peerhave.set(e,n),n>kt.GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,n),[];let s=this.iasked.get(e)||0;if(s>=kt.GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),[];let o=new Map;if(t.forEach(({topicID:u,messageIDs:f})=>{!u||!f||!this.mesh.has(u)||f.forEach(d=>{let h=Pi.messageIdToString(d);this.seenCache.has(h)||o.set(h,d)})}),!o.size)return[];let a=o.size;a+s>kt.GossipsubMaxIHaveLength&&(a=kt.GossipsubMaxIHaveLength-s),this.log("IHAVE: Asking for %d out of %d messages from %s",a,o.size,e);let c=Array.from(o.values());return Pi.shuffle(c),c=c.slice(0,a),this.iasked.set(e,s+a),this.gossipTracer.addPromise(e,c),[{messageIDs:c}]}_handleIWant(e,t){if(!t.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,i),[];let n=new Map;return t.forEach(({messageIDs:s})=>{s&&s.forEach(o=>{let a=Pi.messageIdToString(o),[c,u]=this.messageCache.getForPeer(a,e);if(!!c){if(u>kt.GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,o);return}n.set(a,c)}})}),n.size?(this.log("IWANT: Sending %d messages to %s",n.size,e),Array.from(n.values()).map(YI.utils.normalizeOutRpcMessage)):[]}_handleGraft(e,t){return Un(this,void 0,void 0,function*(){let i=[],n=this.score.score(e),s=this._now(),o=this._options.doPX;return t.forEach(({topicID:a})=>{var c;if(!a)return;let u=this.mesh.get(a);if(!u){o=!1;return}if(u.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),i.push(a),o=!1;return}let f=(c=this.backoff.get(a))===null||c===void 0?void 0:c.get(e);if(typeof f=="number"&&s<f){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1),o=!1;let d=f+kt.GossipsubGraftFloodThreshold-kt.GossipsubPruneBackoff;s<d&&this.score.addPenalty(e,1),this._addBackoff(e,a),i.push(a);return}if(n<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,n,a),i.push(a),o=!1,this._addBackoff(e,a);return}if(u.size>=this._options.Dhi&&!this.outbound.get(e)){i.push(a),this._addBackoff(e,a);return}this.log("GRAFT: Add mesh link from %s in %s",e,a),this.score.graft(e,a),u.add(e)}),i.length?Promise.all(i.map(a=>this._makePrune(e,a,o))):[]})}_handlePrune(e,t){let i=this.score.score(e);t.forEach(({topicID:n,backoff:s,peers:o})=>{if(!n)return;let a=this.mesh.get(n);if(!!a&&(this.log("PRUNE: Remove mesh link to %s in %s",e,n),this.score.prune(e,n),a.delete(e),typeof s=="number"&&s>0?this._doAddBackoff(e,n,s*1e3):this._addBackoff(e,n),o&&o.length)){if(i<this._options.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,i,n);return}this._pxConnect(o)}})}_addBackoff(e,t){this._doAddBackoff(e,t,kt.GossipsubPruneBackoff)}_doAddBackoff(e,t,i){let n=this.backoff.get(t);n||(n=new Map,this.backoff.set(t,n));let s=this._now()+i;(n.get(e)||0)<s&&n.set(e,s)}_applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,t)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",t,e),this.score.addPenalty(t,e)})}_clearBackoff(){if(this.heartbeatTicks%kt.GossipsubPruneBackoffTicks!=0)return;let e=this._now();this.backoff.forEach((t,i)=>{t.forEach((n,s)=>{n<e&&t.delete(s)}),t.size===0&&this.backoff.delete(i)})}_directConnect(){if(this.heartbeatTicks%kt.GossipsubDirectConnectTicks!=0)return;let e=[];this.direct.forEach(t=>{let i=this.peers.get(t);(!i||!i.isWritable)&&e.push(t)}),e.length&&e.forEach(t=>{this._connect(t)})}_pxConnect(e){return Un(this,void 0,void 0,function*(){e.length>kt.GossipsubPrunePeers&&(Pi.shuffle(e),e=e.slice(0,kt.GossipsubPrunePeers));let t=[];yield Promise.all(e.map(i=>Un(this,void 0,void 0,function*(){if(!i.peerID)return;let s=ZI.createFromBytes(i.peerID).toB58String();if(!this.peers.has(s)){if(!i.signedPeerRecord){t.push(s);return}try{let o=yield fqe.openAndCertify(i.signedPeerRecord,"libp2p-peer-record"),a=o.peerId.toB58String();if(s!==a){this.log("bogus peer record obtained through px: peer ID %s doesn't match expected peer %s",a,s);return}if(!this._libp2p.peerStore.addressBook.consumePeerRecord(o)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}t.push(s)}catch(o){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}}))),!!t.length&&t.forEach(i=>this._connect(i))})}start(){let e=Object.create(null,{start:{get:()=>super.start}});return Un(this,void 0,void 0,function*(){yield e.start.call(this),this.heartbeat.start(),this.score.start(),this._directPeerInitial=setTimeout(()=>{this.direct.forEach(t=>{this._connect(t)})},kt.GossipsubDirectConnectInitialDelay)})}stop(){let e=Object.create(null,{stop:{get:()=>super.stop}});return Un(this,void 0,void 0,function*(){yield e.stop.call(this),this.heartbeat.stop(),this.score.stop(),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),clearTimeout(this._directPeerInitial)})}_connect(e){this.log("Initiating connection with %s",e),this._libp2p.dialProtocol(ZI.createFromB58String(e),this.multicodecs)}subscribe(e){super.subscribe(e),this.join(e)}unsubscribe(e){super.unsubscribe(e),this.leave(e)}join(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("JOIN %s",e);let t=this.fanout.get(e);if(t)t.forEach(i=>{this.score.score(i)<0&&t.delete(i)}),t.size<this._options.D&&Tw.getGossipPeers(this,e,this._options.D-t.size,i=>!t.has(i)&&!this.direct.has(i)&&this.score.score(i)>=0).forEach(i=>t.add(i)),this.mesh.set(e,t),this.fanout.delete(e),this.lastpub.delete(e);else{let i=Tw.getGossipPeers(this,e,this._options.D,n=>!this.direct.has(n)&&this.score.score(n)>=0);this.mesh.set(e,i)}this.mesh.get(e).forEach(i=>{this.log("JOIN: Add mesh link to %s in %s",i,e),this._sendGraft(i,e)})}leave(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e);let t=this.mesh.get(e);t&&(t.forEach(i=>{this.log("LEAVE: Remove mesh link to %s in %s",i,e),this._sendPrune(i,e)}),this.mesh.delete(e))}getCanonicalMsgIdStr(e){var t,i;return Un(this,void 0,void 0,function*(){return this.fastMsgIdCache&&this.getFastMsgIdStr?(i=(t=this.getCachedMsgIdStr(e))!==null&&t!==void 0?t:this.fastMsgIdCache.get(this.getFastMsgIdStr(e)))!==null&&i!==void 0?i:Pi.messageIdToString(yield this.getMsgId(e)):Pi.messageIdToString(yield this.getMsgId(e))})}getCachedMsgIdStr(e){}_publish(e){return Un(this,void 0,void 0,function*(){let t=yield this.getCanonicalMsgIdStr(e);e.receivedFrom!==this.peerId.toB58String()&&(this.score.deliverMessage(e,t),this.gossipTracer.deliverMessage(t)),this.seenCache.put(t),this.messageCache.put(e,t);let i=new Set;e.topicIDs.forEach(s=>{let o=this.topics.get(s);if(!!o)if(this._options.floodPublish&&e.from===this.peerId.toB58String())o.forEach(a=>{(this.direct.has(a)||this.score.score(a)>=this._options.scoreThresholds.publishThreshold)&&i.add(a)});else{this.direct.forEach(c=>{i.add(c)}),o.forEach(c=>{let u=this.score.score(c),f=this.peers.get(c);!f||f.protocol===kt.FloodsubID&&u>=this._options.scoreThresholds.publishThreshold&&i.add(c)});let a=this.mesh.get(s);if(!a||!a.size){if(a=this.fanout.get(s),!a){let c=Tw.getGossipPeers(this,s,this._options.D,u=>this.score.score(u)>=this._options.scoreThresholds.publishThreshold);c.size>0?(a=c,this.fanout.set(s,c)):a=new Set}this.lastpub.set(s,this._now())}a.forEach(c=>{i.add(c)})}});let n=Pi.createGossipRpc([YI.utils.normalizeOutRpcMessage(e)]);i.forEach(s=>{s!==e.from&&this._sendRpc(s,n)})})}_sendGraft(e,t){let i=[{topicID:t}],n=Pi.createGossipRpc([],{graft:i});this._sendRpc(e,n)}_sendPrune(e,t){return Un(this,void 0,void 0,function*(){let i=[yield this._makePrune(e,t,this._options.doPX)],n=Pi.createGossipRpc([],{prune:i});this._sendRpc(e,n)})}_sendRpc(e,t){let i=this.peers.get(e);if(!i||!i.isWritable)return;let n=this.control.get(e);n&&(this._piggybackControl(e,t,n),this.control.delete(e));let s=this.gossip.get(e);s&&(this._piggybackGossip(e,t,s),this.gossip.delete(e)),i.write(XI.RPC.encode(t).finish())}_piggybackControl(e,t,i){let n=(i.graft||[]).filter(({topicID:o})=>(o&&this.mesh.get(o)||new Set).has(e)),s=(i.prune||[]).filter(({topicID:o})=>!(o&&this.mesh.get(o)||new Set).has(e));!n.length&&!s.length||(t.control?(t.control.graft=t.control.graft&&t.control.graft.concat(n),t.control.prune=t.control.prune&&t.control.prune.concat(s)):t.control={ihave:[],iwant:[],graft:n,prune:s})}_piggybackGossip(e,t,i){t.control||(t.control={ihave:[],iwant:[],graft:[],prune:[]}),t.control.ihave=i}_sendGraftPrune(e,t,i){return Un(this,void 0,void 0,function*(){let n=this._options.doPX;for(let[s,o]of e){let a=o.map(d=>({topicID:d})),c=[],u=t.get(s);u&&(c=yield Promise.all(u.map(d=>this._makePrune(s,d,n&&!i.get(s)))),t.delete(s));let f=Pi.createGossipRpc([],{graft:a,prune:c});this._sendRpc(s,f)}for(let[s,o]of t){let a=yield Promise.all(o.map(u=>this._makePrune(s,u,n&&!i.get(s)))),c=Pi.createGossipRpc([],{prune:a});this._sendRpc(s,c)}})}_emitGossip(e,t){let i=this.messageCache.getGossipIDs(e);if(!i.length)return;Pi.shuffle(i),i.length>kt.GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",i.length);let n=[],s=this.topics.get(e);if(!s)return;s.forEach(c=>{let u=this.peers.get(c);!u||!t.has(c)&&!this.direct.has(c)&&Pi.hasGossipProtocol(u.protocol)&&this.score.score(c)>=this._options.scoreThresholds.gossipThreshold&&n.push(c)});let o=this._options.Dlazy,a=kt.GossipsubGossipFactor*n.length;a>o&&(o=a),o>n.length?o=n.length:Pi.shuffle(n),n.slice(0,o).forEach(c=>{let u=i;i.length>kt.GossipsubMaxIHaveLength&&(u=Pi.shuffle(u.slice()).slice(0,kt.GossipsubMaxIHaveLength)),this._pushGossip(c,{topicID:e,messageIDs:u})})}_flush(){for(let[e,t]of this.gossip.entries()){this.gossip.delete(e);let i=Pi.createGossipRpc([],{ihave:t});this._sendRpc(e,i)}for(let[e,t]of this.control.entries()){this.control.delete(e);let i=Pi.createGossipRpc([],{graft:t.graft,prune:t.prune});this._sendRpc(e,i)}}_pushGossip(e,t){this.log("Add gossip to %s",e);let i=this.gossip.get(e)||[];this.gossip.set(e,i.concat(t))}_now(){return Date.now()}_makePrune(e,t,i){return Un(this,void 0,void 0,function*(){if(this.peers.get(e).protocol===kt.GossipsubIDv10)return{topicID:t,peers:[]};let n=kt.GossipsubPruneBackoff/1e3;if(!i)return{topicID:t,peers:[],backoff:n};let s=Tw.getGossipPeers(this,t,kt.GossipsubPrunePeers,a=>a!==e&&this.score.score(a)>=0),o=yield Promise.all(Array.from(s).map(a=>Un(this,void 0,void 0,function*(){let c=ZI.createFromB58String(a);return{peerID:c.toBytes(),signedPeerRecord:yield this._libp2p.peerStore.addressBook.getRawEnvelope(c)}})));return{topicID:t,peers:o,backoff:n}})}};eT.multicodec=kt.GossipsubIDv11;Kne.exports=eT});var Xne=m((q_t,Yne)=>{l();"use strict";var zne=st(),{base58btc:dqe}=(di(),Fo),{default:hqe}=Go(),Hne=ec(),$ne=le(),af=$ne("libp2p-delegated-peer-routing");af.error=$ne("libp2p-delegated-peer-routing:error");var Gne=3e4,pqe=4,Wne=class{constructor(e){if(e==null)throw new Error("missing ipfs http client");this._client=e,this._httpQueue=new hqe({concurrency:pqe});let{protocol:t,host:i,port:n}=e.getEndpointConfig();af(`enabled DelegatedPeerRouting via ${t}://${i}:${n}`)}async findPeer(e,t={}){let i=e;zne.isPeerId(i)&&(i=e.toB58String()),af("findPeer starts: "+e),t.timeout=t.timeout||Gne;try{return await this._httpQueue.add(async()=>{let{addrs:n}=await this._client.dht.findPeer(i,{timeout:t.timeout});return{id:e,multiaddrs:n}})}catch(n){if(n.message.includes("not found"))return;throw n}finally{af("findPeer finished: "+e)}}async*getClosestPeers(e,t={}){let i=dqe.encode(e).substring(1);af("getClosestPeers starts:",i),t.timeout=t.timeout||Gne;let n=Hne(),s=Hne();this._httpQueue.add(()=>(n.resolve(),s.promise));try{await n.promise;for await(let o of this._client.dht.query(i,{timeout:t.timeout}))switch(o.type){case 1:for(let a of o.responses)yield{id:zne.parse(a.id),multiaddrs:a.addrs};break;default:af("getClosestPeers unhandled response",o)}}catch(o){throw af.error("getClosestPeers errored:",o),o}finally{s.resolve(),af("getClosestPeers finished:",i)}}};Yne.exports=Wne});var rse=m((U_t,tse)=>{l();"use strict";var Qne=le(),yqe=st(),gqe=rs(),{default:Zne}=Go(),Jne=ec(),ah=Qne("libp2p-delegated-content-routing");ah.error=Qne("libp2p-delegated-content-routing:error");var mqe=3e4,bqe=4,ese=class{constructor(e,t){if(e==null)throw new Error("missing self peerId");if(t==null)throw new Error("missing ipfs http client");this._client=t,this.peerId=e;let i={concurrency:bqe};this._httpQueue=new Zne(i),this._httpQueueRefs=new Zne(Object.assign({},i,{concurrency:2}));let{protocol:n,host:s,port:o}=t.getEndpointConfig();ah(`enabled DelegatedContentRouting via ${n}://${s}:${o}`)}async*findProviders(e,t={}){ah(`findProviders starts: ${e}`),t.timeout=t.timeout||mqe;let i=0,n=Jne(),s=Jne();this._httpQueue.add(()=>(n.resolve(),s.promise));try{await n.promise;for await(let{id:o,addrs:a}of this._client.dht.findProvs(e,{numProviders:t.numProviders,timeout:t.timeout}))yield{id:yqe.parse(o),multiaddrs:a},i++}catch(o){throw ah.error("findProviders errored:",o),o}finally{s.resolve(),ah(`findProviders finished: ${e} found ${i} providers`)}}async provide(e){ah(`provide starts: ${e}`),await this._httpQueueRefs.add(async()=>{await this._client.block.stat(e),await gqe(this._client.dht.provide(e))}),ah(`provide finished: ${e}`)}};tse.exports=ese});var lh=m((tvt,lse)=>{l();"use strict";function use(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function Cqe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return use(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),use(new n,t)}}lse.exports=Cqe});var ym=m((rSt,Toe)=>{l();Toe.exports=r=>{if(r[Symbol.asyncIterator])return r;if(r.getReader)return async function*(){let e=r.getReader();try{for(;;){let{done:t,value:i}=await e.read();if(t)return;yield i}}finally{e.releaseLock()}}();throw new Error("unknown stream")}});var cT=m(()=>{l()});var uT=m((KPt,Ece)=>{l();"use strict";var Hqe=Tp(),$qe=(r,e)=>({path:decodeURIComponent(new URL(r).pathname.split("/").pop()||""),content:Gqe(r,e)});async function*Gqe(r,e){yield*(await new Hqe().get(r,e)).iterator()}Ece.exports=$qe});var Ace=m(()=>{l()});var xce=m((kCt,Rce)=>{l();Rce.exports=typeof WebSocket=="undefined"?Ace():WebSocket});var Tce=m(Vw=>{l();"use strict";Object.defineProperty(Vw,"__esModule",{value:!0});var Ice=class{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;let t={value:e,done:!1};if(this.pullQueue.length){let i=this.pullQueue.shift();i&&i.resolve(t)}else this.pushQueue.push(Promise.resolve(t)),this.highWaterMark!==void 0&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(let e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(let t of this.pullQueue)t.reject(e);this.pullQueue.length=0}else{let t=Promise.reject(e);t.catch(()=>{}),this.pushQueue.push(t)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:e=>{let t=this.pushQueue.shift();return t?(this.lowWaterMark!==void 0&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),t):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((i,n)=>{this.pullQueue.push({resolve:i,reject:n})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}},lT=class{constructor(e,{highWaterMark:t=100,lowWaterMark:i=1}={}){let n=new Ice;n.highWaterMark=t,n.lowWaterMark=i,n.removeCallback=e({push:s=>n.push(s),stop:()=>n.stop(),fail:s=>n.fail(s),on:(s,o)=>{n.eventHandlers[s]=o}})||(()=>{}),this[Symbol.asyncIterator]=()=>n[Symbol.asyncIterator](),Object.freeze(this)}};Vw.EventIterator=lT;Vw.default=lT});var Pce=m(gm=>{l();"use strict";Object.defineProperty(gm,"__esModule",{value:!0});var fT=Tce();gm.EventIterator=fT.EventIterator;function Zqe(r,e,t){return new fT.EventIterator(({push:i})=>(this.addEventListener(r,i,e),()=>this.removeEventListener(r,i,e)),t)}gm.subscribe=Zqe;gm.default=fT.EventIterator});var Oce=m((BCt,Cce)=>{l();var{Buffer:Jqe}=ci(),{EventIterator:eUe}=Pce();function tUe(r){return r instanceof ArrayBuffer||r!=null&&r.constructor!=null&&r.constructor.name==="ArrayBuffer"&&typeof r.byteLength=="number"}Cce.exports=r=>{let e=r.removeEventListener||r.removeListener,t=async function*(){let s=new eUe(({push:o,stop:a,fail:c})=>(r.addEventListener("message",o),r.addEventListener("error",c),r.addEventListener("close",a),()=>{e.call(r,"message",o),e.call(r,"error",c),e.call(r,"close",a)}),{highWaterMark:1/0});for await(let{data:o}of s)yield tUe(o)?Jqe.from(o):o}(),i=r.readyState===1,n;return r.addEventListener("open",()=>{i=!0,n=null}),r.addEventListener("close",()=>{i=!1,n=null}),r.addEventListener("error",s=>{i||(n=s)}),t.connected=()=>new Promise((s,o)=>{if(i)return s();if(n)return o(n);let a=f=>{e.call(r,"open",c),e.call(r,"error",u),f()},c=()=>a(s),u=f=>a(()=>o(f));r.addEventListener("open",c),r.addEventListener("error",u)}),t}});var Dce=m((LCt,kce)=>{l();kce.exports=async r=>{if(r.readyState>=2)throw new Error("socket closed");if(r.readyState!==1)return new Promise((e,t)=>{let i=r&&(r.removeEventListener||r.removeListener);function n(){typeof i=="function"&&(i.call(r,"open",s),i.call(r,"error",o))}function s(){n(),e()}function o(a){n(),t(a)}r.addEventListener("open",s),r.addEventListener("error",o)})}});var Bce=m((MCt,Nce)=>{l();var rUe=Dce();Nce.exports=(r,e)=>(e=e||{},e.closeOnEnd=e.closeOnEnd!==!1,async t=>{for await(let i of t){try{await rUe(r)}catch(n){if(n.message==="socket closed")break;throw n}r.send(i)}if(e.closeOnEnd&&r.readyState<=1)return new Promise((i,n)=>{r.addEventListener("close",s=>{if(s.wasClean||s.code===1006)i();else{let o=Object.assign(new Error("ws error"),{event:s});n(o)}}),setTimeout(()=>r.close())})})});var Mce=m((jCt,Lce)=>{l();var iUe=Oce(),nUe=Bce();Lce.exports=(r,e)=>{e=e||{},e.binaryType?r.binaryType=e.binaryType:e.binary&&(r.binaryType="arraybuffer");let t={sink:nUe(r,e),source:iUe(r,e),connected:()=>t.source.connected()};return t}});var qce=m((qCt,jce)=>{l();var{relative:sUe}=y4(),oUe={http:"ws",https:"wss"},aUe="ws";jce.exports=(r,e)=>sUe(r,e,oUe,aUe)});var Uce=m((UCt,zw)=>{l();"use strict";var cUe=xce(),uUe=Mce(),lUe=qce();zw.exports=function(r,e={}){let t=typeof window=="undefined"?{}:window.location,i=lUe(r,t),n=new cUe(i,e.websocket),s=uUe(n,e);return s.remoteAddress=i,s.close=()=>new Promise((o,a)=>{n.addEventListener("close",o),n.close()}),s.destroy=()=>{n.terminate?n.terminate():n.close()},s.socket=n,s};zw.exports.connect=zw.exports});var Kce=m((FCt,Fce)=>{l();"use strict";Fce.exports=function(){throw new Error("WebSocket Servers can not be created in the browser!")}});var dT=m(fh=>{l();"use strict";fh.CODE_P2P=421;fh.CODE_CIRCUIT=290;fh.CODE_TCP=6;fh.CODE_WS=477;fh.CODE_WSS=478;fh.CLOSE_TIMEOUT=2e3});var Hce=m((VCt,zce)=>{l();"use strict";function Vce(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function fUe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Vce(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Vce(new n,t)}}zce.exports=fUe});var hT=m(g1=>{l();"use strict";Object.defineProperty(g1,"__esModule",{value:!0});g1.isCorrect=g1.isInSubnet=void 0;function dUe(r){return this.subnetMask<r.subnetMask?!1:this.mask(r.subnetMask)===r.mask()}g1.isInSubnet=dUe;function hUe(r){return function(){return this.addressMinusSuffix!==this.correctForm()?!1:this.subnetMask===r&&!this.parsedSubnet?!0:this.parsedSubnet===String(this.subnetMask)}}g1.isCorrect=hUe});var pT=m(wc=>{l();"use strict";Object.defineProperty(wc,"__esModule",{value:!0});wc.RE_SUBNET_STRING=wc.RE_ADDRESS=wc.GROUPS=wc.BITS=void 0;wc.BITS=32;wc.GROUPS=4;wc.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g;wc.RE_SUBNET_STRING=/\/\d{1,2}$/});var Hw=m(m1=>{l();"use strict";var pUe=m1&&m1.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(m1,"__esModule",{value:!0});m1.AddressError=void 0;var yUe=function(r){pUe(e,r);function e(t,i){var n=r.call(this,t)||this;return n.name="AddressError",i!==null&&(n.parseMessage=i),n}return e}(Error);m1.AddressError=yUe});var yT=m(($w,$ce)=>{l();(function(){var r,e=244837814094590,t=(e&16777215)==15715070;function i(_,E,P){_!=null&&(typeof _=="number"?this.fromNumber(_,E,P):E==null&&typeof _!="string"?this.fromString(_,256):this.fromString(_,E))}function n(){return new i(null)}function s(_,E,P,H,ue,me){for(;--me>=0;){var Pe=E*this[_++]+P[H]+ue;ue=Math.floor(Pe/67108864),P[H++]=Pe&67108863}return ue}function o(_,E,P,H,ue,me){for(var Pe=E&32767,Le=E>>15;--me>=0;){var Or=this[_]&32767,Vi=this[_++]>>15,Bs=Le*Or+Vi*Pe;Or=Pe*Or+((Bs&32767)<<15)+P[H]+(ue&1073741823),ue=(Or>>>30)+(Bs>>>15)+Le*Vi+(ue>>>30),P[H++]=Or&1073741823}return ue}function a(_,E,P,H,ue,me){for(var Pe=E&16383,Le=E>>14;--me>=0;){var Or=this[_]&16383,Vi=this[_++]>>14,Bs=Le*Or+Vi*Pe;Or=Pe*Or+((Bs&16383)<<14)+P[H]+ue,ue=(Or>>28)+(Bs>>14)+Le*Vi,P[H++]=Or&268435455}return ue}var c=typeof navigator!="undefined";c&&t&&navigator.appName=="Microsoft Internet Explorer"?(i.prototype.am=o,r=30):c&&t&&navigator.appName!="Netscape"?(i.prototype.am=s,r=26):(i.prototype.am=a,r=28),i.prototype.DB=r,i.prototype.DM=(1<<r)-1,i.prototype.DV=1<<r;var u=52;i.prototype.FV=Math.pow(2,u),i.prototype.F1=u-r,i.prototype.F2=2*r-u;var f="0123456789abcdefghijklmnopqrstuvwxyz",d=new Array,h,p;for(h="0".charCodeAt(0),p=0;p<=9;++p)d[h++]=p;for(h="a".charCodeAt(0),p=10;p<36;++p)d[h++]=p;for(h="A".charCodeAt(0),p=10;p<36;++p)d[h++]=p;function y(_){return f.charAt(_)}function g(_,E){var P=d[_.charCodeAt(E)];return P??-1}function w(_){for(var E=this.t-1;E>=0;--E)_[E]=this[E];_.t=this.t,_.s=this.s}function b(_){this.t=1,this.s=_<0?-1:0,_>0?this[0]=_:_<-1?this[0]=_+this.DV:this.t=0}function v(_){var E=n();return E.fromInt(_),E}function R(_,E){var P;if(E==16)P=4;else if(E==8)P=3;else if(E==256)P=8;else if(E==2)P=1;else if(E==32)P=5;else if(E==4)P=2;else{this.fromRadix(_,E);return}this.t=0,this.s=0;for(var H=_.length,ue=!1,me=0;--H>=0;){var Pe=P==8?_[H]&255:g(_,H);if(Pe<0){_.charAt(H)=="-"&&(ue=!0);continue}ue=!1,me==0?this[this.t++]=Pe:me+P>this.DB?(this[this.t-1]|=(Pe&(1<<this.DB-me)-1)<<me,this[this.t++]=Pe>>this.DB-me):this[this.t-1]|=Pe<<me,me+=P,me>=this.DB&&(me-=this.DB)}P==8&&(_[0]&128)!=0&&(this.s=-1,me>0&&(this[this.t-1]|=(1<<this.DB-me)-1<<me)),this.clamp(),ue&&i.ZERO.subTo(this,this)}function k(){for(var _=this.s&this.DM;this.t>0&&this[this.t-1]==_;)--this.t}function C(_){if(this.s<0)return"-"+this.negate().toString(_);var E;if(_==16)E=4;else if(_==8)E=3;else if(_==2)E=1;else if(_==32)E=5;else if(_==4)E=2;else return this.toRadix(_);var P=(1<<E)-1,H,ue=!1,me="",Pe=this.t,Le=this.DB-Pe*this.DB%E;if(Pe-- >0)for(Le<this.DB&&(H=this[Pe]>>Le)>0&&(ue=!0,me=y(H));Pe>=0;)Le<E?(H=(this[Pe]&(1<<Le)-1)<<E-Le,H|=this[--Pe]>>(Le+=this.DB-E)):(H=this[Pe]>>(Le-=E)&P,Le<=0&&(Le+=this.DB,--Pe)),H>0&&(ue=!0),ue&&(me+=y(H));return ue?me:"0"}function T(){var _=n();return i.ZERO.subTo(this,_),_}function D(){return this.s<0?this.negate():this}function j(_){var E=this.s-_.s;if(E!=0)return E;var P=this.t;if(E=P-_.t,E!=0)return this.s<0?-E:E;for(;--P>=0;)if((E=this[P]-_[P])!=0)return E;return 0}function M(_){var E=1,P;return(P=_>>>16)!=0&&(_=P,E+=16),(P=_>>8)!=0&&(_=P,E+=8),(P=_>>4)!=0&&(_=P,E+=4),(P=_>>2)!=0&&(_=P,E+=2),(P=_>>1)!=0&&(_=P,E+=1),E}function se(){return this.t<=0?0:this.DB*(this.t-1)+M(this[this.t-1]^this.s&this.DM)}function ie(_,E){var P;for(P=this.t-1;P>=0;--P)E[P+_]=this[P];for(P=_-1;P>=0;--P)E[P]=0;E.t=this.t+_,E.s=this.s}function fe(_,E){for(var P=_;P<this.t;++P)E[P-_]=this[P];E.t=Math.max(this.t-_,0),E.s=this.s}function pe(_,E){var P=_%this.DB,H=this.DB-P,ue=(1<<H)-1,me=Math.floor(_/this.DB),Pe=this.s<<P&this.DM,Le;for(Le=this.t-1;Le>=0;--Le)E[Le+me+1]=this[Le]>>H|Pe,Pe=(this[Le]&ue)<<P;for(Le=me-1;Le>=0;--Le)E[Le]=0;E[me]=Pe,E.t=this.t+me+1,E.s=this.s,E.clamp()}function Be(_,E){E.s=this.s;var P=Math.floor(_/this.DB);if(P>=this.t){E.t=0;return}var H=_%this.DB,ue=this.DB-H,me=(1<<H)-1;E[0]=this[P]>>H;for(var Pe=P+1;Pe<this.t;++Pe)E[Pe-P-1]|=(this[Pe]&me)<<ue,E[Pe-P]=this[Pe]>>H;H>0&&(E[this.t-P-1]|=(this.s&me)<<ue),E.t=this.t-P,E.clamp()}function Ae(_,E){for(var P=0,H=0,ue=Math.min(_.t,this.t);P<ue;)H+=this[P]-_[P],E[P++]=H&this.DM,H>>=this.DB;if(_.t<this.t){for(H-=_.s;P<this.t;)H+=this[P],E[P++]=H&this.DM,H>>=this.DB;H+=this.s}else{for(H+=this.s;P<_.t;)H-=_[P],E[P++]=H&this.DM,H>>=this.DB;H-=_.s}E.s=H<0?-1:0,H<-1?E[P++]=this.DV+H:H>0&&(E[P++]=H),E.t=P,E.clamp()}function ke(_,E){var P=this.abs(),H=_.abs(),ue=P.t;for(E.t=ue+H.t;--ue>=0;)E[ue]=0;for(ue=0;ue<H.t;++ue)E[ue+P.t]=P.am(0,H[ue],E,ue,0,P.t);E.s=0,E.clamp(),this.s!=_.s&&i.ZERO.subTo(E,E)}function ne(_){for(var E=this.abs(),P=_.t=2*E.t;--P>=0;)_[P]=0;for(P=0;P<E.t-1;++P){var H=E.am(P,E[P],_,2*P,0,1);(_[P+E.t]+=E.am(P+1,2*E[P],_,2*P+1,H,E.t-P-1))>=E.DV&&(_[P+E.t]-=E.DV,_[P+E.t+1]=1)}_.t>0&&(_[_.t-1]+=E.am(P,E[P],_,2*P,0,1)),_.s=0,_.clamp()}function Me(_,E,P){var H=_.abs();if(!(H.t<=0)){var ue=this.abs();if(ue.t<H.t){E!=null&&E.fromInt(0),P!=null&&this.copyTo(P);return}P==null&&(P=n());var me=n(),Pe=this.s,Le=_.s,Or=this.DB-M(H[H.t-1]);Or>0?(H.lShiftTo(Or,me),ue.lShiftTo(Or,P)):(H.copyTo(me),ue.copyTo(P));var Vi=me.t,Bs=me[Vi-1];if(Bs!=0){var fs=Bs*(1<<this.F1)+(Vi>1?me[Vi-2]>>this.F2:0),Nc=this.FV/fs,w3=(1<<this.F1)/fs,Mo=1<<this.F2,jo=P.t,_3=jo-Vi,Uu=E??n();for(me.dlShiftTo(_3,Uu),P.compareTo(Uu)>=0&&(P[P.t++]=1,P.subTo(Uu,P)),i.ONE.dlShiftTo(Vi,Uu),Uu.subTo(me,me);me.t<Vi;)me[me.t++]=0;for(;--_3>=0;){var Z_=P[--jo]==Bs?this.DM:Math.floor(P[jo]*Nc+(P[jo-1]+Mo)*w3);if((P[jo]+=me.am(0,Z_,P,_3,0,Vi))<Z_)for(me.dlShiftTo(_3,Uu),P.subTo(Uu,P);P[jo]<--Z_;)P.subTo(Uu,P)}E!=null&&(P.drShiftTo(Vi,E),Pe!=Le&&i.ZERO.subTo(E,E)),P.t=Vi,P.clamp(),Or>0&&P.rShiftTo(Or,P),Pe<0&&i.ZERO.subTo(P,P)}}}function ct(_){var E=n();return this.abs().divRemTo(_,null,E),this.s<0&&E.compareTo(i.ZERO)>0&&_.subTo(E,E),E}function Ye(_){this.m=_}function Xe(_){return _.s<0||_.compareTo(this.m)>=0?_.mod(this.m):_}function de(_){return _}function J(_){_.divRemTo(this.m,null,_)}function Ee(_,E,P){_.multiplyTo(E,P),this.reduce(P)}function je(_,E){_.squareTo(E),this.reduce(E)}Ye.prototype.convert=Xe,Ye.prototype.revert=de,Ye.prototype.reduce=J,Ye.prototype.mulTo=Ee,Ye.prototype.sqrTo=je;function ze(){if(this.t<1)return 0;var _=this[0];if((_&1)==0)return 0;var E=_&3;return E=E*(2-(_&15)*E)&15,E=E*(2-(_&255)*E)&255,E=E*(2-((_&65535)*E&65535))&65535,E=E*(2-_*E%this.DV)%this.DV,E>0?this.DV-E:-E}function Te(_){this.m=_,this.mp=_.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<_.DB-15)-1,this.mt2=2*_.t}function ot(_){var E=n();return _.abs().dlShiftTo(this.m.t,E),E.divRemTo(this.m,null,E),_.s<0&&E.compareTo(i.ZERO)>0&&this.m.subTo(E,E),E}function I(_){var E=n();return _.copyTo(E),this.reduce(E),E}function O(_){for(;_.t<=this.mt2;)_[_.t++]=0;for(var E=0;E<this.m.t;++E){var P=_[E]&32767,H=P*this.mpl+((P*this.mph+(_[E]>>15)*this.mpl&this.um)<<15)&_.DM;for(P=E+this.m.t,_[P]+=this.m.am(0,H,_,E,0,this.m.t);_[P]>=_.DV;)_[P]-=_.DV,_[++P]++}_.clamp(),_.drShiftTo(this.m.t,_),_.compareTo(this.m)>=0&&_.subTo(this.m,_)}function N(_,E){_.squareTo(E),this.reduce(E)}function Y(_,E,P){_.multiplyTo(E,P),this.reduce(P)}Te.prototype.convert=ot,Te.prototype.revert=I,Te.prototype.reduce=O,Te.prototype.mulTo=Y,Te.prototype.sqrTo=N;function F(){return(this.t>0?this[0]&1:this.s)==0}function W(_,E){if(_>4294967295||_<1)return i.ONE;var P=n(),H=n(),ue=E.convert(this),me=M(_)-1;for(ue.copyTo(P);--me>=0;)if(E.sqrTo(P,H),(_&1<<me)>0)E.mulTo(H,ue,P);else{var Pe=P;P=H,H=Pe}return E.revert(P)}function ee(_,E){var P;return _<256||E.isEven()?P=new Ye(E):P=new Te(E),this.exp(_,P)}i.prototype.copyTo=w,i.prototype.fromInt=b,i.prototype.fromString=R,i.prototype.clamp=k,i.prototype.dlShiftTo=ie,i.prototype.drShiftTo=fe,i.prototype.lShiftTo=pe,i.prototype.rShiftTo=Be,i.prototype.subTo=Ae,i.prototype.multiplyTo=ke,i.prototype.squareTo=ne,i.prototype.divRemTo=Me,i.prototype.invDigit=ze,i.prototype.isEven=F,i.prototype.exp=W,i.prototype.toString=C,i.prototype.negate=T,i.prototype.abs=D,i.prototype.compareTo=j,i.prototype.bitLength=se,i.prototype.mod=ct,i.prototype.modPowInt=ee,i.ZERO=v(0),i.ONE=v(1);function V(){var _=n();return this.copyTo(_),_}function X(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function te(){return this.t==0?this.s:this[0]<<24>>24}function x(){return this.t==0?this.s:this[0]<<16>>16}function B(_){return Math.floor(Math.LN2*this.DB/Math.log(_))}function G(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Z(_){if(_==null&&(_=10),this.signum()==0||_<2||_>36)return"0";var E=this.chunkSize(_),P=Math.pow(_,E),H=v(P),ue=n(),me=n(),Pe="";for(this.divRemTo(H,ue,me);ue.signum()>0;)Pe=(P+me.intValue()).toString(_).substr(1)+Pe,ue.divRemTo(H,ue,me);return me.intValue().toString(_)+Pe}function he(_,E){this.fromInt(0),E==null&&(E=10);for(var P=this.chunkSize(E),H=Math.pow(E,P),ue=!1,me=0,Pe=0,Le=0;Le<_.length;++Le){var Or=g(_,Le);if(Or<0){_.charAt(Le)=="-"&&this.signum()==0&&(ue=!0);continue}Pe=E*Pe+Or,++me>=P&&(this.dMultiply(H),this.dAddOffset(Pe,0),me=0,Pe=0)}me>0&&(this.dMultiply(Math.pow(E,me)),this.dAddOffset(Pe,0)),ue&&i.ZERO.subTo(this,this)}function Ne(_,E,P){if(typeof E=="number")if(_<2)this.fromInt(1);else for(this.fromNumber(_,P),this.testBit(_-1)||this.bitwiseTo(i.ONE.shiftLeft(_-1),Nr,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(E);)this.dAddOffset(2,0),this.bitLength()>_&&this.subTo(i.ONE.shiftLeft(_-1),this);else{var H=new Array,ue=_&7;H.length=(_>>3)+1,E.nextBytes(H),ue>0?H[0]&=(1<<ue)-1:H[0]=0,this.fromString(H,256)}}function He(){var _=this.t,E=new Array;E[0]=this.s;var P=this.DB-_*this.DB%8,H,ue=0;if(_-- >0)for(P<this.DB&&(H=this[_]>>P)!=(this.s&this.DM)>>P&&(E[ue++]=H|this.s<<this.DB-P);_>=0;)P<8?(H=(this[_]&(1<<P)-1)<<8-P,H|=this[--_]>>(P+=this.DB-8)):(H=this[_]>>(P-=8)&255,P<=0&&(P+=this.DB,--_)),(H&128)!=0&&(H|=-256),ue==0&&(this.s&128)!=(H&128)&&++ue,(ue>0||H!=this.s)&&(E[ue++]=H);return E}function Fe(_){return this.compareTo(_)==0}function Ke(_){return this.compareTo(_)<0?this:_}function it(_){return this.compareTo(_)>0?this:_}function Mt(_,E,P){var H,ue,me=Math.min(_.t,this.t);for(H=0;H<me;++H)P[H]=E(this[H],_[H]);if(_.t<this.t){for(ue=_.s&this.DM,H=me;H<this.t;++H)P[H]=E(this[H],ue);P.t=this.t}else{for(ue=this.s&this.DM,H=me;H<_.t;++H)P[H]=E(ue,_[H]);P.t=_.t}P.s=E(this.s,_.s),P.clamp()}function ft(_,E){return _&E}function _r(_){var E=n();return this.bitwiseTo(_,ft,E),E}function Nr(_,E){return _|E}function xn(_){var E=n();return this.bitwiseTo(_,Nr,E),E}function mt(_,E){return _^E}function nt(_){var E=n();return this.bitwiseTo(_,mt,E),E}function yr(_,E){return _&~E}function Qbe(_){var E=n();return this.bitwiseTo(_,yr,E),E}function Zbe(){for(var _=n(),E=0;E<this.t;++E)_[E]=this.DM&~this[E];return _.t=this.t,_.s=~this.s,_}function Jbe(_){var E=n();return _<0?this.rShiftTo(-_,E):this.lShiftTo(_,E),E}function e6e(_){var E=n();return _<0?this.lShiftTo(-_,E):this.rShiftTo(_,E),E}function t6e(_){if(_==0)return-1;var E=0;return(_&65535)==0&&(_>>=16,E+=16),(_&255)==0&&(_>>=8,E+=8),(_&15)==0&&(_>>=4,E+=4),(_&3)==0&&(_>>=2,E+=2),(_&1)==0&&++E,E}function r6e(){for(var _=0;_<this.t;++_)if(this[_]!=0)return _*this.DB+t6e(this[_]);return this.s<0?this.t*this.DB:-1}function i6e(_){for(var E=0;_!=0;)_&=_-1,++E;return E}function n6e(){for(var _=0,E=this.s&this.DM,P=0;P<this.t;++P)_+=i6e(this[P]^E);return _}function s6e(_){var E=Math.floor(_/this.DB);return E>=this.t?this.s!=0:(this[E]&1<<_%this.DB)!=0}function o6e(_,E){var P=i.ONE.shiftLeft(_);return this.bitwiseTo(P,E,P),P}function a6e(_){return this.changeBit(_,Nr)}function c6e(_){return this.changeBit(_,yr)}function u6e(_){return this.changeBit(_,mt)}function l6e(_,E){for(var P=0,H=0,ue=Math.min(_.t,this.t);P<ue;)H+=this[P]+_[P],E[P++]=H&this.DM,H>>=this.DB;if(_.t<this.t){for(H+=_.s;P<this.t;)H+=this[P],E[P++]=H&this.DM,H>>=this.DB;H+=this.s}else{for(H+=this.s;P<_.t;)H+=_[P],E[P++]=H&this.DM,H>>=this.DB;H+=_.s}E.s=H<0?-1:0,H>0?E[P++]=H:H<-1&&(E[P++]=this.DV+H),E.t=P,E.clamp()}function f6e(_){var E=n();return this.addTo(_,E),E}function d6e(_){var E=n();return this.subTo(_,E),E}function h6e(_){var E=n();return this.multiplyTo(_,E),E}function p6e(){var _=n();return this.squareTo(_),_}function y6e(_){var E=n();return this.divRemTo(_,E,null),E}function g6e(_){var E=n();return this.divRemTo(_,null,E),E}function m6e(_){var E=n(),P=n();return this.divRemTo(_,E,P),new Array(E,P)}function b6e(_){this[this.t]=this.am(0,_-1,this,0,0,this.t),++this.t,this.clamp()}function w6e(_,E){if(_!=0){for(;this.t<=E;)this[this.t++]=0;for(this[E]+=_;this[E]>=this.DV;)this[E]-=this.DV,++E>=this.t&&(this[this.t++]=0),++this[E]}}function py(){}function qO(_){return _}function _6e(_,E,P){_.multiplyTo(E,P)}function v6e(_,E){_.squareTo(E)}py.prototype.convert=qO,py.prototype.revert=qO,py.prototype.mulTo=_6e,py.prototype.sqrTo=v6e;function E6e(_){return this.exp(_,new py)}function S6e(_,E,P){var H=Math.min(this.t+_.t,E);for(P.s=0,P.t=H;H>0;)P[--H]=0;var ue;for(ue=P.t-this.t;H<ue;++H)P[H+this.t]=this.am(0,_[H],P,H,0,this.t);for(ue=Math.min(_.t,E);H<ue;++H)this.am(0,_[H],P,H,0,E-H);P.clamp()}function A6e(_,E,P){--E;var H=P.t=this.t+_.t-E;for(P.s=0;--H>=0;)P[H]=0;for(H=Math.max(E-this.t,0);H<_.t;++H)P[this.t+H-E]=this.am(E-H,_[H],P,0,0,this.t+H-E);P.clamp(),P.drShiftTo(1,P)}function Of(_){this.r2=n(),this.q3=n(),i.ONE.dlShiftTo(2*_.t,this.r2),this.mu=this.r2.divide(_),this.m=_}function R6e(_){if(_.s<0||_.t>2*this.m.t)return _.mod(this.m);if(_.compareTo(this.m)<0)return _;var E=n();return _.copyTo(E),this.reduce(E),E}function x6e(_){return _}function I6e(_){for(_.drShiftTo(this.m.t-1,this.r2),_.t>this.m.t+1&&(_.t=this.m.t+1,_.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);_.compareTo(this.r2)<0;)_.dAddOffset(1,this.m.t+1);for(_.subTo(this.r2,_);_.compareTo(this.m)>=0;)_.subTo(this.m,_)}function T6e(_,E){_.squareTo(E),this.reduce(E)}function P6e(_,E,P){_.multiplyTo(E,P),this.reduce(P)}Of.prototype.convert=R6e,Of.prototype.revert=x6e,Of.prototype.reduce=I6e,Of.prototype.mulTo=P6e,Of.prototype.sqrTo=T6e;function C6e(_,E){var P=_.bitLength(),H,ue=v(1),me;if(P<=0)return ue;P<18?H=1:P<48?H=3:P<144?H=4:P<768?H=5:H=6,P<8?me=new Ye(E):E.isEven()?me=new Of(E):me=new Te(E);var Pe=new Array,Le=3,Or=H-1,Vi=(1<<H)-1;if(Pe[1]=me.convert(this),H>1){var Bs=n();for(me.sqrTo(Pe[1],Bs);Le<=Vi;)Pe[Le]=n(),me.mulTo(Bs,Pe[Le-2],Pe[Le]),Le+=2}var fs=_.t-1,Nc,w3=!0,Mo=n(),jo;for(P=M(_[fs])-1;fs>=0;){for(P>=Or?Nc=_[fs]>>P-Or&Vi:(Nc=(_[fs]&(1<<P+1)-1)<<Or-P,fs>0&&(Nc|=_[fs-1]>>this.DB+P-Or)),Le=H;(Nc&1)==0;)Nc>>=1,--Le;if((P-=Le)<0&&(P+=this.DB,--fs),w3)Pe[Nc].copyTo(ue),w3=!1;else{for(;Le>1;)me.sqrTo(ue,Mo),me.sqrTo(Mo,ue),Le-=2;Le>0?me.sqrTo(ue,Mo):(jo=ue,ue=Mo,Mo=jo),me.mulTo(Mo,Pe[Nc],ue)}for(;fs>=0&&(_[fs]&1<<P)==0;)me.sqrTo(ue,Mo),jo=ue,ue=Mo,Mo=jo,--P<0&&(P=this.DB-1,--fs)}return me.revert(ue)}function O6e(_){var E=this.s<0?this.negate():this.clone(),P=_.s<0?_.negate():_.clone();if(E.compareTo(P)<0){var H=E;E=P,P=H}var ue=E.getLowestSetBit(),me=P.getLowestSetBit();if(me<0)return E;for(ue<me&&(me=ue),me>0&&(E.rShiftTo(me,E),P.rShiftTo(me,P));E.signum()>0;)(ue=E.getLowestSetBit())>0&&E.rShiftTo(ue,E),(ue=P.getLowestSetBit())>0&&P.rShiftTo(ue,P),E.compareTo(P)>=0?(E.subTo(P,E),E.rShiftTo(1,E)):(P.subTo(E,P),P.rShiftTo(1,P));return me>0&&P.lShiftTo(me,P),P}function k6e(_){if(_<=0)return 0;var E=this.DV%_,P=this.s<0?_-1:0;if(this.t>0)if(E==0)P=this[0]%_;else for(var H=this.t-1;H>=0;--H)P=(E*P+this[H])%_;return P}function D6e(_){var E=_.isEven();if(this.isEven()&&E||_.signum()==0)return i.ZERO;for(var P=_.clone(),H=this.clone(),ue=v(1),me=v(0),Pe=v(0),Le=v(1);P.signum()!=0;){for(;P.isEven();)P.rShiftTo(1,P),E?((!ue.isEven()||!me.isEven())&&(ue.addTo(this,ue),me.subTo(_,me)),ue.rShiftTo(1,ue)):me.isEven()||me.subTo(_,me),me.rShiftTo(1,me);for(;H.isEven();)H.rShiftTo(1,H),E?((!Pe.isEven()||!Le.isEven())&&(Pe.addTo(this,Pe),Le.subTo(_,Le)),Pe.rShiftTo(1,Pe)):Le.isEven()||Le.subTo(_,Le),Le.rShiftTo(1,Le);P.compareTo(H)>=0?(P.subTo(H,P),E&&ue.subTo(Pe,ue),me.subTo(Le,me)):(H.subTo(P,H),E&&Pe.subTo(ue,Pe),Le.subTo(me,Le))}if(H.compareTo(i.ONE)!=0)return i.ZERO;if(Le.compareTo(_)>=0)return Le.subtract(_);if(Le.signum()<0)Le.addTo(_,Le);else return Le;return Le.signum()<0?Le.add(_):Le}var In=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],N6e=(1<<26)/In[In.length-1];function B6e(_){var E,P=this.abs();if(P.t==1&&P[0]<=In[In.length-1]){for(E=0;E<In.length;++E)if(P[0]==In[E])return!0;return!1}if(P.isEven())return!1;for(E=1;E<In.length;){for(var H=In[E],ue=E+1;ue<In.length&&H<N6e;)H*=In[ue++];for(H=P.modInt(H);E<ue;)if(H%In[E++]==0)return!1}return P.millerRabin(_)}function L6e(_){var E=this.subtract(i.ONE),P=E.getLowestSetBit();if(P<=0)return!1;var H=E.shiftRight(P);_=_+1>>1,_>In.length&&(_=In.length);for(var ue=n(),me=0;me<_;++me){ue.fromInt(In[Math.floor(Math.random()*In.length)]);var Pe=ue.modPow(H,this);if(Pe.compareTo(i.ONE)!=0&&Pe.compareTo(E)!=0){for(var Le=1;Le++<P&&Pe.compareTo(E)!=0;)if(Pe=Pe.modPowInt(2,this),Pe.compareTo(i.ONE)==0)return!1;if(Pe.compareTo(E)!=0)return!1}}return!0}i.prototype.chunkSize=B,i.prototype.toRadix=Z,i.prototype.fromRadix=he,i.prototype.fromNumber=Ne,i.prototype.bitwiseTo=Mt,i.prototype.changeBit=o6e,i.prototype.addTo=l6e,i.prototype.dMultiply=b6e,i.prototype.dAddOffset=w6e,i.prototype.multiplyLowerTo=S6e,i.prototype.multiplyUpperTo=A6e,i.prototype.modInt=k6e,i.prototype.millerRabin=L6e,i.prototype.clone=V,i.prototype.intValue=X,i.prototype.byteValue=te,i.prototype.shortValue=x,i.prototype.signum=G,i.prototype.toByteArray=He,i.prototype.equals=Fe,i.prototype.min=Ke,i.prototype.max=it,i.prototype.and=_r,i.prototype.or=xn,i.prototype.xor=nt,i.prototype.andNot=Qbe,i.prototype.not=Zbe,i.prototype.shiftLeft=Jbe,i.prototype.shiftRight=e6e,i.prototype.getLowestSetBit=r6e,i.prototype.bitCount=n6e,i.prototype.testBit=s6e,i.prototype.setBit=a6e,i.prototype.clearBit=c6e,i.prototype.flipBit=u6e,i.prototype.add=f6e,i.prototype.subtract=d6e,i.prototype.multiply=h6e,i.prototype.divide=y6e,i.prototype.remainder=g6e,i.prototype.divideAndRemainder=m6e,i.prototype.modPow=C6e,i.prototype.modInverse=D6e,i.prototype.pow=E6e,i.prototype.gcd=O6e,i.prototype.isProbablePrime=B6e,i.prototype.square=p6e,i.prototype.Barrett=Of;var b3,ls,Ki;function M6e(_){ls[Ki++]^=_&255,ls[Ki++]^=_>>8&255,ls[Ki++]^=_>>16&255,ls[Ki++]^=_>>24&255,Ki>=Q_&&(Ki-=Q_)}function UO(){M6e(new Date().getTime())}if(ls==null){ls=new Array,Ki=0;var Lo;if(typeof window!="undefined"&&window.crypto){if(window.crypto.getRandomValues){var FO=new Uint8Array(32);for(window.crypto.getRandomValues(FO),Lo=0;Lo<32;++Lo)ls[Ki++]=FO[Lo]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var KO=window.crypto.random(32);for(Lo=0;Lo<KO.length;++Lo)ls[Ki++]=KO.charCodeAt(Lo)&255}}for(;Ki<Q_;)Lo=Math.floor(65536*Math.random()),ls[Ki++]=Lo>>>8,ls[Ki++]=Lo&255;Ki=0,UO()}function j6e(){if(b3==null){for(UO(),b3=K6e(),b3.init(ls),Ki=0;Ki<ls.length;++Ki)ls[Ki]=0;Ki=0}return b3.next()}function q6e(_){var E;for(E=0;E<_.length;++E)_[E]=j6e()}function Y_(){}Y_.prototype.nextBytes=q6e;function X_(){this.i=0,this.j=0,this.S=new Array}function U6e(_){var E,P,H;for(E=0;E<256;++E)this.S[E]=E;for(P=0,E=0;E<256;++E)P=P+this.S[E]+_[E%_.length]&255,H=this.S[E],this.S[E]=this.S[P],this.S[P]=H;this.i=0,this.j=0}function F6e(){var _;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,_=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=_,this.S[_+this.S[this.i]&255]}X_.prototype.init=U6e,X_.prototype.next=F6e;function K6e(){return new X_}var Q_=256;typeof $w!="undefined"?$w=$ce.exports={default:i,BigInteger:i,SecureRandom:Y_}:this.jsbn={BigInteger:i,SecureRandom:Y_}}).call($w)});var mm=m(Gw=>{l();(function(){"use strict";var r={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function e(o){return i(s(o),arguments)}function t(o,a){return e.apply(null,[o].concat(a||[]))}function i(o,a){var c=1,u=o.length,f,d="",h,p,y,g,w,b,v,R;for(h=0;h<u;h++)if(typeof o[h]=="string")d+=o[h];else if(typeof o[h]=="object"){if(y=o[h],y.keys)for(f=a[c],p=0;p<y.keys.length;p++){if(f==null)throw new Error(e('[sprintf] Cannot access property "%s" of undefined value "%s"',y.keys[p],y.keys[p-1]));f=f[y.keys[p]]}else y.param_no?f=a[y.param_no]:f=a[c++];if(r.not_type.test(y.type)&&r.not_primitive.test(y.type)&&f instanceof Function&&(f=f()),r.numeric_arg.test(y.type)&&typeof f!="number"&&isNaN(f))throw new TypeError(e("[sprintf] expecting number but found %T",f));switch(r.number.test(y.type)&&(v=f>=0),y.type){case"b":f=parseInt(f,10).toString(2);break;case"c":f=String.fromCharCode(parseInt(f,10));break;case"d":case"i":f=parseInt(f,10);break;case"j":f=JSON.stringify(f,null,y.width?parseInt(y.width):0);break;case"e":f=y.precision?parseFloat(f).toExponential(y.precision):parseFloat(f).toExponential();break;case"f":f=y.precision?parseFloat(f).toFixed(y.precision):parseFloat(f);break;case"g":f=y.precision?String(Number(f.toPrecision(y.precision))):parseFloat(f);break;case"o":f=(parseInt(f,10)>>>0).toString(8);break;case"s":f=String(f),f=y.precision?f.substring(0,y.precision):f;break;case"t":f=String(!!f),f=y.precision?f.substring(0,y.precision):f;break;case"T":f=Object.prototype.toString.call(f).slice(8,-1).toLowerCase(),f=y.precision?f.substring(0,y.precision):f;break;case"u":f=parseInt(f,10)>>>0;break;case"v":f=f.valueOf(),f=y.precision?f.substring(0,y.precision):f;break;case"x":f=(parseInt(f,10)>>>0).toString(16);break;case"X":f=(parseInt(f,10)>>>0).toString(16).toUpperCase();break}r.json.test(y.type)?d+=f:(r.number.test(y.type)&&(!v||y.sign)?(R=v?"+":"-",f=f.toString().replace(r.sign,"")):R="",w=y.pad_char?y.pad_char==="0"?"0":y.pad_char.charAt(1):" ",b=y.width-(R+f).length,g=y.width&&b>0?w.repeat(b):"",d+=y.align?R+f+g:w==="0"?R+g+f:g+R+f)}return d}var n=Object.create(null);function s(o){if(n[o])return n[o];for(var a=o,c,u=[],f=0;a;){if((c=r.text.exec(a))!==null)u.push(c[0]);else if((c=r.modulo.exec(a))!==null)u.push("%");else if((c=r.placeholder.exec(a))!==null){if(c[2]){f|=1;var d=[],h=c[2],p=[];if((p=r.key.exec(h))!==null)for(d.push(p[1]);(h=h.substring(p[0].length))!=="";)if((p=r.key_access.exec(h))!==null)d.push(p[1]);else if((p=r.index_access.exec(h))!==null)d.push(p[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");c[2]=d}else f|=2;if(f===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");u.push({placeholder:c[0],param_no:c[1],keys:c[2],sign:c[3],pad_char:c[4],align:c[5],width:c[6],precision:c[7],type:c[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");a=a.substring(c[0].length)}return n[o]=u}typeof Gw!="undefined"&&(Gw.sprintf=e,Gw.vsprintf=t),typeof window!="undefined"&&(window.sprintf=e,window.vsprintf=t,typeof define=="function"&&define.amd&&define(function(){return{sprintf:e,vsprintf:t}}))})()});var gT=m(_c=>{l();"use strict";var gUe=_c&&_c.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),mUe=_c&&_c.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Gce=_c&&_c.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&gUe(e,r,t);return mUe(e,r),e};Object.defineProperty(_c,"__esModule",{value:!0});_c.Address4=void 0;var Wce=Gce(hT()),pa=Gce(pT()),Yce=Hw(),bm=yT(),b1=mm(),bUe=function(){function r(e){this.groups=pa.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=Wce.isCorrect(pa.BITS),this.isInSubnet=Wce.isInSubnet,this.address=e;var t=pa.RE_SUBNET_STRING.exec(e);if(t){if(this.parsedSubnet=t[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,this.subnetMask<0||this.subnetMask>pa.BITS)throw new Yce.AddressError("Invalid subnet mask.");e=e.replace(pa.RE_SUBNET_STRING,"")}this.addressMinusSuffix=e,this.parsedAddress=this.parse(e)}return r.isValid=function(e){try{return new r(e),!0}catch(t){return!1}},r.prototype.parse=function(e){var t=e.split(".");if(!e.match(pa.RE_ADDRESS))throw new Yce.AddressError("Invalid IPv4 address.");return t},r.prototype.correctForm=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)}).join(".")},r.fromHex=function(e){var t=e.replace(/:/g,"").padStart(8,"0"),i=[],n;for(n=0;n<8;n+=2){var s=t.slice(n,n+2);i.push(parseInt(s,16))}return new r(i.join("."))},r.fromInteger=function(e){return r.fromHex(e.toString(16))},r.fromArpa=function(e){var t=e.replace(/(\.in-addr\.arpa)?\.$/,""),i=t.split(".").reverse().join(".");return new r(i)},r.prototype.toHex=function(){return this.parsedAddress.map(function(e){return b1.sprintf("%02x",parseInt(e,10))}).join(":")},r.prototype.toArray=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)})},r.prototype.toGroup6=function(){var e=[],t;for(t=0;t<pa.GROUPS;t+=2){var i=b1.sprintf("%02x%02x",parseInt(this.parsedAddress[t],10),parseInt(this.parsedAddress[t+1],10));e.push(b1.sprintf("%x",parseInt(i,16)))}return e.join(":")},r.prototype.bigInteger=function(){return new bm.BigInteger(this.parsedAddress.map(function(e){return b1.sprintf("%02x",parseInt(e,10))}).join(""),16)},r.prototype._startAddress=function(){return new bm.BigInteger(this.mask()+"0".repeat(pa.BITS-this.subnetMask),2)},r.prototype.startAddress=function(){return r.fromBigInteger(this._startAddress())},r.prototype.startAddressExclusive=function(){var e=new bm.BigInteger("1");return r.fromBigInteger(this._startAddress().add(e))},r.prototype._endAddress=function(){return new bm.BigInteger(this.mask()+"1".repeat(pa.BITS-this.subnetMask),2)},r.prototype.endAddress=function(){return r.fromBigInteger(this._endAddress())},r.prototype.endAddressExclusive=function(){var e=new bm.BigInteger("1");return r.fromBigInteger(this._endAddress().subtract(e))},r.fromBigInteger=function(e){return r.fromInteger(parseInt(e.toString(),10))},r.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},r.prototype.getBitsBase2=function(e,t){return this.binaryZeroPad().slice(e,t)},r.prototype.reverseForm=function(e){e||(e={});var t=this.correctForm().split(".").reverse().join(".");return e.omitSuffix?t:b1.sprintf("%s.in-addr.arpa.",t)},r.prototype.isMulticast=function(){return this.isInSubnet(new r("224.0.0.0/4"))},r.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(pa.BITS,"0")},r.prototype.groupForV6=function(){var e=this.parsedAddress;return this.address.replace(pa.RE_ADDRESS,b1.sprintf('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',e.slice(0,2).join("."),e.slice(2,4).join(".")))},r}();_c.Address4=bUe});var mT=m(ii=>{l();"use strict";Object.defineProperty(ii,"__esModule",{value:!0});ii.RE_URL_WITH_PORT=ii.RE_URL=ii.RE_ZONE_STRING=ii.RE_SUBNET_STRING=ii.RE_BAD_ADDRESS=ii.RE_BAD_CHARACTERS=ii.TYPES=ii.SCOPES=ii.GROUPS=ii.BITS=void 0;ii.BITS=128;ii.GROUPS=8;ii.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"};ii.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"};ii.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi;ii.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi;ii.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/;ii.RE_ZONE_STRING=/%.*$/;ii.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/);ii.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/)});var bT=m(vc=>{l();"use strict";Object.defineProperty(vc,"__esModule",{value:!0});vc.simpleGroup=vc.spanLeadingZeroes=vc.spanAll=vc.spanAllZeroes=void 0;var Xce=mm();function Qce(r){return r.replace(/(0+)/g,'<span class="zero">$1</span>')}vc.spanAllZeroes=Qce;function wUe(r,e){e===void 0&&(e=0);var t=r.split("");return t.map(function(i,n){return Xce.sprintf('<span class="digit value-%s position-%d">%s</span>',i,n+e,Qce(i))}).join("")}vc.spanAll=wUe;function Zce(r){return r.replace(/^(0+)/,'<span class="zero">$1</span>')}function _Ue(r){var e=r.split(":");return e.map(function(t){return Zce(t)}).join(":")}vc.spanLeadingZeroes=_Ue;function vUe(r,e){e===void 0&&(e=0);var t=r.split(":");return t.map(function(i,n){return/group-v4/.test(i)?i:Xce.sprintf('<span class="hover-group group-%d">%s</span>',n+e,Zce(i))})}vc.simpleGroup=vUe});var Jce=m(Zi=>{l();"use strict";var EUe=Zi&&Zi.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),SUe=Zi&&Zi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),AUe=Zi&&Zi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&EUe(e,r,t);return SUe(e,r),e};Object.defineProperty(Zi,"__esModule",{value:!0});Zi.possibleElisions=Zi.simpleRegularExpression=Zi.ADDRESS_BOUNDARY=Zi.padGroup=Zi.groupPossibilities=void 0;var RUe=AUe(mT()),w1=mm();function Ww(r){return w1.sprintf("(%s)",r.join("|"))}Zi.groupPossibilities=Ww;function Yw(r){return r.length<4?w1.sprintf("0{0,%d}%s",4-r.length,r):r}Zi.padGroup=Yw;Zi.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]";function xUe(r){var e=[];r.forEach(function(i,n){var s=parseInt(i,16);s===0&&e.push(n)});var t=e.map(function(i){return r.map(function(n,s){if(s===i){var o=s===0||s===RUe.GROUPS-1?":":"";return Ww([Yw(n),o])}return Yw(n)}).join(":")});return t.push(r.map(Yw).join(":")),Ww(t)}Zi.simpleRegularExpression=xUe;function IUe(r,e,t){var i=e?"":":",n=t?"":":",s=[];!e&&!t&&s.push("::"),e&&t&&s.push(""),(t&&!e||!t&&e)&&s.push(":"),s.push(w1.sprintf("%s(:0{1,4}){1,%d}",i,r-1)),s.push(w1.sprintf("(0{1,4}:){1,%d}%s",r-1,n)),s.push(w1.sprintf("(0{1,4}:){%d}0{1,4}",r-1));for(var o=1;o<r-1;o++)for(var a=1;a<r-o;a++)s.push(w1.sprintf("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",a,r-a-o-1));return Ww(s)}Zi.possibleElisions=IUe});var nue=m(bo=>{l();"use strict";var TUe=bo&&bo.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),PUe=bo&&bo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Xw=bo&&bo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&TUe(e,r,t);return PUe(e,r),e},eue=bo&&bo.__spreadArray||function(r,e){for(var t=0,i=e.length,n=r.length;t<i;t++,n++)r[n]=e[t];return r};Object.defineProperty(bo,"__esModule",{value:!0});bo.Address6=void 0;var tue=Xw(hT()),wT=Xw(pT()),Tr=Xw(mT()),_T=Xw(bT()),dh=gT(),hh=Jce(),Ru=Hw(),Fn=yT(),Kn=mm();function Qw(r){if(!r)throw new Error("Assertion failed.")}function CUe(r){for(var e=/(\d+)(\d{3})/;e.test(r);)r=r.replace(e,"$1,$2");return r}function OUe(r){return r=r.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2'),r=r.replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2'),r}function kUe(r,e){var t=[],i=[],n;for(n=0;n<r.length;n++)n<e[0]?t.push(r[n]):n>e[1]&&i.push(r[n]);return t.concat(["compact"]).concat(i)}function rue(r){return Kn.sprintf("%04x",parseInt(r,16))}function iue(r){return r&255}var DUe=function(){function r(e,t){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=tue.isInSubnet,this.isCorrect=tue.isCorrect(Tr.BITS),t===void 0?this.groups=Tr.GROUPS:this.groups=t,this.address=e;var i=Tr.RE_SUBNET_STRING.exec(e);if(i){if(this.parsedSubnet=i[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>Tr.BITS)throw new Ru.AddressError("Invalid subnet mask.");e=e.replace(Tr.RE_SUBNET_STRING,"")}else if(/\//.test(e))throw new Ru.AddressError("Invalid subnet mask.");var n=Tr.RE_ZONE_STRING.exec(e);n&&(this.zone=n[0],e=e.replace(Tr.RE_ZONE_STRING,"")),this.addressMinusSuffix=e,this.parsedAddress=this.parse(this.addressMinusSuffix)}return r.isValid=function(e){try{return new r(e),!0}catch(t){return!1}},r.fromBigInteger=function(e){var t=e.toString(16).padStart(32,"0"),i=[],n;for(n=0;n<Tr.GROUPS;n++)i.push(t.slice(n*4,(n+1)*4));return new r(i.join(":"))},r.fromURL=function(e){var t,i=null,n;if(e.indexOf("[")!==-1&&e.indexOf("]:")!==-1){if(n=Tr.RE_URL_WITH_PORT.exec(e),n===null)return{error:"failed to parse address with port",address:null,port:null};t=n[1],i=n[2]}else if(e.indexOf("/")!==-1){if(e=e.replace(/^[a-z0-9]+:\/\//,""),n=Tr.RE_URL.exec(e),n===null)return{error:"failed to parse address from URL",address:null,port:null};t=n[1]}else t=e;return i?(i=parseInt(i,10),(i<0||i>65536)&&(i=null)):i=null,{address:new r(t),port:i}},r.fromAddress4=function(e){var t=new dh.Address4(e),i=Tr.BITS-(wT.BITS-t.subnetMask);return new r("::ffff:"+t.correctForm()+"/"+i)},r.fromArpa=function(e){var t=e.replace(/(\.ip6\.arpa)?\.$/,""),i=7;if(t.length!==63)throw new Ru.AddressError("Invalid 'ip6.arpa' form.");for(var n=t.split(".").reverse(),s=i;s>0;s--){var o=s*4;n.splice(o,0,":")}return t=n.join(""),new r(t)},r.prototype.microsoftTranscription=function(){return Kn.sprintf("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))},r.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},r.prototype.possibleSubnets=function(e){e===void 0&&(e=128);var t=Tr.BITS-this.subnetMask,i=Math.abs(e-Tr.BITS),n=t-i;return n<0?"0":CUe(new Fn.BigInteger("2",10).pow(n).toString(10))},r.prototype._startAddress=function(){return new Fn.BigInteger(this.mask()+"0".repeat(Tr.BITS-this.subnetMask),2)},r.prototype.startAddress=function(){return r.fromBigInteger(this._startAddress())},r.prototype.startAddressExclusive=function(){var e=new Fn.BigInteger("1");return r.fromBigInteger(this._startAddress().add(e))},r.prototype._endAddress=function(){return new Fn.BigInteger(this.mask()+"1".repeat(Tr.BITS-this.subnetMask),2)},r.prototype.endAddress=function(){return r.fromBigInteger(this._endAddress())},r.prototype.endAddressExclusive=function(){var e=new Fn.BigInteger("1");return r.fromBigInteger(this._endAddress().subtract(e))},r.prototype.getScope=function(){var e=Tr.SCOPES[this.getBits(12,16).intValue()];return this.getType()==="Global unicast"&&e!=="Link local"&&(e="Global"),e||"Unknown"},r.prototype.getType=function(){for(var e=0,t=Object.keys(Tr.TYPES);e<t.length;e++){var i=t[e];if(this.isInSubnet(new r(i)))return Tr.TYPES[i]}return"Global unicast"},r.prototype.getBits=function(e,t){return new Fn.BigInteger(this.getBitsBase2(e,t),2)},r.prototype.getBitsBase2=function(e,t){return this.binaryZeroPad().slice(e,t)},r.prototype.getBitsBase16=function(e,t){var i=t-e;if(i%4!=0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(e,t).toString(16).padStart(i/4,"0")},r.prototype.getBitsPastSubnet=function(){return this.getBitsBase2(this.subnetMask,Tr.BITS)},r.prototype.reverseForm=function(e){e||(e={});var t=Math.floor(this.subnetMask/4),i=this.canonicalForm().replace(/:/g,"").split("").slice(0,t).reverse().join(".");return t>0?e.omitSuffix?i:Kn.sprintf("%s.ip6.arpa.",i):e.omitSuffix?"":"ip6.arpa."},r.prototype.correctForm=function(){var e,t=[],i=0,n=[];for(e=0;e<this.parsedAddress.length;e++){var s=parseInt(this.parsedAddress[e],16);s===0&&i++,s!==0&&i>0&&(i>1&&n.push([e-i,e-1]),i=0)}i>1&&n.push([this.parsedAddress.length-i,this.parsedAddress.length-1]);var o=n.map(function(u){return u[1]-u[0]+1});if(n.length>0){var a=o.indexOf(Math.max.apply(Math,o));t=kUe(this.parsedAddress,n[a])}else t=this.parsedAddress;for(e=0;e<t.length;e++)t[e]!=="compact"&&(t[e]=parseInt(t[e],16).toString(16));var c=t.join(":");return c=c.replace(/^compact$/,"::"),c=c.replace(/^compact|compact$/,":"),c=c.replace(/compact/,""),c},r.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(Tr.BITS,"0")},r.prototype.parse4in6=function(e){var t=e.split(":"),i=t.slice(-1)[0],n=i.match(wT.RE_ADDRESS);if(n){this.parsedAddress4=n[0],this.address4=new dh.Address4(this.parsedAddress4);for(var s=0;s<this.address4.groups;s++)if(/^0[0-9]+/.test(this.address4.parsedAddress[s]))throw new Ru.AddressError("IPv4 addresses can't have leading zeroes.",e.replace(wT.RE_ADDRESS,this.address4.parsedAddress.map(OUe).join(".")));this.v4=!0,t[t.length-1]=this.address4.toGroup6(),e=t.join(":")}return e},r.prototype.parse=function(e){e=this.parse4in6(e);var t=e.match(Tr.RE_BAD_CHARACTERS);if(t)throw new Ru.AddressError(Kn.sprintf("Bad character%s detected in address: %s",t.length>1?"s":"",t.join("")),e.replace(Tr.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));var i=e.match(Tr.RE_BAD_ADDRESS);if(i)throw new Ru.AddressError(Kn.sprintf("Address failed regex: %s",i.join("")),e.replace(Tr.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));var n=[],s=e.split("::");if(s.length===2){var o=s[0].split(":"),a=s[1].split(":");o.length===1&&o[0]===""&&(o=[]),a.length===1&&a[0]===""&&(a=[]);var c=this.groups-(o.length+a.length);if(!c)throw new Ru.AddressError("Error parsing groups");this.elidedGroups=c,this.elisionBegin=o.length,this.elisionEnd=o.length+this.elidedGroups,n=n.concat(o);for(var u=0;u<c;u++)n.push("0");n=n.concat(a)}else if(s.length===1)n=e.split(":"),this.elidedGroups=0;else throw new Ru.AddressError("Too many :: groups found");if(n=n.map(function(f){return Kn.sprintf("%x",parseInt(f,16))}),n.length!==this.groups)throw new Ru.AddressError("Incorrect number of groups found");return n},r.prototype.canonicalForm=function(){return this.parsedAddress.map(rue).join(":")},r.prototype.decimal=function(){return this.parsedAddress.map(function(e){return Kn.sprintf("%05d",parseInt(e,16))}).join(":")},r.prototype.bigInteger=function(){return new Fn.BigInteger(this.parsedAddress.map(rue).join(""),16)},r.prototype.to4=function(){var e=this.binaryZeroPad().split("");return dh.Address4.fromHex(new Fn.BigInteger(e.slice(96,128).join(""),2).toString(16))},r.prototype.to4in6=function(){var e=this.to4(),t=new r(this.parsedAddress.slice(0,6).join(":"),6),i=t.correctForm(),n="";return/:$/.test(i)||(n=":"),i+n+e.address},r.prototype.inspectTeredo=function(){var e=this.getBitsBase16(0,32),t=this.getBits(80,96).xor(new Fn.BigInteger("ffff",16)).toString(),i=dh.Address4.fromHex(this.getBitsBase16(32,64)),n=dh.Address4.fromHex(this.getBits(96,128).xor(new Fn.BigInteger("ffffffff",16)).toString(16)),s=this.getBits(64,80),o=this.getBitsBase2(64,80),a=s.testBit(15),c=s.testBit(14),u=s.testBit(8),f=s.testBit(9),d=new Fn.BigInteger(o.slice(2,6)+o.slice(8,16),2).toString(10);return{prefix:Kn.sprintf("%s:%s",e.slice(0,4),e.slice(4,8)),server4:i.address,client4:n.address,flags:o,coneNat:a,microsoft:{reserved:c,universalLocal:f,groupIndividual:u,nonce:d},udpPort:t}},r.prototype.inspect6to4=function(){var e=this.getBitsBase16(0,16),t=dh.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:Kn.sprintf("%s",e.slice(0,4)),gateway:t.address}},r.prototype.to6to4=function(){if(!this.is4())return null;var e=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new r(e)},r.prototype.toByteArray=function(){var e=this.bigInteger().toByteArray();return e.length===17&&e[0]===0?e.slice(1):e},r.prototype.toUnsignedByteArray=function(){return this.toByteArray().map(iue)},r.fromByteArray=function(e){return this.fromUnsignedByteArray(e.map(iue))},r.fromUnsignedByteArray=function(e){for(var t=new Fn.BigInteger("256",10),i=new Fn.BigInteger("0",10),n=new Fn.BigInteger("1",10),s=e.length-1;s>=0;s--)i=i.add(n.multiply(new Fn.BigInteger(e[s].toString(10),10))),n=n.multiply(t);return r.fromBigInteger(i)},r.prototype.isCanonical=function(){return this.addressMinusSuffix===this.canonicalForm()},r.prototype.isLinkLocal=function(){return this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000"},r.prototype.isMulticast=function(){return this.getType()==="Multicast"},r.prototype.is4=function(){return this.v4},r.prototype.isTeredo=function(){return this.isInSubnet(new r("2001::/32"))},r.prototype.is6to4=function(){return this.isInSubnet(new r("2002::/16"))},r.prototype.isLoopback=function(){return this.getType()==="Loopback"},r.prototype.href=function(e){return e===void 0?e="":e=Kn.sprintf(":%s",e),Kn.sprintf("http://[%s]%s/",this.correctForm(),e)},r.prototype.link=function(e){e||(e={}),e.className===void 0&&(e.className=""),e.prefix===void 0&&(e.prefix="/#address="),e.v4===void 0&&(e.v4=!1);var t=this.correctForm;return e.v4&&(t=this.to4in6),e.className?Kn.sprintf('<a href="%1$s%2$s" class="%3$s">%2$s</a>',e.prefix,t.call(this),e.className):Kn.sprintf('<a href="%1$s%2$s">%2$s</a>',e.prefix,t.call(this))},r.prototype.group=function(){if(this.elidedGroups===0)return _T.simpleGroup(this.address).join(":");Qw(typeof this.elidedGroups=="number"),Qw(typeof this.elisionBegin=="number");var e=[],t=this.address.split("::"),i=t[0],n=t[1];i.length?e.push.apply(e,_T.simpleGroup(i)):e.push("");for(var s=["hover-group"],o=this.elisionBegin;o<this.elisionBegin+this.elidedGroups;o++)s.push(Kn.sprintf("group-%d",o));return e.push(Kn.sprintf('<span class="%s"></span>',s.join(" "))),n.length?e.push.apply(e,_T.simpleGroup(n,this.elisionEnd)):e.push(""),this.is4()&&(Qw(this.address4 instanceof dh.Address4),e.pop(),e.push(this.address4.groupForV6())),e.join(":")},r.prototype.regularExpressionString=function(e){e===void 0&&(e=!1);var t=[],i=new r(this.correctForm());if(i.elidedGroups===0)t.push(hh.simpleRegularExpression(i.parsedAddress));else if(i.elidedGroups===Tr.GROUPS)t.push(hh.possibleElisions(Tr.GROUPS));else{var n=i.address.split("::");n[0].length&&t.push(hh.simpleRegularExpression(n[0].split(":"))),Qw(typeof i.elidedGroups=="number"),t.push(hh.possibleElisions(i.elidedGroups,n[0].length!==0,n[1].length!==0)),n[1].length&&t.push(hh.simpleRegularExpression(n[1].split(":"))),t=[t.join(":")]}return e||(t=eue(eue(["(?=^|",hh.ADDRESS_BOUNDARY,"|[^\\w\\:])("],t),[")(?=[^\\w\\:]|",hh.ADDRESS_BOUNDARY,"|$)"])),t.join("")},r.prototype.regularExpression=function(e){return e===void 0&&(e=!1),new RegExp(this.regularExpressionString(e),"i")},r}();bo.Address6=DUe});var sue=m(En=>{l();"use strict";var NUe=En&&En.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),BUe=En&&En.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),LUe=En&&En.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&NUe(e,r,t);return BUe(e,r),e};Object.defineProperty(En,"__esModule",{value:!0});En.v6=En.AddressError=En.Address6=En.Address4=void 0;var MUe=gT();Object.defineProperty(En,"Address4",{enumerable:!0,get:function(){return MUe.Address4}});var jUe=nue();Object.defineProperty(En,"Address6",{enumerable:!0,get:function(){return jUe.Address6}});var qUe=Hw();Object.defineProperty(En,"AddressError",{enumerable:!0,get:function(){return qUe.AddressError}});var UUe=LUe(bT());En.v6={helpers:UUe}});var AT=m((eOt,ST)=>{l();"use strict";var oue=le(),FUe=Object.assign(oue("libp2p:ip-port-to-multiaddr"),{error:oue("libp2p:ip-port-to-multiaddr:err")}),{Multiaddr:vT}=lt(),ET=Hce(),{Address4:KUe,Address6:VUe}=sue(),Zw={ERR_INVALID_IP_PARAMETER:"ERR_INVALID_IP_PARAMETER",ERR_INVALID_PORT_PARAMETER:"ERR_INVALID_PORT_PARAMETER",ERR_INVALID_IP:"ERR_INVALID_IP"};function zUe(r,e){if(typeof r!="string")throw ET(new Error(`invalid ip provided: ${r}`),Zw.ERR_INVALID_IP_PARAMETER);if(typeof e=="string"&&(e=parseInt(e)),isNaN(e))throw ET(new Error(`invalid port provided: ${e}`),Zw.ERR_INVALID_PORT_PARAMETER);try{return new KUe(r),new vT(`/ip4/${r}/tcp/${e}`)}catch{}try{let t=new VUe(r);return t.is4()?new vT(`/ip4/${t.to4().correctForm()}/tcp/${e}`):new vT(`/ip6/${r}/tcp/${e}`)}catch(t){let i=`invalid ip:port for creating a multiaddr: ${r}:${e}`;throw FUe.error(i),ET(new Error(i),Zw.ERR_INVALID_IP)}}ST.exports=zUe;ST.exports.Errors=Zw});var cue=m((tOt,Jw)=>{l();"use strict";var RT=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},aue=(r,e,t,i)=>{let n,s=new Promise((o,a)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){o(r);return}i={customTimers:{setTimeout,clearTimeout},...i},n=i.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{o(t())}catch(f){a(f)}return}let c=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,u=t instanceof Error?t:new RT(c);typeof r.cancel=="function"&&r.cancel(),a(u)},e),(async()=>{try{o(await r)}catch(c){a(c)}finally{i.customTimers.clearTimeout.call(void 0,n)}})()});return s.clear=()=>{clearTimeout(n),n=void 0},s};Jw.exports=aue;Jw.exports.default=aue;Jw.exports.TimeoutError=RT});var hue=m((rOt,due)=>{l();"use strict";var uue=fa(),{CLOSE_TIMEOUT:HUe}=dT(),lue=AT(),$Ue=cue(),fue=le(),xT=fue("libp2p:websockets:socket");xT.error=fue("libp2p:websockets:socket:error");due.exports=(r,e={})=>{let t={async sink(i){e.signal&&(i=uue(i,e.signal));try{await r.sink(async function*(){for await(let n of i)yield n instanceof Uint8Array?n:n.slice()}())}catch(n){n.type!=="aborted"&&xT.error(n)}},source:e.signal?uue(r.source,e.signal):r.source,conn:r,localAddr:e.localAddr||(r.localAddress&&r.localPort?lue(r.localAddress,r.localPort):void 0),remoteAddr:e.remoteAddr||lue(r.remoteAddress,r.remotePort),timeline:{open:Date.now()},async close(){let i=Date.now();try{await $Ue(r.close(),HUe)}catch(n){let{host:s,port:o}=t.remoteAddr.toOptions();xT("timeout closing stream to %s:%s after %dms, destroying it manually",s,o,Date.now()-i),r.destroy()}finally{t.timeline.close=Date.now()}}};return r.socket.once&&r.socket.once("close",()=>{t.timeline.close||(t.timeline.close=Date.now())}),t}});var gue=m((iOt,yue)=>{l();"use strict";var cf=Kf(),{CODE_CIRCUIT:IT,CODE_P2P:TT,CODE_TCP:PT,CODE_WS:GUe,CODE_WSS:pue}=dT();yue.exports={all:r=>r.filter(e=>{if(e.protoCodes().includes(IT))return!1;let t=e.decapsulateCode(TT);return cf.WebSockets.matches(t)||cf.WebSocketsSecure.matches(t)}),dnsWss:r=>r.filter(e=>{if(e.protoCodes().includes(IT))return!1;let t=e.decapsulateCode(TT);return cf.WebSocketsSecure.matches(t)&&cf.DNS.matches(t.decapsulateCode(PT).decapsulateCode(pue))}),dnsWsOrWss:r=>r.filter(e=>{if(e.protoCodes().includes(IT))return!1;let t=e.decapsulateCode(TT);return cf.WebSockets.matches(t)?cf.DNS.matches(t.decapsulateCode(PT).decapsulateCode(GUe)):cf.WebSocketsSecure.matches(t)&&cf.DNS.matches(t.decapsulateCode(PT).decapsulateCode(pue))})}});var Sue=m((nOt,Eue)=>{l();"use strict";var WUe=Uce(),YUe=lb(),XUe=U6(),{AbortError:mue}=fa(),QUe=ec(),bue=le(),uf=bue("libp2p:websockets");uf.error=bue("libp2p:websockets:error");var wue=my(),ZUe=Kce(),JUe=hue(),_ue=gue(),vue=class{constructor({upgrader:e,filter:t}){if(!e)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e,this._filter=t}async dial(e,t={}){uf("dialing %s",e);let i=await this._connect(e,t),n=JUe(i,{remoteAddr:e,signal:t.signal});uf("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return uf("outbound connection %s upgraded",n.remoteAddr),s}async _connect(e,t={}){if(t.signal&&t.signal.aborted)throw new mue;let i=e.toOptions();uf("dialing %s:%s",i.host,i.port);let n=QUe(),s=u=>{let f=`connection error: ${u.message}`;uf.error(f),n.reject(u)},o=WUe(XUe(e),Object.assign({binary:!0},t));if(o.socket.on?o.socket.on("error",s):o.socket.onerror=s,!t.signal)return await Promise.race([o.connected(),n.promise]),uf("connected %s",e),o;let a,c=new Promise((u,f)=>{if(a=()=>{f(new mue),setTimeout(()=>{o.close()})},t.signal.aborted)return a();t.signal.addEventListener("abort",a)});try{await Promise.race([c,n.promise,o.connected()])}finally{t.signal.removeEventListener("abort",a)}return uf("connected %s",e),o}createListener(e={},t){return typeof e=="function"&&(t=e,e={}),ZUe({handler:t,upgrader:this._upgrader},e)}filter(e){return e=Array.isArray(e)?e:[e],this._filter?this._filter(e):wue.isBrowser||wue.isWebWorker?_ue.dnsWss(e):_ue.all(e)}};Eue.exports=YUe(vue,{className:"WebSockets",symbolName:"@libp2p/js-libp2p-websockets/websockets"})});var CT=m((sOt,Rue)=>{l();"use strict";function Aue(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function eFe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Aue(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Aue(new n,t)}}Rue.exports=eFe});var Iue=m((oOt,xue)=>{l();xue.exports=function(){if(typeof globalThis=="undefined")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}});var DT=m((aOt,kT)=>{l();"use strict";var OT=65536,tFe=4294967295;function rFe(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var iFe=Kx().Buffer,e8=globalThis.crypto||globalThis.msCrypto;e8&&e8.getRandomValues?kT.exports=nFe:kT.exports=rFe;function nFe(r,e){if(r>tFe)throw new RangeError("requested too many random bytes");var t=iFe.allocUnsafe(r);if(r>0)if(r>OT)for(var i=0;i<r;i+=OT)e8.getRandomValues(t.slice(i,i+OT));else e8.getRandomValues(t);return typeof e=="function"?process.nextTick(function(){e(null,t)}):t}});var Cue=m((cOt,Pue)=>{l();"use strict";function Tue(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function sFe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=void 0),e!=null&&(t.code=e);try{return Tue(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Tue(new n,t)}}Pue.exports=sFe});var LT=m((uOt,Nue)=>{l();var oFe=le()("simple-peer"),Oue=Iue(),kue=DT(),aFe=nI(),NT=Kg(),Pr=Cue(),BT=64*1024,cFe=5*1e3,uFe=5*1e3;function Due(r){return r.replace(/a=ice-options:trickle\s\n/g,"")}function lFe(r){console.warn(r)}var lf=class extends aFe.Duplex{constructor(e){e=Object.assign({allowHalfOpen:!1},e);super(e);if(this._id=kue(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||kue(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||lf.channelConfig,this.negotiated=this.channelConfig.negotiated,this.config=Object.assign({},lf.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(t=>t),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||cFe,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:Oue(),!this._wrtc)throw Pr(typeof window=="undefined"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=this.negotiated?!1:!this.initiator,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._firstStable=!0,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(t){NT(()=>this.destroy(Pr(t,"ERR_PC_CONSTRUCTOR")));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=t=>{this._onIceCandidate(t)},this.initiator||this.negotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=t=>{this._setupData(t)},this.streams&&this.streams.forEach(t=>{this.addStream(t)}),this._pc.ontrack=t=>{this._onTrack(t)},this.initiator&&this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(this.destroyed)throw Pr(new Error("cannot signal after peer is destroyed"),"ERR_SIGNALING");if(typeof e=="string")try{e=JSON.parse(e)}catch(t){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(t=>{this._addIceCandidate(t)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(t=>{this.destroy(Pr(t,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(Pr(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}_addIceCandidate(e){var t=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(t).catch(i=>{!t.address||t.address.endsWith(".local")?lFe("Ignoring unsupported ICE candidate."):this.destroy(Pr(i,"ERR_ADD_ICE_CANDIDATE"))})}send(e){this._channel.send(e)}addTransceiver(e,t){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,t),this._needsNegotiation()}catch(i){this.destroy(Pr(i,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{transceiverRequest:{kind:e,init:t}})}addStream(e){this._debug("addStream()"),e.getTracks().forEach(t=>{this.addTrack(t,e)})}addTrack(e,t){this._debug("addTrack()");var i=this._senderMap.get(e)||new Map,n=i.get(t);if(!n)n=this._pc.addTrack(e,t),i.set(t,n),this._senderMap.set(e,i),this._needsNegotiation();else throw n.removed?Pr(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):Pr(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,t,i){this._debug("replaceTrack()");var n=this._senderMap.get(e),s=n?n.get(i):null;if(!s)throw Pr(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");t&&this._senderMap.set(t,n),s.replaceTrack!=null?s.replaceTrack(t):this.destroy(Pr(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,t){this._debug("removeSender()");var i=this._senderMap.get(e),n=i?i.get(t):null;if(!n)throw Pr(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{n.removed=!0,this._pc.removeTrack(n)}catch(s){s.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(n):this.destroy(Pr(s,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){this._debug("removeSenders()"),e.getTracks().forEach(t=>{this.removeTrack(t,e)})}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,NT(()=>{this._batchedNegotiation=!1,this._debug("starting batched negotiation"),this.negotiate()}))}negotiate(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0}_destroy(e,t){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(i){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(i){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,t(e)}_setupData(e){if(!e.channel)return this.destroy(Pr(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=BT),this.channelName=this._channel.label,this._channel.onmessage=i=>{this._onChannelMessage(i)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=i=>{this.destroy(Pr(i,"ERR_DATA_CHANNEL"))};var t=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(t&&this._onChannelClose(),t=!0):t=!1},uFe)}_read(){}_write(e,t,i){if(this.destroyed)return i(Pr(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(n){return this.destroy(Pr(n,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>BT?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_onFinish(){if(this.destroyed)return;let e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Due(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let t=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp})}},i=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))},n=s=>{this.destroy(Pr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(Pr(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Due(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let t=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp}),this.initiator||this._requestMissingTransceivers()}},i=()=>{this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))},n=s=>{this.destroy(Pr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(Pr(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(Pr(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(Pr(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(Pr(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}}getStats(e){let t=i=>(Object.prototype.toString.call(i.values)==="[object Array]"&&i.values.forEach(n=>{Object.assign(i,n)}),i);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(i=>{var n=[];i.forEach(s=>{n.push(t(s))}),e(null,n)},i=>e(i)):this._pc.getStats.length>0?this._pc.getStats(i=>{if(!this.destroyed){var n=[];i.result().forEach(s=>{var o={};s.names().forEach(a=>{o[a]=s.stat(a)}),o.id=s.id,o.type=s.type,o.timestamp=s.timestamp,n.push(t(o))}),e(null,n)}},i=>e(i)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;let e=()=>{this.destroyed||this.getStats((t,i)=>{if(this.destroyed)return;t&&(i=[]);var n={},s={},o={},a=!1;i.forEach(f=>{(f.type==="remotecandidate"||f.type==="remote-candidate")&&(n[f.id]=f),(f.type==="localcandidate"||f.type==="local-candidate")&&(s[f.id]=f),(f.type==="candidatepair"||f.type==="candidate-pair")&&(o[f.id]=f)});let c=f=>{a=!0;var d=s[f.localCandidateId];d&&(d.ip||d.address)?(this.localAddress=d.ip||d.address,this.localPort=Number(d.port)):d&&d.ipAddress?(this.localAddress=d.ipAddress,this.localPort=Number(d.portNumber)):typeof f.googLocalAddress=="string"&&(d=f.googLocalAddress.split(":"),this.localAddress=d[0],this.localPort=Number(d[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");var h=n[f.remoteCandidateId];h&&(h.ip||h.address)?(this.remoteAddress=h.ip||h.address,this.remotePort=Number(h.port)):h&&h.ipAddress?(this.remoteAddress=h.ipAddress,this.remotePort=Number(h.portNumber)):typeof f.googRemoteAddress=="string"&&(h=f.googRemoteAddress.split(":"),this.remoteAddress=h[0],this.remotePort=Number(h[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach(f=>{f.type==="transport"&&f.selectedCandidatePairId&&c(o[f.selectedCandidatePairId]),(f.type==="googCandidatePair"&&f.googActiveConnection==="true"||(f.type==="candidatepair"||f.type==="candidate-pair")&&f.selected)&&c(f)}),!a&&(!Object.keys(o).length||Object.keys(s).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(f){return this.destroy(Pr(f,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');var u=this._cb;this._cb=null,u(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>BT||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&!this._firstStable&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation&&(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()),this._debug("negotiate"),this.emit("negotiate")),this._firstStable=!1,this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(!this.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=new Uint8Array(t)),this.push(t)}}_onChannelBufferedAmountLow(){if(!(this.destroyed||!this._cb)){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var e=this._cb;this._cb=null,e(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(t=>{this._debug("on track"),this.emit("track",e.track,t),this._remoteTracks.push({track:e.track,stream:t}),!this._remoteStreams.some(i=>i.id===t.id)&&(this._remoteStreams.push(t),NT(()=>{this.emit("stream",t)}))})}_debug(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],oFe.apply(null,e)}};lf.WEBRTC_SUPPORT=!!Oue();lf.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};lf.channelConfig={};Nue.exports=lf});var Lue=m((lOt,Bue)=>{l();"use strict";Bue.exports={supportsFileReader:typeof self!="undefined"&&"FileReader"in self,supportsWebRTC:"RTCPeerConnection"in globalThis&&typeof navigator!="undefined"&&typeof navigator.mediaDevices!="undefined"&&"getUserMedia"in navigator.mediaDevices,supportsWebRTCDataChannels:"RTCPeerConnection"in globalThis}});var r8=m(t8=>{l();"use strict";t8.CODE_P2P=421;t8.CODE_CIRCUIT=290;t8.CLOSE_TIMEOUT=2e3});var MT=m((dOt,Mue)=>{l();var fFe=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,dFe=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];Mue.exports=function(e){var t=e,i=e.indexOf("["),n=e.indexOf("]");i!=-1&&n!=-1&&(e=e.substring(0,i)+e.substring(i,n).replace(/:/g,";")+e.substring(n,e.length));for(var s=fFe.exec(e||""),o={},a=14;a--;)o[dFe[a]]=s[a]||"";return i!=-1&&n!=-1&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=hFe(o,o.path),o.queryKey=pFe(o,o.query),o};function hFe(r,e){var t=/\/{2,9}/g,i=e.replace(t,"/").split("/");return(e.substr(0,1)=="/"||e.length===0)&&i.splice(0,1),e.substr(e.length-1,1)=="/"&&i.splice(i.length-1,1),i}function pFe(r,e){var t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,n,s){n&&(t[n]=s)}),t}});var Uue=m(_1=>{l();"use strict";var jue=_1&&_1.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(_1,"__esModule",{value:!0});_1.url=void 0;var yFe=jue(MT()),gFe=jue(le()),que=gFe.default("socket.io-client:url");function mFe(r,e="",t){let i=r;t=t||typeof location!="undefined"&&location,r==null&&(r=t.protocol+"//"+t.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=t.protocol+r:r=t.host+r),/^(https?|wss?):\/\//.test(r)||(que("protocol-less url %s",r),typeof t!="undefined"?r=t.protocol+"//"+r:r="https://"+r),que("parse %s",r),i=yFe.default(r)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";let s=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port+e,i.href=i.protocol+"://"+s+(t&&t.port===i.port?"":":"+i.port),i}_1.url=mFe});var Fue=m((pOt,jT)=>{l();try{jT.exports=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch(r){jT.exports=!1}});var wm=m(qT=>{l();"use strict";Object.defineProperty(qT,"__esModule",{value:!0});qT.default=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:Function("return this")())()});var Vue=m(_m=>{l();"use strict";var Kue=_m&&_m.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(_m,"__esModule",{value:!0});var bFe=Kue(Fue()),wFe=Kue(wm());function _Fe(r){let e=r.xdomain;try{if(typeof XMLHttpRequest!="undefined"&&(!e||bFe.default))return new XMLHttpRequest}catch(t){}if(!e)try{return new wFe.default[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(t){}}_m.default=_Fe});var v1=m(ff=>{l();"use strict";var vFe=ff&&ff.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ff,"__esModule",{value:!0});ff.installTimerFunctions=ff.pick=void 0;var i8=vFe(wm());function EFe(r,...e){return e.reduce((t,i)=>(r.hasOwnProperty(i)&&(t[i]=r[i]),t),{})}ff.pick=EFe;var SFe=setTimeout,AFe=clearTimeout;function RFe(r,e){e.useNativeTimers?(r.setTimeoutFn=SFe.bind(i8.default),r.clearTimeoutFn=AFe.bind(i8.default)):(r.setTimeoutFn=setTimeout.bind(i8.default),r.clearTimeoutFn=clearTimeout.bind(i8.default))}ff.installTimerFunctions=RFe});var ph=m(zue=>{l();zue.Emitter=Vn;function Vn(r){if(r)return xFe(r)}function xFe(r){for(var e in Vn.prototype)r[e]=Vn.prototype[e];return r}Vn.prototype.on=Vn.prototype.addEventListener=function(r,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(e),this};Vn.prototype.once=function(r,e){function t(){this.off(r,t),e.apply(this,arguments)}return t.fn=e,this.on(r,t),this};Vn.prototype.off=Vn.prototype.removeListener=Vn.prototype.removeAllListeners=Vn.prototype.removeEventListener=function(r,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+r];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var i,n=0;n<t.length;n++)if(i=t[n],i===e||i.fn===e){t.splice(n,1);break}return t.length===0&&delete this._callbacks["$"+r],this};Vn.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+r],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(t){t=t.slice(0);for(var i=0,n=t.length;i<n;++i)t[i].apply(this,e)}return this};Vn.prototype.emitReserved=Vn.prototype.emit;Vn.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};Vn.prototype.hasListeners=function(r){return!!this.listeners(r).length}});var UT=m(df=>{l();"use strict";Object.defineProperty(df,"__esModule",{value:!0});df.ERROR_PACKET=df.PACKET_TYPES_REVERSE=df.PACKET_TYPES=void 0;var Ec=Object.create(null);df.PACKET_TYPES=Ec;Ec.open="0";Ec.close="1";Ec.ping="2";Ec.pong="3";Ec.message="4";Ec.upgrade="5";Ec.noop="6";var Hue=Object.create(null);df.PACKET_TYPES_REVERSE=Hue;Object.keys(Ec).forEach(r=>{Hue[Ec[r]]=r});var IFe={type:"error",data:"parser error"};df.ERROR_PACKET=IFe});var Gue=m(FT=>{l();"use strict";Object.defineProperty(FT,"__esModule",{value:!0});var TFe=UT(),PFe=typeof Blob=="function"||typeof Blob!="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",CFe=typeof ArrayBuffer=="function",OFe=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,kFe=({type:r,data:e},t,i)=>PFe&&e instanceof Blob?t?i(e):$ue(e,i):CFe&&(e instanceof ArrayBuffer||OFe(e))?t?i(e):$ue(new Blob([e]),i):i(TFe.PACKET_TYPES[r]+(e||"")),$ue=(r,e)=>{let t=new FileReader;return t.onload=function(){let i=t.result.split(",")[1];e("b"+i)},t.readAsDataURL(r)};FT.default=kFe});var Yue=m((n8,Wue)=>{l();(function(r,e){typeof n8=="object"&&typeof Wue!="undefined"?e(n8):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r["base64-arraybuffer"]={}))})(n8,function(r){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=typeof Uint8Array=="undefined"?[]:new Uint8Array(256),i=0;i<e.length;i++)t[e.charCodeAt(i)]=i;var n=function(o){var a=new Uint8Array(o),c,u=a.length,f="";for(c=0;c<u;c+=3)f+=e[a[c]>>2],f+=e[(a[c]&3)<<4|a[c+1]>>4],f+=e[(a[c+1]&15)<<2|a[c+2]>>6],f+=e[a[c+2]&63];return u%3==2?f=f.substring(0,f.length-1)+"=":u%3==1&&(f=f.substring(0,f.length-2)+"=="),f},s=function(o){var a=o.length*.75,c=o.length,u,f=0,d,h,p,y;o[o.length-1]==="="&&(a--,o[o.length-2]==="="&&a--);var g=new ArrayBuffer(a),w=new Uint8Array(g);for(u=0;u<c;u+=4)d=t[o.charCodeAt(u)],h=t[o.charCodeAt(u+1)],p=t[o.charCodeAt(u+2)],y=t[o.charCodeAt(u+3)],w[f++]=d<<2|h>>4,w[f++]=(h&15)<<4|p>>2,w[f++]=(p&3)<<6|y&63;return g};r.decode=s,r.encode=n,Object.defineProperty(r,"__esModule",{value:!0})})});var Que=m(KT=>{l();"use strict";Object.defineProperty(KT,"__esModule",{value:!0});var s8=UT(),DFe=Yue(),NFe=typeof ArrayBuffer=="function",BFe=(r,e)=>{if(typeof r!="string")return{type:"message",data:Xue(r,e)};let t=r.charAt(0);return t==="b"?{type:"message",data:LFe(r.substring(1),e)}:s8.PACKET_TYPES_REVERSE[t]?r.length>1?{type:s8.PACKET_TYPES_REVERSE[t],data:r.substring(1)}:{type:s8.PACKET_TYPES_REVERSE[t]}:s8.ERROR_PACKET},LFe=(r,e)=>{if(NFe){let t=(0,DFe.decode)(r);return Xue(t,e)}else return{base64:!0,data:r}},Xue=(r,e)=>{switch(e){case"blob":return r instanceof ArrayBuffer?new Blob([r]):r;case"arraybuffer":default:return r}};KT.default=BFe});var vm=m(wo=>{l();"use strict";Object.defineProperty(wo,"__esModule",{value:!0});wo.decodePayload=wo.decodePacket=wo.encodePayload=wo.encodePacket=wo.protocol=void 0;var Zue=Gue();wo.encodePacket=Zue.default;var Jue=Que();wo.decodePacket=Jue.default;var ele=String.fromCharCode(30),MFe=(r,e)=>{let t=r.length,i=new Array(t),n=0;r.forEach((s,o)=>{(0,Zue.default)(s,!1,a=>{i[o]=a,++n===t&&e(i.join(ele))})})};wo.encodePayload=MFe;var jFe=(r,e)=>{let t=r.split(ele),i=[];for(let n=0;n<t.length;n++){let s=(0,Jue.default)(t[n],e);if(i.push(s),s.type==="error")break}return i};wo.decodePayload=jFe;wo.protocol=4});var o8=m(E1=>{l();"use strict";var qFe=E1&&E1.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(E1,"__esModule",{value:!0});E1.Transport=void 0;var UFe=vm(),FFe=ph(),KFe=v1(),VFe=qFe(le()),zFe=(0,VFe.default)("engine.io-client:transport"),tle=class extends FFe.Emitter{constructor(e){super();this.writable=!1,(0,KFe.installTimerFunctions)(this,e),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,t){let i=new Error(e);return i.type="TransportError",i.description=t,super.emit("error",i),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"?this.write(e):zFe("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emit("open")}onData(e){let t=(0,UFe.decodePacket)(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emit("packet",e)}onClose(){this.readyState="closed",super.emit("close")}};E1.Transport=tle});var HT=m((AOt,ole)=>{l();"use strict";var rle="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a8=64,ile={},nle=0,hf=0,sle;function VT(r){var e="";do e=rle[r%a8]+e,r=Math.floor(r/a8);while(r>0);return e}function HFe(r){var e=0;for(hf=0;hf<r.length;hf++)e=e*a8+ile[r.charAt(hf)];return e}function zT(){var r=VT(+new Date);return r!==sle?(nle=0,sle=r):r+"."+VT(nle++)}for(;hf<a8;hf++)ile[rle[hf]]=hf;zT.encode=VT;zT.decode=HFe;ole.exports=zT});var c8=m($T=>{l();$T.encode=function(r){var e="";for(var t in r)r.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(r[t]));return e};$T.decode=function(r){for(var e={},t=r.split("&"),i=0,n=t.length;i<n;i++){var s=t[i].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}});var ule=m(S1=>{l();"use strict";var GT=S1&&S1.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(S1,"__esModule",{value:!0});S1.Polling=void 0;var $Fe=o8(),GFe=GT(le()),WFe=GT(HT()),YFe=GT(c8()),ale=vm(),ya=(0,GFe.default)("engine.io-client:polling"),cle=class extends $Fe.Transport{constructor(){super(...arguments);this.polling=!1}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let t=()=>{ya("paused"),this.readyState="paused",e()};if(this.polling||!this.writable){let i=0;this.polling&&(ya("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){ya("pre-pause polling complete"),--i||t()})),this.writable||(ya("we are currently writing - waiting to pause"),i++,this.once("drain",function(){ya("pre-pause writing complete"),--i||t()}))}else t()}poll(){ya("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}onData(e){ya("polling got data %s",e);let t=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose(),!1;this.onPacket(i)};(0,ale.decodePayload)(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emit("pollComplete"),this.readyState==="open"?this.poll():ya('ignoring poll - transport state "%s"',this.readyState))}doClose(){let e=()=>{ya("writing close packet"),this.write([{type:"close"}])};this.readyState==="open"?(ya("transport open - closing"),e()):(ya("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,(0,ale.encodePayload)(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emit("drain")})})}uri(){let e=this.query||{},t=this.opts.secure?"https":"http",i="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=(0,WFe.default)()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.opts.port&&(t==="https"&&Number(this.opts.port)!==443||t==="http"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port);let n=YFe.default.encode(e),s=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(n.length?"?"+n:"")}};S1.Polling=cle});var ple=m(pf=>{l();"use strict";var WT=pf&&pf.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(pf,"__esModule",{value:!0});pf.Request=pf.XHR=void 0;var lle=WT(Vue()),XFe=WT(le()),QFe=WT(wm()),fle=v1(),ZFe=ph(),JFe=ule(),YT=(0,XFe.default)("engine.io-client:polling-xhr");function eKe(){}var tKe=function(){return new lle.default({xdomain:!1}).responseType!=null}(),dle=class extends JFe.Polling{constructor(e){super(e);if(typeof location!="undefined"){let i=location.protocol==="https:",n=location.port;n||(n=i?"443":"80"),this.xd=typeof location!="undefined"&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==i}let t=e&&e.forceBase64;this.supportsBinary=tKe&&!t}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new _o(this.uri(),e)}doWrite(e,t){let i=this.request({method:"POST",data:e});i.on("success",t),i.on("error",n=>{this.onError("xhr post error",n)})}doPoll(){YT("xhr poll");let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",t=>{this.onError("xhr poll error",t)}),this.pollXhr=e}};pf.XHR=dle;var _o=class extends ZFe.Emitter{constructor(e,t){super();(0,fle.installTimerFunctions)(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=t.async!==!1,this.data=t.data!==void 0?t.data:null,this.create()}create(){let e=(0,fle.pick)(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;let t=this.xhr=new lle.default(e);try{YT("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let i in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.opts.extraHeaders[i])}}catch(i){}if(this.method==="POST")try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(i){}try{t.setRequestHeader("Accept","*/*")}catch(i){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),t.onreadystatechange=()=>{t.readyState===4&&(t.status===200||t.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof t.status=="number"?t.status:0)},0))},YT("xhr data %s",this.data),t.send(this.data)}catch(i){this.setTimeoutFn(()=>{this.onError(i)},0);return}typeof document!="undefined"&&(this.index=_o.requestsCount++,_o.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(e){this.emit("data",e),this.onSuccess()}onError(e){this.emit("error",e),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr=="undefined"||this.xhr===null)){if(this.xhr.onreadystatechange=eKe,e)try{this.xhr.abort()}catch(t){}typeof document!="undefined"&&delete _o.requests[this.index],this.xhr=null}}onLoad(){let e=this.xhr.responseText;e!==null&&this.onData(e)}abort(){this.cleanup()}};pf.Request=_o;_o.requestsCount=0;_o.requests={};if(typeof document!="undefined"){if(typeof attachEvent=="function")attachEvent("onunload",hle);else if(typeof addEventListener=="function"){let r="onpagehide"in QFe.default?"pagehide":"unload";addEventListener(r,hle,!1)}}function hle(){for(let r in _o.requests)_o.requests.hasOwnProperty(r)&&_o.requests[r].abort()}});var gle=m(vo=>{l();"use strict";var rKe=vo&&vo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(vo,"__esModule",{value:!0});vo.defaultBinaryType=vo.usingBrowserWebSocket=vo.WebSocket=vo.nextTick=void 0;var yle=rKe(wm());vo.nextTick=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0))();vo.WebSocket=yle.default.WebSocket||yle.default.MozWebSocket;vo.usingBrowserWebSocket=!0;vo.defaultBinaryType="arraybuffer"});var ble=m(A1=>{l();"use strict";var XT=A1&&A1.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(A1,"__esModule",{value:!0});A1.WS=void 0;var iKe=o8(),nKe=XT(c8()),sKe=XT(HT()),oKe=v1(),Sc=gle(),aKe=XT(le()),cKe=vm(),uKe=(0,aKe.default)("engine.io-client:websocket"),mle=typeof navigator!="undefined"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",u8=class extends iKe.Transport{constructor(e){super(e);this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),t=this.opts.protocols,i=mle?{}:(0,oKe.pick)(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=Sc.usingBrowserWebSocket&&!mle?t?new Sc.WebSocket(e,t):new Sc.WebSocket(e):new Sc.WebSocket(e,t,i)}catch(n){return this.emit("error",n)}this.ws.binaryType=this.socket.binaryType||Sc.defaultBinaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let i=e[t],n=t===e.length-1;(0,cKe.encodePacket)(i,this.supportsBinary,s=>{let o={};Sc.usingBrowserWebSocket||(i.options&&(o.compress=i.options.compress),this.opts.perMessageDeflate&&(typeof s=="string"?Buffer.byteLength(s):s.length)<this.opts.perMessageDeflate.threshold&&(o.compress=!1));try{Sc.usingBrowserWebSocket?this.ws.send(s):this.ws.send(s,o)}catch(a){uKe("websocket closed before onclose event")}n&&(0,Sc.nextTick)(()=>{this.writable=!0,this.emit("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws!="undefined"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{},t=this.opts.secure?"wss":"ws",i="";this.opts.port&&(t==="wss"&&Number(this.opts.port)!==443||t==="ws"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=(0,sKe.default)()),this.supportsBinary||(e.b64=1);let n=nKe.default.encode(e),s=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(n.length?"?"+n:"")}check(){return!!Sc.WebSocket&&!("__initialize"in Sc.WebSocket&&this.name===u8.prototype.name)}};A1.WS=u8});var QT=m(l8=>{l();"use strict";Object.defineProperty(l8,"__esModule",{value:!0});l8.transports=void 0;var lKe=ple(),fKe=ble();l8.transports={websocket:fKe.WS,polling:lKe.XHR}});var vle=m(R1=>{l();"use strict";var ZT=R1&&R1.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(R1,"__esModule",{value:!0});R1.Socket=void 0;var dKe=QT(),hKe=v1(),pKe=ZT(c8()),wle=ZT(MT()),yKe=ZT(le()),gKe=ph(),_le=vm(),bi=(0,yKe.default)("engine.io-client:socket"),xu=class extends gKe.Emitter{constructor(e,t={}){super();e&&typeof e=="object"&&(t=e,e=null),e?(e=(0,wle.default)(e),t.hostname=e.host,t.secure=e.protocol==="https"||e.protocol==="wss",t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=(0,wle.default)(t.host).host),(0,hKe.installTimerFunctions)(this,t),this.secure=t.secure!=null?t.secure:typeof location!="undefined"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location!="undefined"?location.hostname:"localhost"),this.port=t.port||(typeof location!="undefined"&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=pKe.default.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){bi('creating transport "%s"',e);let t=mKe(this.opts.query);t.EIO=_le.protocol,t.transport=e,this.id&&(t.sid=this.id);let i=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return bi("options: %j",i),new dKe.transports[e](i)}open(){let e;if(this.opts.rememberUpgrade&&xu.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch(t){bi("error while creating transport: %s",t),this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){bi("setting transport %s",e.name),this.transport&&(bi("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",()=>{this.onClose("transport close")})}probe(e){bi('probing transport "%s"',e);let t=this.createTransport(e),i=!1;xu.priorWebsocketSuccess=!1;let n=()=>{i||(bi('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",d=>{if(!i)if(d.type==="pong"&&d.data==="probe"){if(bi('probe transport "%s" pong',e),this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;xu.priorWebsocketSuccess=t.name==="websocket",bi('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{i||this.readyState!=="closed"&&(bi("changing transport and sending upgrade packet"),f(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{bi('probe transport "%s" failed',e);let h=new Error("probe error");h.transport=t.name,this.emitReserved("upgradeError",h)}}))};function s(){i||(i=!0,f(),t.close(),t=null)}let o=d=>{let h=new Error("probe error: "+d);h.transport=t.name,s(),bi('probe transport "%s" failed because of error: %s',e,d),this.emitReserved("upgradeError",h)};function a(){o("transport closed")}function c(){o("socket closed")}function u(d){t&&d.name!==t.name&&(bi('"%s" works - aborting "%s"',d.name,t.name),s())}let f=()=>{t.removeListener("open",n),t.removeListener("error",o),t.removeListener("close",a),this.off("close",c),this.off("upgrading",u)};t.once("open",n),t.once("error",o),t.once("close",a),this.once("close",c),this.once("upgrading",u),t.open()}onOpen(){if(bi("socket open"),this.readyState="open",xu.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){bi("starting upgrade probes");let e=0,t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(bi('socket receive: type "%s", data "%s"',e.type,e.data),this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}else bi('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(bi("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emitReserved("flush"))}write(e,t,i){return this.sendPacket("message",e,t,i),this}send(e,t,i){return this.sendPacket("message",e,t,i),this}sendPacket(e,t,i,n){if(typeof t=="function"&&(n=t,t=void 0),typeof i=="function"&&(n=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;let s={type:e,data:t,options:i};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){let e=()=>{this.onClose("forced close"),bi("socket closing - telling transport to close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},i=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}onError(e){bi("socket error %j",e),xu.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(bi('socket close with reason: "%s"',e),this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){let t=[],i=0,n=e.length;for(;i<n;i++)~this.transports.indexOf(e[i])&&t.push(e[i]);return t}};R1.Socket=xu;xu.protocol=_le.protocol;function mKe(r){let e={};for(let t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e}});var Sle=m(Eo=>{l();"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});Eo.installTimerFunctions=Eo.transports=Eo.Transport=Eo.protocol=Eo.Socket=void 0;var Ele=vle();Object.defineProperty(Eo,"Socket",{enumerable:!0,get:function(){return Ele.Socket}});Eo.protocol=Ele.Socket.protocol;var bKe=o8();Object.defineProperty(Eo,"Transport",{enumerable:!0,get:function(){return bKe.Transport}});var wKe=QT();Object.defineProperty(Eo,"transports",{enumerable:!0,get:function(){return wKe.transports}});var _Ke=v1();Object.defineProperty(Eo,"installTimerFunctions",{enumerable:!0,get:function(){return _Ke.installTimerFunctions}})});var JT=m(x1=>{l();"use strict";Object.defineProperty(x1,"__esModule",{value:!0});x1.hasBinary=x1.isBinary=void 0;var vKe=typeof ArrayBuffer=="function",EKe=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,Ale=Object.prototype.toString,SKe=typeof Blob=="function"||typeof Blob!="undefined"&&Ale.call(Blob)==="[object BlobConstructor]",AKe=typeof File=="function"||typeof File!="undefined"&&Ale.call(File)==="[object FileConstructor]";function Rle(r){return vKe&&(r instanceof ArrayBuffer||EKe(r))||SKe&&r instanceof Blob||AKe&&r instanceof File}x1.isBinary=Rle;function f8(r,e){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let t=0,i=r.length;t<i;t++)if(f8(r[t]))return!0;return!1}if(Rle(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return f8(r.toJSON(),!0);for(let t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&f8(r[t]))return!0;return!1}x1.hasBinary=f8});var xle=m(I1=>{l();"use strict";Object.defineProperty(I1,"__esModule",{value:!0});I1.reconstructPacket=I1.deconstructPacket=void 0;var RKe=JT();function xKe(r){let e=[],t=r.data,i=r;return i.data=eP(t,e),i.attachments=e.length,{packet:i,buffers:e}}I1.deconstructPacket=xKe;function eP(r,e){if(!r)return r;if(RKe.isBinary(r)){let t={_placeholder:!0,num:e.length};return e.push(r),t}else if(Array.isArray(r)){let t=new Array(r.length);for(let i=0;i<r.length;i++)t[i]=eP(r[i],e);return t}else if(typeof r=="object"&&!(r instanceof Date)){let t={};for(let i in r)r.hasOwnProperty(i)&&(t[i]=eP(r[i],e));return t}return r}function IKe(r,e){return r.data=tP(r.data,e),r.attachments=void 0,r}I1.reconstructPacket=IKe;function tP(r,e){if(!r)return r;if(r&&r._placeholder)return e[r.num];if(Array.isArray(r))for(let t=0;t<r.length;t++)r[t]=tP(r[t],e);else if(typeof r=="object")for(let t in r)r.hasOwnProperty(t)&&(r[t]=tP(r[t],e));return r}});var h8=m(ga=>{l();"use strict";Object.defineProperty(ga,"__esModule",{value:!0});ga.Decoder=ga.Encoder=ga.PacketType=ga.protocol=void 0;var TKe=ph(),Ile=xle(),Tle=JT(),PKe=le(),rP=PKe.default("socket.io-parser");ga.protocol=5;var ki;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(ki=ga.PacketType||(ga.PacketType={}));var Ple=class{encode(e){return rP("encoding packet %j",e),(e.type===ki.EVENT||e.type===ki.ACK)&&Tle.hasBinary(e)?(e.type=e.type===ki.EVENT?ki.BINARY_EVENT:ki.BINARY_ACK,this.encodeAsBinary(e)):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===ki.BINARY_EVENT||e.type===ki.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data)),rP("encoded %j as %s",e,t),t}encodeAsBinary(e){let t=Ile.deconstructPacket(e),i=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(i),n}};ga.Encoder=Ple;var d8=class extends TKe.Emitter{constructor(){super()}add(e){let t;if(typeof e=="string")t=this.decodeString(e),t.type===ki.BINARY_EVENT||t.type===ki.BINARY_ACK?(this.reconstructor=new Cle(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t);else if(Tle.isBinary(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0,i={type:Number(e.charAt(0))};if(ki[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===ki.BINARY_EVENT||i.type===ki.BINARY_ACK){let s=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);let o=e.substring(s,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(e.charAt(t+1)==="/"){let s=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););i.nsp=e.substring(s,t)}else i.nsp="/";let n=e.charAt(t+1);if(n!==""&&Number(n)==n){let s=t+1;for(;++t;){let o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}i.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){let s=CKe(e.substr(t));if(d8.isPayloadValid(i.type,s))i.data=s;else throw new Error("invalid payload")}return rP("decoded %s as %j",e,i),i}static isPayloadValid(e,t){switch(e){case ki.CONNECT:return typeof t=="object";case ki.DISCONNECT:return t===void 0;case ki.CONNECT_ERROR:return typeof t=="string"||typeof t=="object";case ki.EVENT:case ki.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case ki.ACK:case ki.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}};ga.Decoder=d8;function CKe(r){try{return JSON.parse(r)}catch(e){return!1}}var Cle=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let t=Ile.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}});var iP=m(p8=>{l();"use strict";Object.defineProperty(p8,"__esModule",{value:!0});p8.on=void 0;function OKe(r,e,t){return r.on(e,t),function(){r.off(e,t)}}p8.on=OKe});var nP=m(T1=>{l();"use strict";var kKe=T1&&T1.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(T1,"__esModule",{value:!0});T1.Socket=void 0;var So=h8(),y8=iP(),DKe=ph(),NKe=kKe(le()),cs=NKe.default("socket.io-client:socket"),BKe=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),Ole=class extends DKe.Emitter{constructor(e,t,i){super();this.connected=!1,this.disconnected=!0,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,i&&i.auth&&(this.auth=i.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;let e=this.io;this.subs=[y8.on(e,"open",this.onopen.bind(this)),y8.on(e,"packet",this.onpacket.bind(this)),y8.on(e,"error",this.onerror.bind(this)),y8.on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(BKe.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');t.unshift(e);let i={type:So.PacketType.EVENT,data:t};if(i.options={},i.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){let o=this.ids++;cs("emitting packet with ack id %d",o);let a=t.pop();this._registerAckCallback(o,a),i.id=o}let n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)?cs("discard packet as the transport is not currently writable"):this.connected?this.packet(i):this.sendBuffer.push(i),this.flags={},this}_registerAckCallback(e,t){let i=this.flags.timeout;if(i===void 0){this.acks[e]=t;return}let n=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let s=0;s<this.sendBuffer.length;s++)this.sendBuffer[s].id===e&&(cs("removing packet with ack id %d from the buffer",e),this.sendBuffer.splice(s,1));cs("event with ack id %d has timed out after %d ms",e,i),t.call(this,new Error("operation has timed out"))},i);this.acks[e]=(...s)=>{this.io.clearTimeoutFn(n),t.apply(this,[null,...s])}}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){cs("transport is open - connecting"),typeof this.auth=="function"?this.auth(e=>{this.packet({type:So.PacketType.CONNECT,data:e})}):this.packet({type:So.PacketType.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e){cs("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",e)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case So.PacketType.CONNECT:if(e.data&&e.data.sid){let n=e.data.sid;this.onconnect(n)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case So.PacketType.EVENT:this.onevent(e);break;case So.PacketType.BINARY_EVENT:this.onevent(e);break;case So.PacketType.ACK:this.onack(e);break;case So.PacketType.BINARY_ACK:this.onack(e);break;case So.PacketType.DISCONNECT:this.ondisconnect();break;case So.PacketType.CONNECT_ERROR:this.destroy();let i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){let t=e.data||[];cs("emitting event %j",t),e.id!=null&&(cs("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let t=this._anyListeners.slice();for(let i of t)i.apply(this,e)}super.emit.apply(this,e)}ack(e){let t=this,i=!1;return function(...n){i||(i=!0,cs("sending ack %j",n),t.packet({type:So.PacketType.ACK,id:e,data:n}))}}onack(e){let t=this.acks[e.id];typeof t=="function"?(cs("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):cs("bad ack %s",e.id)}onconnect(e){cs("socket connected with id %s",e),this.id=e,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>this.packet(e)),this.sendBuffer=[]}ondisconnect(){cs("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(cs("performing disconnect (%s)",this.nsp),this.packet({type:So.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}};T1.Socket=Ole});var Dle=m((jOt,kle)=>{l();kle.exports=P1;function P1(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}P1.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*r);r=(Math.floor(e*10)&1)==0?r-t:r+t}return Math.min(r,this.max)|0};P1.prototype.reset=function(){this.attempts=0};P1.prototype.setMin=function(r){this.ms=r};P1.prototype.setMax=function(r){this.max=r};P1.prototype.setJitter=function(r){this.jitter=r}});var Mle=m(Ao=>{l();"use strict";var LKe=Ao&&Ao.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),MKe=Ao&&Ao.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),jKe=Ao&&Ao.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&LKe(e,r,t);return MKe(e,r),e},Nle=Ao&&Ao.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ao,"__esModule",{value:!0});Ao.Manager=void 0;var Ble=Sle(),qKe=nP(),UKe=jKe(h8()),yh=iP(),FKe=Nle(Dle()),KKe=ph(),VKe=Nle(le()),ln=VKe.default("socket.io-client:manager"),Lle=class extends KKe.Emitter{constructor(e,t){var i;super();this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Ble.installTimerFunctions(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((i=t.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new FKe.default({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;let n=t.parser||UKe;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(ln("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;ln("opening %s",this.uri),this.engine=new Ble.Socket(this.uri,this.opts);let t=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;let n=yh.on(t,"open",function(){i.onopen(),e&&e()}),s=yh.on(t,"error",o=>{ln("error"),i.cleanup(),i._readyState="closed",this.emitReserved("error",o),e?e(o):i.maybeReconnectOnOpen()});if(this._timeout!==!1){let o=this._timeout;ln("connect attempt will timeout after %d",o),o===0&&n();let a=this.setTimeoutFn(()=>{ln("connect attempt timed out after %d",o),n(),t.close(),t.emit("error",new Error("timeout"))},o);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(n),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){ln("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(yh.on(e,"ping",this.onping.bind(this)),yh.on(e,"data",this.ondata.bind(this)),yh.on(e,"error",this.onerror.bind(this)),yh.on(e,"close",this.onclose.bind(this)),yh.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){this.emitReserved("packet",e)}onerror(e){ln("error",e),this.emitReserved("error",e)}socket(e,t){let i=this.nsps[e];return i||(i=new qKe.Socket(this,e,t),this.nsps[e]=i),i}_destroy(e){let t=Object.keys(this.nsps);for(let i of t)if(this.nsps[i].active){ln("socket %s is still active, skipping close",i);return}this._close()}_packet(e){ln("writing packet %j",e);let t=this.encoder.encode(e);for(let i=0;i<t.length;i++)this.engine.write(t[i],e.options)}cleanup(){ln("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){ln("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e){ln("closed due to %s",e),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)ln("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();ln("will wait %dms before reconnect attempt",t),this._reconnecting=!0;let i=this.setTimeoutFn(()=>{e.skipReconnect||(ln("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(ln("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):(ln("reconnect success"),e.onreconnect())}))},t);this.opts.autoUnref&&i.unref(),this.subs.push(function(){clearTimeout(i)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};Ao.Manager=Lle});var Fle=m((Sn,Ule)=>{l();"use strict";var zKe=Sn&&Sn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Sn,"__esModule",{value:!0});Sn.default=Sn.connect=Sn.io=Sn.Socket=Sn.Manager=Sn.protocol=void 0;var HKe=Uue(),g8=Mle();Object.defineProperty(Sn,"Manager",{enumerable:!0,get:function(){return g8.Manager}});var jle=nP();Object.defineProperty(Sn,"Socket",{enumerable:!0,get:function(){return jle.Socket}});var $Ke=zKe(le()),qle=$Ke.default("socket.io-client"),Em={};function gh(r,e){typeof r=="object"&&(e=r,r=void 0),e=e||{};let t=HKe.url(r,e.path||"/socket.io"),i=t.source,n=t.id,s=t.path,o=Em[n]&&s in Em[n].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o,c;return a?(qle("ignoring socket cache for %s",i),c=new g8.Manager(i,e)):(Em[n]||(qle("new io instance for %s",i),Em[n]=new g8.Manager(i,e)),c=Em[n]),t.query&&!e.query&&(e.query=t.queryKey),c.socket(t.path,e)}Sn.io=gh;Sn.connect=gh;Sn.default=gh;Object.assign(gh,{Manager:g8.Manager,Socket:jle.Socket,io:gh,connect:gh});var GKe=h8();Object.defineProperty(Sn,"protocol",{enumerable:!0,get:function(){return GKe.protocol}});Ule.exports=gh});var sP=m((UOt,Kle)=>{l();var WKe=gw();Kle.exports=r=>async e=>{e=WKe(e);let t=b=>{typeof b.return=="function"&&b.return()},i=null,n=null,s=b=>{i=b,n&&n(b),t(e)},o=null,a=!1,c=()=>{a=!0,o&&o()},u=null,f=!1,d=()=>{f=!0,u&&u()},h=null,p=()=>{h&&h()},y=()=>new Promise((b,v)=>{o=h=b,n=v,r.once("drain",p)}),g=()=>(t(e),new Promise((b,v)=>{if(a||f||i)return b();u=o=b,n=v})),w=()=>{r.removeListener("error",s),r.removeListener("close",c),r.removeListener("finish",d),r.removeListener("drain",p)};r.once("error",s),r.once("close",c),r.once("finish",d);try{for await(let b of e){if(!r.writable||r.destroyed||i)break;r.write(b)===!1&&await y()}}catch(b){i||r.destroy(),i=b}try{if(r.writable&&r.end(),await g(),i)throw i}finally{w()}}});var oP=m((FOt,Vle)=>{l();var YKe=sP(),XKe=ym();Vle.exports=r=>({sink:YKe(r),source:XKe(r)})});var Hle=m((KOt,zle)=>{l();var QKe=oP();zle.exports=r=>async function*(e){let t=QKe(r),i;if(t.sink(e).catch(n=>{i=n}),yield*t.source,i)throw i}});var $le=m((VOt,C1)=>{l();C1.exports=ym();C1.exports.source=ym();C1.exports.sink=sP();C1.exports.transform=Hle();C1.exports.duplex=oP()});var aP=m((zOt,Qle)=>{l();"use strict";var Gle=fa(),ZKe=$le(),{CLOSE_TIMEOUT:JKe}=r8(),Wle=AT(),Yle=le(),m8=Yle("libp2p:webrtc-star:socket");m8.error=Yle("libp2p:webrtc-star:socket:error");var Xle=(r,e)=>{if(!(!r||!e))try{return Wle(r,e)}catch(t){return m8.error(t),Wle("0.0.0.0",e)}};Qle.exports=(r,e={})=>{let{sink:t,source:i}=ZKe.duplex(r),n=e.remoteAddr||Xle(r.remoteAddress,r.remotePort),s=Xle(r.localAddress,r.localPort),o={async sink(a){e.signal&&(a=Gle(a,e.signal));try{await t(async function*(){for await(let c of a)yield c instanceof Uint8Array?c:c.slice()}())}catch(c){c.type!=="aborted"&&m8.error(c)}},source:e.signal?Gle(i,e.signal):i,conn:r,localAddr:s,remoteAddr:n,timeline:{open:Date.now()},close(){if(!r.destroyed)return new Promise((a,c)=>{let u=Date.now(),f=setTimeout(()=>{if(o.remoteAddr){let{host:d,port:h}=o.remoteAddr.toOptions();m8("timeout closing socket to %s:%s after %dms, destroying it manually",d,h,Date.now()-u)}r.destroyed||r.destroy()},JKe);r.once("close",()=>{a()}),r.end(d=>{if(clearTimeout(f),o.timeline.close=Date.now(),d)return c(d)})})}};return r.once("close",()=>{o.timeline.close||(o.timeline.close=Date.now())}),o}});var cP=m((HOt,Jle)=>{l();"use strict";var{Multiaddr:Zle}=lt();function eVe(r){let e=r.toString().split("/"),t=r.protos()[1].name,i=r.protos()[2].name,n=r.stringTuples()[1][1];if(t!=="tcp"||i!=="ws"&&i!=="wss")throw new Error("invalid multiaddr: "+r.toString());if(!Zle.isName(r))return"http://"+e[2]+":"+e[4];if(i==="ws")return"http://"+e[2]+(n==="80"?"":":"+n);if(i==="wss")return"https://"+e[2]+(n==="443"?"":":"+n)}function tVe(r){let e="/libp2p-webrtc-star";if(r.indexOf(e)!==-1){r=r.substring(e.length,r.length);let t=new Zle(r),i=t.stringTuples().filter(n=>n[0]===421)[0];t=t.decapsulate("p2p"),t=t.encapsulate("/p2p-webrtc-star"),t=t.encapsulate(`/p2p/${i[1]}`),r=t.toString()}return r}Jle.exports={cleanUrlSIO:eVe,cleanMultiaddr:tVe}});var ife=m(($Ot,rfe)=>{l();"use strict";var rVe=Ut(),efe=le(),mh=efe("libp2p:webrtc-star:listener");mh.error=efe("libp2p:webrtc-star:listener:error");var iVe=CT(),nVe=Fle(),sVe=LT(),oVe=ec(),aVe=aP(),{cleanUrlSIO:cVe}=cP(),{CODE_P2P:tfe}=r8(),uVe={transports:["websocket"],"force new connection":!0,path:"/socket.io-next/"};rfe.exports=({handler:r,upgrader:e},t,i={})=>{let n=new rVe,s,o;return n.__connections=[],n.__spChannels=new Map,n.__pendingIntents=new Map,n.listen=a=>{if(s)throw iVe(new Error("listener already in use"),"ERR_ALREADY_LISTENING");let c=oVe();s=a;let u;!a.protoCodes().includes(tfe)&&e.localPeer?u=a.encapsulate(`/p2p/${e.localPeer.toB58String()}`):u=a,n.on("error",()=>c.reject()),o=cVe(a),mh("Dialing to Signalling Server on: "+o),n.io=nVe.connect(o,uVe);let f=d=>{if(d.answer||d.err||!d.intentId)return;let h=d.intentId,p=n.__pendingIntents.get(h);p||(p=[],n.__pendingIntents.set(h,p));let y=n.__spChannels.get(h);if(y){y.signal(d.signal);return}else if(d.signal.type!=="offer"){p.push(d);return}let g={trickle:!1,...i};t.wrtc&&(g.wrtc=t.wrtc),y=new sVe(g);let w=b=>{mh.error("incoming connection errored",b)};y.on("error",w),y.once("close",(...b)=>{y.removeListener("error",w)}),y.on("signal",b=>{d.signal=b,d.answer=!0,n.io.emit("ss-handshake",d)}),y.signal(d.signal);for(let b of p)y.signal(b.signal);n.__pendingIntents.set(h,[]),y.once("connect",async()=>{let b=aVe(y);mh("new inbound connection %s",b.remoteAddr);let v;try{v=await e.upgradeInbound(b)}catch(R){return mh.error("inbound connection failed to upgrade",R),b.close()}if(!v.remoteAddr)try{v.remoteAddr=a.decapsulateCode(tfe).encapsulate(`/p2p/${v.remotePeer.toB58String()}`)}catch(R){mh.error("could not determine remote address",R)}mh("inbound connection %s upgraded",b.remoteAddr),lVe(n,b,h),n.emit("connection",v),r(v)}),n.__spChannels.set(h,y)};return n.io.once("connect_error",d=>c.reject(d)),n.io.once("error",d=>{n.emit("error",d),n.emit("close")}),n.io.on("ws-handshake",f),n.io.on("ws-peer",t._peerDiscovered),n.io.on("connect",()=>{n.io.emit("ss-join",u.toString())}),n.io.once("connect",()=>{n.emit("listening"),c.resolve()}),t.sigReferences.set(o,{listener:n,signallingAddr:u}),c.promise},n.close=async()=>{let a=t.sigReferences.get(o);a&&a.listener.io&&(a.listener.io.emit("ss-leave"),a.listener.io.close()),await Promise.all(n.__connections.map(c=>c.close())),n.emit("close"),n.removeAllListeners(),s=void 0,t.sigReferences.delete(o)},n.getAddrs=()=>[s],n};function lVe(r,e,t){r.__connections.push(e);let i=()=>{r.__connections=r.__connections.filter(n=>n!==e),r.__spChannels.delete(t),r.__pendingIntents.delete(t)};e.conn.once("close",i)}});var cfe=m((GOt,afe)=>{l();"use strict";var nfe=le(),Iu=nfe("libp2p:webrtc-star");Iu.error=nfe("libp2p:webrtc-star:error");var{EventEmitter:fVe}=Ut(),b8=CT(),dVe=lb(),{AbortError:sfe}=fa(),hVe=LT(),{supportsWebRTCDataChannels:pVe}=Lue(),{Multiaddr:yVe}=lt(),gVe=Kf(),mVe=st(),{CODE_CIRCUIT:bVe}=r8(),wVe=ife(),_Ve=aP(),{cleanMultiaddr:vVe,cleanUrlSIO:EVe}=cP();function SVe(){}var ofe=class{constructor(e={}){if(!e.upgrader)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e.upgrader,this.sioOptions={transports:["websocket"],"force new connection":!0},e.wrtc&&(this.wrtc=e.wrtc),this.sigReferences=new Map,this.discovery=new fVe,this.discovery.tag="webRTCStar",this.discovery._isStarted=!1,this.discovery.start=()=>{this.discovery._isStarted=!0},this.discovery.stop=()=>{this.discovery._isStarted=!1},this._peerDiscovered=this._peerDiscovered.bind(this)}async dial(e,t={}){let i=await this._connect(e,t),n=_Ve(i,{remoteAddr:e,signal:t.signal});Iu("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return Iu("outbound connection %s upgraded",n.remoteAddr),s}_connect(e,t={}){if(t.signal&&t.signal.aborted)throw new sfe;let i={initiator:!0,trickle:!1,...t.spOptions||{}};this.wrtc&&(i.wrtc=this.wrtc);let n=e.toOptions(),s=(~~(Math.random()*1e9)).toString(36)+Date.now();return new Promise((o,a)=>{let c=this.sigReferences.get(EVe(e));if(!c||!c.listener)return a(b8(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let u=c.listener.io,f=Date.now(),d;Iu("dialing %s:%s",n.host,n.port);let h=new hVe(i),p=v=>{if(!d){let R=`connection error ${n.host}:${n.port}: ${v.message}`;Iu.error(R),b(v)}},y=()=>{Iu("connnection timeout %s:%s",n.host,n.port);let v=b8(new Error(`connection timeout after ${Date.now()-f}ms`),"ERR_CONNECT_TIMEOUT");h.emit("error",v)},g=()=>{d=!0,Iu("connection opened %s:%s",n.host,n.port),b(null)},w=()=>{Iu.error("connection aborted %s:%s",n.host,n.port),h.destroy(),b(new sfe)},b=v=>{h.removeListener("timeout",y),h.removeListener("connect",g),t.signal&&t.signal.removeEventListener("abort",w),v?a(v):o(h)};h.on("error",p),h.once("timeout",y),h.once("connect",g),h.on("close",()=>{h.removeListener("error",p)}),t.signal&&t.signal.addEventListener("abort",w),h.on("signal",v=>{u.emit("ss-handshake",{intentId:s,srcMultiaddr:c.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:v})}),u.on("ws-handshake",v=>{v.intentId===s&&v.err&&(h.destroy(),a(b8(v.err instanceof Error?v.err:new Error(v.err),"ERR_SIGNALLING_FAILED"))),!(v.intentId!==s||!v.answer||h.destroyed)&&h.signal(v.signal)})})}createListener(e={},t){if(!pVe&&!this.wrtc)throw b8(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");return typeof e=="function"&&(t=e,e={}),t=t||SVe,wVe({handler:t,upgrader:this._upgrader},this,e)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(t=>t.protoCodes().includes(bVe)?!1:gVe.WebRTCStar.matches(t))}_peerDiscovered(e){if(!this.discovery._isStarted)return;Iu("Peer Discovered:",e),e=vVe(e);let t=new yVe(e),i=mVe.createFromB58String(t.getPeerId());this.discovery.emit("peer",{id:i,multiaddrs:[t]})}};afe.exports=dVe(ofe,{className:"WebRTCStar",symbolName:"@libp2p/js-libp2p-webrtc-star/webrtcstar"})});var hfe=m((WOt,dfe)=>{l();"use strict";var w8=Xn(),ufe=on(),uP=10*1024,lfe=class{constructor(){this._pool=new Uint8Array(uP),this._poolOffset=0}write(e){let t=this._pool,i=this._poolOffset;w8.encode(e.id<<3|e.type,t,i),i+=w8.encode.bytes,w8.encode(e.data?e.data.length:0,t,i),i+=w8.encode.bytes;let n=t.subarray(this._poolOffset,i);return uP-i<100?(this._pool=new Uint8Array(uP),this._poolOffset=0):this._poolOffset=i,e.data?[n,e.data]:n}},ffe=new lfe;dfe.exports=r=>async function*(){for await(let t of r)Array.isArray(t)?yield new ufe(t.map(i=>ffe.write(i))):yield new ufe(ffe.write(t))}()});var gfe=m((YOt,yfe)=>{l();"use strict";var _8=Xn(),AVe=on();yfe.exports=r=>async function*(){let t=new pfe;for await(let i of r){let n=t.write(i);n.length&&(yield n)}}();var pfe=class{constructor(){this._buffer=new AVe,this._bufferProxy=new Proxy({},{get:(e,t)=>t[0]==="l"?this._buffer[t]:this._buffer.get(parseInt(t))}),this._headerInfo=null}write(e){if(!e||!e.length)return[];this._buffer.append(e);let t=[];for(;this._buffer.length;){if(!this._headerInfo)try{this._headerInfo=this._decodeHeader(this._bufferProxy)}catch(c){break}let{id:i,type:n,length:s,offset:o}=this._headerInfo;if(this._buffer.length-o<s)break;t.push({id:i,type:n,data:this._buffer.shallowSlice(o,o+s)}),this._buffer.consume(o+s),this._headerInfo=null}return t}_decodeHeader(e){let t=_8.decode(e),i=_8.decode.bytes,n=_8.decode(e,i);return i+=_8.decode.bytes,{id:t>>3,type:t&7,offset:i,length:n}}}});var mfe=m(lP=>{l();"use strict";lP.encode=hfe();lP.decode=gfe()});var dP=m((QOt,fP)=>{l();"use strict";var bfe=1<<20;fP.exports=r=>{r=r||bfe;let e=t=>{if(t.data&&t.data.length>r)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return t=>async function*(){for await(let n of t)Array.isArray(n)?n.forEach(e):e(n),yield n}()};fP.exports.MAX_MSG_SIZE=bfe});var hP=m(Sm=>{l();"use strict";var Tu=Object.freeze({NEW_STREAM:0,MESSAGE_RECEIVER:1,MESSAGE_INITIATOR:2,CLOSE_RECEIVER:3,CLOSE_INITIATOR:4,RESET_RECEIVER:5,RESET_INITIATOR:6});Sm.MessageTypes=Tu;Sm.InitiatorMessageTypes=Object.freeze({NEW_STREAM:Tu.NEW_STREAM,MESSAGE:Tu.MESSAGE_INITIATOR,CLOSE:Tu.CLOSE_INITIATOR,RESET:Tu.RESET_INITIATOR});Sm.ReceiverMessageTypes=Object.freeze({MESSAGE:Tu.MESSAGE_RECEIVER,CLOSE:Tu.CLOSE_RECEIVER,RESET:Tu.RESET_RECEIVER});Sm.MessageTypeNames=Object.freeze(Object.entries(Tu).reduce((r,e)=>(r[e[1]]=e[0],r),{}))});var vfe=m((JOt,_fe)=>{l();"use strict";function wfe(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function RVe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return wfe(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),wfe(new n,t)}}_fe.exports=RVe});var Afe=m((ekt,Sfe)=>{l();"use strict";var xVe=fa(),Am=le()("libp2p:mplex:stream"),IVe=Za(),Efe=on(),TVe=vfe(),{MAX_MSG_SIZE:PVe}=dP(),{InitiatorMessageTypes:CVe,ReceiverMessageTypes:OVe}=hP(),pP="ERR_MPLEX_STREAM_RESET",kVe="ERR_MPLEX_STREAM_ABORT";Sfe.exports=({id:r,name:e,send:t,onEnd:i=()=>{},type:n="initiator",maxMsgSize:s=PVe})=>{let o=new AbortController,a=new AbortController,c=n==="initiator"?CVe:OVe,u=n==="initiator"?`i${r}`:`r${r}`;e=String(e??r);let f=!1,d=!1,h,p=w=>{f||(f=!0,Am("%s stream %s source end",n,e,w),w&&!h&&(h=w),d&&(g.timeline.close=Date.now(),i(h)))},y=w=>{d||(d=!0,Am("%s stream %s sink end",n,e,w),w&&!h&&(h=w),f&&(g.timeline.close=Date.now(),i(h)))},g={close:()=>g.source.end(),abort:w=>{Am("%s stream %s abort",n,e,w),g.source.end(w),o.abort(),y(w)},reset:()=>{let w=TVe(new Error("stream reset"),pP);a.abort(),g.source.end(w),y(w)},sink:async w=>{w=xVe(w,[{signal:o.signal,options:{abortMessage:"stream aborted",abortCode:kVe}},{signal:a.signal,options:{abortMessage:"stream reset",abortCode:pP}}]),n==="initiator"&&t({id:r,type:c.NEW_STREAM,data:e});try{for await(let b of w)for(;b.length;){if(b.length<=s){t({id:r,type:c.MESSAGE,data:b});break}b=Efe.isBufferList(b)?b:new Efe(b),t({id:r,type:c.MESSAGE,data:b.shallowSlice(0,s)}),b.consume(s)}}catch(b){return b.code===pP?Am("%s stream %s reset",n,e):(Am("%s stream %s error",n,e,b),t({id:r,type:c.RESET})),g.source.end(b),y(b)}t({id:r,type:c.CLOSE}),y()},source:IVe(p),timeline:{open:Date.now(),close:null},id:u};return g}});var Tfe=m((tkt,Ife)=>{l();"use strict";var DVe=dr(),NVe=Za(),Pu=le()("libp2p:mplex"),BVe=fa(),Rfe=mfe(),LVe=dP(),{MessageTypes:bh,MessageTypeNames:xfe}=hP(),MVe=Afe(),yP=class{constructor(e){e=e||{},e=typeof e=="function"?{onStream:e}:e,this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._options=e,this.sink=this._createSink(),this.source=this._createSource(),this.onStream=e.onStream,this.onStreamEnd=e.onStreamEnd}get streams(){let e=[];return this._streams.initiators.forEach(t=>{e.push(t)}),this._streams.receivers.forEach(t=>{e.push(t)}),e}newStream(e){let t=this._streamId++;e=e==null?t.toString():String(e);let i=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:i})}_newReceiverStream({id:e,name:t}){let i=this._streams.receivers;return this._newStream({id:e,name:t,type:"receiver",registry:i})}_newStream({id:e,name:t,type:i,registry:n}){if(n.has(e))throw new Error(`${i} stream ${e} already exists!`);Pu("new %s stream %s %s",i,e,t);let a=MVe({id:e,name:t,send:c=>(Pu.enabled&&Pu("%s stream %s %s send",i,e,t,{...c,type:xfe[c.type],data:c.data&&c.data.slice()}),this.source.push(c)),type:i,onEnd:()=>{Pu("%s stream %s %s ended",i,e,t),n.delete(e),this.onStreamEnd&&this.onStreamEnd(a)},maxMsgSize:this._options.maxMsgSize});return n.set(e,a),a}_createSink(){return async e=>{this._options.signal&&(e=BVe(e,this._options.signal));try{await DVe(e,Rfe.decode,LVe(this._options.maxMsgSize),async t=>{for await(let i of t)for(let n of i)this._handleIncoming(n)})}catch(t){return Pu("error in sink",t),this.source.end(t)}this.source.end()}}_createSource(){let t=NVe({onEnd:i=>{let{initiators:n,receivers:s}=this._streams;for(let o of n.values())o.abort(i);for(let o of s.values())o.abort(i)},writev:!0});return Object.assign(Rfe.encode(t),{push:t.push,end:t.end,return:t.return})}_handleIncoming({id:e,type:t,data:i}){if(Pu.enabled&&Pu("incoming message",{id:e,type:xfe[t],data:i.slice()}),t===bh.NEW_STREAM&&this.onStream){let o=this._newReceiverStream({id:e,name:i.toString()});return this.onStream(o)}let s=(t&1?this._streams.initiators:this._streams.receivers).get(e);if(!s)return Pu("missing stream %s",e);switch(t){case bh.MESSAGE_INITIATOR:case bh.MESSAGE_RECEIVER:s.source.push(i);break;case bh.CLOSE_INITIATOR:case bh.CLOSE_RECEIVER:s.close();break;case bh.RESET_INITIATOR:case bh.RESET_RECEIVER:s.reset();break;default:Pu("unknown message type %s",t)}}};yP.multicodec="/mplex/6.7.0";Ife.exports=yP});var Cfe=m((rkt,Pfe)=>{l();"use strict";Pfe.exports=Tfe()});var kfe=m(gP=>{l();"use strict";Object.defineProperty(gP,"__esModule",{value:!0});var Ofe=65536,jVe=function(){function r(){this.isAvailable=!1,this.isInstantiated=!1;var e=typeof self!="undefined"?self.crypto||self.msCrypto:null;e&&e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return r.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var t=new Uint8Array(e),i=0;i<t.length;i+=Ofe)this._crypto.getRandomValues(t.subarray(i,i+Math.min(t.length-i,Ofe)));return t},r}();gP.BrowserRandomSource=jVe});var Ac=m(mP=>{l();"use strict";Object.defineProperty(mP,"__esModule",{value:!0});function qVe(r){for(var e=0;e<r.length;e++)r[e]=0;return r}mP.wipe=qVe});var Dfe=m(bP=>{l();"use strict";Object.defineProperty(bP,"__esModule",{value:!0});var UVe=Ac(),FVe=function(){function r(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Aa!="undefined"){var e=$f();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}return r.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var i=new Uint8Array(e),n=0;n<i.length;n++)i[n]=t[n];return UVe.wipe(t),i},r}();bP.NodeRandomSource=FVe});var Nfe=m(wP=>{l();"use strict";Object.defineProperty(wP,"__esModule",{value:!0});var KVe=kfe(),VVe=Dfe(),zVe=function(){function r(){if(this.isAvailable=!1,this.name="",this._source=new KVe.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new VVe.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}return r.prototype.randomBytes=function(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)},r}();wP.SystemRandomSource=zVe});var Bfe=m(Is=>{l();"use strict";Object.defineProperty(Is,"__esModule",{value:!0});function HVe(r,e){var t=r>>>16&65535,i=r&65535,n=e>>>16&65535,s=e&65535;return i*s+(t*s+i*n<<16>>>0)|0}Is.mul=Math.imul||HVe;function $Ve(r,e){return r+e|0}Is.add=$Ve;function GVe(r,e){return r-e|0}Is.sub=GVe;function WVe(r,e){return r<<e|r>>>32-e}Is.rotl=WVe;function YVe(r,e){return r<<32-e|r>>>e}Is.rotr=YVe;function XVe(r){return typeof r=="number"&&isFinite(r)&&Math.floor(r)===r}Is.isInteger=Number.isInteger||XVe;Is.MAX_SAFE_INTEGER=9007199254740991;Is.isSafeInteger=function(r){return Is.isInteger(r)&&r>=-Is.MAX_SAFE_INTEGER&&r<=Is.MAX_SAFE_INTEGER}});var Rm=m(Et=>{l();"use strict";Object.defineProperty(Et,"__esModule",{value:!0});var Lfe=Bfe();function QVe(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])<<16>>16}Et.readInt16BE=QVe;function ZVe(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])>>>0}Et.readUint16BE=ZVe;function JVe(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])<<16>>16}Et.readInt16LE=JVe;function eze(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])>>>0}Et.readUint16LE=eze;function Mfe(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>8,e[t+1]=r>>>0,e}Et.writeUint16BE=Mfe;Et.writeInt16BE=Mfe;function jfe(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e}Et.writeUint16LE=jfe;Et.writeInt16LE=jfe;function _P(r,e){return e===void 0&&(e=0),r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}Et.readInt32BE=_P;function vP(r,e){return e===void 0&&(e=0),(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}Et.readUint32BE=vP;function EP(r,e){return e===void 0&&(e=0),r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]}Et.readInt32LE=EP;function SP(r,e){return e===void 0&&(e=0),(r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e])>>>0}Et.readUint32LE=SP;function v8(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}Et.writeUint32BE=v8;Et.writeInt32BE=v8;function E8(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24,e}Et.writeUint32LE=E8;Et.writeInt32LE=E8;function tze(r,e){e===void 0&&(e=0);var t=_P(r,e),i=_P(r,e+4);return t*4294967296+i-(i>>31)*4294967296}Et.readInt64BE=tze;function rze(r,e){e===void 0&&(e=0);var t=vP(r,e),i=vP(r,e+4);return t*4294967296+i}Et.readUint64BE=rze;function ize(r,e){e===void 0&&(e=0);var t=EP(r,e),i=EP(r,e+4);return i*4294967296+t-(t>>31)*4294967296}Et.readInt64LE=ize;function nze(r,e){e===void 0&&(e=0);var t=SP(r,e),i=SP(r,e+4);return i*4294967296+t}Et.readUint64LE=nze;function qfe(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),v8(r/4294967296>>>0,e,t),v8(r>>>0,e,t+4),e}Et.writeUint64BE=qfe;Et.writeInt64BE=qfe;function Ufe(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),E8(r>>>0,e,t),E8(r/4294967296>>>0,e,t+4),e}Et.writeUint64LE=Ufe;Et.writeInt64LE=Ufe;function sze(r,e,t){if(t===void 0&&(t=0),r%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=r/8+t-1;s>=t;s--)i+=e[s]*n,n*=256;return i}Et.readUintBE=sze;function oze(r,e,t){if(t===void 0&&(t=0),r%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=t;s<t+r/8;s++)i+=e[s]*n,n*=256;return i}Et.readUintLE=oze;function aze(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Lfe.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=r/8+i-1;s>=i;s--)t[s]=e/n&255,n*=256;return t}Et.writeUintBE=aze;function cze(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Lfe.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+r/8;s++)t[s]=e/n&255,n*=256;return t}Et.writeUintLE=cze;function uze(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e)}Et.readFloat32BE=uze;function lze(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e,!0)}Et.readFloat32LE=lze;function fze(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e)}Et.readFloat64BE=fze;function dze(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e,!0)}Et.readFloat64LE=dze;function hze(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r),e}Et.writeFloat32BE=hze;function pze(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r,!0),e}Et.writeFloat32LE=pze;function yze(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r),e}Et.writeFloat64BE=yze;function gze(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r,!0),e}Et.writeFloat64LE=gze});var zfe=m(ma=>{l();"use strict";Object.defineProperty(ma,"__esModule",{value:!0});var mze=Nfe(),bze=Rm(),Ffe=Ac();ma.defaultRandomSource=new mze.SystemRandomSource;function AP(r,e){return e===void 0&&(e=ma.defaultRandomSource),e.randomBytes(r)}ma.randomBytes=AP;function wze(r){r===void 0&&(r=ma.defaultRandomSource);var e=AP(4,r),t=bze.readUint32LE(e);return Ffe.wipe(e),t}ma.randomUint32=wze;var Kfe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function Vfe(r,e,t){if(e===void 0&&(e=Kfe),t===void 0&&(t=ma.defaultRandomSource),e.length<2)throw new Error("randomString charset is too short");if(e.length>256)throw new Error("randomString charset is too long");for(var i="",n=e.length,s=256-256%n;r>0;){for(var o=AP(Math.ceil(r*256/s),t),a=0;a<o.length&&r>0;a++){var c=o[a];c<s&&(i+=e.charAt(c%n),r--)}Ffe.wipe(o)}return i}ma.randomString=Vfe;function _ze(r,e,t){e===void 0&&(e=Kfe),t===void 0&&(t=ma.defaultRandomSource);var i=Math.ceil(r/(Math.log(e.length)/Math.LN2));return Vfe(i,e,t)}ma.randomStringForEntropy=_ze});var R8=m(us=>{l();"use strict";Object.defineProperty(us,"__esModule",{value:!0});var vze=zfe(),Eze=Ac();us.PUBLIC_KEY_LENGTH=32;us.SECRET_KEY_LENGTH=32;us.SHARED_KEY_LENGTH=32;function Rc(r){var e=new Float64Array(16);if(r)for(var t=0;t<r.length;t++)e[t]=r[t];return e}var Hfe=new Uint8Array(32);Hfe[0]=9;var Sze=Rc([56129,1]);function RP(r){for(var e=1,t=0;t<16;t++){var i=r[t]+e+65535;e=Math.floor(i/65536),r[t]=i-e*65536}r[0]+=e-1+37*(e-1)}function xm(r,e,t){for(var i=~(t-1),n=0;n<16;n++){var s=i&(r[n]^e[n]);r[n]^=s,e[n]^=s}}function Aze(r,e){for(var t=Rc(),i=Rc(),n=0;n<16;n++)i[n]=e[n];RP(i),RP(i),RP(i);for(var s=0;s<2;s++){t[0]=i[0]-65517;for(var n=1;n<15;n++)t[n]=i[n]-65535-(t[n-1]>>16&1),t[n-1]&=65535;t[15]=i[15]-32767-(t[14]>>16&1);var o=t[15]>>16&1;t[14]&=65535,xm(i,t,1-o)}for(var n=0;n<16;n++)r[2*n]=i[n]&255,r[2*n+1]=i[n]>>8}function Rze(r,e){for(var t=0;t<16;t++)r[t]=e[2*t]+(e[2*t+1]<<8);r[15]&=32767}function S8(r,e,t){for(var i=0;i<16;i++)r[i]=e[i]+t[i]}function A8(r,e,t){for(var i=0;i<16;i++)r[i]=e[i]-t[i]}function Cu(r,e,t){var i,n,s=0,o=0,a=0,c=0,u=0,f=0,d=0,h=0,p=0,y=0,g=0,w=0,b=0,v=0,R=0,k=0,C=0,T=0,D=0,j=0,M=0,se=0,ie=0,fe=0,pe=0,Be=0,Ae=0,ke=0,ne=0,Me=0,ct=0,Ye=t[0],Xe=t[1],de=t[2],J=t[3],Ee=t[4],je=t[5],ze=t[6],Te=t[7],ot=t[8],I=t[9],O=t[10],N=t[11],Y=t[12],F=t[13],W=t[14],ee=t[15];i=e[0],s+=i*Ye,o+=i*Xe,a+=i*de,c+=i*J,u+=i*Ee,f+=i*je,d+=i*ze,h+=i*Te,p+=i*ot,y+=i*I,g+=i*O,w+=i*N,b+=i*Y,v+=i*F,R+=i*W,k+=i*ee,i=e[1],o+=i*Ye,a+=i*Xe,c+=i*de,u+=i*J,f+=i*Ee,d+=i*je,h+=i*ze,p+=i*Te,y+=i*ot,g+=i*I,w+=i*O,b+=i*N,v+=i*Y,R+=i*F,k+=i*W,C+=i*ee,i=e[2],a+=i*Ye,c+=i*Xe,u+=i*de,f+=i*J,d+=i*Ee,h+=i*je,p+=i*ze,y+=i*Te,g+=i*ot,w+=i*I,b+=i*O,v+=i*N,R+=i*Y,k+=i*F,C+=i*W,T+=i*ee,i=e[3],c+=i*Ye,u+=i*Xe,f+=i*de,d+=i*J,h+=i*Ee,p+=i*je,y+=i*ze,g+=i*Te,w+=i*ot,b+=i*I,v+=i*O,R+=i*N,k+=i*Y,C+=i*F,T+=i*W,D+=i*ee,i=e[4],u+=i*Ye,f+=i*Xe,d+=i*de,h+=i*J,p+=i*Ee,y+=i*je,g+=i*ze,w+=i*Te,b+=i*ot,v+=i*I,R+=i*O,k+=i*N,C+=i*Y,T+=i*F,D+=i*W,j+=i*ee,i=e[5],f+=i*Ye,d+=i*Xe,h+=i*de,p+=i*J,y+=i*Ee,g+=i*je,w+=i*ze,b+=i*Te,v+=i*ot,R+=i*I,k+=i*O,C+=i*N,T+=i*Y,D+=i*F,j+=i*W,M+=i*ee,i=e[6],d+=i*Ye,h+=i*Xe,p+=i*de,y+=i*J,g+=i*Ee,w+=i*je,b+=i*ze,v+=i*Te,R+=i*ot,k+=i*I,C+=i*O,T+=i*N,D+=i*Y,j+=i*F,M+=i*W,se+=i*ee,i=e[7],h+=i*Ye,p+=i*Xe,y+=i*de,g+=i*J,w+=i*Ee,b+=i*je,v+=i*ze,R+=i*Te,k+=i*ot,C+=i*I,T+=i*O,D+=i*N,j+=i*Y,M+=i*F,se+=i*W,ie+=i*ee,i=e[8],p+=i*Ye,y+=i*Xe,g+=i*de,w+=i*J,b+=i*Ee,v+=i*je,R+=i*ze,k+=i*Te,C+=i*ot,T+=i*I,D+=i*O,j+=i*N,M+=i*Y,se+=i*F,ie+=i*W,fe+=i*ee,i=e[9],y+=i*Ye,g+=i*Xe,w+=i*de,b+=i*J,v+=i*Ee,R+=i*je,k+=i*ze,C+=i*Te,T+=i*ot,D+=i*I,j+=i*O,M+=i*N,se+=i*Y,ie+=i*F,fe+=i*W,pe+=i*ee,i=e[10],g+=i*Ye,w+=i*Xe,b+=i*de,v+=i*J,R+=i*Ee,k+=i*je,C+=i*ze,T+=i*Te,D+=i*ot,j+=i*I,M+=i*O,se+=i*N,ie+=i*Y,fe+=i*F,pe+=i*W,Be+=i*ee,i=e[11],w+=i*Ye,b+=i*Xe,v+=i*de,R+=i*J,k+=i*Ee,C+=i*je,T+=i*ze,D+=i*Te,j+=i*ot,M+=i*I,se+=i*O,ie+=i*N,fe+=i*Y,pe+=i*F,Be+=i*W,Ae+=i*ee,i=e[12],b+=i*Ye,v+=i*Xe,R+=i*de,k+=i*J,C+=i*Ee,T+=i*je,D+=i*ze,j+=i*Te,M+=i*ot,se+=i*I,ie+=i*O,fe+=i*N,pe+=i*Y,Be+=i*F,Ae+=i*W,ke+=i*ee,i=e[13],v+=i*Ye,R+=i*Xe,k+=i*de,C+=i*J,T+=i*Ee,D+=i*je,j+=i*ze,M+=i*Te,se+=i*ot,ie+=i*I,fe+=i*O,pe+=i*N,Be+=i*Y,Ae+=i*F,ke+=i*W,ne+=i*ee,i=e[14],R+=i*Ye,k+=i*Xe,C+=i*de,T+=i*J,D+=i*Ee,j+=i*je,M+=i*ze,se+=i*Te,ie+=i*ot,fe+=i*I,pe+=i*O,Be+=i*N,Ae+=i*Y,ke+=i*F,ne+=i*W,Me+=i*ee,i=e[15],k+=i*Ye,C+=i*Xe,T+=i*de,D+=i*J,j+=i*Ee,M+=i*je,se+=i*ze,ie+=i*Te,fe+=i*ot,pe+=i*I,Be+=i*O,Ae+=i*N,ke+=i*Y,ne+=i*F,Me+=i*W,ct+=i*ee,s+=38*C,o+=38*T,a+=38*D,c+=38*j,u+=38*M,f+=38*se,d+=38*ie,h+=38*fe,p+=38*pe,y+=38*Be,g+=38*Ae,w+=38*ke,b+=38*ne,v+=38*Me,R+=38*ct,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=w+n+65535,n=Math.floor(i/65536),w=i-n*65536,i=b+n+65535,n=Math.floor(i/65536),b=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=k+n+65535,n=Math.floor(i/65536),k=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=w+n+65535,n=Math.floor(i/65536),w=i-n*65536,i=b+n+65535,n=Math.floor(i/65536),b=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=k+n+65535,n=Math.floor(i/65536),k=i-n*65536,s+=n-1+37*(n-1),r[0]=s,r[1]=o,r[2]=a,r[3]=c,r[4]=u,r[5]=f,r[6]=d,r[7]=h,r[8]=p,r[9]=y,r[10]=g,r[11]=w,r[12]=b,r[13]=v,r[14]=R,r[15]=k}function Im(r,e){Cu(r,e,e)}function xze(r,e){for(var t=Rc(),i=0;i<16;i++)t[i]=e[i];for(var i=253;i>=0;i--)Im(t,t),i!==2&&i!==4&&Cu(t,t,e);for(var i=0;i<16;i++)r[i]=t[i]}function xP(r,e){for(var t=new Uint8Array(32),i=new Float64Array(80),n=Rc(),s=Rc(),o=Rc(),a=Rc(),c=Rc(),u=Rc(),f=0;f<31;f++)t[f]=r[f];t[31]=r[31]&127|64,t[0]&=248,Rze(i,e);for(var f=0;f<16;f++)s[f]=i[f];n[0]=a[0]=1;for(var f=254;f>=0;--f){var d=t[f>>>3]>>>(f&7)&1;xm(n,s,d),xm(o,a,d),S8(c,n,o),A8(n,n,o),S8(o,s,a),A8(s,s,a),Im(a,c),Im(u,n),Cu(n,o,n),Cu(o,s,c),S8(c,n,o),A8(n,n,o),Im(s,n),A8(o,a,u),Cu(n,o,Sze),S8(n,n,a),Cu(o,o,n),Cu(n,a,u),Cu(a,s,i),Im(s,c),xm(n,s,d),xm(o,a,d)}for(var f=0;f<16;f++)i[f+16]=n[f],i[f+32]=o[f],i[f+48]=s[f],i[f+64]=a[f];var h=i.subarray(32),p=i.subarray(16);xze(h,h),Cu(p,p,h);var y=new Uint8Array(32);return Aze(y,p),y}us.scalarMult=xP;function $fe(r){return xP(r,Hfe)}us.scalarMultBase=$fe;function Gfe(r){if(r.length!==us.SECRET_KEY_LENGTH)throw new Error("x25519: seed must be "+us.SECRET_KEY_LENGTH+" bytes");var e=new Uint8Array(r),t=$fe(e);return{publicKey:t,secretKey:e}}us.generateKeyPairFromSeed=Gfe;function Ize(r){var e=vze.randomBytes(32,r),t=Gfe(e);return Eze.wipe(e),t}us.generateKeyPair=Ize;function Tze(r,e,t){if(t===void 0&&(t=!1),r.length!==us.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(e.length!==us.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");var i=xP(r,e);if(t){for(var n=0,s=0;s<i.length;s++)n|=i[s];if(n===0)throw new Error("X25519: invalid shared key")}return i}us.sharedKey=Tze});var wh=m((fkt,Wfe)=>{l();"use strict";var Pze=g6(),Cze=Za(),Oze=ec();Wfe.exports=r=>{let e=Cze(),t=Pze(r.source),i=Oze(),n,s=r.sink(async function*(){yield*e,yield*await i.promise}());return s.catch(a=>{n=a}),{reader:t,writer:e,stream:{sink:a=>n?Promise.reject(n):(i.resolve(a),s),source:t},rest:()=>e.end(),write:e.push,read:async()=>(await t.next()).value}}});var Qfe=m((dkt,Xfe)=>{l();"use strict";var kze=wh(),Yfe=go();Xfe.exports=(r,e={})=>{let t=kze(r),i=Yfe.decode.fromReader(t.reader,e),n=!1,s={read:async o=>{let{value:a,done:c}=await t.reader.next(o);if(c&&a.length<o)throw new Error("Couldn't read enough bytes");if(n=c,!a)throw new Error("Value is null");return a},readLP:async()=>{let{value:o,done:a}=await i.next();if(n=a,!o)throw new Error("Value is null");return o},readPB:async o=>{let a=await s.readLP();if(!a)throw new Error("Value is null");let c=a instanceof Uint8Array?a:a.slice();return o.decode(c)},write:o=>{t.writer.push(o)},writeLP:o=>{s.write(Yfe.encode.single(o,e))},writePB:(o,a)=>{s.writeLP(a.encode(o))},pb:o=>({read:()=>s.readPB(o),write:a=>s.writePB(a,o)}),unwrap:()=>(t.rest(),t.stream)};return s}});var Jfe=m((hkt,Zfe)=>{l();"use strict";var Dze=gw();Zfe.exports=function(){let e,t,i=async s=>{if(e)throw new Error("already piped");e=Dze(s),t&&t(e)},n={[Symbol.asyncIterator](){return this},next(){return e?e.next():new Promise(s=>{t=o=>{t=null,s(o.next())}})}};return{sink:i,source:n}}});var rde=m((pkt,tde)=>{l();var ede=Jfe();tde.exports=function(){var r=ede(),e=ede();return[{source:r.source,sink:e.sink},{source:e.source,sink:r.sink}]}});var T8=m((ykt,Tm)=>{l();"use strict";var{Buffer:x8}=ci(),I8=on();Tm.exports=async function*(r){for await(let e of r)x8.isBuffer(e)?yield e:I8.isBufferList(e)?yield e.slice():yield x8.from(e)};Tm.exports.toBuffer=Tm.exports;Tm.exports.toList=async function*(r){for await(let e of r)x8.isBuffer(e)?yield new I8().append(e):I8.isBufferList(e)?yield e:yield new I8().append(x8.from(e))}});var ide=m(IP=>{l();"use strict";Object.defineProperty(IP,"__esModule",{value:!0});function Nze(r){return typeof r.saveState!="undefined"&&typeof r.restoreState!="undefined"&&typeof r.cleanSavedState!="undefined"}IP.isSerializableHash=Nze});var P8=m(O1=>{l();"use strict";Object.defineProperty(O1,"__esModule",{value:!0});function Bze(r,e,t){return~(r-1)&e|r-1&t}O1.select=Bze;function Lze(r,e){return(r|0)-(e|0)-1>>>31&1}O1.lessOrEqual=Lze;function nde(r,e){if(r.length!==e.length)return 0;for(var t=0,i=0;i<r.length;i++)t|=r[i]^e[i];return 1&t-1>>>8}O1.compare=nde;function Mze(r,e){return r.length===0||e.length===0?!1:nde(r,e)!==0}O1.equal=Mze});var ode=m(Pm=>{l();"use strict";Object.defineProperty(Pm,"__esModule",{value:!0});var xc=ide(),jze=P8(),qze=Ac(),sde=function(){function r(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(i).clean():i.set(t);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=54^92;this._outer.update(i),xc.isSerializableHash(this._inner)&&xc.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),qze.wipe(i)}return r.prototype.reset=function(){if(!xc.isSerializableHash(this._inner)||!xc.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){xc.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),xc.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(e){return this._inner.update(e),this},r.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(!xc.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(e){if(!xc.isSerializableHash(this._inner)||!xc.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(e){if(!xc.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},r}();Pm.HMAC=sde;function Uze(r,e,t){var i=new sde(r,e);i.update(t);var n=i.digest();return i.clean(),n}Pm.hmac=Uze;Pm.equal=jze.equal});var ude=m(TP=>{l();"use strict";Object.defineProperty(TP,"__esModule",{value:!0});var ade=ode(),cde=Ac(),Fze=function(){function r(e,t,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=ade.hmac(this._hash,i,t);this._hmac=new ade.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(e){for(var t=new Uint8Array(e),i=0;i<t.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[i]=this._buffer[this._bufpos++];return t},r.prototype.clean=function(){this._hmac.clean(),cde.wipe(this._buffer),cde.wipe(this._counter),this._bufpos=0},r}();TP.HKDF=Fze});var CP=m(yf=>{l();"use strict";Object.defineProperty(yf,"__esModule",{value:!0});var C8=Rm(),O8=Ac();yf.DIGEST_LENGTH=32;yf.BLOCK_SIZE=64;var lde=function(){function r(){this.digestLength=yf.DIGEST_LENGTH,this.blockSize=yf.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return r.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},r.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},r.prototype.clean=function(){O8.wipe(this._buffer),O8.wipe(this._temp),this.reset()},r.prototype.update=function(e,t){if(t===void 0&&(t=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var i=0;if(this._bytesHashed+=t,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&t>0;)this._buffer[this._bufferLength++]=e[i++],t--;this._bufferLength===this.blockSize&&(PP(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(t>=this.blockSize&&(i=PP(this._temp,this._state,e,i,t),t%=this.blockSize);t>0;)this._buffer[this._bufferLength++]=e[i++],t--;return this},r.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,i=this._bufferLength,n=t/536870912|0,s=t<<3,o=t%64<56?64:128;this._buffer[i]=128;for(var a=i+1;a<o-8;a++)this._buffer[a]=0;C8.writeUint32BE(n,this._buffer,o-8),C8.writeUint32BE(s,this._buffer,o-4),PP(this._temp,this._state,this._buffer,0,o),this._finished=!0}for(var a=0;a<this.digestLength/4;a++)C8.writeUint32BE(this._state[a],e,a*4);return this},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},r.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},r.prototype.cleanSavedState=function(e){O8.wipe(e.state),e.buffer&&O8.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},r}();yf.SHA256=lde;var Kze=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function PP(r,e,t,i,n){for(;n>=64;){for(var s=e[0],o=e[1],a=e[2],c=e[3],u=e[4],f=e[5],d=e[6],h=e[7],p=0;p<16;p++){var y=i+p*4;r[p]=C8.readUint32BE(t,y)}for(var p=16;p<64;p++){var g=r[p-2],w=(g>>>17|g<<32-17)^(g>>>19|g<<32-19)^g>>>10;g=r[p-15];var b=(g>>>7|g<<32-7)^(g>>>18|g<<32-18)^g>>>3;r[p]=(w+r[p-7]|0)+(b+r[p-16]|0)}for(var p=0;p<64;p++){var w=(((u>>>6|u<<32-6)^(u>>>11|u<<32-11)^(u>>>25|u<<32-25))+(u&f^~u&d)|0)+(h+(Kze[p]+r[p]|0)|0)|0,b=((s>>>2|s<<32-2)^(s>>>13|s<<32-13)^(s>>>22|s<<32-22))+(s&o^s&a^o&a)|0;h=d,d=f,f=u,u=c+w|0,c=a,a=o,o=s,s=w+b|0}e[0]+=s,e[1]+=o,e[2]+=a,e[3]+=c,e[4]+=u,e[5]+=f,e[6]+=d,e[7]+=h,i+=64,n-=64}return i}function Vze(r){var e=new lde;e.update(r);var t=e.digest();return e.clean(),t}yf.hash=Vze});var dde=m((fde,Cm)=>{l();"use strict";(function(r,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof Aa=="function"&&typeof Cm=="object"&&Cm&&Cm.exports&&(Cm.exports=e(Br()))})(fde,function(r){"use strict";var e=r.Reader,t=r.Writer,i=r.util,n=r.roots["libp2p-noise"]||(r.roots["libp2p-noise"]={});return n.pb=function(){var s={};return s.NoiseHandshakePayload=function(){function o(a){if(a)for(var c=Object.keys(a),u=0;u<c.length;++u)a[c[u]]!=null&&(this[c[u]]=a[c[u]])}return o.prototype.identityKey=i.newBuffer([]),o.prototype.identitySig=i.newBuffer([]),o.prototype.data=i.newBuffer([]),o.create=function(c){return new o(c)},o.encode=function(c,u){return u||(u=t.create()),c.identityKey!=null&&Object.hasOwnProperty.call(c,"identityKey")&&u.uint32(10).bytes(c.identityKey),c.identitySig!=null&&Object.hasOwnProperty.call(c,"identitySig")&&u.uint32(18).bytes(c.identitySig),c.data!=null&&Object.hasOwnProperty.call(c,"data")&&u.uint32(26).bytes(c.data),u},o.encodeDelimited=function(c,u){return this.encode(c,u).ldelim()},o.decode=function(c,u){c instanceof e||(c=e.create(c));for(var f=u===void 0?c.len:c.pos+u,d=new n.pb.NoiseHandshakePayload;c.pos<f;){var h=c.uint32();switch(h>>>3){case 1:d.identityKey=c.bytes();break;case 2:d.identitySig=c.bytes();break;case 3:d.data=c.bytes();break;default:c.skipType(h&7);break}}return d},o.decodeDelimited=function(c){return c instanceof e||(c=new e(c)),this.decode(c,c.uint32())},o.verify=function(c){return typeof c!="object"||c===null?"object expected":c.identityKey!=null&&c.hasOwnProperty("identityKey")&&!(c.identityKey&&typeof c.identityKey.length=="number"||i.isString(c.identityKey))?"identityKey: buffer expected":c.identitySig!=null&&c.hasOwnProperty("identitySig")&&!(c.identitySig&&typeof c.identitySig.length=="number"||i.isString(c.identitySig))?"identitySig: buffer expected":c.data!=null&&c.hasOwnProperty("data")&&!(c.data&&typeof c.data.length=="number"||i.isString(c.data))?"data: buffer expected":null},o.fromObject=function(c){if(c instanceof n.pb.NoiseHandshakePayload)return c;var u=new n.pb.NoiseHandshakePayload;return c.identityKey!=null&&(typeof c.identityKey=="string"?i.base64.decode(c.identityKey,u.identityKey=i.newBuffer(i.base64.length(c.identityKey)),0):c.identityKey.length&&(u.identityKey=c.identityKey)),c.identitySig!=null&&(typeof c.identitySig=="string"?i.base64.decode(c.identitySig,u.identitySig=i.newBuffer(i.base64.length(c.identitySig)),0):c.identitySig.length&&(u.identitySig=c.identitySig)),c.data!=null&&(typeof c.data=="string"?i.base64.decode(c.data,u.data=i.newBuffer(i.base64.length(c.data)),0):c.data.length&&(u.data=c.data)),u},o.toObject=function(c,u){u||(u={});var f={};return u.defaults&&(u.bytes===String?f.identityKey="":(f.identityKey=[],u.bytes!==Array&&(f.identityKey=i.newBuffer(f.identityKey))),u.bytes===String?f.identitySig="":(f.identitySig=[],u.bytes!==Array&&(f.identitySig=i.newBuffer(f.identitySig))),u.bytes===String?f.data="":(f.data=[],u.bytes!==Array&&(f.data=i.newBuffer(f.data)))),c.identityKey!=null&&c.hasOwnProperty("identityKey")&&(f.identityKey=u.bytes===String?i.base64.encode(c.identityKey,0,c.identityKey.length):u.bytes===Array?Array.prototype.slice.call(c.identityKey):c.identityKey),c.identitySig!=null&&c.hasOwnProperty("identitySig")&&(f.identitySig=u.bytes===String?i.base64.encode(c.identitySig,0,c.identitySig.length):u.bytes===Array?Array.prototype.slice.call(c.identitySig):c.identitySig),c.data!=null&&c.hasOwnProperty("data")&&(f.data=u.bytes===String?i.base64.encode(c.data,0,c.data.length):u.bytes===Array?Array.prototype.slice.call(c.data):c.data),f},o.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},o}(),s}(),n})});var gf=m(ir=>{l();"use strict";var zze=ir&&ir.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Hze=ir&&ir.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),$ze=ir&&ir.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&zze(e,r,t);return Hze(e,r),e},Gze=ir&&ir.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ir,"__esModule",{value:!0});ir.isValidPublicKey=ir.getHkdf=ir.verifySignedPayload=ir.getHandshakePayload=ir.decodePayload=ir.getPeerIdFromPayload=ir.signPayload=ir.createHandshakePayload=ir.getPayload=ir.generateKeypair=void 0;var Wze=ude(),Yze=CP(),Xze=$ze(R8()),OP=Gze(st()),Qze=dde(),Zze=(hi(),hn),Jze=(at(),Xr),eHe=(Ri(),Cn),k8=Qze.pb.NoiseHandshakePayload;function tHe(){let r=Xze.generateKeyPair();return{publicKey:r.publicKey,privateKey:r.secretKey}}ir.generateKeypair=tHe;async function rHe(r,e,t){let i=await pde(r,kP(e)),n=t??new Uint8Array(0);return hde(r.marshalPubKey(),i,n)}ir.getPayload=rHe;function hde(r,e,t){let i=k8.create({identityKey:r,identitySig:e,data:t??null});return k8.encode(i).finish()}ir.createHandshakePayload=hde;async function pde(r,e){return await r.privKey.sign(e)}ir.signPayload=pde;async function iHe(r){return await OP.default.createFromPubKey(r.identityKey)}ir.getPeerIdFromPayload=iHe;function nHe(r){return k8.toObject(k8.decode(r))}ir.decodePayload=nHe;function kP(r){let e=(0,Jze.fromString)("noise-libp2p-static-key:");return(0,eHe.concat)([e,r],e.length+r.length)}ir.getHandshakePayload=kP;async function sHe(r,e){let t=await OP.default.createFromPubKey(e);return(0,Zze.equals)(t.id,r)}async function oHe(r,e,t){let i=e.identityKey;if(!await sHe(t.id,i))throw new Error("Peer ID doesn't match libp2p public key.");let n=kP(r),s=await OP.default.createFromPubKey(i);if(!e.identitySig||!s.pubKey.verify(n,e.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return s}ir.verifySignedPayload=oHe;function aHe(r,e){let n=new Wze.HKDF(Yze.SHA256,e,r).expand(96),s=n.slice(0,32),o=n.slice(32,64),a=n.slice(64,96);return[s,o,a]}ir.getHkdf=aHe;function cHe(r){return!(!(r instanceof Uint8Array)||r.length!==32)}ir.isValidPublicKey=cHe});var gde=m(D8=>{l();"use strict";Object.defineProperty(D8,"__esModule",{value:!0});var An=Rm(),DP=Ac(),uHe=20;function lHe(r,e,t){for(var i=1634760805,n=857760878,s=2036477234,o=1797285236,a=t[3]<<24|t[2]<<16|t[1]<<8|t[0],c=t[7]<<24|t[6]<<16|t[5]<<8|t[4],u=t[11]<<24|t[10]<<16|t[9]<<8|t[8],f=t[15]<<24|t[14]<<16|t[13]<<8|t[12],d=t[19]<<24|t[18]<<16|t[17]<<8|t[16],h=t[23]<<24|t[22]<<16|t[21]<<8|t[20],p=t[27]<<24|t[26]<<16|t[25]<<8|t[24],y=t[31]<<24|t[30]<<16|t[29]<<8|t[28],g=e[3]<<24|e[2]<<16|e[1]<<8|e[0],w=e[7]<<24|e[6]<<16|e[5]<<8|e[4],b=e[11]<<24|e[10]<<16|e[9]<<8|e[8],v=e[15]<<24|e[14]<<16|e[13]<<8|e[12],R=i,k=n,C=s,T=o,D=a,j=c,M=u,se=f,ie=d,fe=h,pe=p,Be=y,Ae=g,ke=w,ne=b,Me=v,ct=0;ct<uHe;ct+=2)R=R+D|0,Ae^=R,Ae=Ae>>>32-16|Ae<<16,ie=ie+Ae|0,D^=ie,D=D>>>32-12|D<<12,k=k+j|0,ke^=k,ke=ke>>>32-16|ke<<16,fe=fe+ke|0,j^=fe,j=j>>>32-12|j<<12,C=C+M|0,ne^=C,ne=ne>>>32-16|ne<<16,pe=pe+ne|0,M^=pe,M=M>>>32-12|M<<12,T=T+se|0,Me^=T,Me=Me>>>32-16|Me<<16,Be=Be+Me|0,se^=Be,se=se>>>32-12|se<<12,C=C+M|0,ne^=C,ne=ne>>>32-8|ne<<8,pe=pe+ne|0,M^=pe,M=M>>>32-7|M<<7,T=T+se|0,Me^=T,Me=Me>>>32-8|Me<<8,Be=Be+Me|0,se^=Be,se=se>>>32-7|se<<7,k=k+j|0,ke^=k,ke=ke>>>32-8|ke<<8,fe=fe+ke|0,j^=fe,j=j>>>32-7|j<<7,R=R+D|0,Ae^=R,Ae=Ae>>>32-8|Ae<<8,ie=ie+Ae|0,D^=ie,D=D>>>32-7|D<<7,R=R+j|0,Me^=R,Me=Me>>>32-16|Me<<16,pe=pe+Me|0,j^=pe,j=j>>>32-12|j<<12,k=k+M|0,Ae^=k,Ae=Ae>>>32-16|Ae<<16,Be=Be+Ae|0,M^=Be,M=M>>>32-12|M<<12,C=C+se|0,ke^=C,ke=ke>>>32-16|ke<<16,ie=ie+ke|0,se^=ie,se=se>>>32-12|se<<12,T=T+D|0,ne^=T,ne=ne>>>32-16|ne<<16,fe=fe+ne|0,D^=fe,D=D>>>32-12|D<<12,C=C+se|0,ke^=C,ke=ke>>>32-8|ke<<8,ie=ie+ke|0,se^=ie,se=se>>>32-7|se<<7,T=T+D|0,ne^=T,ne=ne>>>32-8|ne<<8,fe=fe+ne|0,D^=fe,D=D>>>32-7|D<<7,k=k+M|0,Ae^=k,Ae=Ae>>>32-8|Ae<<8,Be=Be+Ae|0,M^=Be,M=M>>>32-7|M<<7,R=R+j|0,Me^=R,Me=Me>>>32-8|Me<<8,pe=pe+Me|0,j^=pe,j=j>>>32-7|j<<7;An.writeUint32LE(R+i|0,r,0),An.writeUint32LE(k+n|0,r,4),An.writeUint32LE(C+s|0,r,8),An.writeUint32LE(T+o|0,r,12),An.writeUint32LE(D+a|0,r,16),An.writeUint32LE(j+c|0,r,20),An.writeUint32LE(M+u|0,r,24),An.writeUint32LE(se+f|0,r,28),An.writeUint32LE(ie+d|0,r,32),An.writeUint32LE(fe+h|0,r,36),An.writeUint32LE(pe+p|0,r,40),An.writeUint32LE(Be+y|0,r,44),An.writeUint32LE(Ae+g|0,r,48),An.writeUint32LE(ke+w|0,r,52),An.writeUint32LE(ne+b|0,r,56),An.writeUint32LE(Me+v|0,r,60)}function yde(r,e,t,i,n){if(n===void 0&&(n=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<t.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=n}for(var a=new Uint8Array(64),c=0;c<t.length;c+=64){lHe(a,s,r);for(var u=c;u<c+64&&u<t.length;u++)i[u]=t[u]^a[u-c];dHe(s,0,o)}return DP.wipe(a),n===0&&DP.wipe(s),i}D8.streamXOR=yde;function fHe(r,e,t,i){return i===void 0&&(i=0),DP.wipe(t),yde(r,e,t,t,i)}D8.stream=fHe;function dHe(r,e,t){for(var i=1;t--;)i=i+(r[e]&255)|0,r[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}});var bde=m(Ou=>{l();"use strict";Object.defineProperty(Ou,"__esModule",{value:!0});var hHe=P8(),N8=Ac();Ou.DIGEST_LENGTH=16;var mde=function(){function r(e){this.digestLength=Ou.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var t=e[0]|e[1]<<8;this._r[0]=t&8191;var i=e[2]|e[3]<<8;this._r[1]=(t>>>13|i<<3)&8191;var n=e[4]|e[5]<<8;this._r[2]=(i>>>10|n<<6)&7939;var s=e[6]|e[7]<<8;this._r[3]=(n>>>7|s<<9)&8191;var o=e[8]|e[9]<<8;this._r[4]=(s>>>4|o<<12)&255,this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=(o>>>14|a<<2)&8191;var c=e[12]|e[13]<<8;this._r[7]=(a>>>11|c<<5)&8065;var u=e[14]|e[15]<<8;this._r[8]=(c>>>8|u<<8)&8191,this._r[9]=u>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return r.prototype._blocks=function(e,t,i){for(var n=this._fin?0:1<<11,s=this._h[0],o=this._h[1],a=this._h[2],c=this._h[3],u=this._h[4],f=this._h[5],d=this._h[6],h=this._h[7],p=this._h[8],y=this._h[9],g=this._r[0],w=this._r[1],b=this._r[2],v=this._r[3],R=this._r[4],k=this._r[5],C=this._r[6],T=this._r[7],D=this._r[8],j=this._r[9];i>=16;){var M=e[t+0]|e[t+1]<<8;s+=M&8191;var se=e[t+2]|e[t+3]<<8;o+=(M>>>13|se<<3)&8191;var ie=e[t+4]|e[t+5]<<8;a+=(se>>>10|ie<<6)&8191;var fe=e[t+6]|e[t+7]<<8;c+=(ie>>>7|fe<<9)&8191;var pe=e[t+8]|e[t+9]<<8;u+=(fe>>>4|pe<<12)&8191,f+=pe>>>1&8191;var Be=e[t+10]|e[t+11]<<8;d+=(pe>>>14|Be<<2)&8191;var Ae=e[t+12]|e[t+13]<<8;h+=(Be>>>11|Ae<<5)&8191;var ke=e[t+14]|e[t+15]<<8;p+=(Ae>>>8|ke<<8)&8191,y+=ke>>>5|n;var ne=0,Me=ne;Me+=s*g,Me+=o*(5*j),Me+=a*(5*D),Me+=c*(5*T),Me+=u*(5*C),ne=Me>>>13,Me&=8191,Me+=f*(5*k),Me+=d*(5*R),Me+=h*(5*v),Me+=p*(5*b),Me+=y*(5*w),ne+=Me>>>13,Me&=8191;var ct=ne;ct+=s*w,ct+=o*g,ct+=a*(5*j),ct+=c*(5*D),ct+=u*(5*T),ne=ct>>>13,ct&=8191,ct+=f*(5*C),ct+=d*(5*k),ct+=h*(5*R),ct+=p*(5*v),ct+=y*(5*b),ne+=ct>>>13,ct&=8191;var Ye=ne;Ye+=s*b,Ye+=o*w,Ye+=a*g,Ye+=c*(5*j),Ye+=u*(5*D),ne=Ye>>>13,Ye&=8191,Ye+=f*(5*T),Ye+=d*(5*C),Ye+=h*(5*k),Ye+=p*(5*R),Ye+=y*(5*v),ne+=Ye>>>13,Ye&=8191;var Xe=ne;Xe+=s*v,Xe+=o*b,Xe+=a*w,Xe+=c*g,Xe+=u*(5*j),ne=Xe>>>13,Xe&=8191,Xe+=f*(5*D),Xe+=d*(5*T),Xe+=h*(5*C),Xe+=p*(5*k),Xe+=y*(5*R),ne+=Xe>>>13,Xe&=8191;var de=ne;de+=s*R,de+=o*v,de+=a*b,de+=c*w,de+=u*g,ne=de>>>13,de&=8191,de+=f*(5*j),de+=d*(5*D),de+=h*(5*T),de+=p*(5*C),de+=y*(5*k),ne+=de>>>13,de&=8191;var J=ne;J+=s*k,J+=o*R,J+=a*v,J+=c*b,J+=u*w,ne=J>>>13,J&=8191,J+=f*g,J+=d*(5*j),J+=h*(5*D),J+=p*(5*T),J+=y*(5*C),ne+=J>>>13,J&=8191;var Ee=ne;Ee+=s*C,Ee+=o*k,Ee+=a*R,Ee+=c*v,Ee+=u*b,ne=Ee>>>13,Ee&=8191,Ee+=f*w,Ee+=d*g,Ee+=h*(5*j),Ee+=p*(5*D),Ee+=y*(5*T),ne+=Ee>>>13,Ee&=8191;var je=ne;je+=s*T,je+=o*C,je+=a*k,je+=c*R,je+=u*v,ne=je>>>13,je&=8191,je+=f*b,je+=d*w,je+=h*g,je+=p*(5*j),je+=y*(5*D),ne+=je>>>13,je&=8191;var ze=ne;ze+=s*D,ze+=o*T,ze+=a*C,ze+=c*k,ze+=u*R,ne=ze>>>13,ze&=8191,ze+=f*v,ze+=d*b,ze+=h*w,ze+=p*g,ze+=y*(5*j),ne+=ze>>>13,ze&=8191;var Te=ne;Te+=s*j,Te+=o*D,Te+=a*T,Te+=c*C,Te+=u*k,ne=Te>>>13,Te&=8191,Te+=f*R,Te+=d*v,Te+=h*b,Te+=p*w,Te+=y*g,ne+=Te>>>13,Te&=8191,ne=(ne<<2)+ne|0,ne=ne+Me|0,Me=ne&8191,ne=ne>>>13,ct+=ne,s=Me,o=ct,a=Ye,c=Xe,u=de,f=J,d=Ee,h=je,p=ze,y=Te,t+=16,i-=16}this._h[0]=s,this._h[1]=o,this._h[2]=a,this._h[3]=c,this._h[4]=u,this._h[5]=f,this._h[6]=d,this._h[7]=h,this._h[8]=p,this._h[9]=y},r.prototype.finish=function(e,t){t===void 0&&(t=0);var i=new Uint16Array(10),n,s,o,a;if(this._leftover){for(a=this._leftover,this._buffer[a++]=1;a<16;a++)this._buffer[a]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(n=this._h[1]>>>13,this._h[1]&=8191,a=2;a<10;a++)this._h[a]+=n,n=this._h[a]>>>13,this._h[a]&=8191;for(this._h[0]+=n*5,n=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=n,n=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=n,i[0]=this._h[0]+5,n=i[0]>>>13,i[0]&=8191,a=1;a<10;a++)i[a]=this._h[a]+n,n=i[a]>>>13,i[a]&=8191;for(i[9]-=1<<13,s=(n^1)-1,a=0;a<10;a++)i[a]&=s;for(s=~s,a=0;a<10;a++)this._h[a]=this._h[a]&s|i[a];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,o=this._h[0]+this._pad[0],this._h[0]=o&65535,a=1;a<8;a++)o=(this._h[a]+this._pad[a]|0)+(o>>>16)|0,this._h[a]=o&65535;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},r.prototype.update=function(e){var t=0,i=e.length,n;if(this._leftover){n=16-this._leftover,n>i&&(n=i);for(var s=0;s<n;s++)this._buffer[this._leftover+s]=e[t+s];if(i-=n,t+=n,this._leftover+=n,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(i>=16&&(n=i-i%16,this._blocks(e,t,n),t+=n,i-=n),i){for(var s=0;s<i;s++)this._buffer[this._leftover+s]=e[t+s];this._leftover+=i}return this},r.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},r.prototype.clean=function(){return N8.wipe(this._buffer),N8.wipe(this._r),N8.wipe(this._h),N8.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},r}();Ou.Poly1305=mde;function pHe(r,e){var t=new mde(r);t.update(e);var i=t.digest();return t.clean(),i}Ou.oneTimeAuth=pHe;function yHe(r,e){return r.length!==Ou.DIGEST_LENGTH||e.length!==Ou.DIGEST_LENGTH?!1:hHe.equal(r,e)}Ou.equal=yHe});var vde=m(ku=>{l();"use strict";Object.defineProperty(ku,"__esModule",{value:!0});var B8=gde(),gHe=bde(),Om=Ac(),wde=Rm(),mHe=P8();ku.KEY_LENGTH=32;ku.NONCE_LENGTH=12;ku.TAG_LENGTH=16;var _de=new Uint8Array(16),bHe=function(){function r(e){if(this.nonceLength=ku.NONCE_LENGTH,this.tagLength=ku.TAG_LENGTH,e.length!==ku.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return r.prototype.seal=function(e,t,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);B8.stream(this._key,s,o,4);var a=t.length+this.tagLength,c;if(n){if(n.length!==a)throw new Error("ChaCha20Poly1305: incorrect destination length");c=n}else c=new Uint8Array(a);return B8.streamXOR(this._key,s,t,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),o,c.subarray(0,c.length-this.tagLength),i),Om.wipe(s),c},r.prototype.open=function(e,t,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(t.length<this.tagLength)return null;var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);B8.stream(this._key,s,o,4);var a=new Uint8Array(this.tagLength);if(this._authenticate(a,o,t.subarray(0,t.length-this.tagLength),i),!mHe.equal(a,t.subarray(t.length-this.tagLength,t.length)))return null;var c=t.length-this.tagLength,u;if(n){if(n.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");u=n}else u=new Uint8Array(c);return B8.streamXOR(this._key,s,t.subarray(0,t.length-this.tagLength),u,4),Om.wipe(s),u},r.prototype.clean=function(){return Om.wipe(this._key),this},r.prototype._authenticate=function(e,t,i,n){var s=new gHe.Poly1305(t);n&&(s.update(n),n.length%16>0&&s.update(_de.subarray(n.length%16))),s.update(i),i.length%16>0&&s.update(_de.subarray(i.length%16));var o=new Uint8Array(8);n&&wde.writeUint64LE(n.length,o),s.update(o),wde.writeUint64LE(i.length,o),s.update(o);for(var a=s.digest(),c=0;c<a.length;c++)e[c]=a[c];s.clean(),Om.wipe(a),Om.wipe(o)},r}();ku.ChaCha20Poly1305=bHe});var L8={};Pt(L8,{xor:()=>NP});function NP(r,e){if(r.length!==e.length)throw new Error("Inputs should have the same length");let t=new Uint8Array(r.length);for(let i=0;i<r.length;i++)t[i]=r[i]^e[i];return t}var km=qe(()=>{l()});var Ede={};Pt(Ede,{compare:()=>Rg,concat:()=>Li,equals:()=>Hs,fromString:()=>Qe,toString:()=>$e,xor:()=>NP});var Sde=qe(()=>{l();t5();Ri();hi();at();et();km()});var M8=m(Du=>{l();"use strict";Object.defineProperty(Du,"__esModule",{value:!0});Du.DUMP_SESSION_KEYS=Du.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=Du.NOISE_MSG_MAX_LENGTH_BYTES=void 0;Du.NOISE_MSG_MAX_LENGTH_BYTES=65535;Du.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=Du.NOISE_MSG_MAX_LENGTH_BYTES-16;Du.DUMP_SESSION_KEYS=process.env.DUMP_SESSION_KEYS});var k1=m(fn=>{l();"use strict";var wHe=fn&&fn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(fn,"__esModule",{value:!0});fn.logCipherState=fn.logRemoteEphemeralKey=fn.logRemoteStaticKey=fn.logLocalEphemeralKeys=fn.logLocalStaticKeys=fn.logger=void 0;var _He=wHe(le()),vHe=M8(),mf=(et(),or);fn.logger=(0,_He.default)("libp2p:noise");var Ro;vHe.DUMP_SESSION_KEYS?Ro=fn.logger:Ro=()=>{};function EHe(r){Ro(`LOCAL_STATIC_PUBLIC_KEY ${(0,mf.toString)(r.publicKey,"hex")}`),Ro(`LOCAL_STATIC_PRIVATE_KEY ${(0,mf.toString)(r.privateKey,"hex")}`)}fn.logLocalStaticKeys=EHe;function SHe(r){r?(Ro(`LOCAL_PUBLIC_EPHEMERAL_KEY ${(0,mf.toString)(r.publicKey,"hex")}`),Ro(`LOCAL_PRIVATE_EPHEMERAL_KEY ${(0,mf.toString)(r.privateKey,"hex")}`)):Ro("Missing local ephemeral keys.")}fn.logLocalEphemeralKeys=SHe;function AHe(r){Ro(`REMOTE_STATIC_PUBLIC_KEY ${(0,mf.toString)(r,"hex")}`)}fn.logRemoteStaticKey=AHe;function RHe(r){Ro(`REMOTE_EPHEMERAL_PUBLIC_KEY ${(0,mf.toString)(r,"hex")}`)}fn.logRemoteEphemeralKey=RHe;function xHe(r){r.cs1&&r.cs2?(Ro(`CIPHER_STATE_1 ${r.cs1.n} ${(0,mf.toString)(r.cs1.k,"hex")}`),Ro(`CIPHER_STATE_2 ${r.cs2.n} ${(0,mf.toString)(r.cs2.k,"hex")}`)):Ro("Missing cipher state.")}fn.logCipherState=xHe});var BP=m(dn=>{l();"use strict";var IHe=dn&&dn.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),THe=dn&&dn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Ade=dn&&dn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&IHe(e,r,t);return THe(e,r),e};Object.defineProperty(dn,"__esModule",{value:!0});dn.AbstractHandshake=dn.MAX_NONCE=dn.MIN_NONCE=void 0;var PHe=Ade(R8()),CHe=Ade(CP()),Rde=vde(),OHe=(hi(),hn),kHe=(Ri(),Cn),DHe=(Sde(),Ede),xde=gf(),NHe=k1();dn.MIN_NONCE=0;dn.MAX_NONCE=Number.MAX_SAFE_INTEGER;var Ide="Cipherstate has reached maximum n, a new handshake must be performed",Tde=class{encryptWithAd(e,t,i){let n=this.encrypt(e.k,e.n,t,i);return this.setNonce(e,this.incrementNonce(e.n)),n}decryptWithAd(e,t,i){let{plaintext:n,valid:s}=this.decrypt(e.k,e.n,t,i);return this.setNonce(e,this.incrementNonce(e.n)),{plaintext:n,valid:s}}hasKey(e){return!this.isEmptyKey(e.k)}setNonce(e,t){e.n=t}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(e){let t=this.createEmptyKey();return(0,OHe.equals)(t,e)}incrementNonce(e){return e+1}nonceToBytes(e){let t=new Uint8Array(12);return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint32(4,e,!0),t}encrypt(e,t,i,n){if(t>dn.MAX_NONCE)throw new Error(Ide);let s=this.nonceToBytes(t);return new Rde.ChaCha20Poly1305(e).seal(s,n,i)}encryptAndHash(e,t){let i;return this.hasKey(e.cs)?i=this.encryptWithAd(e.cs,e.h,t):i=t,this.mixHash(e,i),i}decrypt(e,t,i,n){if(t>dn.MAX_NONCE)throw new Error(Ide);let s=this.nonceToBytes(t),a=new Rde.ChaCha20Poly1305(e).open(s,n,i);return a?{plaintext:a,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(e,t){let i,n=!0;return this.hasKey(e.cs)?{plaintext:i,valid:n}=this.decryptWithAd(e.cs,e.h,t):i=t,this.mixHash(e,t),{plaintext:i,valid:n}}dh(e,t){try{let i=PHe.sharedKey(e,t);return i.length===32?i:i.slice(0,32)}catch(i){return(0,NHe.logger)(i.message),new Uint8Array(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){return CHe.hash((0,kHe.concat)([e,t],e.length+t.length))}mixKey(e,t){let[i,n]=(0,xde.getHkdf)(e.ck,t);e.cs=this.initializeKey(n),e.ck=i}initializeKey(e){let t=dn.MIN_NONCE;return{k:e,n:t}}initializeSymmetric(e){let t=(0,DHe.fromString)(e,"utf-8"),i=this.hashProtocolName(t),n=i,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:n,h:i}}hashProtocolName(e){if(e.length<=32){let t=new Uint8Array(32);return t.set(e),t}else return this.getHash(e,new Uint8Array(0))}split(e){let[t,i]=(0,xde.getHkdf)(e.ck,new Uint8Array(0)),n=this.initializeKey(t),s=this.initializeKey(i);return{cs1:n,cs2:s}}writeMessageRegular(e,t){let i=this.encryptWithAd(e,new Uint8Array(0),t),n=this.createEmptyKey(),s=new Uint8Array(0);return{ne:n,ns:s,ciphertext:i}}readMessageRegular(e,t){return this.decryptWithAd(e,new Uint8Array(0),t.ciphertext)}};dn.AbstractHandshake=Tde});var Cde=m(j8=>{l();"use strict";Object.defineProperty(j8,"__esModule",{value:!0});j8.XX=void 0;var D1=gf(),BHe=BP(),Pde=class extends BHe.AbstractHandshake{initializeInitiator(e,t,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=new Uint8Array(32);return{ss:o,s:t,rs:i,psk:n,re:a}}initializeResponder(e,t,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=new Uint8Array(32);return{ss:o,s:t,rs:i,psk:n,re:a}}writeMessageA(e,t,i){let n=new Uint8Array(0);i!==void 0?e.e=i:e.e=(0,D1.generateKeypair)();let s=e.e.publicKey;this.mixHash(e.ss,s);let o=this.encryptAndHash(e.ss,t);return{ne:s,ns:n,ciphertext:o}}writeMessageB(e,t){e.e=(0,D1.generateKeypair)();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let n=e.s.publicKey,s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let o=this.encryptAndHash(e.ss,t);return{ne:i,ns:s,ciphertext:o}}writeMessageC(e,t){let i=e.s.publicKey,n=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,t),a={ne:this.createEmptyKey(),ns:n,ciphertext:s},{cs1:c,cs2:u}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:c,cs2:u}}readMessageA(e,t){return(0,D1.isValidPublicKey)(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if((0,D1.isValidPublicKey)(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&i.length===32&&(0,D1.isValidPublicKey)(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:s,valid:n&&o}}readMessageC(e,t){let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);if(n&&i.length===32&&(0,D1.isValidPublicKey)(i)&&(e.rs=i),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,plaintext:s,valid:n&&o,cs1:a,cs2:c}}initSession(e,t,i){let n=this.createEmptyKey(),s=new Uint8Array(32),o;return e?o=this.initializeInitiator(t,i,s,n):o=this.initializeResponder(t,i,s,n),{hs:o,i:e,mc:0}}sendMessage(e,t,i){let n;if(e.mc===0)n=this.writeMessageA(e.hs,t,i);else if(e.mc===1)n=this.writeMessageB(e.hs,t);else if(e.mc===2){let{h:s,messageBuffer:o,cs1:a,cs2:c}=this.writeMessageC(e.hs,t);n=o,e.h=s,e.cs1=a,e.cs2=c}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,t)}else throw new Error("Session invalid.");return e.mc++,n}recvMessage(e,t){let i=new Uint8Array(0),n=!1;if(e.mc===0)({plaintext:i,valid:n}=this.readMessageA(e.hs,t));else if(e.mc===1)({plaintext:i,valid:n}=this.readMessageB(e.hs,t));else if(e.mc===2){let{h:s,plaintext:o,valid:a,cs1:c,cs2:u}=this.readMessageC(e.hs,t);i=o,n=a,e.h=s,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:i,valid:n}}};j8.XX=Pde});var Dm=m(ni=>{l();"use strict";var LHe=ni&&ni.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ni,"__esModule",{value:!0});ni.decode2=ni.decode1=ni.decode0=ni.encode2=ni.encode1=ni.encode0=ni.uint16BEDecode=ni.uint16BEEncode=void 0;var MHe=LHe(on()),LP=(Ri(),Cn),jHe=r=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r),qHe=(r,e,t)=>(e=e||jHe(2),new DataView(e.buffer,e.byteOffset,e.byteLength).setUint16(t,r,!1),e);ni.uint16BEEncode=qHe;ni.uint16BEEncode.bytes=2;var UHe=r=>{if(r.length<2)throw RangeError("Could not decode int16BE");return r instanceof MHe.default?r.readUInt16BE(0):new DataView(r.buffer,r.byteOffset,r.byteLength).getUint16(0,!1)};ni.uint16BEDecode=UHe;ni.uint16BEDecode.bytes=2;function FHe(r){return(0,LP.concat)([r.ne,r.ciphertext],r.ne.length+r.ciphertext.length)}ni.encode0=FHe;function KHe(r){return(0,LP.concat)([r.ne,r.ns,r.ciphertext],r.ne.length+r.ns.length+r.ciphertext.length)}ni.encode1=KHe;function VHe(r){return(0,LP.concat)([r.ns,r.ciphertext],r.ns.length+r.ciphertext.length)}ni.encode2=VHe;function zHe(r){if(r.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:r.slice(0,32),ciphertext:r.slice(32,r.length),ns:new Uint8Array(0)}}ni.decode0=zHe;function HHe(r){if(r.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:r.slice(0,32),ns:r.slice(32,80),ciphertext:r.slice(80,r.length)}}ni.decode1=HHe;function $He(r){if(r.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:r.slice(0,48),ciphertext:r.slice(48,r.length)}}ni.decode2=$He});var MP=m(q8=>{l();"use strict";Object.defineProperty(q8,"__esModule",{value:!0});q8.XXHandshake=void 0;var GHe=Cde(),N1=gf(),wi=k1(),B1=Dm(),Ode=class{constructor(e,t,i,n,s,o,a){this.isInitiator=e,this.payload=t,this.prologue=i,this.staticKeypair=n,this.connection=s,o&&(this.remotePeer=o),this.xx=a??new GHe.XX,this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair),this.remoteEarlyData=new Uint8Array(0)}async propose(){if((0,wi.logLocalStaticKeys)(this.session.hs.s),this.isInitiator){(0,wi.logger)("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP((0,B1.encode0)(e)),(0,wi.logger)("Stage 0 - Initiator finished sending first message."),(0,wi.logLocalEphemeralKeys)(this.session.hs.e)}else{(0,wi.logger)("Stage 0 - Responder waiting to receive first message...");let e=(0,B1.decode0)((await this.connection.readLP()).slice()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new Error("xx handshake stage 0 validation fail");(0,wi.logger)("Stage 0 - Responder received first message."),(0,wi.logRemoteEphemeralKey)(this.session.hs.re)}}async exchange(){if(this.isInitiator){(0,wi.logger)("Stage 1 - Initiator waiting to receive first message from responder...");let e=(0,B1.decode1)((await this.connection.readLP()).slice()),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 1 validation fail");(0,wi.logger)("Stage 1 - Initiator received the message."),(0,wi.logRemoteEphemeralKey)(this.session.hs.re),(0,wi.logRemoteStaticKey)(this.session.hs.rs),(0,wi.logger)("Initiator going to check remote's signature...");try{let n=await(0,N1.decodePayload)(t);this.remotePeer=this.remotePeer||await(0,N1.getPeerIdFromPayload)(n),this.remotePeer=await(0,N1.verifySignedPayload)(e.ns,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}(0,wi.logger)("All good with the signature!")}else{(0,wi.logger)("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP((0,B1.encode1)(e)),(0,wi.logger)("Stage 1 - Responder sent the second handshake message with signed payload."),(0,wi.logLocalEphemeralKeys)(this.session.hs.e)}}async finish(){if(this.isInitiator){(0,wi.logger)("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP((0,B1.encode2)(e)),(0,wi.logger)("Stage 2 - Initiator sent message with signed payload.")}else{(0,wi.logger)("Stage 2 - Responder waiting for third handshake message...");let e=(0,B1.decode2)((await this.connection.readLP()).slice()),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 2 validation fail");(0,wi.logger)("Stage 2 - Responder received the message, finished handshake.");try{let n=await(0,N1.decodePayload)(t);this.remotePeer=this.remotePeer||await(0,N1.getPeerIdFromPayload)(n),await(0,N1.verifySignedPayload)(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}}(0,wi.logCipherState)(this.session)}encrypt(e,t){let i=this.getCS(t);return this.xx.encryptWithAd(i,new Uint8Array(0),e)}decrypt(e,t){let i=this.getCS(t,!1);return this.xx.decryptWithAd(i,new Uint8Array(0),e)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=e)}};q8.XXHandshake=Ode});var Dde=m(U8=>{l();"use strict";Object.defineProperty(U8,"__esModule",{value:!0});U8.IK=void 0;var Nm=gf(),WHe=BP(),kde=class extends WHe.AbstractHandshake{initSession(e,t,i,n){let s=this.createEmptyKey(),o;return e?o=this.initializeInitiator(t,i,n,s):o=this.initializeResponder(t,i,n,s),{hs:o,i:e,mc:0}}sendMessage(e,t){let i;if(e.mc===0)i=this.writeMessageA(e.hs,t);else if(e.mc===1){let{messageBuffer:n,h:s,cs1:o,cs2:a}=this.writeMessageB(e.hs,t);i=n,e.h=s,e.cs1=o,e.cs2=a}else if(e.mc>1)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(e.cs2,t)}else throw new Error("Session invalid.");return e.mc++,i}recvMessage(e,t){let i=new Uint8Array(0),n=!1;if(e.mc===0&&({plaintext:i,valid:n}=this.readMessageA(e.hs,t)),e.mc===1){let{plaintext:s,valid:o,h:a,cs1:c,cs2:u}=this.readMessageB(e.hs,t);i=s,n=o,e.h=a,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:i,valid:n}}writeMessageA(e,t){e.e=(0,Nm.generateKeypair)();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=e.s.publicKey,s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let o=this.encryptAndHash(e.ss,t);return{ne:i,ns:s,ciphertext:o}}writeMessageB(e,t){e.e=(0,Nm.generateKeypair)();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=this.encryptAndHash(e.ss,t),s=this.createEmptyKey(),o={ne:i,ns:s,ciphertext:n},{cs1:a,cs2:c}=this.split(e.ss);return{messageBuffer:o,cs1:a,cs2:c,h:e.ss.h}}readMessageA(e,t){(0,Nm.isValidPublicKey)(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&i.length===32&&(0,Nm.isValidPublicKey)(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:s,valid:n&&o}}readMessageB(e,t){if((0,Nm.isValidPublicKey)(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state should contain ephemeral key by now.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:s,cs2:o}=this.split(e.ss);return{h:e.ss.h,valid:n,plaintext:i,cs1:s,cs2:o}}initializeInitiator(e,t,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,i);let a=new Uint8Array(32);return{ss:o,s:t,rs:i,re:a,psk:n}}initializeResponder(e,t,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,t.publicKey);let a=new Uint8Array(32);return{ss:o,s:t,rs:i,re:a,psk:n}}};U8.IK=kde});var Bde=m(F8=>{l();"use strict";Object.defineProperty(F8,"__esModule",{value:!0});F8.FailedIKError=void 0;var Nde=class extends Error{constructor(e,t){super(t);this.initialMsg=e,this.name="FailedIKhandshake"}};F8.FailedIKError=Nde});var jde=m(V8=>{l();"use strict";Object.defineProperty(V8,"__esModule",{value:!0});V8.IKHandshake=void 0;var YHe=Dde(),K8=Dm(),L1=gf(),Lde=Bde(),Fi=k1(),Mde=class{constructor(e,t,i,n,s,o,a,c){this.isInitiator=e,this.payload=t,this.prologue=i,this.staticKeypair=n,this.connection=s,a&&(this.remotePeer=a),this.ik=c??new YHe.IK,this.session=this.ik.initSession(this.isInitiator,this.prologue,this.staticKeypair,o),this.remoteEarlyData=new Uint8Array}async stage0(){if((0,Fi.logLocalStaticKeys)(this.session.hs.s),(0,Fi.logRemoteStaticKey)(this.session.hs.rs),this.isInitiator){(0,Fi.logger)("IK Stage 0 - Initiator sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP((0,K8.encode1)(e)),(0,Fi.logger)("IK Stage 0 - Initiator sent message."),(0,Fi.logLocalEphemeralKeys)(this.session.hs.e)}else{(0,Fi.logger)("IK Stage 0 - Responder receiving message...");let e=await this.connection.readLP();try{let t=(0,K8.decode1)(e.slice()),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,t);if(!n)throw new Error("ik handshake stage 0 decryption validation fail");(0,Fi.logger)("IK Stage 0 - Responder got message, going to verify payload.");let s=await(0,L1.decodePayload)(i);this.remotePeer=this.remotePeer||await(0,L1.getPeerIdFromPayload)(s),await(0,L1.verifySignedPayload)(this.session.hs.rs,s,this.remotePeer),this.setRemoteEarlyData(s.data),(0,Fi.logger)("IK Stage 0 - Responder successfully verified payload!"),(0,Fi.logRemoteEphemeralKey)(this.session.hs.re)}catch(t){let i=t;throw(0,Fi.logger)("Responder breaking up with IK handshake in stage 0."),new Lde.FailedIKError(e,`Error occurred while verifying initiator's signed payload: ${i.message}`)}}}async stage1(){if(this.isInitiator){(0,Fi.logger)("IK Stage 1 - Initiator receiving message...");let e=(await this.connection.readLP()).slice(),t=(0,K8.decode0)(e),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,t);(0,Fi.logger)("IK Stage 1 - Initiator got message, going to verify payload.");try{if(!n)throw new Error("ik stage 1 decryption validation fail");let s=await(0,L1.decodePayload)(i);this.remotePeer=this.remotePeer||await(0,L1.getPeerIdFromPayload)(s),await(0,L1.verifySignedPayload)(t.ns.slice(0,32),s,this.remotePeer),this.setRemoteEarlyData(s.data),(0,Fi.logger)("IK Stage 1 - Initiator successfully verified payload!"),(0,Fi.logRemoteEphemeralKey)(this.session.hs.re)}catch(s){let o=s;throw(0,Fi.logger)("Initiator breaking up with IK handshake in stage 1."),new Lde.FailedIKError(e,`Error occurred while verifying responder's signed payload: ${o.message}`)}}else{(0,Fi.logger)("IK Stage 1 - Responder sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP((0,K8.encode0)(e)),(0,Fi.logger)("IK Stage 1 - Responder sent message..."),(0,Fi.logLocalEphemeralKeys)(this.session.hs.e)}(0,Fi.logCipherState)(this.session)}decrypt(e,t){let i=this.getCS(t,!1);return this.ik.decryptWithAd(i,new Uint8Array(0),e)}encrypt(e,t){let i=this.getCS(t);return this.ik.encryptWithAd(i,new Uint8Array(0),e)}getLocalEphemeralKeys(){if(!this.session.hs.e)throw new Error("Ephemeral keys do not exist.");return this.session.hs.e}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=e)}};V8.IKHandshake=Mde});var Fde=m(z8=>{l();"use strict";Object.defineProperty(z8,"__esModule",{value:!0});z8.XXFallbackHandshake=void 0;var XHe=MP(),jP=gf(),xo=k1(),qde=Dm(),Ude=class extends XHe.XXHandshake{constructor(e,t,i,n,s,o,a,c,u){super(e,t,i,n,s,a,u);c&&(this.ephemeralKeys=c),this.initialMsg=o}async propose(){if(this.isInitiator)this.xx.sendMessage(this.session,new Uint8Array(0),this.ephemeralKeys),(0,xo.logger)("XX Fallback Stage 0 - Initialized state as the first message was sent by initiator."),(0,xo.logLocalEphemeralKeys)(this.session.hs.e);else{(0,xo.logger)("XX Fallback Stage 0 - Responder decoding initial msg from IK.");let e=(0,qde.decode0)(this.initialMsg),{valid:t}=this.xx.recvMessage(this.session,{ne:e.ne,ns:new Uint8Array(0),ciphertext:new Uint8Array(0)});if(!t)throw new Error("xx fallback stage 0 decryption validation fail");(0,xo.logger)("XX Fallback Stage 0 - Responder used received message from IK."),(0,xo.logRemoteEphemeralKey)(this.session.hs.re)}}async exchange(){if(this.isInitiator){let e=(0,qde.decode1)(this.initialMsg),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx fallback stage 1 decryption validation fail");(0,xo.logger)("XX Fallback Stage 1 - Initiator used received message from IK."),(0,xo.logRemoteEphemeralKey)(this.session.hs.re),(0,xo.logRemoteStaticKey)(this.session.hs.rs),(0,xo.logger)("Initiator going to check remote's signature...");try{let n=await(0,jP.decodePayload)(t);this.remotePeer=this.remotePeer||await(0,jP.getPeerIdFromPayload)(n),await(0,jP.verifySignedPayload)(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload from responder: ${s.message}`)}(0,xo.logger)("All good with the signature!")}else(0,xo.logger)("XX Fallback Stage 1 - Responder start"),await super.exchange(),(0,xo.logger)("XX Fallback Stage 1 - Responder end")}};z8.XXFallbackHandshake=Ude});var Kde=m(M1=>{l();"use strict";Object.defineProperty(M1,"__esModule",{value:!0});M1.decryptStream=M1.encryptStream=void 0;var H8=M8();function QHe(r){return async function*(e){for await(let t of e)for(let i=0;i<t.length;i+=H8.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG){let n=i+H8.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG;n>t.length&&(n=t.length),yield r.encrypt(t.slice(i,n),r.session)}}}M1.encryptStream=QHe;function ZHe(r){return async function*(e){for await(let t of e)for(let i=0;i<t.length;i+=H8.NOISE_MSG_MAX_LENGTH_BYTES){let n=i+H8.NOISE_MSG_MAX_LENGTH_BYTES;n>t.length&&(n=t.length);let{plaintext:s,valid:o}=await r.decrypt(t.slice(i,n),r.session);if(!o)throw new Error("Failed to validate decrypted chunk");yield s}}}M1.decryptStream=ZHe});var zde=m($8=>{l();"use strict";Object.defineProperty($8,"__esModule",{value:!0});$8.KeyCache=void 0;var Vde=class{constructor(){this.storage=new Map}store(e,t){this.storage.set(e.id,t)}load(e){var t;return e&&(t=this.storage.get(e.id))!==null&&t!==void 0?t:null}resetStorage(){this.storage.clear()}},JHe=new Vde;$8.KeyCache=JHe});var UP=m(Io=>{l();"use strict";var e$e=Io&&Io.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),t$e=Io&&Io.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),r$e=Io&&Io.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&e$e(e,r,t);return t$e(e,r),e},G8=Io&&Io.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Io,"__esModule",{value:!0});Io.Noise=void 0;var i$e=r$e(R8()),Hde=G8(Qfe()),n$e=G8(rde()),$de=G8(T8()),s$e=G8(dr()),Gde=go(),o$e=MP(),a$e=jde(),c$e=Fde(),Wde=gf(),j1=Dm(),Yde=Kde(),qP=zde(),u$e=k1(),Xde=M8(),Qde=class{constructor(e,t){if(this.protocol="/noise",this.prologue=new Uint8Array(0),this.earlyData=t??new Uint8Array(0),this.useNoisePipes=!1,e){let i=i$e.generateKeyPairFromSeed(e);this.staticKeys={privateKey:i.secretKey,publicKey:i.publicKey}}else this.staticKeys=(0,Wde.generateKeypair)()}async secureOutbound(e,t,i){let n=(0,Hde.default)(t,{lengthEncoder:j1.uint16BEEncode,lengthDecoder:j1.uint16BEDecode,maxDataLength:Xde.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!0,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async secureInbound(e,t,i){let n=(0,Hde.default)(t,{lengthEncoder:j1.uint16BEEncode,lengthDecoder:j1.uint16BEDecode,maxDataLength:Xde.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!1,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async performHandshake(e){var t;let i=await(0,Wde.getPayload)(e.localPeer,this.staticKeys.publicKey,this.earlyData),n=this.useNoisePipes;if(e.isInitiator&&qP.KeyCache.load(e.remotePeer)===null&&(n=!1),n){let{remotePeer:s,connection:o,isInitiator:a}=e,c=new a$e.IKHandshake(a,i,this.prologue,this.staticKeys,o,(t=qP.KeyCache.load(e.remotePeer))!==null&&t!==void 0?t:new Uint8Array(32),s);try{return await this.performIKHandshake(c)}catch(u){let f;return e.isInitiator&&(f=c.getLocalEphemeralKeys()),await this.performXXFallbackHandshake(e,i,u.initialMsg,f)}}else return await this.performXXHandshake(e,i)}async performXXFallbackHandshake(e,t,i,n){let{isInitiator:s,remotePeer:o,connection:a}=e,c=new c$e.XXFallbackHandshake(s,t,this.prologue,this.staticKeys,a,i,o,n);try{await c.propose(),await c.exchange(),await c.finish()}catch(u){(0,u$e.logger)(u);let f=u;throw new Error(`Error occurred during XX Fallback handshake: ${f.message}`)}return c}async performXXHandshake(e,t){let{isInitiator:i,remotePeer:n,connection:s}=e,o=new o$e.XXHandshake(i,t,this.prologue,this.staticKeys,s,n);try{await o.propose(),await o.exchange(),await o.finish(),this.useNoisePipes&&o.remotePeer&&qP.KeyCache.store(o.remotePeer,o.getRemoteStaticKey())}catch(a){let c=a;throw new Error(`Error occurred during XX handshake: ${c.message}`)}return o}async performIKHandshake(e){return await e.stage0(),await e.stage1(),e}async createSecureConnection(e,t){let[i,n]=(0,n$e.default)(),s=e.unwrap();return await(0,s$e.default)(i,$de.default,(0,Yde.encryptStream)(t),(0,Gde.encode)({lengthEncoder:j1.uint16BEEncode}),s,(0,Gde.decode)({lengthDecoder:j1.uint16BEDecode}),$de.default,(0,Yde.decryptStream)(t),i),n}};Io.Noise=Qde});var Zde=m(Nu=>{l();"use strict";var l$e=Nu&&Nu.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),f$e=Nu&&Nu.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&l$e(e,r,t)};Object.defineProperty(Nu,"__esModule",{value:!0});Nu.NOISE=void 0;var d$e=UP();f$e(UP(),Nu);Nu.NOISE=new d$e.Noise});var the=m((Hkt,ehe)=>{l();"use strict";var h$e=DT(),{EventEmitter:p$e}=Ut();function Jde(r,e){if(r===e)return!0;if(r.length!==e.length)return!1;for(let t=0,i=r.length;t<i;++t)if(r[t]!==e[t])return!1;return!0}function FP(){return{contacts:[],dontSplit:!1,left:null,right:null}}function Bm(r,e){if(!(e instanceof Uint8Array))throw new TypeError(r+" is not a Uint8Array")}var Lm=class extends p$e{constructor(e={}){super();this.localNodeId=e.localNodeId||h$e(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||Lm.distance,this.arbiter=e.arbiter||Lm.arbiter,this.metadata=Object.assign({},e.metadata),Bm("option.localNodeId as parameter 1",this.localNodeId),this.root=FP()}static arbiter(e,t){return e.vectorClock>t.vectorClock?e:t}static distance(e,t){let i=0,n=0,s=Math.min(e.length,t.length),o=Math.max(e.length,t.length);for(;n<s;++n)i=i*256+(e[n]^t[n]);for(;n<o;++n)i=i*256+255;return i}add(e){Bm("contact.id",(e||{}).id);let t=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e.id,t++);let n=this._indexOf(i,e.id);return n>=0?(this._update(i,n,e),this):i.contacts.length<this.numberOfNodesPerKBucket?(i.contacts.push(e),this.emit("added",e),this):i.dontSplit?(this.emit("ping",i.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(i,t),this.add(e))}closest(e,t=1/0){if(Bm("id",e),!Number.isInteger(t)&&t!==1/0||t<=0)throw new TypeError("n is not positive number");let i=[];for(let n=[this.root],s=0;n.length>0&&i.length<t;){let o=n.pop();if(o.contacts===null){let a=this._determineNode(o,e,s++);n.push(o.left===a?o.right:o.left),n.push(a)}else i=i.concat(o.contacts)}return i.map(n=>[this.distance(n.id,e),n]).sort((n,s)=>n[0]-s[0]).slice(0,t).map(n=>n[1])}count(){let e=0;for(let t=[this.root];t.length>0;){let i=t.pop();i.contacts===null?t.push(i.right,i.left):e+=i.contacts.length}return e}_determineNode(e,t,i){let n=i>>3,s=i%8;return t.length<=n&&s!==0?e.left:t[n]&1<<7-s?e.right:e.left}get(e){Bm("id",e);let t=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,t++);let n=this._indexOf(i,e);return n>=0?i.contacts[n]:null}_indexOf(e,t){for(let i=0;i<e.contacts.length;++i)if(Jde(e.contacts[i].id,t))return i;return-1}remove(e){Bm("the id as parameter 1",e);let t=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,t++);let n=this._indexOf(i,e);if(n>=0){let s=i.contacts.splice(n,1)[0];this.emit("removed",s)}return this}_split(e,t){e.left=FP(),e.right=FP();for(let s of e.contacts)this._determineNode(e,s.id,t).contacts.push(s);e.contacts=null;let i=this._determineNode(e,this.localNodeId,t),n=e.left===i?e.right:e.left;n.dontSplit=!0}toArray(){let e=[];for(let t=[this.root];t.length>0;){let i=t.pop();i.contacts===null?t.push(i.right,i.left):e=e.concat(i.contacts)}return e}*toIterable(){for(let e=[this.root];e.length>0;){let t=e.pop();t.contacts===null?e.push(t.right,t.left):yield*t.contacts}}_update(e,t,i){if(!Jde(e.contacts[t].id,i.id))throw new Error("wrong index for _update");let n=e.contacts[t],s=this.arbiter(n,i);s===n&&n!==i||(e.contacts.splice(t,1),e.contacts.push(s),this.emit("updated",n,s))}};ehe.exports=Lm});var rhe=m(Mm=>{l();(function(){var r,e,t,i,n,s,o,a;a=function(c){var u,f,d,h;return u=(c&255<<24)>>>24,f=(c&255<<16)>>>16,d=(c&255<<8)>>>8,h=c&255,[u,f,d,h].join(".")},o=function(c){var u,f,d,h,p,y;for(u=[],d=h=0;h<=3&&c.length!==0;d=++h){if(d>0){if(c[0]!==".")throw new Error("Invalid IP");c=c.substring(1)}y=e(c),p=y[0],f=y[1],c=c.substring(f),u.push(p)}if(c.length!==0)throw new Error("Invalid IP");switch(u.length){case 1:if(u[0]>4294967295)throw new Error("Invalid IP");return u[0]>>>0;case 2:if(u[0]>255||u[1]>16777215)throw new Error("Invalid IP");return(u[0]<<24|u[1])>>>0;case 3:if(u[0]>255||u[1]>255||u[2]>65535)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2])>>>0;case 4:if(u[0]>255||u[1]>255||u[2]>255||u[3]>255)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2]<<8|u[3])>>>0;default:throw new Error("Invalid IP")}},t=function(c){return c.charCodeAt(0)},i=t("0"),s=t("a"),n=t("A"),e=function(c){var u,f,d,h,p;for(h=0,u=10,f="9",d=0,c.length>1&&c[d]==="0"&&(c[d+1]==="x"||c[d+1]==="X"?(d+=2,u=16):"0"<=c[d+1]&&c[d+1]<="9"&&(d++,u=8,f="7")),p=d;d<c.length;){if("0"<=c[d]&&c[d]<=f)h=h*u+(t(c[d])-i)>>>0;else if(u===16)if("a"<=c[d]&&c[d]<="f")h=h*u+(10+t(c[d])-s)>>>0;else if("A"<=c[d]&&c[d]<="F")h=h*u+(10+t(c[d])-n)>>>0;else break;else break;if(h>4294967295)throw new Error("too large");d++}if(d===p)throw new Error("empty octet");return[h,d]},r=function(){function c(u,f){var d,h,p,y;if(typeof u!="string")throw new Error("Missing `net' parameter");if(f||(y=u.split("/",2),u=y[0],f=y[1]),f||(f=32),typeof f=="string"&&f.indexOf(".")>-1){try{this.maskLong=o(f)}catch(g){throw d=g,new Error("Invalid mask: "+f)}for(h=p=32;p>=0;h=--p)if(this.maskLong===4294967295<<32-h>>>0){this.bitmask=h;break}}else if(f||f===0)this.bitmask=parseInt(f,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(o(u)&this.maskLong)>>>0}catch(g){throw d=g,new Error("Invalid net address: "+u)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+f);this.size=Math.pow(2,32-this.bitmask),this.base=a(this.netLong),this.mask=a(this.maskLong),this.hostmask=a(~this.maskLong),this.first=this.bitmask<=30?a(this.netLong+1):this.base,this.last=this.bitmask<=30?a(this.netLong+this.size-2):a(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?a(this.netLong+this.size-1):void 0}return c.prototype.contains=function(u){return typeof u=="string"&&(u.indexOf("/")>0||u.split(".").length!==4)&&(u=new c(u)),u instanceof c?this.contains(u.base)&&this.contains(u.broadcast||u.last):(o(u)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},c.prototype.next=function(u){return u==null&&(u=1),new c(a(this.netLong+this.size*u),this.mask)},c.prototype.forEach=function(u){var f,d,h;for(h=o(this.first),d=o(this.last),f=0;h<=d;)u(a(h),h,f),f++,h++},c.prototype.toString=function(){return this.base+"/"+this.bitmask},c}(),Mm.ip2long=o,Mm.long2ip=a,Mm.Netmask=r}).call(Mm)});var nhe=m((ihe,W8)=>{l();(function(r){"use strict";let e="(0?\\d+|0x[a-f0-9]+)",t={fourOctet:new RegExp(`^${e}\\.${e}\\.${e}\\.${e}$`,"i"),threeOctet:new RegExp(`^${e}\\.${e}\\.${e}$`,"i"),twoOctet:new RegExp(`^${e}\\.${e}$`,"i"),longValue:new RegExp(`^${e}$`,"i")},i=new RegExp("^0[0-7]+$","i"),n=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",o="(?:[0-9a-f]+::?)+",a={zoneIndex:new RegExp(s,"i"),native:new RegExp(`^(::)?(${o})?([0-9a-f]+)?(::)?(${s})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${e}\\.${e}\\.${e}\\.${e}(${s})?)$`,"i"),transitional:new RegExp(`^((?:${o})|(?:::)(?:${o})?)${e}\\.${e}\\.${e}\\.${e}(${s})?$`,"i")};function c(p,y){if(p.indexOf("::")!==p.lastIndexOf("::"))return null;let g=0,w=-1,b=(p.match(a.zoneIndex)||[])[0],v,R;for(b&&(b=b.substring(1),p=p.replace(/%.+$/,""));(w=p.indexOf(":",w+1))>=0;)g++;if(p.substr(0,2)==="::"&&g--,p.substr(-2,2)==="::"&&g--,g>y)return null;for(R=y-g,v=":";R--;)v+="0:";return p=p.replace("::",v),p[0]===":"&&(p=p.slice(1)),p[p.length-1]===":"&&(p=p.slice(0,-1)),y=function(){let k=p.split(":"),C=[];for(let T=0;T<k.length;T++)C.push(parseInt(k[T],16));return C}(),{parts:y,zoneId:b}}function u(p,y,g,w){if(p.length!==y.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let b=0,v;for(;w>0;){if(v=g-w,v<0&&(v=0),p[b]>>v!=y[b]>>v)return!1;w-=g,b+=1}return!0}function f(p){if(n.test(p))return parseInt(p,16);if(p[0]==="0"&&!isNaN(parseInt(p[1],10))){if(i.test(p))return parseInt(p,8);throw new Error(`ipaddr: cannot parse ${p} as octal`)}return parseInt(p,10)}function d(p,y){for(;p.length<y;)p=`0${p}`;return p}let h={};h.IPv4=function(){function p(y){if(y.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let g,w;for(g=0;g<y.length;g++)if(w=y[g],!(0<=w&&w<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=y}return p.prototype.SpecialRanges={unspecified:[[new p([0,0,0,0]),8]],broadcast:[[new p([255,255,255,255]),32]],multicast:[[new p([224,0,0,0]),4]],linkLocal:[[new p([169,254,0,0]),16]],loopback:[[new p([127,0,0,0]),8]],carrierGradeNat:[[new p([100,64,0,0]),10]],private:[[new p([10,0,0,0]),8],[new p([172,16,0,0]),12],[new p([192,168,0,0]),16]],reserved:[[new p([192,0,0,0]),24],[new p([192,0,2,0]),24],[new p([192,88,99,0]),24],[new p([198,51,100,0]),24],[new p([203,0,113,0]),24],[new p([240,0,0,0]),4]]},p.prototype.kind=function(){return"ipv4"},p.prototype.match=function(y,g){let w;if(g===void 0&&(w=y,y=w[0],g=w[1]),y.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,y.octets,8,g)},p.prototype.prefixLengthFromSubnetMask=function(){let y=0,g=!1,w={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},b,v,R;for(b=3;b>=0;b-=1)if(v=this.octets[b],v in w){if(R=w[v],g&&R!==0)return null;R!==8&&(g=!0),y+=R}else return null;return 32-y},p.prototype.range=function(){return h.subnetMatch(this,this.SpecialRanges)},p.prototype.toByteArray=function(){return this.octets.slice(0)},p.prototype.toIPv4MappedAddress=function(){return h.IPv6.parse(`::ffff:${this.toString()}`)},p.prototype.toNormalizedString=function(){return this.toString()},p.prototype.toString=function(){return this.octets.join(".")},p}(),h.IPv4.broadcastAddressFromCIDR=function(p){try{let y=this.parseCIDR(p),g=y[0].toByteArray(),w=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),b=[],v=0;for(;v<4;)b.push(parseInt(g[v],10)|parseInt(w[v],10)^255),v++;return new this(b)}catch(y){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},h.IPv4.isIPv4=function(p){return this.parser(p)!==null},h.IPv4.isValid=function(p){try{return new this(this.parser(p)),!0}catch(y){return!1}},h.IPv4.isValidFourPartDecimal=function(p){return!!(h.IPv4.isValid(p)&&p.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},h.IPv4.networkAddressFromCIDR=function(p){let y,g,w,b,v;try{for(y=this.parseCIDR(p),w=y[0].toByteArray(),v=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),b=[],g=0;g<4;)b.push(parseInt(w[g],10)&parseInt(v[g],10)),g++;return new this(b)}catch(R){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},h.IPv4.parse=function(p){let y=this.parser(p);if(y===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(y)},h.IPv4.parseCIDR=function(p){let y;if(y=p.match(/^(.+)\/(\d+)$/)){let g=parseInt(y[2]);if(g>=0&&g<=32){let w=[this.parse(y[1]),g];return Object.defineProperty(w,"toString",{value:function(){return this.join("/")}}),w}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},h.IPv4.parser=function(p){let y,g,w;if(y=p.match(t.fourOctet))return function(){let b=y.slice(1,6),v=[];for(let R=0;R<b.length;R++)g=b[R],v.push(f(g));return v}();if(y=p.match(t.longValue)){if(w=f(y[1]),w>4294967295||w<0)throw new Error("ipaddr: address outside defined range");return function(){let b=[],v;for(v=0;v<=24;v+=8)b.push(w>>v&255);return b}().reverse()}else return(y=p.match(t.twoOctet))?function(){let b=y.slice(1,4),v=[];if(w=f(b[1]),w>16777215||w<0)throw new Error("ipaddr: address outside defined range");return v.push(f(b[0])),v.push(w>>16&255),v.push(w>>8&255),v.push(w&255),v}():(y=p.match(t.threeOctet))?function(){let b=y.slice(1,5),v=[];if(w=f(b[2]),w>65535||w<0)throw new Error("ipaddr: address outside defined range");return v.push(f(b[0])),v.push(f(b[1])),v.push(w>>8&255),v.push(w&255),v}():null},h.IPv4.subnetMaskFromPrefixLength=function(p){if(p=parseInt(p),p<0||p>32)throw new Error("ipaddr: invalid IPv4 prefix length");let y=[0,0,0,0],g=0,w=Math.floor(p/8);for(;g<w;)y[g]=255,g++;return w<4&&(y[w]=Math.pow(2,p%8)-1<<8-p%8),new this(y)},h.IPv6=function(){function p(y,g){let w,b;if(y.length===16)for(this.parts=[],w=0;w<=14;w+=2)this.parts.push(y[w]<<8|y[w+1]);else if(y.length===8)this.parts=y;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(w=0;w<this.parts.length;w++)if(b=this.parts[w],!(0<=b&&b<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");g&&(this.zoneId=g)}return p.prototype.SpecialRanges={unspecified:[new p([0,0,0,0,0,0,0,0]),128],linkLocal:[new p([65152,0,0,0,0,0,0,0]),10],multicast:[new p([65280,0,0,0,0,0,0,0]),8],loopback:[new p([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new p([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new p([0,0,0,0,0,65535,0,0]),96],rfc6145:[new p([0,0,0,0,65535,0,0,0]),96],rfc6052:[new p([100,65435,0,0,0,0,0,0]),96],"6to4":[new p([8194,0,0,0,0,0,0,0]),16],teredo:[new p([8193,0,0,0,0,0,0,0]),32],reserved:[[new p([8193,3512,0,0,0,0,0,0]),32]]},p.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},p.prototype.kind=function(){return"ipv6"},p.prototype.match=function(y,g){let w;if(g===void 0&&(w=y,y=w[0],g=w[1]),y.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,y.parts,16,g)},p.prototype.prefixLengthFromSubnetMask=function(){let y=0,g=!1,w={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},b,v;for(let R=7;R>=0;R-=1)if(b=this.parts[R],b in w){if(v=w[b],g&&v!==0)return null;v!==16&&(g=!0),y+=v}else return null;return 128-y},p.prototype.range=function(){return h.subnetMatch(this,this.SpecialRanges)},p.prototype.toByteArray=function(){let y,g=[],w=this.parts;for(let b=0;b<w.length;b++)y=w[b],g.push(y>>8),g.push(y&255);return g},p.prototype.toFixedLengthString=function(){let y=function(){let w=[];for(let b=0;b<this.parts.length;b++)w.push(d(this.parts[b].toString(16),4));return w}.call(this).join(":"),g="";return this.zoneId&&(g=`%${this.zoneId}`),y+g},p.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");let y=this.parts.slice(-2),g=y[0],w=y[1];return new h.IPv4([g>>8,g&255,w>>8,w&255])},p.prototype.toNormalizedString=function(){let y=function(){let w=[];for(let b=0;b<this.parts.length;b++)w.push(this.parts[b].toString(16));return w}.call(this).join(":"),g="";return this.zoneId&&(g=`%${this.zoneId}`),y+g},p.prototype.toRFC5952String=function(){let y=/((^|:)(0(:|$)){2,})/g,g=this.toNormalizedString(),w=0,b=-1,v;for(;v=y.exec(g);)v[0].length>b&&(w=v.index,b=v[0].length);return b<0?g:`${g.substring(0,w)}::${g.substring(w+b)}`},p.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},p}(),h.IPv6.broadcastAddressFromCIDR=function(p){try{let y=this.parseCIDR(p),g=y[0].toByteArray(),w=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),b=[],v=0;for(;v<16;)b.push(parseInt(g[v],10)|parseInt(w[v],10)^255),v++;return new this(b)}catch(y){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${y})`)}},h.IPv6.isIPv6=function(p){return this.parser(p)!==null},h.IPv6.isValid=function(p){if(typeof p=="string"&&p.indexOf(":")===-1)return!1;try{let y=this.parser(p);return new this(y.parts,y.zoneId),!0}catch(y){return!1}},h.IPv6.networkAddressFromCIDR=function(p){let y,g,w,b,v;try{for(y=this.parseCIDR(p),w=y[0].toByteArray(),v=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),b=[],g=0;g<16;)b.push(parseInt(w[g],10)&parseInt(v[g],10)),g++;return new this(b)}catch(R){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${R})`)}},h.IPv6.parse=function(p){let y=this.parser(p);if(y.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(y.parts,y.zoneId)},h.IPv6.parseCIDR=function(p){let y,g,w;if((g=p.match(/^(.+)\/(\d+)$/))&&(y=parseInt(g[2]),y>=0&&y<=128))return w=[this.parse(g[1]),y],Object.defineProperty(w,"toString",{value:function(){return this.join("/")}}),w;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},h.IPv6.parser=function(p){let y,g,w,b,v,R;if(w=p.match(a.deprecatedTransitional))return this.parser(`::ffff:${w[1]}`);if(a.native.test(p))return c(p,8);if((w=p.match(a.transitional))&&(R=w[6]||"",y=c(w[1].slice(0,-1)+R,6),y.parts)){for(v=[parseInt(w[2]),parseInt(w[3]),parseInt(w[4]),parseInt(w[5])],g=0;g<v.length;g++)if(b=v[g],!(0<=b&&b<=255))return null;return y.parts.push(v[0]<<8|v[1]),y.parts.push(v[2]<<8|v[3]),{parts:y.parts,zoneId:y.zoneId}}return null},h.IPv6.subnetMaskFromPrefixLength=function(p){if(p=parseInt(p),p<0||p>128)throw new Error("ipaddr: invalid IPv6 prefix length");let y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=0,w=Math.floor(p/8);for(;g<w;)y[g]=255,g++;return w<16&&(y[w]=Math.pow(2,p%8)-1<<8-p%8),new this(y)},h.fromByteArray=function(p){let y=p.length;if(y===4)return new h.IPv4(p);if(y===16)return new h.IPv6(p);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},h.isValid=function(p){return h.IPv6.isValid(p)||h.IPv4.isValid(p)},h.parse=function(p){if(h.IPv6.isValid(p))return h.IPv6.parse(p);if(h.IPv4.isValid(p))return h.IPv4.parse(p);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},h.parseCIDR=function(p){try{return h.IPv6.parseCIDR(p)}catch(y){try{return h.IPv4.parseCIDR(p)}catch(g){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},h.process=function(p){let y=this.parse(p);return y.kind()==="ipv6"&&y.isIPv4MappedAddress()?y.toIPv4Address():y},h.subnetMatch=function(p,y,g){let w,b,v,R;g==null&&(g="unicast");for(b in y)if(Object.prototype.hasOwnProperty.call(y,b)){for(v=y[b],v[0]&&!(v[0]instanceof Array)&&(v=[v]),w=0;w<v.length;w++)if(R=v[w],p.kind()===R[0].kind()&&p.match.apply(p,R))return b}return g},typeof W8!="undefined"&&W8.exports?W8.exports=h:r.ipaddr=h})(ihe)});var che=m(jm=>{l();"use strict";var she=jm&&jm.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(jm,"__esModule",{value:!0});var y$e=rhe(),g$e=she(I7()),m$e=she(P7()),ohe=nhe(),b$e=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],w$e=b$e.map(r=>new y$e.Netmask(r));function _$e(r){for(let e of w$e)if(e.contains(r))return!0;return!1}function ahe(r){return/^::$/.test(r)||/^::1$/.test(r)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(r)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(r)||/^ff([0-9a-fA-F]{2,2}):/i.test(r)}jm.default=r=>{if(ohe.isValid(r)){let e=ohe.parse(r);if(e.kind()==="ipv4")return _$e(e.toNormalizedString());if(e.kind()==="ipv6")return ahe(r)}else if(m$e.default(r)&&g$e.default.v6().test(r))return ahe(r)}});var Y8=m((Wkt,uhe)=>{l();"use strict";uhe.exports=che().default});var Dr=m((Ykt,dhe)=>{l();"use strict";var qm=le(),{sha256:lhe}=(Si(),Ks),{base58btc:v$e}=(di(),Fo),{base32:E$e}=(rn(),Fc),{Key:S$e}=(Mr(),Ap),{Record:A$e}=Ja(),R$e=st(),{fromString:x$e}=(at(),Xr),{toString:KP}=(et(),or),{concat:I$e}=(Ri(),Cn),fhe=Y8(),T$e=x$e("/pk/");function P$e({id:r,multiaddrs:e}){return{id:r,multiaddrs:e.filter(t=>{let[[i,n]]=t.stringTuples();return i!==4&&i!==6?!1:!fhe(n)})}}function C$e({id:r,multiaddrs:e}){return{id:r,multiaddrs:e.filter(t=>{let[[i,n]]=t.stringTuples();return i!==4&&i!==6?!1:fhe(n)})}}var O$e=async r=>(await lhe.digest(r)).digest,k$e=async r=>(await lhe.digest(r.id)).digest,D$e=r=>new S$e("/"+KP(r,"base32"),!1),N$e=r=>I$e([T$e,r.id]),B$e=r=>KP(r.slice(0,4))==="/pk/",L$e=r=>KP(r.slice(0,4))==="/ipns/",M$e=r=>new R$e(r.slice(4)),j$e=(r,e)=>{let t=new Date;return new A$e(r,e,t).serialize()},q$e=r=>(qm.formatters.b=t=>v$e.baseEncode(t),qm.formatters.t=t=>E$e.baseEncode(t),qm.formatters.p=t=>t.toB58String(),Object.assign(qm(r),{error:qm(`${r}:error`)}));dhe.exports={removePrivateAddresses:P$e,removePublicAddresses:C$e,convertBuffer:O$e,convertPeerId:k$e,bufferToKey:D$e,keyForPublicKey:N$e,isPublicKeyKey:B$e,isIPNSKey:L$e,fromPublicKeyKey:M$e,createPutRecord:j$e,logger:q$e}});var Ic=m(Di=>{l();"use strict";var Um=Di.second=1e3,VP=Di.minute=60*Um,zP=Di.hour=60*VP;Di.MAX_RECORD_AGE=36*zP;Di.PROTOCOL_DHT="/kad/1.0.0";Di.RECORD_KEY_PREFIX="/dht/record";Di.PROVIDER_KEY_PREFIX="/dht/provider";Di.PROVIDERS_LRU_CACHE_SIZE=256;Di.PROVIDERS_VALIDITY=24*zP;Di.PROVIDERS_CLEANUP_INTERVAL=zP;Di.READ_MESSAGE_TIMEOUT=10*Um;Di.GET_MANY_RECORD_COUNT=16;Di.K=20;Di.ALPHA=3;Di.QUERY_SELF_INTERVAL=Number(5*VP);Di.QUERY_SELF_TIMEOUT=Number(30*Um);Di.TABLE_REFRESH_INTERVAL=Number(5*VP);Di.TABLE_REFRESH_QUERY_TIMEOUT=Number(30*Um);Di.DEFAULT_QUERY_TIMEOUT=Number(30*Um)});var yhe=m((Qkt,phe)=>{l();"use strict";var U$e=the(),Fm=Dr(),{default:F$e}=Go(),{PROTOCOL_DHT:K$e}=Ic(),{TimeoutController:V$e}=Ma(),HP="routing-table-size",hhe=class{constructor({peerId:e,dialer:t,kBucketSize:i,pingTimeout:n,lan:s,metrics:o}){this._log=Fm.logger(`libp2p:kad-dht:${s?"lan":"wan"}:routing-table`),this._peerId=e,this._dialer=t,this._kBucketSize=i||20,this._pingTimeout=n||1e4,this._lan=s,this._metrics=o,this.kb,this.commonPrefixLengthRefreshedAt=[],this._onPing=this._onPing.bind(this),this._pingQueue=new F$e({concurrency:1}),this._running=!1}async start(){this._running=!0,this.kb=new U$e({localNodeId:await Fm.convertPeerId(this._peerId),numberOfNodesPerKBucket:this._kBucketSize,numberOfNodesToPing:1}),this.kb.on("ping",this._onPing)}async stop(){this._running=!1,this._pingQueue.clear()}_onPing(e,t){this._pingQueue.add(async()=>{if(!this._running)return;let i=0;try{await Promise.all(e.map(async n=>{let s;try{s=new V$e(this._pingTimeout),this._log(`pinging old contact ${n.peer}`);let{stream:o}=await this._dialer.dialProtocol(n.peer,K$e,{signal:s.signal});await o.close(),i++}catch(o){this._running&&(this._log.error("could not ping peer %p",n.peer,o),this._log(`evicting old contact after ping failed ${n.peer}`),this.kb.remove(n.id))}finally{s&&s.clear(),this._metrics&&this._metrics.updateComponentMetric({component:`kad-dht-${this._lan?"lan":"wan"}`,metric:HP,value:this.size})}})),this._running&&i<e.length&&(this._log(`adding new contact ${t.peer}`),this.kb.add(t))}catch(n){this._log.error("could not process k-bucket ping event",n)}})}get size(){return this.kb.count()}async find(e){let t=await Fm.convertPeerId(e),i=this.closestPeer(t);if(i&&e.equals(i))return i}closestPeer(e){let t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e,t=this._kBucketSize){return this.kb.closest(e,t).map(n=>n.peer)}async add(e){let t=await Fm.convertPeerId(e);this.kb.add({id:t,peer:e}),this._log("added %p with kad id %b",e,t),this._metrics&&this._metrics.updateComponentMetric({component:`kad-dht-${this._lan?"lan":"wan"}`,metric:HP,value:this.size})}async remove(e){let t=await Fm.convertPeerId(e);this.kb.remove(t),this._metrics&&this._metrics.updateComponentMetric({component:`kad-dht-${this._lan?"lan":"wan"}`,metric:HP,value:this.size})}};phe.exports.RoutingTable=hhe});var ghe=m((Zkt,z$e)=>{z$e.exports=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782]});var whe=m((Jkt,bhe)=>{l();"use strict";var{xor:H$e}=(km(),L8),$$e=ghe(),{sha256:G$e}=(Si(),Ks),W$e=Qa(),Y$e=st(),X$e=Dr(),Q$e=Sg(),{TimeoutController:Z$e}=Ma(),{TABLE_REFRESH_INTERVAL:J$e,TABLE_REFRESH_QUERY_TIMEOUT:eGe}=Ic(),X8=15,mhe=class{constructor({peerRouting:e,routingTable:t,refreshInterval:i,refreshQueryTimeout:n,lan:s}){this._log=X$e.logger(`libp2p:kad-dht:${s?"lan":"wan"}:routing-table:refresh`),this._peerRouting=e,this._routingTable=t,this._refreshInterval=i||J$e,this._refreshQueryTimeout=n||eGe,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}async start(){this._log(`refreshing routing table every ${this._refreshInterval}ms`),await this.refreshTable(!0)}async stop(){this._refreshTimeoutId&&clearTimeout(this._refreshTimeoutId)}async refreshTable(e){this._log("refreshing routing table");let t=this._maxCommonPrefix(),i=this._getTrackedCommonPrefixLengthsForRefresh(t);this._log(`max common prefix length ${t}`),this._log(`tracked CPLs [ ${i.map(n=>n.toISOString()).join(", ")} ]`),await Promise.all(i.map(async(n,s)=>{try{if(await this._refreshCommonPrefixLength(s,n,e===!0),this._numPeersForCpl(t)===0){let o=Math.min(2*(s+1),i.length-1);for(let a=s+1;a<o+1;a++)try{await this._refreshCommonPrefixLength(a,n,e===!0)}catch(c){this._log.error(c)}}}catch(o){this._log.error(o)}})),this._refreshTimeoutId=setTimeout(this.refreshTable,this._refreshInterval),this._refreshTimeoutId.unref&&this._refreshTimeoutId.unref()}async _refreshCommonPrefixLength(e,t,i){if(!i&&t.getTime()>Date.now()-this._refreshInterval){this._log("not running refresh for cpl %s as time since last refresh not above interval",e);return}let n=await this._generateRandomPeerId(e);this._log("starting refreshing cpl %s with key %p (routing table size was %s)",e,n,this._routingTable.kb.count());let s=new Z$e(this._refreshQueryTimeout);try{let o=await Q$e(this._peerRouting.getClosestPeers(n.toBytes(),{signal:s.signal}));this._log(`found ${o} peers that were close to imaginary peer %p`,n),this._log("finished refreshing cpl %s with key %p (routing table size is now %s)",e,n,this._routingTable.kb.count())}finally{s.clear()}}_getTrackedCommonPrefixLengthsForRefresh(e){e>X8&&(e=X8);let t=[];for(let i=0;i<=e;i++)t[i]=this.commonPrefixLengthRefreshedAt[i]||new Date;return t}async _generateRandomPeerId(e){let t=W$e.randomBytes(2),i=(t[1]<<8)+t[0],n=await this._makePeerId(this._routingTable.kb.localNodeId,i,e);return Y$e.createFromBytes(n)}async _makePeerId(e,t,i){if(i>X8)throw new Error(`Cannot generate peer ID for common prefix length greater than ${X8}`);let o=new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1)^32768>>i,a=65535<<16-(i+1),c=o&a|t&~a,u=$$e[c],f=new ArrayBuffer(34),d=new DataView(f,0,f.byteLength);return d.setUint8(0,G$e.code),d.setUint8(1,32),d.setUint32(2,u,!1),new Uint8Array(d.buffer,d.byteOffset,d.byteLength)}_maxCommonPrefix(){let e=0;for(let t of this._prefixLengths())t>e&&(e=t);return e}_numPeersForCpl(e){let t=0;for(let i of this._prefixLengths())i===e&&t++;return t}*_prefixLengths(){if(!!this._routingTable.kb)for(let{id:e}of this._routingTable.kb.toIterable()){let t=H$e(this._routingTable.kb.localNodeId,e),i=0;for(let n of t)if(n===0)i++;else break;yield i}}};bhe.exports.RoutingTableRefresh=mhe});var Tc=m((eDt,vhe)=>{l();"use strict";function _he(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function tGe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return _he(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),_he(new n,t)}}vhe.exports=tGe});var GP=m((tDt,Ehe)=>{l();"use strict";var bf=Br(),q1=bf.Reader,$P=bf.Writer,We=bf.util,si=bf.roots["libp2p-dht-message"]||(bf.roots["libp2p-dht-message"]={});si.Record=function(){function r(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.key=null,r.prototype.value=null,r.prototype.author=null,r.prototype.signature=null,r.prototype.timeReceived=null;var e;return Object.defineProperty(r.prototype,"_key",{get:We.oneOfGetter(e=["key"]),set:We.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_value",{get:We.oneOfGetter(e=["value"]),set:We.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_author",{get:We.oneOfGetter(e=["author"]),set:We.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_signature",{get:We.oneOfGetter(e=["signature"]),set:We.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_timeReceived",{get:We.oneOfGetter(e=["timeReceived"]),set:We.oneOfSetter(e)}),r.encode=function(i,n){return n||(n=$P.create()),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&n.uint32(10).bytes(i.key),i.value!=null&&Object.hasOwnProperty.call(i,"value")&&n.uint32(18).bytes(i.value),i.author!=null&&Object.hasOwnProperty.call(i,"author")&&n.uint32(26).bytes(i.author),i.signature!=null&&Object.hasOwnProperty.call(i,"signature")&&n.uint32(34).bytes(i.signature),i.timeReceived!=null&&Object.hasOwnProperty.call(i,"timeReceived")&&n.uint32(42).string(i.timeReceived),n},r.decode=function(i,n){i instanceof q1||(i=q1.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new si.Record;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.key=i.bytes();break;case 2:o.value=i.bytes();break;case 3:o.author=i.bytes();break;case 4:o.signature=i.bytes();break;case 5:o.timeReceived=i.string();break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof si.Record)return i;var n=new si.Record;return i.key!=null&&(typeof i.key=="string"?We.base64.decode(i.key,n.key=We.newBuffer(We.base64.length(i.key)),0):i.key.length&&(n.key=i.key)),i.value!=null&&(typeof i.value=="string"?We.base64.decode(i.value,n.value=We.newBuffer(We.base64.length(i.value)),0):i.value.length&&(n.value=i.value)),i.author!=null&&(typeof i.author=="string"?We.base64.decode(i.author,n.author=We.newBuffer(We.base64.length(i.author)),0):i.author.length&&(n.author=i.author)),i.signature!=null&&(typeof i.signature=="string"?We.base64.decode(i.signature,n.signature=We.newBuffer(We.base64.length(i.signature)),0):i.signature.length&&(n.signature=i.signature)),i.timeReceived!=null&&(n.timeReceived=String(i.timeReceived)),n},r.toObject=function(i,n){n||(n={});var s={};return i.key!=null&&i.hasOwnProperty("key")&&(s.key=n.bytes===String?We.base64.encode(i.key,0,i.key.length):n.bytes===Array?Array.prototype.slice.call(i.key):i.key,n.oneofs&&(s._key="key")),i.value!=null&&i.hasOwnProperty("value")&&(s.value=n.bytes===String?We.base64.encode(i.value,0,i.value.length):n.bytes===Array?Array.prototype.slice.call(i.value):i.value,n.oneofs&&(s._value="value")),i.author!=null&&i.hasOwnProperty("author")&&(s.author=n.bytes===String?We.base64.encode(i.author,0,i.author.length):n.bytes===Array?Array.prototype.slice.call(i.author):i.author,n.oneofs&&(s._author="author")),i.signature!=null&&i.hasOwnProperty("signature")&&(s.signature=n.bytes===String?We.base64.encode(i.signature,0,i.signature.length):n.bytes===Array?Array.prototype.slice.call(i.signature):i.signature,n.oneofs&&(s._signature="signature")),i.timeReceived!=null&&i.hasOwnProperty("timeReceived")&&(s.timeReceived=i.timeReceived,n.oneofs&&(s._timeReceived="timeReceived")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,bf.util.toJSONOptions)},r}();si.Message=function(){function r(t){if(this.closerPeers=[],this.providerPeers=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.type=null,r.prototype.clusterLevelRaw=null,r.prototype.key=null,r.prototype.record=null,r.prototype.closerPeers=We.emptyArray,r.prototype.providerPeers=We.emptyArray;var e;return Object.defineProperty(r.prototype,"_type",{get:We.oneOfGetter(e=["type"]),set:We.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_clusterLevelRaw",{get:We.oneOfGetter(e=["clusterLevelRaw"]),set:We.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_key",{get:We.oneOfGetter(e=["key"]),set:We.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_record",{get:We.oneOfGetter(e=["record"]),set:We.oneOfSetter(e)}),r.encode=function(i,n){if(n||(n=$P.create()),i.type!=null&&Object.hasOwnProperty.call(i,"type")&&n.uint32(8).int32(i.type),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&n.uint32(18).bytes(i.key),i.record!=null&&Object.hasOwnProperty.call(i,"record")&&n.uint32(26).bytes(i.record),i.closerPeers!=null&&i.closerPeers.length)for(var s=0;s<i.closerPeers.length;++s)si.Message.Peer.encode(i.closerPeers[s],n.uint32(66).fork()).ldelim();if(i.providerPeers!=null&&i.providerPeers.length)for(var s=0;s<i.providerPeers.length;++s)si.Message.Peer.encode(i.providerPeers[s],n.uint32(74).fork()).ldelim();return i.clusterLevelRaw!=null&&Object.hasOwnProperty.call(i,"clusterLevelRaw")&&n.uint32(80).int32(i.clusterLevelRaw),n},r.decode=function(i,n){i instanceof q1||(i=q1.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new si.Message;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.type=i.int32();break;case 10:o.clusterLevelRaw=i.int32();break;case 2:o.key=i.bytes();break;case 3:o.record=i.bytes();break;case 8:o.closerPeers&&o.closerPeers.length||(o.closerPeers=[]),o.closerPeers.push(si.Message.Peer.decode(i,i.uint32()));break;case 9:o.providerPeers&&o.providerPeers.length||(o.providerPeers=[]),o.providerPeers.push(si.Message.Peer.decode(i,i.uint32()));break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof si.Message)return i;var n=new si.Message;switch(i.type){case"PUT_VALUE":case 0:n.type=0;break;case"GET_VALUE":case 1:n.type=1;break;case"ADD_PROVIDER":case 2:n.type=2;break;case"GET_PROVIDERS":case 3:n.type=3;break;case"FIND_NODE":case 4:n.type=4;break;case"PING":case 5:n.type=5;break}if(i.clusterLevelRaw!=null&&(n.clusterLevelRaw=i.clusterLevelRaw|0),i.key!=null&&(typeof i.key=="string"?We.base64.decode(i.key,n.key=We.newBuffer(We.base64.length(i.key)),0):i.key.length&&(n.key=i.key)),i.record!=null&&(typeof i.record=="string"?We.base64.decode(i.record,n.record=We.newBuffer(We.base64.length(i.record)),0):i.record.length&&(n.record=i.record)),i.closerPeers){if(!Array.isArray(i.closerPeers))throw TypeError(".Message.closerPeers: array expected");n.closerPeers=[];for(var s=0;s<i.closerPeers.length;++s){if(typeof i.closerPeers[s]!="object")throw TypeError(".Message.closerPeers: object expected");n.closerPeers[s]=si.Message.Peer.fromObject(i.closerPeers[s])}}if(i.providerPeers){if(!Array.isArray(i.providerPeers))throw TypeError(".Message.providerPeers: array expected");n.providerPeers=[];for(var s=0;s<i.providerPeers.length;++s){if(typeof i.providerPeers[s]!="object")throw TypeError(".Message.providerPeers: object expected");n.providerPeers[s]=si.Message.Peer.fromObject(i.providerPeers[s])}}return n},r.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.closerPeers=[],s.providerPeers=[]),i.type!=null&&i.hasOwnProperty("type")&&(s.type=n.enums===String?si.Message.MessageType[i.type]:i.type,n.oneofs&&(s._type="type")),i.key!=null&&i.hasOwnProperty("key")&&(s.key=n.bytes===String?We.base64.encode(i.key,0,i.key.length):n.bytes===Array?Array.prototype.slice.call(i.key):i.key,n.oneofs&&(s._key="key")),i.record!=null&&i.hasOwnProperty("record")&&(s.record=n.bytes===String?We.base64.encode(i.record,0,i.record.length):n.bytes===Array?Array.prototype.slice.call(i.record):i.record,n.oneofs&&(s._record="record")),i.closerPeers&&i.closerPeers.length){s.closerPeers=[];for(var o=0;o<i.closerPeers.length;++o)s.closerPeers[o]=si.Message.Peer.toObject(i.closerPeers[o],n)}if(i.providerPeers&&i.providerPeers.length){s.providerPeers=[];for(var o=0;o<i.providerPeers.length;++o)s.providerPeers[o]=si.Message.Peer.toObject(i.providerPeers[o],n)}return i.clusterLevelRaw!=null&&i.hasOwnProperty("clusterLevelRaw")&&(s.clusterLevelRaw=i.clusterLevelRaw,n.oneofs&&(s._clusterLevelRaw="clusterLevelRaw")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,bf.util.toJSONOptions)},r.MessageType=function(){var t={},i=Object.create(t);return i[t[0]="PUT_VALUE"]=0,i[t[1]="GET_VALUE"]=1,i[t[2]="ADD_PROVIDER"]=2,i[t[3]="GET_PROVIDERS"]=3,i[t[4]="FIND_NODE"]=4,i[t[5]="PING"]=5,i}(),r.ConnectionType=function(){var t={},i=Object.create(t);return i[t[0]="NOT_CONNECTED"]=0,i[t[1]="CONNECTED"]=1,i[t[2]="CAN_CONNECT"]=2,i[t[3]="CANNOT_CONNECT"]=3,i}(),r.Peer=function(){function t(n){if(this.addrs=[],n)for(var s=Object.keys(n),o=0;o<s.length;++o)n[s[o]]!=null&&(this[s[o]]=n[s[o]])}t.prototype.id=null,t.prototype.addrs=We.emptyArray,t.prototype.connection=null;var i;return Object.defineProperty(t.prototype,"_id",{get:We.oneOfGetter(i=["id"]),set:We.oneOfSetter(i)}),Object.defineProperty(t.prototype,"_connection",{get:We.oneOfGetter(i=["connection"]),set:We.oneOfSetter(i)}),t.encode=function(s,o){if(o||(o=$P.create()),s.id!=null&&Object.hasOwnProperty.call(s,"id")&&o.uint32(10).bytes(s.id),s.addrs!=null&&s.addrs.length)for(var a=0;a<s.addrs.length;++a)o.uint32(18).bytes(s.addrs[a]);return s.connection!=null&&Object.hasOwnProperty.call(s,"connection")&&o.uint32(24).int32(s.connection),o},t.decode=function(s,o){s instanceof q1||(s=q1.create(s));for(var a=o===void 0?s.len:s.pos+o,c=new si.Message.Peer;s.pos<a;){var u=s.uint32();switch(u>>>3){case 1:c.id=s.bytes();break;case 2:c.addrs&&c.addrs.length||(c.addrs=[]),c.addrs.push(s.bytes());break;case 3:c.connection=s.int32();break;default:s.skipType(u&7);break}}return c},t.fromObject=function(s){if(s instanceof si.Message.Peer)return s;var o=new si.Message.Peer;if(s.id!=null&&(typeof s.id=="string"?We.base64.decode(s.id,o.id=We.newBuffer(We.base64.length(s.id)),0):s.id.length&&(o.id=s.id)),s.addrs){if(!Array.isArray(s.addrs))throw TypeError(".Message.Peer.addrs: array expected");o.addrs=[];for(var a=0;a<s.addrs.length;++a)typeof s.addrs[a]=="string"?We.base64.decode(s.addrs[a],o.addrs[a]=We.newBuffer(We.base64.length(s.addrs[a])),0):s.addrs[a].length&&(o.addrs[a]=s.addrs[a])}switch(s.connection){case"NOT_CONNECTED":case 0:o.connection=0;break;case"CONNECTED":case 1:o.connection=1;break;case"CAN_CONNECT":case 2:o.connection=2;break;case"CANNOT_CONNECT":case 3:o.connection=3;break}return o},t.toObject=function(s,o){o||(o={});var a={};if((o.arrays||o.defaults)&&(a.addrs=[]),s.id!=null&&s.hasOwnProperty("id")&&(a.id=o.bytes===String?We.base64.encode(s.id,0,s.id.length):o.bytes===Array?Array.prototype.slice.call(s.id):s.id,o.oneofs&&(a._id="id")),s.addrs&&s.addrs.length){a.addrs=[];for(var c=0;c<s.addrs.length;++c)a.addrs[c]=o.bytes===String?We.base64.encode(s.addrs[c],0,s.addrs[c].length):o.bytes===Array?Array.prototype.slice.call(s.addrs[c]):s.addrs[c]}return s.connection!=null&&s.hasOwnProperty("connection")&&(a.connection=o.enums===String?si.Message.ConnectionType[s.connection]:s.connection,o.oneofs&&(a._connection="connection")),a},t.prototype.toJSON=function(){return this.constructor.toObject(this,bf.util.toJSONOptions)},t}(),r}();Ehe.exports=si});var ba=m((rDt,Z8)=>{l();"use strict";var rGe=st(),{Multiaddr:iGe}=lt(),{Record:nGe}=Ja(),Q8=GP(),WP=Q8.Message.MessageType,She=Q8.Message.ConnectionType,sGe=Object.keys(WP),U1=class{constructor(e,t,i){if(t&&!(t instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=t,this._clusterLevelRaw=i,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){let e=this._clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this._clusterLevelRaw=e}serialize(){let e={key:this.key,type:this.type,clusterLevelRaw:this._clusterLevelRaw,closerPeers:this.closerPeers.map(Ahe),providerPeers:this.providerPeers.map(Ahe),record:void 0};return this.record&&(this.record instanceof Uint8Array?e.record=this.record:e.record=this.record.serialize()),Q8.Message.encode(e).finish()}static deserialize(e){let t=Q8.Message.decode(e),i=new U1(t.type||0,t.key||Uint8Array.from([]),t.clusterLevelRaw||0);return i.closerPeers=t.closerPeers.map(Rhe),i.providerPeers=t.providerPeers.map(Rhe),t.record&&t.record.length&&(i.record=nGe.deserialize(t.record)),i}};U1.TYPES=WP;U1.CONNECTION_TYPES=She;function Ahe(r){return{id:r.id.id,addrs:(r.multiaddrs||[]).map(t=>t.bytes),connection:She.CONNECTED}}function Rhe(r){return{id:new rGe(r.id),multiaddrs:(r.addrs||[]).map(e=>new iGe(e))}}Z8.exports.Message=U1;Z8.exports.MESSAGE_TYPE=WP;Z8.exports.MESSAGE_TYPE_LOOKUP=sGe});var _h=m((iDt,xhe)=>{l();"use strict";var{MESSAGE_TYPE_LOOKUP:oGe}=ba(),aGe=["PUT_VALUE","GET_VALUE","ADD_PROVIDER","GET_PROVIDERS","FIND_NODE","PING"];function cGe(r){return{...r,name:"SENDING_QUERY",type:0,messageName:oGe[r.type],messageType:r.type}}function uGe(r){return{...r,name:"PEER_RESPONSE",type:1,messageName:aGe[r.messageType],closer:r.closer?r.closer:[],providers:r.providers?r.providers:[]}}function lGe(r){return{...r,name:"FINAL_PEER",type:2}}function fGe(r){return{...r,name:"QUERY_ERROR",type:3}}function dGe(r){return{...r,name:"PROVIDER",type:4}}function hGe(r){return{...r,name:"VALUE",type:5}}function pGe(r){return{...r,name:"ADDING_PEER",type:6}}function yGe(r){return{...r,name:"DIALING_PEER",type:7}}xhe.exports={sendingQueryEvent:cGe,peerResponseEvent:uGe,finalPeerEvent:lGe,queryErrorEvent:fGe,providerEvent:dGe,valueEvent:hGe,addingPeerEvent:pGe,dialingPeerEvent:yGe}});var Bhe=m((nDt,Nhe)=>{l();"use strict";var gGe=Tc(),{pipe:Ihe}=dr(),YP=go(),mGe=rs(),bGe=Td(),{Message:wGe,MESSAGE_TYPE_LOOKUP:The}=ba(),_Ge=Dr(),{EventEmitter:vGe}=Ut(),{dialingPeerEvent:Phe,sendingQueryEvent:Che,peerResponseEvent:Ohe,queryErrorEvent:khe}=_h(),Dhe=class extends vGe{constructor({dialer:e,protocol:t,lan:i}){super();this._log=_Ge.logger(`libp2p:kad-dht:${i?"lan":"wan"}:network`),this._running=!1,this._dialer=e,this._protocol=t}start(){this._running||(this._running=!0)}stop(){this._running=!1}get isStarted(){return this._running}async*sendRequest(e,t,i={}){if(!!this._running){this._log("sending %s to %p",The[t.type],e);try{yield Phe({peer:e});let{stream:n}=await this._dialer.dialProtocol(e,this._protocol,i);yield Che({to:e,type:t.type});let s=await this._writeReadMessage(n,t.serialize(),i);yield Ohe({from:e,messageType:s.type,closer:s.closerPeers,providers:s.providerPeers,record:s.record})}catch(n){yield khe({from:e,error:n})}}}async*sendMessage(e,t,i={}){if(!this._running)return;this._log("sending %s to %p",The[t.type],e),yield Phe({peer:e});let{stream:n}=await this._dialer.dialProtocol(e,this._protocol,i);yield Che({to:e,type:t.type});try{await this._writeMessage(n,t.serialize(),i),yield Ohe({from:e,messageType:t.type})}catch(s){yield khe({from:e,error:s})}}async _writeMessage(e,t,i={}){await Ihe([t],YP.encode(),e,mGe)}async _writeReadMessage(e,t,i={}){let n=await Ihe([t],YP.encode(),e,YP.decode(),async o=>{let a=await bGe(o);if(a)return a.slice()});if(n.length===0)throw gGe(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED");let s=wGe.deserialize(n);return s.closerPeers.forEach(o=>{this.emit("peer",o)}),s.providerPeers.forEach(o=>{this.emit("peer",o)}),s}};Nhe.exports.Network=Dhe});var Uhe=m((sDt,qhe)=>{l();"use strict";var XP=Tc(),{equals:QP}=(hi(),hn),{toString:EGe}=(et(),or),ZP=Ja(),{ALPHA:SGe}=Ic(),wf=Dr(),Km=ZP.Record,AGe=Vb(),RGe=wn(),{valueEvent:Lhe,queryErrorEvent:Mhe}=_h(),{Message:J8}=ba(),{pipe:xGe}=dr(),jhe=class{constructor({peerId:e,records:t,validators:i,selectors:n,peerRouting:s,queryManager:o,routingTable:a,network:c,lan:u}){this._log=wf.logger(`libp2p:kad-dht:${u?"lan":"wan"}:content-fetching`),this._peerId=e,this._records=t,this._validators=i,this._selectors=n,this._peerRouting=s,this._queryManager=o,this._routingTable=a,this._network=c}async putLocal(e,t){return this._records.put(wf.bufferToKey(e),t)}async getLocal(e){this._log(`getLocal ${EGe(e,"base32")}`);let t=wf.bufferToKey(e);this._log(`fetching record for key ${t}`);let i=await this._records.get(t);this._log(`found ${t} in local datastore`);let n=Km.deserialize(i);return await ZP.validator.verifyRecord(this._validators,n),n}async*sendCorrectionRecord(e,t,i,n={}){this._log("sendCorrection for %b",e);let s=await wf.createPutRecord(e,i);for(let{value:o,from:a}of t){if(QP(o,i)){this._log("record was ok");continue}if(this._peerId.equals(a)){try{let f=wf.bufferToKey(e);this._log(`Storing corrected record for key ${f}`),await this._records.put(f,s)}catch(f){this._log.error("Failed error correcting self",f)}continue}let c=!1,u=new J8(J8.TYPES.PUT_VALUE,e,0);u.record=Km.deserialize(s);for await(let f of this._network.sendRequest(a,u,n))f.name==="PEER_RESPONSE"&&f.record&&QP(f.record.value,Km.deserialize(s).value)&&(c=!0),yield f;c||(yield Mhe({from:a,error:XP(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})),this._log.error("Failed error correcting entry")}}async*put(e,t,i={}){this._log("put key %b value %b",e,t);let n=await wf.createPutRecord(e,t),s=wf.bufferToKey(e);this._log(`storing record for key ${s}`),await this._records.put(s,n),yield*xGe(this._peerRouting.getClosestPeers(e,{signal:i.signal}),o=>RGe(o,a=>async()=>{if(a.name!=="FINAL_PEER")return[a];let c=[],u=new J8(J8.TYPES.PUT_VALUE,e,0);u.record=Km.deserialize(n);for await(let f of this._network.sendRequest(a.peer.id,u,i))c.push(f),f.name==="PEER_RESPONSE"&&(f.record&&QP(f.record.value,Km.deserialize(n).value)||c.push(Mhe({from:a.peer.id,error:XP(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})));return c}),o=>AGe(o,{ordered:!1,concurrency:SGe}),async function*(o){for await(let a of o)yield*a})}async*get(e,t={}){this._log("get %b",e);let i=[];for await(let a of this.getMany(e,t))a.name==="VALUE"&&i.push(a),yield a;if(!i.length)return;let n=i.map(a=>a.value),s=0;try{s=ZP.selection.bestRecord(this._selectors,e,n)}catch(a){if(a.code!=="ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")throw a}let o=n[s];if(this._log("GetValue %b %b",e,o),!o)throw XP(new Error("best value was not found"),"ERR_NOT_FOUND");yield*this.sendCorrectionRecord(e,i,o,t),yield i[s]}async*getMany(e,t={}){this._log("getMany values for %t",e);try{let a=await this.getLocal(e);yield Lhe({value:a.value,from:this._peerId})}catch(a){this._log("error getting local value for %b",e,a)}let i=await wf.convertBuffer(e),n=this._routingTable.closestPeers(i);this._log("found %d peers in routing table",n.length);let s=this,o=async function*({peer:a,signal:c}){for await(let u of s._peerRouting.getValueOrPeers(a,e,{signal:c}))yield u,u.name==="PEER_RESPONSE"&&u.record&&(yield Lhe({from:a,value:u.record.value}))};yield*this._queryManager.run(e,n,o,t)}};qhe.exports.ContentFetching=jhe});var zhe=m((oDt,Vhe)=>{l();"use strict";var{Message:e_}=ba(),IGe=Vb(),TGe=wn(),{convertBuffer:PGe,logger:CGe}=Dr(),{ALPHA:OGe}=Ic(),{pipe:kGe}=dr(),{queryErrorEvent:DGe,peerResponseEvent:NGe,providerEvent:Fhe}=_h(),{Message:{MessageType:BGe}}=GP(),Khe=class{constructor({peerId:e,network:t,peerRouting:i,queryManager:n,routingTable:s,providers:o,peerStore:a,lan:c}){this._log=CGe(`libp2p:kad-dht:${c?"lan":"wan"}:content-routing`),this._peerId=e,this._network=t,this._peerRouting=i,this._queryManager=n,this._routingTable=s,this._providers=o,this._peerStore=a}async*provide(e,t,i={}){this._log("provide %s",e),await this._providers.addProvider(e,this._peerId);let n=new e_(e_.TYPES.ADD_PROVIDER,e.bytes,0);n.providerPeers=[{id:this._peerId,multiaddrs:t}];let s=0,o=a=>async()=>{if(a.name!=="FINAL_PEER")return[a];let c=[];this._log("putProvider %s to %p",e,a.peer.id);try{this._log("sending provider record for %s to %p",e,a.peer.id);for await(let u of this._network.sendMessage(a.peer.id,n,i))u.name==="PEER_RESPONSE"&&(this._log("sent provider record for %s to %p",e,a.peer.id),s++),c.push(u)}catch(u){this._log.error("error sending provide record to peer %p",a.peer.id,u),c.push(DGe({from:a.peer.id,error:u}))}return c};yield*kGe(this._peerRouting.getClosestPeers(e.multihash.bytes,i),a=>TGe(a,c=>o(c)),a=>IGe(a,{ordered:!1,concurrency:OGe}),async function*(a){for await(let c of a)yield*c}),this._log("sent provider records to %d peers",s)}async*findProviders(e,t={maxNumProviders:5}){let i=t.maxNumProviders||this._routingTable._kBucketSize,n=e.multihash.bytes,s=await PGe(n),o=this;this._log(`findProviders ${e}`);let a=await this._providers.getProviders(e);if(a.length){let f=[];for(let d of a.slice(0,i))f.push({id:d,multiaddrs:(await this._peerStore.addressBook.get(d)||[]).map(h=>h.multiaddr)});yield NGe({from:this._peerId,messageType:BGe.GET_PROVIDERS,providers:f}),yield Fhe({from:this._peerId,providers:f})}if(a.length>=i)return;let c=async function*({peer:f,signal:d}){let h=new e_(e_.TYPES.GET_PROVIDERS,n,0);yield*o._network.sendRequest(f,h,{signal:d})},u=new Set(a.map(f=>f.toB58String()));for await(let f of this._queryManager.run(n,this._routingTable.closestPeers(s),c,t))if(yield f,f.name==="PEER_RESPONSE"){this._log(`Found ${f.providers.length} provider entries for ${e} and ${f.closer.length} closer peers`);let d=[];for(let h of f.providers)u.has(h.id.toB58String())||(u.add(h.id.toB58String()),d.push(h));if(d.length&&(yield Fhe({from:f.from,providers:d})),u.size===i)return}}};Vhe.exports.ContentRouting=Khe});var $he=m((aDt,Hhe)=>{l();"use strict";Hhe.exports=(r,e=1,t)=>{if(t={indent:" ",includeEmptyLines:!1,...t},typeof r!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof r}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(typeof t.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof t.indent}\``);if(e===0)return r;let i=t.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return r.replace(i,t.indent.repeat(e))}});var Ghe=m(()=>{l()});var Qhe=m((lDt,Xhe)=>{l();"use strict";var Whe=Ghe(),Yhe=/\s+at.*(?:\(|\s)(.*)\)?/,LGe=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,MGe=typeof Whe.homedir=="undefined"?"":Whe.homedir();Xhe.exports=(r,e)=>(e=Object.assign({pretty:!1},e),r.replace(/\\/g,"/").split(`
`).filter(t=>{let i=t.match(Yhe);if(i===null||!i[1])return!0;let n=i[1];return n.includes(".app/Contents/Resources/electron.asar")||n.includes(".app/Contents/Resources/default_app.asar")?!1:!LGe.test(n)}).filter(t=>t.trim()!=="").map(t=>e.pretty?t.replace(Yhe,(i,n)=>i.replace(n,n.replace(MGe,"~"))):t).join(`
`))});var JP=m((fDt,Jhe)=>{l();"use strict";var jGe=$he(),qGe=Qhe(),UGe=r=>r.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),Zhe=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);e=[...e].map(i=>i instanceof Error?i:i!==null&&typeof i=="object"?Object.assign(new Error(i.message),i):new Error(i));let t=e.map(i=>typeof i.stack=="string"?UGe(qGe(i.stack)):String(i)).join(`
`);t=`
`+jGe(t,4);super(t);this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(let e of this._errors)yield e}};Jhe.exports=Zhe});var tpe=m((dDt,epe)=>{l();"use strict";var FGe=JP();epe.exports=async(r,e,{concurrency:t=1/0,stopOnError:i=!0}={})=>new Promise((n,s)=>{if(typeof e!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(t)||t===1/0)&&t>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${t}\` (${typeof t})`);let o=[],a=[],c=r[Symbol.iterator](),u=!1,f=!1,d=0,h=0,p=()=>{if(u)return;let y=c.next(),g=h;if(h++,y.done){f=!0,d===0&&(!i&&a.length!==0?s(new FGe(a)):n(o));return}d++,(async()=>{try{let w=await y.value;o[g]=await e(w,g),d--,p()}catch(w){i?(u=!0,s(w)):(a.push(w),d--,p())}})()};for(let y=0;y<t&&(p(),!f);y++);})});var ape=m((hDt,ope)=>{l();"use strict";var rpe=Dr(),KGe=tpe(),{compare:ipe}=(t5(),VQ),{xor:npe}=(km(),L8),spe=class{constructor(e,t){this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(e=>e.peerId)}async add(e){if(this.peerDistances.find(n=>n.peerId.equals(e)))return;let t=await rpe.convertPeerId(e),i={peerId:e,distance:npe(this.originDhtKey,t)};this.peerDistances.push(i),this.peerDistances.sort((n,s)=>ipe(n.distance,s.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(!e.length)return!1;if(!this.length)return!0;let t=await KGe(e,n=>rpe.convertPeerId(n)),i=this.peerDistances[this.peerDistances.length-1].distance;for(let n of t){let s=npe(this.originDhtKey,n);if(ipe(s,i)<0)return!0}return!1}};ope.exports=spe});var fpe=m((pDt,lpe)=>{l();"use strict";var t_=Tc(),{validator:VGe}=Ja(),zGe=st(),{toString:HGe}=(et(),or),{Message:F1}=ba(),Vm=Dr(),{queryErrorEvent:cpe,finalPeerEvent:r_,valueEvent:$Ge}=_h(),GGe=ape(),{Record:WGe}=Ja(),upe=class{constructor({peerId:e,routingTable:t,peerStore:i,network:n,validators:s,queryManager:o,lan:a}){this._peerId=e,this._routingTable=t,this._peerStore=i,this._network=n,this._validators=s,this._queryManager=o,this._log=Vm.logger(`libp2p:kad-dht:${a?"lan":"wan"}:peer-routing`)}async findPeerLocal(e){let t,i=await this._routingTable.find(e);if(i){this._log("findPeerLocal found %p in routing table",e);try{t=await this._peerStore.get(i)}catch(n){if(n.code!=="ERR_NOT_FOUND")throw n}}if(!t)try{t=await this._peerStore.get(e)}catch(n){if(n.code!=="ERR_NOT_FOUND")throw n}if(t)return this._log("findPeerLocal found %p in peer store",e),{id:t.id,multiaddrs:t.addresses.map(n=>n.multiaddr)}}async*_getValueSingle(e,t,i={}){let n=new F1(F1.TYPES.GET_VALUE,t,0);yield*this._network.sendRequest(e,n,i)}async*getPublicKeyFromNode(e,t){let i=Vm.keyForPublicKey(e);for await(let n of this._getValueSingle(e,i,t))if(yield n,n.name==="PEER_RESPONSE"&&n.record){let s=await zGe.createFromPubKey(n.record.value);if(!s.equals(e))throw t_(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");yield $Ge({from:e,value:s.pubKey.bytes})}throw t_(new Error(`Node not responding with its public key: ${e.toB58String()}`),"ERR_INVALID_RECORD")}async*findPeer(e,t={}){this._log("findPeer %p",e);let i=await this.findPeerLocal(e);if(i!=null){this._log("found local"),yield r_({from:this._peerId,peer:i});return}let n=await Vm.convertPeerId(e),s=this._routingTable.closestPeers(n);if(s.find(f=>f.equals(e)))try{let f=await this._peerStore.get(e);this._log("found in peerStore"),yield r_({from:this._peerId,peer:{id:f.id,multiaddrs:f.addresses.map(d=>d.multiaddr)}});return}catch(f){if(f.code!=="ERR_NOT_FOUND")throw f}let a=this,c=async function*({peer:f,signal:d}){let h=new F1(F1.TYPES.FIND_NODE,e.toBytes(),0);for await(let p of a._network.sendRequest(f,h,{signal:d}))if(yield p,p.name==="PEER_RESPONSE"){let y=p.closer.find(g=>g.id.equals(e));y&&(yield r_({from:p.from,peer:y}))}},u=!1;for await(let f of this._queryManager.run(e.id,s,c,t))f.name==="FINAL_PEER"&&(u=!0),yield f;u||(yield cpe({from:this._peerId,error:t_(new Error("Not found"),"ERR_NOT_FOUND")}))}async*getClosestPeers(e,t={}){this._log("getClosestPeers to %b",e);let i=await Vm.convertBuffer(e),n=this._routingTable.closestPeers(i),s=this,o=new GGe(i,this._routingTable._kBucketSize);n.forEach(c=>o.add(c));let a=async function*({peer:c,signal:u}){s._log("closerPeersSingle %s from %p",HGe(e,"base32"),c);let f=new F1(F1.TYPES.FIND_NODE,e,0);yield*s._network.sendRequest(c,f,{signal:u})};for await(let c of this._queryManager.run(e,n,a,t))yield c,c.name==="PEER_RESPONSE"&&c.closer.forEach(u=>{o.add(u.id)});this._log("found %d peers close to %b",o.length,e);for(let c of o.peers)yield r_({from:this._peerId,peer:{id:c,multiaddrs:(await this._peerStore.addressBook.get(c)||[]).map(u=>u.multiaddr)}})}async*getValueOrPeers(e,t,i={}){for await(let n of this._getValueSingle(e,t,i)){if(n.name==="PEER_RESPONSE"&&n.record)try{await this._verifyRecordOnline(n.record)}catch(s){let o="invalid record received, discarded";this._log(o),yield cpe({from:n.from,error:t_(new Error(o),"ERR_INVALID_RECORD")});continue}yield n}}async _verifyRecordOnline({key:e,value:t,timeReceived:i}){await VGe.verifyRecord(this._validators,new WGe(e,t,i))}async getCloserPeersOffline(e,t){let i=await Vm.convertBuffer(e),n=this._routingTable.closestPeers(i),s=[];for(let o of n)if(!o.equals(t))try{let a=await this._peerStore.addressBook.get(o);s.push({id:o,multiaddrs:a.map(c=>c.multiaddr)})}catch(a){if(a.code!=="ERR_NOT_FOUND")throw a}return s.length?this._log("getCloserPeersOffline found %d peer(s) closer to %b than %p",s.length,e,t):this._log("getCloserPeersOffline could not find peer closer to %b than %p",e,t),s}};lpe.exports.PeerRouting=upe});var bpe=m((yDt,mpe)=>{l();"use strict";var YGe=xp(),dpe=Xn(),XGe=st(),{Key:QGe}=(Mr(),Ap),{default:ZGe}=Go(),{PROVIDERS_CLEANUP_INTERVAL:JGe,PROVIDERS_VALIDITY:eWe,PROVIDERS_LRU_CACHE_SIZE:tWe,PROVIDER_KEY_PREFIX:hpe}=Ic(),rWe=Dr(),{toString:iWe}=(et(),or),_f=rWe.logger("libp2p:kad-dht:providers"),ppe=class{constructor({providers:e,cacheSize:t,cleanupInterval:i,provideValidity:n}){this.datastore=e,this.cleanupInterval=i||JGe,this.provideValidity=n||eWe,this.cache=YGe(t||tWe),this.syncQueue=new ZGe({concurrency:1})}start(){this._started||(this._started=!0,this._cleaner=setInterval(()=>this._cleanup(),this.cleanupInterval))}stop(){this._started=!1,this._cleaner&&(clearInterval(this._cleaner),this._cleaner=null)}_cleanup(){return this.syncQueue.add(async()=>{let e=Date.now(),t=0,i=0,n=new Map,s=this.datastore.batch(),o=this.datastore.query({prefix:hpe});for await(let a of o)try{let{cid:c,peerId:u}=ype(a.key),f=gpe(a.value),d=Date.now(),h=d-f,p=h>this.provideValidity;if(_f("comparing: %d - %d = %d > %d %s",d,f,h,this.provideValidity,p?"(expired)":""),p){i++,s.delete(a.key);let y=n.get(c)||new Set;y.add(u),n.set(c,y)}t++}catch(c){_f.error(c.message)}n.size?(_f("deleting %d / %d entries",i,t),await s.commit()):_f("nothing to delete");for(let[a,c]of n){let u=zm(a),f=this.cache.get(u);if(f){for(let d of c)f.delete(d);f.size===0?this.cache.remove(u):this.cache.set(u,f)}}_f("Cleanup successful (%dms)",Date.now()-e)})}async _getProvidersMap(e){let t=zm(e),i=this.cache.get(t);return i||(i=await sWe(this.datastore,e),this.cache.set(t,i)),i}async addProvider(e,t){return this.syncQueue.add(async()=>{_f("%p provides %s",t,e);let i=await this._getProvidersMap(e);_f("loaded %s provs",i.size);let n=new Date;i.set(t.toString(),n);let s=zm(e);return this.cache.set(s,i),nWe(this.datastore,e,t,n)})}async getProviders(e){return this.syncQueue.add(async()=>(_f("get providers for %s",e),[...(await this._getProvidersMap(e)).keys()].map(i=>XGe.parse(i))))}};function zm(r){return r=typeof r=="string"?r:iWe(r.multihash.bytes,"base32"),`${hpe}/${r}`}async function nWe(r,e,t,i){let n=[zm(e),"/",t.toString()].join(""),s=new QGe(n),o=Uint8Array.from(dpe.encode(i.getTime()));return r.put(s,o)}function ype(r){let e=r.toString().split("/");if(e.length!==5)throw new Error("incorrectly formatted provider entry key in datastore: "+r);return{cid:e[3],peerId:e[4]}}async function sWe(r,e){let t=new Map,i=r.query({prefix:zm(e)});for await(let n of i){let{peerId:s}=ype(n.key);t.set(s,gpe(n.value))}return t}function gpe(r){return dpe.decode(r)}mpe.exports.Providers=ppe});var Ape=m((gDt,Spe)=>{l();"use strict";var{default:oWe}=Go(),{xor:wpe}=(km(),L8),{toString:_pe}=(et(),or),vpe=ec(),aWe=Tc(),{convertPeerId:Epe,convertBuffer:cWe}=Dr(),{TimeoutController:uWe}=Ma(),{anySignal:lWe}=$o(),{queryErrorEvent:fWe}=_h(),dWe=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");Spe.exports.queryPath=async function*({key:e,startingPeer:t,ourPeerId:i,signal:n,query:s,alpha:o,pathIndex:a,numPaths:c,cleanUp:u,queryFuncTimeout:f,log:d}){let h=new oWe({concurrency:o}),p=await cWe(e),y=new Set;function g(w,b){if(!w)return;y.add(w.toB58String());let v=BigInt("0x"+_pe(wpe(b,p),"base16"));h.add(async()=>{let R,k=[n];f!=null&&(R=new uWe(f),k.push(R.signal));let C=lWe(k);try{for await(let T of s({key:e,peer:w,signal:C,pathIndex:a,numPaths:c})){if(C.aborted)return;if(T.name==="PEER_RESPONSE")for(let D of T.closer){if(y.has(D.id.toB58String())){d("already seen %p in query",D.id);continue}if(i.equals(D.id)){d("not querying ourselves");continue}let j=await Epe(D.id);if(BigInt("0x"+_pe(wpe(j,p),"base16"))>v){d("skipping %p as they are not closer to %b than %p",D.id,e,w);continue}d("querying closer peer %p",D.id),g(D.id,j)}h.emit("completed",T)}R&&R.clear()}catch(T){n.aborted?h.emit("error",T):h.emit("completed",fWe({from:w,error:T}))}finally{R&&R.clear()}},{priority:dWe-v})}g(t,await Epe(t)),yield*hWe(h,n,u,d)};async function*hWe(r,e,t,i){let n=vpe(),s=!0,o=[],a=()=>{!s||(i("clean up queue, results %d, queue size %d, pending tasks %d",o.length,r.size,r.pending),s=!1,r.clear(),o.splice(0,o.length))};for(r.on("completed",c=>{o.push(c),n.resolve()}),r.on("error",c=>{i("queue error",c),a(),n.reject(c)}),r.on("idle",()=>{i("queue idle"),s=!1,n.resolve()}),e.addEventListener("abort",()=>{i("abort queue");let c=s;a(),c&&n.reject(aWe(new Error("Query aborted"),"ERR_QUERY_ABORTED"))}),t.on("cleanup",()=>{a(),n.resolve()});s;)for(await n.promise,n=vpe();o.length;){let c=o.shift();c&&(yield c)}yield*o}});var Ope=m((mDt,Cpe)=>{l();"use strict";var{TimeoutController:pWe}=Ma(),{anySignal:yWe}=$o(),{ALPHA:Rpe,K:xpe,DEFAULT_QUERY_TIMEOUT:gWe}=Ic(),{toString:mWe}=(et(),or),{logger:bWe}=Dr(),{queryPath:wWe}=Ape(),_We=Al(),{EventEmitter:vWe,setMaxListeners:Ipe}=Ut(),Tpe="running-queries",Ppe=class{constructor({peerId:e,lan:t,metrics:i,disjointPaths:n=xpe,alpha:s=Rpe}){this._peerId=e,this._disjointPaths=n||xpe,this._controllers=new Set,this._running=!1,this._alpha=s||Rpe,this._lan=t,this._metrics=i,this._queries=0}start(){this._running=!0}stop(){this._running=!1;for(let e of this._controllers)e.abort();this._controllers.clear()}async*run(e,t,i,n={}){if(!this._running)throw new Error("QueryManager not started");let s;n.signal||(s=new pWe(gWe),n.signal=s.signal);let o=new AbortController;this._controllers.add(o);let a=[o.signal];n.signal&&a.push(n.signal);let c=yWe(a);try{Ipe&&Ipe(0,c)}catch{}let u=bWe(`libp2p:kad-dht:${this._lan?"lan":"wan"}:query:`+mWe(e,"base58btc")),f=t.slice(0,Math.min(this._disjointPaths,t.length)),d=Date.now(),h=new vWe;try{if(u("query:start"),this._queries++,this._metrics&&this._metrics.updateComponentMetric({component:`kad-dht-${this._lan?"lan":"wan"}`,metric:Tpe,value:this._queries}),t.length===0){u.error("Running query with no peers");return}let p=f.map((y,g)=>wWe({key:e,startingPeer:y,ourPeerId:this._peerId,signal:c,query:i,pathIndex:g,numPaths:f.length,alpha:this._alpha,cleanUp:h,queryFuncTimeout:n.queryFuncTimeout,log:u}));for await(let y of _We(...p))yield y,y.name==="QUERY_ERROR"&&y.error&&u("error",y.error)}catch(p){if(!(!this._running&&p.code==="ERR_QUERY_ABORTED"))throw p}finally{this._controllers.delete(o),s&&s.clear(),this._queries--,this._metrics&&this._metrics.updateComponentMetric({component:`kad-dht-${this._lan?"lan":"wan"}`,metric:Tpe,value:this._queries}),h.emit("cleanup"),u(`query:done in ${Date.now()-(d||0)}ms`)}}};Cpe.exports.QueryManager=Ppe});var Bpe=m((bDt,Npe)=>{l();"use strict";var{CID:EWe}=(we(),Kc),kpe=Tc(),SWe=Dr(),Hm=SWe.logger("libp2p:kad-dht:rpc:handlers:add-provider"),Dpe=class{constructor({peerId:e,providers:t,peerStore:i}){this._peerId=e,this._providers=t,this._peerStore=i}async handle(e,t){if(Hm("start"),!t.key||t.key.length===0)throw kpe(new Error("Missing key"),"ERR_MISSING_KEY");let i;try{i=EWe.decode(t.key)}catch(n){let s=`Invalid CID: ${n.message}`;throw kpe(new Error(s),"ERR_INVALID_CID")}(!t.providerPeers||!t.providerPeers.length)&&Hm.error("no providers found in message"),await Promise.all(t.providerPeers.map(async n=>{if(!n.id.equals(e)){Hm("invalid provider peer %p from %p",n.id,e);return}if(n.multiaddrs.length<1){Hm("no valid addresses for provider %p. Ignore",e);return}Hm("received provider %p for %s (addrs %s)",e,i,n.multiaddrs.map(s=>s.toString())),this._peerId.equals(n.id)||(await this._peerStore.addressBook.add(n.id,n.multiaddrs),await this._providers.addProvider(i,n.id))}))}};Npe.exports.AddProviderHandler=Dpe});var qpe=m((wDt,jpe)=>{l();"use strict";var{Message:AWe}=ba(),RWe=Dr(),Lpe=RWe.logger("libp2p:kad-dht:rpc:handlers:find-node"),{removePrivateAddresses:xWe,removePublicAddresses:IWe}=Dr(),Mpe=class{constructor({peerId:e,addressable:t,peerRouting:i,lan:n}){this._peerId=e,this._addressable=t,this._peerRouting=i,this._lan=Boolean(n)}async handle(e,t){Lpe("incoming request from %p for peers closer to %b",e,t.key);let i;this._peerId.equals(t.key)?i=[{id:this._peerId,multiaddrs:this._addressable.multiaddrs}]:i=await this._peerRouting.getCloserPeersOffline(t.key,e),i=i.map(this._lan?IWe:xWe).filter(({multiaddrs:s})=>s.length);let n=new AWe(t.type,new Uint8Array(0),t.clusterLevel);return i.length>0?n.closerPeers=i:Lpe("could not find any peers closer to %p",e),n}};jpe.exports.FindNodeHandler=Mpe});var Vpe=m((_Dt,Kpe)=>{l();"use strict";var{CID:TWe}=(we(),Kc),PWe=Tc(),{Message:CWe}=ba(),OWe=Dr(),Upe=OWe.logger("libp2p:kad-dht:rpc:handlers:get-providers"),{removePrivateAddresses:kWe,removePublicAddresses:DWe}=Dr(),Fpe=class{constructor({peerId:e,peerRouting:t,providers:i,peerStore:n,addressable:s,lan:o}){this._peerId=e,this._peerRouting=t,this._providers=i,this._peerStore=n,this._addressable=s,this._lan=Boolean(o)}async handle(e,t){let i;try{i=TWe.decode(t.key)}catch(u){throw PWe(new Error(`Invalid CID: ${u.message}`),"ERR_INVALID_CID")}Upe("%p asking for providers for %s",e,i);let[n,s]=await Promise.all([this._providers.getProviders(i),this._peerRouting.getCloserPeersOffline(t.key,e)]),o=await this._getPeers(n),a=await this._getPeers(s.map(({id:u})=>u)),c=new CWe(t.type,t.key,t.clusterLevel);return o.length>0&&(c.providerPeers=o),a.length>0&&(c.closerPeers=a),Upe("got %s providers %s closerPeers",o.length,a.length),c}async _getAddresses(e){return this._peerId.equals(e)?this._addressable.multiaddrs:(await this._peerStore.addressBook.get(e)||[]).map(t=>t.multiaddr)}async _getPeers(e){let t=[],i=this._lan?DWe:kWe;for(let n of e){let s=i({id:n,multiaddrs:await this._getAddresses(n)});s.multiaddrs.length&&t.push(s)}return t}};Kpe.exports.GetProvidersHandler=Fpe});var Ype=m((vDt,Wpe)=>{l();"use strict";var{Record:zpe}=Ja(),Hpe=Tc(),{Message:$pe}=ba(),{MAX_RECORD_AGE:NWe}=Ic(),i_=Dr(),K1=i_.logger("libp2p:kad-dht:rpc:handlers:get-value"),Gpe=class{constructor({peerId:e,peerStore:t,peerRouting:i,records:n}){this._peerId=e,this._peerStore=t,this._peerRouting=i,this._records=n}async handle(e,t){let i=t.key;if(K1("%p asked for key %b",e,i),!i||i.length===0)throw Hpe(new Error("Invalid key"),"ERR_INVALID_KEY");let n=new $pe($pe.TYPES.GET_VALUE,i,t.clusterLevel);if(i_.isPublicKeyKey(i)){K1("is public key");let a=i_.fromPublicKeyKey(i),c;if(this._peerId.equals(a))c=this._peerId.pubKey;else try{c=await this._peerStore.keyBook.get(a)}catch(u){if(u.code!=="ERR_NOT_FOUND")throw u}if(c!=null)return K1("returning found public key"),n.record=new zpe(i,c.bytes),n}let[s,o]=await Promise.all([this._checkLocalDatastore(i),this._peerRouting.getCloserPeersOffline(t.key,e)]);return s&&(K1("had record for %b in local datastore",i),n.record=s),o.length>0&&(K1("had %s closer peers in routing table",o.length),n.closerPeers=o),n}async _checkLocalDatastore(e){K1("checkLocalDatastore looking for %b",e);let t=i_.bufferToKey(e),i;try{i=await this._records.get(t)}catch(s){if(s.code==="ERR_NOT_FOUND")return;throw s}let n=zpe.deserialize(i);if(!n)throw Hpe(new Error("Invalid record"),"ERR_INVALID_RECORD");if(n.timeReceived==null||Date.now()-n.timeReceived.getTime()>NWe){await this._records.delete(t);return}return n}};Wpe.exports.GetValueHandler=Gpe});var Zpe=m((EDt,Qpe)=>{l();"use strict";var BWe=Dr(),LWe=BWe.logger("libp2p:kad-dht:rpc:handlers:ping"),Xpe=class{async handle(e,t){return LWe(`ping from ${e}`),t}};Qpe.exports.PingHandler=Xpe});var i0e=m((SDt,r0e)=>{l();"use strict";var Jpe=Dr(),MWe=Tc(),jWe=Ja(),e0e=Jpe.logger("libp2p:kad-dht:rpc:handlers:put-value"),t0e=class{constructor({validators:e,records:t}){this._validators=e,this._records=t}async handle(e,t){let i=t.key;e0e("%p asked to store value for key %b",e,i);let n=t.record;if(!n){let o=`Empty record from: ${e.toB58String()}`;throw e0e.error(o),MWe(new Error(o),"ERR_EMPTY_RECORD")}await jWe.validator.verifyRecord(this._validators,n),n.timeReceived=new Date;let s=Jpe.bufferToKey(n.key);return await this._records.put(s,n.serialize()),t}};r0e.exports.PutValueHandler=t0e});var s0e=m((ADt,n0e)=>{l();"use strict";var{Message:V1}=ba(),{AddProviderHandler:qWe}=Bpe(),{FindNodeHandler:UWe}=qpe(),{GetProvidersHandler:FWe}=Vpe(),{GetValueHandler:KWe}=Ype(),{PingHandler:VWe}=Zpe(),{PutValueHandler:zWe}=i0e();n0e.exports=({peerId:r,providers:e,peerStore:t,addressable:i,peerRouting:n,records:s,validators:o,lan:a})=>{let c={[V1.TYPES.GET_VALUE]:new KWe({peerId:r,peerStore:t,peerRouting:n,records:s}),[V1.TYPES.PUT_VALUE]:new zWe({validators:o,records:s}),[V1.TYPES.FIND_NODE]:new UWe({peerId:r,addressable:i,peerRouting:n,lan:a}),[V1.TYPES.ADD_PROVIDER]:new qWe({peerId:r,providers:e,peerStore:t}),[V1.TYPES.GET_PROVIDERS]:new FWe({peerId:r,peerRouting:n,providers:e,peerStore:t,addressable:i,lan:a}),[V1.TYPES.PING]:new VWe};function u(f){return c[f]}return u}});var u0e=m((RDt,c0e)=>{l();"use strict";var{pipe:HWe}=dr(),o0e=go(),{Message:$We,MESSAGE_TYPE_LOOKUP:GWe}=ba(),WWe=s0e(),YWe=Dr(),n_=YWe.logger("libp2p:kad-dht:rpc"),a0e=class{constructor(e){this._messageHandler=WWe(e),this._routingTable=e.routingTable}async handleMessage(e,t){let i=this._messageHandler(t.type);try{await this._routingTable.add(e)}catch(n){n_.error("Failed to update the kbucket store",n)}if(!i){n_.error(`no handler found for message type: ${t.type}`);return}return i.handle(e,t)}async onIncomingStream({stream:e,connection:t}){let i=t.remotePeer;try{await this._routingTable.add(i)}catch(s){n_.error(s)}let n=this;await HWe(e.source,o0e.decode(),s=>async function*(){for await(let o of s){let a=$We.deserialize(o.slice());n_("incoming %s from %p",GWe[a.type],i);let c=await n.handleMessage(i,a);c&&(yield c.serialize())}}(),o0e.encode(),e.sink)}};c0e.exports.RPC=a0e});var d0e=m((xDt,f0e)=>{l();"use strict";var XWe=dw(),{EventEmitter:QWe}=Ut(),ZWe=Dr(),l0e=class extends QWe{constructor({registrar:e,protocol:t,lan:i}){super();this._log=ZWe.logger(`libp2p:kad-dht:topology-listener:${i?"lan":"wan"}:network`),this._running=!1,this._registrar=e,this._protocol=t}async start(){if(this._running)return;this._running=!0;let e=new XWe({multicodecs:[this._protocol],handlers:{onConnect:t=>{this._log("observed peer that with protocol %s %p",this._protocol,t),this.emit("peer",t)},onDisconnect:()=>{}}});this._registrarId=await this._registrar.register(e)}stop(){this._running=!1,this._registrarId&&this._registrar.unregister(this._registrarId)}};f0e.exports.TopologyListener=l0e});var w0e=m((IDt,b0e)=>{l();"use strict";var{EventEmitter:JWe}=Ut(),eYe=fd(),tYe=Sg(),{QUERY_SELF_INTERVAL:h0e,QUERY_SELF_TIMEOUT:p0e,K:y0e}=Ic(),rYe=Dr(),{TimeoutController:iYe}=Ma(),{anySignal:nYe}=$o(),{setMaxListeners:g0e}=Ut(),m0e=class extends JWe{constructor({peerId:e,peerRouting:t,lan:i,count:n=y0e,interval:s=h0e,queryTimeout:o=p0e}){super();this._log=rYe.logger(`libp2p:kad-dht:${i?"lan":"wan"}:query-self`),this._running=!1,this._peerId=e,this._peerRouting=t,this._count=n||y0e,this._interval=s||h0e,this._queryTimeout=o||p0e}start(){this._running||(this._running=!0,this._querySelf())}stop(){this._running=!1,this._timeoutId&&clearTimeout(this._timeoutId),this._controller&&this._controller.abort()}async _querySelf(){let e=new iYe(this._queryTimeout);try{this._controller=new AbortController;let t=nYe([this._controller.signal,e.signal]);try{g0e&&g0e(1/0,t)}catch{}let i=await tYe(await eYe(this._peerRouting.getClosestPeers(this._peerId.toBytes(),{signal:t}),this._count));this._log("query ran successfully - found %d peers",i)}catch(t){this._log("query error",t)}finally{this._timeoutId=setTimeout(this._querySelf.bind(this),this._interval),e.clear()}}};b0e.exports.QuerySelf=m0e});var I0e=m((TDt,x0e)=>{l();"use strict";var{EventEmitter:sYe}=Ut(),_0e=Qa(),v0e=Ja(),{MemoryDatastore:oYe}=(Ib(),$9),{RoutingTable:aYe}=yhe(),{RoutingTableRefresh:cYe}=whe(),E0e=Dr(),{K:uYe,QUERY_SELF_INTERVAL:lYe,RECORD_KEY_PREFIX:fYe}=Ic(),{Network:dYe}=Bhe(),{ContentFetching:hYe}=Uhe(),{ContentRouting:pYe}=zhe(),{PeerRouting:yYe}=fpe(),{Providers:gYe}=bpe(),{QueryManager:mYe}=Ope(),{RPC:bYe}=u0e(),{TopologyListener:wYe}=d0e(),{QuerySelf:_Ye}=w0e(),{removePrivateAddresses:vYe,removePublicAddresses:EYe}=Dr(),{KeyTransformDatastore:SYe}=(Ob(),YK),{Key:S0e}=(Mr(),Ap),A0e=class{constructor(e){this._prefix=e,this._prefix.startsWith("/")&&(this._prefix=this._prefix.substring(1))}convert(e){return new S0e(`/${this._prefix}${e}`)}invert(e){let t=e.namespaces();return t[0]===this._prefix&&t.shift(),S0e.withNamespaces(t)}},R0e=class extends sYe{constructor({libp2p:e,kBucketSize:t=uYe,clientMode:i=!0,validators:n={},selectors:s={},querySelfInterval:o=lYe,lan:a=!0,protocol:c="/ipfs/lan/kad/1.0.0",bootstrapPeers:u=[]}){super();this._running=!1,this._log=E0e.logger(`libp2p:kad-dht:${a?"lan":"wan"}`),this._libp2p=e,this._protocol=c,this._kBucketSize=t,this._clientMode=i,this._bootstrapPeers=u,this._routingTable=new aYe({peerId:e.peerId,dialer:e,kBucketSize:t,metrics:e.metrics,lan:a});let f=e.datastore||new oYe,d=new SYe(f,new A0e(fYe));this._providers=new gYe({providers:f}),this._lan=a,this._validators={pk:v0e.validator.validators.pk,...n},this._selectors={pk:v0e.selection.selectors.pk,...s},this._network=new dYe({dialer:e,protocol:this._protocol,lan:a}),this._queryManager=new mYe({peerId:e.peerId,disjointPaths:Math.ceil(t/2),metrics:e.metrics,lan:a}),this._peerRouting=new yYe({peerId:e.peerId,routingTable:this._routingTable,peerStore:e.peerStore,network:this._network,validators:this._validators,queryManager:this._queryManager,lan:a}),this._contentFetching=new hYe({peerId:e.peerId,records:d,validators:this._validators,selectors:this._selectors,peerRouting:this._peerRouting,queryManager:this._queryManager,routingTable:this._routingTable,network:this._network,lan:a}),this._contentRouting=new pYe({peerId:e.peerId,network:this._network,peerRouting:this._peerRouting,queryManager:this._queryManager,routingTable:this._routingTable,providers:this._providers,peerStore:e.peerStore,lan:a}),this._routingTableRefresh=new cYe({peerRouting:this._peerRouting,routingTable:this._routingTable,lan:a}),this._rpc=new bYe({routingTable:this._routingTable,peerId:e.peerId,providers:this._providers,peerStore:e.peerStore,addressable:e,peerRouting:this._peerRouting,records:d,validators:this._validators,lan:a}),this._topologyListener=new wYe({registrar:e.registrar,protocol:this._protocol,lan:a}),this._querySelf=new _Ye({peerId:e.peerId,peerRouting:this._peerRouting,interval:o,lan:a}),this._network.on("peer",h=>{this.onPeerConnect(h).catch(p=>{this._log.error(`could not add ${h.id} to routing table`,p)}),this.emit("peer",h)}),this._topologyListener.on("peer",async h=>{let p=await this._libp2p.peerStore.addressBook.get(h),y={id:h,multiaddrs:p.map(g=>g.multiaddr)};this.onPeerConnect(y).catch(g=>{this._log.error(`could not add ${y.id} to routing table`,g)})})}async onPeerConnect(e){if(this._log("peer %p connected",e.id),this._lan?e=EYe(e):e=vYe(e),!e.multiaddrs.length){this._log("ignoring %p as they do not have any %s addresses in %s",e.id,this._lan?"private":"public",e.multiaddrs.map(t=>t.toString()));return}try{await this._routingTable.add(e.id)}catch(t){this._log.error("could not add %p to routing table",e.id,t)}}isStarted(){return this._running}isServer(){return!this._clientMode}async enableServerMode(){this._log("enabling server mode"),this._clientMode=!1,await this._libp2p.handle(this._protocol,this._rpc.onIncomingStream.bind(this._rpc))}async enableClientMode(){this._log("enabling client mode"),this._clientMode=!0,await this._libp2p.unhandle(this._protocol)}async start(){this._running=!0,this._clientMode?await this.enableClientMode():await this.enableServerMode(),await Promise.all([this._providers.start(),this._queryManager.start(),this._network.start(),this._routingTable.start(),this._topologyListener.start(),this._querySelf.start()]),await Promise.all(this._bootstrapPeers.map(e=>this._routingTable.add(e.id))),await this._routingTableRefresh.start(),await this.refreshRoutingTable()}async stop(){this._running=!1,await Promise.all([this._providers.stop(),this._queryManager.stop(),this._network.stop(),this._routingTable.stop(),this._routingTableRefresh.stop(),this._topologyListener.stop(),this._querySelf.stop()])}async*put(e,t,i={}){yield*this._contentFetching.put(e,t,i)}async*get(e,t={}){yield*this._contentFetching.get(e,t)}async*provide(e,t={}){yield*this._contentRouting.provide(e,this._libp2p.multiaddrs,t)}async*findProviders(e,t={maxNumProviders:5}){yield*this._contentRouting.findProviders(e,t)}async*findPeer(e,t={}){yield*this._peerRouting.findPeer(e,t)}async*getClosestPeers(e,t={}){yield*this._peerRouting.getClosestPeers(e,t)}async getPublicKey(e,t={}){this._log("getPublicKey %p",e);for await(let n of this._peerRouting.getPublicKeyFromNode(e,t))if(n.name==="VALUE")return _0e.keys.unmarshalPublicKey(n.value);let i=E0e.keyForPublicKey(e);for await(let n of this.get(i,t))if(n.name==="VALUE")return _0e.keys.unmarshalPublicKey(n.value)}async refreshRoutingTable(){await this._routingTableRefresh.refreshTable(!0)}};x0e.exports={KadDHT:R0e}});var C0e=m((PDt,P0e)=>{l();"use strict";var{EventEmitter:AYe}=Ut(),RYe=st(),xYe=Dr(),vf=Tc(),z1=Al(),{queryErrorEvent:IYe}=_h(),$m=xYe.logger("libp2p:kad-dht"),T0e=class extends AYe{constructor(e,t,i){super();this._wan=e,this._lan=t,this._libp2p=i,this._wan.on("peer",n=>{this.emit("peer",n)}),this._lan.on("peer",n=>{this.emit("peer",n)})}isStarted(){return this._wan.isStarted()&&this._lan.isStarted()}async enableServerMode(){await this._wan.enableServerMode()}async enableClientMode(){await this._wan.enableClientMode()}async start(){await Promise.all([this._lan.start(),this._wan.start()])}async stop(){await Promise.all([this._lan.stop(),this._wan.stop()])}async*put(e,t,i={}){let n=0,s=0;for await(let a of z1(this._lan.put(e,t,i),this._wan.put(e,t,i)))yield a,a.name==="SENDING_QUERY"&&a.messageName==="PUT_VALUE"&&n++,a.name==="PEER_RESPONSE"&&a.messageName==="PUT_VALUE"&&s++;let o=i.minPeers==null?n||1:i.minPeers;if(s<o){let a=vf(new Error(`Failed to put value to enough peers: ${s}/${o}`),"ERR_NOT_ENOUGH_PUT_PEERS");throw $m.error(a),a}}async*get(e,t={}){let i=!1,n=!1;for await(let s of z1(this._lan.get(e,t),this._wan.get(e,t)))yield s,s.name==="DIALING_PEER"&&(i=!0),s.name==="VALUE"&&(i=!0,s.value!=null&&(n=!0)),s.name==="SENDING_QUERY"&&(i=!0);if(!i)throw vf(new Error("No peers found in routing table!"),"ERR_NO_PEERS_IN_ROUTING_TABLE");n||(yield IYe({from:this._libp2p.peerId,error:vf(new Error("Not found"),"ERR_NOT_FOUND")}))}async*provide(e,t={}){let i=0,n=0,s=[],o=[this._lan];this._wan.isServer()&&o.push(this._wan);for await(let a of z1(...o.map(c=>c.provide(e,t))))yield a,a.name==="SENDING_QUERY"&&i++,a.name==="QUERY_ERROR"&&s.push(a.error),a.name==="PEER_RESPONSE"&&a.messageName==="ADD_PROVIDER"&&($m("sent provider record for %s to %p",e,a.from.id),n++);if(n===0)throw s.length?vf(new Error(`Failed to provide to ${s.length} of ${i} peers`),"ERR_PROVIDES_FAILED",{errors:s}):vf(new Error("Failed to provide - no peers found"),"ERR_PROVIDES_FAILED")}async*findProviders(e,t={maxNumProviders:5}){yield*z1(this._lan.findProviders(e,t),this._wan.findProviders(e,t))}async*findPeer(e,t={}){let i=!1;for await(let n of z1(this._lan.findPeer(e,t),this._wan.findPeer(e,t)))yield n,(n.name==="SENDING_QUERY"||n.name==="FINAL_PEER")&&(i=!0);if(!i)throw vf(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED")}async*getClosestPeers(e,t={}){yield*z1(this._lan.getClosestPeers(e,t),this._wan.getClosestPeers(e,t))}async getPublicKey(e,t={}){$m("getPublicKey %p",e);let i;try{if(i=await this._libp2p.peerStore.get(e),i.pubKey)return $m("getPublicKey: found local copy"),i.pubKey;if(i.id.pubKey)return $m("getPublicKey: found local copy"),i.id.pubKey}catch(c){if(c.code!=="ERR_NOT_FOUND")throw c}let n=await Promise.all([this._lan.getPublicKey(e,t),this._wan.getPublicKey(e,t)]);if(n[0]&&n[1]&&!n[0].equals(n[1]))throw vf(new Error("Inconsistent public key loaded from wan and lan DHTs"),"ERR_FAILED_TO_LOAD_KEY");let s=n[0]||n[1];if(!s)throw vf(new Error("Failed to load public key"),"ERR_FAILED_TO_LOAD_KEY");let o=new RYe(e.id,void 0,s),a=(i&&i.addresses||[]).map(c=>c.multiaddr);return await this._libp2p.peerStore.addressBook.add(o,a),await this._libp2p.peerStore.keyBook.set(o,s),s}async refreshRoutingTable(){await Promise.all([this._lan.refreshRoutingTable(),this._wan.refreshRoutingTable()])}};P0e.exports={DualKadDHT:T0e}});var D0e=m((CDt,k0e)=>{l();"use strict";var{KadDHT:O0e}=I0e(),{DualKadDHT:TYe}=C0e();k0e.exports={create:r=>new TYe(new O0e({...r,protocol:"/ipfs/kad/1.0.0",lan:!1}),new O0e({...r,protocol:"/ipfs/lan/kad/1.0.0",clientMode:!1,lan:!0}),r.libp2p)}});var $0e=m((eC,H0e)=>{l();"use strict";var PYe=st(),{Multiaddr:CYe}=lt(),OYe=Kf(),{EventEmitter:kYe}=Ut(),V0e=le(),s_=Object.assign(V0e("libp2p:bootstrap"),{error:V0e("libp2p:bootstrap:error")}),z0e=class extends kYe{constructor(e={list:[]}){if(!e.list||!e.list.length)throw new Error("Bootstrap requires a list of peer addresses");super();this._list=e.list,this._interval=e.interval||1e4,this._timer=null}start(){this._timer||(this._timer=setInterval(()=>this._discoverBootstrapPeers(),this._interval),s_("Starting bootstrap node discovery"),this._discoverBootstrapPeers())}_discoverBootstrapPeers(){!this._timer||this._list.forEach(e=>{if(!OYe.P2P.matches(e))return s_.error("Invalid multiaddr");let t=new CYe(e),i=t.getPeerId();if(!i){s_.error("Invalid bootstrap multiaddr without peer id");return}let n=PYe.createFromB58String(i);try{this.emit("peer",{id:n,multiaddrs:[t]})}catch(s){s_.error("Invalid bootstrap peer id",s)}})}stop(){this._timer&&clearInterval(this._timer),this._timer=null}};eC=H0e.exports=z0e;eC.tag="bootstrap"});var tC=m((BDt,G0e)=>{l();"use strict";var DYe=br(),NYe=is(),BYe=wn(),LYe=fd();async function*MYe(r,e){yield*BYe(r,async t=>(await e.addressBook.add(t.id,t.multiaddrs),t))}function jYe(r){let e=new Set;return NYe(r,t=>e.has(t.id.toString())?!1:(e.add(t.id.toString()),!0))}async function*qYe(r,e=1){let t=0;for await(let i of r)t++,yield i;if(t<e)throw DYe(new Error("not found"),"NOT_FOUND")}function UYe(r,e){return e?LYe(r,e):r}G0e.exports={storeAddresses:MYe,uniquePeers:jYe,requirePeers:qYe,maybeLimitSource:UYe}});var rC=m((LDt,W0e)=>{l();"use strict";var H1=new Map,FYe=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function KYe(r,e,t){for(;H1.get(t);){try{await r()}catch(i){setTimeout(()=>{throw i},1);break}if(!H1.get(t))break;await new Promise(i=>{let n=setTimeout(i,e);H1.set(t,n)})}}function VYe(r,e,t){t=t||e;let i=FYe(),n=setTimeout(()=>{KYe(r,e,i)},t);return H1.set(i,n),i}function zYe(r){let e=H1.get(r);e&&(clearTimeout(e),H1.delete(r))}W0e.exports={setDelayedInterval:VYe,clearDelayedInterval:zYe}});var Q0e=m((MDt,X0e)=>{l();"use strict";var HYe=br(),{messages:$Ye,codes:GYe}=wr(),Y0e=class{constructor(e){this._dht=e}async findPeer(e,t={}){for await(let i of this._dht.findPeer(e,t))if(i.name==="FINAL_PEER")return i.peer;throw HYe(new Error($Ye.NOT_FOUND),GYe.ERR_NOT_FOUND)}async*getClosestPeers(e,t={}){for await(let i of this._dht.getClosestPeers(e,t))i.name==="PEER_RESPONSE"&&(yield*i.closer)}};X0e.exports={DHTPeerRouting:Y0e}});var o1e=m((jDt,s1e)=>{l();"use strict";var Z0e=le(),J0e=Object.assign(Z0e("libp2p:peer-routing"),{error:Z0e("libp2p:peer-routing:err")}),o_=br(),Gm=wr(),{storeAddresses:e1e,uniquePeers:WYe,requirePeers:YYe}=tC(),{TimeoutController:XYe}=Ma(),t1e=Al(),{pipe:r1e}=dr(),QYe=Td(),ZYe=rs(),JYe=is(),{setDelayedInterval:eXe,clearDelayedInterval:tXe}=rC(),{DHTPeerRouting:rXe}=Q0e(),{setMaxListeners:i1e}=Ut(),n1e=class{constructor(e){this._peerId=e.peerId,this._peerStore=e.peerStore,this._routers=e._modules.peerRouting||[],e._dht&&e._config.dht.enabled&&this._routers.push(new rXe(e._dht)),this._refreshManagerOptions=e._options.peerRouting.refreshManager,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}start(){!this._routers.length||this._timeoutId||!this._refreshManagerOptions.enabled||(this._timeoutId=eXe(this._findClosestPeersTask,this._refreshManagerOptions.interval,this._refreshManagerOptions.bootDelay))}async _findClosestPeersTask(){try{await ZYe(this.getClosestPeers(this._peerId.id,{timeout:this._refreshManagerOptions.timeout||1e4}))}catch(e){J0e.error(e)}}stop(){tXe(this._timeoutId)}async findPeer(e,t){if(!this._routers.length)throw o_(new Error("No peer routers available"),Gm.codes.ERR_NO_ROUTERS_AVAILABLE);if(e.toB58String()===this._peerId.toB58String())throw o_(new Error("Should not try to find self"),Gm.codes.ERR_FIND_SELF);let i=await r1e(t1e(...this._routers.map(n=>async function*(){try{yield await n.findPeer(e,t)}catch(s){J0e.error(s)}}())),n=>JYe(n,Boolean),n=>e1e(n,this._peerStore),n=>QYe(n));if(i)return i;throw o_(new Error(Gm.messages.NOT_FOUND),Gm.codes.ERR_NOT_FOUND)}async*getClosestPeers(e,t={timeout:3e4}){if(!this._routers.length)throw o_(new Error("No peer routers available"),Gm.codes.ERR_NO_ROUTERS_AVAILABLE);if(t.timeout){let i=new XYe(t.timeout);try{i1e&&i1e(1/0,i.signal)}catch{}t.signal=i.signal}yield*r1e(t1e(...this._routers.map(i=>i.getClosestPeers(e,t))),i=>e1e(i,this._peerStore),i=>WYe(i),i=>YYe(i))}};s1e.exports=n1e});var u1e=m((qDt,c1e)=>{l();"use strict";var iXe=rs(),a1e=class{constructor(e){this._dht=e}async provide(e){await iXe(this._dht.provide(e))}async*findProviders(e,t){for await(let i of this._dht.findProviders(e,t))i.name==="PROVIDER"&&(yield*i.providers)}};c1e.exports={DHTContentRouting:a1e}});var d1e=m((UDt,f1e)=>{l();"use strict";var vh=br(),{messages:Wm,codes:Eh}=wr(),{storeAddresses:nXe,uniquePeers:sXe,requirePeers:oXe,maybeLimitSource:aXe}=tC(),cXe=rs(),uXe=Al(),{pipe:lXe}=dr(),{DHTContentRouting:fXe}=u1e(),l1e=class{constructor(e){this.libp2p=e,this.routers=e._modules.contentRouting||[],this.dht=e._dht,this.dht&&e._config.dht.enabled&&this.routers.push(new fXe(this.dht))}async*findProviders(e,t={}){if(!this.routers.length)throw vh(new Error("No content this.routers available"),Eh.ERR_NO_ROUTERS_AVAILABLE);yield*lXe(uXe(...this.routers.map(i=>i.findProviders(e,t))),i=>nXe(i,this.libp2p.peerStore),i=>sXe(i),i=>aXe(i,t.maxNumProviders),i=>oXe(i))}async provide(e){if(!this.routers.length)throw vh(new Error("No content routers available"),Eh.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map(t=>t.provide(e)))}async put(e,t,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw vh(new Error(Wm.NOT_STARTED_YET),Eh.DHT_NOT_STARTED);await cXe(this.dht.put(e,t,i))}async get(e,t){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw vh(new Error(Wm.NOT_STARTED_YET),Eh.DHT_NOT_STARTED);for await(let i of this.dht.get(e,t))if(i.name==="VALUE")return{from:i.peerId,val:i.value};throw vh(new Error(Wm.NOT_FOUND),Eh.ERR_NOT_FOUND)}async*getMany(e,t,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw vh(new Error(Wm.NOT_STARTED_YET),Eh.DHT_NOT_STARTED);if(!t)return;let n=0;for await(let s of this.dht.get(e,i))if(s.name==="VALUE"&&(yield{from:s.peerId,val:s.value},n++,n===t))break;if(n===0)throw vh(new Error(Wm.NOT_FOUND),Eh.ERR_NOT_FOUND)}};f1e.exports=l1e});var iC=m((FDt,g1e)=>{l();"use strict";var dXe=st(),{Multiaddr:h1e}=lt(),p1e=br(),{codes:y1e}=wr();function hXe(r){typeof r=="string"&&(r=new h1e(r));let e;if(h1e.isMultiaddr(r)){e=r;let t=r.getPeerId();if(!t)throw p1e(new Error(`${r} does not have a valid peer type`),y1e.ERR_INVALID_MULTIADDR);try{r=dXe.createFromB58String(t)}catch(i){throw p1e(new Error(`${r} is not a valid peer type`),y1e.ERR_INVALID_MULTIADDR)}}return{id:r,multiaddrs:e?[e]:void 0}}g1e.exports=hXe});var w1e=m((KDt,b1e)=>{l();"use strict";b1e.exports=m1e;var pXe=hv(),Ef=m1e.prototype,yXe=new Date%1e9;function gXe(){return(Math.random()*1e9>>>0)+yXe++}function m1e(r){r=r||{},this.id=r.id||gXe(),this.max=r.max||1/0,this.items=r.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(r.lastModified||new Date);for(var e,t,i=this.items.length;i--;)e=this.items[i],t=new Date(e.expires)-new Date,this._lookup[e.key]=e,t>0?this.expire(e.key,t):t<=0&&this.delete(e.key)}Ef.has=function(r){return r in this._lookup};Ef.get=function(r){if(!this.has(r))return null;var e=this._lookup[r];return e.refresh&&this.expire(r,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value};Ef.meta=function(r){if(!this.has(r))return null;var e=this._lookup[r];return"meta"in e?e.meta:null};Ef.set=function(r,e,t){var i=this._lookup[r],n=this._lookup[r]={key:r,value:e};return this.lastModified=new Date,i?(clearTimeout(i.timeout),this.items.splice(this.items.indexOf(i),1,n)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(n),this.size++),t&&("ttl"in t&&this.expire(r,t.ttl),"meta"in t&&(n.meta=t.meta),t.refresh&&(n.refresh=t.ttl)),this};Ef.delete=function(r){var e=this._lookup[r];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[r],this.size--,this):!1};Ef.expire=function(r,e){var t=e||0,i=this._lookup[r];if(!i)return this;if(typeof t=="string"&&(t=pXe(e)),typeof t!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(i.timeout),i.timeout=setTimeout(this.delete.bind(this,i.key),t),i.expires=Number(new Date)+t,this};Ef.clear=function(){for(var r=this.items.length;r--;)this.delete(this.items[r].key);return this};Ef.toJSON=function(){for(var r=new Array(this.items.length),e,t=r.length;t--;)e=this.items[t],r[t]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:r}}});var v1e=m((VDt,_1e)=>{l();"use strict";var{default:mXe,Headers:bXe}=uE();function wXe({serverResolver:r,hostname:e,recordType:t}){return`${r}?name=${e}&type=${t}`}function _Xe(r){return mXe(r,{headers:new bXe({accept:"application/dns-json"})})}function vXe(r,e){return`${e}_${r}`}_1e.exports={buildResource:wXe,fetch:_Xe,getCacheKey:vXe}});var A1e=m((zDt,S1e)=>{l();"use strict";var E1e=le(),a_=E1e("dns-over-http-resolver");a_.error=E1e("dns-over-http-resolver:error");var EXe=w1e(),To=v1e(),c_=class{constructor({maxCache:e=100}={}){this._cache=new EXe({max:e}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"]}getServers(){return this._servers}_getShuffledServers(){let e=[].concat(this._servers);for(let t=e.length-1;t>0;t--){let i=Math.floor(Math.random()*t),n=e[t];e[t]=e[i],e[i]=n}return e}setServers(e){this._servers=e}resolve(e,t="A"){switch(t){case"A":return this.resolve4(e);case"AAAA":return this.resolve6(e);case"TXT":return this.resolveTxt(e);default:throw new Error(`${t} is not supported`)}}async resolve4(e){let t="A",i=this._cache.get(To.getCacheKey(e,t));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await To.fetch(To.buildResource({serverResolver:n,hostname:e,recordType:t}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(To.getCacheKey(e,t),a,{ttl:c}),a}catch(s){a_.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}async resolve6(e){let t="AAAA",i=this._cache.get(To.getCacheKey(e,t));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await To.fetch(To.buildResource({serverResolver:n,hostname:e,recordType:t}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(To.getCacheKey(e,t),a,{ttl:c}),a}catch(s){a_.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}async resolveTxt(e){let t="TXT",i=this._cache.get(To.getCacheKey(e,t));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await To.fetch(To.buildResource({serverResolver:n,hostname:e,recordType:t}))).json(),a=o.Answer.map(u=>[u.data.replace(/['"]+/g,"")]),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(To.getCacheKey(e,t),a,{ttl:c}),a}catch(s){a_.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}};c_.Resolver=c_;S1e.exports=c_});var x1e=m((HDt,R1e)=>{l();"use strict";var SXe=A1e();R1e.exports=SXe});var T1e=m(($Dt,I1e)=>{l();"use strict";var AXe=jy(),{code:RXe}=AXe("dnsaddr");async function xXe(r){let e=x1e(),t=new e,i=r.getPeerId(),[,n]=r.stringTuples().find(([a])=>a===RXe)||[],o=(await t.resolveTxt(`_dnsaddr.${n}`)).flat().map(a=>a.split("=")[1]);return i&&(o=o.filter(a=>a.includes(i))),o}I1e.exports={dnsaddrResolver:xXe}});var u_=m((GDt,P1e)=>{l();"use strict";P1e.exports={DIAL_TIMEOUT:3e4,MAX_PARALLEL_DIALS:100,MAX_PER_PEER_DIALS:4,MAX_ADDRS_TO_DIAL:25,METRICS:{computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50}}});var nC=m((WDt,IXe)=>{IXe.exports={name:"libp2p",version:"0.36.2",description:"JavaScript implementation of libp2p, a modular peer to peer network stack",leadMaintainer:"Jacob Heun <jacobheun@gmail.com>",main:"src/index.js",types:"dist/src/index.d.ts",typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"]}},files:["dist","src"],scripts:{lint:"aegir lint",build:"aegir build","build:proto":"npm run build:proto:circuit && npm run build:proto:fetch && npm run build:proto:identify && npm run build:proto:plaintext && npm run build:proto:address-book && npm run build:proto:proto-book && npm run build:proto:peer && npm run build:proto:peer-record && npm run build:proto:envelope","build:proto:circuit":"pbjs -t static-module -w commonjs -r libp2p-circuit --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/circuit/protocol/index.js ./src/circuit/protocol/index.proto","build:proto:fetch":"pbjs -t static-module -w commonjs -r libp2p-fetch --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/fetch/proto.js ./src/fetch/proto.proto","build:proto:identify":"pbjs -t static-module -w commonjs -r libp2p-identify --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/identify/message.js ./src/identify/message.proto","build:proto:plaintext":"pbjs -t static-module -w commonjs -r libp2p-plaintext --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/insecure/proto.js ./src/insecure/proto.proto","build:proto:peer":"pbjs -t static-module -w commonjs -r libp2p-peer --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/pb/peer.js ./src/peer-store/pb/peer.proto","build:proto:peer-record":"pbjs -t static-module -w commonjs -r libp2p-peer-record --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/peer-record/peer-record.js ./src/record/peer-record/peer-record.proto","build:proto:envelope":"pbjs -t static-module -w commonjs -r libp2p-envelope --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/envelope/envelope.js ./src/record/envelope/envelope.proto","build:proto-types":"npm run build:proto-types:circuit && npm run build:proto-types:fetch && npm run build:proto-types:identify && npm run build:proto-types:plaintext && npm run build:proto-types:address-book && npm run build:proto-types:proto-book && npm run build:proto-types:peer && npm run build:proto-types:peer-record && npm run build:proto-types:envelope","build:proto-types:circuit":"pbts -o src/circuit/protocol/index.d.ts src/circuit/protocol/index.js","build:proto-types:fetch":"pbts -o src/fetch/proto.d.ts src/fetch/proto.js","build:proto-types:identify":"pbts -o src/identify/message.d.ts src/identify/message.js","build:proto-types:plaintext":"pbts -o src/insecure/proto.d.ts src/insecure/proto.js","build:proto-types:peer":"pbts -o src/peer-store/pb/peer.d.ts src/peer-store/pb/peer.js","build:proto-types:peer-record":"pbts -o src/record/peer-record/peer-record.d.ts src/record/peer-record/peer-record.js","build:proto-types:envelope":"pbts -o src/record/envelope/envelope.d.ts src/record/envelope/envelope.js",test:"aegir test","test:ts":"aegir build --no-bundle && npm run test --prefix test/ts-use","test:node":'aegir test -t node -f "./test/**/*.{node,spec}.js"',"test:browser":"aegir test -t browser","test:examples":"cd examples && npm run test:all","test:interop":"LIBP2P_JS=$PWD npx aegir test -t node -f ./node_modules/libp2p-interop/test/*",prepare:"npm run build",coverage:"nyc --reporter=text --reporter=lcov npm run test:node"},repository:{type:"git",url:"https://github.com/libp2p/js-libp2p.git"},keywords:["libp2p","network","p2p","peer","peer-to-peer","IPFS"],bugs:{url:"https://github.com/libp2p/js-libp2p/issues"},homepage:"https://libp2p.io",license:"MIT",engines:{node:">=15.0.0"},browser:{"nat-api":!1},eslintConfig:{extends:"ipfs",ignorePatterns:["!.aegir.js","test/ts-use","*.d.ts"]},dependencies:{"@vascosantos/moving-average":"^1.1.0","abortable-iterator":"^3.0.0","aggregate-error":"^3.1.0","any-signal":"^3.0.0","bignumber.js":"^9.0.1","class-is":"^1.1.0","datastore-core":"^7.0.0",debug:"^4.3.1","err-code":"^3.0.0","es6-promisify":"^7.0.0",events:"^3.3.0",hashlru:"^2.3.0","interface-datastore":"^6.0.2","it-all":"^1.0.4","it-buffer":"^0.1.2","it-drain":"^1.0.3","it-filter":"^1.0.1","it-first":"^1.0.4","it-foreach":"^0.1.1","it-handshake":"^2.0.0","it-length-prefixed":"^5.0.2","it-map":"^1.0.4","it-merge":"^1.0.0","it-pipe":"^1.1.0","it-sort":"^1.0.1","it-take":"^1.0.0","libp2p-crypto":"^0.21.2","libp2p-interfaces":"^4.0.0","libp2p-utils":"^0.4.0",mafmt:"^10.0.0","merge-options":"^3.0.4",mortice:"^2.0.1",multiaddr:"^10.0.0",multiformats:"^9.0.0","multistream-select":"^3.0.0","mutable-proxy":"^1.0.0","nat-api":"^0.3.1","node-forge":"^1.2.1","p-any":"^3.0.0","p-fifo":"^1.0.0","p-retry":"^4.4.0","p-settle":"^4.1.1","peer-id":"^0.16.0","private-ip":"^2.1.0",protobufjs:"^6.10.2",retimer:"^3.0.0","sanitize-filename":"^1.6.3","set-delayed-interval":"^1.0.0","streaming-iterables":"^6.0.0","timeout-abort-controller":"^3.0.0",uint8arrays:"^3.0.0",varint:"^6.0.0",wherearewe:"^1.0.0",xsalsa20:"^1.1.0"},devDependencies:{"@chainsafe/libp2p-noise":"^5.0.0","@nodeutils/defaults-deep":"^1.1.0","@types/es6-promisify":"^6.0.0","@types/node":"^16.0.1","@types/node-forge":"^1.0.0","@types/varint":"^6.0.0",aegir:"^36.0.0",buffer:"^6.0.3",delay:"^5.0.0","into-stream":"^6.0.0","ipfs-http-client":"^54.0.2","it-concat":"^2.0.0","it-pair":"^1.0.0","it-pushable":"^1.4.0",libp2p:".","libp2p-bootstrap":"^0.14.0","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.11.1","libp2p-interfaces-compliance-tests":"^4.0.8","libp2p-interop":"^0.7.1","libp2p-kad-dht":"^0.28.6","libp2p-mdns":"^0.18.0","libp2p-mplex":"^0.10.4","libp2p-tcp":"^0.17.0","libp2p-webrtc-star":"^0.25.0","libp2p-websockets":"^0.16.0",nock:"^13.0.3","p-defer":"^3.0.0","p-times":"^3.0.0","p-wait-for":"^3.2.0",rimraf:"^3.0.2",sinon:"^12.0.1",util:"^0.12.3"},contributors:["Vasco Santos <vasco.santos@moxy.studio>","David Dias <daviddias.p@gmail.com>","Jacob Heun <jacobheun@gmail.com>","Alex Potsides <alex@achingbrain.net>","Alan Shaw <alan@tableflip.io>","Cayman <caymannava@gmail.com>","Pedro Teixeira <i@pgte.me>","Friedel Ziegelmayer <dignifiedquire@gmail.com>","Maciej Kr\xFCger <mkg20001@gmail.com>","Hugo Dias <mail@hugodias.me>","dirkmc <dirkmdev@gmail.com>","Volker Mische <volker.mische@gmail.com>","Chris Dostert <chrisdostert@users.noreply.github.com>","zeim839 <50573884+zeim839@users.noreply.github.com>","Robert Kiel <robert.kiel@hoprnet.org>","Richard Littauer <richard.littauer@gmail.com>","a1300 <matthias-knopp@gmx.net>","Ryan Bell <ryan@piing.net>","\u1D20\u026A\u1D04\u1D1B\u1D0F\u0280 \u0299\u1D0A\u1D07\u029F\u1D0B\u029C\u1D0F\u029F\u1D0D <victorbjelkholm@gmail.com>","Andrew Nesbitt <andrewnez@gmail.com>","Franck Royer <franck@royer.one>","Thomas Eizinger <thomas@eizinger.io>","V\xEDt Habada <vithabada93@gmail.com>","Giovanni T. Parra <fiatjaf@gmail.com>","acolytec3 <17355484+acolytec3@users.noreply.github.com>","Alan Smithee <ggnore.alan.smithee@gmail.com>","Elven <mon.samuel@qq.com>","Samlior <samlior@foxmail.com>","Didrik Nordstr\xF6m <didrik.nordstrom@gmail.com>","Aditya Bose <13054902+adbose@users.noreply.github.com>","TJKoury <TJKoury@gmail.com>","TheStarBoys <41286328+TheStarBoys@users.noreply.github.com>","Tiago Alves <alvesjtiago@gmail.com>","Tim Daubensch\xFCtz <tim@daubenschuetz.de>","XiaoZhang <zxinmyth@gmail.com>","Yusef Napora <yusef@napora.org>","Zane Starr <zcstarr@gmail.com>","ebinks <elizabethjbinks@gmail.com>","greenSnot <greenSnot@users.noreply.github.com>","isan_rivkin <isanrivkin@gmail.com>","mayerwin <mayerwin@users.noreply.github.com>","mcclure <andi.m.mcclure@gmail.com>","patrickwoodhead <91056047+patrickwoodhead@users.noreply.github.com>","phillmac <phillmac@users.noreply.github.com>","robertkiel <robert.kiel@validitylabs.org>","shresthagrawal <34920931+shresthagrawal@users.noreply.github.com>","swedneck <40505480+swedneck@users.noreply.github.com>","tuyennhv <vutuyen2636@gmail.com>","S\xF6nke Hahn <soenkehahn@gmail.com>","Aleksei <vozhdb@gmail.com>","Bernd Strehl <bernd.strehl@gmail.com>","Chris Bratlien <chrisbratlien@gmail.com>","Cindy Wu <ciindy.wu@gmail.com>","Daijiro Wachi <daijiro.wachi@gmail.com>","Diogo Silva <fsdiogo@gmail.com>","Dmitriy Ryajov <dryajov@gmail.com>","Ethan Lam <elmemphis2000@gmail.com>","Fei Liu <liu.feiwood@gmail.com>","Felipe Martins <felipebrasil93@gmail.com>","Florian-Merle <florian.david.merle@gmail.com>","Francis Gulotta <wizard@roborooter.com>","Guy Sviry <32539816+guysv@users.noreply.github.com>","Henrique Dias <hacdias@gmail.com>","Irakli Gozalishvili <rfobic@gmail.com>","Joel Gustafson <joelg@mit.edu>","John Rees <johnrees@users.noreply.github.com>","Jo\xE3o Santos <joaosantos15@users.noreply.github.com>","Julien Bouquillon <contact@revolunet.com>","Kevin Kwok <antimatter15@gmail.com>","Kevin Lacker <lacker@gmail.com>","Lars Gierth <lgierth@users.noreply.github.com>","Leask Wong <i@leaskh.com>","Marcin Tojek <mtojek@users.noreply.github.com>","Marston Connell <34043723+TheMarstonConnell@users.noreply.github.com>","Michael Burns <5170+mburns@users.noreply.github.com>","Miguel Mota <miguelmota2@gmail.com>","Nuno Nogueira <nunofmn@gmail.com>","Philipp Muens <raute1337@gmx.de>","RasmusErik Voel Jensen <github@solsort.com>","Smite Chow <xiaopengyou@live.com>","Soeren <nikorpoulsen@gmail.com>"]}});var sC=m((YDt,Pc)=>{l();"use strict";var TXe=nC().version;Pc.exports.PROTOCOL_VERSION="ipfs/0.1.0";Pc.exports.AGENT_VERSION=`js-libp2p/${TXe}`;Pc.exports.MULTICODEC_IDENTIFY="/ipfs/id/1.0.0";Pc.exports.MULTICODEC_IDENTIFY_PUSH="/ipfs/id/push/1.0.0";Pc.exports.IDENTIFY_PROTOCOL_VERSION="0.1.0";Pc.exports.MULTICODEC_IDENTIFY_PROTOCOL_NAME="id";Pc.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME="id/push";Pc.exports.MULTICODEC_IDENTIFY_PROTOCOL_VERSION="1.0.0";Pc.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION="1.0.0"});var l_=m((XDt,O1e)=>{l();"use strict";var C1e=60*1e3;O1e.exports={ADVERTISE_BOOT_DELAY:15*C1e,ADVERTISE_TTL:30*C1e,CIRCUIT_PROTO_CODE:290,HOP_METADATA_KEY:"hop_relay",HOP_METADATA_VALUE:"true",RELAY_RENDEZVOUS_NS:"/libp2p/relay"}});var D1e=m((QDt,k1e)=>{l();"use strict";var PXe=Y8();function CXe(r){let{address:e}=r.nodeAddress();return PXe(e)}k1e.exports=CXe});var oC=m((ZDt,B1e)=>{l();"use strict";var N1e=D1e();function OXe(r,e){let t=N1e(r.multiaddr),i=N1e(e.multiaddr);return t&&!i?1:!t&&i||r.isCertified&&!e.isCertified?-1:!r.isCertified&&e.isCertified?1:0}function kXe(r){return[...r].sort(OXe)}B1e.exports.publicAddressesFirst=kXe});var M1e=m((JDt,aC)=>{l();"use strict";var L1e=async r=>{try{let e=await r;return{isFulfilled:!0,isRejected:!1,value:e}}catch(e){return{isFulfilled:!1,isRejected:!0,reason:e}}};aC.exports=L1e;aC.exports.default=L1e});var q1e=m((eNt,cC)=>{l();"use strict";var j1e=(r,...e)=>new Promise(t=>{t(r(...e))});cC.exports=j1e;cC.exports.default=j1e});var F1e=m((tNt,uC)=>{l();"use strict";var DXe=q1e(),U1e=r=>{if(!((Number.isInteger(r)||r===1/0)&&r>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));let e=[],t=0,i=()=>{t--,e.length>0&&e.shift()()},n=(a,c,...u)=>{t++;let f=DXe(a,...u);c(f),f.then(i,i)},s=(a,c,...u)=>{t<r?n(a,c,...u):e.push(n.bind(null,a,c,...u))},o=(a,...c)=>new Promise(u=>s(a,u,...c));return Object.defineProperties(o,{activeCount:{get:()=>t},pendingCount:{get:()=>e.length},clearQueue:{value:()=>{e.length=0}}}),o};uC.exports=U1e;uC.exports.default=U1e});var V1e=m((rNt,K1e)=>{l();"use strict";var lC=M1e(),NXe=F1e();K1e.exports=async(r,e={})=>{let{concurrency:t=1/0}=e,i=NXe(t);return Promise.all(r.map(n=>n&&typeof n.then=="function"?lC(n):lC(typeof n=="function"?i(()=>n()):Promise.resolve(n))))}});var H1e=m((iNt,z1e)=>{l();"use strict";function BXe(r,e){return r.length===e.length&&e.sort()&&r.sort().every((t,i)=>e[i].equals(t))}z1e.exports=BXe});var W1e=m((nNt,G1e)=>{l();"use strict";var Sh=Br(),f_=Sh.Reader,$1e=Sh.Writer,oi=Sh.util,Po=Sh.roots["libp2p-peer-record"]||(Sh.roots["libp2p-peer-record"]={});Po.PeerRecord=function(){function r(e){if(this.addresses=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.peerId=oi.newBuffer([]),r.prototype.seq=oi.Long?oi.Long.fromBits(0,0,!0):0,r.prototype.addresses=oi.emptyArray,r.encode=function(t,i){if(i||(i=$1e.create()),t.peerId!=null&&Object.hasOwnProperty.call(t,"peerId")&&i.uint32(10).bytes(t.peerId),t.seq!=null&&Object.hasOwnProperty.call(t,"seq")&&i.uint32(16).uint64(t.seq),t.addresses!=null&&t.addresses.length)for(var n=0;n<t.addresses.length;++n)Po.PeerRecord.AddressInfo.encode(t.addresses[n],i.uint32(26).fork()).ldelim();return i},r.decode=function(t,i){t instanceof f_||(t=f_.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Po.PeerRecord;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.peerId=t.bytes();break;case 2:s.seq=t.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(Po.PeerRecord.AddressInfo.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Po.PeerRecord)return t;var i=new Po.PeerRecord;if(t.peerId!=null&&(typeof t.peerId=="string"?oi.base64.decode(t.peerId,i.peerId=oi.newBuffer(oi.base64.length(t.peerId)),0):t.peerId.length&&(i.peerId=t.peerId)),t.seq!=null&&(oi.Long?(i.seq=oi.Long.fromValue(t.seq)).unsigned=!0:typeof t.seq=="string"?i.seq=parseInt(t.seq,10):typeof t.seq=="number"?i.seq=t.seq:typeof t.seq=="object"&&(i.seq=new oi.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0))),t.addresses){if(!Array.isArray(t.addresses))throw TypeError(".PeerRecord.addresses: array expected");i.addresses=[];for(var n=0;n<t.addresses.length;++n){if(typeof t.addresses[n]!="object")throw TypeError(".PeerRecord.addresses: object expected");i.addresses[n]=Po.PeerRecord.AddressInfo.fromObject(t.addresses[n])}}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addresses=[]),i.defaults)if(i.bytes===String?n.peerId="":(n.peerId=[],i.bytes!==Array&&(n.peerId=oi.newBuffer(n.peerId))),oi.Long){var s=new oi.Long(0,0,!0);n.seq=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.seq=i.longs===String?"0":0;if(t.peerId!=null&&t.hasOwnProperty("peerId")&&(n.peerId=i.bytes===String?oi.base64.encode(t.peerId,0,t.peerId.length):i.bytes===Array?Array.prototype.slice.call(t.peerId):t.peerId),t.seq!=null&&t.hasOwnProperty("seq")&&(typeof t.seq=="number"?n.seq=i.longs===String?String(t.seq):t.seq:n.seq=i.longs===String?oi.Long.prototype.toString.call(t.seq):i.longs===Number?new oi.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0):t.seq),t.addresses&&t.addresses.length){n.addresses=[];for(var o=0;o<t.addresses.length;++o)n.addresses[o]=Po.PeerRecord.AddressInfo.toObject(t.addresses[o],i)}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Sh.util.toJSONOptions)},r.AddressInfo=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.multiaddr=oi.newBuffer([]),e.encode=function(i,n){return n||(n=$1e.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),n},e.decode=function(i,n){i instanceof f_||(i=f_.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Po.PeerRecord.AddressInfo;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Po.PeerRecord.AddressInfo)return i;var n=new Po.PeerRecord.AddressInfo;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?oi.base64.decode(i.multiaddr,n.multiaddr=oi.newBuffer(oi.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=oi.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?oi.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Sh.util.toJSONOptions)},e}(),r}();G1e.exports=Po});var X1e=m((sNt,Y1e)=>{l();"use strict";var LXe="libp2p-peer-record",MXe=Uint8Array.from([3,1]);Y1e.exports={ENVELOPE_DOMAIN_PEER_RECORD:LXe,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:MXe}});var d_=m((oNt,J1e)=>{l();"use strict";var{Multiaddr:jXe}=lt(),qXe=st(),UXe=H1e(),{PeerRecord:Q1e}=W1e(),{ENVELOPE_DOMAIN_PEER_RECORD:Z1e,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:FXe}=X1e(),Ah=class{constructor({peerId:e,multiaddrs:t=[],seqNumber:i=Date.now()}){this.domain=Z1e,this.codec=FXe,this.peerId=e,this.multiaddrs=t,this.seqNumber=i,this._marshal=void 0}marshal(){return this._marshal?this._marshal:(this._marshal=Q1e.encode({peerId:this.peerId.toBytes(),seq:this.seqNumber,addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))}).finish(),this._marshal)}equals(e){return!(!(e instanceof Ah)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!UXe(this.multiaddrs,e.multiaddrs))}};Ah.createFromProtobuf=r=>{let e=Q1e.decode(r),t=qXe.createFromBytes(e.peerId),i=(e.addresses||[]).map(s=>new jXe(s.multiaddr)),n=Number(e.seq);return new Ah({peerId:t,multiaddrs:i,seqNumber:n})};Ah.DOMAIN=Z1e;J1e.exports=Ah});var fC=m((aNt,eye)=>{l();"use strict";var KXe=um(),VXe=d_();async function zXe(r){let e=new VXe({peerId:r.peerId,multiaddrs:r.multiaddrs}),t=await KXe.seal(e,r.peerId);await r.peerStore.addressBook.consumePeerRecord(t)}eye.exports.updateSelfPeerRecord=zXe});var hC=m((cNt,iye)=>{l();"use strict";var tye=le(),Rh=Object.assign(tye("libp2p:transports"),{error:tye("libp2p:transports:err")}),HXe=V1e(),{codes:$1}=wr(),Ym=br(),{updateSelfPeerRecord:rye}=fC(),dC=class{constructor({libp2p:e,upgrader:t,faultTolerance:i=h_.FATAL_ALL}){this.libp2p=e,this.upgrader=t,this._transports=new Map,this._listeners=new Map,this._listenerOptions=new Map,this.faultTolerance=i}add(e,t,i={}){if(Rh("adding %s",e),!e)throw Ym(new Error(`Transport must have a valid key, was given '${e}'`),$1.ERR_INVALID_KEY);if(this._transports.has(e))throw Ym(new Error("There is already a transport with this key"),$1.ERR_DUPLICATE_TRANSPORT);let n=new t({...i,libp2p:this.libp2p,upgrader:this.upgrader});this._transports.set(e,n),this._listenerOptions.set(e,i.listenerOptions||{}),this._listeners.has(e)||this._listeners.set(e,[])}async close(){let e=[];for(let[t,i]of this._listeners)for(Rh("closing listeners for %s",t);i.length;){let n=i.pop();n.removeAllListeners("listening"),n.removeAllListeners("close"),e.push(n.close())}await Promise.all(e),Rh("all listeners closed");for(let t of this._listeners.keys())this._listeners.set(t,[])}async dial(e,t){let i=this.transportForMultiaddr(e);if(!i)throw Ym(new Error(`No transport available for address ${String(e)}`),$1.ERR_TRANSPORT_UNAVAILABLE);try{return await i.dial(e,t)}catch(n){throw n.code||(n.code=$1.ERR_TRANSPORT_DIAL_FAILED),n}}getAddrs(){let e=[];for(let t of this._listeners.values())for(let i of t)e=[...e,...i.getAddrs()];return e}getTransports(){return this._transports.values()}transportForMultiaddr(e){for(let t of this._transports.values())if(t.filter([e]).length)return t;return null}async listen(e){if(!e||e.length===0){Rh("no addresses were provided for listening, this node is dial only");return}let t=[];for(let[i,n]of this._transports.entries()){let s=n.filter(e),o=[];for(let u of s){Rh("creating listener for %s on %s",i,u);let f=n.createListener(this._listenerOptions.get(i));this._listeners.get(i).push(f),f.on("listening",()=>rye(this.libp2p)),f.on("close",()=>rye(this.libp2p)),o.push(f.listen(u))}if(o.length===0){t.push(i);continue}if(!(await HXe(o)).find(u=>u.isFulfilled===!0)&&this.faultTolerance!==h_.NO_FATAL)throw Ym(new Error(`Transport (${i}) could not listen on any available address`),$1.ERR_NO_VALID_ADDRESSES)}if(t.length===this._transports.size){let i=`no valid addresses were provided for transports [${t}]`;if(this.faultTolerance===h_.FATAL_ALL)throw Ym(new Error(i),$1.ERR_NO_VALID_ADDRESSES);Rh(`libp2p in dial mode only: ${i}`)}}async remove(e){if(Rh("removing %s",e),this._listeners.has(e))for(let t of this._listeners.get(e))t.removeAllListeners("listening"),t.removeAllListeners("close"),await t.close();this._transports.delete(e),this._listeners.delete(e)}async removeAll(){let e=[];for(let t of this._transports.keys())e.push(this.remove(t));await Promise.all(e)}},h_={FATAL_ALL:0,NO_FATAL:1};dC.FaultTolerance=h_;iye.exports=dC});var oye=m((uNt,sye)=>{l();"use strict";var $Xe=Ku(),{dnsaddrResolver:GXe}=T1e(),pC=u_(),{AGENT_VERSION:WXe}=sC(),nye=l_(),{publicAddressesFirst:YXe}=oC(),{FaultTolerance:XXe}=hC(),QXe={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:r=>r},connectionManager:{minConnections:25},connectionGater:{},transportManager:{faultTolerance:XXe.FATAL_ALL},dialer:{maxParallelDials:pC.MAX_PARALLEL_DIALS,maxDialsPerPeer:pC.MAX_PER_PEER_DIALS,dialTimeout:pC.DIAL_TIMEOUT,resolvers:{dnsaddr:GXe},addressSorter:YXe},host:{agentVersion:WXe},metrics:{enabled:!1},peerStore:{persistence:!1,threshold:5},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},config:{protocolPrefix:"ipfs",dht:{enabled:!1,kBucketSize:20},nat:{enabled:!0,ttl:7200,keepAlive:!0,gateway:null,externalIp:null,pmp:{enabled:!1}},peerDiscovery:{autoDial:!0},pubsub:{enabled:!0},relay:{enabled:!0,advertise:{bootDelay:nye.ADVERTISE_BOOT_DELAY,enabled:!1,ttl:nye.ADVERTISE_TTL},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},transport:{}}};sye.exports.validate=r=>{let e=$Xe(QXe,r);if(e.modules.transport.length<1)throw new Error("'options.modules.transport' must contain at least 1 transport");return e}});var uye=m((lNt,cye)=>{l();"use strict";var{EventEmitter:ZXe}=Ut(),{Multiaddr:Xm}=lt(),JXe=st(),aye=class extends ZXe{constructor(e,{listen:t=[],announce:i=[]}={}){super();this.peerId=e,this.listen=new Set(t.map(n=>n.toString())),this.announce=new Set(i.map(n=>n.toString())),this.observed=new Set}getListenAddrs(){return Array.from(this.listen).map(e=>new Xm(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new Xm(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new Xm(e))}addObservedAddr(e){let t=new Xm(e),i=t.getPeerId();i&&JXe.createFromB58String(i).equals(this.peerId)&&(t=t.decapsulate(new Xm(`/p2p/${this.peerId}`)));let n=t.toString();this.observed.has(n)||(this.observed.add(n),this.emit("change:addresses"))}};cye.exports=aye});var dye=m((fNt,fye)=>{l();"use strict";var{EventEmitter:eQe}=Ut(),yC=le()("latency-monitor:VisibilityChangeEmitter"),lye=class extends eQe{constructor(){super();if(typeof document=="undefined"){yC('This is not a browser, no "document" found. Stopping.');return}this._initializeVisibilityVarNames(),this._addVisibilityChangeListener()}_initializeVisibilityVarNames(){let e,t;typeof document.hidden!="undefined"?(e="hidden",t="visibilitychange"):typeof document.mozHidden!="undefined"?(e="mozHidden",t="mozvisibilitychange"):typeof document.msHidden!="undefined"?(e="msHidden",t="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(e="webkitHidden",t="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=t}_addVisibilityChangeListener(){typeof document.addEventListener=="undefined"||typeof document[this._hidden]=="undefined"?yC("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this._hidden===void 0||document[this._hidden]===void 0))return!document[this._hidden]}_handleVisibilityChange(){let e=!document[this._hidden];yC(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}};fye.exports=lye});var yye=m((dNt,pye)=>{l();"use strict";var{EventEmitter:tQe}=Ut(),rQe=dye(),Bu=le()("latency-monitor:LatencyMonitor"),hye=class extends tQe{constructor({latencyCheckIntervalMs:e,dataEmitIntervalMs:t,asyncTestFn:i,latencyRandomPercentage:n}={}){super();let s=this;s.latencyCheckIntervalMs=e||500,s.latencyRandomPercentage=n||10,s._latecyCheckMultiply=2*(s.latencyRandomPercentage/100)*s.latencyCheckIntervalMs,s._latecyCheckSubtract=s._latecyCheckMultiply/2,s.dataEmitIntervalMs=t===null||t===0?void 0:t||5*1e3,Bu("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",s.latencyCheckIntervalMs,s.dataEmitIntervalMs),s.dataEmitIntervalMs?Bu("Expecting ~%s events per summary",s.latencyCheckIntervalMs/s.dataEmitIntervalMs):Bu("Not emitting summaries"),s.asyncTestFn=i}start(){globalThis.process&&globalThis.process.hrtime?(Bu("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{let t=this.now(e);return t[0]*1e3+t[1]/1e6}):typeof window!="undefined"&&window.performance&&window.performance.now?(Bu("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(Bu("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this._latencyData=this._initLatencyData(),iQe()&&(this._visibilityChangeEmitter=new rQe,this._visibilityChangeEmitter.on("visibilityChange",e=>{e?this._startTimers():(this._emitSummary(),this._stopTimers())})),(!this._visibilityChangeEmitter||this._visibilityChangeEmitter.isVisible())&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this._checkLatencyID||(this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this._emitIntervalID.unref=="function"&&this._emitIntervalID.unref()))}_stopTimers(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=void 0),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=void 0)}_emitSummary(){let e=this.getSummary();e.events>0&&this.emit("data",e)}getSummary(){let e={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),Bu("Summary: %O",e),e}_checkLatency(){let e=this,t=Math.random()*e._latecyCheckMultiply-e._latecyCheckSubtract,i={deltaOffset:Math.ceil(e.latencyCheckIntervalMs+t),startTime:e.now()},n=()=>{if(!this._checkLatencyID)return;let s=e.getDeltaMS(i.startTime)-i.deltaOffset;e._checkLatency(),e._latencyData.events++,e._latencyData.minMs=Math.min(e._latencyData.minMs,s),e._latencyData.maxMs=Math.max(e._latencyData.maxMs,s),e._latencyData.totalMs+=s,Bu("MS: %s Data: %O",s,e._latencyData)};Bu("localData: %O",i),this._checkLatencyID=setTimeout(()=>{e.asyncTestFn?(i.deltaOffset=0,i.startTime=e.now(),e.asyncTestFn(n)):(i.deltaOffset-=1,n())},i.deltaOffset),typeof this._checkLatencyID.unref=="function"&&this._checkLatencyID.unref()}_initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}};function iQe(){return typeof window!="undefined"}pye.exports=hye});var xh=m((hNt,mye)=>{l();"use strict";var gye=class extends Map{constructor(e){super();let{system:t,component:i,metric:n,metrics:s}=e;this._system=t,this._component=i,this._metric=n,this._metrics=s,this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size})}set(e,t){return super.set(e,t),this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size}),this}delete(e){let t=super.delete(e);return this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size}),t}clear(){super.clear(),this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size})}};mye.exports=({system:r="libp2p",component:e,metric:t,metrics:i})=>{let n;return i?n=new gye({system:r,component:e,metric:t,metrics:i}):n=new Map,n}});var xye=m((pNt,Rye)=>{l();"use strict";var bye=le(),wa=Object.assign(bye("libp2p:connection-manager"),{error:bye("libp2p:connection-manager:err")}),wye=br(),nQe=Ku(),sQe=yye(),_ye=Gy(),{EventEmitter:oQe}=Ut(),vye=xh(),aQe=st(),{codes:{ERR_INVALID_PARAMETERS:Eye}}=wr(),cQe={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:1},Sye="connection-manager",uQe="peer-connections",lQe="peer-values",Aye=class extends oQe{constructor(e,t={}){super();if(this._libp2p=e,this._peerId=e.peerId.toB58String(),this._options=nQe.call({ignoreUndefined:!0},cQe,t),this._options.maxConnections<this._options.minConnections)throw wye(new Error("Connection Manager maxConnections must be greater than minConnections"),Eye);wa("options: %j",this._options),this._peerValues=vye({component:Sye,metric:lQe,metrics:this._libp2p.metrics}),this.connections=vye({component:Sye,metric:uQe,metrics:this._libp2p.metrics}),this._started=!1,this._timer=null,this._checkMetrics=this._checkMetrics.bind(this),this._latencyMonitor=new sQe({latencyCheckIntervalMs:this._options.pollInterval,dataEmitIntervalMs:this._options.pollInterval}),this.setMaxListeners(1/0)}get size(){return Array.from(this.connections.values()).reduce((e,t)=>e+t.length,0)}start(){this._libp2p.metrics&&(this._timer=this._timer||_ye(this._checkMetrics,this._options.pollInterval)),this._latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure),this._started=!0,wa("started")}async stop(){this._timer&&this._timer.clear(),this._latencyMonitor.removeListener("data",this._onLatencyMeasure),this._latencyMonitor.stop(),this._started=!1,await this._close(),wa("stopped")}async _close(){let e=[];for(let t of this.connections.values())for(let i of t)e.push(i.close());await Promise.all(e),this.connections.clear()}setPeerValue(e,t){if(t<0||t>1)throw new Error("value should be a number between 0 and 1");this._peerValues.set(e.toB58String(),t)}async _checkMetrics(){if(this._libp2p.metrics)try{let e=this._libp2p.metrics.global.movingAverages,t=e.dataReceived[this._options.movingAverageInterval].movingAverage();await this._checkMaxLimit("maxReceivedData",t);let i=e.dataSent[this._options.movingAverageInterval].movingAverage();await this._checkMaxLimit("maxSentData",i);let n=t+i;await this._checkMaxLimit("maxData",n),wa("metrics update",n)}finally{this._timer=_ye(this._checkMetrics,this._options.pollInterval)}}async onConnect(e){if(!this._started){await e.close();return}let t=e.remotePeer,i=t.toB58String(),n=this.connections.get(i);this.emit("peer:connect",e),n?n.push(e):this.connections.set(i,[e]),await this._libp2p.peerStore.keyBook.set(t,t.pubKey),this._peerValues.has(i)||this._peerValues.set(i,this._options.defaultPeerValue),await this._checkMaxLimit("maxConnections",this.size)}onDisconnect(e){if(!this._started)return;let t=e.remotePeer.toB58String(),i=this.connections.get(t);i&&i.length>1?(i=i.filter(n=>n.id!==e.id),this.connections.set(t,i)):i&&(this.connections.delete(t),this._peerValues.delete(e.remotePeer.toB58String()),this.emit("peer:disconnect",e),this._libp2p.metrics&&this._libp2p.metrics.onPeerDisconnected(e.remotePeer))}get(e){let t=this.getAll(e);return t.length?t[0]:null}getAll(e){if(!aQe.isPeerId(e))throw wye(new Error("peerId must be an instance of peer-id"),Eye);let t=e.toB58String(),i=this.connections.get(t);return i?i.filter(n=>n.stat.status==="open"):[]}_onLatencyMeasure(e){this._checkMaxLimit("maxEventLoopDelay",e.avgMs).catch(t=>{wa.error(t)})}async _checkMaxLimit(e,t){let i=this._options[e];wa("checking limit of %s. current value: %d of %d",e,t,i),t>i&&(wa("%s: limit exceeded: %s, %d",this._peerId,e,t),await this._maybeDisconnectOne())}async _maybeDisconnectOne(){if(this._options.minConnections<this.connections.size){let e=Array.from(new Map([...this._peerValues.entries()].sort((i,n)=>i[1]-n[1])));wa("%s: sorted peer values: %j",this._peerId,e);let t=e[0];if(t){let i=t[0];wa("%s: lowest value peer is %s",this._peerId,i),wa("%s: closing a connection to %j",this._peerId,i);for(let n of this.connections.values())if(n[0].remotePeer.toB58String()===i){n[0].close().catch(s=>{wa.error(s)}),this.onDisconnect(n[0]);break}}}}};Rye.exports=Aye});var Oye=m((yNt,Cye)=>{l();"use strict";var Iye=le(),fQe=Ku(),Tye=Gy(),dQe=Jo(),{pipe:hQe}=dr(),pQe=is(),yQe=WR(),Sf=Object.assign(Iye("libp2p:connection-manager:auto-dialler"),{error:Iye("libp2p:connection-manager:auto-dialler:err")}),gQe={enabled:!0,minConnections:0,autoDialInterval:1e4},Pye=class{constructor(e,t={}){this._options=fQe.call({ignoreUndefined:!0},gQe,t),this._libp2p=e,this._running=!1,this._autoDialTimeout=null,this._autoDial=this._autoDial.bind(this),Sf("options: %j",this._options)}async start(){if(!this._options.enabled){Sf("not enabled");return}this._running=!0,this._autoDial().catch(e=>{Sf.error("could start autodial",e)}),Sf("started")}async stop(){if(!this._options.enabled){Sf("not enabled");return}this._running=!1,this._autoDialTimeout&&this._autoDialTimeout.clear(),Sf("stopped")}async _autoDial(){let e=this._options.minConnections;if(this._libp2p.connections.size>=e){this._autoDialTimeout=Tye(this._autoDial,this._options.autoDialInterval);return}let t=await hQe(this._libp2p.peerStore.getPeers(),i=>pQe(i,n=>!n.id.equals(this._libp2p.peerId)),i=>yQe(i,(n,s)=>s.protocols&&s.protocols.length&&(!n.protocols||!n.protocols.length)||s.id.pubKey&&!n.id.pubKey?1:-1),i=>dQe(i));for(let i=0;this._running&&i<t.length&&this._libp2p.connections.size<e;i++){let n=t[i];if(!this._libp2p.connectionManager.get(n.id)){Sf("connecting to a peerStore stored peer %s",n.id.toB58String());try{await this._libp2p.dialer.connectToPeer(n.id)}catch(s){Sf.error("could not connect to peerStore stored peer",s)}}}!this._running||(this._autoDialTimeout=Tye(this._autoDial,this._options.autoDialInterval))}};Cye.exports=Pye});var G1=m((gNt,Dye)=>{l();"use strict";var Ih=Br(),p_=Ih.Reader,kye=Ih.Writer,Co=Ih.util,Ji=Ih.roots["libp2p-circuit"]||(Ih.roots["libp2p-circuit"]={});Ji.CircuitRelay=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.type=1,r.prototype.srcPeer=null,r.prototype.dstPeer=null,r.prototype.code=100,r.encode=function(t,i){return i||(i=kye.create()),t.type!=null&&Object.hasOwnProperty.call(t,"type")&&i.uint32(8).int32(t.type),t.srcPeer!=null&&Object.hasOwnProperty.call(t,"srcPeer")&&Ji.CircuitRelay.Peer.encode(t.srcPeer,i.uint32(18).fork()).ldelim(),t.dstPeer!=null&&Object.hasOwnProperty.call(t,"dstPeer")&&Ji.CircuitRelay.Peer.encode(t.dstPeer,i.uint32(26).fork()).ldelim(),t.code!=null&&Object.hasOwnProperty.call(t,"code")&&i.uint32(32).int32(t.code),i},r.decode=function(t,i){t instanceof p_||(t=p_.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Ji.CircuitRelay;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.type=t.int32();break;case 2:s.srcPeer=Ji.CircuitRelay.Peer.decode(t,t.uint32());break;case 3:s.dstPeer=Ji.CircuitRelay.Peer.decode(t,t.uint32());break;case 4:s.code=t.int32();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Ji.CircuitRelay)return t;var i=new Ji.CircuitRelay;switch(t.type){case"HOP":case 1:i.type=1;break;case"STOP":case 2:i.type=2;break;case"STATUS":case 3:i.type=3;break;case"CAN_HOP":case 4:i.type=4;break}if(t.srcPeer!=null){if(typeof t.srcPeer!="object")throw TypeError(".CircuitRelay.srcPeer: object expected");i.srcPeer=Ji.CircuitRelay.Peer.fromObject(t.srcPeer)}if(t.dstPeer!=null){if(typeof t.dstPeer!="object")throw TypeError(".CircuitRelay.dstPeer: object expected");i.dstPeer=Ji.CircuitRelay.Peer.fromObject(t.dstPeer)}switch(t.code){case"SUCCESS":case 100:i.code=100;break;case"HOP_SRC_ADDR_TOO_LONG":case 220:i.code=220;break;case"HOP_DST_ADDR_TOO_LONG":case 221:i.code=221;break;case"HOP_SRC_MULTIADDR_INVALID":case 250:i.code=250;break;case"HOP_DST_MULTIADDR_INVALID":case 251:i.code=251;break;case"HOP_NO_CONN_TO_DST":case 260:i.code=260;break;case"HOP_CANT_DIAL_DST":case 261:i.code=261;break;case"HOP_CANT_OPEN_DST_STREAM":case 262:i.code=262;break;case"HOP_CANT_SPEAK_RELAY":case 270:i.code=270;break;case"HOP_CANT_RELAY_TO_SELF":case 280:i.code=280;break;case"STOP_SRC_ADDR_TOO_LONG":case 320:i.code=320;break;case"STOP_DST_ADDR_TOO_LONG":case 321:i.code=321;break;case"STOP_SRC_MULTIADDR_INVALID":case 350:i.code=350;break;case"STOP_DST_MULTIADDR_INVALID":case 351:i.code=351;break;case"STOP_RELAY_REFUSED":case 390:i.code=390;break;case"MALFORMED_MESSAGE":case 400:i.code=400;break}return i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.type=i.enums===String?"HOP":1,n.srcPeer=null,n.dstPeer=null,n.code=i.enums===String?"SUCCESS":100),t.type!=null&&t.hasOwnProperty("type")&&(n.type=i.enums===String?Ji.CircuitRelay.Type[t.type]:t.type),t.srcPeer!=null&&t.hasOwnProperty("srcPeer")&&(n.srcPeer=Ji.CircuitRelay.Peer.toObject(t.srcPeer,i)),t.dstPeer!=null&&t.hasOwnProperty("dstPeer")&&(n.dstPeer=Ji.CircuitRelay.Peer.toObject(t.dstPeer,i)),t.code!=null&&t.hasOwnProperty("code")&&(n.code=i.enums===String?Ji.CircuitRelay.Status[t.code]:t.code),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Ih.util.toJSONOptions)},r.Status=function(){var e={},t=Object.create(e);return t[e[100]="SUCCESS"]=100,t[e[220]="HOP_SRC_ADDR_TOO_LONG"]=220,t[e[221]="HOP_DST_ADDR_TOO_LONG"]=221,t[e[250]="HOP_SRC_MULTIADDR_INVALID"]=250,t[e[251]="HOP_DST_MULTIADDR_INVALID"]=251,t[e[260]="HOP_NO_CONN_TO_DST"]=260,t[e[261]="HOP_CANT_DIAL_DST"]=261,t[e[262]="HOP_CANT_OPEN_DST_STREAM"]=262,t[e[270]="HOP_CANT_SPEAK_RELAY"]=270,t[e[280]="HOP_CANT_RELAY_TO_SELF"]=280,t[e[320]="STOP_SRC_ADDR_TOO_LONG"]=320,t[e[321]="STOP_DST_ADDR_TOO_LONG"]=321,t[e[350]="STOP_SRC_MULTIADDR_INVALID"]=350,t[e[351]="STOP_DST_MULTIADDR_INVALID"]=351,t[e[390]="STOP_RELAY_REFUSED"]=390,t[e[400]="MALFORMED_MESSAGE"]=400,t}(),r.Type=function(){var e={},t=Object.create(e);return t[e[1]="HOP"]=1,t[e[2]="STOP"]=2,t[e[3]="STATUS"]=3,t[e[4]="CAN_HOP"]=4,t}(),r.Peer=function(){function e(t){if(this.addrs=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.id=Co.newBuffer([]),e.prototype.addrs=Co.emptyArray,e.encode=function(i,n){if(n||(n=kye.create()),n.uint32(10).bytes(i.id),i.addrs!=null&&i.addrs.length)for(var s=0;s<i.addrs.length;++s)n.uint32(18).bytes(i.addrs[s]);return n},e.decode=function(i,n){i instanceof p_||(i=p_.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ji.CircuitRelay.Peer;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.id=i.bytes();break;case 2:o.addrs&&o.addrs.length||(o.addrs=[]),o.addrs.push(i.bytes());break;default:i.skipType(a&7);break}}if(!o.hasOwnProperty("id"))throw Co.ProtocolError("missing required 'id'",{instance:o});return o},e.fromObject=function(i){if(i instanceof Ji.CircuitRelay.Peer)return i;var n=new Ji.CircuitRelay.Peer;if(i.id!=null&&(typeof i.id=="string"?Co.base64.decode(i.id,n.id=Co.newBuffer(Co.base64.length(i.id)),0):i.id.length&&(n.id=i.id)),i.addrs){if(!Array.isArray(i.addrs))throw TypeError(".CircuitRelay.Peer.addrs: array expected");n.addrs=[];for(var s=0;s<i.addrs.length;++s)typeof i.addrs[s]=="string"?Co.base64.decode(i.addrs[s],n.addrs[s]=Co.newBuffer(Co.base64.length(i.addrs[s])),0):i.addrs[s].length&&(n.addrs[s]=i.addrs[s])}return n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addrs=[]),n.defaults&&(n.bytes===String?s.id="":(s.id=[],n.bytes!==Array&&(s.id=Co.newBuffer(s.id)))),i.id!=null&&i.hasOwnProperty("id")&&(s.id=n.bytes===String?Co.base64.encode(i.id,0,i.id.length):n.bytes===Array?Array.prototype.slice.call(i.id):i.id),i.addrs&&i.addrs.length){s.addrs=[];for(var o=0;o<i.addrs.length;++o)s.addrs[o]=n.bytes===String?Co.base64.encode(i.addrs[o],0,i.addrs[o].length):n.bytes===Array?Array.prototype.slice.call(i.addrs[o]):i.addrs[o]}return s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ih.util.toJSONOptions)},e}(),r}();Dye.exports=Ji});var Lye=m((mNt,Bye)=>{l();"use strict";var{source:Nye}=fa(),mQe=le(),bQe=mQe("libp2p:stream:converter");function wQe({stream:r,remoteAddr:e,localAddr:t},i={}){let{sink:n,source:s}=r,o={async sink(c){i.signal&&(c=Nye(c,i.signal));try{await n(c)}catch(u){u.type!=="aborted"&&bQe(u)}a()},source:i.signal?Nye(s,i.signal):s,conn:r,localAddr:t,remoteAddr:e,timeline:{open:Date.now(),close:void 0},close(){return n(new Uint8Array(0)),a()}};function a(){return o.timeline.close||(o.timeline.close=Date.now()),Promise.resolve()}return o}Bye.exports=wQe});var Qm=m((bNt,Mye)=>{l();"use strict";Mye.exports={relay:"/libp2p/circuit/relay/0.1.0"}});var qye=m((wNt,jye)=>{l();"use strict";var{EventEmitter:_Qe}=Ut(),{Multiaddr:vQe}=lt();jye.exports=r=>{let e=new Map;async function t(s){let o=String(s).split("/p2p-circuit").find(u=>u!==""),a=await r.dial(new vQe(o)),c=a.remoteAddr.encapsulate("/p2p-circuit");e.set(a.remotePeer.toB58String(),c),n.emit("listening")}function i(){let s=[];for(let o of e.values())s.push(o);return s}let n=Object.assign(new _Qe,{close:()=>Promise.resolve(),listen:t,getAddrs:i});return r.connectionManager.on("peer:disconnect",s=>{e.delete(s.remotePeer.toB58String())&&n.emit("close")}),n}});var gC=m((_Nt,Kye)=>{l();"use strict";var{Multiaddr:Uye}=lt(),{CircuitRelay:Th}=G1();function Fye(r,e){r.write({type:Th.Type.STATUS,code:e})}function EQe(r,e){try{r.dstPeer&&r.dstPeer.addrs&&r.dstPeer.addrs.forEach(t=>new Uye(t))}catch(t){throw Fye(e,r.type===Th.Type.HOP?Th.Status.HOP_DST_MULTIADDR_INVALID:Th.Status.STOP_DST_MULTIADDR_INVALID),t}try{r.srcPeer&&r.srcPeer.addrs&&r.srcPeer.addrs.forEach(t=>new Uye(t))}catch(t){throw Fye(e,r.type===Th.Type.HOP?Th.Status.HOP_SRC_MULTIADDR_INVALID:Th.Status.STOP_SRC_MULTIADDR_INVALID),t}}Kye.exports={validateAddrs:EQe}});var g_=m((vNt,Gye)=>{l();"use strict";var Vye=le(),y_=Object.assign(Vye("libp2p:circuit:stream-handler"),{error:Vye("libp2p:circuit:stream-handler:err")}),zye=go(),SQe=wh(),{CircuitRelay:Hye}=G1(),$ye=class{constructor({stream:e,maxLength:t=4096}){this.stream=e,this.shake=SQe(this.stream),this.decoder=zye.decode.fromReader(this.shake.reader,{maxDataLength:t})}async read(){let e=await this.decoder.next();if(e.value){let t=Hye.decode(e.value.slice());return y_("read message type",t.type),t}y_("read received no value, closing stream"),this.close()}write(e){y_("write message type %s",e.type),this.shake.write(zye.encode.single(Hye.encode(e).finish()))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){y_("closing the stream"),this.rest().sink([])}};Gye.exports=$ye});var wC=m((ENt,bC)=>{l();"use strict";var Wye=le(),Zm=Object.assign(Wye("libp2p:circuit:stop"),{error:Wye("libp2p:circuit:stop:err")}),{CircuitRelay:mC}=G1(),AQe=Qm(),RQe=g_(),{validateAddrs:xQe}=gC();bC.exports.handleStop=function({connection:e,request:t,streamHandler:i}){try{xQe(t,i)}catch(n){return Zm.error("invalid stop request via peer %s",e.remotePeer.toB58String(),n)}return Zm("stop request is valid"),i.write({type:mC.Type.STATUS,code:mC.Status.SUCCESS}),i.rest()};bC.exports.stop=async function({connection:e,request:t}){let{stream:i}=await e.newStream([AQe.relay]);Zm("starting stop request to %s",e.remotePeer.toB58String());let n=new RQe({stream:i});n.write(t);let s=await n.read();if(!s)return n.close();if(s.code===mC.Status.SUCCESS)return Zm("stop request to %s was successful",e.remotePeer.toB58String()),n.rest();Zm("stop request failed with code %d",s.code),n.close()}});var _C=m((SNt,e2e)=>{l();"use strict";var Yye=le(),Lu=Object.assign(Yye("libp2p:circuit:hop"),{error:Yye("libp2p:circuit:hop:err")}),Xye=br(),IQe=st(),{validateAddrs:TQe}=gC(),Qye=g_(),{CircuitRelay:Ts}=G1(),{pipe:PQe}=dr(),{codes:Zye}=wr(),{stop:CQe}=wC(),Jye=Qm();async function OQe({connection:r,request:e,streamHandler:t,circuit:i}){if(!i._options.hop.enabled)return Lu("HOP request received but we are not acting as a relay"),t.end({type:Ts.Type.STATUS,code:Ts.Status.HOP_CANT_SPEAK_RELAY});try{TQe(e,t)}catch(u){return Lu.error("invalid hop request via peer %s",r.remotePeer.toB58String(),u)}if(!e.dstPeer){Lu("HOP request received but we do not receive a dstPeer");return}let n=new IQe(e.dstPeer.id),s=i._connectionManager.get(n);if(!s&&!i._options.hop.active)return Lu("HOP request received but we are not connected to the destination peer"),t.end({type:Ts.Type.STATUS,code:Ts.Status.HOP_NO_CONN_TO_DST});if(!s)return;let o={type:Ts.Type.STOP,dstPeer:e.dstPeer,srcPeer:e.srcPeer},a;try{a=await CQe({connection:s,request:o})}catch(u){return Lu.error(u)}Lu("hop request from %s is valid",r.remotePeer.toB58String()),t.write({type:Ts.Type.STATUS,code:Ts.Status.SUCCESS});let c=t.rest();return PQe(c,a,c)}async function kQe({connection:r,request:e}){let{stream:t}=await r.newStream([Jye.relay]),i=new Qye({stream:t});i.write(e);let n=await i.read();if(!n)throw Xye(new Error("HOP request had no response"),Zye.ERR_HOP_REQUEST_FAILED);if(n.code===Ts.Status.SUCCESS)return Lu("hop request was successful"),i.rest();throw Lu("hop request failed with code %d, closing stream",n.code),i.close(),Xye(new Error(`HOP request failed with code ${n.code}`),Zye.ERR_HOP_REQUEST_FAILED)}async function DQe({connection:r}){let{stream:e}=await r.newStream([Jye.relay]),t=new Qye({stream:e});t.write({type:Ts.Type.CAN_HOP});let i=await t.read();return await t.close(),!(!i||i.code!==Ts.Status.SUCCESS)}function NQe({connection:r,streamHandler:e,circuit:t}){let i=t._options.hop.enabled;Lu("can hop (%s) request from %s",i,r.remotePeer.toB58String()),e.end({type:Ts.Type.STATUS,code:i?Ts.Status.SUCCESS:Ts.Status.HOP_CANT_SPEAK_RELAY})}e2e.exports={handleHop:OQe,hop:kQe,canHop:DQe,handleCanHop:NQe}});var o2e=m((ANt,s2e)=>{l();"use strict";var t2e=le(),Mu=Object.assign(t2e("libp2p:circuit"),{error:t2e("libp2p:circuit:err")}),BQe=br(),LQe=Kf(),{Multiaddr:Jm}=lt(),r2e=st(),{CircuitRelay:e3}=G1(),{codes:MQe}=wr(),i2e=Lye(),{relay:jQe}=Qm(),qQe=qye(),{handleCanHop:UQe,handleHop:FQe,hop:KQe}=_C(),{handleStop:VQe}=wC(),zQe=g_(),HQe=Symbol.for("@libp2p/js-libp2p-circuit/circuit"),n2e=class{constructor({libp2p:e,upgrader:t}){this._dialer=e.dialer,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._upgrader=t,this._options=e._config.relay,this._libp2p=e,this.peerId=e.peerId,this._registrar.handle(jQe,this._onProtocol.bind(this))}async _onProtocol({connection:e,stream:t}){let i=new zQe({stream:t}),n=await i.read();if(!n)return;let s=this,o;switch(n.type){case e3.Type.CAN_HOP:{Mu("received CAN_HOP request from %s",e.remotePeer.toB58String()),await UQe({circuit:s,connection:e,streamHandler:i});break}case e3.Type.HOP:{Mu("received HOP request from %s",e.remotePeer.toB58String()),o=await FQe({connection:e,request:n,streamHandler:i,circuit:s});break}case e3.Type.STOP:{Mu("received STOP request from %s",e.remotePeer.toB58String()),o=await VQe({connection:e,request:n,streamHandler:i});break}default:Mu("Request of type %s not supported",n.type)}if(o){let a=new Jm(n.dstPeer.addrs[0]),c=new Jm(n.srcPeer.addrs[0]),u=i2e({stream:o,remoteAddr:a,localAddr:c}),f=n.type===e3.Type.HOP?"relay":"inbound";Mu("new %s connection %s",f,u.remoteAddr);let d=await this._upgrader.upgradeInbound(u);Mu("%s connection %s upgraded",f,u.remoteAddr),this.handler&&this.handler(d)}}async dial(e,t){let i=e.toString().split("/p2p-circuit"),n=new Jm(i[0]),s=new Jm(i[i.length-1]),o=n.getPeerId(),a=s.getPeerId();if(!o||!a){let h="Circuit relay dial failed as addresses did not have peer id";throw Mu.error(h),BQe(new Error(h),MQe.ERR_RELAYED_DIAL)}let c=r2e.createFromB58String(o),u=r2e.createFromB58String(a),f=!1,d=this._connectionManager.get(c);d||(d=await this._dialer.connectToPeer(n,t),f=!0);try{let h=await KQe({connection:d,request:{type:e3.Type.HOP,srcPeer:{id:this.peerId.toBytes(),addrs:this._libp2p.multiaddrs.map(g=>g.bytes)},dstPeer:{id:u.toBytes(),addrs:[new Jm(s).bytes]}}}),p=n.encapsulate(`/p2p-circuit/p2p/${this.peerId.toB58String()}`),y=i2e({stream:h,remoteAddr:e,localAddr:p});return Mu("new outbound connection %s",y.remoteAddr),this._upgrader.upgradeOutbound(y)}catch(h){throw Mu.error("Circuit relay dial failed",h),f&&await d.close(),h}}createListener(e,t){return typeof e=="function"&&(t=e,e={}),this.handler=t,qQe(this._libp2p)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(t=>LQe.Circuit.matches(t))}get[Symbol.toStringTag](){return"Circuit"}static isTransport(e){return Boolean(e&&e[HQe])}};s2e.exports=n2e});var vC=m((RNt,a2e)=>{l();"use strict";var{CID:$Qe}=(we(),Kc),{sha256:GQe}=(Si(),Ks);a2e.exports.namespaceToCid=async r=>{let e=new TextEncoder().encode(r),t=await GQe.digest(e);return $Qe.createV0(t)}});var h2e=m((xNt,d2e)=>{l();"use strict";var c2e=le(),EC=Object.assign(c2e("libp2p:auto-relay"),{error:c2e("libp2p:auto-relay:err")}),{fromString:WQe}=(at(),Xr),{toString:YQe}=(et(),or),{Multiaddr:XQe}=lt(),QQe=Jo(),{relay:ZQe}=Qm(),{canHop:JQe}=_C(),{namespaceToCid:eZe}=vC(),{CIRCUIT_PROTO_CODE:tZe,HOP_METADATA_KEY:u2e,HOP_METADATA_VALUE:l2e,RELAY_RENDEZVOUS_NS:rZe}=l_(),f2e=class{constructor({libp2p:e,maxListeners:t=1,onError:i}){this._libp2p=e,this._peerId=e.peerId,this._peerStore=e.peerStore,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._addressSorter=e.dialer.addressSorter,this.maxListeners=t,this._listenRelays=new Set,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this._peerStore.on("change:protocols",this._onProtocolChange),this._connectionManager.on("peer:disconnect",this._onPeerDisconnected),this._onError=(n,s)=>{EC.error(s||n),i&&i(n,s)}}async _onProtocolChange({peerId:e,protocols:t}){let i=e.toB58String(),n=t.find(s=>s===ZQe);if(!n&&this._listenRelays.has(i)){await this._removeListenRelay(i);return}else if(!n||this._listenRelays.has(i))return;try{let s=this._connectionManager.get(e);if(!s)return;if(s.remoteAddr.protoCodes().includes(tZe)){EC(`relayed connection to ${i} will not be used to hop on`);return}await JQe({connection:s})&&(await this._peerStore.metadataBook.setValue(e,u2e,WQe(l2e)),await this._addListenRelay(s,i))}catch(s){this._onError(s)}}_onPeerDisconnected(e){let i=e.remotePeer.toB58String();!this._listenRelays.has(i)||this._removeListenRelay(i).catch(n=>{EC.error(n)})}async _addListenRelay(e,t){try{if(this._listenRelays.size>=this.maxListeners)return;let i=await this._peerStore.addressBook.getMultiaddrsForPeer(e.remotePeer,this._addressSorter);(await Promise.all(i.map(async s=>{try{return await this._transportManager.listen([new XQe(`${s.toString()}/p2p-circuit`)]),!0}catch(o){this._onError(o)}return!1}))).includes(!0)&&this._listenRelays.add(t)}catch(i){this._onError(i),this._listenRelays.delete(t)}}async _removeListenRelay(e){this._listenRelays.delete(e)&&await this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this._listenRelays.size>=this.maxListeners)return;let t=[],i=await QQe(this._peerStore.getPeers());for await(let{id:n,metadata:s}of i){let o=n.toB58String();if(this._listenRelays.has(o)||e.includes(o))continue;let a=s.get(u2e);if(!a||YQe(a)!==l2e)continue;let c=this._connectionManager.get(n);if(!c){t.push(n);continue}if(await this._addListenRelay(c,o),this._listenRelays.size>=this.maxListeners)return}for(let n of t)if(await this._tryToListenOnRelay(n),this._listenRelays.size>=this.maxListeners)return;try{let n=await eZe(rZe);for await(let s of this._libp2p.contentRouting.findProviders(n)){if(!s.multiaddrs.length)continue;let o=s.id;if(await this._peerStore.addressBook.add(o,s.multiaddrs),await this._tryToListenOnRelay(o),this._listenRelays.size>=this.maxListeners)return}}catch(n){this._onError(n)}}async _tryToListenOnRelay(e){try{let t=await this._libp2p.dial(e);await this._addListenRelay(t,e.toB58String())}catch(t){this._onError(t,`could not connect and listen on known hop relay ${e.toB58String()}`)}}};d2e.exports=f2e});var b2e=m((INt,m2e)=>{l();"use strict";var p2e=le(),y2e=Object.assign(p2e("libp2p:relay"),{error:p2e("libp2p:relay:err")}),{codes:iZe}=wr(),{setDelayedInterval:nZe,clearDelayedInterval:sZe}=rC(),oZe=h2e(),{namespaceToCid:aZe}=vC(),{RELAY_RENDEZVOUS_NS:cZe}=l_(),g2e=class{constructor(e){this._libp2p=e,this._options={...e._config.relay},this._autoRelay=this._options.autoRelay.enabled&&new oZe({libp2p:e,...this._options.autoRelay}),this._advertiseService=this._advertiseService.bind(this)}start(){this._options.hop.enabled&&this._options.advertise.enabled&&(this._timeout=nZe(this._advertiseService,this._options.advertise.ttl,this._options.advertise.bootDelay))}stop(){sZe(this._timeout)}async _advertiseService(){try{let e=await aZe(cZe);await this._libp2p.contentRouting.provide(e)}catch(e){e.code===iZe.ERR_NO_ROUTERS_AVAILABLE?(y2e.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),this.stop()):y2e.error(e)}}};m2e.exports=g2e});var E2e=m((PNt,v2e)=>{l();var w2e=k9(),_2e=ec();v2e.exports=class{constructor(){this._buffer=new w2e,this._waitingConsumers=new w2e}push(e){let{promise:t,resolve:i}=_2e();return this._buffer.push({chunk:e,resolve:i}),this._consume(),t}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let e=this._waitingConsumers.shift(),t=this._buffer.shift();e.resolve(t.chunk),t.resolve()}}shift(){let{promise:e,resolve:t}=_2e();return this._waitingConsumers.push({resolve:t}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}});var S2e=m((CNt,AC)=>{l();"use strict";var SC=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},t3=class{static fn(e){return(...t)=>new t3((i,n,s)=>{t.push(s),e(...t).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((t,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,t(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let t of this._cancelHandlers)t()}catch(t){this._reject(t);return}this._rejectOnCancel&&this._reject(new SC(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(t3.prototype,Promise.prototype);AC.exports=t3;AC.exports.CancelError=SC});var R2e=m((ONt,m_)=>{l();"use strict";var A2e=JP(),uZe=S2e(),RC=class extends Error{},lZe=(r,e)=>new uZe((t,i,n)=>{let{count:s,filter:o=()=>!0}=e;if(!Number.isFinite(s)){i(new TypeError(`Expected a finite number, got ${typeof e.count}`));return}let a=[],c=[],u=0,f=!1,d=new Set,h=()=>(a.length===s&&(t(a),f=!0),u-c.length<s&&(i(new A2e(c)),f=!0),f),p=()=>{for(let y of r)!d.has(y)&&typeof y.cancel=="function"&&y.cancel()};n(p);for(let y of r)u++,(async()=>{try{let g=await y;if(f)return;if(!o(g))throw new RC("Value does not satisfy filter");a.push(g)}catch(g){c.push(g)}finally{d.add(y),!f&&h()&&p()}})();s>u&&(i(new RangeError(`Expected input to contain at least ${e.count} items, but contains ${u} items`)),p())});m_.exports=lZe;m_.exports.AggregateError=A2e;m_.exports.FilterError=RC});var x2e=m((kNt,IC)=>{l();"use strict";var xC=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},r3=class{static fn(e){return(...t)=>new r3((i,n,s)=>{t.push(s),e(...t).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((t,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,t(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let t of this._cancelHandlers)t()}catch(t){this._reject(t);return}this._rejectOnCancel&&this._reject(new xC(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(r3.prototype,Promise.prototype);IC.exports=r3;IC.exports.CancelError=xC});var T2e=m((DNt,TC)=>{l();"use strict";var I2e=R2e(),fZe=x2e();TC.exports=(r,e)=>{let t=I2e(r,{...e,count:1});return fZe.fn(async i=>{i(()=>{t.cancel()});let[n]=await t;return n})()};TC.exports.AggregateError=I2e.AggregateError});var k2e=m((NNt,O2e)=>{l();"use strict";var dZe=br(),{anySignal:hZe}=$o(),pZe=E2e(),yZe=T2e(),{setMaxListeners:P2e}=Ut(),{codes:gZe}=wr(),C2e=class{constructor({addrs:e,dialAction:t,dialer:i}){this.addrs=e,this.dialer=i,this.dialAction=t}async run(e={}){let t=this.dialer.getTokens(this.addrs.length);if(t.length<1)throw dZe(new Error("No dial tokens available"),gZe.ERR_NO_DIAL_TOKENS);let i=new pZe;t.forEach(o=>i.push(o));let n=this.addrs.map(()=>{let o=new AbortController;try{P2e&&P2e(1/0,o.signal)}catch{}return o}),s=0;try{return await yZe(this.addrs.map(async(o,a)=>{let c=await i.shift(),u;try{let f=n[a].signal;u=await this.dialAction(o,{...e,signal:e.signal?hZe([f,e.signal]):f}),n.splice(a,1)}finally{s++,this.addrs.length-s>=t.length?i.push(c):this.dialer.releaseToken(t.splice(t.indexOf(c),1)[0])}return u}))}finally{n.map(o=>o.abort()),t.forEach(o=>this.dialer.releaseToken(o))}}};O2e.exports=C2e});var U2e=m((BNt,q2e)=>{l();"use strict";var D2e=le(),mZe=Jo(),bZe=is(),{pipe:wZe}=dr(),W1=Object.assign(D2e("libp2p:dialer"),{error:D2e("libp2p:dialer:err")}),b_=br(),{Multiaddr:PC}=lt(),{TimeoutController:_Ze}=Ma(),{AbortError:vZe}=fa(),{anySignal:EZe}=$o(),{setMaxListeners:N2e}=Ut(),SZe=k2e(),{publicAddressesFirst:AZe}=oC(),B2e=iC(),L2e=xh(),{codes:i3}=wr(),{DIAL_TIMEOUT:RZe,MAX_PARALLEL_DIALS:xZe,MAX_PER_PEER_DIALS:IZe,MAX_ADDRS_TO_DIAL:TZe}=u_(),M2e="dialler",PZe="pending-dials",CZe="pending-dial-targets",j2e=class{constructor({transportManager:e,peerStore:t,connectionGater:i,addressSorter:n=AZe,maxParallelDials:s=xZe,maxAddrsToDial:o=TZe,dialTimeout:a=RZe,maxDialsPerPeer:c=IZe,resolvers:u={},metrics:f}){this.connectionGater=i,this.transportManager=e,this.peerStore=t,this.addressSorter=n,this.maxParallelDials=s,this.maxAddrsToDial=o,this.timeout=a,this.maxDialsPerPeer=c,this.tokens=[...new Array(s)].map((d,h)=>h),this._pendingDials=L2e({component:M2e,metric:PZe,metrics:f}),this._pendingDialTargets=L2e({component:M2e,metric:CZe,metrics:f});for(let[d,h]of Object.entries(u))PC.resolvers.set(d,h)}destroy(){for(let e of this._pendingDials.values())try{e.controller.abort()}catch(t){W1.error(t)}this._pendingDials.clear();for(let e of this._pendingDialTargets.values())e.reject(new vZe("Dialer was destroyed"));this._pendingDialTargets.clear()}async connectToPeer(e,t={}){let{id:i}=B2e(e);if(await this.connectionGater.denyDialPeer(i))throw b_(new Error("The dial request is blocked by gater.allowDialPeer"),i3.ERR_PEER_DIAL_INTERCEPTED);let n=await this._createCancellableDialTarget(e);if(!n.addrs.length)throw b_(new Error("The dial request has no valid addresses"),i3.ERR_NO_VALID_ADDRESSES);let s=this._pendingDials.get(n.id)||this._createPendingDial(n,t);try{let o=await s.promise;return W1("dial succeeded to %s",n.id),o}catch(o){throw s.controller.signal.aborted&&(o.code=i3.ERR_TIMEOUT),W1.error(o),o}finally{s.destroy()}}async _createCancellableDialTarget(e){let t=`${parseInt(String(Math.random()*1e9),10).toString()+Date.now()}`,i=new Promise((n,s)=>{this._pendingDialTargets.set(t,{resolve:n,reject:s})});try{return await Promise.race([this._createDialTarget(e),i])}finally{this._pendingDialTargets.delete(t)}}async _createDialTarget(e){let{id:t,multiaddrs:i}=B2e(e);i&&await this.peerStore.addressBook.add(t,i);let n=await wZe(await this.peerStore.addressBook.getMultiaddrsForPeer(t,this.addressSorter),a=>bZe(a,async c=>!await this.connectionGater.denyDialMultiaddr(t,c)),a=>mZe(a));PC.isMultiaddr(e)&&(n=n.filter(a=>!e.equals(a)),n.unshift(e));let s=[];for(let a of n)(await this._resolve(a)).forEach(u=>s.push(u));let o=s.filter(a=>this.transportManager.transportForMultiaddr(a));if(o.length>this.maxAddrsToDial)throw await this.peerStore.delete(t),b_(new Error("dial with more addresses than allowed"),i3.ERR_TOO_MANY_ADDRESSES);return{id:t.toB58String(),addrs:o}}_createPendingDial(e,t={}){let i=(u,f)=>{if(f.signal.aborted)throw b_(new Error("already aborted"),i3.ERR_ALREADY_ABORTED);return this.transportManager.dial(u,f)},n=new SZe({addrs:e.addrs,dialAction:i,dialer:this}),s=new _Ze(this.timeout),o=[s.signal];t.signal&&o.push(t.signal);let a=EZe(o);try{N2e&&N2e(1/0,a)}catch{}let c={dialRequest:n,controller:s,promise:n.run({...t,signal:a}),destroy:()=>{s.clear(),this._pendingDials.delete(e.id)}};return this._pendingDials.set(e.id,c),c}getTokens(e){let t=Math.min(e,this.maxDialsPerPeer,this.tokens.length),i=this.tokens.splice(0,t);return W1("%d tokens request, returning %d, %d remaining",e,t,this.tokens.length),i}releaseToken(e){this.tokens.indexOf(e)>-1||(W1("token %d released",e),this.tokens.push(e))}async _resolve(e){if(!e.protoNames().includes("dnsaddr"))return[e];let i=await this._resolveRecord(e);return(await Promise.all(i.map(o=>this._resolve(o)))).flat().reduce((o,a)=>(o.find(c=>c.equals(a))||o.push(a),o),[])}async _resolveRecord(e){try{return e=new PC(e.toString()),await e.resolve()}catch(t){return W1.error(`multiaddr ${e} could not be resolved`),[]}}};q2e.exports=j2e});var K2e=m((LNt,F2e)=>{l();"use strict";function OZe(r){return r>=55296&&r<=56319}function kZe(r){return r>=56320&&r<=57343}F2e.exports=function(e,t,i){if(typeof t!="string")throw new Error("Input must be string");for(var n=t.length,s=0,o,a,c=0;c<n;c+=1){if(o=t.charCodeAt(c),a=t[c],OZe(o)&&kZe(t.charCodeAt(c+1))&&(c+=1,a+=t[c]),s+=e(a),s===i)return t.slice(0,c+1);if(s>i)return t.slice(0,c-a.length+1)}return t}});var z2e=m((MNt,V2e)=>{l();"use strict";function DZe(r){return r>=55296&&r<=56319}function NZe(r){return r>=56320&&r<=57343}V2e.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var t=e.length,i=0,n=null,s=null,o=0;o<t;o++)n=e.charCodeAt(o),NZe(n)?s!=null&&DZe(s)?i+=1:i+=3:n<=127?i+=1:n>=128&&n<=2047?i+=2:n>=2048&&n<=65535&&(i+=3),s=n;return i}});var $2e=m((jNt,H2e)=>{l();"use strict";var BZe=K2e(),LZe=z2e();H2e.exports=BZe.bind(null,LZe)});var Y2e=m((qNt,W2e)=>{l();"use strict";var MZe=$2e(),jZe=/[\/\?<>\\:\*\|"]/g,qZe=/[\x00-\x1f\x80-\x9f]/g,UZe=/^\.+$/,FZe=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,KZe=/[\. ]+$/;function G2e(r,e){if(typeof r!="string")throw new Error("Input must be string");var t=r.replace(jZe,e).replace(qZe,e).replace(UZe,e).replace(FZe,e).replace(KZe,e);return MZe(t,255)}W2e.exports=function(r,e){var t=e&&e.replacement||"",i=G2e(r,t);return t===""?i:G2e(i,"")}});var J2e=m((UNt,Z2e)=>{l();var Y1=At();fl();vr();var Oe=Y1.asn1,X1=Z2e.exports=Y1.pkcs7asn1=Y1.pkcs7asn1||{};Y1.pkcs7=Y1.pkcs7||{};Y1.pkcs7.asn1=X1;var X2e={name:"ContentInfo",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:Oe.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};X1.contentInfoValidator=X2e;var Q2e={name:"EncryptedContentInfo",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:Oe.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:Oe.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};X1.envelopedDataValidator={name:"EnvelopedData",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(Q2e)};X1.encryptedDataValidator={name:"EncryptedData",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.INTEGER,constructed:!1,capture:"version"}].concat(Q2e)};var VZe={name:"SignerInfo",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:Oe.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:Oe.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:Oe.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};X1.signedDataValidator={name:"SignedData",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},X2e,{name:"SignedData.Certificates",tagClass:Oe.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:Oe.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SET,capture:"signerInfos",optional:!0,value:[VZe]}]};X1.recipientInfoValidator={name:"RecipientInfo",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:Oe.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:Oe.Class.UNIVERSAL,type:Oe.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var tge=m((FNt,ege)=>{l();var Ph=At();vr();Ph.mgf=Ph.mgf||{};var zZe=ege.exports=Ph.mgf.mgf1=Ph.mgf1=Ph.mgf1||{};zZe.create=function(r){var e={generate:function(t,i){for(var n=new Ph.util.ByteBuffer,s=Math.ceil(i/r.digestLength),o=0;o<s;o++){var a=new Ph.util.ByteBuffer;a.putInt32(o),r.start(),r.update(t+a.getBytes()),n.putBuffer(r.digest())}return n.truncate(n.length()-i),n.getBytes()}};return e}});var ige=m((KNt,rge)=>{l();var w_=At();tge();rge.exports=w_.mgf=w_.mgf||{};w_.mgf.mgf1=w_.mgf1});var sge=m((VNt,nge)=>{l();var Ch=At();Gf();vr();var HZe=nge.exports=Ch.pss=Ch.pss||{};HZe.create=function(r){arguments.length===3&&(r={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=r.md,t=r.mgf,i=e.digestLength,n=r.salt||null;typeof n=="string"&&(n=Ch.util.createBuffer(n));var s;if("saltLength"in r)s=r.saltLength;else if(n!==null)s=n.length();else throw new Error("Salt length not specified or specific salt not given.");if(n!==null&&n.length()!==s)throw new Error("Given salt length does not match length of given salt.");var o=r.prng||Ch.random,a={};return a.encode=function(c,u){var f,d=u-1,h=Math.ceil(d/8),p=c.digest().getBytes();if(h<i+s+2)throw new Error("Message is too long to encrypt.");var y;n===null?y=o.getBytesSync(s):y=n.bytes();var g=new Ch.util.ByteBuffer;g.fillWithByte(0,8),g.putBytes(p),g.putBytes(y),e.start(),e.update(g.getBytes());var w=e.digest().getBytes(),b=new Ch.util.ByteBuffer;b.fillWithByte(0,h-s-i-2),b.putByte(1),b.putBytes(y);var v=b.getBytes(),R=h-i-1,k=t.generate(w,R),C="";for(f=0;f<R;f++)C+=String.fromCharCode(v.charCodeAt(f)^k.charCodeAt(f));var T=65280>>8*h-d&255;return C=String.fromCharCode(C.charCodeAt(0)&~T)+C.substr(1),C+w+String.fromCharCode(188)},a.verify=function(c,u,f){var d,h=f-1,p=Math.ceil(h/8);if(u=u.substr(-p),p<i+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(p-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var y=p-i-1,g=u.substr(0,y),w=u.substr(y,i),b=65280>>8*p-h&255;if((g.charCodeAt(0)&b)!=0)throw new Error("Bits beyond keysize not zero as expected.");var v=t.generate(w,y),R="";for(d=0;d<y;d++)R+=String.fromCharCode(g.charCodeAt(d)^v.charCodeAt(d));R=String.fromCharCode(R.charCodeAt(0)&~b)+R.substr(1);var k=p-i-s-2;for(d=0;d<k;d++)if(R.charCodeAt(d)!==0)throw new Error("Leftmost octets not zero as expected");if(R.charCodeAt(k)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var C=R.substr(-s),T=new Ch.util.ByteBuffer;T.fillWithByte(0,8),T.putBytes(c),T.putBytes(C),e.start(),e.update(T.getBytes());var D=e.digest().getBytes();return w===D},a}});var OC=m((zNt,lge)=>{l();var Je=At();kp();fl();L4();dl();ige();Pp();U4();sge();r2();vr();var S=Je.asn1,ve=lge.exports=Je.pki=Je.pki||{},Kt=ve.oids,ai={};ai.CN=Kt.commonName;ai.commonName="CN";ai.C=Kt.countryName;ai.countryName="C";ai.L=Kt.localityName;ai.localityName="L";ai.ST=Kt.stateOrProvinceName;ai.stateOrProvinceName="ST";ai.O=Kt.organizationName;ai.organizationName="O";ai.OU=Kt.organizationalUnitName;ai.organizationalUnitName="OU";ai.E=Kt.emailAddress;ai.emailAddress="E";var oge=Je.pki.rsa.publicKeyValidator,$Ze={name:"Certificate",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:S.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:S.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:S.Class.UNIVERSAL,type:S.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:S.Class.UNIVERSAL,type:S.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:S.Class.UNIVERSAL,type:S.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:S.Class.UNIVERSAL,type:S.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},oge,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:S.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:S.Class.UNIVERSAL,type:S.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:S.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:S.Class.UNIVERSAL,type:S.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:S.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:S.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:S.Class.UNIVERSAL,type:S.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},GZe={name:"rsapss",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:S.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:S.Class.UNIVERSAL,type:S.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:S.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:S.Class.UNIVERSAL,type:S.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:S.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:S.Class.UNIVERSAL,type:S.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:S.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:S.Class.UNIVERSAL,type:S.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},WZe={name:"CertificationRequestInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},oge,{name:"CertificationRequestInfo.attributes",tagClass:S.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:S.Class.UNIVERSAL,type:S.Type.SET,constructed:!0}]}]}]},YZe={name:"CertificationRequest",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[WZe,{name:"CertificationRequest.signatureAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:S.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:S.Class.UNIVERSAL,type:S.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};ve.RDNAttributesAsArray=function(r,e){for(var t=[],i,n,s,o=0;o<r.value.length;++o){i=r.value[o];for(var a=0;a<i.value.length;++a)s={},n=i.value[a],s.type=S.derToOid(n.value[0].value),s.value=n.value[1].value,s.valueTagClass=n.value[1].type,s.type in Kt&&(s.name=Kt[s.type],s.name in ai&&(s.shortName=ai[s.name])),e&&(e.update(s.type),e.update(s.value)),t.push(s)}return t};ve.CRIAttributesAsArray=function(r){for(var e=[],t=0;t<r.length;++t)for(var i=r[t],n=S.derToOid(i.value[0].value),s=i.value[1].value,o=0;o<s.length;++o){var a={};if(a.type=n,a.value=s[o].value,a.valueTagClass=s[o].type,a.type in Kt&&(a.name=Kt[a.type],a.name in ai&&(a.shortName=ai[a.name])),a.type===Kt.extensionRequest){a.extensions=[];for(var c=0;c<a.value.length;++c)a.extensions.push(ve.certificateExtensionFromAsn1(a.value[c]))}e.push(a)}return e};function Af(r,e){typeof e=="string"&&(e={shortName:e});for(var t=null,i,n=0;t===null&&n<r.attributes.length;++n)i=r.attributes[n],(e.type&&e.type===i.type||e.name&&e.name===i.name||e.shortName&&e.shortName===i.shortName)&&(t=i);return t}var __=function(r,e,t){var i={};if(r!==Kt["RSASSA-PSS"])return i;t&&(i={hash:{algorithmOid:Kt.sha1},mgf:{algorithmOid:Kt.mgf1,hash:{algorithmOid:Kt.sha1}},saltLength:20});var n={},s=[];if(!S.validate(e,GZe,n,s)){var o=new Error("Cannot read RSASSA-PSS parameter block.");throw o.errors=s,o}return n.hashOid!==void 0&&(i.hash=i.hash||{},i.hash.algorithmOid=S.derToOid(n.hashOid)),n.maskGenOid!==void 0&&(i.mgf=i.mgf||{},i.mgf.algorithmOid=S.derToOid(n.maskGenOid),i.mgf.hash=i.mgf.hash||{},i.mgf.hash.algorithmOid=S.derToOid(n.maskGenHashOid)),n.saltLength!==void 0&&(i.saltLength=n.saltLength.charCodeAt(0)),i},v_=function(r){switch(Kt[r.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return Je.md.sha1.create();case"md5WithRSAEncryption":return Je.md.md5.create();case"sha256WithRSAEncryption":return Je.md.sha256.create();case"sha384WithRSAEncryption":return Je.md.sha384.create();case"sha512WithRSAEncryption":return Je.md.sha512.create();case"RSASSA-PSS":return Je.md.sha256.create();default:var e=new Error("Could not compute "+r.type+" digest. Unknown signature OID.");throw e.signatureOid=r.signatureOid,e}},age=function(r){var e=r.certificate,t;switch(e.signatureOid){case Kt.sha1WithRSAEncryption:case Kt.sha1WithRSASignature:break;case Kt["RSASSA-PSS"]:var i,n;if(i=Kt[e.signatureParameters.mgf.hash.algorithmOid],i===void 0||Je.md[i]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=i,s}if(n=Kt[e.signatureParameters.mgf.algorithmOid],n===void 0||Je.mgf[n]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=n,s}if(n=Je.mgf[n].create(Je.md[i].create()),i=Kt[e.signatureParameters.hash.algorithmOid],i===void 0||Je.md[i]===void 0){var s=new Error("Unsupported RSASSA-PSS hash function.");throw s.oid=e.signatureParameters.hash.algorithmOid,s.name=i,s}t=Je.pss.create(Je.md[i].create(),n,e.signatureParameters.saltLength);break}return e.publicKey.verify(r.md.digest().getBytes(),r.signature,t)};ve.certificateFromPem=function(r,e,t){var i=Je.pem.decode(r)[0];if(i.type!=="CERTIFICATE"&&i.type!=="X509 CERTIFICATE"&&i.type!=="TRUSTED CERTIFICATE"){var n=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=S.fromDer(i.body,t);return ve.certificateFromAsn1(s,e)};ve.certificateToPem=function(r,e){var t={type:"CERTIFICATE",body:S.toDer(ve.certificateToAsn1(r)).getBytes()};return Je.pem.encode(t,{maxline:e})};ve.publicKeyFromPem=function(r){var e=Je.pem.decode(r)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var t=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var i=S.fromDer(e.body);return ve.publicKeyFromAsn1(i)};ve.publicKeyToPem=function(r,e){var t={type:"PUBLIC KEY",body:S.toDer(ve.publicKeyToAsn1(r)).getBytes()};return Je.pem.encode(t,{maxline:e})};ve.publicKeyToRSAPublicKeyPem=function(r,e){var t={type:"RSA PUBLIC KEY",body:S.toDer(ve.publicKeyToRSAPublicKey(r)).getBytes()};return Je.pem.encode(t,{maxline:e})};ve.getPublicKeyFingerprint=function(r,e){e=e||{};var t=e.md||Je.md.sha1.create(),i=e.type||"RSAPublicKey",n;switch(i){case"RSAPublicKey":n=S.toDer(ve.publicKeyToRSAPublicKey(r)).getBytes();break;case"SubjectPublicKeyInfo":n=S.toDer(ve.publicKeyToAsn1(r)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}t.start(),t.update(n);var s=t.digest();if(e.encoding==="hex"){var o=s.toHex();return e.delimiter?o.match(/.{2}/g).join(e.delimiter):o}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};ve.certificationRequestFromPem=function(r,e,t){var i=Je.pem.decode(r)[0];if(i.type!=="CERTIFICATE REQUEST"){var n=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=S.fromDer(i.body,t);return ve.certificationRequestFromAsn1(s,e)};ve.certificationRequestToPem=function(r,e){var t={type:"CERTIFICATE REQUEST",body:S.toDer(ve.certificationRequestToAsn1(r)).getBytes()};return Je.pem.encode(t,{maxline:e})};ve.createCertificate=function(){var r={};return r.version=2,r.serialNumber="00",r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.validity={},r.validity.notBefore=new Date,r.validity.notAfter=new Date,r.issuer={},r.issuer.getField=function(e){return Af(r.issuer,e)},r.issuer.addField=function(e){Oo([e]),r.issuer.attributes.push(e)},r.issuer.attributes=[],r.issuer.hash=null,r.subject={},r.subject.getField=function(e){return Af(r.subject,e)},r.subject.addField=function(e){Oo([e]),r.subject.attributes.push(e)},r.subject.attributes=[],r.subject.hash=null,r.extensions=[],r.publicKey=null,r.md=null,r.setSubject=function(e,t){Oo(e),r.subject.attributes=e,delete r.subject.uniqueId,t&&(r.subject.uniqueId=t),r.subject.hash=null},r.setIssuer=function(e,t){Oo(e),r.issuer.attributes=e,delete r.issuer.uniqueId,t&&(r.issuer.uniqueId=t),r.issuer.hash=null},r.setExtensions=function(e){for(var t=0;t<e.length;++t)cge(e[t],{cert:r});r.extensions=e},r.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var t=null,i,n=0;t===null&&n<r.extensions.length;++n)i=r.extensions[n],(e.id&&i.id===e.id||e.name&&i.name===e.name)&&(t=i);return t},r.sign=function(e,t){r.md=t||Je.md.sha1.create();var i=Kt[r.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw n.algorithm=r.md.algorithm,n}r.signatureOid=r.siginfo.algorithmOid=i,r.tbsCertificate=ve.getTBSCertificate(r);var s=S.toDer(r.tbsCertificate);r.md.update(s.getBytes()),r.signature=e.sign(r.md)},r.verify=function(e){var t=!1;if(!r.issued(e)){var i=e.issuer,n=r.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=n.attributes,s.actualIssuer=i.attributes,s}var o=e.md;if(o===null){o=v_({signatureOid:e.signatureOid,type:"certificate"});var a=e.tbsCertificate||ve.getTBSCertificate(e),c=S.toDer(a);o.update(c.getBytes())}return o!==null&&(t=age({certificate:r,md:o,signature:e.signature})),t},r.isIssuer=function(e){var t=!1,i=r.issuer,n=e.subject;if(i.hash&&n.hash)t=i.hash===n.hash;else if(i.attributes.length===n.attributes.length){t=!0;for(var s,o,a=0;t&&a<i.attributes.length;++a)s=i.attributes[a],o=n.attributes[a],(s.type!==o.type||s.value!==o.value)&&(t=!1)}return t},r.issued=function(e){return e.isIssuer(r)},r.generateSubjectKeyIdentifier=function(){return ve.getPublicKeyFingerprint(r.publicKey,{type:"RSAPublicKey"})},r.verifySubjectKeyIdentifier=function(){for(var e=Kt.subjectKeyIdentifier,t=0;t<r.extensions.length;++t){var i=r.extensions[t];if(i.id===e){var n=r.generateSubjectKeyIdentifier().getBytes();return Je.util.hexToBytes(i.subjectKeyIdentifier)===n}}return!1},r};ve.certificateFromAsn1=function(r,e){var t={},i=[];if(!S.validate(r,$Ze,t,i)){var n=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw n.errors=i,n}var s=S.derToOid(t.publicKeyOid);if(s!==ve.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=ve.createCertificate();o.version=t.certVersion?t.certVersion.charCodeAt(0):0;var a=Je.util.createBuffer(t.certSerialNumber);o.serialNumber=a.toHex(),o.signatureOid=Je.asn1.derToOid(t.certSignatureOid),o.signatureParameters=__(o.signatureOid,t.certSignatureParams,!0),o.siginfo.algorithmOid=Je.asn1.derToOid(t.certinfoSignatureOid),o.siginfo.parameters=__(o.siginfo.algorithmOid,t.certinfoSignatureParams,!1),o.signature=t.certSignature;var c=[];if(t.certValidity1UTCTime!==void 0&&c.push(S.utcTimeToDate(t.certValidity1UTCTime)),t.certValidity2GeneralizedTime!==void 0&&c.push(S.generalizedTimeToDate(t.certValidity2GeneralizedTime)),t.certValidity3UTCTime!==void 0&&c.push(S.utcTimeToDate(t.certValidity3UTCTime)),t.certValidity4GeneralizedTime!==void 0&&c.push(S.generalizedTimeToDate(t.certValidity4GeneralizedTime)),c.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(c.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(o.validity.notBefore=c[0],o.validity.notAfter=c[1],o.tbsCertificate=t.tbsCertificate,e){o.md=v_({signatureOid:o.signatureOid,type:"certificate"});var u=S.toDer(o.tbsCertificate);o.md.update(u.getBytes())}var f=Je.md.sha1.create(),d=S.toDer(t.certIssuer);f.update(d.getBytes()),o.issuer.getField=function(y){return Af(o.issuer,y)},o.issuer.addField=function(y){Oo([y]),o.issuer.attributes.push(y)},o.issuer.attributes=ve.RDNAttributesAsArray(t.certIssuer),t.certIssuerUniqueId&&(o.issuer.uniqueId=t.certIssuerUniqueId),o.issuer.hash=f.digest().toHex();var h=Je.md.sha1.create(),p=S.toDer(t.certSubject);return h.update(p.getBytes()),o.subject.getField=function(y){return Af(o.subject,y)},o.subject.addField=function(y){Oo([y]),o.subject.attributes.push(y)},o.subject.attributes=ve.RDNAttributesAsArray(t.certSubject),t.certSubjectUniqueId&&(o.subject.uniqueId=t.certSubjectUniqueId),o.subject.hash=h.digest().toHex(),t.certExtensions?o.extensions=ve.certificateExtensionsFromAsn1(t.certExtensions):o.extensions=[],o.publicKey=ve.publicKeyFromAsn1(t.subjectPublicKeyInfo),o};ve.certificateExtensionsFromAsn1=function(r){for(var e=[],t=0;t<r.value.length;++t)for(var i=r.value[t],n=0;n<i.value.length;++n)e.push(ve.certificateExtensionFromAsn1(i.value[n]));return e};ve.certificateExtensionFromAsn1=function(r){var e={};if(e.id=S.derToOid(r.value[0].value),e.critical=!1,r.value[1].type===S.Type.BOOLEAN?(e.critical=r.value[1].value.charCodeAt(0)!==0,e.value=r.value[2].value):e.value=r.value[1].value,e.id in Kt){if(e.name=Kt[e.id],e.name==="keyUsage"){var t=S.fromDer(e.value),i=0,n=0;t.value.length>1&&(i=t.value.charCodeAt(1),n=t.value.length>2?t.value.charCodeAt(2):0),e.digitalSignature=(i&128)==128,e.nonRepudiation=(i&64)==64,e.keyEncipherment=(i&32)==32,e.dataEncipherment=(i&16)==16,e.keyAgreement=(i&8)==8,e.keyCertSign=(i&4)==4,e.cRLSign=(i&2)==2,e.encipherOnly=(i&1)==1,e.decipherOnly=(n&128)==128}else if(e.name==="basicConstraints"){var t=S.fromDer(e.value);t.value.length>0&&t.value[0].type===S.Type.BOOLEAN?e.cA=t.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;t.value.length>0&&t.value[0].type===S.Type.INTEGER?s=t.value[0].value:t.value.length>1&&(s=t.value[1].value),s!==null&&(e.pathLenConstraint=S.derToInteger(s))}else if(e.name==="extKeyUsage")for(var t=S.fromDer(e.value),o=0;o<t.value.length;++o){var a=S.derToOid(t.value[o].value);a in Kt?e[Kt[a]]=!0:e[a]=!0}else if(e.name==="nsCertType"){var t=S.fromDer(e.value),i=0;t.value.length>1&&(i=t.value.charCodeAt(1)),e.client=(i&128)==128,e.server=(i&64)==64,e.email=(i&32)==32,e.objsign=(i&16)==16,e.reserved=(i&8)==8,e.sslCA=(i&4)==4,e.emailCA=(i&2)==2,e.objCA=(i&1)==1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var c,t=S.fromDer(e.value),u=0;u<t.value.length;++u){c=t.value[u];var f={type:c.type,value:c.value};switch(e.altNames.push(f),c.type){case 1:case 2:case 6:break;case 7:f.ip=Je.util.bytesToIP(c.value);break;case 8:f.oid=S.derToOid(c.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var t=S.fromDer(e.value);e.subjectKeyIdentifier=Je.util.bytesToHex(t.value)}}return e};ve.certificationRequestFromAsn1=function(r,e){var t={},i=[];if(!S.validate(r,YZe,t,i)){var n=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw n.errors=i,n}var s=S.derToOid(t.publicKeyOid);if(s!==ve.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=ve.createCertificationRequest();if(o.version=t.csrVersion?t.csrVersion.charCodeAt(0):0,o.signatureOid=Je.asn1.derToOid(t.csrSignatureOid),o.signatureParameters=__(o.signatureOid,t.csrSignatureParams,!0),o.siginfo.algorithmOid=Je.asn1.derToOid(t.csrSignatureOid),o.siginfo.parameters=__(o.siginfo.algorithmOid,t.csrSignatureParams,!1),o.signature=t.csrSignature,o.certificationRequestInfo=t.certificationRequestInfo,e){o.md=v_({signatureOid:o.signatureOid,type:"certification request"});var a=S.toDer(o.certificationRequestInfo);o.md.update(a.getBytes())}var c=Je.md.sha1.create();return o.subject.getField=function(u){return Af(o.subject,u)},o.subject.addField=function(u){Oo([u]),o.subject.attributes.push(u)},o.subject.attributes=ve.RDNAttributesAsArray(t.certificationRequestInfoSubject,c),o.subject.hash=c.digest().toHex(),o.publicKey=ve.publicKeyFromAsn1(t.subjectPublicKeyInfo),o.getAttribute=function(u){return Af(o,u)},o.addAttribute=function(u){Oo([u]),o.attributes.push(u)},o.attributes=ve.CRIAttributesAsArray(t.certificationRequestInfoAttributes||[]),o};ve.createCertificationRequest=function(){var r={};return r.version=0,r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.subject={},r.subject.getField=function(e){return Af(r.subject,e)},r.subject.addField=function(e){Oo([e]),r.subject.attributes.push(e)},r.subject.attributes=[],r.subject.hash=null,r.publicKey=null,r.attributes=[],r.getAttribute=function(e){return Af(r,e)},r.addAttribute=function(e){Oo([e]),r.attributes.push(e)},r.md=null,r.setSubject=function(e){Oo(e),r.subject.attributes=e,r.subject.hash=null},r.setAttributes=function(e){Oo(e),r.attributes=e},r.sign=function(e,t){r.md=t||Je.md.sha1.create();var i=Kt[r.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw n.algorithm=r.md.algorithm,n}r.signatureOid=r.siginfo.algorithmOid=i,r.certificationRequestInfo=ve.getCertificationRequestInfo(r);var s=S.toDer(r.certificationRequestInfo);r.md.update(s.getBytes()),r.signature=e.sign(r.md)},r.verify=function(){var e=!1,t=r.md;if(t===null){t=v_({signatureOid:r.signatureOid,type:"certification request"});var i=r.certificationRequestInfo||ve.getCertificationRequestInfo(r),n=S.toDer(i);t.update(n.getBytes())}return t!==null&&(e=age({certificate:r,md:t,signature:r.signature})),e},r};function Q1(r){for(var e=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]),t,i,n=r.attributes,s=0;s<n.length;++s){t=n[s];var o=t.value,a=S.Type.PRINTABLESTRING;"valueTagClass"in t&&(a=t.valueTagClass,a===S.Type.UTF8&&(o=Je.util.encodeUtf8(o))),i=S.create(S.Class.UNIVERSAL,S.Type.SET,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(t.type).getBytes()),S.create(S.Class.UNIVERSAL,a,!1,o)])]),e.value.push(i)}return e}function Oo(r){for(var e,t=0;t<r.length;++t){if(e=r[t],typeof e.name=="undefined"&&(e.type&&e.type in ve.oids?e.name=ve.oids[e.type]:e.shortName&&e.shortName in ai&&(e.name=ve.oids[ai[e.shortName]])),typeof e.type=="undefined")if(e.name&&e.name in ve.oids)e.type=ve.oids[e.name];else{var i=new Error("Attribute type not specified.");throw i.attribute=e,i}if(typeof e.shortName=="undefined"&&e.name&&e.name in ai&&(e.shortName=ai[e.name]),e.type===Kt.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=S.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var n=0;n<e.extensions.length;++n)e.value.push(ve.certificateExtensionToAsn1(cge(e.extensions[n])))}if(typeof e.value=="undefined"){var i=new Error("Attribute value not specified.");throw i.attribute=e,i}}}function cge(r,e){if(e=e||{},typeof r.name=="undefined"&&r.id&&r.id in ve.oids&&(r.name=ve.oids[r.id]),typeof r.id=="undefined")if(r.name&&r.name in ve.oids)r.id=ve.oids[r.name];else{var t=new Error("Extension ID not specified.");throw t.extension=r,t}if(typeof r.value!="undefined")return r;if(r.name==="keyUsage"){var i=0,n=0,s=0;r.digitalSignature&&(n|=128,i=7),r.nonRepudiation&&(n|=64,i=6),r.keyEncipherment&&(n|=32,i=5),r.dataEncipherment&&(n|=16,i=4),r.keyAgreement&&(n|=8,i=3),r.keyCertSign&&(n|=4,i=2),r.cRLSign&&(n|=2,i=1),r.encipherOnly&&(n|=1,i=0),r.decipherOnly&&(s|=128,i=7);var o=String.fromCharCode(i);s!==0?o+=String.fromCharCode(n)+String.fromCharCode(s):n!==0&&(o+=String.fromCharCode(n)),r.value=S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,o)}else if(r.name==="basicConstraints")r.value=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]),r.cA&&r.value.value.push(S.create(S.Class.UNIVERSAL,S.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in r&&r.value.value.push(S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(r.pathLenConstraint).getBytes()));else if(r.name==="extKeyUsage"){r.value=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);var a=r.value.value;for(var c in r)r[c]===!0&&(c in Kt?a.push(S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(Kt[c]).getBytes())):c.indexOf(".")!==-1&&a.push(S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(c).getBytes())))}else if(r.name==="nsCertType"){var i=0,n=0;r.client&&(n|=128,i=7),r.server&&(n|=64,i=6),r.email&&(n|=32,i=5),r.objsign&&(n|=16,i=4),r.reserved&&(n|=8,i=3),r.sslCA&&(n|=4,i=2),r.emailCA&&(n|=2,i=1),r.objCA&&(n|=1,i=0);var o=String.fromCharCode(i);n!==0&&(o+=String.fromCharCode(n)),r.value=S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,o)}else if(r.name==="subjectAltName"||r.name==="issuerAltName"){r.value=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);for(var u,f=0;f<r.altNames.length;++f){u=r.altNames[f];var o=u.value;if(u.type===7&&u.ip){if(o=Je.util.bytesFromIP(u.ip),o===null){var t=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw t.extension=r,t}}else u.type===8&&(u.oid?o=S.oidToDer(S.oidToDer(u.oid)):o=S.oidToDer(o));r.value.value.push(S.create(S.Class.CONTEXT_SPECIFIC,u.type,!1,o))}}else if(r.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(r.comment)||r.comment.length<1||r.comment.length>128)throw new Error('Invalid "nsComment" content.');r.value=S.create(S.Class.UNIVERSAL,S.Type.IA5STRING,!1,r.comment)}else if(r.name==="subjectKeyIdentifier"&&e.cert){var d=e.cert.generateSubjectKeyIdentifier();r.subjectKeyIdentifier=d.toHex(),r.value=S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,d.getBytes())}else if(r.name==="authorityKeyIdentifier"&&e.cert){r.value=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);var a=r.value.value;if(r.keyIdentifier){var h=r.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():r.keyIdentifier;a.push(S.create(S.Class.CONTEXT_SPECIFIC,0,!1,h))}if(r.authorityCertIssuer){var p=[S.create(S.Class.CONTEXT_SPECIFIC,4,!0,[Q1(r.authorityCertIssuer===!0?e.cert.issuer:r.authorityCertIssuer)])];a.push(S.create(S.Class.CONTEXT_SPECIFIC,1,!0,p))}if(r.serialNumber){var y=Je.util.hexToBytes(r.serialNumber===!0?e.cert.serialNumber:r.serialNumber);a.push(S.create(S.Class.CONTEXT_SPECIFIC,2,!1,y))}}else if(r.name==="cRLDistributionPoints"){r.value=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);for(var a=r.value.value,g=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]),w=S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[]),u,f=0;f<r.altNames.length;++f){u=r.altNames[f];var o=u.value;if(u.type===7&&u.ip){if(o=Je.util.bytesFromIP(u.ip),o===null){var t=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw t.extension=r,t}}else u.type===8&&(u.oid?o=S.oidToDer(S.oidToDer(u.oid)):o=S.oidToDer(o));w.value.push(S.create(S.Class.CONTEXT_SPECIFIC,u.type,!1,o))}g.value.push(S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[w])),a.push(g)}if(typeof r.value=="undefined"){var t=new Error("Extension value not specified.");throw t.extension=r,t}return r}function CC(r,e){switch(r){case Kt["RSASSA-PSS"]:var t=[];return e.hash.algorithmOid!==void 0&&t.push(S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(e.hash.algorithmOid).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&t.push(S.create(S.Class.CONTEXT_SPECIFIC,1,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(e.mgf.algorithmOid).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(e.mgf.hash.algorithmOid).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&t.push(S.create(S.Class.CONTEXT_SPECIFIC,2,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(e.saltLength).getBytes())])),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,t);default:return S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")}}function XZe(r){var e=S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[]);if(r.attributes.length===0)return e;for(var t=r.attributes,i=0;i<t.length;++i){var n=t[i],s=n.value,o=S.Type.UTF8;"valueTagClass"in n&&(o=n.valueTagClass),o===S.Type.UTF8&&(s=Je.util.encodeUtf8(s));var a=!1;"valueConstructed"in n&&(a=n.valueConstructed);var c=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(n.type).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SET,!0,[S.create(S.Class.UNIVERSAL,o,a,s)])]);e.value.push(c)}return e}var QZe=new Date("1950-01-01T00:00:00Z"),ZZe=new Date("2050-01-01T00:00:00Z");function uge(r){return r>=QZe&&r<ZZe?S.create(S.Class.UNIVERSAL,S.Type.UTCTIME,!1,S.dateToUtcTime(r)):S.create(S.Class.UNIVERSAL,S.Type.GENERALIZEDTIME,!1,S.dateToGeneralizedTime(r))}ve.getTBSCertificate=function(r){var e=uge(r.validity.notBefore),t=uge(r.validity.notAfter),i=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.CONTEXT_SPECIFIC,0,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(r.version).getBytes())]),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,Je.util.hexToBytes(r.serialNumber)),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(r.siginfo.algorithmOid).getBytes()),CC(r.siginfo.algorithmOid,r.siginfo.parameters)]),Q1(r.issuer),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[e,t]),Q1(r.subject),ve.publicKeyToAsn1(r.publicKey)]);return r.issuer.uniqueId&&i.value.push(S.create(S.Class.CONTEXT_SPECIFIC,1,!0,[S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,String.fromCharCode(0)+r.issuer.uniqueId)])),r.subject.uniqueId&&i.value.push(S.create(S.Class.CONTEXT_SPECIFIC,2,!0,[S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,String.fromCharCode(0)+r.subject.uniqueId)])),r.extensions.length>0&&i.value.push(ve.certificateExtensionsToAsn1(r.extensions)),i};ve.getCertificationRequestInfo=function(r){var e=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(r.version).getBytes()),Q1(r.subject),ve.publicKeyToAsn1(r.publicKey),XZe(r)]);return e};ve.distinguishedNameToAsn1=function(r){return Q1(r)};ve.certificateToAsn1=function(r){var e=r.tbsCertificate||ve.getTBSCertificate(r);return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[e,S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(r.signatureOid).getBytes()),CC(r.signatureOid,r.signatureParameters)]),S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,String.fromCharCode(0)+r.signature)])};ve.certificateExtensionsToAsn1=function(r){var e=S.create(S.Class.CONTEXT_SPECIFIC,3,!0,[]),t=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);e.value.push(t);for(var i=0;i<r.length;++i)t.value.push(ve.certificateExtensionToAsn1(r[i]));return e};ve.certificateExtensionToAsn1=function(r){var e=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);e.value.push(S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(r.id).getBytes())),r.critical&&e.value.push(S.create(S.Class.UNIVERSAL,S.Type.BOOLEAN,!1,String.fromCharCode(255)));var t=r.value;return typeof r.value!="string"&&(t=S.toDer(t).getBytes()),e.value.push(S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,t)),e};ve.certificationRequestToAsn1=function(r){var e=r.certificationRequestInfo||ve.getCertificationRequestInfo(r);return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[e,S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(r.signatureOid).getBytes()),CC(r.signatureOid,r.signatureParameters)]),S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,String.fromCharCode(0)+r.signature)])};ve.createCaStore=function(r){var e={certs:{}};e.getIssuer=function(o){var a=t(o.issuer);return a},e.addCertificate=function(o){if(typeof o=="string"&&(o=Je.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))if(o.subject.hash in e.certs){var a=e.certs[o.subject.hash];Je.util.isArray(a)||(a=[a]),a.push(o),e.certs[o.subject.hash]=a}else e.certs[o.subject.hash]=o},e.hasCertificate=function(o){typeof o=="string"&&(o=Je.pki.certificateFromPem(o));var a=t(o.subject);if(!a)return!1;Je.util.isArray(a)||(a=[a]);for(var c=S.toDer(ve.certificateToAsn1(o)).getBytes(),u=0;u<a.length;++u){var f=S.toDer(ve.certificateToAsn1(a[u])).getBytes();if(c===f)return!0}return!1},e.listAllCertificates=function(){var o=[];for(var a in e.certs)if(e.certs.hasOwnProperty(a)){var c=e.certs[a];if(!Je.util.isArray(c))o.push(c);else for(var u=0;u<c.length;++u)o.push(c[u])}return o},e.removeCertificate=function(o){var a;if(typeof o=="string"&&(o=Je.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))return null;var c=t(o.subject);if(!Je.util.isArray(c))return a=e.certs[o.subject.hash],delete e.certs[o.subject.hash],a;for(var u=S.toDer(ve.certificateToAsn1(o)).getBytes(),f=0;f<c.length;++f){var d=S.toDer(ve.certificateToAsn1(c[f])).getBytes();u===d&&(a=c[f],c.splice(f,1))}return c.length===0&&delete e.certs[o.subject.hash],a};function t(o){return i(o),e.certs[o.hash]||null}function i(o){if(!o.hash){var a=Je.md.sha1.create();o.attributes=ve.RDNAttributesAsArray(Q1(o),a),o.hash=a.digest().toHex()}}if(r)for(var n=0;n<r.length;++n){var s=r[n];e.addCertificate(s)}return e};ve.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};ve.verifyCertificateChain=function(r,e,t){typeof t=="function"&&(t={verify:t}),t=t||{},e=e.slice(0);var i=e.slice(0),n=t.validityCheckDate;typeof n=="undefined"&&(n=new Date);var s=!0,o=null,a=0;do{var c=e.shift(),u=null,f=!1;if(n&&(n<c.validity.notBefore||n>c.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:ve.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:n}),o===null){if(u=e[0]||r.getIssuer(c),u===null&&c.isIssuer(c)&&(f=!0,u=c),u){var d=u;Je.util.isArray(d)||(d=[d]);for(var h=!1;!h&&d.length>0;){u=d.shift();try{h=u.verify(c)}catch(C){}}h||(o={message:"Certificate signature is invalid.",error:ve.certificateError.bad_certificate})}o===null&&(!u||f)&&!r.hasCertificate(c)&&(o={message:"Certificate is not trusted.",error:ve.certificateError.unknown_ca})}if(o===null&&u&&!c.isIssuer(u)&&(o={message:"Certificate issuer is invalid.",error:ve.certificateError.bad_certificate}),o===null)for(var p={keyUsage:!0,basicConstraints:!0},y=0;o===null&&y<c.extensions.length;++y){var g=c.extensions[y];g.critical&&!(g.name in p)&&(o={message:"Certificate has an unsupported critical extension.",error:ve.certificateError.unsupported_certificate})}if(o===null&&(!s||e.length===0&&(!u||f))){var w=c.getExtension("basicConstraints"),b=c.getExtension("keyUsage");if(b!==null&&(!b.keyCertSign||w===null)&&(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:ve.certificateError.bad_certificate}),o===null&&w!==null&&!w.cA&&(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:ve.certificateError.bad_certificate}),o===null&&b!==null&&"pathLenConstraint"in w){var v=a-1;v>w.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:ve.certificateError.bad_certificate})}}var R=o===null?!0:o.error,k=t.verify?t.verify(R,a,i):R;if(k===!0)o=null;else throw R===!0&&(o={message:"The application rejected the certificate.",error:ve.certificateError.bad_certificate}),(k||k===0)&&(typeof k=="object"&&!Je.util.isArray(k)?(k.message&&(o.message=k.message),k.error&&(o.error=k.error)):typeof k=="string"&&(o.error=k)),o;s=!1,++a}while(e.length>0);return!0}});var hge=m((HNt,dge)=>{l();var Ie=At();kp();fl();L4();Pp();U4();J2e();Gf();vr();OC();var U=Ie.asn1,zn=dge.exports=Ie.pkcs7=Ie.pkcs7||{};zn.messageFromPem=function(r){var e=Ie.pem.decode(r)[0];if(e.type!=="PKCS7"){var t=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var i=U.fromDer(e.body);return zn.messageFromAsn1(i)};zn.messageToPem=function(r,e){var t={type:"PKCS7",body:U.toDer(r.toAsn1()).getBytes()};return Ie.pem.encode(t,{maxline:e})};zn.messageFromAsn1=function(r){var e={},t=[];if(!U.validate(r,zn.asn1.contentInfoValidator,e,t)){var i=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw i.errors=t,i}var n=U.derToOid(e.contentType),s;switch(n){case Ie.pki.oids.envelopedData:s=zn.createEnvelopedData();break;case Ie.pki.oids.encryptedData:s=zn.createEncryptedData();break;case Ie.pki.oids.signedData:s=zn.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+n+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};zn.createSignedData=function(){var r=null;return r={type:Ie.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(i){if(DC(r,i,zn.asn1.signedDataValidator),r.certificates=[],r.crls=[],r.digestAlgorithmIdentifiers=[],r.contentInfo=null,r.signerInfos=[],r.rawCapture.certificates)for(var n=r.rawCapture.certificates.value,s=0;s<n.length;++s)r.certificates.push(Ie.pki.certificateFromAsn1(n[s]))},toAsn1:function(){r.contentInfo||r.sign();for(var i=[],n=0;n<r.certificates.length;++n)i.push(Ie.pki.certificateToAsn1(r.certificates[n]));var s=[],o=U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(r.version).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SET,!0,r.digestAlgorithmIdentifiers),r.contentInfo])]);return i.length>0&&o.value[0].value.push(U.create(U.Class.CONTEXT_SPECIFIC,0,!0,i)),s.length>0&&o.value[0].value.push(U.create(U.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(U.create(U.Class.UNIVERSAL,U.Type.SET,!0,r.signerInfos)),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.type).getBytes()),o])},addSigner:function(i){var n=i.issuer,s=i.serialNumber;if(i.certificate){var o=i.certificate;typeof o=="string"&&(o=Ie.pki.certificateFromPem(o)),n=o.issuer.attributes,s=o.serialNumber}var a=i.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof a=="string"&&(a=Ie.pki.privateKeyFromPem(a));var c=i.digestAlgorithm||Ie.pki.oids.sha1;switch(c){case Ie.pki.oids.sha1:case Ie.pki.oids.sha256:case Ie.pki.oids.sha384:case Ie.pki.oids.sha512:case Ie.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var u=i.authenticatedAttributes||[];if(u.length>0){for(var f=!1,d=!1,h=0;h<u.length;++h){var p=u[h];if(!f&&p.type===Ie.pki.oids.contentType){if(f=!0,d)break;continue}if(!d&&p.type===Ie.pki.oids.messageDigest){if(d=!0,f)break;continue}}if(!f||!d)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}r.signers.push({key:a,version:1,issuer:n,serialNumber:s,digestAlgorithm:c,signatureAlgorithm:Ie.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(i){if(i=i||{},(typeof r.content!="object"||r.contentInfo===null)&&(r.contentInfo=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(Ie.pki.oids.data).getBytes())]),"content"in r)){var n;r.content instanceof Ie.util.ByteBuffer?n=r.content.bytes():typeof r.content=="string"&&(n=Ie.util.encodeUtf8(r.content)),i.detached?r.detachedContent=U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,n):r.contentInfo.value.push(U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,n)]))}if(r.signers.length!==0){var s=e();t(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(i){typeof i=="string"&&(i=Ie.pki.certificateFromPem(i)),r.certificates.push(i)},addCertificateRevokationList:function(i){throw new Error("PKCS#7 CRL support not yet implemented.")}},r;function e(){for(var i={},n=0;n<r.signers.length;++n){var s=r.signers[n],o=s.digestAlgorithm;o in i||(i[o]=Ie.md[Ie.pki.oids[o]].create()),s.authenticatedAttributes.length===0?s.md=i[o]:s.md=Ie.md[Ie.pki.oids[o]].create()}r.digestAlgorithmIdentifiers=[];for(var o in i)r.digestAlgorithmIdentifiers.push(U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(o).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")]));return i}function t(i){var n;if(r.detachedContent?n=r.detachedContent:(n=r.contentInfo.value[1],n=n.value[0]),!n)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=U.derToOid(r.contentInfo.value[0].value),o=U.toDer(n);o.getByte(),U.getBerValueLength(o),o=o.getBytes();for(var a in i)i[a].start().update(o);for(var c=new Date,u=0;u<r.signers.length;++u){var f=r.signers[u];if(f.authenticatedAttributes.length===0){if(s!==Ie.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{f.authenticatedAttributesAsn1=U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var d=U.create(U.Class.UNIVERSAL,U.Type.SET,!0,[]),h=0;h<f.authenticatedAttributes.length;++h){var p=f.authenticatedAttributes[h];p.type===Ie.pki.oids.messageDigest?p.value=i[f.digestAlgorithm].digest():p.type===Ie.pki.oids.signingTime&&(p.value||(p.value=c)),d.value.push(kC(p)),f.authenticatedAttributesAsn1.value.push(kC(p))}o=U.toDer(d).getBytes(),f.md.start().update(o)}f.signature=f.key.sign(f.md,"RSASSA-PKCS1-V1_5")}r.signerInfos=nJe(r.signers)}};zn.createEncryptedData=function(){var r=null;return r={type:Ie.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:Ie.pki.oids["aes256-CBC"]},fromAsn1:function(e){DC(r,e,zn.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(r.encryptedContent.key=e),fge(r)}},r};zn.createEnvelopedData=function(){var r=null;return r={type:Ie.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:Ie.pki.oids["aes256-CBC"]},fromAsn1:function(e){var t=DC(r,e,zn.asn1.envelopedDataValidator);r.recipients=tJe(t.recipientInfos.value)},toAsn1:function(){return U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.type).getBytes()),U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(r.version).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SET,!0,rJe(r.recipients)),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,sJe(r.encryptedContent))])])])},findRecipient:function(e){for(var t=e.issuer.attributes,i=0;i<r.recipients.length;++i){var n=r.recipients[i],s=n.issuer;if(n.serialNumber===e.serialNumber&&s.length===t.length){for(var o=!0,a=0;a<t.length;++a)if(s[a].type!==t[a].type||s[a].value!==t[a].value){o=!1;break}if(o)return n}}return null},decrypt:function(e,t){if(r.encryptedContent.key===void 0&&e!==void 0&&t!==void 0)switch(e.encryptedContent.algorithm){case Ie.pki.oids.rsaEncryption:case Ie.pki.oids.desCBC:var i=t.decrypt(e.encryptedContent.content);r.encryptedContent.key=Ie.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}fge(r)},addRecipient:function(e){r.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:Ie.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,t){if(r.encryptedContent.content===void 0){t=t||r.encryptedContent.algorithm,e=e||r.encryptedContent.key;var i,n,s;switch(t){case Ie.pki.oids["aes128-CBC"]:i=16,n=16,s=Ie.aes.createEncryptionCipher;break;case Ie.pki.oids["aes192-CBC"]:i=24,n=16,s=Ie.aes.createEncryptionCipher;break;case Ie.pki.oids["aes256-CBC"]:i=32,n=16,s=Ie.aes.createEncryptionCipher;break;case Ie.pki.oids["des-EDE3-CBC"]:i=24,n=8,s=Ie.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+t)}if(e===void 0)e=Ie.util.createBuffer(Ie.random.getBytes(i));else if(e.length()!=i)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+i+".");r.encryptedContent.algorithm=t,r.encryptedContent.key=e,r.encryptedContent.parameter=Ie.util.createBuffer(Ie.random.getBytes(n));var o=s(e);if(o.start(r.encryptedContent.parameter.copy()),o.update(r.content),!o.finish())throw new Error("Symmetric encryption failed.");r.encryptedContent.content=o.output}for(var a=0;a<r.recipients.length;++a){var c=r.recipients[a];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case Ie.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(r.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},r};function JZe(r){var e={},t=[];if(!U.validate(r,zn.asn1.recipientInfoValidator,e,t)){var i=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw i.errors=t,i}return{version:e.version.charCodeAt(0),issuer:Ie.pki.RDNAttributesAsArray(e.issuer),serialNumber:Ie.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:U.derToOid(e.encAlgorithm),parameter:e.encParameter?e.encParameter.value:void 0,content:e.encKey}}}function eJe(r){return U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(r.version).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[Ie.pki.distinguishedNameToAsn1({attributes:r.issuer}),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,Ie.util.hexToBytes(r.serialNumber))]),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.encryptedContent.algorithm).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")]),U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,r.encryptedContent.content)])}function tJe(r){for(var e=[],t=0;t<r.length;++t)e.push(JZe(r[t]));return e}function rJe(r){for(var e=[],t=0;t<r.length;++t)e.push(eJe(r[t]));return e}function iJe(r){var e=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(r.version).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[Ie.pki.distinguishedNameToAsn1({attributes:r.issuer}),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,Ie.util.hexToBytes(r.serialNumber))]),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.digestAlgorithm).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")])]);if(r.authenticatedAttributesAsn1&&e.value.push(r.authenticatedAttributesAsn1),e.value.push(U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.signatureAlgorithm).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")])),e.value.push(U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,r.signature)),r.unauthenticatedAttributes.length>0){for(var t=U.create(U.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<r.unauthenticatedAttributes.length;++i){var n=r.unauthenticatedAttributes[i];t.values.push(kC(n))}e.value.push(t)}return e}function nJe(r){for(var e=[],t=0;t<r.length;++t)e.push(iJe(r[t]));return e}function kC(r){var e;if(r.type===Ie.pki.oids.contentType)e=U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.value).getBytes());else if(r.type===Ie.pki.oids.messageDigest)e=U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,r.value.bytes());else if(r.type===Ie.pki.oids.signingTime){var t=new Date("1950-01-01T00:00:00Z"),i=new Date("2050-01-01T00:00:00Z"),n=r.value;if(typeof n=="string"){var s=Date.parse(n);isNaN(s)?n.length===13?n=U.utcTimeToDate(n):n=U.generalizedTimeToDate(n):n=new Date(s)}n>=t&&n<i?e=U.create(U.Class.UNIVERSAL,U.Type.UTCTIME,!1,U.dateToUtcTime(n)):e=U.create(U.Class.UNIVERSAL,U.Type.GENERALIZEDTIME,!1,U.dateToGeneralizedTime(n))}return U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.type).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SET,!0,[e])])}function sJe(r){return[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(Ie.pki.oids.data).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(r.algorithm).getBytes()),r.parameter?U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,r.parameter.getBytes()):void 0]),U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,r.content.getBytes())])]}function DC(r,e,t){var i={},n=[];if(!U.validate(e,t,i,n)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=U.derToOid(i.contentType);if(o!==Ie.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(i.encryptedContent){var a="";if(Ie.util.isArray(i.encryptedContent))for(var c=0;c<i.encryptedContent.length;++c){if(i.encryptedContent[c].type!==U.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=i.encryptedContent[c].value}else a=i.encryptedContent;r.encryptedContent={algorithm:U.derToOid(i.encAlgorithm),parameter:Ie.util.createBuffer(i.encParameter.value),content:Ie.util.createBuffer(a)}}if(i.content){var a="";if(Ie.util.isArray(i.content))for(var c=0;c<i.content.length;++c){if(i.content[c].type!==U.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=i.content[c].value}else a=i.content;r.content=Ie.util.createBuffer(a)}return r.version=i.version.charCodeAt(0),r.rawCapture=i,i}function fge(r){if(r.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(r.content===void 0){var e;switch(r.encryptedContent.algorithm){case Ie.pki.oids["aes128-CBC"]:case Ie.pki.oids["aes192-CBC"]:case Ie.pki.oids["aes256-CBC"]:e=Ie.aes.createDecryptionCipher(r.encryptedContent.key);break;case Ie.pki.oids.desCBC:case Ie.pki.oids["des-EDE3-CBC"]:e=Ie.des.createDecryptionCipher(r.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+r.encryptedContent.algorithm)}if(e.start(r.encryptedContent.parameter),e.update(r.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");r.content=e.output}}});var gge=m(($Nt,yge)=>{l();"use strict";OC();var oJe=At(),pge=oJe.pki,aJe=(r,e)=>{let t=pge.setRsaPublicKey(e.n,e.e),i=pge.createCertificate();i.publicKey=t,i.serialNumber="01",i.validity.notBefore=new Date,i.validity.notAfter=new Date,i.validity.notAfter.setFullYear(i.validity.notBefore.getFullYear()+10);let n=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:r.id}];return i.setSubject(n),i.setIssuer(n),i.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),i.sign(e),i};async function cJe(r,e){let t=r.map(e),n=(await Promise.all(t)).findIndex(s=>s);return r[n]}yge.exports={certificateForKey:aJe,findAsync:cJe}});var _ge=m((GNt,wge)=>{l();"use strict";hge();LE();var Rf=At(),{certificateForKey:uJe,findAsync:lJe}=gge(),Z1=br(),{fromString:mge}=(at(),Xr),{toString:fJe}=(et(),or),{codes:J1}=wr(),NC=new WeakMap,bge=class{constructor(e,t){if(!e)throw Z1(new Error("keychain is required"),J1.ERR_KEYCHAIN_REQUIRED);this.keychain=e,NC.set(this,{dek:t})}async encrypt(e,t){if(!(t instanceof Uint8Array))throw Z1(new Error("Plain data must be a Uint8Array"),J1.ERR_INVALID_PARAMETERS);let i=await this.keychain.findKeyByName(e),n=await this.keychain._getPrivateKey(e),s=NC.get(this).dek,o=Rf.pki.decryptRsaPrivateKey(n,s),a=await uJe(i,o),c=Rf.pkcs7.createEnvelopedData();c.addRecipient(a),c.content=Rf.util.createBuffer(t),c.encrypt();let u=Rf.asn1.toDer(c.toAsn1()).getBytes();return mge(u,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw Z1(new Error("CMS data is required"),J1.ERR_INVALID_PARAMETERS);let t;try{let u=Rf.util.createBuffer(fJe(e,"ascii")),f=Rf.asn1.fromDer(u);t=Rf.pkcs7.messageFromAsn1(f)}catch(u){throw Z1(new Error("Invalid CMS: "+u.message),J1.ERR_INVALID_CMS)}let i=t.recipients.filter(u=>u.issuer.find(f=>f.shortName==="O"&&f.value==="ipfs")).filter(u=>u.issuer.find(f=>f.shortName==="CN")).map(u=>({recipient:u,keyId:u.issuer.find(f=>f.shortName==="CN").value})),n=await lJe(i,async u=>{try{if(await this.keychain.findKeyById(u.keyId))return!0}catch(f){return!1}return!1});if(!n){let u=i.map(f=>f.keyId);throw Z1(new Error("Decryption needs one of the key(s): "+u.join(", ")),J1.ERR_MISSING_KEYS,{missingKeys:u})}let s=await this.keychain.findKeyById(n.keyId);if(!s)throw Z1(new Error("No key available to decrypto"),J1.ERR_NO_KEY);let o=await this.keychain._getPrivateKey(s.name),a=NC.get(this).dek,c=Rf.pki.decryptRsaPrivateKey(o,a);return t.decrypt(n.recipient,c),mge(t.content.getBytes(),"ascii")}};wge.exports=bge});var Ige=m((WNt,xge)=>{l();"use strict";var vge=le(),Ege=Object.assign(vge("libp2p:keychain"),{error:vge("libp2p:keychain:err")}),dJe=Y2e(),hJe=Ku(),Oh=Qa(),{Key:Sge}=(Mr(),Ap),pJe=_ge(),Hr=br(),{codes:$r}=wr(),{toString:kh}=(et(),or),{fromString:ju}=(at(),Xr);UE();var yJe="/pkcs8/",Age="/info/",xf=new WeakMap,Dh={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},BC={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function qu(r){return!r||typeof r!="string"?!1:r===dJe(r.trim())}async function nr(r){let e=200,t=1e3,i=Math.random()*(t-e)+e;throw await new Promise(n=>setTimeout(n,i)),r}function Cc(r){return new Sge(yJe+r)}function If(r){return new Sge(Age+r)}var Rge=class{constructor(e,t){if(!e)throw new Error("store is required");if(this.store=e,this.opts=hJe(BC,t),this.opts.pass&&this.opts.pass.length<20)throw new Error("pass must be least 20 characters");if(this.opts.dek.keyLength<Dh.minKeyLength)throw new Error(`dek.keyLength must be least ${Dh.minKeyLength} bytes`);if(this.opts.dek.salt.length<Dh.minSaltLength)throw new Error(`dek.saltLength must be least ${Dh.minSaltLength} bytes`);if(this.opts.dek.iterationCount<Dh.minIterationCount)throw new Error(`dek.iterationCount must be least ${Dh.minIterationCount}`);let i=this.opts.pass?Oh.pbkdf2(this.opts.pass,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";xf.set(this,{dek:i})}get cms(){return new pJe(this,xf.get(this).dek)}static generateOptions(){let e=Object.assign({},BC),t=Math.ceil(Dh.minSaltLength/3)*3;return e.dek.salt=kh(Oh.randomBytes(t),"base64"),e}static get options(){return BC}async createKey(e,t,i=2048){let n=this;if(!qu(e)||e==="self")return nr(Hr(new Error(`Invalid key name '${e}'`),$r.ERR_INVALID_KEY_NAME));if(typeof t!="string")return nr(Hr(new Error(`Invalid key type '${t}'`),$r.ERR_INVALID_KEY_TYPE));let s=Cc(e);if(await n.store.has(s))return nr(Hr(new Error(`Key '${e}' already exists`),$r.ERR_KEY_ALREADY_EXISTS));switch(t.toLowerCase()){case"rsa":if(!Number.isSafeInteger(i)||i<2048)return nr(Hr(new Error(`Invalid RSA key size ${i}`),$r.ERR_INVALID_KEY_SIZE));break;default:break}let a;try{let c=await Oh.keys.generateKeyPair(t,i),u=await c.id(),f=xf.get(this).dek,d=await c.export(f);a={name:e,id:u};let h=n.store.batch();h.put(s,ju(d)),h.put(If(e),ju(JSON.stringify(a))),await h.commit()}catch(c){return nr(c)}return a}async listKeys(){let e=this,t={prefix:Age},i=[];for await(let n of e.store.query(t))i.push(JSON.parse(kh(n.value)));return i}async findKeyById(e){try{return(await this.listKeys()).find(i=>i.id===e)}catch(t){return nr(t)}}async findKeyByName(e){if(!qu(e))return nr(Hr(new Error(`Invalid key name '${e}'`),$r.ERR_INVALID_KEY_NAME));let t=If(e);try{let i=await this.store.get(t);return JSON.parse(kh(i))}catch(i){return nr(Hr(new Error(`Key '${e}' does not exist. ${i.message}`),$r.ERR_KEY_NOT_FOUND))}}async removeKey(e){let t=this;if(!qu(e)||e==="self")return nr(Hr(new Error(`Invalid key name '${e}'`),$r.ERR_INVALID_KEY_NAME));let i=Cc(e),n=await t.findKeyByName(e),s=t.store.batch();return s.delete(i),s.delete(If(e)),await s.commit(),n}async renameKey(e,t){let i=this;if(!qu(e)||e==="self")return nr(Hr(new Error(`Invalid old key name '${e}'`),$r.ERR_OLD_KEY_NAME_INVALID));if(!qu(t)||t==="self")return nr(Hr(new Error(`Invalid new key name '${t}'`),$r.ERR_NEW_KEY_NAME_INVALID));let n=Cc(e),s=Cc(t),o=If(e),a=If(t);if(await i.store.has(s))return nr(Hr(new Error(`Key '${t}' already exists`),$r.ERR_KEY_ALREADY_EXISTS));try{let u=await i.store.get(n),f=await i.store.get(o),d=JSON.parse(kh(f));d.name=t;let h=i.store.batch();return h.put(s,u),h.put(a,ju(JSON.stringify(d))),h.delete(n),h.delete(o),await h.commit(),d}catch(u){return nr(u)}}async exportKey(e,t){if(!qu(e))return nr(Hr(new Error(`Invalid key name '${e}'`),$r.ERR_INVALID_KEY_NAME));if(!t)return nr(Hr(new Error("Password is required"),$r.ERR_PASSWORD_REQUIRED));let i=Cc(e);try{let n=await this.store.get(i),s=kh(n),o=xf.get(this).dek;return(await Oh.keys.import(s,o)).export(t)}catch(n){return nr(n)}}async importKey(e,t,i){let n=this;if(!qu(e)||e==="self")return nr(Hr(new Error(`Invalid key name '${e}'`),$r.ERR_INVALID_KEY_NAME));if(!t)return nr(Hr(new Error("PEM encoded key is required"),$r.ERR_PEM_REQUIRED));let s=Cc(e);if(await n.store.has(s))return nr(Hr(new Error(`Key '${e}' already exists`),$r.ERR_KEY_ALREADY_EXISTS));let a;try{a=await Oh.keys.import(t,i)}catch(d){return nr(Hr(new Error("Cannot read the key, most likely the password is wrong"),$r.ERR_CANNOT_READ_KEY))}let c;try{c=await a.id();let d=xf.get(this).dek;t=await a.export(d)}catch(d){return nr(d)}let u={name:e,id:c},f=n.store.batch();return f.put(s,ju(t)),f.put(If(e),ju(JSON.stringify(u))),await f.commit(),u}async importPeer(e,t){let i=this;if(!qu(e))return nr(Hr(new Error(`Invalid key name '${e}'`),$r.ERR_INVALID_KEY_NAME));if(!t||!t.privKey)return nr(Hr(new Error("Peer.privKey is required"),$r.ERR_MISSING_PRIVATE_KEY));let n=t.privKey,s=Cc(e);if(await i.store.has(s))return nr(Hr(new Error(`Key '${e}' already exists`),$r.ERR_KEY_ALREADY_EXISTS));try{let a=await n.id(),c=xf.get(this).dek,u=await n.export(c),f={name:e,id:a},d=i.store.batch();return d.put(s,ju(u)),d.put(If(e),ju(JSON.stringify(f))),await d.commit(),f}catch(a){return nr(a)}}async _getPrivateKey(e){if(!qu(e))return nr(Hr(new Error(`Invalid key name '${e}'`),$r.ERR_INVALID_KEY_NAME));try{let t=Cc(e),i=await this.store.get(t);return kh(i)}catch(t){return nr(Hr(new Error(`Key '${e}' does not exist. ${t.message}`),$r.ERR_KEY_NOT_FOUND))}}async rotateKeychainPass(e,t){if(typeof e!="string")return nr(Hr(new Error(`Invalid old pass type '${typeof e}'`),$r.ERR_INVALID_OLD_PASS_TYPE));if(typeof t!="string")return nr(Hr(new Error(`Invalid new pass type '${typeof t}'`),$r.ERR_INVALID_NEW_PASS_TYPE));if(t.length<20)return nr(Hr(new Error(`Invalid pass length ${t.length}`),$r.ERR_INVALID_PASS_LENGTH));Ege("recreating keychain");let i=xf.get(this).dek;this.opts.pass=t;let n=t?Oh.pbkdf2(t,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";xf.set(this,{dek:n});let s=await this.listKeys();for(let o of s){let a=await this.store.get(Cc(o.name)),c=kh(a),u=await Oh.keys.import(c,i),f=n.toString(),d=await u.export(f),h=this.store.batch(),p={name:o.name,id:o.id};h.put(Cc(o.name),ju(d)),h.put(If(o.name),ju(JSON.stringify(p))),await h.commit()}Ege("keychain reconstructed")}};xge.exports=Rge});var S_=m((E_,Tge)=>{l();(function(r,e){typeof E_=="object"&&typeof Tge!="undefined"?e(E_):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.streamingIterables={}))})(E_,function(r){"use strict";async function*e(x,B){let G=[];for await(let Z of B)G.push(Z),G.length===x&&(yield G,G=[]);G.length>0&&(yield G)}function*t(x,B){let G=[];for(let Z of B)G.push(Z),G.length===x&&(yield G,G=[]);G.length>0&&(yield G)}function i(x,B){return B===void 0?G=>i(x,G):B[Symbol.asyncIterator]?e(x,B):t(x,B)}let n=Symbol("TIMEOUT"),s=x=>{let B;return[new Promise(G=>{B=setTimeout(()=>G(n),x)}),()=>{clearTimeout(B)}]};async function*o(x,B,G){let Z=G[Symbol.asyncIterator](),he,Ne=[],He,Fe,Ke=()=>{it(),[He,Fe]=s(B)},it=()=>{Fe&&Fe(),He=void 0};for(he=Z.next();;){let Mt=await(He?Promise.race([he,He]):he);if(Mt===n||Mt.done){if(Ne.length&&(yield Ne,Ne=[]),it(),Mt!==n)break;continue}if(he=Z.next(),Ne.push(Mt.value),Ne.length===1&&Ke(),Ne.length===x){yield Ne,Ne=[],it();continue}}}function a(x,B,G){return G===void 0?Z=>a(x,B,Z):G[Symbol.asyncIterator]&&B!==1/0?o(x,B,G):i(x,G)}function c(x){if(typeof x.next=="function")return x;if(typeof x[Symbol.iterator]=="function")return x[Symbol.iterator]();if(typeof x[Symbol.asyncIterator]=="function")return x[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function u(){let x,B;return{promise:new Promise((Z,he)=>{B=Z,x=he}),reject:x,resolve:B}}function f(x,B){let G=c(B),Z=[],he=[],Ne=!1,He=!1;function Fe(){for(;he.length>0&&Z.length>0;){let ft=he.shift(),{error:_r,value:Nr}=Z.shift();_r?ft.reject(_r):ft.resolve({done:!1,value:Nr})}for(;he.length>0&&He;){let{resolve:ft}=he.shift();ft({done:!0,value:void 0})}}async function Ke(){if(!He&&!Ne&&!(Z.length>=x)){Ne=!0;try{let{done:ft,value:_r}=await G.next();ft?He=!0:Z.push({value:_r})}catch(ft){He=!0,Z.push({error:ft})}Fe(),Ne=!1,Ke()}}async function it(){if(Z.length>0){let{error:_r,value:Nr}=Z.shift();if(_r)throw _r;return Ke(),{done:!1,value:Nr}}if(He)return{done:!0,value:void 0};let ft=u();return he.push(ft),Ke(),ft.promise}let Mt={next:it,[Symbol.asyncIterator]:()=>Mt};return Mt}function*d(x,B){let G=[],Z;try{for(let he of B)G.push(he),!(G.length<=x)&&(yield G.shift())}catch(he){Z=he}for(let he of G)yield he;if(Z)throw Z}function h(x,B){return B===void 0?G=>h(x,G):x===0?B:B[Symbol.asyncIterator]?f(x,B):d(x,B)}async function p(x){let B=[];for await(let G of x)B.push(G);return B}function y(x){return x[Symbol.asyncIterator]?p(x):Array.from(x)}async function*g(x){for await(let B of x)yield*B}function*w(x){for(let B of x)yield*B}function b(...x){return x.find(G=>G[Symbol.asyncIterator]!==void 0)?g(x):w(x)}async function v(x){for await(let B of x);}function R(x){if(x[Symbol.asyncIterator])return v(x);for(let B of x);}async function*k(x,B){for await(let G of B)await x(G)&&(yield G)}function C(x,B){return B===void 0?G=>k(x,G):k(x,B)}async function*T(x){for await(let B of x)B&&typeof B!="string"&&(B[Symbol.iterator]||B[Symbol.asyncIterator])?yield*T(B):yield B}async function*D(x,B){for await(let G of B)yield await x(G)}function j(x,B){return B===void 0?G=>D(x,G):D(x,B)}function M(x,B){return B===void 0?G=>M(x,G):C(G=>G!=null,T(j(x,B)))}function se(x,B,G){let Z=c(G),he=[],Ne=[],He=!1,Fe=!1,Ke=0,it=null;function Mt(){for(;Ne.length>0&&he.length>0;){let{resolve:mt}=Ne.shift(),nt=he.shift();mt({done:!1,value:nt})}for(;Ne.length>0&&Ke===0&&He;){let{resolve:mt,reject:nt}=Ne.shift();it?(nt(it),it=null):mt({done:!0,value:void 0})}}async function ft(){if(He){Mt();return}if(!Fe&&!(Ke+he.length>=x)){Fe=!0,Ke++;try{let{done:mt,value:nt}=await Z.next();mt?(He=!0,Ke--,Mt()):_r(nt)}catch(mt){He=!0,Ke--,it=mt,Mt()}Fe=!1,ft()}}async function _r(mt){try{let nt=await B(mt);if(nt&&nt[Symbol.asyncIterator])for await(let yr of nt)he.push(yr);else he.push(nt)}catch(nt){He=!0,it=nt}Ke--,Mt(),ft()}async function Nr(){if(he.length===0){let nt=u();return Ne.push(nt),ft(),nt.promise}let mt=he.shift();return ft(),{done:!1,value:mt}}let xn={next:Nr,[Symbol.asyncIterator]:()=>xn};return xn}function ie(x,B,G){return B===void 0?(Z,he)=>he?ie(x,Z,he):ie(x,Z):G===void 0?Z=>ie(x,B,Z):C(Z=>Z!=null,T(se(x,B,G)))}async function fe(x){return new Promise(B=>{x.once("readable",()=>{B()})})}async function*pe(x){for(;;){let B=x.read();if(B!==null){yield B;continue}if(x._readableState.ended)break;await fe(x)}}function Be(x){return typeof x[Symbol.asyncIterator]=="function"?x:pe(x)}async function*Ae(...x){let B=new Set(x.map(c));for(;B.size>0;)for(let G of B){let Z=await G.next();Z.done?B.delete(G):yield Z.value}}function ke(x,...B){let G=x();for(let Z of B)G=Z(G);return G}async function*ne(x,B,G){let Z=null,he=Ke=>({value:B(Ke)}),Ne=async function*(Ke){for await(let it of Ke){if(Z)return;yield it}},He=ke(()=>G,h(1),Ne,j(he),h(x-1)),Fe=c(He);for(;;){let{value:Ke,done:it}=await Fe.next();if(it)break;try{let Mt=await Ke.value;Z||(yield Mt)}catch(Mt){Z=Mt}}if(Z)throw Z}function Me(x,B,G){return B===void 0?(Z,he)=>Me(x,Z,he):G===void 0?Z=>Me(x,B,Z):x===1?j(B,G):ne(x,B,G)}function ct(x,B,G){return B===void 0?(Z,he)=>he?ct(x,Z,he):ct(x,Z):G===void 0?Z=>ct(x,B,Z):C(Z=>Z!=null,T(Me(x,B,G)))}async function*Ye(...x){let B=x.map(c),G=new Set,Z=new Map,he=null,Ne=null,He=null,Fe=ft=>{he=ft,Ne&&Ne(ft)},Ke=ft=>{He&&He(ft)},it=()=>new Promise((ft,_r)=>{if(he&&_r(he),Z.size>0)return ft();He=ft,Ne=_r}),Mt=ft=>{let _r=Promise.resolve(ft.next()).then(async({done:Nr,value:xn})=>{Nr||Z.set(ft,xn),G.delete(_r)});G.add(_r),_r.then(Ke,Fe)};for(let ft of B)Mt(ft);for(;;){if(G.size===0&&Z.size===0)return;await it();for(let[ft,_r]of Z)Z.delete(ft),yield _r,Mt(ft)}}async function Xe(x,B,G){let Z=B;for await(let he of G)Z=await x(Z,he);return Z}function de(x,B,G){return B===void 0?(Z,he)=>he?Xe(x,Z,he):de(x,Z):G===void 0?Z=>de(x,B,Z):Xe(x,B,G)}async function*J(x,B){let G=0;for await(let Z of B)if(yield await Z,G++,G>=x)break}function*Ee(x,B){let G=0;for(let Z of B)if(yield Z,G++,G>=x)break}function je(x,B){return B===void 0?G=>je(x,G):B[Symbol.asyncIterator]?J(x,B):Ee(x,B)}async function*ze(x,B){for await(let G of B)await x(G),yield G}function Te(x,B){return B===void 0?G=>ze(x,G):ze(x,B)}let ot=x=>new Promise(B=>setTimeout(B,x));function I(x,B,G){if(!Number.isFinite(x))throw new TypeError("Expected `limit` to be a finite number");if(x<=0)throw new TypeError("Expected `limit` to be greater than 0");if(!Number.isFinite(B))throw new TypeError("Expected `interval` to be a finite number");return async function*(){let he=0,Ne;for await(let He of G){if(he<x){typeof Ne=="undefined"&&(Ne=Date.now()),he++,yield He;continue}let Fe=Date.now()-Ne,Ke=B-Fe;Ke>0&&await ot(Ke),Ne=Date.now(),he=1,yield He}}()}function O(x,B,G){return G===void 0?Z=>I(x,B,Z):I(x,B,G)}function N(x,B){let G=x[0]+B[0],Z=x[1]+B[1];if(Z>=1e9){let he=Z%1e9;G+=(Z-he)/1e9,Z=he}return[G,Z]}async function*Y(x,B){let G=B[Symbol.asyncIterator](),Z=[0,0];for(;;){let he=process.hrtime(),{value:Ne,done:He}=await G.next(),Fe=process.hrtime(he);if(Z=N(Z,Fe),x.progress&&x.progress(Fe,Z),He)return x.total&&x.total(Z),Ne;yield Ne}}function*F(x,B){let G=B[Symbol.iterator](),Z=[0,0];for(;;){let he=process.hrtime(),{value:Ne,done:He}=G.next(),Fe=process.hrtime(he);if(Z=N(Z,Fe),x.progress&&x.progress(Fe,Z),He)return x.total&&x.total(Z),Ne;yield Ne}}function W(x={},B){return B===void 0?G=>W(x,G):B[Symbol.asyncIterator]!==void 0?Y(x,B):F(x,B)}function ee(x,B,G){let Z=c(G),he=[],Ne=[],He=!1,Fe=!1,Ke=0,it=null;function Mt(){for(;Ne.length>0&&he.length>0;){let{resolve:mt}=Ne.shift(),nt=he.shift();mt({done:!1,value:nt})}for(;Ne.length>0&&Ke===0&&He;){let{resolve:mt,reject:nt}=Ne.shift();it?(nt(it),it=null):mt({done:!0,value:void 0})}}async function ft(){if(He){Mt();return}if(!Fe&&!(Ke+he.length>=x)){Fe=!0,Ke++;try{let{done:mt,value:nt}=await Z.next();mt?(He=!0,Ke--,Mt()):_r(nt)}catch(mt){He=!0,Ke--,it=mt,Mt()}Fe=!1,ft()}}async function _r(mt){try{let nt=await B(mt);he.push(nt)}catch(nt){He=!0,it=nt}Ke--,Mt(),ft()}async function Nr(){if(he.length===0){let nt=u();return Ne.push(nt),ft(),nt.promise}let mt=he.shift();return ft(),{done:!1,value:mt}}let xn={next:Nr,[Symbol.asyncIterator]:()=>xn};return xn}function V(x,B,G){return B===void 0?(Z,he)=>he?V(x,Z,he):V(x,Z):G===void 0?Z=>V(x,B,Z):ee(x,B,G)}async function X(x,B){let G=null,Z=null,he=null,Ne=it=>{G=it,Z&&Z(it)},He=()=>{he&&he()},Fe=()=>{x.removeListener("error",Ne),x.removeListener("drain",He)};x.once("error",Ne);let Ke=()=>new Promise((it,Mt)=>{if(G)return Mt(G);x.once("drain",He),he=it,Z=Mt});for await(let it of B)if(x.write(it)===!1&&await Ke(),G)break;if(Fe(),G)throw G}function te(x,B){return B===void 0?G=>X(x,G):X(x,B)}r.batch=i,r.batchWithTimeout=a,r.buffer=h,r.collect=y,r.concat=b,r.consume=R,r.filter=C,r.flatMap=M,r.flatTransform=ie,r.flatten=T,r.fromStream=Be,r.getIterator=c,r.map=j,r.merge=Ae,r.parallelFlatMap=ct,r.parallelMap=Me,r.parallelMerge=Ye,r.pipeline=ke,r.reduce=de,r.take=je,r.tap=Te,r.throttle=O,r.time=W,r.transform=V,r.writeToStream=te,Object.defineProperty(r,"__esModule",{value:!0})})});var Cge=m((YNt,Pge)=>{l();"use strict";var gJe=xp();Pge.exports=r=>{let e=gJe(r);return e.delete=e.remove,e}});var kge=m((Oge,A_)=>{l();(function(r){"use strict";var e,t=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,n=Math.floor,s="[BigNumber Error] ",o=s+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,u=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,h=1e9;function p(C){var T,D,j,M=J.prototype={constructor:J,toString:null,valueOf:null},se=new J(1),ie=20,fe=4,pe=-7,Be=21,Ae=-1e7,ke=1e7,ne=!1,Me=1,ct=0,Ye={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},Xe="0123456789abcdefghijklmnopqrstuvwxyz",de=!0;function J(I,O){var N,Y,F,W,ee,V,X,te,x=this;if(!(x instanceof J))return new J(I,O);if(O==null){if(I&&I._isBigNumber===!0){x.s=I.s,!I.c||I.e>ke?x.c=x.e=null:I.e<Ae?x.c=[x.e=0]:(x.e=I.e,x.c=I.c.slice());return}if((V=typeof I=="number")&&I*0==0){if(x.s=1/I<0?(I=-I,-1):1,I===~~I){for(W=0,ee=I;ee>=10;ee/=10,W++);W>ke?x.c=x.e=null:(x.e=W,x.c=[I]);return}te=String(I)}else{if(!t.test(te=String(I)))return j(x,te,V);x.s=te.charCodeAt(0)==45?(te=te.slice(1),-1):1}(W=te.indexOf("."))>-1&&(te=te.replace(".","")),(ee=te.search(/e/i))>0?(W<0&&(W=ee),W+=+te.slice(ee+1),te=te.substring(0,ee)):W<0&&(W=te.length)}else{if(b(O,2,Xe.length,"Base"),O==10&&de)return x=new J(I),Te(x,ie+x.e+1,fe);if(te=String(I),V=typeof I=="number"){if(I*0!=0)return j(x,te,V,O);if(x.s=1/I<0?(te=te.slice(1),-1):1,J.DEBUG&&te.replace(/^0\.0*|\./,"").length>15)throw Error(o+I)}else x.s=te.charCodeAt(0)===45?(te=te.slice(1),-1):1;for(N=Xe.slice(0,O),W=ee=0,X=te.length;ee<X;ee++)if(N.indexOf(Y=te.charAt(ee))<0){if(Y=="."){if(ee>W){W=X;continue}}else if(!F&&(te==te.toUpperCase()&&(te=te.toLowerCase())||te==te.toLowerCase()&&(te=te.toUpperCase()))){F=!0,ee=-1,W=0;continue}return j(x,String(I),V,O)}V=!1,te=D(te,O,10,x.s),(W=te.indexOf("."))>-1?te=te.replace(".",""):W=te.length}for(ee=0;te.charCodeAt(ee)===48;ee++);for(X=te.length;te.charCodeAt(--X)===48;);if(te=te.slice(ee,++X)){if(X-=ee,V&&J.DEBUG&&X>15&&(I>u||I!==n(I)))throw Error(o+x.s*I);if((W=W-ee-1)>ke)x.c=x.e=null;else if(W<Ae)x.c=[x.e=0];else{if(x.e=W,x.c=[],ee=(W+1)%c,W<0&&(ee+=c),ee<X){for(ee&&x.c.push(+te.slice(0,ee)),X-=c;ee<X;)x.c.push(+te.slice(ee,ee+=c));ee=c-(te=te.slice(ee)).length}else ee-=X;for(;ee--;te+="0");x.c.push(+te)}}else x.c=[x.e=0]}J.clone=p,J.ROUND_UP=0,J.ROUND_DOWN=1,J.ROUND_CEIL=2,J.ROUND_FLOOR=3,J.ROUND_HALF_UP=4,J.ROUND_HALF_DOWN=5,J.ROUND_HALF_EVEN=6,J.ROUND_HALF_CEIL=7,J.ROUND_HALF_FLOOR=8,J.EUCLID=9,J.config=J.set=function(I){var O,N;if(I!=null)if(typeof I=="object"){if(I.hasOwnProperty(O="DECIMAL_PLACES")&&(N=I[O],b(N,0,h,O),ie=N),I.hasOwnProperty(O="ROUNDING_MODE")&&(N=I[O],b(N,0,8,O),fe=N),I.hasOwnProperty(O="EXPONENTIAL_AT")&&(N=I[O],N&&N.pop?(b(N[0],-h,0,O),b(N[1],0,h,O),pe=N[0],Be=N[1]):(b(N,-h,h,O),pe=-(Be=N<0?-N:N))),I.hasOwnProperty(O="RANGE"))if(N=I[O],N&&N.pop)b(N[0],-h,-1,O),b(N[1],1,h,O),Ae=N[0],ke=N[1];else if(b(N,-h,h,O),N)Ae=-(ke=N<0?-N:N);else throw Error(s+O+" cannot be zero: "+N);if(I.hasOwnProperty(O="CRYPTO"))if(N=I[O],N===!!N)if(N)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))ne=N;else throw ne=!N,Error(s+"crypto unavailable");else ne=N;else throw Error(s+O+" not true or false: "+N);if(I.hasOwnProperty(O="MODULO_MODE")&&(N=I[O],b(N,0,9,O),Me=N),I.hasOwnProperty(O="POW_PRECISION")&&(N=I[O],b(N,0,h,O),ct=N),I.hasOwnProperty(O="FORMAT"))if(N=I[O],typeof N=="object")Ye=N;else throw Error(s+O+" not an object: "+N);if(I.hasOwnProperty(O="ALPHABET"))if(N=I[O],typeof N=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(N))de=N.slice(0,10)=="0123456789",Xe=N;else throw Error(s+O+" invalid: "+N)}else throw Error(s+"Object expected: "+I);return{DECIMAL_PLACES:ie,ROUNDING_MODE:fe,EXPONENTIAL_AT:[pe,Be],RANGE:[Ae,ke],CRYPTO:ne,MODULO_MODE:Me,POW_PRECISION:ct,FORMAT:Ye,ALPHABET:Xe}},J.isBigNumber=function(I){if(!I||I._isBigNumber!==!0)return!1;if(!J.DEBUG)return!0;var O,N,Y=I.c,F=I.e,W=I.s;e:if({}.toString.call(Y)=="[object Array]"){if((W===1||W===-1)&&F>=-h&&F<=h&&F===n(F)){if(Y[0]===0){if(F===0&&Y.length===1)return!0;break e}if(O=(F+1)%c,O<1&&(O+=c),String(Y[0]).length==O){for(O=0;O<Y.length;O++)if(N=Y[O],N<0||N>=a||N!==n(N))break e;if(N!==0)return!0}}}else if(Y===null&&F===null&&(W===null||W===1||W===-1))return!0;throw Error(s+"Invalid BigNumber: "+I)},J.maximum=J.max=function(){return je(arguments,M.lt)},J.minimum=J.min=function(){return je(arguments,M.gt)},J.random=function(){var I=9007199254740992,O=Math.random()*I&2097151?function(){return n(Math.random()*I)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(N){var Y,F,W,ee,V,X=0,te=[],x=new J(se);if(N==null?N=ie:b(N,0,h),ee=i(N/c),ne)if(crypto.getRandomValues){for(Y=crypto.getRandomValues(new Uint32Array(ee*=2));X<ee;)V=Y[X]*131072+(Y[X+1]>>>11),V>=9e15?(F=crypto.getRandomValues(new Uint32Array(2)),Y[X]=F[0],Y[X+1]=F[1]):(te.push(V%1e14),X+=2);X=ee/2}else if(crypto.randomBytes){for(Y=crypto.randomBytes(ee*=7);X<ee;)V=(Y[X]&31)*281474976710656+Y[X+1]*1099511627776+Y[X+2]*4294967296+Y[X+3]*16777216+(Y[X+4]<<16)+(Y[X+5]<<8)+Y[X+6],V>=9e15?crypto.randomBytes(7).copy(Y,X):(te.push(V%1e14),X+=7);X=ee/7}else throw ne=!1,Error(s+"crypto unavailable");if(!ne)for(;X<ee;)V=O(),V<9e15&&(te[X++]=V%1e14);for(ee=te[--X],N%=c,ee&&N&&(V=f[c-N],te[X]=n(ee/V)*V);te[X]===0;te.pop(),X--);if(X<0)te=[W=0];else{for(W=-1;te[0]===0;te.splice(0,1),W-=c);for(X=1,V=te[0];V>=10;V/=10,X++);X<c&&(W-=c-X)}return x.e=W,x.c=te,x}}(),J.sum=function(){for(var I=1,O=arguments,N=new J(O[0]);I<O.length;)N=N.plus(O[I++]);return N},D=function(){var I="0123456789";function O(N,Y,F,W){for(var ee,V=[0],X,te=0,x=N.length;te<x;){for(X=V.length;X--;V[X]*=Y);for(V[0]+=W.indexOf(N.charAt(te++)),ee=0;ee<V.length;ee++)V[ee]>F-1&&(V[ee+1]==null&&(V[ee+1]=0),V[ee+1]+=V[ee]/F|0,V[ee]%=F)}return V.reverse()}return function(N,Y,F,W,ee){var V,X,te,x,B,G,Z,he,Ne=N.indexOf("."),He=ie,Fe=fe;for(Ne>=0&&(x=ct,ct=0,N=N.replace(".",""),he=new J(Y),G=he.pow(N.length-Ne),ct=x,he.c=O(k(g(G.c),G.e,"0"),10,F,I),he.e=he.c.length),Z=O(N,Y,F,ee?(V=Xe,I):(V=I,Xe)),te=x=Z.length;Z[--x]==0;Z.pop());if(!Z[0])return V.charAt(0);if(Ne<0?--te:(G.c=Z,G.e=te,G.s=W,G=T(G,he,He,Fe,F),Z=G.c,B=G.r,te=G.e),X=te+He+1,Ne=Z[X],x=F/2,B=B||X<0||Z[X+1]!=null,B=Fe<4?(Ne!=null||B)&&(Fe==0||Fe==(G.s<0?3:2)):Ne>x||Ne==x&&(Fe==4||B||Fe==6&&Z[X-1]&1||Fe==(G.s<0?8:7)),X<1||!Z[0])N=B?k(V.charAt(1),-He,V.charAt(0)):V.charAt(0);else{if(Z.length=X,B)for(--F;++Z[--X]>F;)Z[X]=0,X||(++te,Z=[1].concat(Z));for(x=Z.length;!Z[--x];);for(Ne=0,N="";Ne<=x;N+=V.charAt(Z[Ne++]));N=k(N,te,V.charAt(0))}return N}}(),T=function(){function I(Y,F,W){var ee,V,X,te,x=0,B=Y.length,G=F%d,Z=F/d|0;for(Y=Y.slice();B--;)X=Y[B]%d,te=Y[B]/d|0,ee=Z*X+te*G,V=G*X+ee%d*d+x,x=(V/W|0)+(ee/d|0)+Z*te,Y[B]=V%W;return x&&(Y=[x].concat(Y)),Y}function O(Y,F,W,ee){var V,X;if(W!=ee)X=W>ee?1:-1;else for(V=X=0;V<W;V++)if(Y[V]!=F[V]){X=Y[V]>F[V]?1:-1;break}return X}function N(Y,F,W,ee){for(var V=0;W--;)Y[W]-=V,V=Y[W]<F[W]?1:0,Y[W]=V*ee+Y[W]-F[W];for(;!Y[0]&&Y.length>1;Y.splice(0,1));}return function(Y,F,W,ee,V){var X,te,x,B,G,Z,he,Ne,He,Fe,Ke,it,Mt,ft,_r,Nr,xn,mt=Y.s==F.s?1:-1,nt=Y.c,yr=F.c;if(!nt||!nt[0]||!yr||!yr[0])return new J(!Y.s||!F.s||(nt?yr&&nt[0]==yr[0]:!yr)?NaN:nt&&nt[0]==0||!yr?mt*0:mt/0);for(Ne=new J(mt),He=Ne.c=[],te=Y.e-F.e,mt=W+te+1,V||(V=a,te=y(Y.e/c)-y(F.e/c),mt=mt/c|0),x=0;yr[x]==(nt[x]||0);x++);if(yr[x]>(nt[x]||0)&&te--,mt<0)He.push(1),B=!0;else{for(ft=nt.length,Nr=yr.length,x=0,mt+=2,G=n(V/(yr[0]+1)),G>1&&(yr=I(yr,G,V),nt=I(nt,G,V),Nr=yr.length,ft=nt.length),Mt=Nr,Fe=nt.slice(0,Nr),Ke=Fe.length;Ke<Nr;Fe[Ke++]=0);xn=yr.slice(),xn=[0].concat(xn),_r=yr[0],yr[1]>=V/2&&_r++;do{if(G=0,X=O(yr,Fe,Nr,Ke),X<0){if(it=Fe[0],Nr!=Ke&&(it=it*V+(Fe[1]||0)),G=n(it/_r),G>1)for(G>=V&&(G=V-1),Z=I(yr,G,V),he=Z.length,Ke=Fe.length;O(Z,Fe,he,Ke)==1;)G--,N(Z,Nr<he?xn:yr,he,V),he=Z.length,X=1;else G==0&&(X=G=1),Z=yr.slice(),he=Z.length;if(he<Ke&&(Z=[0].concat(Z)),N(Fe,Z,Ke,V),Ke=Fe.length,X==-1)for(;O(yr,Fe,Nr,Ke)<1;)G++,N(Fe,Nr<Ke?xn:yr,Ke,V),Ke=Fe.length}else X===0&&(G++,Fe=[0]);He[x++]=G,Fe[0]?Fe[Ke++]=nt[Mt]||0:(Fe=[nt[Mt]],Ke=1)}while((Mt++<ft||Fe[0]!=null)&&mt--);B=Fe[0]!=null,He[0]||He.splice(0,1)}if(V==a){for(x=1,mt=He[0];mt>=10;mt/=10,x++);Te(Ne,W+(Ne.e=x+te*c-1)+1,ee,B)}else Ne.e=te,Ne.r=+B;return Ne}}();function Ee(I,O,N,Y){var F,W,ee,V,X;if(N==null?N=fe:b(N,0,8),!I.c)return I.toString();if(F=I.c[0],ee=I.e,O==null)X=g(I.c),X=Y==1||Y==2&&(ee<=pe||ee>=Be)?R(X,ee):k(X,ee,"0");else if(I=Te(new J(I),O,N),W=I.e,X=g(I.c),V=X.length,Y==1||Y==2&&(O<=W||W<=pe)){for(;V<O;X+="0",V++);X=R(X,W)}else if(O-=ee,X=k(X,W,"0"),W+1>V){if(--O>0)for(X+=".";O--;X+="0");}else if(O+=W-V,O>0)for(W+1==V&&(X+=".");O--;X+="0");return I.s<0&&F?"-"+X:X}function je(I,O){for(var N,Y=1,F=new J(I[0]);Y<I.length;Y++)if(N=new J(I[Y]),N.s)O.call(F,N)&&(F=N);else{F=N;break}return F}function ze(I,O,N){for(var Y=1,F=O.length;!O[--F];O.pop());for(F=O[0];F>=10;F/=10,Y++);return(N=Y+N*c-1)>ke?I.c=I.e=null:N<Ae?I.c=[I.e=0]:(I.e=N,I.c=O),I}j=function(){var I=/^(-?)0([xbo])(?=\w[\w.]*$)/i,O=/^([^.]+)\.$/,N=/^\.([^.]+)$/,Y=/^-?(Infinity|NaN)$/,F=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(W,ee,V,X){var te,x=V?ee:ee.replace(F,"");if(Y.test(x))W.s=isNaN(x)?null:x<0?-1:1;else{if(!V&&(x=x.replace(I,function(B,G,Z){return te=(Z=Z.toLowerCase())=="x"?16:Z=="b"?2:8,!X||X==te?G:B}),X&&(te=X,x=x.replace(O,"$1").replace(N,"0.$1")),ee!=x))return new J(x,te);if(J.DEBUG)throw Error(s+"Not a"+(X?" base "+X:"")+" number: "+ee);W.s=null}W.c=W.e=null}}();function Te(I,O,N,Y){var F,W,ee,V,X,te,x,B=I.c,G=f;if(B){e:{for(F=1,V=B[0];V>=10;V/=10,F++);if(W=O-F,W<0)W+=c,ee=O,X=B[te=0],x=X/G[F-ee-1]%10|0;else if(te=i((W+1)/c),te>=B.length)if(Y){for(;B.length<=te;B.push(0));X=x=0,F=1,W%=c,ee=W-c+1}else break e;else{for(X=V=B[te],F=1;V>=10;V/=10,F++);W%=c,ee=W-c+F,x=ee<0?0:X/G[F-ee-1]%10|0}if(Y=Y||O<0||B[te+1]!=null||(ee<0?X:X%G[F-ee-1]),Y=N<4?(x||Y)&&(N==0||N==(I.s<0?3:2)):x>5||x==5&&(N==4||Y||N==6&&(W>0?ee>0?X/G[F-ee]:0:B[te-1])%10&1||N==(I.s<0?8:7)),O<1||!B[0])return B.length=0,Y?(O-=I.e+1,B[0]=G[(c-O%c)%c],I.e=-O||0):B[0]=I.e=0,I;if(W==0?(B.length=te,V=1,te--):(B.length=te+1,V=G[c-W],B[te]=ee>0?n(X/G[F-ee]%G[ee])*V:0),Y)for(;;)if(te==0){for(W=1,ee=B[0];ee>=10;ee/=10,W++);for(ee=B[0]+=V,V=1;ee>=10;ee/=10,V++);W!=V&&(I.e++,B[0]==a&&(B[0]=1));break}else{if(B[te]+=V,B[te]!=a)break;B[te--]=0,V=1}for(W=B.length;B[--W]===0;B.pop());}I.e>ke?I.c=I.e=null:I.e<Ae&&(I.c=[I.e=0])}return I}function ot(I){var O,N=I.e;return N===null?I.toString():(O=g(I.c),O=N<=pe||N>=Be?R(O,N):k(O,N,"0"),I.s<0?"-"+O:O)}return M.absoluteValue=M.abs=function(){var I=new J(this);return I.s<0&&(I.s=1),I},M.comparedTo=function(I,O){return w(this,new J(I,O))},M.decimalPlaces=M.dp=function(I,O){var N,Y,F,W=this;if(I!=null)return b(I,0,h),O==null?O=fe:b(O,0,8),Te(new J(W),I+W.e+1,O);if(!(N=W.c))return null;if(Y=((F=N.length-1)-y(this.e/c))*c,F=N[F])for(;F%10==0;F/=10,Y--);return Y<0&&(Y=0),Y},M.dividedBy=M.div=function(I,O){return T(this,new J(I,O),ie,fe)},M.dividedToIntegerBy=M.idiv=function(I,O){return T(this,new J(I,O),0,1)},M.exponentiatedBy=M.pow=function(I,O){var N,Y,F,W,ee,V,X,te,x,B=this;if(I=new J(I),I.c&&!I.isInteger())throw Error(s+"Exponent not an integer: "+ot(I));if(O!=null&&(O=new J(O)),V=I.e>14,!B.c||!B.c[0]||B.c[0]==1&&!B.e&&B.c.length==1||!I.c||!I.c[0])return x=new J(Math.pow(+ot(B),V?2-v(I):+ot(I))),O?x.mod(O):x;if(X=I.s<0,O){if(O.c?!O.c[0]:!O.s)return new J(NaN);Y=!X&&B.isInteger()&&O.isInteger(),Y&&(B=B.mod(O))}else{if(I.e>9&&(B.e>0||B.e<-1||(B.e==0?B.c[0]>1||V&&B.c[1]>=24e7:B.c[0]<8e13||V&&B.c[0]<=9999975e7)))return W=B.s<0&&v(I)?-0:0,B.e>-1&&(W=1/W),new J(X?1/W:W);ct&&(W=i(ct/c+2))}for(V?(N=new J(.5),X&&(I.s=1),te=v(I)):(F=Math.abs(+ot(I)),te=F%2),x=new J(se);;){if(te){if(x=x.times(B),!x.c)break;W?x.c.length>W&&(x.c.length=W):Y&&(x=x.mod(O))}if(F){if(F=n(F/2),F===0)break;te=F%2}else if(I=I.times(N),Te(I,I.e+1,1),I.e>14)te=v(I);else{if(F=+ot(I),F===0)break;te=F%2}B=B.times(B),W?B.c&&B.c.length>W&&(B.c.length=W):Y&&(B=B.mod(O))}return Y?x:(X&&(x=se.div(x)),O?x.mod(O):W?Te(x,ct,fe,ee):x)},M.integerValue=function(I){var O=new J(this);return I==null?I=fe:b(I,0,8),Te(O,O.e+1,I)},M.isEqualTo=M.eq=function(I,O){return w(this,new J(I,O))===0},M.isFinite=function(){return!!this.c},M.isGreaterThan=M.gt=function(I,O){return w(this,new J(I,O))>0},M.isGreaterThanOrEqualTo=M.gte=function(I,O){return(O=w(this,new J(I,O)))===1||O===0},M.isInteger=function(){return!!this.c&&y(this.e/c)>this.c.length-2},M.isLessThan=M.lt=function(I,O){return w(this,new J(I,O))<0},M.isLessThanOrEqualTo=M.lte=function(I,O){return(O=w(this,new J(I,O)))===-1||O===0},M.isNaN=function(){return!this.s},M.isNegative=function(){return this.s<0},M.isPositive=function(){return this.s>0},M.isZero=function(){return!!this.c&&this.c[0]==0},M.minus=function(I,O){var N,Y,F,W,ee=this,V=ee.s;if(I=new J(I,O),O=I.s,!V||!O)return new J(NaN);if(V!=O)return I.s=-O,ee.plus(I);var X=ee.e/c,te=I.e/c,x=ee.c,B=I.c;if(!X||!te){if(!x||!B)return x?(I.s=-O,I):new J(B?ee:NaN);if(!x[0]||!B[0])return B[0]?(I.s=-O,I):new J(x[0]?ee:fe==3?-0:0)}if(X=y(X),te=y(te),x=x.slice(),V=X-te){for((W=V<0)?(V=-V,F=x):(te=X,F=B),F.reverse(),O=V;O--;F.push(0));F.reverse()}else for(Y=(W=(V=x.length)<(O=B.length))?V:O,V=O=0;O<Y;O++)if(x[O]!=B[O]){W=x[O]<B[O];break}if(W&&(F=x,x=B,B=F,I.s=-I.s),O=(Y=B.length)-(N=x.length),O>0)for(;O--;x[N++]=0);for(O=a-1;Y>V;){if(x[--Y]<B[Y]){for(N=Y;N&&!x[--N];x[N]=O);--x[N],x[Y]+=a}x[Y]-=B[Y]}for(;x[0]==0;x.splice(0,1),--te);return x[0]?ze(I,x,te):(I.s=fe==3?-1:1,I.c=[I.e=0],I)},M.modulo=M.mod=function(I,O){var N,Y,F=this;return I=new J(I,O),!F.c||!I.s||I.c&&!I.c[0]?new J(NaN):!I.c||F.c&&!F.c[0]?new J(F):(Me==9?(Y=I.s,I.s=1,N=T(F,I,0,3),I.s=Y,N.s*=Y):N=T(F,I,0,Me),I=F.minus(N.times(I)),!I.c[0]&&Me==1&&(I.s=F.s),I)},M.multipliedBy=M.times=function(I,O){var N,Y,F,W,ee,V,X,te,x,B,G,Z,he,Ne,He,Fe=this,Ke=Fe.c,it=(I=new J(I,O)).c;if(!Ke||!it||!Ke[0]||!it[0])return!Fe.s||!I.s||Ke&&!Ke[0]&&!it||it&&!it[0]&&!Ke?I.c=I.e=I.s=null:(I.s*=Fe.s,!Ke||!it?I.c=I.e=null:(I.c=[0],I.e=0)),I;for(Y=y(Fe.e/c)+y(I.e/c),I.s*=Fe.s,X=Ke.length,B=it.length,X<B&&(he=Ke,Ke=it,it=he,F=X,X=B,B=F),F=X+B,he=[];F--;he.push(0));for(Ne=a,He=d,F=B;--F>=0;){for(N=0,G=it[F]%He,Z=it[F]/He|0,ee=X,W=F+ee;W>F;)te=Ke[--ee]%He,x=Ke[ee]/He|0,V=Z*te+x*G,te=G*te+V%He*He+he[W]+N,N=(te/Ne|0)+(V/He|0)+Z*x,he[W--]=te%Ne;he[W]=N}return N?++Y:he.splice(0,1),ze(I,he,Y)},M.negated=function(){var I=new J(this);return I.s=-I.s||null,I},M.plus=function(I,O){var N,Y=this,F=Y.s;if(I=new J(I,O),O=I.s,!F||!O)return new J(NaN);if(F!=O)return I.s=-O,Y.minus(I);var W=Y.e/c,ee=I.e/c,V=Y.c,X=I.c;if(!W||!ee){if(!V||!X)return new J(F/0);if(!V[0]||!X[0])return X[0]?I:new J(V[0]?Y:F*0)}if(W=y(W),ee=y(ee),V=V.slice(),F=W-ee){for(F>0?(ee=W,N=X):(F=-F,N=V),N.reverse();F--;N.push(0));N.reverse()}for(F=V.length,O=X.length,F-O<0&&(N=X,X=V,V=N,O=F),F=0;O;)F=(V[--O]=V[O]+X[O]+F)/a|0,V[O]=a===V[O]?0:V[O]%a;return F&&(V=[F].concat(V),++ee),ze(I,V,ee)},M.precision=M.sd=function(I,O){var N,Y,F,W=this;if(I!=null&&I!==!!I)return b(I,1,h),O==null?O=fe:b(O,0,8),Te(new J(W),I,O);if(!(N=W.c))return null;if(F=N.length-1,Y=F*c+1,F=N[F]){for(;F%10==0;F/=10,Y--);for(F=N[0];F>=10;F/=10,Y++);}return I&&W.e+1>Y&&(Y=W.e+1),Y},M.shiftedBy=function(I){return b(I,-u,u),this.times("1e"+I)},M.squareRoot=M.sqrt=function(){var I,O,N,Y,F,W=this,ee=W.c,V=W.s,X=W.e,te=ie+4,x=new J("0.5");if(V!==1||!ee||!ee[0])return new J(!V||V<0&&(!ee||ee[0])?NaN:ee?W:1/0);if(V=Math.sqrt(+ot(W)),V==0||V==1/0?(O=g(ee),(O.length+X)%2==0&&(O+="0"),V=Math.sqrt(+O),X=y((X+1)/2)-(X<0||X%2),V==1/0?O="5e"+X:(O=V.toExponential(),O=O.slice(0,O.indexOf("e")+1)+X),N=new J(O)):N=new J(V+""),N.c[0]){for(X=N.e,V=X+te,V<3&&(V=0);;)if(F=N,N=x.times(F.plus(T(W,F,te,1))),g(F.c).slice(0,V)===(O=g(N.c)).slice(0,V))if(N.e<X&&--V,O=O.slice(V-3,V+1),O=="9999"||!Y&&O=="4999"){if(!Y&&(Te(F,F.e+ie+2,0),F.times(F).eq(W))){N=F;break}te+=4,V+=4,Y=1}else{(!+O||!+O.slice(1)&&O.charAt(0)=="5")&&(Te(N,N.e+ie+2,1),I=!N.times(N).eq(W));break}}return Te(N,N.e+ie+1,fe,I)},M.toExponential=function(I,O){return I!=null&&(b(I,0,h),I++),Ee(this,I,O,1)},M.toFixed=function(I,O){return I!=null&&(b(I,0,h),I=I+this.e+1),Ee(this,I,O)},M.toFormat=function(I,O,N){var Y,F=this;if(N==null)I!=null&&O&&typeof O=="object"?(N=O,O=null):I&&typeof I=="object"?(N=I,I=O=null):N=Ye;else if(typeof N!="object")throw Error(s+"Argument not an object: "+N);if(Y=F.toFixed(I,O),F.c){var W,ee=Y.split("."),V=+N.groupSize,X=+N.secondaryGroupSize,te=N.groupSeparator||"",x=ee[0],B=ee[1],G=F.s<0,Z=G?x.slice(1):x,he=Z.length;if(X&&(W=V,V=X,X=W,he-=W),V>0&&he>0){for(W=he%V||V,x=Z.substr(0,W);W<he;W+=V)x+=te+Z.substr(W,V);X>0&&(x+=te+Z.slice(W)),G&&(x="-"+x)}Y=B?x+(N.decimalSeparator||"")+((X=+N.fractionGroupSize)?B.replace(new RegExp("\\d{"+X+"}\\B","g"),"$&"+(N.fractionGroupSeparator||"")):B):x}return(N.prefix||"")+Y+(N.suffix||"")},M.toFraction=function(I){var O,N,Y,F,W,ee,V,X,te,x,B,G,Z=this,he=Z.c;if(I!=null&&(V=new J(I),!V.isInteger()&&(V.c||V.s!==1)||V.lt(se)))throw Error(s+"Argument "+(V.isInteger()?"out of range: ":"not an integer: ")+ot(V));if(!he)return new J(Z);for(O=new J(se),te=N=new J(se),Y=X=new J(se),G=g(he),W=O.e=G.length-Z.e-1,O.c[0]=f[(ee=W%c)<0?c+ee:ee],I=!I||V.comparedTo(O)>0?W>0?O:te:V,ee=ke,ke=1/0,V=new J(G),X.c[0]=0;x=T(V,O,0,1),F=N.plus(x.times(Y)),F.comparedTo(I)!=1;)N=Y,Y=F,te=X.plus(x.times(F=te)),X=F,O=V.minus(x.times(F=O)),V=F;return F=T(I.minus(N),Y,0,1),X=X.plus(F.times(te)),N=N.plus(F.times(Y)),X.s=te.s=Z.s,W=W*2,B=T(te,Y,W,fe).minus(Z).abs().comparedTo(T(X,N,W,fe).minus(Z).abs())<1?[te,Y]:[X,N],ke=ee,B},M.toNumber=function(){return+ot(this)},M.toPrecision=function(I,O){return I!=null&&b(I,1,h),Ee(this,I,O,2)},M.toString=function(I){var O,N=this,Y=N.s,F=N.e;return F===null?Y?(O="Infinity",Y<0&&(O="-"+O)):O="NaN":(I==null?O=F<=pe||F>=Be?R(g(N.c),F):k(g(N.c),F,"0"):I===10&&de?(N=Te(new J(N),ie+F+1,fe),O=k(g(N.c),N.e,"0")):(b(I,2,Xe.length,"Base"),O=D(k(g(N.c),F,"0"),10,I,Y,!0)),Y<0&&N.c[0]&&(O="-"+O)),O},M.valueOf=M.toJSON=function(){return ot(this)},M._isBigNumber=!0,C!=null&&J.set(C),J}function y(C){var T=C|0;return C>0||C===T?T:T-1}function g(C){for(var T,D,j=1,M=C.length,se=C[0]+"";j<M;){for(T=C[j++]+"",D=c-T.length;D--;T="0"+T);se+=T}for(M=se.length;se.charCodeAt(--M)===48;);return se.slice(0,M+1||1)}function w(C,T){var D,j,M=C.c,se=T.c,ie=C.s,fe=T.s,pe=C.e,Be=T.e;if(!ie||!fe)return null;if(D=M&&!M[0],j=se&&!se[0],D||j)return D?j?0:-fe:ie;if(ie!=fe)return ie;if(D=ie<0,j=pe==Be,!M||!se)return j?0:!M^D?1:-1;if(!j)return pe>Be^D?1:-1;for(fe=(pe=M.length)<(Be=se.length)?pe:Be,ie=0;ie<fe;ie++)if(M[ie]!=se[ie])return M[ie]>se[ie]^D?1:-1;return pe==Be?0:pe>Be^D?1:-1}function b(C,T,D,j){if(C<T||C>D||C!==n(C))throw Error(s+(j||"Argument")+(typeof C=="number"?C<T||C>D?" out of range: ":" not an integer: ":" not a primitive number: ")+String(C))}function v(C){var T=C.c.length-1;return y(C.e/c)==T&&C.c[T]%2!=0}function R(C,T){return(C.length>1?C.charAt(0)+"."+C.slice(1):C)+(T<0?"e":"e+")+T}function k(C,T,D){var j,M;if(T<0){for(M=D+".";++T;M+=D);C=M+C}else if(j=C.length,++T>j){for(M=D,T-=j;--T;M+=D);C+=M}else T<j&&(C=C.slice(0,T)+"."+C.slice(T));return C}e=p(),e.default=e.BigNumber=e,typeof define=="function"&&define.amd?define(function(){return e}):typeof A_!="undefined"&&A_.exports?A_.exports=e:(r||(r=typeof self!="undefined"&&self?self:window),r.BigNumber=e)})(Oge)});var LC=m((Dge,Nge)=>{l();"use strict";var mJe=Math.exp;Dge=Nge.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,i=0,n=0,s=0,o,a={};function c(u,f){return 1-mJe(-(u-f)/e)}return a.push=function(f,d){if(o){let h=c(f,o),p=d-t,y=h*p;t=h*d+(1-h)*t,i=(1-h)*(i+p*y),n=Math.sqrt(i),s=t+h*p}else t=d;o=f},a.movingAverage=function(){return t},a.variance=function(){return i},a.deviation=function(){return n},a.forecast=function(){return s},a}});var jge=m((XNt,Mge)=>{l();"use strict";var{EventEmitter:bJe}=Ut(),{BigNumber:R_}=kge(),Bge=LC(),wJe=Gy(),Lge=class extends bJe{constructor(e,t){super();this._options=t,this._queue=[],this._stats={dataReceived:R_(0),dataSent:R_(0)},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);let i=this._options.movingAverageIntervals;for(let n=0;n<e.length;n++){let s=e[n];this._stats[s]=R_(0),this._movingAverages[s]={};for(let o=0;o<i.length;o++){let a=i[o];(this._movingAverages[s][a]=Bge(a)).push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}toJSON(){let e=this.snapshot,t=this.movingAverages,i={dataReceived:e.dataReceived.toString(),dataSent:e.dataSent.toString(),movingAverages:{}},n=Object.keys(t);for(let s of n){i.movingAverages[s]={};for(let o of Object.keys(t[s]))i.movingAverages[s][o]=t[s][o].movingAverage()}return i}push(e,t){this._queue.push([e,t,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout=wJe(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(e of this._queue)this._applyOp(e);this._queue=[],this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let t=e-this._frequencyLastTime;Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let o=n/(t||1)*1e3,a=this._movingAverages[e];a||(a=this._movingAverages[e]={});let c=this._options.movingAverageIntervals;for(let u=0;u<c.length;u++){let f=c[u],d=a[f];d||(d=a[f]=Bge(f)),d.push(i,o)}}_applyOp(e){let t=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);let n;Object.prototype.hasOwnProperty.call(this._stats,t)?n=this._stats[t]:n=this._stats[t]=R_(0),this._stats[t]=n.plus(i),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=i}};Mge.exports=Lge});var Fge=m((QNt,Uge)=>{l();"use strict";var _Je=Ku(),{pipe:vJe}=dr(),{tap:qge}=S_(),EJe=Cge(),{METRICS:SJe}=u_(),MC=jge(),jC=["dataReceived","dataSent"],AJe={in:"dataReceived",out:"dataSent"},x_=class{constructor(e){this._options=_Je(SJe,e),this._globalStats=new MC(jC,this._options),this._peerStats=new Map,this._protocolStats=new Map,this._oldPeers=EJe(this._options.maxOldPeersRetention),this._running=!1,this._onMessage=this._onMessage.bind(this),this._systems=new Map}start(){this._running=!0}stop(){this._running=!1,this._globalStats.stop();for(let e of this._peerStats.values())e.stop();for(let e of this._protocolStats.values())e.stop()}get global(){return this._globalStats}get peers(){return Array.from(this._peerStats.keys())}getComponentMetrics(){return this._systems}updateComponentMetric({system:e="libp2p",component:t,metric:i,value:n}){this._systems.has(e)||this._systems.set(e,new Map);let s=this._systems.get(e);s.has(t)||s.set(t,new Map),s.get(t).set(i,n)}forPeer(e){let t=e.toB58String();return this._peerStats.get(t)||this._oldPeers.get(t)}get protocols(){return Array.from(this._protocolStats.keys())}forProtocol(e){return this._protocolStats.get(e)}onPeerDisconnected(e){let t=e.toB58String(),i=this._peerStats.get(t);i&&(i.stop(),this._peerStats.delete(t),this._oldPeers.set(t,i))}_onMessage({remotePeer:e,protocol:t,direction:i,dataLength:n}){if(!this._running)return;let s=AJe[i],o=this.forPeer(e);if(o||(o=new MC(jC,this._options),this._peerStats.set(e.toB58String(),o)),o.push(s,n),this._globalStats.push(s,n),t){let a=this.forProtocol(t);a||(a=new MC(jC,this._options),this._protocolStats.set(t,a)),a.push(s,n)}}updatePlaceholder(e,t){if(!this._running)return;let i=this.forPeer(e),n=t.toB58String(),s=this.forPeer(t),o=i;s&&(o=x_.mergeStats(s,o),this._oldPeers.delete(n)),this._peerStats.delete(e.toB58String()),this._peerStats.set(n,o),o.start()}trackStream({stream:e,remotePeer:t,protocol:i}){let n=this,s=e.source;e.source=qge(a=>n._onMessage({remotePeer:t,protocol:i,direction:"in",dataLength:a.length}))(s);let o=e.sink;return e.sink=a=>vJe(a,qge(c=>n._onMessage({remotePeer:t,protocol:i,direction:"out",dataLength:c.length})),o),e}static mergeStats(e,t){return e.stop(),t.stop(),e._queue=[...e._queue,...t._queue],e}};Uge.exports=x_});var qC=m((ZNt,Vge)=>{l();"use strict";function Kge(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function RJe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return Kge(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),Kge(new n,t)}}Vge.exports=RJe});var I_=m((JNt,Gge)=>{l();"use strict";var zge=on(),Hge=go(),{pipe:xJe}=dr(),IJe=qC(),{fromString:TJe}=(at(),Xr),PJe=Td(),{source:CJe}=fa(),$ge=TJe(`
`);function UC(r){return Hge.encode.single(new zge([r,$ge]))}function OJe(r,e){r.push(UC(e))}async function kJe(r,e){r.push(e.reduce((t,i)=>t.append(UC(i)),new zge))}async function DJe(r,e){let t=1,i={[Symbol.asyncIterator](){return this},next:()=>r.next(t)},n=i;e&&e.signal&&(n=CJe(i,e.signal));let s=a=>{t=a},o=await xJe(n,Hge.decode({onLength:s}),PJe);if(o.get(o.length-1)!==$ge[0])throw IJe(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return o.shallowSlice(0,-1)}Gge.exports={encode:UC,write:OJe,writeAll:kJe,read:DJe}});var Xge=m((eBt,Yge)=>{l();"use strict";var Wge=le(),NJe=qC(),ey=I_(),BJe=wh(),ty=Object.assign(Wge("mss:select"),{error:Wge("mss:select:error")});Yge.exports=async function(e,t,i,n){t=Array.isArray(t)?[...t]:[t];let{reader:s,writer:o,rest:a,stream:c}=BJe(e),u=t.shift();if(!u)throw new Error("At least one protocol must be specified");i?(ty('select: write ["%s", "%s"]',i,u),ey.writeAll(o,[i,u])):(ty('select: write "%s"',u),ey.write(o,u));let f=(await ey.read(s,n)).toString();if(ty('select: read "%s"',f),f===i&&(f=(await ey.read(s,n)).toString(),ty('select: read "%s"',f)),f===u)return a(),{stream:c,protocol:u};for(let d of t){ty('select: write "%s"',d),ey.write(o,d);let h=(await ey.read(s,n)).toString();if(ty('select: read "%s" for "%s"',h,d),h===d)return a(),{stream:c,protocol:d}}throw a(),NJe(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}});var FC=m(Qge=>{l();"use strict";Qge.PROTOCOL_ID="/multistream/1.0.0"});var eme=m((rBt,Jge)=>{l();"use strict";var Zge=le(),LJe=on(),ry=I_(),MJe=wh(),{PROTOCOL_ID:KC}=FC(),n3=Object.assign(Zge("mss:handle"),{error:Zge("mss:handle:error")});Jge.exports=async function(e,t,i){t=Array.isArray(t)?t:[t];let{writer:n,reader:s,rest:o,stream:a}=MJe(e);for(;;){let c=(await ry.read(s,i)).toString();if(n3('read "%s"',c),c===KC){n3('respond with "%s" for "%s"',KC,c),ry.write(n,KC);continue}if(t.includes(c))return ry.write(n,c),n3('respond with "%s" for "%s"',c,c),o(),{stream:a,protocol:c};if(c==="ls"){ry.write(n,new LJe(t.map(u=>ry.encode(u)))),n3('respond with "%s" for %s',t,c);continue}ry.write(n,"na"),n3('respond with "na" for "%s"',c)}}});var nme=m((iBt,ime)=>{l();"use strict";var jJe=g6(),tme=le(),rme=I_(),qJe=wh(),UJe=go(),{pipe:FJe}=dr(),KJe=Object.assign(tme("mss:ls"),{error:tme("mss:ls:error")});ime.exports=async function(e,t){let{reader:i,writer:n,rest:s,stream:o}=qJe(e);KJe('write "ls"'),rme.write(n,"ls"),s();let a=await rme.read(i,t),c=jJe([a]),u=[];return await FJe(c,UJe.decode(),async d=>{for await(let h of d)u.push(h.shallowSlice(0,-1).toString())}),{stream:o,protocols:u}}});var cme=m(T_=>{l();"use strict";var sme=Xge(),VJe=eme(),zJe=nme(),{PROTOCOL_ID:VC}=FC();T_.PROTOCOL_ID=VC;var zC=class{constructor(e){this._stream=e,this._shaken=!1}async _handshake(e){if(this._shaken)return;let{stream:t}=await sme(this._stream,VC,void 0,e);this._stream=t,this._shaken=!0}},ome=class extends zC{select(e,t){return sme(this._stream,e,this._shaken?void 0:VC,t)}async ls(e){await this._handshake(e);let t=await zJe(this._stream,e),{stream:i,protocols:n}=t;return this._stream=i,n}};T_.Dialer=ome;var ame=class extends zC{handle(e,t){return VJe(this._stream,e,t)}};T_.Listener=ame});var lme=m((sBt,ume)=>{l();"use strict";var HJe={OPEN:"open",CLOSING:"closing",CLOSED:"closed"};ume.exports=HJe});var gme=m((oBt,yme)=>{l();"use strict";var fme=st(),{Multiaddr:$Je}=lt(),Ps=RI(),{OPEN:GJe,CLOSING:dme,CLOSED:HC}=lme(),hme=Symbol.for("@libp2p/interface-connection/connection"),pme=class{constructor({localAddr:e,remoteAddr:t,localPeer:i,remotePeer:n,newStream:s,close:o,getStreams:a,stat:c}){WJe(e,i,n,s,o,a,c),this.id=parseInt(String(Math.random()*1e9)).toString(36)+Date.now(),this.localAddr=e,this.remoteAddr=t,this.localPeer=i,this.remotePeer=n,this._stat={...c,status:GJe},this._newStream=s,this._close=o,this._getStreams=a,this.registry=new Map,this.tags=[]}get[Symbol.toStringTag](){return"Connection"}get[hme](){return!0}static isConnection(e){return Boolean(e&&e[hme])}get stat(){return this._stat}get streams(){return this._getStreams()}async newStream(e){if(this.stat.status===dme)throw Ps(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===HC)throw Ps(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);let{stream:t,protocol:i}=await this._newStream(e);return this.addStream(t,{protocol:i}),{stream:t,protocol:i}}addStream(e,{protocol:t,metadata:i={}}){this.registry.set(e.id,{protocol:t,...i})}removeStream(e){this.registry.delete(e)}async close(){if(this.stat.status!==HC){if(this._closing)return this._closing;this.stat.status=dme,this._closing=await this._close(),this._stat.timeline.close=Date.now(),this.stat.status=HC}}};yme.exports=pme;function WJe(r,e,t,i,n,s,o){if(r&&!$Je.isMultiaddr(r))throw Ps(new Error("localAddr must be an instance of multiaddr"),"ERR_INVALID_PARAMETERS");if(!fme.isPeerId(e))throw Ps(new Error("localPeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(!fme.isPeerId(t))throw Ps(new Error("remotePeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw Ps(new Error("new stream must be a function"),"ERR_INVALID_PARAMETERS");if(typeof n!="function")throw Ps(new Error("close must be a function"),"ERR_INVALID_PARAMETERS");if(typeof s!="function")throw Ps(new Error("getStreams must be a function"),"ERR_INVALID_PARAMETERS");if(!o)throw Ps(new Error("connection metadata object must be provided"),"ERR_INVALID_PARAMETERS");if(o.direction!=="inbound"&&o.direction!=="outbound")throw Ps(new Error('direction must be "inbound" or "outbound"'),"ERR_INVALID_PARAMETERS");if(!o.timeline)throw Ps(new Error("connection timeline object must be provided in the stat object"),"ERR_INVALID_PARAMETERS");if(!o.timeline.open)throw Ps(new Error("connection open timestamp must be provided"),"ERR_INVALID_PARAMETERS");if(!o.timeline.upgraded)throw Ps(new Error("connection upgraded timestamp must be provided"),"ERR_INVALID_PARAMETERS")}});var bme=m(mme=>{l();"use strict";mme.Connection=gme()});var _me=m((cBt,wme)=>{l();"use strict";function YJe(r){if(Array.isArray(r)){for(var e=0,t=Array(r.length);e<r.length;e++)t[e]=r[e];return t}else return Array.from(r)}wme.exports=function(e){var t=void 0,i=void 0;function n(a){if(!(a instanceof Object))throw new Error('Target "'+a+'" is not an object');i=a}function s(a){Object.keys(a).forEach(function(c){var u=a[c];if(typeof u!="function")throw new Error('Trap "'+c+": "+u+'" is not a function');if(!Reflect[c])throw new Error('Trap "'+c+": "+u+'" is not a valid trap')}),t=a}n(function(){}),e&&n(e),s(Reflect);var o=new Proxy({},{get:function(c,u){return function(){for(var f=arguments.length,d=Array(f),h=0;h<f;h++)d[h]=arguments[h];return t[u].apply(null,[i].concat(YJe(d.slice(1))))}}});return{setTarget:n,setHandler:s,getTarget:function(){return i},getHandler:function(){return t},proxy:new Proxy(i,o)}}});var Rme=m((uBt,Ame)=>{l();"use strict";var vme=le(),Ni=Object.assign(vme("libp2p:upgrader"),{error:vme("libp2p:upgrader:err")}),Cs=br(),iy=cme(),{Connection:XJe}=bme(),QJe=st(),{pipe:ZJe}=dr(),Eme=_me(),{codes:Os}=wr(),Sme=class{constructor({localPeer:e,metrics:t,connectionGater:i,cryptos:n=new Map,muxers:s=new Map,onConnectionEnd:o=()=>{},onConnection:a=()=>{}}){this.connectionGater=i,this.localPeer=e,this.metrics=t,this.cryptos=n,this.muxers=s,this.protector=null,this.protocols=new Map,this.onConnection=a,this.onConnectionEnd=o}async upgradeInbound(e){let t,i,n,s,o,a,c;if(await this.connectionGater.denyInboundConnection(e))throw Cs(new Error("The multiaddr connection is blocked by gater.acceptConnection"),Os.ERR_CONNECTION_INTERCEPTED);if(this.metrics){({setTarget:a,proxy:c}=Eme());let f=(Math.random()*1e9).toString(36)+Date.now();a({toB58String:()=>f}),e=this.metrics.trackStream({stream:e,remotePeer:c})}Ni("Starting the inbound connection upgrade");let u=e;this.protector&&(u=await this.protector.protect(e));try{if({conn:t,remotePeer:i,protocol:o}=await this._encryptInbound(this.localPeer,u,this.cryptos),await this.connectionGater.denyInboundEncryptedConnection(i,t))throw Cs(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Os.ERR_CONNECTION_INTERCEPTED);this.muxers.size?{stream:n,Muxer:s}=await this._multiplexInbound(t,this.muxers):n=t}catch(f){throw Ni.error("Failed to upgrade inbound connection",f),await e.close(f),f}if(await this.connectionGater.denyInboundUpgradedConnection(i,t))throw Cs(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Os.ERR_CONNECTION_INTERCEPTED);return this.metrics&&(this.metrics.updatePlaceholder(c,i),a(i)),Ni("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:o,direction:"inbound",maConn:e,upgradedConn:n,Muxer:s,remotePeer:i})}async upgradeOutbound(e){let t=e.remoteAddr.getPeerId();if(!t)throw Cs(new Error("outbound connection must have a peer id"),Os.ERR_INVALID_MULTIADDR);let i=QJe.createFromB58String(t);if(await this.connectionGater.denyOutboundConnection(i,e))throw Cs(new Error("The multiaddr connection is blocked by connectionGater.denyOutboundConnection"),Os.ERR_CONNECTION_INTERCEPTED);let n,s,o,a,c,u,f;if(this.metrics){({setTarget:u,proxy:f}=Eme());let h=(Math.random()*1e9).toString(36)+Date.now();u({toB58String:()=>h}),e=this.metrics.trackStream({stream:e,remotePeer:f})}Ni("Starting the outbound connection upgrade");let d=e;this.protector&&(d=await this.protector.protect(e));try{if({conn:n,remotePeer:s,protocol:a}=await this._encryptOutbound(this.localPeer,d,i,this.cryptos),await this.connectionGater.denyOutboundEncryptedConnection(s,n))throw Cs(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Os.ERR_CONNECTION_INTERCEPTED);this.muxers.size?{stream:o,Muxer:c}=await this._multiplexOutbound(n,this.muxers):o=n}catch(h){throw Ni.error("Failed to upgrade outbound connection",h),await e.close(h),h}if(await this.connectionGater.denyOutboundUpgradedConnection(s,n))throw Cs(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Os.ERR_CONNECTION_INTERCEPTED);return this.metrics&&(this.metrics.updatePlaceholder(f,s),u(s)),Ni("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:o,Muxer:c,remotePeer:s})}_createConnection({cryptoProtocol:e,direction:t,maConn:i,upgradedConn:n,Muxer:s,remotePeer:o}){let a,c,u;s&&(a=new s({onStream:async h=>{if(!u)return;let p=new iy.Listener(h);try{let{stream:y,protocol:g}=await p.handle(Array.from(this.protocols.keys()));Ni("%s: incoming stream opened on %s",t,g),this.metrics&&this.metrics.trackStream({stream:y,remotePeer:o,protocol:g}),u.addStream(h,{protocol:g}),this._onStream({connection:u,stream:{...h,...y},protocol:g})}catch(y){Ni.error(y)}},onStreamEnd:h=>{u.removeStream(h.id)}}),c=async h=>{Ni("%s: starting new stream on %s",t,h);let p=a.newStream(),y=new iy.Dialer(p);try{let{stream:g,protocol:w}=await y.select(h);return this.metrics&&this.metrics.trackStream({stream:g,remotePeer:o,protocol:w}),{stream:{...p,...g},protocol:w}}catch(g){throw Ni.error("could not create new stream",g),Cs(g,Os.ERR_UNSUPPORTED_PROTOCOL)}},ZJe(n,a,n).catch(Ni.error));let f=i.timeline;i.timeline=new Proxy(f,{set:(...h)=>(u&&h[1]==="close"&&h[2]&&!f.close&&(async()=>{try{u.stat.status==="open"&&await u.close()}catch(p){Ni.error(p)}finally{this.onConnectionEnd(u)}})().catch(p=>{Ni.error(p)}),Reflect.set(...h))}),i.timeline.upgraded=Date.now();let d=()=>{throw Cs(new Error("connection is not multiplexed"),Os.ERR_CONNECTION_NOT_MULTIPLEXED)};return u=new XJe({localAddr:i.localAddr,remoteAddr:i.remoteAddr,localPeer:this.localPeer,remotePeer:o,stat:{direction:t,timeline:i.timeline,multiplexer:s&&s.multicodec,encryption:e},newStream:c||d,getStreams:()=>a?a.streams:d(),close:async()=>{await i.close(),a&&a.streams.map(h=>h.abort())}}),this.onConnection(u),u}_onStream({connection:e,stream:t,protocol:i}){this.protocols.get(i)({connection:e,stream:t,protocol:i})}async _encryptInbound(e,t,i){let n=new iy.Listener(t),s=Array.from(i.keys());Ni("handling inbound crypto protocol selection",s);try{let{stream:o,protocol:a}=await n.handle(s),c=i.get(a);if(Ni("encrypting inbound connection..."),!c)throw new Error(`no crypto module found for ${a}`);return{...await c.secureInbound(e,o),protocol:a}}catch(o){throw Cs(o,Os.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,t,i,n){let s=new iy.Dialer(t),o=Array.from(n.keys());Ni("selecting outbound crypto protocol",o);try{let{stream:a,protocol:c}=await s.select(o),u=n.get(c);if(Ni("encrypting outbound connection to %j",i),!u)throw new Error(`no crypto module found for ${c}`);return{...await u.secureOutbound(e,a,i),protocol:c}}catch(a){throw Cs(a,Os.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,t){let i=new iy.Dialer(e),n=Array.from(t.keys());Ni("outbound selecting muxer %s",n);try{let{stream:s,protocol:o}=await i.select(n);Ni("%s selected as muxer protocol",o);let a=t.get(o);return{stream:s,Muxer:a}}catch(s){throw Cs(s,Os.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,t){let i=new iy.Listener(e),n=Array.from(t.keys());Ni("inbound handling muxers %s",n);try{let{stream:s,protocol:o}=await i.handle(n),a=t.get(o);return{stream:s,Muxer:a}}catch(s){throw Cs(s,Os.ERR_MUXER_UNAVAILABLE)}}};Ame.exports=Sme});var Ime=m((lBt,xme)=>{l();"use strict";var JJe=async function*(r,e){for await(let t of r)await e(t),yield t};xme.exports=JJe});var Nme=m((fBt,Dme)=>{l();"use strict";var Tme=le(),Nh=br(),{Multiaddr:Pme}=lt(),P_=st(),{codes:_a}=wr(),Cme=d_(),Ome=um(),{pipe:eet}=dr(),tet=Jo(),ret=is(),iet=wn(),net=Ime(),sr=Object.assign(Tme("libp2p:peer-store:address-book"),{error:Tme("libp2p:peer-store:address-book:err")}),C_="change:multiaddrs",kme=class{constructor(e,t,i){this._emit=e,this._store=t,this._addressFilter=i}async consumePeerRecord(e){sr("consumePeerRecord await write lock");let t=await this._store.lock.writeLock();sr("consumePeerRecord got write lock");let i,n;try{let s;try{s=Cme.createFromProtobuf(e.payload)}catch(a){return sr.error("invalid peer record received"),!1}i=s.peerId;let o=s.multiaddrs;if(!i.equals(e.peerId))return sr("signing key does not match PeerId in the PeerRecord"),!1;if(!o||!o.length)return!1;if(await this._store.has(i)){let a=await this._store.load(i);if(a.peerRecordEnvelope){let c=await Ome.createFromProtobuf(a.peerRecordEnvelope);if(Cme.createFromProtobuf(c.payload).seqNumber>=s.seqNumber)return!1}}n=await this._store.patchOrCreate(i,{addresses:await $C(i,o,this._addressFilter,!0),peerRecordEnvelope:e.marshal()}),sr(`stored provided peer record for ${s.peerId.toB58String()}`)}finally{sr("consumePeerRecord release write lock"),t()}return this._emit(C_,{peerId:i,multiaddrs:n.addresses.map(({multiaddr:s})=>s)}),!0}async getRawEnvelope(e){sr("getRawEnvelope await read lock");let t=await this._store.lock.readLock();sr("getRawEnvelope got read lock");try{return(await this._store.load(e)).peerRecordEnvelope}catch(i){if(i.code!==_a.ERR_NOT_FOUND)throw i}finally{sr("getRawEnvelope release read lock"),t()}}async getPeerRecord(e){let t=await this.getRawEnvelope(e);if(!!t)return Ome.createFromProtobuf(t)}async get(e){if(!P_.isPeerId(e))throw sr.error("peerId must be an instance of peer-id to store data"),Nh(new Error("peerId must be an instance of peer-id"),_a.ERR_INVALID_PARAMETERS);sr("get wait for read lock");let t=await this._store.lock.readLock();sr("get got read lock");try{return(await this._store.load(e)).addresses}catch(i){if(i.code!==_a.ERR_NOT_FOUND)throw i}finally{sr("get release read lock"),t()}return[]}async set(e,t){if(!P_.isPeerId(e))throw sr.error("peerId must be an instance of peer-id to store data"),Nh(new Error("peerId must be an instance of peer-id"),_a.ERR_INVALID_PARAMETERS);if(!Array.isArray(t))throw sr.error("multiaddrs must be an array of Multiaddrs"),Nh(new Error("multiaddrs must be an array of Multiaddrs"),_a.ERR_INVALID_PARAMETERS);sr("set await write lock");let i=await this._store.lock.writeLock();sr("set got write lock");let n=!1,s;try{let o=await $C(e,t,this._addressFilter);if(!o.length)return;try{let a=await this._store.load(e);if(n=!0,new Set([...o.map(({multiaddr:c})=>c.toString()),...a.addresses.map(({multiaddr:c})=>c.toString())]).size===a.addresses.length&&o.length===a.addresses.length)return}catch(a){if(a.code!==_a.ERR_NOT_FOUND)throw a}s=await this._store.patchOrCreate(e,{addresses:o}),sr(`set multiaddrs for ${e.toB58String()}`)}finally{sr("set release write lock"),i()}this._emit(C_,{peerId:e,multiaddrs:s.addresses.map(o=>o.multiaddr)}),n||this._emit("peer",e)}async add(e,t){if(!P_.isPeerId(e))throw sr.error("peerId must be an instance of peer-id to store data"),Nh(new Error("peerId must be an instance of peer-id"),_a.ERR_INVALID_PARAMETERS);if(!Array.isArray(t))throw sr.error("multiaddrs must be an array of Multiaddrs"),Nh(new Error("multiaddrs must be an array of Multiaddrs"),_a.ERR_INVALID_PARAMETERS);sr("add await write lock");let i=await this._store.lock.writeLock();sr("add got write lock");let n,s;try{let o=await $C(e,t,this._addressFilter);if(!o.length)return;try{let a=await this._store.load(e);if(n=!0,new Set([...o.map(({multiaddr:c})=>c.toString()),...a.addresses.map(({multiaddr:c})=>c.toString())]).size===a.addresses.length)return}catch(a){if(a.code!==_a.ERR_NOT_FOUND)throw a}s=await this._store.mergeOrCreate(e,{addresses:o}),sr(`added multiaddrs for ${e.toB58String()}`)}finally{sr("set release write lock"),i()}this._emit(C_,{peerId:e,multiaddrs:s.addresses.map(o=>o.multiaddr)}),n||this._emit("peer",e)}async delete(e){if(!P_.isPeerId(e))throw sr.error("peerId must be an instance of peer-id to store data"),Nh(new Error("peerId must be an instance of peer-id"),_a.ERR_INVALID_PARAMETERS);sr("delete await write lock");let t=await this._store.lock.writeLock();sr("delete got write lock");let i;try{i=await this._store.has(e),await this._store.patchOrCreate(e,{addresses:[]})}finally{sr("delete release write lock"),t()}i&&this._emit(C_,{peerId:e,multiaddrs:[]})}async getMultiaddrsForPeer(e,t=i=>i){let i=await this.get(e);return t(i).map(n=>{let s=n.multiaddr,o=s.getPeerId();return o&&o===e.toB58String()?s:s.encapsulate(`/p2p/${e.toB58String()}`)})}};function $C(r,e,t,i=!1){return eet(e,n=>net(n,s=>{if(!Pme.isMultiaddr(s))throw sr.error("multiaddr must be an instance of Multiaddr"),Nh(new Error("multiaddr must be an instance of Multiaddr"),_a.ERR_INVALID_PARAMETERS)}),n=>ret(n,s=>t(r,s)),n=>iet(n,s=>({multiaddr:new Pme(s.toString()),isCertified:i})),n=>tet(n))}Dme.exports=kme});var qme=m((dBt,jme)=>{l();"use strict";var Bme=le(),O_=br(),{codes:ny}=wr(),GC=st(),{equals:set}=(hi(),hn),ks=Object.assign(Bme("libp2p:peer-store:key-book"),{error:Bme("libp2p:peer-store:key-book:err")}),Lme="change:pubkey",Mme=class{constructor(e,t){this._emit=e,this._store=t}async set(e,t){if(!GC.isPeerId(e))throw ks.error("peerId must be an instance of peer-id to store data"),O_(new Error("peerId must be an instance of peer-id"),ny.ERR_INVALID_PARAMETERS);if(!t)throw ks.error("publicKey must be an instance of PublicKey to store data"),O_(new Error("publicKey must be an instance of PublicKey"),ny.ERR_INVALID_PARAMETERS);ks("set await write lock");let i=await this._store.lock.writeLock();ks("set got write lock");let n=!1;try{try{let s=await this._store.load(e);if(s.pubKey&&set(s.pubKey.bytes,t.bytes))return}catch(s){if(s.code!==ny.ERR_NOT_FOUND)throw s}await this._store.patchOrCreate(e,{pubKey:t}),n=!0}finally{ks("set release write lock"),i()}n&&this._emit(Lme,{peerId:e,pubKey:t})}async get(e){if(!GC.isPeerId(e))throw ks.error("peerId must be an instance of peer-id to store data"),O_(new Error("peerId must be an instance of peer-id"),ny.ERR_INVALID_PARAMETERS);ks("get await write lock");let t=await this._store.lock.readLock();ks("get got write lock");try{return(await this._store.load(e)).pubKey}catch(i){if(i.code!==ny.ERR_NOT_FOUND)throw i}finally{ks("get release write lock"),t()}}async delete(e){if(!GC.isPeerId(e))throw ks.error("peerId must be an instance of peer-id to store data"),O_(new Error("peerId must be an instance of peer-id"),ny.ERR_INVALID_PARAMETERS);ks("delete await write lock");let t=await this._store.lock.writeLock();ks("delete got write lock");try{await this._store.patchOrCreate(e,{pubKey:void 0})}finally{ks("delete release write lock"),t()}this._emit(Lme,{peerId:e,pubKey:void 0})}};jme.exports=Mme});var Vme=m((hBt,Kme)=>{l();"use strict";var Ume=le(),Tf=br(),{codes:ko}=wr(),sy=st(),{equals:oet}=(hi(),hn),Cr=Object.assign(Ume("libp2p:peer-store:metadata-book"),{error:Ume("libp2p:peer-store:metadata-book:err")}),k_="change:metadata",Fme=class{constructor(e,t){this._emit=e,this._store=t}async get(e){if(!sy.isPeerId(e))throw Cr.error("peerId must be an instance of peer-id to store data"),Tf(new Error("peerId must be an instance of peer-id"),ko.ERR_INVALID_PARAMETERS);Cr("get await read lock");let t=await this._store.lock.readLock();Cr("get got read lock");try{return(await this._store.load(e)).metadata}catch(i){if(i.code!==ko.ERR_NOT_FOUND)throw i}finally{Cr("get release read lock"),t()}return new Map}async getValue(e,t){if(!sy.isPeerId(e))throw Cr.error("peerId must be an instance of peer-id to store data"),Tf(new Error("peerId must be an instance of peer-id"),ko.ERR_INVALID_PARAMETERS);Cr("getValue await read lock");let i=await this._store.lock.readLock();Cr("getValue got read lock");try{return(await this._store.load(e)).metadata.get(t)}catch(n){if(n.code!==ko.ERR_NOT_FOUND)throw n}finally{Cr("getValue release write lock"),i()}}async set(e,t){if(!sy.isPeerId(e))throw Cr.error("peerId must be an instance of peer-id to store data"),Tf(new Error("peerId must be an instance of peer-id"),ko.ERR_INVALID_PARAMETERS);if(!t||!(t instanceof Map))throw Cr.error("valid metadata must be provided to store data"),Tf(new Error("valid metadata must be provided"),ko.ERR_INVALID_PARAMETERS);Cr("set await write lock");let i=await this._store.lock.writeLock();Cr("set got write lock");try{await this._store.mergeOrCreate(e,{metadata:t})}finally{Cr("set release write lock"),i()}this._emit(k_,{peerId:e,metadata:t})}async setValue(e,t,i){if(!sy.isPeerId(e))throw Cr.error("peerId must be an instance of peer-id to store data"),Tf(new Error("peerId must be an instance of peer-id"),ko.ERR_INVALID_PARAMETERS);if(typeof t!="string"||!(i instanceof Uint8Array))throw Cr.error("valid key and value must be provided to store data"),Tf(new Error("valid key and value must be provided"),ko.ERR_INVALID_PARAMETERS);Cr("setValue await write lock");let n=await this._store.lock.writeLock();Cr("setValue got write lock");let s;try{try{let a=(await this._store.load(e)).metadata.get(t);if(a!=null&&oet(i,a))return}catch(o){if(o.code!==ko.ERR_NOT_FOUND)throw o}s=await this._store.mergeOrCreate(e,{metadata:new Map([[t,i]])})}finally{Cr("setValue release write lock"),n()}this._emit(k_,{peerId:e,metadata:s.metadata})}async delete(e){if(!sy.isPeerId(e))throw Cr.error("peerId must be an instance of peer-id to store data"),Tf(new Error("peerId must be an instance of peer-id"),ko.ERR_INVALID_PARAMETERS);Cr("delete await write lock");let t=await this._store.lock.writeLock();Cr("delete got write lock");let i;try{i=await this._store.has(e),i&&await this._store.patch(e,{metadata:new Map})}finally{Cr("delete release write lock"),t()}i&&this._emit(k_,{peerId:e,metadata:new Map})}async deleteValue(e,t){if(!sy.isPeerId(e))throw Cr.error("peerId must be an instance of peer-id to store data"),Tf(new Error("peerId must be an instance of peer-id"),ko.ERR_INVALID_PARAMETERS);Cr("deleteValue await write lock");let i=await this._store.lock.writeLock();Cr("deleteValue got write lock");let n;try{n=(await this._store.load(e)).metadata,n.delete(t),await this._store.patch(e,{metadata:n})}catch(s){if(s.code!==ko.ERR_NOT_FOUND)throw s}finally{Cr("deleteValue release write lock"),i()}n&&this._emit(k_,{peerId:e,metadata:n})}};Kme.exports=Fme});var Gme=m((pBt,$me)=>{l();"use strict";var zme=le(),oy=br(),{codes:va}=wr(),WC=st(),Wr=Object.assign(zme("libp2p:peer-store:proto-book"),{error:zme("libp2p:peer-store:proto-book:err")}),D_="change:protocols",Hme=class{constructor(e,t){this._emit=e,this._store=t}async get(e){Wr("get wait for read lock");let t=await this._store.lock.readLock();Wr("get got read lock");try{return(await this._store.load(e)).protocols}catch(i){if(i.code!==va.ERR_NOT_FOUND)throw i}finally{Wr("get release read lock"),t()}return[]}async set(e,t){if(!WC.isPeerId(e))throw Wr.error("peerId must be an instance of peer-id to store data"),oy(new Error("peerId must be an instance of peer-id"),va.ERR_INVALID_PARAMETERS);if(!Array.isArray(t))throw Wr.error("protocols must be provided to store data"),oy(new Error("protocols must be provided"),va.ERR_INVALID_PARAMETERS);Wr("set await write lock");let i=await this._store.lock.writeLock();Wr("set got write lock");let n;try{try{let s=await this._store.load(e);if(new Set([...t]).size===s.protocols.length)return}catch(s){if(s.code!==va.ERR_NOT_FOUND)throw s}n=await this._store.patchOrCreate(e,{protocols:t}),Wr(`stored provided protocols for ${e.toB58String()}`)}finally{Wr("set release write lock"),i()}this._emit(D_,{peerId:e,protocols:n.protocols})}async add(e,t){if(!WC.isPeerId(e))throw Wr.error("peerId must be an instance of peer-id to store data"),oy(new Error("peerId must be an instance of peer-id"),va.ERR_INVALID_PARAMETERS);if(!Array.isArray(t))throw Wr.error("protocols must be provided to store data"),oy(new Error("protocols must be provided"),va.ERR_INVALID_PARAMETERS);Wr("add await write lock");let i=await this._store.lock.writeLock();Wr("add got write lock");let n;try{try{let s=await this._store.load(e);if(new Set([...s.protocols,...t]).size===s.protocols.length)return}catch(s){if(s.code!==va.ERR_NOT_FOUND)throw s}n=await this._store.mergeOrCreate(e,{protocols:t}),Wr(`added provided protocols for ${e.toB58String()}`)}finally{Wr("add release write lock"),i()}this._emit(D_,{peerId:e,protocols:n.protocols})}async remove(e,t){if(!WC.isPeerId(e))throw Wr.error("peerId must be an instance of peer-id to store data"),oy(new Error("peerId must be an instance of peer-id"),va.ERR_INVALID_PARAMETERS);if(!Array.isArray(t))throw Wr.error("protocols must be provided to store data"),oy(new Error("protocols must be provided"),va.ERR_INVALID_PARAMETERS);Wr("remove await write lock");let i=await this._store.lock.writeLock();Wr("remove got write lock");let n;try{try{let s=await this._store.load(e),o=new Set(s.protocols);for(let a of t)o.delete(a);if(s.protocols.length===o.size)return;t=Array.from(o)}catch(s){if(s.code!==va.ERR_NOT_FOUND)throw s}n=await this._store.patchOrCreate(e,{protocols:t})}finally{Wr("remove release write lock"),i()}this._emit(D_,{peerId:e,protocols:n.protocols})}async delete(e){Wr("delete await write lock");let t=await this._store.lock.writeLock();Wr("delete got write lock");let i;try{i=await this._store.has(e),await this._store.patchOrCreate(e,{protocols:[]})}catch(n){if(n.code!==va.ERR_NOT_FOUND)throw n}finally{Wr("delete release write lock"),t()}i&&this._emit(D_,{peerId:e,protocols:[]})}};$me.exports=Hme});var Yme=m((yBt,Wme)=>{l();"use strict";var Pf=Br(),ay=Pf.Reader,YC=Pf.Writer,cr=Pf.util,_i=Pf.roots["libp2p-peer"]||(Pf.roots["libp2p-peer"]={});_i.Peer=function(){function r(t){if(this.addresses=[],this.protocols=[],this.metadata=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.addresses=cr.emptyArray,r.prototype.protocols=cr.emptyArray,r.prototype.metadata=cr.emptyArray,r.prototype.pubKey=null,r.prototype.peerRecordEnvelope=null;var e;return Object.defineProperty(r.prototype,"_pubKey",{get:cr.oneOfGetter(e=["pubKey"]),set:cr.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_peerRecordEnvelope",{get:cr.oneOfGetter(e=["peerRecordEnvelope"]),set:cr.oneOfSetter(e)}),r.encode=function(i,n){if(n||(n=YC.create()),i.addresses!=null&&i.addresses.length)for(var s=0;s<i.addresses.length;++s)_i.Address.encode(i.addresses[s],n.uint32(10).fork()).ldelim();if(i.protocols!=null&&i.protocols.length)for(var s=0;s<i.protocols.length;++s)n.uint32(18).string(i.protocols[s]);if(i.metadata!=null&&i.metadata.length)for(var s=0;s<i.metadata.length;++s)_i.Metadata.encode(i.metadata[s],n.uint32(26).fork()).ldelim();return i.pubKey!=null&&Object.hasOwnProperty.call(i,"pubKey")&&n.uint32(34).bytes(i.pubKey),i.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(i,"peerRecordEnvelope")&&n.uint32(42).bytes(i.peerRecordEnvelope),n},r.decode=function(i,n){i instanceof ay||(i=ay.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new _i.Peer;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.addresses&&o.addresses.length||(o.addresses=[]),o.addresses.push(_i.Address.decode(i,i.uint32()));break;case 2:o.protocols&&o.protocols.length||(o.protocols=[]),o.protocols.push(i.string());break;case 3:o.metadata&&o.metadata.length||(o.metadata=[]),o.metadata.push(_i.Metadata.decode(i,i.uint32()));break;case 4:o.pubKey=i.bytes();break;case 5:o.peerRecordEnvelope=i.bytes();break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof _i.Peer)return i;var n=new _i.Peer;if(i.addresses){if(!Array.isArray(i.addresses))throw TypeError(".Peer.addresses: array expected");n.addresses=[];for(var s=0;s<i.addresses.length;++s){if(typeof i.addresses[s]!="object")throw TypeError(".Peer.addresses: object expected");n.addresses[s]=_i.Address.fromObject(i.addresses[s])}}if(i.protocols){if(!Array.isArray(i.protocols))throw TypeError(".Peer.protocols: array expected");n.protocols=[];for(var s=0;s<i.protocols.length;++s)n.protocols[s]=String(i.protocols[s])}if(i.metadata){if(!Array.isArray(i.metadata))throw TypeError(".Peer.metadata: array expected");n.metadata=[];for(var s=0;s<i.metadata.length;++s){if(typeof i.metadata[s]!="object")throw TypeError(".Peer.metadata: object expected");n.metadata[s]=_i.Metadata.fromObject(i.metadata[s])}}return i.pubKey!=null&&(typeof i.pubKey=="string"?cr.base64.decode(i.pubKey,n.pubKey=cr.newBuffer(cr.base64.length(i.pubKey)),0):i.pubKey.length&&(n.pubKey=i.pubKey)),i.peerRecordEnvelope!=null&&(typeof i.peerRecordEnvelope=="string"?cr.base64.decode(i.peerRecordEnvelope,n.peerRecordEnvelope=cr.newBuffer(cr.base64.length(i.peerRecordEnvelope)),0):i.peerRecordEnvelope.length&&(n.peerRecordEnvelope=i.peerRecordEnvelope)),n},r.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addresses=[],s.protocols=[],s.metadata=[]),i.addresses&&i.addresses.length){s.addresses=[];for(var o=0;o<i.addresses.length;++o)s.addresses[o]=_i.Address.toObject(i.addresses[o],n)}if(i.protocols&&i.protocols.length){s.protocols=[];for(var o=0;o<i.protocols.length;++o)s.protocols[o]=i.protocols[o]}if(i.metadata&&i.metadata.length){s.metadata=[];for(var o=0;o<i.metadata.length;++o)s.metadata[o]=_i.Metadata.toObject(i.metadata[o],n)}return i.pubKey!=null&&i.hasOwnProperty("pubKey")&&(s.pubKey=n.bytes===String?cr.base64.encode(i.pubKey,0,i.pubKey.length):n.bytes===Array?Array.prototype.slice.call(i.pubKey):i.pubKey,n.oneofs&&(s._pubKey="pubKey")),i.peerRecordEnvelope!=null&&i.hasOwnProperty("peerRecordEnvelope")&&(s.peerRecordEnvelope=n.bytes===String?cr.base64.encode(i.peerRecordEnvelope,0,i.peerRecordEnvelope.length):n.bytes===Array?Array.prototype.slice.call(i.peerRecordEnvelope):i.peerRecordEnvelope,n.oneofs&&(s._peerRecordEnvelope="peerRecordEnvelope")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,Pf.util.toJSONOptions)},r}();_i.Address=function(){function r(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.multiaddr=cr.newBuffer([]),r.prototype.isCertified=null;var e;return Object.defineProperty(r.prototype,"_isCertified",{get:cr.oneOfGetter(e=["isCertified"]),set:cr.oneOfSetter(e)}),r.encode=function(i,n){return n||(n=YC.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),i.isCertified!=null&&Object.hasOwnProperty.call(i,"isCertified")&&n.uint32(16).bool(i.isCertified),n},r.decode=function(i,n){i instanceof ay||(i=ay.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new _i.Address;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;case 2:o.isCertified=i.bool();break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof _i.Address)return i;var n=new _i.Address;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?cr.base64.decode(i.multiaddr,n.multiaddr=cr.newBuffer(cr.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),i.isCertified!=null&&(n.isCertified=Boolean(i.isCertified)),n},r.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=cr.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?cr.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),i.isCertified!=null&&i.hasOwnProperty("isCertified")&&(s.isCertified=i.isCertified,n.oneofs&&(s._isCertified="isCertified")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,Pf.util.toJSONOptions)},r}();_i.Metadata=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.key="",r.prototype.value=cr.newBuffer([]),r.encode=function(t,i){return i||(i=YC.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&i.uint32(10).string(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(18).bytes(t.value),i},r.decode=function(t,i){t instanceof ay||(t=ay.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new _i.Metadata;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.key=t.string();break;case 2:s.value=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof _i.Metadata)return t;var i=new _i.Metadata;return t.key!=null&&(i.key=String(t.key)),t.value!=null&&(typeof t.value=="string"?cr.base64.decode(t.value,i.value=cr.newBuffer(cr.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.key="",i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=cr.newBuffer(n.value)))),t.key!=null&&t.hasOwnProperty("key")&&(n.key=t.key),t.value!=null&&t.hasOwnProperty("value")&&(n.value=i.bytes===String?cr.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Pf.util.toJSONOptions)},r}();Wme.exports=_i});var s3e=m((gBt,n3e)=>{l();"use strict";var Xme=le(),Qme=st(),Zme=br(),{codes:N_}=wr(),{Key:aet}=(Mr(),Ap),{base32:cet}=(rn(),Fc),{keys:{unmarshalPublicKey:uet,marshalPublicKey:fet}}=Qa(),{Multiaddr:Jme}=lt(),{Peer:e3e}=Yme(),det=z6(),{equals:het}=(hi(),hn),t3e=Object.assign(Xme("libp2p:peer-store:store"),{error:Xme("libp2p:peer-store:store:err")}),r3e="/peers/",i3e=class{constructor(e){this._datastore=e,this.lock=det("peer-store",{singleProcess:!0})}_peerIdToDatastoreKey(e){if(!Qme.isPeerId(e))throw t3e.error("peerId must be an instance of peer-id to store data"),Zme(new Error("peerId must be an instance of peer-id"),N_.ERR_INVALID_PARAMETERS);let t=e.toString();return new aet(`${r3e}${t}`)}async has(e){return this._datastore.has(this._peerIdToDatastoreKey(e))}async delete(e){await this._datastore.delete(this._peerIdToDatastoreKey(e))}async load(e){let t=await this._datastore.get(this._peerIdToDatastoreKey(e)),i=e3e.decode(t),n=i.pubKey?uet(i.pubKey):e.pubKey,s=new Map;for(let o of i.metadata)s.set(o.key,o.value);return{...i,id:e,pubKey:n,addresses:i.addresses.map(({multiaddr:o,isCertified:a})=>({multiaddr:new Jme(o),isCertified:a||!1})),metadata:s,peerRecordEnvelope:i.peerRecordEnvelope||void 0}}async save(e){if(e.pubKey!=null&&e.id.pubKey!=null&&!het(e.pubKey.bytes,e.id.pubKey.bytes))throw t3e.error("peer publicKey bytes do not match peer id publicKey bytes"),Zme(new Error("publicKey bytes do not match peer id publicKey bytes"),N_.ERR_INVALID_PARAMETERS);let t=new Set,i=e3e.encode({addresses:e.addresses.filter(n=>t.has(n.multiaddr.toString())?!1:(t.add(n.multiaddr.toString()),!0)).sort((n,s)=>n.multiaddr.toString().localeCompare(s.multiaddr.toString())).map(({multiaddr:n,isCertified:s})=>({multiaddr:n.bytes,isCertified:s})),protocols:e.protocols.sort(),pubKey:e.pubKey?fet(e.pubKey):void 0,metadata:[...e.metadata.keys()].sort().map(n=>({key:n,value:e.metadata.get(n)})),peerRecordEnvelope:e.peerRecordEnvelope}).finish();return await this._datastore.put(this._peerIdToDatastoreKey(e.id),i),this.load(e.id)}async patch(e,t){let i=await this.load(e);return await this._patch(e,t,i)}async patchOrCreate(e,t){let i;try{i=await this.load(e)}catch(n){if(n.code!==N_.ERR_NOT_FOUND)throw n;i={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._patch(e,t,i)}async _patch(e,t,i){return await this.save({...i,...t,id:e})}async merge(e,t){let i=await this.load(e);return this._merge(e,t,i)}async mergeOrCreate(e,t){let i;try{i=await this.load(e)}catch(n){if(n.code!==N_.ERR_NOT_FOUND)throw n;i={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._merge(e,t,i)}async _merge(e,t,i){let n=new Map;return(t.addresses||[]).forEach(s=>{n.set(s.multiaddr.toString(),s.isCertified)}),i.addresses.forEach(({multiaddr:s,isCertified:o})=>{let a=s.toString();n.set(a,Boolean(n.get(a)||o))}),await this.save({id:e,addresses:Array.from(n.entries()).map(([s,o])=>({multiaddr:new Jme(s),isCertified:o})),protocols:Array.from(new Set([...i.protocols||[],...t.protocols||[]])),metadata:new Map([...i.metadata?i.metadata.entries():[],...t.metadata?t.metadata.entries():[]]),pubKey:t.pubKey||(i!=null?i.pubKey:void 0),peerRecordEnvelope:t.peerRecordEnvelope||(i!=null?i.peerRecordEnvelope:void 0)})}async*all(){for await(let e of this._datastore.queryKeys({prefix:r3e})){let t=e.toString().split("/")[2],i=cet.decode(t);yield this.load(Qme.createFromBytes(i))}}};n3e.exports=i3e});var u3e=m((mBt,c3e)=>{l();"use strict";var o3e=le(),{EventEmitter:pet}=Ut(),yet=Nme(),get=qme(),met=Vme(),bet=Gme(),wet=s3e(),Do=Object.assign(o3e("libp2p:peer-store"),{error:o3e("libp2p:peer-store:err")}),a3e=class extends pet{constructor({peerId:e,datastore:t,addressFilter:i}){super();this._peerId=e,this._store=new wet(t),this.addressBook=new yet(this.emit.bind(this),this._store,i),this.keyBook=new get(this.emit.bind(this),this._store),this.metadataBook=new met(this.emit.bind(this),this._store),this.protoBook=new bet(this.emit.bind(this),this._store)}async*getPeers(){Do("getPeers await read lock");let e=await this._store.lock.readLock();Do("getPeers got read lock");try{for await(let t of this._store.all())t.id.toB58String()!==this._peerId.toB58String()&&(yield t)}finally{Do("getPeers release read lock"),e()}}async delete(e){Do("delete await write lock");let t=await this._store.lock.writeLock();Do("delete got write lock");try{await this._store.delete(e)}finally{Do("delete release write lock"),t()}}async get(e){Do("get await read lock");let t=await this._store.lock.readLock();Do("get got read lock");try{return this._store.load(e)}finally{Do("get release read lock"),t()}}async has(e){Do("has await read lock");let t=await this._store.lock.readLock();Do("has got read lock");try{return this._store.has(e)}finally{Do("has release read lock"),t()}}};c3e.exports=a3e});var f3e=m((bBt,l3e)=>{l();"use strict";function _et(r,e,t){let i=new r(e,t);i._subscribeAdapter=i.subscribe,i._unsubscribeAdapter=i.unsubscribe;function n(o,a){a&&i.on(o,a),i._subscribeAdapter(o)}function s(o,a){a?i.removeListener(o,a):i.removeAllListeners(o),i.listenerCount(o)===0&&i._unsubscribeAdapter(o)}return i.subscribe=n,i.unsubscribe=s,i}l3e.exports=_et});var y3e=m((wBt,p3e)=>{l();"use strict";var d3e=le(),vet=Object.assign(d3e("libp2p:registrar"),{error:d3e("libp2p:registrar:err")}),Eet=br(),{codes:{ERR_INVALID_PARAMETERS:Aet}}=wr(),Ret=xI(),h3e=class{constructor({peerStore:e,connectionManager:t}){this.peerStore=e,this.connectionManager=t,this.topologies=new Map,this._handle=void 0,this._onDisconnect=this._onDisconnect.bind(this),this.connectionManager.on("peer:disconnect",this._onDisconnect)}get handle(){return this._handle}set handle(e){this._handle=e}getConnection(e){return this.connectionManager.get(e)}async register(e){if(!Ret.isTopology(e))throw vet.error("topology must be an instance of interfaces/topology"),Eet(new Error("topology must be an instance of interfaces/topology"),Aet);let t=(Math.random()*1e9).toString(36)+Date.now();return this.topologies.set(t,e),await e.setRegistrar(this),t}unregister(e){return this.topologies.delete(e)}_onDisconnect(e){for(let[,t]of this.topologies)t.disconnect(e.remotePeer)}};p3e.exports=h3e});var b3e=m((_Bt,m3e)=>{l();"use strict";var cy=Br(),g3e=cy.Reader,xet=cy.Writer,Gr=cy.util,s3=cy.roots["libp2p-identify"]||(cy.roots["libp2p-identify"]={});s3.Identify=function(){function r(e){if(this.listenAddrs=[],this.protocols=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.protocolVersion="",r.prototype.agentVersion="",r.prototype.publicKey=Gr.newBuffer([]),r.prototype.listenAddrs=Gr.emptyArray,r.prototype.observedAddr=Gr.newBuffer([]),r.prototype.protocols=Gr.emptyArray,r.prototype.signedPeerRecord=Gr.newBuffer([]),r.encode=function(t,i){if(i||(i=xet.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&i.uint32(10).bytes(t.publicKey),t.listenAddrs!=null&&t.listenAddrs.length)for(var n=0;n<t.listenAddrs.length;++n)i.uint32(18).bytes(t.listenAddrs[n]);if(t.protocols!=null&&t.protocols.length)for(var n=0;n<t.protocols.length;++n)i.uint32(26).string(t.protocols[n]);return t.observedAddr!=null&&Object.hasOwnProperty.call(t,"observedAddr")&&i.uint32(34).bytes(t.observedAddr),t.protocolVersion!=null&&Object.hasOwnProperty.call(t,"protocolVersion")&&i.uint32(42).string(t.protocolVersion),t.agentVersion!=null&&Object.hasOwnProperty.call(t,"agentVersion")&&i.uint32(50).string(t.agentVersion),t.signedPeerRecord!=null&&Object.hasOwnProperty.call(t,"signedPeerRecord")&&i.uint32(66).bytes(t.signedPeerRecord),i},r.decode=function(t,i){t instanceof g3e||(t=g3e.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new s3.Identify;t.pos<n;){var o=t.uint32();switch(o>>>3){case 5:s.protocolVersion=t.string();break;case 6:s.agentVersion=t.string();break;case 1:s.publicKey=t.bytes();break;case 2:s.listenAddrs&&s.listenAddrs.length||(s.listenAddrs=[]),s.listenAddrs.push(t.bytes());break;case 4:s.observedAddr=t.bytes();break;case 3:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(t.string());break;case 8:s.signedPeerRecord=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof s3.Identify)return t;var i=new s3.Identify;if(t.protocolVersion!=null&&(i.protocolVersion=String(t.protocolVersion)),t.agentVersion!=null&&(i.agentVersion=String(t.agentVersion)),t.publicKey!=null&&(typeof t.publicKey=="string"?Gr.base64.decode(t.publicKey,i.publicKey=Gr.newBuffer(Gr.base64.length(t.publicKey)),0):t.publicKey.length&&(i.publicKey=t.publicKey)),t.listenAddrs){if(!Array.isArray(t.listenAddrs))throw TypeError(".Identify.listenAddrs: array expected");i.listenAddrs=[];for(var n=0;n<t.listenAddrs.length;++n)typeof t.listenAddrs[n]=="string"?Gr.base64.decode(t.listenAddrs[n],i.listenAddrs[n]=Gr.newBuffer(Gr.base64.length(t.listenAddrs[n])),0):t.listenAddrs[n].length&&(i.listenAddrs[n]=t.listenAddrs[n])}if(t.observedAddr!=null&&(typeof t.observedAddr=="string"?Gr.base64.decode(t.observedAddr,i.observedAddr=Gr.newBuffer(Gr.base64.length(t.observedAddr)),0):t.observedAddr.length&&(i.observedAddr=t.observedAddr)),t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Identify.protocols: array expected");i.protocols=[];for(var n=0;n<t.protocols.length;++n)i.protocols[n]=String(t.protocols[n])}return t.signedPeerRecord!=null&&(typeof t.signedPeerRecord=="string"?Gr.base64.decode(t.signedPeerRecord,i.signedPeerRecord=Gr.newBuffer(Gr.base64.length(t.signedPeerRecord)),0):t.signedPeerRecord.length&&(i.signedPeerRecord=t.signedPeerRecord)),i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.listenAddrs=[],n.protocols=[]),i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=Gr.newBuffer(n.publicKey))),i.bytes===String?n.observedAddr="":(n.observedAddr=[],i.bytes!==Array&&(n.observedAddr=Gr.newBuffer(n.observedAddr))),n.protocolVersion="",n.agentVersion="",i.bytes===String?n.signedPeerRecord="":(n.signedPeerRecord=[],i.bytes!==Array&&(n.signedPeerRecord=Gr.newBuffer(n.signedPeerRecord)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?Gr.base64.encode(t.publicKey,0,t.publicKey.length):i.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.listenAddrs&&t.listenAddrs.length){n.listenAddrs=[];for(var s=0;s<t.listenAddrs.length;++s)n.listenAddrs[s]=i.bytes===String?Gr.base64.encode(t.listenAddrs[s],0,t.listenAddrs[s].length):i.bytes===Array?Array.prototype.slice.call(t.listenAddrs[s]):t.listenAddrs[s]}if(t.protocols&&t.protocols.length){n.protocols=[];for(var s=0;s<t.protocols.length;++s)n.protocols[s]=t.protocols[s]}return t.observedAddr!=null&&t.hasOwnProperty("observedAddr")&&(n.observedAddr=i.bytes===String?Gr.base64.encode(t.observedAddr,0,t.observedAddr.length):i.bytes===Array?Array.prototype.slice.call(t.observedAddr):t.observedAddr),t.protocolVersion!=null&&t.hasOwnProperty("protocolVersion")&&(n.protocolVersion=t.protocolVersion),t.agentVersion!=null&&t.hasOwnProperty("agentVersion")&&(n.agentVersion=t.agentVersion),t.signedPeerRecord!=null&&t.hasOwnProperty("signedPeerRecord")&&(n.signedPeerRecord=i.bytes===String?Gr.base64.encode(t.signedPeerRecord,0,t.signedPeerRecord.length):i.bytes===Array?Array.prototype.slice.call(t.signedPeerRecord):t.signedPeerRecord),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,cy.util.toJSONOptions)},r}();m3e.exports=s3});var I3e=m((vBt,x3e)=>{l();"use strict";var w3e=le(),Ds=Object.assign(w3e("libp2p:identify"),{error:w3e("libp2p:identify:err")}),XC=br(),B_=go(),{pipe:L_}=dr(),{collect:_3e,take:v3e,consume:E3e}=S_(),{fromString:uy}=(at(),Xr),Iet=st(),{Multiaddr:QC}=lt(),{toBuffer:S3e}=T8(),o3=b3e(),A3e=um(),R3e=d_(),{MULTICODEC_IDENTIFY:Tet,MULTICODEC_IDENTIFY_PUSH:Pet,IDENTIFY_PROTOCOL_VERSION:Cet,MULTICODEC_IDENTIFY_PROTOCOL_NAME:Oet,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME:ket,MULTICODEC_IDENTIFY_PROTOCOL_VERSION:Det,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION:Net}=sC(),{codes:ZC}=wr(),Bh=class{static getProtocolStr(e){return{identifyProtocolStr:`/${e._config.protocolPrefix}/${Oet}/${Det}`,identifyPushProtocolStr:`/${e._config.protocolPrefix}/${ket}/${Net}`}}constructor({libp2p:e}){this._libp2p=e,this.peerStore=e.peerStore,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.handleMessage=this.handleMessage.bind(this);let t=Bh.getProtocolStr(e);this.identifyProtocolStr=t.identifyProtocolStr,this.identifyPushProtocolStr=t.identifyPushProtocolStr,this._host={protocolVersion:`${e._config.protocolPrefix}/${Cet}`,...e._options.host},this.connectionManager.on("peer:connect",i=>{this.identify(i).catch(Ds.error)}),this.peerStore.on("change:multiaddrs",({peerId:i})=>{i.toString()===this.peerId.toString()&&this.pushToPeerStore().catch(n=>Ds.error(n))}),this.peerStore.on("change:protocols",({peerId:i})=>{i.toString()===this.peerId.toString()&&this.pushToPeerStore().catch(n=>Ds.error(n))})}async start(){await this.peerStore.metadataBook.setValue(this.peerId,"AgentVersion",uy(this._host.agentVersion)),await this.peerStore.metadataBook.setValue(this.peerId,"ProtocolVersion",uy(this._host.protocolVersion))}async stop(){}async push(e){let t=await this.peerStore.addressBook.getRawEnvelope(this.peerId),i=this._libp2p.multiaddrs.map(o=>o.bytes),n=await this.peerStore.protoBook.get(this.peerId),s=e.map(async o=>{try{let{stream:a}=await o.newStream(this.identifyPushProtocolStr);await L_([o3.Identify.encode({listenAddrs:i,signedPeerRecord:t,protocols:n}).finish()],B_.encode(),a,E3e)}catch(a){Ds.error("could not push identify update to peer",a)}});return Promise.all(s)}async pushToPeerStore(){if(!this._libp2p.isStarted())return;let e=[],t;for await(let i of this.peerStore.getPeers())i.protocols.includes(this.identifyPushProtocolStr)&&(t=this.connectionManager.get(i.id))&&e.push(t);await this.push(e)}async identify(e){let{stream:t}=await e.newStream(this.identifyProtocolStr),[i]=await L_([],t,B_.decode(),v3e(1),S3e,_3e);if(!i)throw XC(new Error("No data could be retrieved"),ZC.ERR_CONNECTION_ENDED);let n;try{n=o3.Identify.decode(i)}catch(h){throw XC(h,ZC.ERR_INVALID_MESSAGE)}let{publicKey:s,listenAddrs:o,protocols:a,observedAddr:c,signedPeerRecord:u}=n,f=await Iet.createFromPubKey(s);if(e.remotePeer.toB58String()!==f.toB58String())throw XC(new Error("identified peer does not match the expected peer"),ZC.ERR_INVALID_PEER);let d=Bh.getCleanMultiaddr(c);try{let h=await A3e.openAndCertify(u,R3e.DOMAIN);if(await this.peerStore.addressBook.consumePeerRecord(h)){await this.peerStore.protoBook.set(f,a),await this.peerStore.metadataBook.setValue(f,"AgentVersion",uy(n.agentVersion)),await this.peerStore.metadataBook.setValue(f,"ProtocolVersion",uy(n.protocolVersion));return}}catch(h){Ds("received invalid envelope, discard it and fallback to listenAddrs is available",h)}try{await this.peerStore.addressBook.set(f,o.map(h=>new QC(h)))}catch(h){Ds.error("received invalid addrs",h)}await this.peerStore.protoBook.set(f,a),await this.peerStore.metadataBook.setValue(f,"AgentVersion",uy(n.agentVersion)),await this.peerStore.metadataBook.setValue(f,"ProtocolVersion",uy(n.protocolVersion)),Ds("received observed address of %s",d)}handleMessage({connection:e,stream:t,protocol:i}){switch(i){case this.identifyProtocolStr:return this._handleIdentify({connection:e,stream:t});case this.identifyPushProtocolStr:return this._handlePush({connection:e,stream:t});default:Ds.error("cannot handle unknown protocol %s",i)}}async _handleIdentify({connection:e,stream:t}){try{let i=new Uint8Array(0);this.peerId.pubKey&&(i=this.peerId.pubKey.bytes);let n=await this.peerStore.addressBook.getRawEnvelope(this.peerId),s=await this.peerStore.protoBook.get(this.peerId),o=o3.Identify.encode({protocolVersion:this._host.protocolVersion,agentVersion:this._host.agentVersion,publicKey:i,listenAddrs:this._libp2p.multiaddrs.map(a=>a.bytes),signedPeerRecord:n,observedAddr:e.remoteAddr.bytes,protocols:s}).finish();await L_([o],B_.encode(),t,E3e)}catch(i){Ds.error("could not respond to identify request",i)}}async _handlePush({connection:e,stream:t}){let i;try{let[s]=await L_([],t,B_.decode(),v3e(1),S3e,_3e);i=o3.Identify.decode(s)}catch(s){return Ds.error("received invalid message",s)}let n=e.remotePeer;try{let s=await A3e.openAndCertify(i.signedPeerRecord,R3e.DOMAIN);if(await this.peerStore.addressBook.consumePeerRecord(s)){await this.peerStore.protoBook.set(n,i.protocols);return}}catch(s){Ds("received invalid envelope, discard it and fallback to listenAddrs is available",s)}try{await this.peerStore.addressBook.set(n,i.listenAddrs.map(s=>new QC(s)))}catch(s){Ds.error("received invalid addrs",s)}try{await this.peerStore.protoBook.set(n,i.protocols)}catch(s){Ds.error("received invalid protocols",s)}}static getCleanMultiaddr(e){if(e&&e.length>0)try{return new QC(e)}catch(t){return null}return null}},Bet={IDENTIFY:Tet,IDENTIFY_PUSH:Pet};Bh.multicodecs=Bet;Bh.Messsage=o3;x3e.exports=Bh});var C3e=m((EBt,P3e)=>{l();"use strict";var Lh=Br(),M_=Lh.Reader,T3e=Lh.Writer,ly=Lh.util,Oc=Lh.roots["libp2p-fetch"]||(Lh.roots["libp2p-fetch"]={});Oc.FetchRequest=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.identifier="",r.encode=function(t,i){return i||(i=T3e.create()),t.identifier!=null&&Object.hasOwnProperty.call(t,"identifier")&&i.uint32(10).string(t.identifier),i},r.decode=function(t,i){t instanceof M_||(t=M_.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Oc.FetchRequest;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.identifier=t.string();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Oc.FetchRequest)return t;var i=new Oc.FetchRequest;return t.identifier!=null&&(i.identifier=String(t.identifier)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.identifier=""),t.identifier!=null&&t.hasOwnProperty("identifier")&&(n.identifier=t.identifier),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Lh.util.toJSONOptions)},r}();Oc.FetchResponse=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.status=0,r.prototype.data=ly.newBuffer([]),r.encode=function(t,i){return i||(i=T3e.create()),t.status!=null&&Object.hasOwnProperty.call(t,"status")&&i.uint32(8).int32(t.status),t.data!=null&&Object.hasOwnProperty.call(t,"data")&&i.uint32(18).bytes(t.data),i},r.decode=function(t,i){t instanceof M_||(t=M_.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Oc.FetchResponse;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.status=t.int32();break;case 2:s.data=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Oc.FetchResponse)return t;var i=new Oc.FetchResponse;switch(t.status){case"OK":case 0:i.status=0;break;case"NOT_FOUND":case 1:i.status=1;break;case"ERROR":case 2:i.status=2;break}return t.data!=null&&(typeof t.data=="string"?ly.base64.decode(t.data,i.data=ly.newBuffer(ly.base64.length(t.data)),0):t.data.length&&(i.data=t.data)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.status=i.enums===String?"OK":0,i.bytes===String?n.data="":(n.data=[],i.bytes!==Array&&(n.data=ly.newBuffer(n.data)))),t.status!=null&&t.hasOwnProperty("status")&&(n.status=i.enums===String?Oc.FetchResponse.StatusCode[t.status]:t.status),t.data!=null&&t.hasOwnProperty("data")&&(n.data=i.bytes===String?ly.base64.encode(t.data,0,t.data.length):i.bytes===Array?Array.prototype.slice.call(t.data):t.data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Lh.util.toJSONOptions)},r.StatusCode=function(){var e={},t=Object.create(e);return t[e[0]="OK"]=0,t[e[1]="NOT_FOUND"]=1,t[e[2]="ERROR"]=2,t}(),r}();P3e.exports=Oc});var k3e=m((SBt,O3e)=>{l();"use strict";O3e.exports={PROTOCOL:"/libp2p/fetch/0.0.1"}});var M3e=m((B3e,L3e)=>{l();"use strict";var D3e=le(),Let=Object.assign(D3e("libp2p:fetch"),{error:D3e("libp2p:fetch:err")}),JC=br(),{codes:eO}=wr(),j_=go(),{FetchRequest:tO,FetchResponse:Ea}=C3e(),N3e=wh(),{PROTOCOL:Met}=k3e(),a3=class{constructor(e){this._lookupFunctions=new Map,this._libp2p=e,this.handleMessage=this.handleMessage.bind(this)}async fetch(e,t){Let("dialing %s to %s",this._protocol,e.toB58String?e.toB58String():e);let i=await this._libp2p.dial(e),{stream:n}=await i.newStream(a3.PROTOCOL),s=N3e(n),o=new tO({identifier:t});s.write(j_.encode.single(tO.encode(o).finish()));let a=Ea.decode((await j_.decode.fromReader(s.reader).next()).value.slice());switch(a.status){case Ea.StatusCode.OK:return a.data;case Ea.StatusCode.NOT_FOUND:return null;case Ea.StatusCode.ERROR:{let c=new TextDecoder().decode(a.data);throw JC(new Error("Error in fetch protocol response: "+c),eO.ERR_INVALID_PARAMETERS)}default:throw JC(new Error("Unknown response status"),eO.ERR_INVALID_MESSAGE)}}async handleMessage(e){let{stream:t}=e,i=N3e(t),n=tO.decode((await j_.decode.fromReader(i.reader).next()).value.slice()),s,o=this._getLookupFunction(n.identifier);if(o){let a=await o(n.identifier);a?s=new Ea({status:Ea.StatusCode.OK,data:a}):s=new Ea({status:Ea.StatusCode.NOT_FOUND})}else{let a=new TextEncoder().encode("No lookup function registered for key: "+n.identifier);s=new Ea({status:Ea.StatusCode.ERROR,data:a})}i.write(j_.encode.single(Ea.encode(s).finish()))}_getLookupFunction(e){for(let t of this._lookupFunctions.keys())if(e.startsWith(t))return this._lookupFunctions.get(t);return null}registerLookupFunction(e,t){if(this._lookupFunctions.has(e))throw JC(new Error("Fetch protocol handler for key prefix '"+e+"' already registered"),eO.ERR_KEY_ALREADY_EXISTS);this._lookupFunctions.set(e,t)}unregisterLookupFunction(e,t){t!=null&&this._lookupFunctions.get(e)!==t||this._lookupFunctions.delete(e)}};a3.PROTOCOL=Met;B3e=L3e.exports=a3});var q3e=m((ABt,j3e)=>{l();"use strict";j3e.exports={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32,PROTOCOL_VERSION:"1.0.0",PROTOCOL_NAME:"ping"}});var $3e=m((RBt,H3e)=>{l();"use strict";var U3e=le(),jet=Object.assign(U3e("libp2p:ping"),{error:U3e("libp2p:ping:err")}),qet=br(),{codes:Uet}=wr(),Fet=Qa(),{pipe:F3e}=dr(),{toBuffer:Ket}=T8(),{collect:Vet,take:zet}=S_(),{equals:Het}=(hi(),hn),{PROTOCOL_NAME:K3e,PING_LENGTH:$et,PROTOCOL_VERSION:V3e}=q3e(),z3e=class{static getProtocolStr(e){return`/${e._config.protocolPrefix}/${K3e}/${V3e}`}constructor(e){this._libp2p=e}handleMessage({stream:e}){return F3e(e,e)}async ping(e){let t=`/${this._libp2p._config.protocolPrefix}/${K3e}/${V3e}`;jet("dialing %s to %s",t,e.toB58String?e.toB58String():e);let i=await this._libp2p.dial(e),{stream:n}=await i.newStream(t),s=Date.now(),o=Fet.randomBytes($et),[a]=await F3e([o],n,u=>zet(1,u),Ket,Vet),c=Date.now();if(!Het(o,a))throw qet(new Error("Received wrong ping ack"),Uet.ERR_WRONG_PING_ACK);return c-s}};H3e.exports=z3e});var G3e=m(()=>{l()});var W3e=m(rO=>{l();"use strict";Object.defineProperty(rO,"__esModule",{value:!0}),rO.promisify=q_;var Get="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function q_(r){if(typeof r!="function")throw new TypeError("Argument to promisify must be a function");var e=r[Get],t=q_.Promise||Promise;if(typeof t!="function")throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var i=this,n=arguments.length,s=Array(n),o=0;o<n;o++)s[o]=arguments[o];return new t(function(a,c){s.push(function(u){if(u)return c(u);for(var f=arguments.length,d=Array(1<f?f-1:0),h=1;h<f;h++)d[h-1]=arguments[h];if(d.length===1||!e)return a(d[0]);var p={};d.forEach(function(y,g){var w=e[g];w&&(p[w]=y)}),a(p)}),r.apply(i,s)})}}q_.argumentNames="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__",q_.Promise=void 0});var X3e=m((PBt,Y3e)=>{l();"use strict";var Wet=dv(),U_=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,c3=Wet(),Yet=U_&&!c3,Xet=c3&&!U_,Qet=c3&&U_,Zet=typeof Aa=="function"&&typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!c3,Jet=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,ett=typeof process!="undefined"&&typeof process.env!="undefined"&&!1;Y3e.exports={isTest:ett,isElectron:c3,isElectronMain:Xet,isElectronRenderer:Qet,isNode:Zet,isBrowser:Yet,isWebWorker:Jet,isEnvWithDom:U_}});var Z3e=m((CBt,Q3e)=>{l();function No(r,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(r)),this._timeouts=r,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}Q3e.exports=No;No.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};No.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};No.prototype.retry=function(r){if(this._timeout&&clearTimeout(this._timeout),!r)return!1;var e=new Date().getTime();if(r&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(r),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(r);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),t=this._cachedTimeouts.slice(-1);else return!1;var i=this;return this._timer=setTimeout(function(){i._attempts++,i._operationTimeoutCb&&(i._timeout=setTimeout(function(){i._operationTimeoutCb(i._attempts)},i._operationTimeout),i._options.unref&&i._timeout.unref()),i._fn(i._attempts)},t),this._options.unref&&this._timer.unref(),!0};No.prototype.attempt=function(r,e){this._fn=r,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};No.prototype.try=function(r){console.log("Using RetryOperation.try() is deprecated"),this.attempt(r)};No.prototype.start=function(r){console.log("Using RetryOperation.start() is deprecated"),this.attempt(r)};No.prototype.start=No.prototype.try;No.prototype.errors=function(){return this._errors};No.prototype.attempts=function(){return this._attempts};No.prototype.mainError=function(){if(this._errors.length===0)return null;for(var r={},e=null,t=0,i=0;i<this._errors.length;i++){var n=this._errors[i],s=n.message,o=(r[s]||0)+1;r[s]=o,o>=t&&(e=n,t=o)}return e}});var J3e=m(Mh=>{l();var ttt=Z3e();Mh.operation=function(r){var e=Mh.timeouts(r);return new ttt(e,{forever:r&&(r.forever||r.retries===1/0),unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})};Mh.timeouts=function(r){if(r instanceof Array)return[].concat(r);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var t in r)e[t]=r[t];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],n=0;n<e.retries;n++)i.push(this.createTimeout(n,e));return r&&r.forever&&!i.length&&i.push(this.createTimeout(n,e)),i.sort(function(s,o){return s-o}),i};Mh.createTimeout=function(r,e){var t=e.randomize?Math.random()+1:1,i=Math.round(t*Math.max(e.minTimeout,1)*Math.pow(e.factor,r));return i=Math.min(i,e.maxTimeout),i};Mh.wrap=function(r,e,t){if(e instanceof Array&&(t=e,e=null),!t){t=[];for(var i in r)typeof r[i]=="function"&&t.push(i)}for(var n=0;n<t.length;n++){var s=t[n],o=r[s];r[s]=function(c){var u=Mh.operation(e),f=Array.prototype.slice.call(arguments,1),d=f.pop();f.push(function(h){u.retry(h)||(h&&(arguments[0]=u.mainError()),d.apply(this,arguments))}),u.attempt(function(){c.apply(r,f)})}.bind(r,o),r[s].options=e}}});var t4e=m((kBt,e4e)=>{l();e4e.exports=J3e()});var i4e=m((DBt,F_)=>{l();"use strict";var rtt=t4e(),itt=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"],iO=class extends Error{constructor(e){super();e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},ntt=(r,e,t)=>{let i=t.retries-(e-1);return r.attemptNumber=e,r.retriesLeft=i,r},stt=r=>itt.includes(r),r4e=(r,e)=>new Promise((t,i)=>{e={onFailedAttempt:()=>{},retries:10,...e};let n=rtt.operation(e);n.attempt(async s=>{try{t(await r(s))}catch(o){if(!(o instanceof Error)){i(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof iO)n.stop(),i(o.originalError);else if(o instanceof TypeError&&!stt(o.message))n.stop(),i(o);else{ntt(o,s,e);try{await e.onFailedAttempt(o)}catch(a){i(a);return}n.retry(o)||i(n.mainError())}}})});F_.exports=r4e;F_.exports.default=r4e;F_.exports.AbortError=iO});var s4e=m((NBt,n4e)=>{l();"use strict";function ott(r){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(r)||/^::1$/.test(r)}n4e.exports=ott});var a4e=m((BBt,o4e)=>{l();"use strict";var att=s4e();function ctt(r){let{address:e}=r.nodeAddress();return att(e)}o4e.exports=ctt});var h4e=m((LBt,d4e)=>{l();"use strict";var utt=G3e(),c4e=le(),{promisify:nO}=W3e(),{Multiaddr:ltt}=lt(),fy=Object.assign(c4e("libp2p:nat"),{error:c4e("libp2p:nat:err")}),{isBrowser:u4e}=X3e(),sO=i4e(),ftt=Y8(),l4e=nC(),dtt=br(),{codes:{ERR_INVALID_PARAMETERS:htt}}=wr(),ptt=a4e(),oO=7200;function ytt(r=1024,e=65535){return Math.floor(Math.random()*(e-r+1)+r)}var f4e=class{constructor({peerId:e,addressManager:t,transportManager:i,...n}){if(this._peerId=e,this._addressManager=t,this._transportManager=i,this._enabled=n.enabled,this._externalIp=n.externalIp,this._options={description:n.description||`${l4e.name}@${l4e.version} ${this._peerId}`,ttl:n.ttl||oO,autoUpdate:n.keepAlive||!0,gateway:n.gateway,enablePMP:Boolean(n.pmp&&n.pmp.enabled)},this._options.ttl<oO)throw dtt(new Error(`NatManager ttl should be at least ${oO} seconds`),htt)}start(){u4e||!this._enabled||this._start().catch(e=>{fy.error(e)})}async _start(){let e=this._transportManager.getAddrs();for(let t of e){let{family:i,host:n,port:s,transport:o}=t.toOptions();if(!t.isThinWaistAddress()||o!=="tcp"||ptt(t)||i!==4)continue;let a=this._getClient(),c=this._externalIp||await a.externalIp();if(ftt(c))throw new Error(`${c} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let u=ytt();fy(`opening uPnP connection from ${c}:${u} to ${n}:${s}`),await a.map({publicPort:u,privatePort:s,protocol:o.toUpperCase()}),this._addressManager.addObservedAddr(ltt.fromNodeAddress({family:4,address:c,port:u},o))}}_getClient(){if(this._client)return this._client;let e=new utt(this._options),t=nO(e.map.bind(e)),i=nO(e.destroy.bind(e)),n=nO(e.externalIp.bind(e));return this._client={map:(...s)=>sO(()=>t(...s),{onFailedAttempt:fy.error,unref:!0}),destroy:(...s)=>sO(()=>i(...s),{onFailedAttempt:fy.error,unref:!0}),externalIp:(...s)=>sO(()=>n(...s),{onFailedAttempt:fy.error,unref:!0})},this._client}async stop(){if(!(u4e||!this._client))try{await this._client.destroy(),this._client=null}catch(e){fy.error(e)}}};d4e.exports=f4e});var w4e=m((MBt,b4e)=>{l();"use strict";var p4e=le(),Rn=Object.assign(p4e("libp2p"),{error:p4e("libp2p:err")}),{EventEmitter:gtt}=Ut(),aO=br(),mtt=st(),{Multiaddr:btt}=lt(),{MemoryDatastore:wtt}=(Ib(),$9),_tt=o1e(),vtt=d1e(),cO=iC(),{validate:Ett}=oye(),{codes:K_,messages:Stt}=wr(),Att=uye(),Rtt=xye(),xtt=Oye(),y4e=o2e(),Itt=b2e(),Ttt=U2e(),g4e=Ige(),Ptt=Fge(),Ctt=hC(),Ott=Rme(),ktt=u3e(),Dtt=f3e(),Ntt=y3e(),m4e=I3e(),uO=M3e(),lO=$3e(),Btt=h4e(),{updateSelfPeerRecord:Ltt}=fC(),u3=class extends gtt{static async create(e){if(e.peerId)return new u3(e);let t=await mtt.create();return e.peerId=t,new u3(e)}constructor(e){super();if(this._options=Ett(e),this.peerId=this._options.peerId,this.datastore=this._options.datastore,this._options.metrics.enabled){let i=new Ptt({...this._options.metrics});this.metrics=i}if(this.connectionGater={denyDialPeer:async()=>Promise.resolve(!1),denyDialMultiaddr:async()=>Promise.resolve(!1),denyInboundConnection:async()=>Promise.resolve(!1),denyOutboundConnection:async()=>Promise.resolve(!1),denyInboundEncryptedConnection:async()=>Promise.resolve(!1),denyOutboundEncryptedConnection:async()=>Promise.resolve(!1),denyInboundUpgradedConnection:async()=>Promise.resolve(!1),denyOutboundUpgradedConnection:async()=>Promise.resolve(!1),filterMultiaddrForPeer:async()=>Promise.resolve(!0),...this._options.connectionGater},this.peerStore=new ktt({peerId:this.peerId,datastore:this.datastore&&this._options.peerStore.persistence?this.datastore:new wtt,addressFilter:this.connectionGater.filterMultiaddrForPeer}),this.addresses=this._options.addresses,this.addressManager=new Att(this.peerId,this._options.addresses),this.addressManager.on("change:addresses",()=>{Ltt(this).catch(i=>{Rn.error("Error updating self peer record",i)})}),this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=new Map,this.connectionManager=new Rtt(this,{...this._options.connectionManager}),this._autodialler=new xtt(this,{enabled:this._config.peerDiscovery.autoDial,minConnections:this._options.connectionManager.minConnections,autoDialInterval:this._options.connectionManager.autoDialInterval}),this._options.keychain&&this._options.keychain.datastore){Rn("creating keychain");let i=g4e.generateOptions();this.keychain=new g4e(this._options.keychain.datastore,{...i,...this._options.keychain}),Rn("keychain constructed")}if(this.upgrader=new Ott({connectionGater:this.connectionGater,localPeer:this.peerId,metrics:this.metrics,onConnection:i=>this.connectionManager.onConnect(i),onConnectionEnd:i=>this.connectionManager.onDisconnect(i)}),this.transportManager=new Ctt({libp2p:this,upgrader:this.upgrader,faultTolerance:this._options.transportManager.faultTolerance}),this.natManager=new Btt({peerId:this.peerId,addressManager:this.addressManager,transportManager:this.transportManager,...this._options.config.nat}),this.registrar=new Ntt({peerStore:this.peerStore,connectionManager:this.connectionManager}),this.handle=this.handle.bind(this),this.registrar.handle=this.handle,!this._modules.connEncryption||!this._modules.connEncryption.length)throw aO(new Error(Stt.CONN_ENCRYPTION_REQUIRED),K_.CONN_ENCRYPTION_REQUIRED);if(this._modules.connEncryption.forEach(i=>{this.upgrader.cryptos.set(i.protocol,i)}),this.dialer=new Ttt({transportManager:this.transportManager,connectionGater:this.connectionGater,peerStore:this.peerStore,metrics:this.metrics,...this._options.dialer}),this._modules.transport.forEach(i=>{let n=i.prototype[Symbol.toStringTag],s=this._config.transport[n];this.transportManager.add(n,i,s)}),this._config.relay.enabled&&(this.transportManager.add(y4e.prototype[Symbol.toStringTag],y4e),this.relay=new Itt(this)),this._modules.streamMuxer&&(this._modules.streamMuxer.forEach(n=>{this.upgrader.muxers.set(n.multicodec,n)}),this.identifyService=new m4e({libp2p:this})),this._modules.connProtector)this.upgrader.protector=this._modules.connProtector;else if(globalThis.process!==void 0&&globalThis.process.env&&globalThis.process.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._modules.dht){let i=this._modules.dht;this._dht=i.create({libp2p:this,...this._config.dht})}if(this._modules.pubsub){let i=this._modules.pubsub;this.pubsub=Dtt(i,this,this._config.pubsub)}this.peerRouting=new _tt(this),this.contentRouting=new vtt(this),this._onDiscoveryPeer=this._onDiscoveryPeer.bind(this),this.fetchService=new uO(this),this.pingService=new lO(this)}emit(e,...t){return e==="error"&&!this._events.error?(Rn.error(t),!1):super.emit(e,...t)}async start(){Rn("libp2p is starting"),this.identifyService&&await this.handle(Object.values(m4e.getProtocolStr(this)),this.identifyService.handleMessage),this.fetchService&&await this.handle(uO.PROTOCOL,this.fetchService.handleMessage),this.pingService&&await this.handle(lO.getProtocolStr(this),this.pingService.handleMessage);try{await this._onStarting(),await this._onDidStart(),Rn("libp2p has started")}catch(e){throw this.emit("error",e),Rn.error("An error occurred starting libp2p",e),await this.stop(),e}}async stop(){Rn("libp2p is stopping");try{this._isStarted=!1,this.identifyService&&await this.identifyService.stop(),this.relay&&this.relay.stop(),this.peerRouting.stop(),await this._autodialler.stop(),await(this._dht&&this._dht.stop());for(let e of this._discovery.values())e.removeListener("peer",this._onDiscoveryPeer);await Promise.all(Array.from(this._discovery.values(),e=>e.stop())),this._discovery=new Map,await this.connectionManager.stop(),await Promise.all([this.pubsub&&this.pubsub.stop(),this.metrics&&this.metrics.stop()]),await this.natManager.stop(),await this.transportManager.close(),await this.unhandle(uO.PROTOCOL),await this.unhandle(lO.getProtocolStr(this)),this.dialer.destroy()}catch(e){e&&(Rn.error(e),this.emit("error",e))}Rn("libp2p has stopped")}async loadKeychain(){if(!!this.keychain)try{await this.keychain.findKeyByName("self")}catch(e){await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this._isStarted}get connections(){return this.connectionManager.connections}dial(e,t){return this._dial(e,t)}async dialProtocol(e,t,i){if(!t||!t.length)throw aO(new Error("no protocols were provided to open a stream"),K_.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this._dial(e,i)).newStream(t)}async _dial(e,t){let{id:i,multiaddrs:n}=cO(e);if(i.equals(this.peerId))throw aO(new Error("Cannot dial self"),K_.ERR_DIALED_SELF);let s=this.connectionManager.get(i);return s?n&&await this.peerStore.addressBook.add(i,n):s=await this.dialer.connectToPeer(e,t),s}get multiaddrs(){let e=this.addressManager.getAnnounceAddrs().map(n=>n.toString());e.length||(e=this.transportManager.getAddrs().map(n=>n.toString())),e=e.concat(this.addressManager.getObservedAddrs().map(n=>n.toString()));let t=this._options.addresses.announceFilter,i=new Set(e);return t(Array.from(i).map(n=>new btt(n)))}async hangUp(e){let{id:t}=cO(e),i=this.connectionManager.connections.get(t.toB58String());!i||await Promise.all(i.map(n=>n.close()))}fetch(e,t){return this.fetchService.fetch(e,t)}ping(e){let{id:t,multiaddrs:i}=cO(e);return i?this.pingService.ping(i[0]):this.pingService.ping(t)}async handle(e,t){e=Array.isArray(e)?e:[e],e.forEach(i=>{this.upgrader.protocols.set(i,t)}),await this.peerStore.protoBook.add(this.peerId,e)}async unhandle(e){e=Array.isArray(e)?e:[e],e.forEach(t=>{this.upgrader.protocols.delete(t)}),await this.peerStore.protoBook.remove(this.peerId,e)}async _onStarting(){let e=this.addressManager.getListenAddrs();await this.transportManager.listen(e),this.natManager.start(),this._config.pubsub.enabled&&this.pubsub&&await this.pubsub.start(),this._config.dht.enabled&&(this._dht&&await this._dht.start(),this._dht.on("peer",this._onDiscoveryPeer)),this.metrics&&this.metrics.start(),this.identifyService&&await this.identifyService.start()}async _onDidStart(){this._isStarted=!0,this.peerStore.on("peer",e=>{this.emit("peer:discovery",e),this._maybeConnect(e).catch(t=>{Rn.error(t)})});for await(let e of this.peerStore.getPeers())this.emit("peer:discovery",e.id);this.connectionManager.start(),await this._autodialler.start(),await this._setupPeerDiscovery(),this.relay&&this.relay.start(),this.peerRouting.start()}_onDiscoveryPeer(e){if(e.id.toB58String()===this.peerId.toB58String()){Rn.error(new Error(K_.ERR_DISCOVERED_SELF));return}e.multiaddrs&&this.peerStore.addressBook.add(e.id,e.multiaddrs).catch(t=>Rn.error(t)),e.protocols&&this.peerStore.protoBook.set(e.id,e.protocols).catch(t=>Rn.error(t))}async _maybeConnect(e){if(this._config.peerDiscovery.autoDial===!0&&!this.connectionManager.get(e)&&(this._options.connectionManager.minConnections||0)>this.connectionManager.size){Rn("connecting to discovered peer %s",e.toB58String());try{await this.dialer.connectToPeer(e)}catch(i){Rn.error(`could not connect to discovered peer ${e.toB58String()} with ${i}`)}}}async _setupPeerDiscovery(){let e=t=>{let i={enabled:!0};if(t.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[t.tag]&&(i={...i,...this._config.peerDiscovery[t.tag]}),i.enabled&&!this._discovery.has(t.tag)){let n;typeof t=="function"?n=new t(Object.assign({},i,{peerId:this.peerId,libp2p:this})):n=t,n.on("peer",this._onDiscoveryPeer),this._discovery.set(t.tag,n)}};for(let t of this._modules.peerDiscovery||[])e(t);for(let t of this.transportManager.getTransports())t.discovery&&e(t.discovery);await Promise.all(Array.from(this._discovery.values(),t=>t.start()))}};b4e.exports=u3});var D4e=m((tLt,k4e)=>{l();k4e.exports=O4e;var C4e=128,Htt=127,$tt=~Htt,Gtt=Math.pow(2,31);function O4e(r,e,t){e=e||[],t=t||0;for(var i=t;r>=Gtt;)e[t++]=r&255|C4e,r/=128;for(;r&$tt;)e[t++]=r&255|C4e,r>>>=7;return e[t]=r|0,O4e.bytes=t-i+1,e}});var L4e=m((rLt,B4e)=>{l();B4e.exports=fO;var Wtt=128,N4e=127;function fO(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o)throw fO.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&N4e)<<i:(s&N4e)*Math.pow(2,i),i+=7}while(s>=Wtt);return fO.bytes=n-e,t}});var j4e=m((iLt,M4e)=>{l();var Ytt=Math.pow(2,7),Xtt=Math.pow(2,14),Qtt=Math.pow(2,21),Ztt=Math.pow(2,28),Jtt=Math.pow(2,35),ert=Math.pow(2,42),trt=Math.pow(2,49),rrt=Math.pow(2,56),irt=Math.pow(2,63);M4e.exports=function(r){return r<Ytt?1:r<Xtt?2:r<Qtt?3:r<Ztt?4:r<Jtt?5:r<ert?6:r<trt?7:r<rrt?8:r<irt?9:10}});var U4e=m((nLt,q4e)=>{l();q4e.exports={encode:D4e(),decode:L4e(),encodingLength:j4e()}});var V4e=m((sLt,K4e)=>{l();"use strict";var F4e=U4e();K4e.exports=r=>{if(!(r instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");let e=[];for(;r.length>0;){let t=F4e.decode(r);e.push(t),r=r.slice(F4e.decode.bytes)}return e}});var Y4e=m((_Lt,W4e)=>{l();"use strict";function G4e(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function art(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return G4e(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),G4e(new n,t)}}W4e.exports=art});var nbe=m((kLt,ibe)=>{l();ibe.exports=crt;function crt(r,e,t){var i=null,n=null,s=function(){i&&(clearTimeout(i),n=null,i=null)},o=function(){var c=n;s(),c&&c()},a=function(){if(!e)return r.apply(this,arguments);var c=this,u=arguments,f=t&&!i;if(s(),n=function(){r.apply(c,u)},i=setTimeout(function(){if(i=null,!f){var d=n;return n=null,d()}},e),f)return n()};return a.cancel=s,a.flush=o,a}});var Sbe=m((IMt,Ebe)=>{l();"use strict";function vbe(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function yrt(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return vbe(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),vbe(new n,t)}}Ebe.exports=yrt});var Prt={};Pt(Prt,{CID:()=>L,PeerId:()=>xrt,create:()=>Srt,crypto:()=>Art,globSource:()=>Irt,isIPFS:()=>Rrt,multiaddr:()=>Xbe.Multiaddr,urlSource:()=>Trt});l();l();l();var Ek=A(Ku()),Ct=Ek.default;var Kbe=A(my()),MO=A(le()),jO=A(St());l();var B3=A(kk());l();var jc=A(Br()),Qh=jc.default.Reader,Iv=jc.default.Writer,tt=jc.default.util,en=jc.default.roots["ipfs-unixfs"]||(jc.default.roots["ipfs-unixfs"]={}),PD=en.Data=(()=>{function r(e){if(this.blocksizes=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Type=0,r.prototype.Data=tt.newBuffer([]),r.prototype.filesize=tt.Long?tt.Long.fromBits(0,0,!0):0,r.prototype.blocksizes=tt.emptyArray,r.prototype.hashType=tt.Long?tt.Long.fromBits(0,0,!0):0,r.prototype.fanout=tt.Long?tt.Long.fromBits(0,0,!0):0,r.prototype.mode=0,r.prototype.mtime=null,r.encode=function(t,i){if(i||(i=Iv.create()),i.uint32(8).int32(t.Type),t.Data!=null&&Object.hasOwnProperty.call(t,"Data")&&i.uint32(18).bytes(t.Data),t.filesize!=null&&Object.hasOwnProperty.call(t,"filesize")&&i.uint32(24).uint64(t.filesize),t.blocksizes!=null&&t.blocksizes.length)for(var n=0;n<t.blocksizes.length;++n)i.uint32(32).uint64(t.blocksizes[n]);return t.hashType!=null&&Object.hasOwnProperty.call(t,"hashType")&&i.uint32(40).uint64(t.hashType),t.fanout!=null&&Object.hasOwnProperty.call(t,"fanout")&&i.uint32(48).uint64(t.fanout),t.mode!=null&&Object.hasOwnProperty.call(t,"mode")&&i.uint32(56).uint32(t.mode),t.mtime!=null&&Object.hasOwnProperty.call(t,"mtime")&&en.UnixTime.encode(t.mtime,i.uint32(66).fork()).ldelim(),i},r.decode=function(t,i){t instanceof Qh||(t=Qh.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new en.Data;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;case 3:s.filesize=t.uint64();break;case 4:if(s.blocksizes&&s.blocksizes.length||(s.blocksizes=[]),(o&7)==2)for(var a=t.uint32()+t.pos;t.pos<a;)s.blocksizes.push(t.uint64());else s.blocksizes.push(t.uint64());break;case 5:s.hashType=t.uint64();break;case 6:s.fanout=t.uint64();break;case 7:s.mode=t.uint32();break;case 8:s.mtime=en.UnixTime.decode(t,t.uint32());break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw tt.ProtocolError("missing required 'Type'",{instance:s});return s},r.fromObject=function(t){if(t instanceof en.Data)return t;var i=new en.Data;switch(t.Type){case"Raw":case 0:i.Type=0;break;case"Directory":case 1:i.Type=1;break;case"File":case 2:i.Type=2;break;case"Metadata":case 3:i.Type=3;break;case"Symlink":case 4:i.Type=4;break;case"HAMTShard":case 5:i.Type=5;break}if(t.Data!=null&&(typeof t.Data=="string"?tt.base64.decode(t.Data,i.Data=tt.newBuffer(tt.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),t.filesize!=null&&(tt.Long?(i.filesize=tt.Long.fromValue(t.filesize)).unsigned=!0:typeof t.filesize=="string"?i.filesize=parseInt(t.filesize,10):typeof t.filesize=="number"?i.filesize=t.filesize:typeof t.filesize=="object"&&(i.filesize=new tt.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0))),t.blocksizes){if(!Array.isArray(t.blocksizes))throw TypeError(".Data.blocksizes: array expected");i.blocksizes=[];for(var n=0;n<t.blocksizes.length;++n)tt.Long?(i.blocksizes[n]=tt.Long.fromValue(t.blocksizes[n])).unsigned=!0:typeof t.blocksizes[n]=="string"?i.blocksizes[n]=parseInt(t.blocksizes[n],10):typeof t.blocksizes[n]=="number"?i.blocksizes[n]=t.blocksizes[n]:typeof t.blocksizes[n]=="object"&&(i.blocksizes[n]=new tt.LongBits(t.blocksizes[n].low>>>0,t.blocksizes[n].high>>>0).toNumber(!0))}if(t.hashType!=null&&(tt.Long?(i.hashType=tt.Long.fromValue(t.hashType)).unsigned=!0:typeof t.hashType=="string"?i.hashType=parseInt(t.hashType,10):typeof t.hashType=="number"?i.hashType=t.hashType:typeof t.hashType=="object"&&(i.hashType=new tt.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0))),t.fanout!=null&&(tt.Long?(i.fanout=tt.Long.fromValue(t.fanout)).unsigned=!0:typeof t.fanout=="string"?i.fanout=parseInt(t.fanout,10):typeof t.fanout=="number"?i.fanout=t.fanout:typeof t.fanout=="object"&&(i.fanout=new tt.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0))),t.mode!=null&&(i.mode=t.mode>>>0),t.mtime!=null){if(typeof t.mtime!="object")throw TypeError(".Data.mtime: object expected");i.mtime=en.UnixTime.fromObject(t.mtime)}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocksizes=[]),i.defaults){if(n.Type=i.enums===String?"Raw":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=tt.newBuffer(n.Data))),tt.Long){var s=new tt.Long(0,0,!0);n.filesize=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.filesize=i.longs===String?"0":0;if(tt.Long){var s=new tt.Long(0,0,!0);n.hashType=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.hashType=i.longs===String?"0":0;if(tt.Long){var s=new tt.Long(0,0,!0);n.fanout=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.fanout=i.longs===String?"0":0;n.mode=0,n.mtime=null}if(t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=i.enums===String?en.Data.DataType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?tt.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),t.filesize!=null&&t.hasOwnProperty("filesize")&&(typeof t.filesize=="number"?n.filesize=i.longs===String?String(t.filesize):t.filesize:n.filesize=i.longs===String?tt.Long.prototype.toString.call(t.filesize):i.longs===Number?new tt.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0):t.filesize),t.blocksizes&&t.blocksizes.length){n.blocksizes=[];for(var o=0;o<t.blocksizes.length;++o)typeof t.blocksizes[o]=="number"?n.blocksizes[o]=i.longs===String?String(t.blocksizes[o]):t.blocksizes[o]:n.blocksizes[o]=i.longs===String?tt.Long.prototype.toString.call(t.blocksizes[o]):i.longs===Number?new tt.LongBits(t.blocksizes[o].low>>>0,t.blocksizes[o].high>>>0).toNumber(!0):t.blocksizes[o]}return t.hashType!=null&&t.hasOwnProperty("hashType")&&(typeof t.hashType=="number"?n.hashType=i.longs===String?String(t.hashType):t.hashType:n.hashType=i.longs===String?tt.Long.prototype.toString.call(t.hashType):i.longs===Number?new tt.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0):t.hashType),t.fanout!=null&&t.hasOwnProperty("fanout")&&(typeof t.fanout=="number"?n.fanout=i.longs===String?String(t.fanout):t.fanout:n.fanout=i.longs===String?tt.Long.prototype.toString.call(t.fanout):i.longs===Number?new tt.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0):t.fanout),t.mode!=null&&t.hasOwnProperty("mode")&&(n.mode=t.mode),t.mtime!=null&&t.hasOwnProperty("mtime")&&(n.mtime=en.UnixTime.toObject(t.mtime,i)),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,jc.default.util.toJSONOptions)},r.DataType=function(){let e={},t=Object.create(e);return t[e[0]="Raw"]=0,t[e[1]="Directory"]=1,t[e[2]="File"]=2,t[e[3]="Metadata"]=3,t[e[4]="Symlink"]=4,t[e[5]="HAMTShard"]=5,t}(),r})(),cit=en.UnixTime=(()=>{function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Seconds=tt.Long?tt.Long.fromBits(0,0,!1):0,r.prototype.FractionalNanoseconds=0,r.encode=function(t,i){return i||(i=Iv.create()),i.uint32(8).int64(t.Seconds),t.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(t,"FractionalNanoseconds")&&i.uint32(21).fixed32(t.FractionalNanoseconds),i},r.decode=function(t,i){t instanceof Qh||(t=Qh.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new en.UnixTime;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Seconds=t.int64();break;case 2:s.FractionalNanoseconds=t.fixed32();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Seconds"))throw tt.ProtocolError("missing required 'Seconds'",{instance:s});return s},r.fromObject=function(t){if(t instanceof en.UnixTime)return t;var i=new en.UnixTime;return t.Seconds!=null&&(tt.Long?(i.Seconds=tt.Long.fromValue(t.Seconds)).unsigned=!1:typeof t.Seconds=="string"?i.Seconds=parseInt(t.Seconds,10):typeof t.Seconds=="number"?i.Seconds=t.Seconds:typeof t.Seconds=="object"&&(i.Seconds=new tt.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber())),t.FractionalNanoseconds!=null&&(i.FractionalNanoseconds=t.FractionalNanoseconds>>>0),i},r.toObject=function(t,i){i||(i={});var n={};if(i.defaults){if(tt.Long){var s=new tt.Long(0,0,!1);n.Seconds=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.Seconds=i.longs===String?"0":0;n.FractionalNanoseconds=0}return t.Seconds!=null&&t.hasOwnProperty("Seconds")&&(typeof t.Seconds=="number"?n.Seconds=i.longs===String?String(t.Seconds):t.Seconds:n.Seconds=i.longs===String?tt.Long.prototype.toString.call(t.Seconds):i.longs===Number?new tt.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber():t.Seconds),t.FractionalNanoseconds!=null&&t.hasOwnProperty("FractionalNanoseconds")&&(n.FractionalNanoseconds=t.FractionalNanoseconds),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,jc.default.util.toJSONOptions)},r})(),uit=en.Metadata=(()=>{function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.MimeType="",r.encode=function(t,i){return i||(i=Iv.create()),t.MimeType!=null&&Object.hasOwnProperty.call(t,"MimeType")&&i.uint32(10).string(t.MimeType),i},r.decode=function(t,i){t instanceof Qh||(t=Qh.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new en.Metadata;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.MimeType=t.string();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof en.Metadata)return t;var i=new en.Metadata;return t.MimeType!=null&&(i.MimeType=String(t.MimeType)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.MimeType=""),t.MimeType!=null&&t.hasOwnProperty("MimeType")&&(n.MimeType=t.MimeType),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,jc.default.util.toJSONOptions)},r})();var qc=PD,CD=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],dwe=["directory","hamt-sharded-directory"],OD=parseInt("0644",8),kD=parseInt("0755",8);function Uc(r){if(r!=null)return typeof r=="number"?r&4095:(r=r.toString(),r.substring(0,1)==="0"?parseInt(r,8)&4095:parseInt(r,10)&4095)}function $u(r){if(r==null)return;let e;if(r.secs!=null&&(e={secs:r.secs,nsecs:r.nsecs}),r.Seconds!=null&&(e={secs:r.Seconds,nsecs:r.FractionalNanoseconds}),Array.isArray(r)&&(e={secs:r[0],nsecs:r[1]}),r instanceof Date){let t=r.getTime(),i=Math.floor(t/1e3);e={secs:i,nsecs:(t-i*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw(0,B3.default)(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}var dt=class{static unmarshal(e){let t=qc.decode(e),i=qc.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}),n=new dt({type:CD[i.Type],data:i.Data,blockSizes:i.blocksizes,mode:i.mode,mtime:i.mtime?{secs:i.mtime.Seconds,nsecs:i.mtime.FractionalNanoseconds}:void 0});return n._originalMode=i.mode||0,n}constructor(e={type:"file"}){let{type:t,data:i,blockSizes:n,hashType:s,fanout:o,mtime:a,mode:c}=e;if(t&&!CD.includes(t))throw(0,B3.default)(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=t||"file",this.data=i,this.hashType=s,this.fanout=o,this.blockSizes=n||[],this._originalMode=0,this.mode=Uc(c),a&&(this.mtime=$u(a),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?kD:OD;let t=Uc(e);t!==void 0&&(this._mode=t)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&dwe.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach(t=>{e+=t}),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=qc.DataType.Raw;break;case"directory":e=qc.DataType.Directory;break;case"file":e=qc.DataType.File;break;case"metadata":e=qc.DataType.Metadata;break;case"symlink":e=qc.DataType.Symlink;break;case"hamt-sharded-directory":e=qc.DataType.HAMTShard;break;default:throw(0,B3.default)(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let t=this.data;(!this.data||!this.data.length)&&(t=void 0);let i;this.mode!=null&&(i=this._originalMode&4294963200|(Uc(this.mode)||0),i===OD&&!this.isDirectory()&&(i=void 0),i===kD&&this.isDirectory()&&(i=void 0));let n;if(this.mtime!=null){let o=$u(this.mtime);o&&(n={Seconds:o.secs,FractionalNanoseconds:o.nsecs},n.FractionalNanoseconds===0&&delete n.FractionalNanoseconds)}let s={Type:e,Data:t,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:i,mtime:n};return qc.encode(s).finish()}};var Tn={};Pt(Tn,{code:()=>wt,createLink:()=>iN,createNode:()=>rN,decode:()=>Nt,encode:()=>ut,name:()=>u8e,prepare:()=>$i,validate:()=>Mv});l();we();l();var Jwe=new TextDecoder;function Bv(r,e){let t=0;for(let i=0;;i+=7){if(i>=64)throw new Error("protobuf: varint overflow");if(e>=r.length)throw new Error("protobuf: unexpected end of data");let n=r[e++];if(t+=i<28?(n&127)<<i:(n&127)*2**i,n<128)break}return[t,e]}function U3(r,e){let t;[t,e]=Bv(r,e);let i=e+t;if(t<0||i<0)throw new Error("protobuf: invalid length");if(i>r.length)throw new Error("protobuf: unexpected end of data");return[r.subarray(e,i),i]}function WD(r,e){let t;return[t,e]=Bv(r,e),[t&7,t>>3,e]}function e8e(r){let e={},t=r.length,i=0;for(;i<t;){let n,s;if([n,s,i]=WD(r,i),s===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,i]=U3(r,i)}else if(s===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,i]=U3(r,i),e.Name=Jwe.decode(o)}else if(s===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(n!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Tsize`);[e.Tsize,i]=Bv(r,i)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${s}`)}if(i>t)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function YD(r){let e=r.length,t=0,i,n=!1,s;for(;t<e;){let a,c;if([a,c,t]=WD(r,t),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(c===1){if(s)throw new Error("protobuf: (PBNode) duplicate Data section");[s,t]=U3(r,t),i&&(n=!0)}else if(c===2){if(n)throw new Error("protobuf: (PBNode) duplicate Links section");i||(i=[]);let u;[u,t]=U3(r,t),i.push(e8e(u))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${c}`)}if(t>e)throw new Error("protobuf: (PBNode) unexpected end of data");let o={};return s&&(o.Data=s),o.Links=i||[],o}l();var XD=new TextEncoder,QD=2**32,t8e=2**31;function r8e(r,e){let t=e.length;if(typeof r.Tsize=="number"){if(r.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(r.Tsize))throw new Error("Tsize too large for encoding");t=Ay(e,t,r.Tsize)-1,e[t]=24}if(typeof r.Name=="string"){let i=XD.encode(r.Name);t-=i.length,e.set(i,t),t=Ay(e,t,i.length)-1,e[t]=18}return r.Hash&&(t-=r.Hash.length,e.set(r.Hash,t),t=Ay(e,t,r.Hash.length)-1,e[t]=10),e.length-t}function ZD(r){let e=n8e(r),t=new Uint8Array(e),i=e;if(r.Data&&(i-=r.Data.length,t.set(r.Data,i),i=Ay(t,i,r.Data.length)-1,t[i]=10),r.Links)for(let n=r.Links.length-1;n>=0;n--){let s=r8e(r.Links[n],t.subarray(0,i));i-=s,i=Ay(t,i,s)-1,t[i]=18}return t}function i8e(r){let e=0;if(r.Hash){let t=r.Hash.length;e+=1+t+ip(t)}if(typeof r.Name=="string"){let t=XD.encode(r.Name).length;e+=1+t+ip(t)}return typeof r.Tsize=="number"&&(e+=1+ip(r.Tsize)),e}function n8e(r){let e=0;if(r.Data){let t=r.Data.length;e+=1+t+ip(t)}if(r.Links)for(let t of r.Links){let i=i8e(t);e+=1+i+ip(i)}return e}function Ay(r,e,t){e-=ip(t);let i=e;for(;t>=t8e;)r[e++]=t&127|128,t/=128;for(;t>=128;)r[e++]=t&127|128,t>>>=7;return r[e]=t,i}function ip(r){return r%2==0&&r++,Math.floor((s8e(r)+6)/7)}function s8e(r){let e=0;return r>=QD&&(r=Math.floor(r/QD),e=32),r>=1<<16&&(r>>>=16,e+=16),r>=1<<8&&(r>>>=8,e+=8),e+o8e[r]}var o8e=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8];l();we();var a8e=["Data","Links"],c8e=["Hash","Name","Tsize"],Lv=new TextEncoder;function JD(r,e){if(r===e)return 0;let t=r.Name?Lv.encode(r.Name):[],i=e.Name?Lv.encode(e.Name):[],n=t.length,s=i.length;for(let o=0,a=Math.min(n,s);o<a;++o)if(t[o]!==i[o]){n=t[o],s=i[o];break}return n<s?-1:s<n?1:0}function eN(r,e){return!Object.keys(r).some(t=>!e.includes(t))}function tN(r){if(typeof r.asCID=="object"){let t=L.asCID(r);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if(typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");let e={};if(r.Hash){let t=L.asCID(r.Hash);try{t||(typeof r.Hash=="string"?t=L.parse(r.Hash):r.Hash instanceof Uint8Array&&(t=L.decode(r.Hash)))}catch(i){throw new TypeError(`Invalid DAG-PB form: ${i.message}`)}t&&(e.Hash=t)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return typeof r.Name=="string"&&(e.Name=r.Name),typeof r.Tsize=="number"&&(e.Tsize=r.Tsize),e}function $i(r){if((r instanceof Uint8Array||typeof r=="string")&&(r={Data:r}),typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");let e={};if(r.Data!==void 0)if(typeof r.Data=="string")e.Data=Lv.encode(r.Data);else if(r.Data instanceof Uint8Array)e.Data=r.Data;else throw new TypeError("Invalid DAG-PB form");if(r.Links!==void 0)if(Array.isArray(r.Links))e.Links=r.Links.map(tN),e.Links.sort(JD);else throw new TypeError("Invalid DAG-PB form");else e.Links=[];return e}function Mv(r){if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");if(!eN(r,a8e))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(r.Data!==void 0&&!(r.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(r.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let e=0;e<r.Links.length;e++){let t=r.Links[e];if(!t||typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!eN(t,c8e))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!t.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(t.Hash.asCID!==t.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(t.Name!==void 0&&typeof t.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(t.Tsize!==void 0&&(typeof t.Tsize!="number"||t.Tsize%1!=0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e>0&&JD(t,r.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function rN(r,e=[]){return $i({Data:r,Links:e})}function iN(r,e,t){return tN({Hash:t,Name:r,Tsize:e})}var u8e="dag-pb",wt=112;function ut(r){Mv(r);let e={};return r.Links&&(e.Links=r.Links.map(t=>{let i={};return t.Hash&&(i.Hash=t.Hash.bytes),t.Name!==void 0&&(i.Name=t.Name),t.Tsize!==void 0&&(i.Tsize=t.Tsize),i})),r.Data&&(e.Data=r.Data),ZD(e)}function Nt(r){let e=YD(r),t={};return e.Data&&(t.Data=e.Data),e.Links&&(t.Links=e.Links.map(i=>{let n={};try{n.Hash=L.decode(i.Hash)}catch(s){}if(!n.Hash)throw new Error("Invalid Hash field found in link, expected CID");return i.Name!==void 0&&(n.Name=i.Name),i.Tsize!==void 0&&(n.Tsize=i.Tsize),n})),t}var ky={};Pt(ky,{code:()=>r7,decode:()=>n7,encode:()=>i7,name:()=>N8e});l();Ju();we();var lB=42;function P8e(r){if(r.asCID!==r)return null;let e=L.asCID(r);if(!e)return null;let t=new Uint8Array(e.bytes.byteLength+1);return t.set(e.bytes,1),[new ge($.tag,lB),new ge($.bytes,t)]}function C8e(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function O8e(r){if(Number.isNaN(r))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(r===1/0||r===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var k8e={float64:!0,typeEncoders:{Object:P8e,undefined:C8e,number:O8e}};function D8e(r){if(r[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return L.decode(r.subarray(1))}var fB={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};fB.tags[lB]=D8e;var N8e="dag-cbor",r7=113,i7=r=>Wn(r,k8e),n7=r=>vi(r,fB);var Ny={};Pt(Ny,{code:()=>c7,decode:()=>H8e,encode:()=>z8e,name:()=>V8e});l();up();el();Ju();l();l();Pn();e7();hs();Xu();var pB=class extends Array{constructor(){super();this.inRecursive=[]}prefix(e){let t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===$.array&&(t.elements++,t.elements!==1&&e.push([44])),t.type===$.map&&(t.elements++,t.elements!==1&&(t.elements%2==1?e.push([44]):e.push([58]))))}[$.uint.major](e,t){this.prefix(e);let i=String(t.value),n=[];for(let s=0;s<i.length;s++)n[s]=i.charCodeAt(s);e.push(n)}[$.negint.major](e,t){this[$.uint.major](e,t)}[$.bytes.major](e,t){throw new Error(`${Vc} unsupported type: Uint8Array`)}[$.string.major](e,t){this.prefix(e);let i=K3(JSON.stringify(t.value));e.push(i.length>32?Ry(i):i)}[$.array.major](e,t){this.prefix(e),this.inRecursive.push({type:$.array,elements:0}),e.push([91])}[$.map.major](e,t){this.prefix(e),this.inRecursive.push({type:$.map,elements:0}),e.push([123])}[$.tag.major](e,t){}[$.float.major](e,t){if(t.type.name==="break"){let o=this.inRecursive.pop();if(o){if(o.type===$.array)e.push([93]);else if(o.type===$.map)e.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(t.value===void 0)throw new Error(`${Vc} unsupported type: undefined`);if(this.prefix(e),t.type.name==="true"){e.push([116,114,117,101]);return}else if(t.type.name==="false"){e.push([102,97,108,115,101]);return}else if(t.type.name==="null"){e.push([110,117,108,108]);return}let i=String(t.value),n=[],s=!1;for(let o=0;o<i.length;o++)n[o]=i.charCodeAt(o),!s&&(n[o]===46||n[o]===101||n[o]===69)&&(s=!0);s||(n.push(46),n.push(48)),e.push(n)}};function M8e(r,e){if(Array.isArray(r[0])||Array.isArray(e[0]))throw new Error(`${Vc} complex map keys are not supported`);let t=r[0],i=e[0];if(t.type!==$.string||i.type!==$.string)throw new Error(`${Vc} non-string map keys are not supported`);if(t<i)return-1;if(t>i)return 1;throw new Error(`${Vc} unexpected duplicate map keys, this is not supported`)}var j8e={addBreakTokens:!0,mapSorter:M8e};function s7(r,e){return e=Object.assign({},j8e,e),Jv(r,new pB,e)}l();t7();Pn();Xu();hs();var Dy=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;e===32||e===9||e===13||e===10;)e=this.data[++this.pos]}expect(e){if(this.data.length-this.pos<e.length)throw new Error(`${Ve} unexpected end of input at position ${this.pos}`);for(let t=0;t<e.length;t++)if(this.data[this.pos++]!==e[t])throw new Error(`${Ve} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){let e=this.pos,t=!1,i=!1,n=a=>{for(;!this.done();){let c=this.ch();if(a.includes(c))this.pos++;else break}};if(this.ch()===45&&(t=!0,this.pos++),this.ch()===48)if(this.pos++,this.ch()===46)this.pos++,i=!0;else return new ge($.uint,0,this.pos-e);if(n([48,49,50,51,52,53,54,55,56,57]),t&&this.pos===e+1)throw new Error(`${Ve} unexpected token at position ${this.pos}`);if(!this.done()&&this.ch()===46){if(i)throw new Error(`${Ve} unexpected token at position ${this.pos}`);i=!0,this.pos++,n([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(i=!0,this.pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this.pos++,n([48,49,50,51,52,53,54,55,56,57]));let s=String.fromCharCode.apply(null,this.data.subarray(e,this.pos)),o=parseFloat(s);return i?new ge($.float,o,this.pos-e):this.options.allowBigInt!==!0||Number.isSafeInteger(o)?new ge(o>=0?$.uint:$.negint,o,this.pos-e):new ge(o>=0?$.uint:$.negint,BigInt(s),this.pos-e)}parseString(){if(this.ch()!==34)throw new Error(`${Ve} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let s=this.pos,o=0;s<this.data.length&&o<65536;s++,o++){let a=this.data[s];if(a===92||a<32||a>=128)break;if(a===34){let c=String.fromCharCode.apply(null,this.data.subarray(this.pos,s));return this.pos=s+1,new ge($.string,c,o)}}let e=this.pos,t=[],i=()=>{if(this.pos+4>=this.data.length)throw new Error(`${Ve} unexpected end of unicode escape sequence at position ${this.pos}`);let s=0;for(let o=0;o<4;o++){let a=this.ch();if(a>=48&&a<=57)a-=48;else if(a>=97&&a<=102)a=a-97+10;else if(a>=65&&a<=70)a=a-65+10;else throw new Error(`${Ve} unexpected unicode escape character at position ${this.pos}`);s=s*16+a,this.pos++}return s},n=()=>{let s=this.ch(),o=null,a=s>239?4:s>223?3:s>191?2:1;if(this.pos+a>this.data.length)throw new Error(`${Ve} unexpected unicode sequence at position ${this.pos}`);let c,u,f,d;switch(a){case 1:s<128&&(o=s);break;case 2:c=this.data[this.pos+1],(c&192)==128&&(d=(s&31)<<6|c&63,d>127&&(o=d));break;case 3:c=this.data[this.pos+1],u=this.data[this.pos+2],(c&192)==128&&(u&192)==128&&(d=(s&15)<<12|(c&63)<<6|u&63,d>2047&&(d<55296||d>57343)&&(o=d));break;case 4:c=this.data[this.pos+1],u=this.data[this.pos+2],f=this.data[this.pos+3],(c&192)==128&&(u&192)==128&&(f&192)==128&&(d=(s&15)<<18|(c&63)<<12|(u&63)<<6|f&63,d>65535&&d<1114112&&(o=d))}o===null?(o=65533,a=1):o>65535&&(o-=65536,t.push(o>>>10&1023|55296),o=56320|o&1023),t.push(o),this.pos+=a};for(;!this.done();){let s=this.ch(),o;switch(s){case 92:if(this.pos++,this.done())throw new Error(`${Ve} unexpected string termination at position ${this.pos}`);switch(o=this.ch(),this.pos++,o){case 34:case 39:case 92:case 47:t.push(o);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(i());break;default:throw new Error(`${Ve} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new ge($.string,jv(t),this.pos-e);default:if(s<32)throw new Error(`${Ve} invalid control character at position ${this.pos}`);s<128?(t.push(s),this.pos++):n()}}throw new Error(`${Ve} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new ge($.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new ge($.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new ge($.null,null,4);case 102:return this.expect([102,97,108,115,101]),new ge($.false,!1,5);case 116:return this.expect([116,114,117,101]),new ge($.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${Ve} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this.pos++,this.skipWhitespace(),new ge($.break,void 0,1);if(this.ch()!==44)throw new Error(`${Ve} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this.pos++,this.skipWhitespace(),new ge($.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new ge($.break,void 0,1);if(this.ch()!==44)throw new Error(`${Ve} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this.pos++,this.skipWhitespace(),new ge($.break,void 0,1);let e=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${Ve} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${Ve} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}};function o7(r,e){return e=Object.assign({tokenizer:new Dy(r,e)},e),vi(r,e)}function q8e(r){if(r.asCID!==r)return null;let e=L.asCID(r);if(!e)return null;let t=e.toString();return[new ge($.map,1/0,1),new ge($.string,"/",1),new ge($.string,t,t.length),new ge($.break,void 0,1)]}function yB(r){let e=J3.encode(r).slice(1);return[new ge($.map,1/0,1),new ge($.string,"/",1),new ge($.map,1/0,1),new ge($.string,"bytes",5),new ge($.string,e,e.length),new ge($.break,void 0,1),new ge($.break,void 0,1)]}function U8e(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function F8e(r){if(Number.isNaN(r))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(r===1/0||r===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var K8e={typeEncoders:{Object:q8e,Uint8Array:yB,Buffer:yB,undefined:U8e,number:F8e}},gB=class extends Dy{constructor(e,t){super(e,t);this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){let e=this._next();if(e.type===$.map){let t=this._next();if(t.type===$.string&&t.value==="/"){let i=this._next();if(i.type===$.string){if(this._next().type!==$.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(i),new ge($.tag,42,0)}if(i.type===$.map){let n=this._next();if(n.type===$.string&&n.value==="bytes"){let s=this._next();if(s.type===$.string){for(let a=0;a<2;a++)if(this._next().type!==$.break)throw new Error("Invalid encoded Bytes form");let o=J3.decode(`m${s.value}`);return new ge($.bytes,o,s.value.length)}this.tokenBuffer.push(s)}this.tokenBuffer.push(n)}this.tokenBuffer.push(i)}this.tokenBuffer.push(t)}return e}},a7={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};a7.tags[42]=L.parse;var V8e="dag-json",c7=297,z8e=r=>s7(r,K8e),H8e=r=>{let e=Object.assign(a7,{tokenizer:new gB(r,a7)});return o7(r,e)};var wrt=A(y7());Hc();s4();l();function LB(){}l();var tl=class extends Error{constructor(e="not initialized"){super(e);this.name="NotInitializedError",this.code=tl.code}};tl.code="ERR_NOT_INITIALIZED";var MB=class extends Error{constructor(e="cannot initialize an initializing node"){super(e);this.name="AlreadyInitializingError",this.code=Ba.code}};MB.code="ERR_ALREADY_INITIALIZING";var Ba=class extends Error{constructor(e="cannot re-initialize an initialized node"){super(e);this.name="AlreadyInitializedError",this.code=Ba.code}};Ba.code="ERR_ALREADY_INITIALIZED";var rl=class extends Error{constructor(e="not started"){super(e);this.name="NotStartedError",this.code=rl.code}};rl.code="ERR_NOT_STARTED";var dp=class extends Error{constructor(e="cannot start, already startin"){super(e);this.name="AlreadyStartingError",this.code=dp.code}};dp.code="ERR_ALREADY_STARTING";var hp=class extends Error{constructor(e="cannot start, already started"){super(e);this.name="AlreadyStartedError",this.code=hp.code}};hp.code="ERR_ALREADY_STARTED";var La=class extends Error{constructor(e="not enabled"){super(e);this.name="NotEnabledError",this.code=La.code}};La.code="ERR_NOT_ENABLED";at();l();l();l();var RM=A(Sp());we();Mr();var v4=A(St());l();var _M=A(Ma()),vM=A($o());l();var Zve=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;_t.nanosecond=_t.ns=1/1e6;_t.\u00B5s=_t.\u03BCs=_t.us=_t.microsecond=1/1e3;_t.millisecond=_t.ms=_t[""]=1;_t.second=_t.sec=_t.s=_t.ms*1e3;_t.minute=_t.min=_t.m=_t.s*60;_t.hour=_t.hr=_t.h=_t.m*60;_t.day=_t.d=_t.h*24;_t.week=_t.wk=_t.w=_t.d*7;_t.month=_t.b=_t.d*(365.25/12);_t.year=_t.yr=_t.y=_t.d*365.25;function _t(r="",e="ms"){var t=null;return r=(r+"").replace(/(\d)[,_](\d)/g,"$1$2"),r.replace(Zve,function(i,n,s){s=wM(s),s&&(t=(t||0)+parseFloat(n,10)*s)}),t&&t/(wM(e)||1)}function wM(r){return _t[r]||_t[r.toLowerCase().replace(/s$/,"")]}var sl=_t;l();var ol=class extends Error{constructor(e="request timed out"){super(e);this.name="TimeoutError",this.code=ol.code}};ol.code="ERR_TIMEOUT";function Q(r,e){return(...t)=>{let i=t[e??t.length-1];if(!i||!i.timeout)return r(...t);let n=typeof i.timeout=="string"?sl(i.timeout):i.timeout,s=new _M.TimeoutController(n);i.signal=(0,vM.anySignal)([i.signal,s.signal]);let o=r(...t),a=new Promise((f,d)=>{s.signal.addEventListener("abort",()=>{d(new ol)})}),c=Date.now(),u=()=>{if(s.signal.aborted)throw new ol;if(Date.now()-c>n)throw s.abort(),new ol};return o[Symbol.asyncIterator]?async function*(){let f=o[Symbol.asyncIterator]();try{for(;;){let{value:d,done:h}=await Promise.race([f.next(),a]);if(h)break;u(),yield d}}catch(d){throw u(),d}finally{s.clear(),f.return&&f.return()}}():(async()=>{try{let f=await Promise.race([o,a]);return u(),f}catch(f){throw u(),f}finally{s.clear()}})()}}l();we();var J7=A(Vf()),AM="/ipfs/";function Gc(r){if(r instanceof Uint8Array)try{r=L.decode(r)}catch(n){throw(0,J7.default)(n,"ERR_INVALID_CID")}let e=L.asCID(r);if(e)return{cid:e,path:void 0};r=r.toString(),r.startsWith(AM)&&(r=r.substring(AM.length));let t=r.split("/"),i;try{e=L.parse(t.shift()||"")}catch(n){throw(0,J7.default)(n,"ERR_INVALID_CID")}return t.length&&(i=`/${t.join("/")}`),{cid:e,path:i}}var e7e="ERR_BAD_PATH",E4="This command must be run in online mode. Try running 'ipfs daemon' first.",Wy=new xe("/local/filesroot"),Yy=262144;var xM=r=>{if(L.asCID(r))return`/ipfs/${r}`;let t=r.toString();try{return`/ipfs/${L.parse(t)}`}catch{}if(RM.default.path(t))return t;throw(0,v4.default)(new Error(`invalid path: ${r}`),e7e)},Rp=r=>r instanceof Uint8Array?L.decode(r).toString():(r=r.toString(),r.indexOf("/ipfs/")===0&&(r=r.substring("/ipfs/".length)),r.charAt(r.length-1)==="/"&&(r=r.substring(0,r.length-1)),r),al=async function(r,e,t,i={}){let{cid:n,path:s}=Gc(t);s&&(i.path=s);let o=n,a=i.path||"";if(a.startsWith("/")&&(a=a.substring(1)),i.path)try{for await(let{value:c,remainderPath:u}of cl(n,i.path,e,r,{signal:i.signal})){if(!L.asCID(c))break;a=u,o=c}}catch(c){throw c.message.startsWith("Object has no property")&&(c.message=`no link named "${a.split("/")[0]}" under ${o}`,c.code="ERR_NO_LINK"),c}return{cid:o,remainderPath:a||""}},eE=r=>{if(r.type!=="file"&&r.type!=="directory"&&r.type!=="raw")throw new Error(`Unknown node type '${r.type}'`);let e={cid:r.cid,path:r.path,name:r.name,size:r.size,type:"file"};return r.type==="directory"&&(e.type="dir"),r.type==="file"&&(e.size=r.unixfs.fileSize()),(r.type==="file"||r.type==="directory")&&(e.mode=r.unixfs.mode,r.unixfs.mtime!==void 0&&(e.mtime=r.unixfs.mtime)),e},IM=Q(async(r,e)=>await r),cl=async function*(r,e,t,i,n){let s=async u=>{let f=await t.getCodec(u.code),d=await i.blocks.get(u,n);return f.decode(d)},o=e.split("/").filter(Boolean),a=await s(r),c=r;for(;o.length;){let u=o.shift();if(!u)throw(0,v4.default)(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(r.code===wt&&Array.isArray(a.Links)){let f=a.Links.find(d=>d.Name===u);if(f){yield{value:f.Hash,remainderPath:o.join("/")},a=await s(f.Hash),c=f.Hash;continue}}if(Object.prototype.hasOwnProperty.call(a,u))a=a[u],yield{value:a,remainderPath:o.join("/")};else throw(0,v4.default)(new Error(`no link named "${u}" under ${c}`),"ERR_NO_LINK");L.asCID(a)&&(c=a,a=await s(a))}yield{value:a,remainderPath:""}};var kn=class{static create({start:e,stop:t}){return new kn(e,t)}static async start(e,t){let{state:i,activate:n}=e;switch(i.status){case"stopped":try{let s=n(t);e.state={status:"starting",ready:s};let o=await s;return e.state={status:"started",value:o},o}catch(s){throw e.state={status:"stopped"},s}case"starting":throw new dp;case"started":throw new hp;case"stopping":return await i.ready,await kn.start(e,t);default:return kn.panic(e)}}static async stop(e){let{state:t,deactivate:i}=e;switch(t.status){case"stopped":break;case"starting":{try{await t.ready}catch(n){}return await kn.stop(e)}case"stopping":return await t.ready;case"started":{i&&await i(t.value),e.state={status:"stopped"};break}default:kn.panic(t)}}static try({state:e}){switch(e.status){case"started":return e.value;default:return null}}static async use({state:e},t){switch(e.status){case"started":return e.value;case"starting":return await IM(e.ready,t);default:throw new rl}}static panic({state:e}){let t=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${t}, should never happen if you see this please report a bug`)}constructor(e,t){this.activate=e,this.deactivate=t,this.state={status:"stopped"}}async use(e){return await kn.use(this,e)}try(){return kn.try(this)}};function TM({network:r,preload:e,peerId:t,keychain:i,repo:n,ipns:s,mfsPreload:o,print:a,hashers:c,options:u}){return async()=>{let{libp2p:d}=await kn.start(r,{peerId:t,repo:n,print:a,hashers:c,options:u});await Promise.all([s.startOnline({keychain:i,libp2p:d,peerId:t,repo:n}),e.start(),o.start()])}}l();function PM({network:r,preload:e,ipns:t,repo:i,mfsPreload:n}){return async()=>{await Promise.all([e.stop(),t.stop(),n.stop()]),await kn.stop(r),await i.close()}}l();l();l();var OM=A(xp()),tE=class{constructor(e){this.lru=(0,OM.default)(e)}get(e){let t=this.lru.get(e);if(t){if(t.expire&&t.expire<Date.now()){this.lru.remove(e);return}return t.value}}set(e,t,i){this.lru.set(e,{value:t,expire:Date.now()+i})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}};var I4=A(Go()),sj=A(Tp()),hE=new tE(1e3),P7e=60*1e3,C7e=I4.default.default?I4.default.default:I4.default,O7e=new C7e({concurrency:4}),oj=r=>{if(r.Path)return r.Path;throw new Error(r.Message)};async function aj(r,e){return(async(i,n={})=>{let s=new URLSearchParams(n);s.set("arg",i);let o=s.toString();if(!n.nocache&&hE.has(o)){let c=hE.get(o);return oj(c)}let a=await O7e.add(async()=>{let c=await sj.default.get("https://ipfs.io/api/v0/dns",{searchParams:s}),u=new URL(c.url).search.slice(1),f=await c.json();return hE.set(u,f,P7e),f});return oj(a)})(r,e)}function k7e(r){return r.endsWith(".eth")&&(r=r.replace(/.eth$/,".eth.link")),r}function cj(){return Q(async(e,t={recursive:!0})=>{if(typeof e!="string")throw new Error("Invalid arguments, domain must be a string");return e=k7e(e),aj(e,t)})}l();function uj({network:r}){return()=>{let e=r.try();return e!=null&&Boolean(e.libp2p.isStarted())}}l();var a9=A(Sp());we();var _F=A(st());function vF({repo:r,codecs:e,bases:t,name:i}){async function n(s,o={}){if(!a9.default.path(s))throw new Error("invalid argument "+s);if(a9.default.ipnsPath(s))for await(let w of i.resolve(s,o))s=w;let[,a,c,...u]=s.split("/"),f=o.cidBase?await t.getBase(o.cidBase):void 0,d=iRe(c);if(u.length===0){let w=f?f.encoder.encode(d):c;return`/${a}/${w}`}let h=L.decode(d);s=u.join("/");let p=cl(h,s,e,r,o),y=h,g=s;for await(let w of p)L.asCID(w.value)&&(y=w.value,g=w.remainderPath);return`/ipfs/${y.toString(f&&f.encoder)}${g?"/"+g:""}`}return Q(n)}function iRe(r){try{return _F.default.parse(r).toBytes()}catch{return L.parse(r).bytes}}l();l();var SF=A(Zn());we();function AF({addAll:r}){return(e,t={})=>{let i,n=L.asCID(e);return n?i=r([{cid:n,...t}],t):i=r([{path:e.toString(),...t}],t),(0,SF.default)(i)}}l();l();var Fp=A(Vf());we();async function*Xa(r){if(r==null)throw(0,Fp.default)(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT");let e=L.asCID(r);if(e){yield Qo({cid:e});return}if(r instanceof String||typeof r=="string"){yield Qo({path:r});return}if(r.cid!=null||r.path!=null)return yield Qo(r);if(Symbol.iterator in r){let t=r[Symbol.iterator](),i=t.next();if(i.done)return t;if(L.asCID(i.value)||i.value instanceof String||typeof i.value=="string"){yield Qo({cid:i.value});for(let n of t)yield Qo({cid:n});return}if(i.value.cid!=null||i.value.path!=null){yield Qo(i.value);for(let n of t)yield Qo(n);return}throw(0,Fp.default)(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in r){let t=r[Symbol.asyncIterator](),i=await t.next();if(i.done)return t;if(L.asCID(i.value)||i.value instanceof String||typeof i.value=="string"){yield Qo({cid:i.value});for await(let n of t)yield Qo({cid:n});return}if(i.value.cid!=null||i.value.path!=null){yield Qo(i.value);for await(let n of t)yield Qo(n);return}throw(0,Fp.default)(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}throw(0,Fp.default)(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}function Qo(r){let e=r.cid||`${r.path}`;if(!e)throw(0,Fp.default)(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");let t={path:e,recursive:r.recursive!==!1};return r.metadata!=null&&(t.metadata=r.metadata),t}l();var Ot={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};function RF({repo:r,codecs:e}){async function*t(i,n={}){let s=async function*(){for await(let{path:c,recursive:u,metadata:f}of Xa(i)){let{cid:d}=await al(r,e,c),{reason:h}=await r.pins.isPinnedWithType(d,[Ot.recursive,Ot.direct]);if(h==="recursive"&&!u)throw new Error(`${d} already pinned recursively`);u?await r.pins.pinRecursively(d,{metadata:f}):await r.pins.pinDirectly(d,{metadata:f}),yield d}};if(!Boolean(n.lock)){yield*s();return}let a=await r.gcLock.readLock();try{yield*s()}finally{a()}}return Q(t)}l();var c9=A(St());function A2(r,e,t){let i={type:r,cid:e};return t&&(i.metadata=t),i}function xF({repo:r,codecs:e}){async function*t(i={}){let n=Ot.all;if(i.type&&(n=i.type,!Object.keys(Ot).includes(n)))throw(0,c9.default)(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(i.paths){let s=!1;for await(let{path:o}of Xa(i.paths)){let{cid:a}=await al(r,e,o),{reason:c,pinned:u,parent:f,metadata:d}=await r.pins.isPinnedWithType(a,n);if(!u)throw(0,c9.default)(new Error(`path '${o}' is not pinned`),"ERR_NOT_PINNED");switch(c){case Ot.direct:case Ot.recursive:s=!0,yield A2(c,a,d);break;default:s=!0,yield A2(`${Ot.indirect} through ${f}`,a,d)}}if(!s)throw new Error("No match found");return}if(n===Ot.recursive||n===Ot.all)for await(let{cid:s,metadata:o}of r.pins.recursiveKeys())yield A2(Ot.recursive,s,o);if(n===Ot.indirect||n===Ot.all)for await(let s of r.pins.indirectKeys(i))yield A2(Ot.indirect,s);if(n===Ot.direct||n===Ot.all)for await(let{cid:s,metadata:o}of r.pins.directKeys())yield A2(Ot.direct,s,o)}return Q(t)}l();var IF=A(Zn());function TF({rmAll:r}){async function e(t,i={}){let n=await(0,IF.default)(r([{path:t,...i}],i));if(!n)throw new Error("CID expected");return n}return e}l();function PF({repo:r,codecs:e}){async function*t(i,n={}){let s=await r.gcLock.readLock();try{for await(let{path:o,recursive:a}of Xa(i)){let{cid:c}=await al(r,e,o),{pinned:u,reason:f}=await r.pins.isPinnedWithType(c,Ot.all);if(!u)throw new Error(`${c} is not pinned`);switch(f){case Ot.recursive:if(!a)throw new Error(`${c} is pinned recursively`);await r.pins.unpin(c),yield c;break;case Ot.direct:await r.pins.unpin(c),yield c;break;default:throw new Error(`${c} is pinned indirectly under ${f}`)}}}finally{s()}}return Q(t)}var u9=class{constructor({codecs:e,repo:t}){let i=RF({codecs:e,repo:t});this.addAll=i,this.add=AF({addAll:i});let n=PF({codecs:e,repo:t});this.rmAll=n,this.rm=TF({rmAll:n}),this.ls=xF({codecs:e,repo:t}),this.remote={add:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:async function*(s,o={}){return Promise.reject(new Error("Not implemented"))},rm:(s,o={})=>Promise.reject(new Error("Not implemented")),rmAll:(s,o={})=>Promise.reject(new Error("Not implemented")),service:{add:(s,o)=>Promise.reject(new Error("Not implemented")),rm:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:(s={})=>Promise.reject(new Error("Not implemented"))}}}};l();l();var IK=A(st()),TK=A(St()),T9=A(le());l();var O2=A(st());Mr();eo();var vs=A(St()),v9=A(le());et();hi();l();var pK=A(DF());Mr();var gb=A(Qa()),mb=A(st());tn();Hc();var ji=A(WF());rn();at();et();Ri();hi();Ju();var y9=A(sK()),g9=A(le());l();var od=A(Br()),oK=od.default.Reader,bRe=od.default.Writer,Ze=od.default.util,T2=od.default.roots["ipfs-ipns"]||(od.default.roots["ipfs-ipns"]={}),Gp=T2.IpnsEntry=(()=>{function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.value=Ze.newBuffer([]),r.prototype.signature=Ze.newBuffer([]),r.prototype.validityType=0,r.prototype.validity=Ze.newBuffer([]),r.prototype.sequence=Ze.Long?Ze.Long.fromBits(0,0,!0):0,r.prototype.ttl=Ze.Long?Ze.Long.fromBits(0,0,!0):0,r.prototype.pubKey=Ze.newBuffer([]),r.prototype.signatureV2=Ze.newBuffer([]),r.prototype.data=Ze.newBuffer([]),r.encode=function(t,i){return i||(i=bRe.create()),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(10).bytes(t.value),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&i.uint32(18).bytes(t.signature),t.validityType!=null&&Object.hasOwnProperty.call(t,"validityType")&&i.uint32(24).int32(t.validityType),t.validity!=null&&Object.hasOwnProperty.call(t,"validity")&&i.uint32(34).bytes(t.validity),t.sequence!=null&&Object.hasOwnProperty.call(t,"sequence")&&i.uint32(40).uint64(t.sequence),t.ttl!=null&&Object.hasOwnProperty.call(t,"ttl")&&i.uint32(48).uint64(t.ttl),t.pubKey!=null&&Object.hasOwnProperty.call(t,"pubKey")&&i.uint32(58).bytes(t.pubKey),t.signatureV2!=null&&Object.hasOwnProperty.call(t,"signatureV2")&&i.uint32(66).bytes(t.signatureV2),t.data!=null&&Object.hasOwnProperty.call(t,"data")&&i.uint32(74).bytes(t.data),i},r.decode=function(t,i){t instanceof oK||(t=oK.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new T2.IpnsEntry;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.value=t.bytes();break;case 2:s.signature=t.bytes();break;case 3:s.validityType=t.int32();break;case 4:s.validity=t.bytes();break;case 5:s.sequence=t.uint64();break;case 6:s.ttl=t.uint64();break;case 7:s.pubKey=t.bytes();break;case 8:s.signatureV2=t.bytes();break;case 9:s.data=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof T2.IpnsEntry)return t;var i=new T2.IpnsEntry;switch(t.value!=null&&(typeof t.value=="string"?Ze.base64.decode(t.value,i.value=Ze.newBuffer(Ze.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),t.signature!=null&&(typeof t.signature=="string"?Ze.base64.decode(t.signature,i.signature=Ze.newBuffer(Ze.base64.length(t.signature)),0):t.signature.length&&(i.signature=t.signature)),t.validityType){case"EOL":case 0:i.validityType=0;break}return t.validity!=null&&(typeof t.validity=="string"?Ze.base64.decode(t.validity,i.validity=Ze.newBuffer(Ze.base64.length(t.validity)),0):t.validity.length&&(i.validity=t.validity)),t.sequence!=null&&(Ze.Long?(i.sequence=Ze.Long.fromValue(t.sequence)).unsigned=!0:typeof t.sequence=="string"?i.sequence=parseInt(t.sequence,10):typeof t.sequence=="number"?i.sequence=t.sequence:typeof t.sequence=="object"&&(i.sequence=new Ze.LongBits(t.sequence.low>>>0,t.sequence.high>>>0).toNumber(!0))),t.ttl!=null&&(Ze.Long?(i.ttl=Ze.Long.fromValue(t.ttl)).unsigned=!0:typeof t.ttl=="string"?i.ttl=parseInt(t.ttl,10):typeof t.ttl=="number"?i.ttl=t.ttl:typeof t.ttl=="object"&&(i.ttl=new Ze.LongBits(t.ttl.low>>>0,t.ttl.high>>>0).toNumber(!0))),t.pubKey!=null&&(typeof t.pubKey=="string"?Ze.base64.decode(t.pubKey,i.pubKey=Ze.newBuffer(Ze.base64.length(t.pubKey)),0):t.pubKey.length&&(i.pubKey=t.pubKey)),t.signatureV2!=null&&(typeof t.signatureV2=="string"?Ze.base64.decode(t.signatureV2,i.signatureV2=Ze.newBuffer(Ze.base64.length(t.signatureV2)),0):t.signatureV2.length&&(i.signatureV2=t.signatureV2)),t.data!=null&&(typeof t.data=="string"?Ze.base64.decode(t.data,i.data=Ze.newBuffer(Ze.base64.length(t.data)),0):t.data.length&&(i.data=t.data)),i},r.toObject=function(t,i){i||(i={});var n={};if(i.defaults){if(i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=Ze.newBuffer(n.value))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=Ze.newBuffer(n.signature))),n.validityType=i.enums===String?"EOL":0,i.bytes===String?n.validity="":(n.validity=[],i.bytes!==Array&&(n.validity=Ze.newBuffer(n.validity))),Ze.Long){var s=new Ze.Long(0,0,!0);n.sequence=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.sequence=i.longs===String?"0":0;if(Ze.Long){var s=new Ze.Long(0,0,!0);n.ttl=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.ttl=i.longs===String?"0":0;i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=Ze.newBuffer(n.pubKey))),i.bytes===String?n.signatureV2="":(n.signatureV2=[],i.bytes!==Array&&(n.signatureV2=Ze.newBuffer(n.signatureV2))),i.bytes===String?n.data="":(n.data=[],i.bytes!==Array&&(n.data=Ze.newBuffer(n.data)))}return t.value!=null&&t.hasOwnProperty("value")&&(n.value=i.bytes===String?Ze.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),t.signature!=null&&t.hasOwnProperty("signature")&&(n.signature=i.bytes===String?Ze.base64.encode(t.signature,0,t.signature.length):i.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),t.validityType!=null&&t.hasOwnProperty("validityType")&&(n.validityType=i.enums===String?T2.IpnsEntry.ValidityType[t.validityType]:t.validityType),t.validity!=null&&t.hasOwnProperty("validity")&&(n.validity=i.bytes===String?Ze.base64.encode(t.validity,0,t.validity.length):i.bytes===Array?Array.prototype.slice.call(t.validity):t.validity),t.sequence!=null&&t.hasOwnProperty("sequence")&&(typeof t.sequence=="number"?n.sequence=i.longs===String?String(t.sequence):t.sequence:n.sequence=i.longs===String?Ze.Long.prototype.toString.call(t.sequence):i.longs===Number?new Ze.LongBits(t.sequence.low>>>0,t.sequence.high>>>0).toNumber(!0):t.sequence),t.ttl!=null&&t.hasOwnProperty("ttl")&&(typeof t.ttl=="number"?n.ttl=i.longs===String?String(t.ttl):t.ttl:n.ttl=i.longs===String?Ze.Long.prototype.toString.call(t.ttl):i.longs===Number?new Ze.LongBits(t.ttl.low>>>0,t.ttl.high>>>0).toNumber(!0):t.ttl),t.pubKey!=null&&t.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?Ze.base64.encode(t.pubKey,0,t.pubKey.length):i.bytes===Array?Array.prototype.slice.call(t.pubKey):t.pubKey),t.signatureV2!=null&&t.hasOwnProperty("signatureV2")&&(n.signatureV2=i.bytes===String?Ze.base64.encode(t.signatureV2,0,t.signatureV2.length):i.bytes===Array?Array.prototype.slice.call(t.signatureV2):t.signatureV2),t.data!=null&&t.hasOwnProperty("data")&&(n.data=i.bytes===String?Ze.base64.encode(t.data,0,t.data.length):i.bytes===Array?Array.prototype.slice.call(t.data):t.data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,od.default.util.toJSONOptions)},r.ValidityType=function(){let e={},t=Object.create(e);return t[e[0]="EOL"]=0,t}(),r})();l();function pb(r){let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),t=String(r).trim().match(e);if(!t)throw new Error("Invalid format");let i=parseInt(t[1],10),n=parseInt(t[2],10)-1,s=parseInt(t[3],10),o=parseInt(t[4],10),a=parseInt(t[5],10),c=parseInt(t[6],10),u=parseInt(t[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,u))}l();var aK="ERR_IPNS_EXPIRED_RECORD",p9="ERR_UNRECOGNIZED_VALIDITY",cK="ERR_SIGNATURE_CREATION",ad="ERR_SIGNATURE_VERIFICATION",uK="ERR_UNRECOGNIZED_FORMAT",lK="ERR_PEER_ID_FROM_PUBLIC_KEY",fK="ERR_PUBLIC_KEY_FROM_ID",yb="ERR_UNDEFINED_PARAMETER",dK="ERR_INVALID_RECORD_DATA",hK="ERR_INVALID_EMBEDDED_KEY";var _s=Object.assign((0,g9.default)("jsipns"),{error:(0,g9.default)("jsipns:error")}),wRe=bs.code,_Re=Qe("/ipns/"),P2="/ipns/",bb=P2.length,yK=(r,e,t,i)=>{let n=new pK.default(Date.now()+Number(i)),s=Gp.ValidityType.EOL,[o,a]=i.toString().split("."),c=BigInt(o)*BigInt(1e5)+BigInt(a||0);return vRe(r,e,t,s,n,c)};var vRe=async(r,e,t,i,n,s)=>{t=BigInt(t);let o=Qe(n.toString()),a=await ARe(r,e,i,o),c=ERe(e,o,i,t,s),u=bK(c),f=await r.sign(u),d={value:e,signature:a,validityType:i,validity:o,sequence:t,ttl:s,signatureV2:f,data:c};return _s(`ipns entry for ${e} created`),d},ERe=(r,e,t,i,n)=>Wn({Value:r,Validity:e,ValidityType:t,Sequence:i,TTL:n}),m9=async(r,e)=>{let{value:t,validityType:i,validity:n}=e,s,o;e.signatureV2&&e.data?(o=e.signatureV2,s=bK(e.data),SRe(e)):(o=e.signature,s=mK(t,i,n));let a;try{a=await r.verify(s,o)}catch(c){a=!1}if(!a)throw _s.error("record signature verification failed"),(0,ji.default)(new Error("record signature verification failed"),ad);if(i===Gp.ValidityType.EOL){let c;try{c=pb($e(n))}catch(u){throw _s.error("unrecognized validity format (not an rfc3339 format)"),(0,ji.default)(new Error("unrecognized validity format (not an rfc3339 format)"),uK)}if(c.getTime()<Date.now())throw _s.error("record has expired"),(0,ji.default)(new Error("record has expired"),aK)}else if(i)throw _s.error("unrecognized validity type"),(0,ji.default)(new Error("unrecognized validity type"),p9);_s(`ipns entry for ${t} is valid`)},SRe=r=>{if(!r.data)throw(0,ji.default)(new Error("Record data is missing"),dK);let e=vi(r.data);if(Number.isInteger(e.Sequence)&&(e.Sequence=BigInt(e.Sequence)),Number.isInteger(e.TTL)&&(e.TTL=BigInt(e.TTL)),!Hs(e.Value,r.value))throw(0,ji.default)(new Error('Field "value" did not match between protobuf and CBOR'),ad);if(!Hs(e.Validity,r.validity))throw(0,ji.default)(new Error('Field "validity" did not match between protobuf and CBOR'),ad);if(e.ValidityType!==r.validityType)throw(0,ji.default)(new Error('Field "validityType" did not match between protobuf and CBOR'),ad);if(e.Sequence!==r.sequence)throw(0,ji.default)(new Error('Field "sequence" did not match between protobuf and CBOR'),ad);if(e.TTL!==r.ttl)throw(0,ji.default)(new Error('Field "ttl" did not match between protobuf and CBOR'),ad)},gK=async(r,e)=>{if(!r||!r.bytes||!e){let n=new Error("one or more of the provided parameters are not defined");throw _s.error(n),(0,ji.default)(n,yb)}let t;try{t=await mb.default.createFromPubKey(r.bytes)}catch(n){throw(0,ji.default)(n,lK)}let i;try{i=xRe(t)}catch(n){throw _s.error(n),(0,ji.default)(n,fK)}if(i)return null;try{e.pubKey=gb.default.keys.marshalPublicKey(r)}catch(n){throw _s.error(n),n}return e},b9=async(r,e)=>{if(!e||!r){let i=new Error("one or more of the provided parameters are not defined");throw _s.error(i),(0,ji.default)(i,yb)}let t;if(e.pubKey){try{t=gb.default.keys.unmarshalPublicKey(e.pubKey)}catch(n){throw _s.error(n),n}if(!(await mb.default.createFromPubKey(e.pubKey)).equals(r))throw(0,ji.default)(new Error("Embedded public key did not match PeerID"),hK)}else r.pubKey&&(t=r.pubKey);if(t)return t;throw(0,ji.default)(new Error("no public key is available"),yb)},w9=r=>Dv.encode(r).slice(1),C2=r=>new xe(`/ipns/${w9(r)}`),cd=r=>{let e=Qe("/pk/"),t=Qe("/ipns/");return{routingPubKey:new xe(Li([e,r]),!1),pkKey:new xe(w9(Li([e,r]))),routingKey:new xe(Li([t,r]),!1),ipnsKey:new xe(w9(Li([t,r])))}},ARe=(r,e,t,i)=>{try{let n=mK(e,t,i);return r.sign(n)}catch(n){throw _s.error("record signature creation failed"),(0,ji.default)(new Error("record signature creation failed: "+n.message),cK)}},RRe=r=>{if(r.toString()==="0")return"EOL";let e=new Error(`unrecognized validity type ${r.toString()}`);throw _s.error(e),(0,ji.default)(e,p9)},mK=(r,e,t)=>{let i=Qe(RRe(e));return Li([r,t,i])},bK=r=>{let e=Qe("ipns-signature:");return Li([e,r])},xRe=r=>{let e=fi(r.id);return e.code!==wRe?null:gb.default.keys.unmarshalPublicKey(e.digest)},_9=r=>Gp.encode({...r,sequence:y9.default.fromString(r.sequence.toString()),ttl:r.ttl==null?void 0:y9.default.fromString(r.ttl.toString())}).finish(),iu=r=>{let e=Gp.decode(r),t=Gp.toObject(e,{defaults:!1,arrays:!0,objects:!1});return{value:t.value,signature:t.signature,validityType:t.validityType,validity:t.validity,sequence:Object.hasOwnProperty.call(t,"sequence")?BigInt(`${t.sequence}`):0,pubKey:t.pubKey,ttl:Object.hasOwnProperty.call(t,"ttl")?BigInt(`${t.ttl}`):void 0,signatureV2:t.signatureV2,data:t.data}},ud={validate:async(r,e)=>{let t=iu(r),i=e.slice(_Re.length),n=mb.default.createFromBytes(i),s=await b9(n,t);await m9(s,t)},select:(r,e)=>{let t=iu(r),i=iu(e);if(t.signatureV2&&!i.signatureV2)return 0;if(i.signatureV2&&!t.signatureV2)return 1;if(t.sequence>i.sequence)return 0;if(t.sequence<i.sequence)return 1;let n=pb($e(t.validity));return pb($e(i.validity)).getTime()>n.getTime()?1:0}};var ts=Object.assign((0,v9.default)("ipfs:ipns:publisher"),{error:(0,v9.default)("ipfs:ipns:publisher:error")}),wK=xi().code,_K=60*60*1e3,Wp=class{constructor(e,t){this._routing=e,this._datastore=t}async publishWithEOL(e,t,i){if(!e||!e.bytes)throw(0,vs.default)(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");let n=await O2.default.createFromPrivKey(e.bytes),s=await this._updateOrCreateRecord(e,t,i,n);return this._putRecordToRouting(s,n)}publish(e,t){return this.publishWithEOL(e,t,_K)}async _putRecordToRouting(e,t){if(!O2.default.isPeerId(t)){let o="peerId received is not valid";throw ts.error(o),(0,vs.default)(new Error(o),"ERR_INVALID_PEER_ID")}let i=t.pubKey,n=await gK(i,e),s=cd(t.toBytes());return await this._publishEntry(s.routingKey,n||e),n||e}async _publishEntry(e,t){let i=xe.asKey(e);if(!i){let s="datastore key does not have a valid format";throw ts.error(s),(0,vs.default)(new Error(s),"ERR_INVALID_DATASTORE_KEY")}let n;try{n=_9(t)}catch(s){throw ts.error(s),s}try{let s=await this._routing.put(i.uint8Array(),n);return ts(`ipns record for ${$e(i.uint8Array(),"base32")} was stored in the routing`),s}catch(s){let o=`ipns record for ${$e(i.uint8Array(),"base32")} could not be stored in the routing - ${s.stack}`;throw ts.error(o),ts.error(s),(0,vs.default)(new Error(o),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(e,t={}){if(!O2.default.isPeerId(e)){let n="peerId received is not valid";throw ts.error(n),(0,vs.default)(new Error(n),"ERR_INVALID_PEER_ID")}let i=t.checkRouting!==!1;try{let n=await this._datastore.get(C2(e.id));return this._unmarshalData(n)}catch(n){if(n.code!==wK){let s=`unexpected error getting the ipns record ${e.id} from datastore`;throw ts.error(s),(0,vs.default)(new Error(s),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!i)throw(0,vs.default)(n,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{let s=cd(e.toBytes()),o=await this._routing.get(s.routingKey.uint8Array());return this._unmarshalData(o)}catch(s){throw ts.error(s),s}}}_unmarshalData(e){try{return iu(e)}catch(t){throw(0,vs.default)(t,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(e,t,i,n){if(!O2.default.isPeerId(n)){let u="peerId received is not valid";throw ts.error(u),(0,vs.default)(new Error(u),"ERR_INVALID_PEER_ID")}let s={checkRouting:!0},o;try{o=await this._getPublished(n,s)}catch(u){if(u.code!==wK){let f=`unexpected error when determining the last published IPNS record for ${n.id} ${u.stack}`;throw ts.error(f),(0,vs.default)(new Error(f),"ERR_DETERMINING_PUBLISHED_RECORD")}}let a=0n;o&&o.sequence!==void 0&&(a=Hs(o.value,t)?BigInt(o.sequence):BigInt(o.sequence)+BigInt(1));let c;try{c=await yK(e,t,a,i)}catch(u){let f=`ipns record for ${t} could not be created`;throw ts.error(u),(0,vs.default)(new Error(f),"ERR_CREATING_IPNS_RECORD")}try{let u=_9(c);return await this._datastore.put(C2(n.id),u),ts(`ipns record for ${$e(t,"base32")} was stored in the datastore`),c}catch(u){let f=`ipns record for ${t} could not be stored in the datastore`;throw ts.error(f),(0,vs.default)(new Error(f),"ERR_STORING_IN_DATASTORE")}}};Wp.defaultRecordLifetime=_K;l();var vK=A(Qa()),E9=A(st()),vl=A(St()),S9=A(le()),wb=Object.assign((0,S9.default)("ipfs:ipns:republisher"),{error:(0,S9.default)("ipfs:ipns:republisher:error")}),EK=60*1e3,SK=60*EK,IRe=4*SK,TRe=24*SK,A9=class{constructor(e,t,i,n,s={pass:""}){this._publisher=e,this._datastore=t,this._peerId=i,this._keychain=n,this._options=s,this._republishHandle=null}async start(){if(this._republishHandle)throw(0,vl.default)(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");let e={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:s=>{e._timeoutId=setTimeout(async()=>{e._timeoutId=null;try{e._inflightTask=e._task(),await e._inflightTask,e._task&&e.runPeriodically(s)}catch(o){wb.error(o)}},s())},cancel:async()=>{e._timeoutId!=null&&clearTimeout(e._timeoutId),e._task=null,await e._inflightTask}},{privKey:t}=this._peerId,{pass:i}=this._options,n=!0;e._task=()=>this._republishEntries(t,i),e.runPeriodically(()=>n?(n=!1,this._options.initialBroadcastInterval||EK):this._options.broadcastInterval||IRe),this._republishHandle=e}async stop(){let e=this._republishHandle;if(!e)throw(0,vl.default)(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await e.cancel()}async _republishEntries(e,t){try{await this._republishEntry(e)}catch(i){let n="cannot republish entry for the node's private key";wb.error(n);return}if(t)try{let i=await this._keychain.listKeys();for(let n of i){if(n.name==="self")continue;let s=await this._keychain.exportKey(n.name,t),o=await vK.default.keys.import(s,t);await this._republishEntry(o)}}catch(i){wb.error(i)}}async _republishEntry(e){if(!e||!e.bytes)throw(0,vl.default)(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");try{let t=await E9.default.createFromPrivKey(e.bytes),i=await this._getPreviousValue(t);await this._publisher.publishWithEOL(e,i,TRe)}catch(t){if(t.code==="ERR_NO_ENTRY_FOUND")return;throw t}}async _getPreviousValue(e){if(!E9.default.isPeerId(e))throw(0,vl.default)(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{let t=await this._datastore.get(C2(e.id));if(!(t instanceof Uint8Array))throw(0,vl.default)(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return iu(t).value}catch(i){throw wb.error(i),(0,vl.default)(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(t){throw t&&t.notFound?(0,vl.default)(new Error(`no previous entry for record with id: ${e.id}`),"ERR_NO_ENTRY_FOUND"):t}}};l();var AK=A(st()),ld=A(St()),R9=A(le());et();eo();var _b=Object.assign((0,R9.default)("ipfs:ipns:resolver"),{error:(0,R9.default)("ipfs:ipns:resolver:error")}),PRe=xi().code,RK=32,x9=class{constructor(e){this._routing=e}async resolve(e,t={}){if(typeof e!="string")throw(0,ld.default)(new Error("invalid name"),"ERR_INVALID_NAME");let i=t.recursive&&t.recursive.toString()==="true",n=e.split("/");if(n.length!==3||n[0]!=="")throw(0,ld.default)(new Error("invalid name"),"ERR_INVALID_NAME");let s=n[2],o=1/0;i&&(o=RK);let a=await this.resolver(s,o);return _b(`${e} was locally resolved correctly`),a}async resolver(e,t){if(t===0){let s=`could not resolve name (recursion limit of ${RK} exceeded)`;throw _b.error(s),(0,ld.default)(new Error(s),"ERR_RESOLVE_RECURSION_LIMIT")}let i=await this._resolveName(e),n=i.split("/");return n[1]==="ipfs"||!t?i:this.resolver(n[2],t-1)}async _resolveName(e){let t=AK.default.parse(e),{routingKey:i}=cd(t.toBytes()),n;try{n=await this._routing.get(i.uint8Array())}catch(o){throw _b.error("could not get record from routing",o),o.code===PRe?(0,ld.default)(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND"):(0,ld.default)(new Error(`unexpected error getting the ipns record ${t.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s;try{s=iu(n)}catch(o){throw _b.error("could not unmarshal record",o),(0,ld.default)(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_RECORD_RECEIVED")}return this._validateRecord(t,s)}async _validateRecord(e,t){let i=await b9(e,t);return await m9(i,t),$e(t.value)}};l();var xK=A(xp()),I9=class{constructor(e){this.lru=(0,xK.default)(e)}get(e){let t=this.lru.get(e);if(t){if(t.expire&&t.expire<Date.now()){this.lru.remove(e);return}return t.value}}set(e,t,i){this.lru.set(e,{value:t,expire:Date.now()+i})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}};et();var k2=Object.assign((0,T9.default)("ipfs:ipns"),{error:(0,T9.default)("ipfs:ipns:error")}),PK=60*1e3,vb=class{constructor(e,t,i,n,s){this.publisher=new Wp(e,t),this.republisher=new A9(this.publisher,t,i,n,s),this.resolver=new x9(e),this.cache=new I9(1e3),this.routing=e}async publish(e,t,i=Wp.defaultRecordLifetime){try{let n=await(0,IK.createFromPrivKey)(e.bytes);await this.publisher.publishWithEOL(e,t,i),k2(`IPNS value ${$e(t,"base32")} was published correctly`);let s=n.toB58String(),o=parseFloat(i),a=o<PK?o:PK;return this.cache.set(s,t,a),k2(`IPNS value ${$e(t,"base32")} was cached correctly`),{name:s,value:t}}catch(n){throw k2.error(n),n}}async resolve(e,t={}){if(typeof e!="string")throw(0,TK.default)(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!t.nocache&&!t.recursive){let i=e.split("/")[2],n=this.cache.get(i);if(n)return n}try{let i=await this.resolver.resolve(e,t);return k2(`IPNS record from ${e} was resolved correctly`),i}catch(i){throw k2.error(i),i}}async initializeKeyspace(e,t){return this.publish(e,t,Wp.defaultRecordLifetime)}};l();L9();var Lb=A(N2());l();di();l();Xp();Ob();l();var ZK=A(Z9());et();at();var kb="/record/";function J9(r){return $e(r,"base32")}function j2(r){(typeof r=="string"||r instanceof String)&&(r=Qe(r.toString()));let e=$e(r,"base64url");return`${kb}${e}`}function JK(r){if(r.substring(0,kb.length)!==kb)throw(0,ZK.default)(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");let e=r.substring(kb.length);return Qe(e,"base64url")}hi();var Es=A(Z9()),eS=A(le()),_n=Object.assign((0,eS.default)("datastore-pubsub:publisher"),{error:(0,eS.default)("datastore-pubsub:publisher:error")}),tS=class extends sn{constructor(e,t,i,n,s){super();if(!n)throw(0,Es.default)(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if(typeof n.validate!="function")throw(0,Es.default)(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if(typeof n.select!="function")throw(0,Es.default)(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(s&&typeof s!="function")throw(0,Es.default)(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=t,this._peerId=i,this._validator=n,this._handleSubscriptionKeyFn=s,this._onMessage=this._onMessage.bind(this)}async put(e,t){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw _n.error(n),(0,Es.default)(new Error(n),"ERR_INVALID_DATASTORE_KEY")}if(!(t instanceof Uint8Array)){let n="received value is not a Uint8Array";throw _n.error(n),(0,Es.default)(new Error(n),"ERR_INVALID_VALUE_RECEIVED")}let i=j2(e);_n(`publish value for topic ${i}`),await this._pubsub.publish(i,t)}async get(e){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw _n.error(n),(0,Es.default)(new Error(n),"ERR_INVALID_DATASTORE_KEY")}let t=j2(e),i=await this._pubsub.getTopics();if(i&&Array.isArray(i)&&i.indexOf(t)>-1)return this._getLocal(e);try{this._pubsub.on(t,this._onMessage),await this._pubsub.subscribe(t)}catch(n){let s=`cannot subscribe topic ${t}`;throw _n.error(s),(0,Es.default)(new Error(s),"ERR_SUBSCRIBING_TOPIC")}return _n(`subscribed values for key ${t}`),this._getLocal(e)}unsubscribe(e){let t=j2(e);return this._pubsub.removeListener(t,this._onMessage),this._pubsub.unsubscribe(t)}async _getLocal(e){let t=new xe("/"+J9(e),!1),i;try{i=await this._datastore.get(t)}catch(n){if(n.code!=="ERR_NOT_FOUND"){let o=`unexpected error getting the ipns record for ${t.toString()}`;throw _n.error(o),(0,Es.default)(new Error(o),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s=`local record requested was not found for ${t.toString()}`;throw _n.error(s),(0,Es.default)(new Error(s),"ERR_NOT_FOUND")}if(!(i instanceof Uint8Array)){let n="found record that we couldn't convert to a value";throw _n.error(n),(0,Es.default)(new Error(n),"ERR_INVALID_RECORD_RECEIVED")}return i}async _onMessage(e){let{data:t,from:i,topicIDs:n}=e,s;try{s=JK(n[0])}catch(o){_n.error(o);return}if(_n(`message received for topic ${n[0]}`),i===this._peerId.toB58String()){_n("message discarded as it is from the same peer");return}if(this._handleSubscriptionKeyFn){let o;try{o=await this._handleSubscriptionKeyFn(s)}catch(a){_n.error("message discarded by the subscriptionKeyFn");return}s=o}try{await this._storeIfSubscriptionIsBetter(s,t)}catch(o){_n.error(o)}}async _storeIfSubscriptionIsBetter(e,t){let i=!1;try{i=await this._isBetter(e,t)}catch(n){if(n.code!=="ERR_NOT_VALID_RECORD")throw n}i&&await this._storeRecord(e,t)}async _validateRecord(e,t){return this._validator.validate(e,t)}async _selectRecord(e,t){return await this._validator.select(e,t)===0}async _isBetter(e,t){try{await this._validateRecord(t,e)}catch(s){let o="record received through pubsub is not valid";throw _n.error(o),(0,Es.default)(new Error(o),"ERR_NOT_VALID_RECORD")}let i=new xe(e),n;try{n=await this._getLocal(i.uint8Array())}catch(s){return!0}return Hs(n,t)?!1:this._selectRecord(e,[n,t])}async _storeRecord(e,t){let i=new xe("/"+J9(e),!1);await this._datastore.put(i,t),_n(`record for ${j2(e)} was stored in the datastore`)}};at();et();var rS=A(St()),iS=A(le()),Db=Object.assign((0,iS.default)("ipfs:ipns:pubsub"),{error:(0,iS.default)("ipfs:ipns:pubsub:error")}),Jp=class{constructor(e,t,i){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new tS(e,t,i,ud,this._handleSubscriptionKey)}async put(e,t){try{await this._pubsubDs.put(e,t)}catch(i){throw Db.error(i),i}}async get(e){let t,i;try{t=await this._pubsubDs.get(e)}catch(s){i=s}let n=e.slice(0,bb);if($e(n)===P2){let s=yt.encode(e).substring(1),o=yt.encode(e.slice(bb)).substring(1);this._subscriptions[s]=o,Db(`subscribed to pubsub topic ${s}, id ${o}`)}if(i)throw i;return t}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=$e(e,"base58btc"));let t=this._subscriptions[e];if(!t)throw(0,rS.default)(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");let i;try{i=cd(Qe(t,"base58btc"))}catch(n){throw Db.error(n),n}return i.routingKey.uint8Array()}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map(t=>`${P2}${t}`)}async cancel(e){if(typeof e!="string")throw(0,rS.default)(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(P2)&&(e=e.substring(bb));let t=Object.keys(this._subscriptions).find(n=>this._subscriptions[n]===e);if(!t)return{canceled:!1};let i=Qe(t);return this._pubsubDs.unsubscribe(i),delete this._subscriptions[t],Db(`unsubscribed pubsub ${t}: ${e}`),{canceled:!0}}};l();Mr();var aS=A(Ja()),t0=A(St()),cS=A(le());et();var uS=Object.assign((0,cS.default)("ipfs:ipns:offline-datastore"),{error:(0,cS.default)("ipfs:ipns:offline-datastore:error")}),F2=class{constructor(e){this._repo=e,this.stores=[]}async put(e,t){if(!(e instanceof Uint8Array))throw(0,t0.default)(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(t instanceof Uint8Array))throw(0,t0.default)(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let i;try{i=this._routingKey(e)}catch(s){throw uS.error(s),(0,t0.default)(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let n=new aS.Record(e,t);return this._repo.datastore.put(i,n.serialize())}async get(e){if(!(e instanceof Uint8Array))throw(0,t0.default)(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let t;try{t=this._routingKey(e)}catch(s){throw uS.error(s),(0,t0.default)(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let i=await this._repo.datastore.get(t),n;try{n=aS.Record.deserialize(i)}catch(s){throw uS.error(s),s}return n.value}_routingKey(e){return new xe("/dht/record/"+$e(e,"base32"),!1)}};l();var EV=A(rs());eo();var lS=A(le()),JRe=Object.assign((0,lS.default)("ipfs:ipns:dht-datastore"),{error:(0,lS.default)("ipfs:ipns:dht-datastore:error")}),fS=class{constructor(e){this._dht=e}async put(e,t){try{await(0,EV.default)(this._dht.put(e,t))}catch(i){throw JRe.error(i),i}}async get(e){for await(let t of this._dht.get(e))if(t.name==="VALUE")return t.value;throw xi()}};function SV({libp2p:r,repo:e,peerId:t,options:i}){let n=[],s;if((0,Lb.default)(i,"EXPERIMENTAL.ipnsPubsub",!1)){let o=r.pubsub,a=e.datastore;s=new Jp(o,a,t),n.push(s)}if(!(0,Lb.default)(i,"offline",!1)&&r._config&&r._config.dht&&r._config.dht.enabled&&n.push(new fS(r._dht)),(0,Lb.default)(i,"offline",!1)||n.length===0){let o=new F2(e);n.push(o)}return new D2(n)}var AV=A(le()),exe=(0,AV.default)("ipfs:components:ipns"),dS=class{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){let e=this.online||this.offline;if(e)return e;throw new tl}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:t,keychain:i}){if(this.offline!=null)throw new Ba;exe("initializing IPNS keyspace");let n=new F2(e),s=new vb(n,e.datastore,t,i,this.options);this.offline=s}async startOnline({libp2p:e,repo:t,peerId:i,keychain:n}){if(this.online!=null)throw new Ba;let s=SV({libp2p:e,repo:t,peerId:i,options:this.options}),o=new vb(s,t.datastore,i,n,this.options);await o.republisher.start(),this.online=o}async stop(){let e=this.online;e&&(await e.republisher.stop(),this.online=null)}publish(e,t,i){return this.getIPNS().publish(e,t,i)}resolve(e,t){return this.getIPNS().resolve(e,t)}initializeKeyspace(e,t){return this.getIPNS().initializeKeyspace(e,t)}};l();l();var hS=A(le());var TV=A(Qa()),pS=A(St());at();et();l();var RV=A(Sp());var xV=A(rs());async function IV({ipns:r,repo:e,codecs:t},i,n){if(RV.default.ipnsPath(i))return r.resolve(i);let{cid:s,path:o}=Gc(i);await(0,xV.default)(cl(s,o||"",t,e,n))}var yS=Object.assign((0,hS.default)("ipfs:name:publish"),{error:(0,hS.default)("ipfs:name:publish:error")});function PV({ipns:r,repo:e,codecs:t,peerId:i,isOnline:n,keychain:s}){let o=async c=>{if(c==="self")return i.privKey;try{let u=await s.exportKey(c,"temp");return await TV.default.keys.import(u,"temp")}catch(u){throw yS.error(u),(0,pS.default)(u,"ERR_CANNOT_GET_KEY")}};async function a(c,u={}){let f=u.resolve!==!1,d=u.lifetime||"24h",h=u.key||"self";if(!n())throw(0,pS.default)(new Error(E4),"OFFLINE_ERROR");try{c=xM(c)}catch(b){throw yS.error(b),b}let p=0;try{p=sl(d)||0,p=parseFloat(p.toFixed(6))}catch(b){throw yS.error(b),b}let y=await Promise.all([o(h),f?IV({ipns:r,repo:e,codecs:t},c):Promise.resolve()]),g=Qe(c),w=await r.publish(y[0],g,p);return{name:w.name,value:$e(w.value)}}return Q(a)}l();var gS=A(le()),Mb=A(St());we();tn();Ly();var kV=A(st()),DV=A(OV());et();var rxe=Ct.bind({ignoreUndefined:!0}),ixe=Object.assign((0,gS.default)("ipfs:name:resolve"),{error:(0,gS.default)("ipfs:name:resolve:error")}),NV=(r,e)=>e.length>0?r+"/"+e.join("/"):r;function BV({dns:r,ipns:e,peerId:t,isOnline:i,options:{offline:n}}){async function*s(o,a={}){if(a=rxe({nocache:!1,recursive:!0},a),n&&a&&a.nocache)throw(0,Mb.default)(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");if(!i()&&!n)throw(0,Mb.default)(new Error(E4),"OFFLINE_ERROR");o||(o=t.toB58String()),o.startsWith("/ipns/")||(o=`/ipns/${o}`);let[c,u,...f]=o.slice(1).split("/");try{if(u.substring(0,1)==="1"){let h=kV.default.parse(u),p=fi(h.toBytes());u=L.createV1(114,p).toString(fp)}else{let h=L.parse(u);h.version===1&&(u=h.toString(fp))}}catch(h){if((0,DV.default)(u)){yield NV(await r(u,a),f);return}throw ixe.error(h),(0,Mb.default)(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}let d=await e.resolve(`/${c}/${u}`,a);yield NV(d instanceof Uint8Array?$e(d):d,f)}return Q(s)}l();l();l();var mS=A(St());function r0(r,e){if(!r||!(e&&e.ipnsPubsub))throw(0,mS.default)(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(r.routing instanceof Jp)return r.routing;let t=(r.routing.stores||[]).find(i=>i instanceof Jp);if(!t)throw(0,mS.default)(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return t}function LV({ipns:r,options:e}){let t=e.EXPERIMENTAL;async function i(n,s={}){return r0(r,t).cancel(n,s)}return Q(i)}l();function MV({ipns:r,options:e}){let t=e.EXPERIMENTAL;async function i(n={}){try{return{enabled:Boolean(r0(r,t))}}catch(s){return{enabled:!1}}}return Q(i)}l();function jV({ipns:r,options:e}){let t=e.EXPERIMENTAL;async function i(n={}){return r0(r,t).getSubscriptions(n)}return Q(i)}var bS=class{constructor({ipns:e,options:t}){this.cancel=LV({ipns:e,options:t}),this.state=MV({ipns:e,options:t}),this.subs=jV({ipns:e,options:t})}};var wS=class{constructor({dns:e,ipns:t,repo:i,codecs:n,peerId:s,isOnline:o,keychain:a,options:c}){this.publish=PV({ipns:t,repo:i,codecs:n,peerId:s,isOnline:o,keychain:a}),this.resolve=BV({dns:e,ipns:t,peerId:s,isOnline:o,options:c}),this.pubsub=new bS({ipns:t,options:c})}};l();eo();we();var qV=A(Ma()),UV=A($o()),nxe=xi().code,_S={default:"<dst>",edges:"<src> -> <dst>"};function FV({repo:r,codecs:e,resolve:t,preload:i}){async function*n(s,o={}){if(o.maxDepth===0)return;if(o.edges&&o.format&&o.format!==_S.default)throw new Error("Cannot set edges to true and also specify format");if(o.format=o.edges?_S.edges:o.format,typeof o.maxDepth!="number"&&(o.maxDepth=o.recursive?1/0:1),o.timeout){let f=[new qV.TimeoutController(o.timeout).signal];o.signal&&f.push(o.signal),o.signal=(0,UV.anySignal)(f)}let c=(Array.isArray(s)?s:[s]).map(u=>sxe(i,u,o));for(let u of c)try{yield*oxe(t,r,e,u,o)}catch(f){yield{ref:"",err:f.message}}}return n}function sxe(r,e,t){let{cid:i,path:n}=Gc(e);return t.preload!==!1&&r(i),`/ipfs/${i}${n||""}`}async function*oxe(r,e,t,i,n){let s=await r(i,n),{cid:o}=Gc(s),a=n.maxDepth!=null?n.maxDepth:1/0,c=n.unique||!1;for await(let u of cxe(e,t,o,a,c,n))!u.parent||u.isDuplicate||(yield{ref:axe(u.parent.cid,u.node.cid,u.node.name,n.format)})}function axe(r,e,t="",i=_S.default){let n=i.replace(/<src>/g,r.toString());return n=n.replace(/<dst>/g,e.toString()),n=n.replace(/<linkname>/g,t),n}async function*cxe(r,e,t,i,n,s){let o=new Set;async function*a(c,u){let f=u+1;if(!(f>i))try{for await(let d of uxe(r,e,c.cid,s))yield{parent:c,node:d,isDuplicate:n&&o.has(d.cid.toString())},n&&o.add(d.cid.toString()),yield*a(d,f)}catch(d){throw d.code===nxe&&(d.message=`Could not find object with CID: ${c.cid}`),d}}yield*a({cid:t},0)}async function*uxe(r,e,t,i){let n=await r.blocks.get(t,i),o=(await e.getCodec(t.code)).decode(n),a=t.code===wt,c=[];for(let[u,f]of vS(o,c)){if(a){let d=u.match(/^Links\/(\d+)\/Hash$/);if(d){let h=Number(d[1]);if(h<o.Links.length){yield{name:o.Links[h].Name,cid:f};continue}}}yield{name:u,cid:f}}}var vS=function*(r,e){if(r!=null&&!(r instanceof Uint8Array)){for(let[t,i]of Object.entries(r)){let n=[...e,t];if(i!=null&&typeof i=="object")if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s],c=L.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*vS(o,a))}else{let s=L.asCID(i);s?yield[n.join("/"),s]:yield*vS(i,n)}}return[]}};l();function KV({repo:r}){async function*e(t={}){for await(let i of r.blocks.queryKeys({},{signal:t.signal}))yield{ref:i.toString()}}return Q(e)}l();l();function VV({network:r}){async function e(t={}){let{bitswap:i}=await r.use(t),n=i.getWantlist();return Array.from(n).map(s=>s[1].cid)}return Q(e)}l();var zV=A(st());function HV({network:r}){async function e(t,i={}){let{bitswap:n}=await r.use(i),s=n.wantlistForPeer(zV.default.createFromB58String(t));return Array.from(s).map(o=>o[1].cid)}return Q(e)}l();function $V({network:r}){async function e(t,i={}){let{bitswap:n}=await r.use(i);return Array.isArray(t)||(t=[t]),n.unwant(t)}return Q(e)}l();function jb({network:r}){async function e(t={}){let i=(await r.use(t)).bitswap,n=i.stat().snapshot;return{provideBufLen:parseInt(n.providesBufferLength.toString()),blocksReceived:BigInt(n.blocksReceived.toString()),wantlist:Array.from(i.getWantlist()).map(s=>s[1].cid),peers:i.peers().map(s=>s.toB58String()),dupBlksReceived:BigInt(n.dupBlksReceived.toString()),dupDataReceived:BigInt(n.dupDataReceived.toString()),dataReceived:BigInt(n.dataReceived.toString()),blocksSent:BigInt(n.blocksSent.toString()),dataSent:BigInt(n.dataSent.toString())}}return Q(e)}var ES=class{constructor({network:e}){this.wantlist=VV({network:e}),this.wantlistForPeer=HV({network:e}),this.unwant=$V({network:e}),this.stat=jb({network:e})}};l();l();l();var GV=A(Kf());function qb(r){try{return GV.default.IPFS.matches(r)}catch(e){return!1}}function WV({repo:r}){async function e(t,i={}){if(!qb(t))throw new Error(`${t} is not a valid Multiaddr`);let n=await r.config.getAll(i),s=n.Bootstrap||[];return s.push(t.toString()),n.Bootstrap=Array.from(new Set(s)).sort((o,a)=>o.localeCompare(a)),await r.config.replace(n),{Peers:[t]}}return Q(e)}l();var YV=A(lt());function XV({repo:r}){async function e(t={}){let i=await r.config.getAll(t),n=i.Bootstrap||[];return i.Bootstrap=[],await r.config.replace(i),{Peers:n.map(s=>new YV.Multiaddr(s))}}return Q(e)}l();var QV=A(lt());function ZV({repo:r}){async function e(t={}){return{Peers:(await r.config.get("Bootstrap",t)||[]).map(n=>new QV.Multiaddr(n))}}return Q(e)}l();l();var nu=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}});var JV=A(lt());function ez({repo:r}){async function e(t={}){let i=await r.config.getAll(t);return i.Bootstrap=nu().Bootstrap,await r.config.replace(i),{Peers:nu().Bootstrap.map(n=>new JV.Multiaddr(n))}}return Q(e)}l();function tz({repo:r}){async function e(t,i={}){if(!qb(t))throw new Error(`${t} is not a valid Multiaddr`);let n=await r.config.getAll(i);return n.Bootstrap=(n.Bootstrap||[]).filter(s=>s.toString()!==t.toString()),await r.config.replace(n),{Peers:[t]}}return Q(e)}var SS=class{constructor({repo:e}){this.add=WV({repo:e}),this.list=ZV({repo:e}),this.rm=tz({repo:e}),this.clear=XV({repo:e}),this.reset=ez({repo:e})}};l();l();function rz({preload:r,repo:e}){async function t(i,n={}){return n.preload!==!1&&r(i),e.blocks.get(i,n)}return Q(t)}l();we();function iz({codecs:r,hashers:e,repo:t,preload:i}){async function n(s,o={}){let a=o.pin?await t.gcLock.readLock():null;try{let c=o.version!=null?o.version:0,u=o.format||(c===0?"dag-pb":"raw"),d=await(await e.getHasher(o.mhtype||"sha2-256")).digest(s),h=await r.getCodec(u),p=L.create(c,h.code,d);return await t.blocks.put(p,s,{signal:o.signal}),o.preload!==!1&&i(p),o.pin===!0&&await t.pins.pinRecursively(p,{signal:o.signal}),p}finally{a&&a()}}return Q(n)}l();var gz=A(St()),mz=A(Vb()),bz=A(wn()),wz=A(is()),_z=A(dr());l();we();function zb(r){return r instanceof Uint8Array?L.decode(r):L.parse(r.toString())}var wxe=8;function vz({repo:r}){async function*e(t,i={}){Array.isArray(t)||(t=[t]);let n=await r.gcLock.writeLock();try{yield*(0,_z.pipe)(t,s=>(0,bz.default)(s,o=>async()=>{o=zb(o);let a={cid:o};try{if(!await r.blocks.has(o))throw(0,gz.default)(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await r.blocks.delete(o)}catch(c){i.force||(c.message=`cannot remove ${o}: ${c.message}`,a.error=c)}return a}),s=>(0,mz.default)(s,{concurrency:wxe}),s=>(0,wz.default)(s,()=>!i.quiet))}finally{n()}}return Q(e)}l();function Ez({repo:r,preload:e}){async function t(i,n={}){i=zb(i),n.preload!==!1&&e(i);let s=await r.blocks.get(i);return{cid:i,size:s.length}}return Q(t)}var RS=class{constructor({codecs:e,hashers:t,preload:i,repo:n}){this.get=rz({preload:i,repo:n}),this.put=iz({codecs:e,hashers:t,preload:i,repo:n}),this.rm=vz({repo:n}),this.stat=Ez({preload:i,repo:n})}};l();l();var Mz=A(Zn());l();l();var Tz=A(Vf());at();var Pz=A(n0()),Cz=A(xz()),Oz=A(s0()),kz=A(Jo()),Dz=A(wn());l();function so(r){return ArrayBuffer.isView(r)||r instanceof ArrayBuffer}function su(r){return r.constructor&&(r.constructor.name==="Blob"||r.constructor.name==="File")&&typeof r.stream=="function"}function K2(r){return typeof r=="object"&&(r.path||r.content)}var ou=r=>r&&typeof r.getReader=="function";async function*Hb(r){yield r}async function $b(r){if(so(r))return Hb(xS(r));if(typeof r=="string"||r instanceof String)return Hb(xS(r.toString()));if(su(r))return(0,Cz.default)(r);if(ou(r)&&(r=(0,Pz.default)(r)),Symbol.iterator in r||Symbol.asyncIterator in r){let e=(0,Oz.default)(r),{value:t,done:i}=await e.peek();if(i)return Hb(new Uint8Array(0));if(e.push(t),Number.isInteger(t))return Hb(Uint8Array.from(await(0,kz.default)(e)));if(so(t)||typeof t=="string"||t instanceof String)return(0,Dz.default)(e,xS)}throw(0,Tz.default)(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT")}function xS(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r instanceof ArrayBuffer?new Uint8Array(r):Array.isArray(r)?Uint8Array.from(r):Qe(r.toString())}l();var Gb=A(Vf()),Nz=A(n0()),Bz=A(s0());async function*Lz(r,e){if(r==null)throw(0,Gb.default)(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT");if(typeof r=="string"||r instanceof String){yield Wb(r.toString(),e);return}if(so(r)||su(r)){yield Wb(r,e);return}if(ou(r)&&(r=(0,Nz.default)(r)),Symbol.iterator in r||Symbol.asyncIterator in r){let t=(0,Bz.default)(r),{value:i,done:n}=await t.peek();if(n){yield{content:[]};return}if(t.push(i),Number.isInteger(i)||so(i)||typeof i=="string"||i instanceof String){yield Wb(t,e);return}throw(0,Gb.default)(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(K2(r)){yield Wb(r,e);return}throw(0,Gb.default)(new Error('Unexpected input: cannot convert "'+typeof r+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function Wb(r,e){let{path:t,mode:i,mtime:n,content:s}=r,o={path:t||"",mode:Uc(i),mtime:$u(n)};return s?o.content=await e(s):t||(o.content=await e(r)),o}function Yb(r){return Lz(r,$b)}function jz({addAll:r}){async function e(t,i={}){let n=await(0,Mz.default)(r(Yb(t),i));if(n==null)throw Error("Failed to add a file, if you see this please report a bug");return n}return e}l();l();var r$=A(Qb());l();Si();l();Z3();up();var IS=A(Vz());function xxe(r){let e=new Array(4);for(let t=0;t<4;t++)e[t]=r&255,r=r>>8;return new Uint8Array(e)}var Pht=cp({name:"murmur3-32",code:35,encode:r=>xxe(IS.default.x86.hash32(r))}),gd=cp({name:"murmur3-128",code:34,encode:r=>ep.fromHex(IS.default.x64.hash128(r))});async function Ixe(r){return(await gd.encode(r)).slice(0,8).reverse()}var Txe={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:Lr,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:17437180132763652,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:Ixe,hamtHashCode:34,hamtBucketBits:8},zz=(r={})=>Ct.bind({ignoreUndefined:!0})(Txe,r);l();l();l();we();Si();var Pxe=async(r,e,t)=>{t.codec||(t.codec=Tn),t.hasher||(t.hasher=Lr),t.cidVersion===void 0&&(t.cidVersion=1),t.codec===Tn&&t.hasher!==Lr&&(t.cidVersion=1);let i=await t.hasher.digest(r),n=L.create(t.cidVersion,t.codec.code,i);return t.onlyHash||await e.put(n,r,{signal:t.signal}),n},ea=Pxe;var Cxe=async(r,e,t)=>{let i=new dt({type:"directory",mtime:r.mtime,mode:r.mode}),n=ut($i({Data:i.marshal()})),s=await ea(n,e,t),o=r.path;return{cid:s,path:o,unixfs:i,size:n.length}},Hz=Cxe;l();var iH=A(z2());var nH=A(Qb());Vs();l();var Wz=A(Jo());async function kxe(r,e){return e(await(0,Wz.default)(r))}var Yz=kxe;l();var Xz=A(Xb());function Dxe(r,e,t){return Qz(r,e,t)}async function Qz(r,e,t){let i=[];for await(let n of(0,Xz.default)(r,t.maxChildrenPerNode))i.push(await e(n));return i.length>1?Qz(i,e,t):i[0]}var Zz=Dxe;l();var Jz=A(Xb());async function Nxe(r,e,t){let i=new tH(t.layerRepeat),n=0,s=1,o=i;for await(let a of(0,Jz.default)(r,t.maxChildrenPerNode))o.isFull()&&(o!==i&&i.addChild(await o.reduce(e)),n&&n%t.layerRepeat==0&&s++,o=new TS(s,t.layerRepeat,n),n++),o.append(a);return o&&o!==i&&i.addChild(await o.reduce(e)),i.reduce(e)}var eH=Nxe,TS=class{constructor(e,t,i=0){this.maxDepth=e,this.layerRepeat=t,this.currentDepth=1,this.iteration=i,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;let e=this._findParent(this.node,this.currentDepth);return e?(this._addNextNodeToParent(e),!1):!0}_addNextNodeToParent(e){this.parent=e;let t={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(t),this.currentDepth=t.depth,this.node=t}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,t){let i=[];return e.children.length&&(i=await Promise.all(e.children.filter(n=>n.data).map(n=>this._reduce(n,t)))),t((e.data||[]).concat(i))}_findParent(e,t){let i=e.parent;if(!(!i||i.depth===0))return i.children.length===i.maxChildren||!i.maxChildren?this._findParent(i,t):i}},tH=class extends TS{constructor(e){super(0,e);this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}};l();Vs();async function*Bxe(r,e,t){for await(let i of r.content)yield async()=>{t.progress(i.length,r.path);let n,s={codec:Tn,cidVersion:t.cidVersion,hasher:t.hasher,onlyHash:t.onlyHash};return t.rawLeaves?(s.codec=My,s.cidVersion=1):(n=new dt({type:t.leafType,data:i,mtime:r.mtime,mode:r.mode}),i=ut({Data:n.marshal(),Links:[]})),{cid:await ea(i,e,s),unixfs:n,size:i.length}}}var rH=Bxe;var Lxe={flat:Yz,balanced:Zz,trickle:eH};async function*Mxe(r,e,t){let i=-1,n,s;typeof t.bufferImporter=="function"?s=t.bufferImporter:s=rH;for await(let o of(0,nH.default)(s(r,e,t),t.blockWriteConcurrency)){if(i++,i===0){n=o;continue}else i===1&&n&&(yield n,n=null);yield o}n&&(n.single=!0,yield n)}var jxe=(r,e,t)=>{async function i(n){if(n.length===1&&n[0].single&&t.reduceSingleLeafToSelf){let f=n[0];if(f.cid.code===Bi&&(r.mtime!==void 0||r.mode!==void 0)){let d=await e.get(f.cid);f.unixfs=new dt({type:"file",mtime:r.mtime,mode:r.mode,data:d}),d=ut($i({Data:f.unixfs.marshal()})),f.cid=await ea(d,e,{...t,codec:Tn,hasher:t.hasher,cidVersion:t.cidVersion}),f.size=d.length}return{cid:f.cid,path:r.path,unixfs:f.unixfs,size:f.size}}let s=new dt({type:"file",mtime:r.mtime,mode:r.mode}),o=n.filter(f=>f.cid.code===Bi&&f.size||f.unixfs&&!f.unixfs.data&&f.unixfs.fileSize()?!0:Boolean(f.unixfs&&f.unixfs.data&&f.unixfs.data.length)).map(f=>f.cid.code===Bi?(s.addBlockSize(f.size),{Name:"",Tsize:f.size,Hash:f.cid}):(!f.unixfs||!f.unixfs.data?s.addBlockSize(f.unixfs&&f.unixfs.fileSize()||0):s.addBlockSize(f.unixfs.data.length),{Name:"",Tsize:f.size,Hash:f.cid})),a={Data:s.marshal(),Links:o},c=ut($i(a));return{cid:await ea(c,e,t),path:r.path,unixfs:s,size:c.length+a.Links.reduce((f,d)=>f+d.Tsize,0)}}return i};function qxe(r,e,t){let i=Lxe[t.strategy];if(!i)throw(0,iH.default)(new Error(`Unknown importer build strategy name: ${t.strategy}`),"ERR_BAD_STRATEGY");return i(Mxe(r,e,t),jxe(r,e,t),t)}var sH=qxe;var LS=A(z2());l();var PH=A(on()),CH=A(TH()),NS=A(z2());async function*Qxe(r,e){let t,i,n;if(e.minChunkSize&&e.maxChunkSize&&e.avgChunkSize)n=e.avgChunkSize,t=e.minChunkSize,i=e.maxChunkSize;else if(e.avgChunkSize)n=e.avgChunkSize,t=n/3,i=n+n/2;else throw(0,NS.default)(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");if(t<16)throw(0,NS.default)(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");i<t&&(i=t),n<t&&(n=t);let s=Math.floor(Math.log2(n));for await(let o of Zxe(r,{min:t,max:i,bits:s,window:e.window,polynomial:e.polynomial}))yield o}var OH=Qxe;async function*Zxe(r,e){let t=await(0,CH.create)(e.bits,e.min,e.max,e.window),i=new PH.default;for await(let n of r){i.append(n);let s=t.fingerprint(n);for(let o=0;o<s.length;o++){let a=s[o],c=i.slice(0,a);i.consume(a),yield c}}i.length&&(yield i.slice(0))}l();var t6=A(on());async function*Jxe(r,e){let t=new t6.default,i=0,n=!1,s=e.maxChunkSize;for await(let o of r)for(t.append(o),i+=o.length;i>=s;)if(yield t.slice(0,s),n=!0,s===t.length)t=new t6.default,i=0;else{let a=new t6.default;a.append(t.shallowSlice(s)),t=a,i-=s}(!n||i)&&(yield t.slice(0,i))}var kH=Jxe;l();var BS=A(z2());at();async function*eIe(r){for await(let e of r){if(e.length===void 0)throw(0,BS.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof e=="string"||e instanceof String)yield Qe(e.toString());else if(Array.isArray(e))yield Uint8Array.from(e);else if(e instanceof Uint8Array)yield e;else throw(0,BS.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}}var DH=eIe;function tIe(r){return Symbol.iterator in r}function rIe(r){return Symbol.asyncIterator in r}function iIe(r){try{if(r instanceof Uint8Array)return async function*(){yield r}();if(tIe(r))return async function*(){yield*r}();if(rIe(r))return r}catch{throw(0,LS.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw(0,LS.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*nIe(r,e,t){for await(let i of r)if(i.path&&(i.path.substring(0,2)==="./"&&(t.wrapWithDirectory=!0),i.path=i.path.split("/").filter(n=>n&&n!==".").join("/")),i.content){let n;typeof t.chunker=="function"?n=t.chunker:t.chunker==="rabin"?n=OH:n=kH;let s;typeof t.chunkValidator=="function"?s=t.chunkValidator:s=DH;let o={path:i.path,mtime:i.mtime,mode:i.mode,content:n(s(iIe(i.content),t),t)};yield()=>sH(o,e,t)}else if(i.path){let n={path:i.path,mtime:i.mtime,mode:i.mode};yield()=>Hz(n,e,t)}else throw new Error("Import candidate must have content or path or both")}var NH=nIe;l();l();l();var BH=class{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}},Rl=BH;var LH=class extends Rl{constructor(e,t){super(e,t);this._children={}}async put(e,t){this.cid=void 0,this.size=void 0,this._children[e]=t}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){let e=Object.keys(this._children);for(let t=0;t<e.length;t++){let i=e[t];yield{key:i,child:this._children[i]}}}async*flush(e){let t=Object.keys(this._children),i=[];for(let u=0;u<t.length;u++){let f=this._children[t[u]];if(f instanceof Rl)for await(let d of f.flush(e))f=d,yield f;f.size!=null&&f.cid&&i.push({Name:t[u],Tsize:f.size,Hash:f.cid})}let n=new dt({type:"directory",mtime:this.mtime,mode:this.mode}),s={Data:n.marshal(),Links:i},o=ut($i(s)),a=await ea(o,e,this.options),c=o.length+s.Links.reduce((u,f)=>u+(f.Tsize==null?0:f.Tsize),0);this.cid=a,this.size=c,yield{cid:a,unixfs:n,path:this.path,size:c}}},W2=LH;l();l();var n6=A(Y2()),WH=class extends Rl{constructor(e,t){super(e,t);this._bucket=(0,n6.createHAMT)({hashFn:t.hamtHashFn,bits:t.hamtBucketBits})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){for await(let t of XH(this._bucket,e,this,this.options))yield{...t,path:this.path}}},YH=WH;async function*XH(r,e,t,i){let n=r._children,s=[],o=0;for(let p=0;p<n.length;p++){let y=n.get(p);if(!y)continue;let g=p.toString(16).toUpperCase().padStart(2,"0");if(y instanceof n6.Bucket){let w;for await(let b of await XH(y,e,null,i))w=b;if(!w)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:g,Tsize:w.size,Hash:w.cid}),o+=w.size}else if(typeof y.value.flush=="function"){let w=y.value,b;for await(let R of w.flush(e))b=R,yield b;let v=g+y.key;s.push({Name:v,Tsize:b.size,Hash:b.cid}),o+=b.size}else{let w=y.value;if(!w.cid)continue;let b=g+y.key,v=w.size;s.push({Name:b,Tsize:v,Hash:w.cid}),o+=v}}let a=Uint8Array.from(n.bitField().reverse()),c=new dt({type:"hamt-sharded-directory",data:a,fanout:r.tableSize(),hashType:i.hamtHashCode,mtime:t&&t.mtime,mode:t&&t.mode}),u={Data:c.marshal(),Links:s},f=ut($i(u)),d=await ea(f,e,i),h=f.length+o;yield{cid:d,unixfs:c,size:h}}async function QH(r,e,t,i){let n=e;e instanceof W2&&e.directChildrenCount()>=t&&(n=await EIe(e,i));let s=n.parent;if(s){if(n!==e){if(r&&(r.parent=n),!n.parentKey)throw new Error("No parent key found");await s.put(n.parentKey,n)}return QH(n,s,t,i)}return n}async function EIe(r,e){let t=new YH({root:r.root,dir:!0,parent:r.parent,parentKey:r.parentKey,path:r.path,dirty:r.dirty,flat:!1,mtime:r.mtime,mode:r.mode},e);for await(let{key:i,child:n}of r.eachChildSeries())await t.put(i,n);return t}var ZH=QH;l();var SIe=(r="")=>(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),JH=SIe;async function AIe(r,e,t){let i=JH(r.path||""),n=i.length-1,s=e,o="";for(let a=0;a<i.length;a++){let c=i[a];o+=`${o?"/":""}${c}`;let u=a===n;if(s.dirty=!0,s.cid=void 0,s.size=void 0,u)await s.put(c,r),e=await ZH(null,s,t.shardSplitThreshold,t);else{let f=await s.get(c);(!f||!(f instanceof Rl))&&(f=new W2({root:!1,dir:!0,parent:s,parentKey:c,path:o,dirty:!0,flat:!0,mtime:f&&f.unixfs&&f.unixfs.mtime,mode:f&&f.unixfs&&f.unixfs.mode},t)),await s.put(c,f),s=f}}return e}async function*e$(r,e){if(!(r instanceof Rl)){r&&r.unixfs&&r.unixfs.isDirectory()&&(yield r);return}yield*r.flush(e)}async function*RIe(r,e,t){let i=new W2({root:!0,dir:!0,path:"",dirty:!0,flat:!0},t);for await(let n of r)!n||(i=await AIe(n,i,t),(!n.unixfs||!n.unixfs.isDirectory())&&(yield n));if(t.wrapWithDirectory)yield*e$(i,e);else for await(let n of i.eachChildSeries())!n||(yield*e$(n.child,e))}var t$=RIe;async function*o0(r,e,t={}){let i=zz(t),n;typeof t.dagBuilder=="function"?n=t.dagBuilder:n=NH;let s;typeof t.treeBuilder=="function"?s=t.treeBuilder:s=t$;let o;Symbol.asyncIterator in r||Symbol.iterator in r?o=r:o=[r];for await(let a of s((0,r$.default)(n(o,e,i),i.fileImportConcurrency),e,i))yield{cid:a.cid,path:a.path,unixfs:a.unixfs,size:a.size}}l();l();var X2=A(Vf()),i$=A(n0()),n$=A(s0()),jS=A(wn());async function*s6(r,e){if(typeof r=="string"||r instanceof String||so(r)||su(r)||r._readableState)throw(0,X2.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(ou(r)&&(r=(0,i$.default)(r)),Symbol.iterator in r||Symbol.asyncIterator in r){let t=(0,n$.default)(r),{value:i,done:n}=await t.peek();if(n){yield*[];return}if(t.push(i),Number.isInteger(i))throw(0,X2.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(i._readableState){yield*(0,jS.default)(t,s=>qS({content:s},e));return}if(so(i)){yield qS({content:t},e);return}if(K2(i)||i[Symbol.iterator]||i[Symbol.asyncIterator]||ou(i)||su(i)){yield*(0,jS.default)(t,s=>qS(s,e));return}}throw K2(r)?(0,X2.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):(0,X2.default)(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}async function qS(r,e){let{path:t,mode:i,mtime:n,content:s}=r,o={path:t||"",mode:Uc(i),mtime:$u(n)};return s?o.content=await e(s):t||(o.content=await e(r)),o}function s$(r){return s6(r,$b)}l();var o$=r=>{if(r)if(r.startsWith("size-")){let e=r.split("-")[1],t=parseInt(e);if(isNaN(t))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:t}}else{if(r.startsWith("rabin"))return{chunker:"rabin",...xIe(r)};throw new Error(`Unrecognized chunker option: ${r}`)}else return{chunker:"fixed"}},xIe=r=>{let e={},t=r.split("-");switch(t.length){case 1:e.avgChunkSize=262144;break;case 2:e.avgChunkSize=o6(t[1],"avg");break;case 4:e.minChunkSize=o6(t[1],"min"),e.avgChunkSize=o6(t[2],"avg"),e.maxChunkSize=o6(t[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return e},o6=(r,e)=>{let t=parseInt(r);if(isNaN(t))throw new Error(`Chunker parameter ${e} must be an integer`);return t};var a$=A(dr());var IIe=Ct.bind({ignoreUndefined:!0});function c$({repo:r,preload:e,hashers:t,options:i}){let n=i&&i.sharding;async function*s(o,a={}){let c=IIe({shardSplitThreshold:n?1e3:1/0,strategy:"balanced"},a,{...o$(a.chunker)});c.hashAlg&&c.hashAlg!=="sha2-256"&&c.cidVersion!==1&&(c.cidVersion=1),c.trickle&&(c.strategy="trickle"),c.strategy==="trickle"&&(c.leafType="raw",c.reduceSingleLeafToSelf=!1),c.cidVersion>0&&c.rawLeaves===void 0&&(c.rawLeaves=!0),c.hashAlg!==void 0&&c.rawLeaves===void 0&&(c.rawLeaves=!0),delete c.trickle;let u={};if(c.progress){let p=c.progress;c.progress=(y,g)=>{u[g]||(u[g]=0),u[g]+=y,p(u[g],g)}}let f;c.hashAlg!=null&&(f=await t.getHasher(c.hashAlg));let d=(0,a$.pipe)(s$(o),p=>o0(p,r.blocks,{...c,hasher:f,pin:!1}),TIe(c),PIe(e,c),CIe(r,c)),h=await r.gcLock.readLock();try{for await(let p of d)delete u[p.path],yield p}finally{h()}}return Q(s)}function TIe(r){async function*e(t){for await(let i of t){let n=i.cid;r.cidVersion===1&&(n=n.toV1());let s=i.path?i.path:n.toString();r.wrapWithDirectory&&!i.path&&(s=""),yield{path:s,cid:n,size:i.size,mode:i.unixfs&&i.unixfs.mode,mtime:i.unixfs&&i.unixfs.mtime}}}return e}function PIe(r,e){async function*t(i){for await(let n of i)(!n.path||e.wrapWithDirectory?n.path==="":!n.path.includes("/"))&&!e.onlyHash&&e.preload!==!1&&r(n.cid),yield n}return t}function CIe(r,e){async function*t(i){for await(let n of i){let s=!(n.path&&n.path.includes("/"));(e.pin==null?!0:e.pin)&&s&&!e.onlyHash&&await r.pins.pinRecursively(n.cid),yield n}}return t}l();l();var d6=A(au());we();l();var x$=A(au());l();Ju();we();var kIe=42;function DIe(r){if(r[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return L.decode(r.subarray(1))}var f$={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};f$.tags[kIe]=DIe;var a6=113;var c6=r=>vi(r,f$);Vs();Hc();l();var f6=A(au());l();var u6=A(Y2());var NIe=async function(r){return(await gd.encode(r)).slice(0,8).reverse()},BIe=(r,e,t)=>Promise.all(r.map(i=>{if(i.Name==null)throw new Error("Unexpected Link without a Name");if(i.Name.length===2){let n=parseInt(i.Name,16);return e._putObjectAt(n,new u6.Bucket({hash:t._options.hash,bits:t._options.bits},e,n))}return t.put(i.Name.substring(2),!0)})),d$=r=>r.toString(16).toUpperCase().padStart(2,"0").substring(0,2),LIe=r=>{let e=r.bucket,t=[];for(;e._parent;)t.push(e),e=e._parent;return t.push(e),t.reverse()},h$=async(r,e,t,i,n)=>{if(!i){let f=(0,u6.createHAMT)({hashFn:NIe});i={rootBucket:f,hamtDepth:1,lastBucket:f}}await BIe(r.Links,i.lastBucket,i.rootBucket);let s=await i.rootBucket._findNewBucketAndPos(e),o=d$(s.pos),a=LIe(s);a.length>i.hamtDepth&&(i.lastBucket=a[i.hamtDepth],o=d$(i.lastBucket._posAtParent));let c=r.Links.find(f=>{if(f.Name==null)return!1;let d=f.Name.substring(0,2),h=f.Name.substring(2);return!(d!==o||h&&h!==e)});if(!c)return null;if(c.Name!=null&&c.Name.substring(2)===e)return c.Hash;i.hamtDepth++;let u=await t.get(c.Hash,n);return r=Nt(u),h$(r,e,t,i,n)},p$=h$;l();l();function MIe(r,e,t,i){let n=r.length,s=e+n;return t>=s||i<e?new Uint8Array(0):(i>=e&&i<s&&(r=r.slice(0,i-e)),t>=e&&t<s&&(r=r.slice(t-e)),r)}var md=MIe;l();var l6=A(au()),jIe=(r,e,t)=>{if(e||(e=0),e<0)throw(0,l6.default)(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(e>r)throw(0,l6.default)(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(!t&&t!==0&&(t=r-e),t<0)throw(0,l6.default)(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return e+t>r&&(t=r-e),{offset:e,length:t}},a0=jIe;var US=A(au());Vs();async function*y$(r,e,t,i,n=0,s){if(e instanceof Uint8Array){let c=md(e,n,t,i);return c.length&&(yield c),n+=c.length,n}if(e.Data==null)throw(0,US.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let o;try{o=dt.unmarshal(e.Data)}catch(c){throw(0,US.default)(c,"ERR_NOT_UNIXFS")}if(o.data&&o.data.length){let c=md(o.data,n,t,i);c.length&&(yield c),n+=o.data.length}let a=n;for(let c=0;c<e.Links.length;c++){let u=e.Links[c],f=n+o.blockSizes[c];if(t>=a&&t<f||i>a&&i<=f||t<a&&i>f){let d=await r.get(u.Hash,{signal:s.signal}),h;switch(u.Hash.code){case wt:h=await Nt(d);break;case Bi:h=d;break;case a6:h=await c6(d);break;default:throw Error(`Unsupported codec: ${u.Hash.code}`)}for await(let p of y$(r,h,t,i,n,s))n+=p.length,yield p}n=f,a=f+1}}var qIe=(r,e,t,i,n,s,o)=>{function a(c={}){let u=t.fileSize();if(u===void 0)throw new Error("File was a directory");let{offset:f,length:d}=a0(u,c.offset,c.length),h=f,p=f+d;return y$(o,e,h,p,0,c)}return a},FS=qIe;l();var UIe=(r,e,t,i,n,s,o)=>{async function*a(c={}){let u=c.offset||0,f=c.length||e.Links.length,d=e.Links.slice(u,f);for(let h of d){let p=await n(h.Hash,h.Name||"",`${i}/${h.Name||""}`,[],s+1,o,c);p.entry&&(yield p.entry)}}return a},g$=UIe;l();var FIe=(r,e,t,i,n,s,o)=>{function a(c={}){return m$(e,i,n,s,o,c)}return a};async function*m$(r,e,t,i,n,s){let o=r.Links;for(let a of o){let c=a.Name!=null?a.Name.substring(2):null;if(c)yield(await t(a.Hash,c,`${e}/${c}`,[],i+1,n,s)).entry;else{let u=await n.get(a.Hash);r=Nt(u);for await(let f of m$(r,e,t,i,n,s))yield f}}}var b$=FIe;var KIe=(r,e)=>{let t=r.Links.find(i=>i.Name===e);return t&&t.Hash},VIe={raw:FS,file:FS,directory:g$,"hamt-sharded-directory":b$,metadata:(r,e,t,i,n,s,o)=>()=>[],symlink:(r,e,t,i,n,s,o)=>()=>[]},zIe=async(r,e,t,i,n,s,o,a)=>{let c=await o.get(r,a),u=Nt(c),f,d;if(e||(e=r.toString()),u.Data==null)throw(0,f6.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{f=dt.unmarshal(u.Data)}catch(h){throw(0,f6.default)(h,"ERR_NOT_UNIXFS")}if(t||(t=e),i.length){let h;if(f&&f.type==="hamt-sharded-directory"?h=await p$(u,i[0],o):h=KIe(u,i[0]),!h)throw(0,f6.default)(new Error("file does not exist"),"ERR_NOT_FOUND");let p=i.shift(),y=`${t}/${p}`;d={cid:h,toResolve:i,name:p||"",path:y}}return{entry:{type:f.isDirectory()?"directory":"file",name:e,path:t,cid:r,content:VIe[f.type](r,u,f,t,n,s,o),unixfs:f,depth:s,node:u,size:f.fileSize()},next:d}},w$=zIe;l();var _$=A(au());var HIe=r=>{async function*e(t={}){let{offset:i,length:n}=a0(r.length,t.offset,t.length);yield md(r,0,i,i+n)}return e},$Ie=async(r,e,t,i,n,s,o,a)=>{if(i.length)throw(0,_$.default)(new Error(`No link named ${t} found in raw node ${r}`),"ERR_NOT_FOUND");let c=await o.get(r,a);return{entry:{type:"raw",name:e,path:t,cid:r,content:HIe(c),depth:s,size:c.length,node:c}}},v$=$Ie;l();we();var E$=A(au());var GIe=async(r,e,t,i,n,s,o,a)=>{let c=await o.get(r),u=c6(c),f=u,d=t;for(;i.length;){let h=i[0];if(h in f){i.shift(),d=`${d}/${h}`;let p=L.asCID(f[h]);if(p)return{entry:{type:"object",name:e,path:t,cid:r,node:c,depth:s,size:c.length,content:async function*(){yield u}},next:{cid:p,name:h,path:d,toResolve:i}};f=f[h]}else throw(0,E$.default)(new Error(`No property named ${h} found in cbor node ${r}`),"ERR_NO_PROP")}return{entry:{type:"object",name:e,path:t,cid:r,node:c,depth:s,size:c.length,content:async function*(){yield u}}}},S$=GIe;l();var A$=A(au());tn();var WIe=r=>{async function*e(t={}){let{offset:i,length:n}=a0(r.length,t.offset,t.length);yield md(r,0,i,i+n)}return e},YIe=async(r,e,t,i,n,s,o,a)=>{if(i.length)throw(0,A$.default)(new Error(`No link named ${t} found in raw node ${r}`),"ERR_NOT_FOUND");let c=await fi(r.multihash.bytes);return{entry:{type:"identity",name:e,path:t,cid:r,content:WIe(c.digest),depth:s,size:c.digest.length,node:c.digest}}},R$=YIe;var XIe={[wt]:w$,[Bi]:v$,[a6]:S$,[bs.code]:R$};function I$(r,e,t,i,n,s,o){let a=XIe[r.code];if(!a)throw(0,x$.default)(new Error(`No resolver for code ${r.code}`),"ERR_NO_RESOLVER");return a(r,e,t,i,I$,n,s,o)}var T$=I$;var P$=A(Zn()),QIe=(r="")=>(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),ZIe=r=>{if(r instanceof Uint8Array)return{cid:L.decode(r),toResolve:[]};let e=L.asCID(r);if(e)return{cid:e,toResolve:[]};if(typeof r=="string"){r.indexOf("/ipfs/")===0&&(r=r.substring(6));let t=QIe(r);return{cid:L.parse(t[0]),toResolve:t.slice(1)}}throw(0,d6.default)(new Error(`Unknown path type ${r}`),"ERR_BAD_PATH")};async function*KS(r,e,t={}){let{cid:i,toResolve:n}=ZIe(r),s=i.toString(),o=s,a=n.length;for(;;){let c=await T$(i,s,o,n,a,e,t);if(!c.entry&&!c.next)throw(0,d6.default)(new Error(`Could not resolve ${r}`),"ERR_NOT_FOUND");if(c.entry&&(yield c.entry),!c.next)return;n=c.next.toResolve,i=c.next.cid,s=c.next.name,o=c.next.path}}async function an(r,e,t={}){let i=await(0,P$.default)(KS(r,e,t));if(!i)throw(0,d6.default)(new Error(`Could not resolve ${r}`),"ERR_NOT_FOUND");return i}async function*h6(r,e,t={}){let i=await an(r,e,t);if(!i)return;if(yield i,i.type==="directory")for await(let s of n(i,t))yield s;async function*n(s,o){for await(let a of s.content(o))yield a,!(a instanceof Uint8Array)&&a.type==="directory"&&(yield*n(a,o))}}we();function C$({repo:r,preload:e}){async function*t(i,n={}){if(i=Rp(i),n.preload!==!1){let o=i.split("/");e(L.parse(o[0]))}let s=await an(i,r.blocks,n);if(s.type==="directory")throw new Error("this dag node is a directory");if(!s.content)throw new Error("this dag node has no content");yield*s.content(n)}return Q(t)}l();var _0=A(St());we();var DA=A(G$()),NA=A(dr()),BA=A(NW()),LA=A(wn()),MA=A(LW()),MW=6;function jW({repo:r,preload:e}){async function*t(i,n={}){if(n.compressionLevel!=null&&(n.compressionLevel<-1||n.compressionLevel>9))throw(0,_0.default)(new Error("Compression level must be between -1 and 9"),"ERR_INVALID_PARAMS");if(n.preload!==!1){let a;try{a=Rp(i).split("/")}catch(c){throw(0,_0.default)(c,"ERR_INVALID_PATH")}e(L.parse(a[0]))}let s=L.asCID(i)||i,o=await an(s,r.blocks,n);if(o.type==="file"||o.type==="raw"){let a=[];!n.compress||n.archive===!0?a.push([{header:{name:o.path,mode:o.type==="file"&&o.unixfs.mode,mtime:o.type==="file"&&o.unixfs.mtime?new Date(o.unixfs.mtime.secs*1e3):void 0,size:o.size,type:"file"},body:o.content()}],(0,DA.pack)(),c=>(0,LA.default)(c,u=>u.slice())):a.push(o.content),n.compress&&a.push(async function*(c){let u=await(0,MA.default)(c);yield BA.default.gzip(u,{level:n.compressionLevel||MW})}),yield*(0,NA.pipe)(...a);return}if(o.type==="directory"){let a=[h6(s,r.blocks,n),async function*(c){for await(let u of c){let f={header:{name:u.path,size:u.size}};if(u.type==="file")f.header.type="file",f.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,f.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0,f.body=u.content();else if(u.type==="raw")f.header.type="file",f.body=u.content();else if(u.type==="directory")f.header.type="directory",f.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,f.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0;else throw(0,_0.default)(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");yield f}},(0,DA.pack)(),c=>(0,LA.default)(c,u=>u.slice())];if(n.compress){if(!n.archive)throw(0,_0.default)(new Error("file is not regular"),"ERR_INVALID_PATH");n.compress&&a.push(async function*(c){let u=await(0,MA.default)(c);yield BA.default.gzip(u,{level:n.compressionLevel||MW})})}yield*(0,NA.pipe)(...a);return}throw(0,_0.default)(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS")}return Q(t)}l();var qW=A(St());we();function UW({repo:r,preload:e}){async function*t(i,n={}){let s=Rp(i),o=s.split("/");n.preload!==!1&&e(L.parse(o[0]));let a=L.asCID(s)||s,c=await an(a,r.blocks,n);if(c.type==="file"){yield eE(c);return}if(c.type==="directory"){for await(let u of c.content())yield eE(u);return}throw(0,qW.default)(new Error(`Unknown UnixFS type ${c.type}`),"ERR_UNKNOWN_UNIXFS_TYPE")}return Q(t)}var jA=class{constructor({preload:e,repo:t,hashers:i,options:n}){let s=c$({preload:e,repo:t,options:n,hashers:i});this.addAll=s,this.add=jz({addAll:s}),this.cat=C$({repo:t,preload:e}),this.get=jW({repo:t,preload:e}),this.ls=UW({repo:t,preload:e})}};l();l();var Id="0.14.1",FW="",KW="^0.154.1";function VW({repo:r}){async function e(t={}){let i=await r.version.get();return{version:Id,commit:FW,repo:`${i}`,"ipfs-core":Id,"interface-ipfs-core":KW}}return Q(e)}l();var zW=A(lt());et();var HW=A(st());var $W=A(St()),qA=A(le()),TCe=Object.assign((0,qA.default)("ipfs:components:id"),{error:(0,qA.default)("ipfs:components:id:error")});function GW({peerId:r,network:e}){async function t(i={}){let n=e.try();if(!n){if(i.peerId)throw new rl;return{id:r.toB58String(),publicKey:$e(r.pubKey.bytes,"base64pad"),addresses:[],agentVersion:`js-ipfs/${Id}`,protocolVersion:"9000",protocols:[]}}let{libp2p:s}=n,o=i.peerId?HW.default.parse(i.peerId):r,a=await PCe(o,s,i),c=$e(a.metadata.get("AgentVersion")||new Uint8Array),u=$e(a.metadata.get("ProtocolVersion")||new Uint8Array),f=a.id.toB58String(),d=a.publicKey?$e(a.publicKey.bytes,"base64pad"):"";return{id:f,publicKey:d,addresses:(a.addresses||[]).map(h=>{let p=h.toString();return p.endsWith(`/p2p/${f}`)?p:`${p}/p2p/${f}`}).sort().map(h=>new zW.Multiaddr(h)),agentVersion:c,protocolVersion:u,protocols:(a.protocols||[]).sort()}}return Q(t)}async function PCe(r,e,t){let i=await e.peerStore.get(r);i||(i=await CCe(r,e,t));let n=r.pubKey?r.pubKey:await e.peerStore.keyBook.get(r);if(!n)try{n=await e._dht.getPublicKey(r,t)}catch(s){TCe.error("Could not load public key for",r.toB58String(),s)}return{...i,publicKey:n,metadata:i.metadata||new Map,addresses:i.addresses.map(s=>s.multiaddr)}}async function CCe(r,e,t){for await(let n of e._dht.findPeer(r,t))if(n.name==="FINAL_PEER")break;let i=await e.peerStore.get(r);if(!i)throw(0,$W.default)(new Error("Could not find peer"),"ERR_NOT_FOUND");return i}l();var XW=A(le());l();var Zr=A(UA());var v0={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:r=>((0,Zr.default)(r,"Discovery.MDNS.Enabled",!1),(0,Zr.default)(r,"Discovery.webRTCStar.Enabled",!1),r.Swarm={...r.Swarm||{},DisableNatPortMap:!0},r)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:r=>((0,Zr.default)(r,"Discovery.MDNS.Enabled",!0),(0,Zr.default)(r,"Discovery.webRTCStar.Enabled",!0),(0,Zr.default)(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!1}),r)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:r=>{let e=nu();return(0,Zr.default)(r,"Addresses.API",e.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),(0,Zr.default)(r,"Addresses.Gateway",e.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),(0,Zr.default)(r,"Addresses.Swarm",e.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),(0,Zr.default)(r,"Addresses.Delegates",[]),(0,Zr.default)(r,"Bootstrap",[]),(0,Zr.default)(r,"Discovery.MDNS.Enabled",!1),(0,Zr.default)(r,"Discovery.webRTCStar.Enabled",!1),(0,Zr.default)(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!0}),r}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:r=>{let e=nu();return(0,Zr.default)(r,"Addresses.API",e.Addresses.API),(0,Zr.default)(r,"Addresses.Gateway",e.Addresses.Gateway),(0,Zr.default)(r,"Addresses.Swarm",e.Addresses.Swarm),(0,Zr.default)(r,"Addresses.Delegates",e.Addresses.Delegates),(0,Zr.default)(r,"Bootstrap",e.Bootstrap),(0,Zr.default)(r,"Discovery.MDNS.Enabled",e.Discovery.MDNS.Enabled),(0,Zr.default)(r,"Discovery.webRTCStar.Enabled",e.Discovery.webRTCStar.Enabled),(0,Zr.default)(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!1}),r}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:r=>{let e=r.Swarm||{},t=e.ConnMgr||{};return t.LowWater=20,t.HighWater=40,e.ConnMgr=t,r.Swarm=e,r}},"default-power":{description:'Inverse of "lowpower" profile.',transform:r=>{let e=nu();return r.Swarm=e.Swarm,r}}};var kCe=(0,XW.default)("ipfs:core:config");function QW({repo:r}){return{getAll:Q(e),get:Q(t),set:Q(i),replace:Q(n),profiles:{apply:Q(s),list:Q(DCe)}};async function e(o={}){return r.config.getAll(o)}async function t(o,a){return o?r.config.get(o,a):Promise.reject(new Error("key argument is required"))}async function i(o,a,c){return r.config.set(o,a,c)}async function n(o,a){return r.config.replace(o,a)}async function s(o,a={dryRun:!1}){let{dryRun:c}=a,u=v0[o];if(!u)throw new Error(`No profile with name '${o}' exists`);try{let f=await r.config.getAll(a),d=JSON.parse(JSON.stringify(f));return d=u.transform(d),c||await r.config.replace(d,a),delete f.Identity.PrivKey,delete d.Identity.PrivKey,{original:f,updated:d}}catch(f){throw kCe(f),new Error(`Could not apply profile '${o}' to config: ${f.message}`)}}}async function DCe(r){return Object.keys(v0).map(e=>({name:e,description:v0[e].description}))}l();l();we();l();up();var N6=({enumerable:r=!0,configurable:e=!1}={})=>({enumerable:r,configurable:e,writable:!1}),FA=function*(r,e){if(r!=null&&!(r instanceof Uint8Array))for(let[t,i]of Object.entries(r)){let n=[...e,t];if(i!=null&&typeof i=="object")if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s],c=L.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*FA(o,a))}else{let s=L.asCID(i);s?yield[n.join("/"),s]:yield*FA(i,n)}}},KA=function*(r,e){if(r!=null)for(let[t,i]of Object.entries(r)){let n=[...e,t];if(yield n.join("/"),i!=null&&!(i instanceof Uint8Array)&&typeof i=="object"&&!L.asCID(i))if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s];yield a.join("/"),typeof o=="object"&&!L.asCID(o)&&(yield*KA(o,a))}else yield*KA(i,n)}},NCe=(r,e)=>{let t=r;for(let[i,n]of e.entries()){if(t=t[n],t==null)throw new Error(`Object has no property at ${e.slice(0,i+1).map(o=>`[${JSON.stringify(o)}]`).join("")}`);let s=L.asCID(t);if(s)return{value:s,remaining:e.slice(i+1).join("/")}}return{value:t}},ZW=class{constructor({cid:e,bytes:t,value:i}){if(!e||!t||typeof i=="undefined")throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=i,this.asBlock=this,Object.defineProperties(this,{cid:N6(),bytes:N6(),value:N6(),asBlock:N6()})}links(){return FA(this.value,[])}tree(){return KA(this.value,[])}get(e="/"){return NCe(this.value,e.split("/").filter(Boolean))}};var E0=({bytes:r,cid:e,value:t,codec:i})=>{let n=t!==void 0?t:i&&i.decode(r);if(n===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new ZW({cid:e,bytes:r,value:n})};l();we();l();var VA=A(Xn());function zA(r){let e=i7({version:1,roots:r}),t=VA.default.encode(e.length),i=new Uint8Array(t.length+e.length);return i.set(t,0),i.set(e,t.length),i}function JW(r){return{async setRoots(e){let t=zA(e);await r.write(t)},async writeBlock(e){let{cid:t,bytes:i}=e;await r.write(new Uint8Array(VA.default.encode(t.bytes.length+i.length))),await r.write(t.bytes),i.length&&await r.write(i)},async close(){return r.end()}}}l();function B6(){}function eY(){let r=[],e=null,t=B6,i=!1,n=null,s=B6,o=()=>(e||(e=new Promise(u=>{t=()=>{e=null,t=B6,u()}})),e),a={write(u){r.push(u);let f=o();return s(),f},async end(){i=!0;let u=o();return s(),u}},c={async next(){let u=r.shift();return u?(r.length===0&&t(),{done:!1,value:u}):i?(t(),{done:!0,value:void 0}):(n||(n=new Promise(f=>{s=()=>(n=null,s=B6,f(c.next()))})),n)}};return{writer:a,iterator:c}}l();var Nl=A(Xn());we();tn();var HA={SHA2_256:18,LENGTH:32,DAG_PB:112};async function L6(r){let e=await r.upTo(8),t=Nl.default.decode(e);return r.seek(Nl.default.decode.bytes),t}async function $A(r){let e=await L6(r);if(e===0)throw new Error("Invalid CAR header (zero length)");let t=await r.exactly(e);r.seek(e);let i=n7(t);if(i==null||Array.isArray(i)||typeof i!="object")throw new Error("Invalid CAR header format");if(i.version!==1)throw typeof i.version=="string"?new Error(`Invalid CAR version: "${i.version}"`):new Error(`Invalid CAR version: ${i.version}`);if(!Array.isArray(i.roots))throw new Error("Invalid CAR header format");if(Object.keys(i).filter(n=>n!=="roots"&&n!=="version").length)throw new Error("Invalid CAR header format");return i}async function BCe(r){let e=await r.upTo(8);Nl.default.decode(e);let t=Nl.default.decode.bytes,i=Nl.default.decode(e.subarray(Nl.default.decode.bytes)),n=Nl.default.decode.bytes,s=t+n+i,o=await r.exactly(s);return r.seek(s),o}async function LCe(r){let e=await r.exactly(2);if(e[0]===HA.SHA2_256&&e[1]===HA.LENGTH){let o=await r.exactly(34);r.seek(34);let a=fi(o);return L.create(0,HA.DAG_PB,a)}let t=await L6(r);if(t!==1)throw new Error(`Unexpected CID version (${t})`);let i=await L6(r),n=await BCe(r),s=fi(n);return L.create(t,i,s)}async function tY(r){let e=r.pos,t=await L6(r);if(t===0)throw new Error("Invalid CAR section (zero length)");t+=r.pos-e;let i=await LCe(r),n=t-(r.pos-e);return{cid:i,length:t,blockLength:n}}async function MCe(r){let{cid:e,blockLength:t}=await tY(r),i=await r.exactly(t);return r.seek(t),{bytes:i,cid:e}}async function jCe(r){let e=r.pos,{cid:t,length:i,blockLength:n}=await tY(r),s={cid:t,length:i,blockLength:n,offset:e,blockOffset:r.pos};return r.seek(s.blockLength),s}function rY(r){let e=$A(r);return{header:()=>e,async*blocks(){for(await e;(await r.upTo(8)).length>0;)yield await MCe(r)},async*blocksIndex(){for(await e;(await r.upTo(8)).length>0;)yield await jCe(r)}}}function M6(r){let e=0;return{async upTo(t){return r.subarray(e,e+Math.min(t,r.length-e))},async exactly(t){if(t>r.length-e)throw new Error("Unexpected end of data");return r.subarray(e,e+t)},seek(t){e+=t},get pos(){return e}}}function qCe(r){let e=0,t=0,i=0,n=new Uint8Array(0),s=async o=>{t=n.length-i;let a=[n.subarray(i)];for(;t<o;){let u=await r();if(u==null)break;t<0?u.length>t&&a.push(u.subarray(-t)):a.push(u),t+=u.length}n=new Uint8Array(a.reduce((u,f)=>u+f.length,0));let c=0;for(let u of a)n.set(u,c),c+=u.length;i=0};return{async upTo(o){return n.length-i<o&&await s(o),n.subarray(i,i+Math.min(n.length-i,o))},async exactly(o){if(n.length-i<o&&await s(o),n.length-i<o)throw new Error("Unexpected end of data");return n.subarray(i,i+o)},seek(o){e+=o,i+=o},get pos(){return e}}}function iY(r){let e=r[Symbol.asyncIterator]();async function t(){let i=await e.next();return i.done?null:i.value}return qCe(t)}var S0=class{constructor(e,t){this._encoder=t,this._mutex=t.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array)||!e.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");let t=L.asCID(e.cid);if(!t)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:t,bytes:e.bytes})),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=UCe(e);let{encoder:t,iterator:i}=nY(),n=new S0(e,t),s=new GA(i);return{writer:n,out:s}}static createAppender(){let{encoder:e,iterator:t}=nY();e.setRoots=()=>Promise.resolve();let i=new S0([],e),n=new GA(t);return{writer:i,out:n}}static async updateRootsInBytes(e,t){let i=M6(e);await $A(i);let n=zA(t);if(i.pos!==n.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${i.pos} bytes, new header is ${n.length} bytes)`);return e.set(n,0),e}},GA=class{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}};function nY(){let r=eY(),{writer:e,iterator:t}=r;return{encoder:JW(e),iterator:t}}function UCe(r){if(r===void 0)return[];if(!Array.isArray(r)){let t=L.asCID(r);if(!t)throw new TypeError("roots must be a single CID or an array of CIDs");return[t]}let e=[];for(let t of r){let i=L.asCID(t);if(!i)throw new TypeError("roots must be a single CID or an array of CIDs");e.push(i)}return e}var sY=A(le());Vs();S7();l();di();var WA=async({cid:r,load:e,seen:t})=>{t=t||new Set;let i=r.toString(yt);if(t.has(i))return;let n=await e(r);if(t.add(i),n!==null)for(let[,s]of n.links())await WA({cid:s,load:e,seen:t})};var oY=(0,sY.default)("ipfs:components:dag:import"),FCe=[Bi,v7];function aY({repo:r,preload:e,codecs:t}){async function*i(n,s={}){s.preload!==!1&&e(n);let o=L.asCID(n);if(!o)throw new Error(`Unexpected error converting CID type: ${n}`);oY(`Exporting ${o} as car`);let{writer:a,out:c}=await S0.create([o]),u=null;(async()=>{try{let f=KCe(r,a,{signal:s.signal,timeout:s.timeout},t);await WA({cid:o,load:f})}catch(f){u=f}finally{a.close()}})();for await(let f of c){if(u)break;yield f}if(u)throw u}return Q(i)}function KCe(r,e,t,i){return async n=>{let s=await i.getCodec(n.code);if(!s)throw new Error(`Can't decode links in block with codec 0x${n.code.toString(16)} to form complete DAG`);let o=await r.blocks.get(n,t);return oY(`Adding block ${n} to car`),await e.put({cid:n,bytes:o}),FCe.includes(n.code)?null:E0({bytes:o,cid:n,codec:s})}}l();var uY=A(Td()),lY=A(Zn());var fY=A(St());function dY({codecs:r,repo:e,preload:t}){return Q(async function(s,o={}){if(o.preload!==!1&&t(s),o.path){let d=o.localResolve?await(0,uY.default)(cl(s,o.path,r,e,o)):await(0,lY.default)(cl(s,o.path,r,e,o));if(!d)throw(0,fY.default)(new Error("Not found"),"ERR_NOT_FOUND");return d}let a=await r.getCodec(s.code),c=await e.blocks.get(s,o);return{value:a.decode(c),remainderPath:""}})}l();l();var YA=class{constructor(e,t,i){this._version=e,this._roots=t,this._iterable=i,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}},A0=class extends YA{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){let{version:t,roots:i,iterator:n}=await hY(e);return new A0(t,i,n)}static async fromIterable(e){let{version:t,roots:i,iterator:n}=await pY(e);return new A0(t,i,n)}},j6=class extends YA{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");this._decoded=!0;let e=this._iterable[Symbol.asyncIterator]();return{async next(){let t=await e.next();return t.done?t:{done:!1,value:t.value.cid}}}}static async fromBytes(e){let{version:t,roots:i,iterator:n}=await hY(e);return new j6(t,i,n)}static async fromIterable(e){let{version:t,roots:i,iterator:n}=await pY(e);return new j6(t,i,n)}};async function hY(r){if(!(r instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return yY(M6(r))}async function pY(r){if(!r||typeof r[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return yY(iY(r))}async function yY(r){let e=rY(r),{version:t,roots:i}=await e.header();return{version:t,roots:i,iterator:e.blocks()}}var gY=A(s0()),mY=A(rs()),bY=A(wn()),wY=A(le()),_Y=(0,wY.default)("ipfs:components:dag:import");function vY({repo:r}){async function*e(t,i={}){let n=await r.gcLock.readLock();try{let s={signal:i.signal,timeout:i.timeout},o=(0,gY.default)(t),{value:a,done:c}=await o.peek();if(c)return;a&&o.push(a);let u;a instanceof Uint8Array?u=[o]:u=o;for await(let f of u){let d=await zCe(r,s,f);if(i.pinRoots!==!1)for(let h of d){let p="";try{await r.blocks.has(h)?(_Y(`Pinning root ${h}`),await r.pins.pinRecursively(h)):p="blockstore: block not found"}catch(y){p=y.message}yield{root:{cid:h,pinErrorMsg:p}}}}}finally{n()}}return Q(e)}async function zCe(r,e,t){let i=await A0.fromIterable(t),n=await i.getRoots();return await(0,mY.default)(r.blocks.putMany((0,bY.default)(i,({cid:s,bytes:o})=>(_Y(`Import block ${s}`),{key:s,value:o})),{signal:e.signal})),n}l();we();function EY({repo:r,codecs:e,hashers:t,preload:i}){async function n(s,o={}){let a=o.pin?await r.gcLock.readLock():null;try{let c=await e.getCodec(o.storeCodec||"dag-cbor");if(!c)throw new Error(`Unknown storeCodec ${o.storeCodec}, please configure additional BlockCodecs for this IPFS instance`);if(o.inputCodec){if(!(s instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");let y=await e.getCodec(o.inputCodec);if(!y)throw new Error(`Unknown inputCodec ${o.inputCodec}, please configure additional BlockCodecs for this IPFS instance`);s=y.decode(s)}let u=o.version!=null?o.version:1,f=await t.getHasher(o.hashAlg||"sha2-256");if(!f)throw new Error(`Unknown hash algorithm ${o.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);let d=c.encode(s),h=await f.digest(d),p=L.create(u,c.code,h);return await r.blocks.put(p,d,{signal:o.signal}),o.pin&&await r.pins.pinRecursively(p),o.preload!==!1&&i(p),p}finally{a&&a()}}return Q(n)}l();function SY({repo:r,codecs:e,preload:t}){async function i(n,s={}){let{cid:o}=Gc(n);return s.preload!==!1&&t(o),al(r,e,n,s)}return Q(i)}var XA=class{constructor({repo:e,codecs:t,hashers:i,preload:n}){this.export=aY({repo:e,preload:n,codecs:t}),this.get=dY({codecs:t,repo:e,preload:n}),this.import=vY({repo:e}),this.resolve=SY({repo:e,codecs:t,preload:n}),this.put=EY({repo:e,codecs:t,hashers:i,preload:n})}};l();var PY=A(U6()),ZA=A(le()),CY=A(xY());l();var IY=A(Tp()),QA=A(le()),F6=A(Go()),WCe=Object.assign((0,QA.default)("ipfs:preload"),{error:(0,QA.default)("ipfs:preload:error")}),YCe=F6.default.default?F6.default.default:F6.default,XCe=new YCe({concurrency:4});function TY(r,e={}){return WCe(r),XCe.add(async()=>{let i=(await IY.default.post(r,{signal:e.signal})).body.getReader();try{for(;;){let{done:n}=await i.read();if(n)return}}finally{i.releaseLock()}})}var OY=A(xp()),yg=Object.assign((0,ZA.default)("ipfs:preload"),{error:(0,ZA.default)("ipfs:preload:error")});function kY(r={}){if(r.enabled=Boolean(r.enabled),r.addresses=r.addresses||[],r.cache=r.cache||1e3,!r.enabled||!r.addresses.length)return yg("preload disabled"),Object.assign(()=>{},{start:()=>{},stop:()=>{}});let e=!0,t=[],i=r.addresses.map(PY.default),n=(0,OY.default)(r.cache),s=async o=>{try{if(e)throw new Error(`preload ${o} but preloader is not started`);let a=o.toString();if(n.has(a))return;n.set(a,!0);let c=(0,CY.default)(i),u=!1,f=Date.now();for(let d of c){if(e)throw new Error(`preload aborted for ${a}`);let h;try{h=new AbortController,t=t.concat(h),await TY(`${d}/api/v0/refs?r=true&arg=${encodeURIComponent(a)}`,{signal:h.signal}),u=!0}catch(p){p.type!=="aborted"&&yg.error(p)}finally{t=t.filter(p=>p!==h)}if(u)break}yg(`${u?"":"un"}successfully preloaded ${a} in ${Date.now()-f}ms`)}catch(a){yg.error(a)}};return s.start=()=>{e=!1},s.stop=()=>{e=!0,yg(`aborting ${t.length} pending preload request(s)`),t.forEach(o=>o.abort()),t=[]},s}l();var JA=A(le()),K6=Object.assign((0,JA.default)("ipfs:mfs-preload"),{error:(0,JA.default)("ipfs:mfs-preload:error")});function DY({preload:r,files:e,options:t={}}){if(t.interval=t.interval||30*1e3,!t.enabled){K6("MFS preload disabled");let o=async()=>{};return{start:o,stop:o}}let i="",n,s=async()=>{try{let o=await e.stat("/"),a=o.cid.toString();i!==a&&(K6(`preloading updated MFS root ${i} -> ${o.cid}`),await r(o.cid),i=a)}catch(o){K6.error("failed to preload MFS root",o)}finally{n=setTimeout(s,t.interval)}};return{async start(){let o=await e.stat("/");i=o.cid.toString(),K6(`monitoring MFS root ${o.cid}`),n=setTimeout(s,t.interval)},stop(){clearTimeout(n)}}}l();l();var oX=A(z6()),H6;function mg(r=!1){if(H6)return H6;let e=(0,oX.default)({singleProcess:r});return H6={readLock:t=>async(...i)=>{let n=await e.readLock();try{return await t.apply(null,i)}finally{n()}},writeLock:t=>async(...i)=>{let n=await e.writeLock();try{return await t.apply(null,i)}finally{n()}}},H6}var hR=A(Sp());l();l();l();we();Si();var aX=A(le()),sR=A(St());var cX=(0,aX.default)("ipfs:mfs:utils:with-mfs-root");async function x0(r,e){if(e&&e.signal&&e.signal.aborted)throw(0,sR.default)(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await r.repo.datastore.open();let t;try{let i=await r.repo.datastore.get(Wy);t=L.decode(i)}catch(i){if(i.code!=="ERR_NOT_FOUND")throw i;cX("Creating new MFS root");let n=ut({Data:new dt({type:"directory"}).marshal(),Links:[]}),s=await Lr.digest(n);if(t=L.createV0(s),await r.repo.blocks.put(t,n),e&&e.signal&&e.signal.aborted)throw(0,sR.default)(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await r.repo.datastore.put(Wy,t.bytes)}return cX(`Loaded MFS root /ipfs/${t}`),t}l();function I0(r=""){return(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean)}var oR=A(St());we();var aR="ipfs",Jr=async(r,e,t)=>{let i=await x0(r,t),n={entryType:"file"},s="";if(L.asCID(e)?s=`/ipfs/${e}`:s=e.toString(),s=s.trim(),s=s.replace(/(\/\/+)/g,"/"),s.endsWith("/")&&s.length>1&&(s=s.substring(0,s.length-1)),!s)throw(0,oR.default)(new Error("paths must not be empty"),"ERR_NO_PATH");if(s.substring(0,1)!=="/")throw(0,oR.default)(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");s.substring(s.length-1)==="/"&&(s=s.substring(0,s.length-1));let o=I0(s);if(o[0]===aR){let c;o.length===2?c=`/${o.join("/")}`:c=`/${o.slice(0,o.length-1).join("/")}`,n={type:"ipfs",depth:o.length-2,entryType:"file",mfsPath:`/${o.join("/")}`,mfsDirectory:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}else{let c=`/${aR}/${i}${o.length?"/"+o.join("/"):""}`,u=`/${aR}/${i}/${o.slice(0,o.length-1).join("/")}`;n={type:"mfs",depth:o.length,entryType:"file",mfsDirectory:u,mfsPath:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}let a=n.type==="mfs"?n.mfsPath:n.path;try{let c=await an(a,r.repo.blocks,t);n.cid=c.cid,n.mfsPath=`/ipfs/${c.path}`,n.entryType=c.type,n.content=c.content,(n.entryType==="file"||n.entryType==="directory")&&(c.type==="file"||c.type==="directory")&&(n.unixfs=c.unixfs)}catch(c){if(c.code!=="ERR_NOT_FOUND")throw c}return n.exists=Boolean(n.cid),n};var uX=A(le()),lX=A(St());var cOe=Ct.bind({ignoreUndefined:!0}),uOe=(0,uX.default)("ipfs:mfs:stat"),lOe={withLocal:!1};function Ml(r){async function e(t,i={}){i=cOe(lOe,i),uOe(`Fetching stats for ${t}`);let{type:n,cid:s,mfsPath:o}=await Jr(r,t,i),a=n==="ipfs"&&s?s:o,c;try{c=await an(a,r.repo.blocks)}catch(u){throw u.code==="ERR_NOT_FOUND"?(0,lX.default)(new Error(`${t} does not exist`),"ERR_NOT_FOUND"):u}if(!fX[c.type])throw new Error(`Cannot stat codec ${c.cid.code}`);return fX[c.type](c)}return Q(e)}var fX={raw:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:r=>{let e={cid:r.cid,type:"file",size:r.unixfs.fileSize(),cumulativeSize:ut(r.node).length+(r.node.Links||[]).reduce((t,i)=>t+(i.Tsize||0),0),blocks:r.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:r.unixfs.mode};return r.unixfs.mtime&&(e.mtime=r.unixfs.mtime),e},directory:r=>{let e={cid:r.cid,type:"directory",size:0,cumulativeSize:ut(r.node).length+(r.node.Links||[]).reduce((t,i)=>t+(i.Tsize||0),0),blocks:r.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:r.unixfs.mode};return r.unixfs.mtime&&(e.mtime=r.unixfs.mtime),e},object:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})};l();var NX=A(le()),k0=A(St());l();var dX=A(le()),fOe=(0,dX.default)("ipfs:mfs:utils:to-trail");async function ac(r,e){fOe(`Creating trail for path ${e}`);let t=[];for await(let i of KS(e,r.repo.blocks))t.push({name:i.name,cid:i.cid,size:i.size,type:i.type});return t}l();we();var wX=A(le());l();l();we();Si();var $6=async(r,e,t)=>{t.codec||(t.codec=Tn),t.hasher||(t.hasher=Lr),t.cidVersion===void 0&&(t.cidVersion=1),t.codec===Tn&&t.hasher!==Lr&&(t.cidVersion=1);let i=await t.hasher.digest(r),n=L.create(t.cidVersion,t.codec.code,i);return t.onlyHash||await e.put(n,r,{signal:t.signal}),n};var X6=A(Y2());l();var G6=gd.code,W6=8;async function Y6(r){return(await gd.encode(r)).slice(0,8).reverse()}var hX=class{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}},bg=class extends hX{constructor(e,t){super(e,t);this._bucket=(0,X6.createHAMT)({hashFn:Y6,bits:W6})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){yield*pX(this._bucket,e,this,this.options)}};async function*pX(r,e,t,i){let n=r._children,s=[],o=0;for(let p=0;p<n.length;p++){let y=n.get(p);if(!y)continue;let g=p.toString(16).toUpperCase().padStart(2,"0");if(y instanceof X6.Bucket){let w;for await(let b of await pX(y,e,null,i))w=b;if(!w)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:g,Tsize:w.size,Hash:w.cid}),o+=w.size}else if(typeof y.value.flush=="function"){let w=y.value,b;for await(let R of w.flush(e))b=R,yield b;let v=g+y.key;s.push({Name:v,Tsize:b.size,Hash:b.cid}),o+=b.size}else{let w=y.value;if(!w.cid)continue;let b=g+y.key,v=w.size;s.push({Name:b,Tsize:v,Hash:w.cid}),o+=v}}let a=Uint8Array.from(n.bitField().reverse()),u={Data:new dt({type:"hamt-sharded-directory",data:a,fanout:r.tableSize(),hashType:G6,mtime:t&&t.mtime,mode:t&&t.mode}).marshal(),Links:s},f=ut($i(u)),d=await $6(f,e,i),h=f.length+o;yield{cid:d,node:u,size:h}}l();var T0=A(Y2());var yX=A(le());var gX=A(Zn());we();var wg=(0,yX.default)("ipfs:mfs:core:utils:hamt-utils"),P0=async(r,e,t,i)=>{if(!i.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");let n=Uint8Array.from(t._children.bitField().reverse()),s=dt.unmarshal(i.parent.Data),o=new dt({type:"hamt-sharded-directory",data:n,fanout:t.tableSize(),hashType:G6,mode:s.mode,mtime:s.mtime}),a=await r.hashers.getHasher(i.hashAlg),c={Data:o.marshal(),Links:e.sort((h,p)=>(h.Name||"").localeCompare(p.Name||""))},u=ut(c),f=await a.digest(u),d=L.create(i.cidVersion,wt,f);return i.flush&&await r.repo.blocks.put(d,u),{node:c,cid:d,size:e.reduce((h,p)=>h+(p.Tsize||0),u.length)}},cR=async(r,e,t,i,n)=>{let s=new T0.Bucket({hash:t._options.hash,bits:t._options.bits},i,n);return i._putObjectAt(n,s),await _g(r,e,s,t),s},uR=async r=>{let e=(0,T0.createHAMT)({hashFn:Y6,bits:W6});return await Promise.all(r.map(async t=>{let i=t.Name||"";if(i.length===2){let n=parseInt(i,16),s=new T0.Bucket({hash:e._options.hash,bits:e._options.bits},e,n);return e._putObjectAt(n,s),Promise.resolve()}return e.put(i.substring(2),{size:t.Tsize,cid:t.Hash})})),e},_g=async(r,e,t,i)=>{await Promise.all(e.map(async n=>{let s=n.Name||"";if(s.length===2){wg("Populating sub bucket",s);let o=parseInt(s,16),a=await r.repo.blocks.get(n.Hash),c=Nt(a),u=new T0.Bucket({hash:i._options.hash,bits:i._options.bits},t,o);return t._putObjectAt(o,u),await _g(r,c.Links,u,i),Promise.resolve()}return i.put(s.substring(2),{size:n.Tsize,cid:n.Hash})}))},Cd=r=>r.toString(16).toUpperCase().padStart(2,"0").substring(0,2),mX=async(r,e,t)=>{let i=await uR(t.Links),n=await i._findNewBucketAndPos(e),s=[{bucket:n.bucket,prefix:Cd(n.pos)}],o=n.bucket;for(;o!==i;)s.push({bucket:o,prefix:Cd(o._posAtParent)}),o=o._parent;s.reverse(),s[0].node=t;for(let a=0;a<s.length;a++){let c=s[a];if(!c.node)throw new Error("Could not generate HAMT path");let u=c.node.Links.filter(p=>(p.Name||"").substring(0,2)===c.prefix).pop();if(!u){wg(`Link ${c.prefix}${e} will be added`);continue}if(u.Name===`${c.prefix}${e}`){wg(`Link ${c.prefix}${e} will be replaced`);continue}wg(`Found subshard ${c.prefix}`);let f=await r.repo.blocks.get(u.Hash),d=Nt(f);if(!s[a+1]){wg(`Loaded new subshard ${c.prefix}`),await cR(r,d.Links,i,c.bucket,parseInt(c.prefix,16));let p=await i._findNewBucketAndPos(e);s.push({bucket:p.bucket,prefix:Cd(p.pos),node:d});continue}let h=s[a+1];await _g(r,d.Links,h.bucket,i),h.node=d}return await i.put(e,!0),s.reverse(),{rootBucket:i,path:s}},bX=async(r,e,t={})=>{let i=new bg({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:t.mtime,mode:t.mode},t);for(let s=0;s<e.length;s++)await i._bucket.put(e[s].name,{size:e[s].size,cid:e[s].cid});let n=await(0,gX.default)(i.flush(r.repo.blocks));if(!n)throw new Error("Flushing shard yielded no result");return n};var cc=A(St()),_X=A(Zn()),uc=(0,wX.default)("ipfs:mfs:core:utils:add-link");async function uo(r,e){let t=e.parent;if(e.parentCid){let n=L.asCID(e.parentCid);if(n===null)throw(0,cc.default)(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(n.code!==wt)throw(0,cc.default)(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");uc(`Loading parent node ${n}`);let s=await r.repo.blocks.get(n);t=Nt(s)}if(!t)throw(0,cc.default)(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!e.cid)throw(0,cc.default)(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!e.name)throw(0,cc.default)(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!e.size&&e.size!==0)throw(0,cc.default)(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!t.Data)throw(0,cc.default)(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");let i=dt.unmarshal(t.Data);return i.type==="hamt-sharded-directory"?(uc("Adding link to sharded directory"),pOe(r,{...e,parent:t})):t.Links.length>=e.shardSplitThreshold?(uc("Converting directory to sharded directory"),dOe(r,{...e,parent:t,mtime:i.mtime,mode:i.mode})):(uc(`Adding ${e.name} (${e.cid}) to regular directory`),hOe(r,{...e,parent:t}))}var dOe=async(r,e)=>{let t=await bX(r,e.parent.Links.map(i=>({name:i.Name||"",size:i.Tsize||0,cid:i.Hash})).concat({name:e.name,size:e.size,cid:e.cid}),e);return uc(`Converted directory to sharded directory ${t.cid}`),t},hOe=async(r,e)=>{let t=e.parent.Links.filter(u=>u.Name!==e.name);if(t.push({Name:e.name,Tsize:e.size,Hash:e.cid}),!e.parent.Data)throw(0,cc.default)(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");let i=dt.unmarshal(e.parent.Data),n;if(i.mtime){let u=Date.now(),f=Math.floor(u/1e3);i.mtime={secs:f,nsecs:(u-f*1e3)*1e3},n=i.marshal()}else n=e.parent.Data;e.parent=$i({Data:n,Links:t});let s=await r.hashers.getHasher(e.hashAlg),o=ut(e.parent),a=await s.digest(o),c=L.create(e.cidVersion,wt,a);return e.flush&&await r.repo.blocks.put(c,o),{node:e.parent,cid:c,size:o.length}},pOe=async(r,e)=>{let{shard:t,path:i}=await yOe(r,e),n=await(0,_X.default)(t.flush(r.repo.blocks));if(!n)throw new Error("No result from flushing shard");let s=await r.repo.blocks.get(n.cid),o=Nt(s),a=e.parent.Links.filter(u=>(u.Name||"").substring(0,2)!==i[0].prefix),c=o.Links.find(u=>(u.Name||"").substring(0,2)===i[0].prefix);if(!c)throw new Error(`No link found with prefix ${i[0].prefix}`);return a.push(c),P0(r,a,i[0].bucket,e)},yOe=async(r,e)=>{let t={name:e.name,cid:e.cid,size:e.size};if(!e.parent.Data)throw(0,cc.default)(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");let i=await uR(e.parent.Links),n=dt.unmarshal(e.parent.Data),s=new bg({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mode:n.mode},e);s._bucket=i,n.mtime&&(s.mtime={secs:Math.round(Date.now()/1e3)});let o=await i._findNewBucketAndPos(t.name),a=gOe(o);a[0].node=e.parent;let c=0;for(;c<a.length;){let u=a[c];c++;let f=u.node;if(!f)throw new Error("Segment had no node");let d=f.Links.find(g=>(g.Name||"").substring(0,2)===u.prefix);if(!d){uc(`Link ${u.prefix}${t.name} will be added`),c=a.length;break}if(d.Name===`${u.prefix}${t.name}`){uc(`Link ${u.prefix}${t.name} will be replaced`),c=a.length;break}if((d.Name||"").length>2){uc(`Link ${d.Name} ${d.Hash} will be replaced with a subshard`),c=a.length;break}uc(`Found subshard ${u.prefix}`);let h=await r.repo.blocks.get(d.Hash),p=Nt(h);if(!a[c]){uc(`Loaded new subshard ${u.prefix}`),await cR(r,p.Links,i,u.bucket,parseInt(u.prefix,16));let g=await i._findNewBucketAndPos(t.name);a.push({bucket:g.bucket,prefix:Cd(g.pos),node:p});break}let y=a[c];await _g(r,p.Links,y.bucket,i),y.node=p}return await s._bucket.put(t.name,{size:t.size,cid:t.cid}),{shard:s,path:a}},gOe=r=>{let e=[{bucket:r.bucket,prefix:Cd(r.pos)}],t=r.bucket._parent,i=r.bucket._posAtParent;for(;t;)e.push({bucket:t,prefix:Cd(i)}),i=t._posAtParent,t=t._parent;return e.reverse(),e};l();var vX=A(le());var EX=(0,vX.default)("ipfs:mfs:utils:update-tree"),mOe={shardSplitThreshold:1e3};async function As(r,e,t){t=Object.assign({},mOe,t),EX("Trail",e),e=e.slice().reverse();let i=0,n;for await(let o of r.repo.blocks.getMany(e.map(a=>a.cid))){let a=Nt(o),c=e[i].cid,u=e[i].name;if(i++,!n){n={cid:c,name:u,size:o.length};continue}let f=await uo(r,{parent:a,name:n.name,cid:n.cid,size:n.size,flush:t.flush,shardSplitThreshold:t.shardSplitThreshold,hashAlg:t.hashAlg,cidVersion:t.cidVersion});n={cid:f.cid,name:u,size:f.size}}let{cid:s}=n;return EX(`Final CID ${s}`),s}l();var SX=A(le());var AX=A(St()),bOe=(0,SX.default)("ipfs:mfs:utils:update-mfs-root");async function Rs(r,e,t){if(t&&t.signal&&t.signal.aborted)throw(0,AX.default)(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return bOe(`New MFS root will be ${e}`),await r.repo.datastore.put(Wy,e.bytes),e}we();var BX=A(dr());var LX=A(Zn());l();l();var Od=A(St()),xX=A(le());l();we();async function RX(r,e,t){let i=new dt({type:e,mode:t.mode,mtime:t.mtime}),n=await r.hashers.getHasher(t.hashAlg),s={Data:i.marshal(),Links:[]},o=ut(s),a=await n.digest(o),c=L.create(t.cidVersion,wt,a);return t.flush&&await r.repo.blocks.put(c,o),{cid:c,node:s}}var wOe=Ct.bind({ignoreUndefined:!0}),IX=(0,xX.default)("ipfs:mfs:mkdir"),_Oe={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};function kd(r){async function e(t,i={}){let n=wOe(_Oe,i);if(!t)throw new Error("no path given to Mkdir");if(t=t.trim(),t==="/"){if(n.parents)return;throw(0,Od.default)(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if(t.substring(0,1)!=="/")throw(0,Od.default)(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");IX(`Creating ${t}`);let s=I0(t);if(s[0]==="ipfs")throw(0,Od.default)(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");let o=await x0(r,n),a,c=[],u=await RX(r,"directory",n);for(let d=0;d<=s.length;d++){let h=s.slice(0,d),p=`/ipfs/${o}/${h.join("/")}`;try{if(a=await an(p,r.repo.blocks),a.type!=="file"&&a.type!=="directory")throw(0,Od.default)(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(d===s.length){if(n.parents)return;throw(0,Od.default)(new Error("file already exists"),"ERR_ALREADY_EXISTS")}c.push({name:a.name,cid:a.cid})}catch(y){if(y.code==="ERR_NOT_FOUND"){if(d<s.length&&!n.parents)throw(0,Od.default)(new Error(`Intermediate directory path ${p} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await vOe(r,h[h.length-1],u,c[c.length-1],c,n)}else throw y}}let f=await As(r,c,n);await Rs(r,f,n)}return Q(e)}var vOe=async(r,e,t,i,n,s)=>{IX(`Adding empty dir called ${e} to ${i.cid}`);let o=await uo(r,{parent:i.node,parentCid:i.cid,size:0,cid:t.cid,name:e,hashAlg:s.hashAlg,cidVersion:s.cidVersion,flush:s.flush,shardSplitThreshold:s.shardSplitThreshold});n[n.length-1].cid=o.cid,n.push({name:e,cid:t.cid})};var TX=A(le()),jl=A(St());var EOe=Ct.bind({ignoreUndefined:!0}),Q6=(0,TX.default)("ipfs:mfs:cp"),SOe={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};function C0(r){async function e(t,i,n={}){let s=EOe(SOe,n);Array.isArray(t)||(t=[t]);let o=await Promise.all(t.map(h=>Jr(r,h,s))),a=await Jr(r,i,s);if(!o.length||!a)throw(0,jl.default)(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");let c=o.find(h=>!h.exists);if(c)throw(0,jl.default)(new Error(`${c.path} does not exist`),"ERR_INVALID_PARAMS");let u=PX(a);if(a.exists){if(Q6("Destination exists"),o.length===1&&!u)throw(0,jl.default)(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(Q6("Destination does not exist"),o.length>1){if(!s.parents)throw(0,jl.default)(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await kd(r)(a.path,s),a=await Jr(r,a.path,s)}else if(a.parts.length>1){let h=`/${a.parts.slice(0,-1).join("/")}`;try{await Ml(r)(h,s)}catch(p){if(p.code!=="ERR_NOT_FOUND")throw p;if(!s.parents)throw(0,jl.default)(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await kd(r)(h,s),a=await Jr(r,a.path,s)}}let f=PX(a)?a.mfsPath:a.mfsDirectory,d=await ac(r,f);if(o.length===1){let h=o.pop();if(!h)throw(0,jl.default)(new Error("could not find source"),"ERR_INVALID_PARAMS");let p=u?h.name:a.name;return Q6(`Only one source, copying to destination ${u?"directory":"file"} ${p}`),AOe(r,h,p,d,s)}return Q6("Multiple sources, wrapping in a directory"),ROe(r,o,a,d,s)}return Q(e)}var PX=r=>r.unixfs&&r.unixfs.type&&r.unixfs.type.includes("directory"),AOe=async(r,e,t,i,n)=>{let s=i.pop();if(!s)throw(0,jl.default)(new Error("destination had no parent"),"ERR_INVALID_PARAMS");s=await CX(r,e,t,s,n),i.push(s);let o=await As(r,i,n);await Rs(r,o,n)},ROe=async(r,e,t,i,n)=>{for(let o=0;o<e.length;o++){let a=e[o];t=await CX(r,a,a.name,t,n)}i[i.length-1]=t;let s=await As(r,i,n);await Rs(r,s,n)},CX=async(r,e,t,i,n)=>{let s=await r.repo.blocks.get(e.cid),{node:o,cid:a,size:c}=await uo(r,{parentCid:i.cid,size:s.length,cid:e.cid,name:t,hashAlg:n.hashAlg,cidVersion:n.cidVersion,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold});return i.node=o,i.cid=a,i.size=c,i};l();var vg=A(St());l();we();var OX=A(le());var ql=A(St()),Ul=(0,OX.default)("ipfs:mfs:core:utils:remove-link");async function kX(r,e){let t=e.parent;if(e.parentCid){let n=L.asCID(e.parentCid);if(n===null)throw(0,ql.default)(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");Ul(`Loading parent node ${n}`);let s=await r.repo.blocks.get(n);t=Nt(s)}if(!t)throw(0,ql.default)(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!e.name)throw(0,ql.default)(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!t.Data)throw(0,ql.default)(new Error("Parent node had no data"),"ERR_INVALID_NODE");return dt.unmarshal(t.Data).type==="hamt-sharded-directory"?(Ul(`Removing ${e.name} from sharded directory`),IOe(r,{...e,parent:t})):(Ul(`Removing link ${e.name} regular directory`),xOe(r,{...e,parent:t}))}var xOe=async(r,e)=>{e.parent.Links=e.parent.Links.filter(o=>o.Name!==e.name);let t=await ut(e.parent),n=await(await r.hashers.getHasher(e.hashAlg)).digest(t),s=L.create(e.cidVersion,wt,n);return await r.repo.blocks.put(s,t),Ul(`Updated regular directory ${s}`),{node:e.parent,cid:s}},IOe=async(r,e)=>{let{rootBucket:t,path:i}=await mX(r,e.name,e.parent);await t.del(e.name);let{node:n}=await DX(r,i,e.name,e);return P0(r,n.Links,t,e)},DX=async(r,e,t,i)=>{let n=e.pop();if(!n)throw(0,ql.default)(new Error("Could not find parent"),"EINVALIDPARENT");let{bucket:s,prefix:o,node:a}=n;if(!a)throw(0,ql.default)(new Error("Could not find parent"),"EINVALIDPARENT");let c=a.Links.find(p=>(p.Name||"").substring(0,2)===o);if(!c)throw(0,ql.default)(new Error(`No link found with prefix ${o} for file ${t}`),"ERR_NOT_FOUND");if(c.Name===`${o}${t}`){Ul(`Removing existing link ${c.Name}`);let p=a.Links.filter(y=>y.Name!==c.Name);return await s.del(t),P0(r,p,s,i)}Ul(`Descending into sub-shard ${c.Name} for ${o}${t}`);let u=await DX(r,e,t,i),f=u.cid,d=u.size,h=o;if(u.node.Links.length===1){Ul(`Removing subshard for ${o}`);let p=u.node.Links[0];h=`${o}${(p.Name||"").substring(2)}`,f=p.Hash,d=p.Tsize||0}return Ul(`Updating shard ${o} with name ${h}`),TOe(r,s,a,o,h,d,f,i)},TOe=(r,e,t,i,n,s,o,a)=>{let c=t.Links.filter(u=>u.Name!==i);return c.push({Name:n,Tsize:s,Hash:o}),P0(r,c,e,a)};var POe=Ct.bind({ignoreUndefined:!0}),COe={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};function O0(r){async function e(t,i={}){let n=POe(COe,i);Array.isArray(t)||(t=[t]);let s=await Promise.all(t.map(o=>Jr(r,o,n)));if(!s.length)throw(0,vg.default)(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");s.forEach(o=>{if(o.path==="/")throw(0,vg.default)(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")});for(let o of s)await OOe(r,o.path,n)}return Q(e)}var OOe=async(r,e,t)=>{let i=await Jr(r,e,t),n=await ac(r,i.mfsPath),s=n[n.length-1];n.pop();let o=n[n.length-1];if(!o)throw(0,vg.default)(new Error(`${e} does not exist`),"ERR_NOT_FOUND");if(s.type==="directory"&&!t.recursive)throw(0,vg.default)(new Error(`${e} is a directory, use -r to remove directories`),"ERR_WAS_DIR");let{cid:a}=await kX(r,{parentCid:o.cid,name:s.name,hashAlg:t.hashAlg,cidVersion:t.cidVersion,flush:t.flush,shardSplitThreshold:t.shardSplitThreshold});o.cid=a;let c=await As(r,n,t);await Rs(r,c,t)};var kOe=Ct.bind({ignoreUndefined:!0}),DOe=(0,NX.default)("ipfs:mfs:touch"),MX={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function NOe(r,e,t){let i=0;return(r.includes("x")||r.includes("X")&&(t||e&1||e&8||e&64))&&(i+=1),r.includes("w")&&(i+=2),r.includes("r")&&(i+=4),i}function BOe(r,e){let t=0;return r.includes("u")&&(t+=e<<6),r.includes("g")&&(t+=e<<3),r.includes("o")&&(t+=e),t}function LOe(r,e,t){return e.includes("t")&&(t+=parseInt("1000",8)),e.includes("s")&&(r.includes("u")&&(t+=parseInt("4000",8)),r.includes("g")&&(t+=parseInt("2000",8))),t}function MOe(r,e,t){e||(e=0);let i=r.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!i)throw new Error(`Invalid file mode: ${r}`);let[,n,s,o]=i;(n==="a"||!n)&&(n="ugo");let a=NOe(o,e,t);return a=BOe(n,a),a=LOe(n,o,a),s==="="?(n.includes("u")&&(e=e&parseInt("7077",8),e=e|a),n.includes("g")&&(e=e&parseInt("7707",8),e=e|a),n.includes("o")&&(e=e&parseInt("7770",8),e=e|a),e):s==="+"?a|e:s==="-"?a^e:e}function jX(r,e){if(r instanceof String||typeof r=="string"){let t=`${r}`;t.match(/^\d+$/g)?r=parseInt(t,8):r=0+t.split(",").reduce((i,n)=>MOe(n,i,e.isDirectory()),e.mode||0)}return r}function qX(r){async function e(t,i,n={}){let s=kOe(MX,n);DOe(`Fetching stats for ${t}`);let{cid:o,mfsDirectory:a,name:c}=await Jr(r,t,s);if(o.code!==wt)throw(0,k0.default)(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(s.recursive){let j=await(0,BX.pipe)(async function*(){for await(let M of h6(o,r.repo.blocks)){if(M.type!=="file"&&M.type!=="directory")throw(0,k0.default)(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");M.unixfs.mode=jX(i,M.unixfs);let se=$i({Data:M.unixfs.marshal(),Links:M.node.Links});yield{path:M.path,content:se}}},M=>o0(M,r.repo.blocks,{...s,pin:!1,dagBuilder:async function*(se,ie,fe){for await(let pe of se)yield async function(){let Be=pe.content,Ae=ut(Be),ke=await $6(Ae,ie,fe);if(!Be.Data)throw(0,k0.default)(new Error(`${ke} had no data`),"ERR_INVALID_NODE");let ne=dt.unmarshal(Be.Data);return{cid:ke,size:Ae.length,path:pe.path,unixfs:ne}}}}),M=>(0,LX.default)(M));if(!j)throw(0,k0.default)(new Error(`Could not chmod ${t}`),"ERR_COULD_NOT_CHMOD");await O0(r)(t,s),await C0(r)(`/ipfs/${j.cid}`,t,s);return}let u=await r.repo.blocks.get(o),f=Nt(u);if(!f.Data)throw(0,k0.default)(new Error(`${o} had no data`),"ERR_INVALID_NODE");let d=dt.unmarshal(f.Data);d.mode=jX(i,d);let h=ut({Data:d.marshal(),Links:f.Links}),p=s.hashAlg||MX.hashAlg,g=await(await r.hashers.getHasher(p)).digest(h),w=L.create(s.cidVersion,wt,g);s.flush&&await r.repo.blocks.put(w,h);let b=await ac(r,a),v=b[b.length-1],R=L.decode(v.cid.bytes),k=await r.repo.blocks.get(R),C=Nt(k),T=await uo(r,{parent:C,name:c,cid:w,size:h.length,flush:s.flush,hashAlg:p,cidVersion:o.version,shardSplitThreshold:1/0});v.cid=T.cid;let D=await As(r,b,s);await Rs(r,D,s)}return Q(e)}l();var jOe=Ct.bind({ignoreUndefined:!0}),qOe={};function UX(r){async function e(t,i={}){i=jOe(qOe,i);let{cid:n}=await Ml(r)(t,i);return n}return Q(e)}l();var UOe=Ct.bind({ignoreUndefined:!0}),FOe={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};function FX(r){async function e(t,i,n={}){let s=UOe(FOe,n);await C0(r)(t,i,s),await O0(r)(t,{...s,recursive:!0})}return Q(e)}l();var KX=A(le()),lR=A(St());we();var KOe=Ct.bind({ignoreUndefined:!0}),VOe=(0,KX.default)("ipfs:mfs:touch"),VX={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};function zX(r){async function e(t,i={}){let n=KOe(VX,i);n.mtime=n.mtime||new Date,VOe(`Touching ${t} mtime: ${n.mtime}`);let{cid:s,mfsDirectory:o,name:a,exists:c}=await Jr(r,t,n),u=i.hashAlg||VX.hashAlg,f=await r.hashers.getHasher(u),d,h,p=n.cidVersion;if(c){if(s.code!==wt)throw(0,lR.default)(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");p=s.version;let C=await r.repo.blocks.get(s),T=Nt(C);if(!T.Data)throw(0,lR.default)(new Error(`${t} had no data`),"ERR_INVALID_NODE");let D=dt.unmarshal(T.Data);D.mtime=n.mtime,d=ut({Data:D.marshal(),Links:T.Links});let j=await f.digest(d);h=L.create(n.cidVersion,wt,j),n.flush&&await r.repo.blocks.put(h,d)}else{let C=new dt({type:"file",mtime:n.mtime});d=ut({Data:C.marshal(),Links:[]});let T=await f.digest(d);h=L.create(n.cidVersion,wt,T),n.flush&&await r.repo.blocks.put(h,d)}let y=await ac(r,o),g=y[y.length-1],w=g.cid,b=await r.repo.blocks.get(w),v=Nt(b),R=await uo(r,{parent:v,name:a,cid:h,size:d.length,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:p});g.cid=R.cid;let k=await As(r,y,n);await Rs(r,k,n)}return Q(e)}l();var fR=A(St());var zOe=Ct.bind({ignoreUndefined:!0}),HOe={offset:0,length:1/0};function HX(r){function e(t,i={}){return i=zOe(HOe,i),{[Symbol.asyncIterator]:async function*(){let s=await Jr(r,t,i),o=await an(s.mfsPath,r.repo.blocks);if(o.type!=="file")throw(0,fR.default)(new Error(`${t} was not a file`),"ERR_NOT_FILE");if(!o.content)throw(0,fR.default)(new Error(`Could not load content stream from ${t}`),"ERR_NO_CONTENT");for await(let a of o.content({offset:i.offset,length:i.length}))yield a}}}return Q(e)}l();var WX=A(le());l();var dR=A(St()),$X=A(le());at();var Eg=(0,$X.default)("ipfs:mfs:utils:to-async-iterator");function GX(r){if(!r)throw(0,dR.default)(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if((typeof r=="string"||r instanceof String)&&(Eg("Content was a string"),r=Qe(r.toString())),r.length)return Eg("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield r}};if(r[Symbol.asyncIterator])return Eg("Content was an async iterator"),r;if(r[Symbol.iterator])return Eg("Content was an iterator"),r;if(globalThis.Blob&&r instanceof globalThis.Blob){Eg("Content was an HTML5 Blob");let e=0,t={next:()=>e>r.size?{done:!0}:new Promise((i,n)=>{let s=r.slice(e,Yy);e+=Yy;let o=new globalThis.FileReader,a=c=>{if(o.removeEventListener("loadend",a,!1),c.error)return n(c.error);i({done:!1,value:new Uint8Array(o.result)})};o.addEventListener("loadend",a),o.readAsArrayBuffer(s)})};return{[Symbol.asyncIterator]:()=>t}}throw(0,dR.default)(new Error(`Don't know how to convert ${r} into an async iterator`),"ERR_INVALID_PARAMS")}var lc=A(St());var YX=A(Zn());var $Oe=Ct.bind({ignoreUndefined:!0}),fc=(0,WX.default)("ipfs:mfs:write"),GOe={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(r,e)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};function XX(r){async function e(t,i,n={}){let s=$Oe(GOe,n),o,a,c;if(fc("Reading source, destination and parent"),await mg().readLock(async()=>{o=await GX(i),a=await Jr(r,t,s),c=await Jr(r,a.mfsDirectory,s)})(),fc("Read source, destination and parent"),!s.parents&&!c.exists)throw(0,lc.default)(new Error("directory does not exist"),"ERR_NO_EXIST");if(o==null)throw(0,lc.default)(new Error("could not create source"),"ERR_NO_SOURCE");if(a==null)throw(0,lc.default)(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!s.create&&!a.exists)throw(0,lc.default)(new Error("file does not exist"),"ERR_NO_EXIST");if(a.entryType!=="file")throw(0,lc.default)(new Error("not a file"),"ERR_NOT_A_FILE");return WOe(r,t,o,a,s)}return Q(e)}var WOe=async(r,e,t,i,n)=>{let s=await YOe(r,t,i,n);await mg().writeLock(async()=>{let o=I0(e),a=o.pop();if(a==null)throw(0,lc.default)(new Error("source does not exist"),"ERR_NO_EXIST");let c=!1;try{await Ml(r)(`/${o.join("/")}`,n),c=!0}catch(w){if(w.code!=="ERR_NOT_FOUND")throw w}c||await kd(r)(`/${o.join("/")}`,n);let u=await Jr(r,e,n),f=await ac(r,u.mfsDirectory),d=f[f.length-1];if(!d)throw(0,lc.default)(new Error("directory does not exist"),"ERR_NO_EXIST");if(!d.type||!d.type.includes("directory"))throw(0,lc.default)(new Error(`cannot write to ${d.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");let h=await r.repo.blocks.get(d.cid),p=Nt(h),y=await uo(r,{parent:p,name:a,cid:s.cid,size:s.size,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:n.cidVersion});d.cid=y.cid;let g=await As(r,f,n);await Rs(r,g,n)})()},YOe=async(r,e,t,i)=>{t.exists?fc(`Overwriting file ${t.cid} offset ${i.offset} length ${i.length}`):fc(`Writing file offset ${i.offset} length ${i.length}`);let n=[];if(i.offset>0)if(t.unixfs){if(fc(`Writing first ${i.offset} bytes of original file`),n.push(()=>t.content({offset:0,length:i.offset})),t.unixfs.fileSize()<i.offset){let f=i.offset-t.unixfs.fileSize();fc(`Writing zeros for extra ${f} bytes`),n.push(ZX(f))}}else fc(`Writing zeros for first ${i.offset} bytes`),n.push(ZX(i.offset));n.push(QX(e,i.length));let s=QOe(XOe(n),f=>{if(t.unixfs&&!i.truncate){let d=t.unixfs.fileSize();if(d>f)return fc(`Writing last ${d-f} of ${d} bytes from original file starting at offset ${f}`),t.content({offset:f});fc("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}),o;i.mode!==void 0&&i.mode!==null?o=Uc(i.mode):t&&t.unixfs&&(o=t.unixfs.mode);let a;i.mtime!=null?a=$u(i.mtime):t&&t.unixfs&&(a=t.unixfs.mtime);let c=await r.hashers.getHasher(i.hashAlg),u=await(0,YX.default)(o0([{content:s,mode:o,mtime:a}],r.repo.blocks,{progress:i.progress,hasher:c,cidVersion:i.cidVersion,strategy:i.strategy,rawLeaves:i.rawLeaves,reduceSingleLeafToSelf:i.reduceSingleLeafToSelf,leafType:i.leafType}));if(!u)throw(0,lc.default)(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return fc(`Wrote ${u.cid}`),{cid:u.cid,size:u.size}},QX=(r,e)=>async function*(){let i=0;for await(let n of r){if(i+=n.length,i>e){yield n.slice(0,e-i);return}yield n}},ZX=(r,e=Yy)=>{let t=new Uint8Array(e);async function*i(){for(;;)yield t.slice()}return QX(i(),r)},XOe=async function*(r){for(let e=0;e<r.length;e++)yield*r[e]()},QOe=async function*(r,e){let t=0;for await(let i of r)t+=i.length,yield i;for await(let i of e(t))t+=i.length,yield i};l();var JX=A(wn()),eQ=r=>{let e={cid:r.cid,name:r.name,type:r.type==="directory"?"directory":"file",size:r.size};return(r.type==="file"||r.type==="directory")&&(e.mode=r.unixfs.mode,e.mtime=r.unixfs.mtime),e};function tQ(r){async function*e(t,i={}){let n=await Jr(r,t,i),s=await an(n.mfsPath,r.repo.blocks);if(s.type==="directory"){yield*(0,JX.default)(s.content(i),eQ);return}yield eQ(s)}return Q(e)}var ZOe={stat:Ml},JOe={chmod:qX,cp:C0,flush:UX,mkdir:kd,mv:FX,rm:O0,touch:zX},rQ={write:XX,read:HX,ls:tQ},iQ=({options:r,mfs:e,operations:t,lock:i})=>{Object.keys(t).forEach(n=>{e[n]=i(t[n](r))})},eke={repoOwner:!0,repo:null};function tke(r){let{repoOwner:e}=Object.assign({},eke||{},r),t=mg(e),i=o=>t.readLock(o),n=o=>t.writeLock(o),s={};return iQ({options:r,mfs:s,operations:ZOe,lock:i}),iQ({options:r,mfs:s,operations:JOe,lock:n}),Object.keys(rQ).forEach(o=>{s[o]=rQ[o](r)}),s}function nQ({repo:r,preload:e,hashers:t,options:i}){let n=tke({repo:r,repoOwner:Boolean(i.repoOwner),hashers:t}),s=o=>(...c)=>{let u=c.filter(f=>hR.default.ipfsPath(f)||hR.default.cid(f));if(u.length){let f=c[c.length-1];f&&f.preload!==!1&&u.forEach(d=>e(d))}return o(...c)};return{...n,chmod:n.chmod,cp:s(n.cp),mkdir:n.mkdir,stat:s(n.stat),rm:n.rm,read:s(n.read),touch:n.touch,write:n.write,mv:s(n.mv),flush:n.flush,ls:s(async function*(...o){for await(let a of n.ls(...o))yield{...a,size:a.size||0}})}}l();l();function sQ({keychain:r}){return Q((t,i)=>r.exportKey(t,i))}l();var oQ="ed25519",aQ=2048;function cQ({keychain:r}){return Q((t,i={type:oQ,size:aQ})=>r.createKey(t,i.type||oQ,i.size||aQ))}l();function uQ({keychain:r}){return Q((t,i,n)=>r.importKey(t,i,n))}l();function lQ({keychain:r}){return Q(t=>r.findKeyByName(t))}l();function fQ({keychain:r}){return Q(()=>r.listKeys())}l();function dQ({keychain:r}){return Q(async(t,i)=>{let n=await r.renameKey(t,i);return{was:t,now:n.name,id:n.id,overwrite:!1}})}l();function hQ({keychain:r}){return Q(t=>r.removeKey(t))}var pR=class{constructor({keychain:e}){this.gen=cQ({keychain:e}),this.list=fQ({keychain:e}),this.rm=hQ({keychain:e}),this.rename=dQ({keychain:e}),this.export=sQ({keychain:e}),this.import=uQ({keychain:e}),this.info=lQ({keychain:e})}};l();l();l();function ss({repo:r,preload:e}){async function t(i,n={}){n.preload!==!1&&e(i);let s=await r.blocks.get(i,n);return Nt(s)}return Q(t)}function pQ({repo:r,preload:e}){let t=ss({repo:r,preload:e});async function i(n,s={}){return(await t(n,s)).Data||new Uint8Array(0)}return Q(i)}l();Vs();we();function yR(r,e=[]){for(let t in r){let i=r[t];if(t==="/"&&Object.keys(r).length===1)try{e.push({Name:"",Tsize:0,Hash:L.parse(i)});continue}catch(s){}let n=L.asCID(i);if(n){e.push({Name:"",Tsize:0,Hash:n});continue}Array.isArray(i)&&yR(i,e),i&&typeof i=="object"&&yR(i,e)}return e}function yQ({repo:r,codecs:e}){async function t(i,n={}){let s=await e.getCodec(i.code),o=await r.blocks.get(i,n),a=s.decode(o);switch(i.code){case Bi:return[];case wt:return a.Links;case r7:case c7:return yR(a);default:throw new Error(`Cannot resolve links from codec ${i.code}`)}}return Q(t)}l();Si();we();function gQ({repo:r,preload:e}){async function t(i={}){let n;if(i.template)if(i.template==="unixfs-dir")n=new dt({type:"directory"}).marshal();else throw new Error("unknown template");let s=ut({Data:n,Links:[]}),o=await Lr.digest(s),a=L.createV0(o);return await r.blocks.put(a,s,{signal:i.signal}),i.preload!==!1&&e(a),a}return Q(t)}l();we();Si();function dc({repo:r,preload:e}){async function t(i,n={}){let s=await r.gcLock.readLock();try{let o=ut(i),a=await Lr.digest(o),c=L.createV1(wt,a);return await r.blocks.put(c,o,{signal:n.signal}),n.preload!==!1&&e(c),n.pin&&await r.pins.pinRecursively(c,{signal:n.signal}),c}finally{s()}}return Q(t)}l();function mQ({repo:r,preload:e}){let t=ss({repo:r,preload:e});async function i(n,s={}){let o=await t(n,s),c=ut(o).length,u=o.Links.reduce((f,d)=>f+(d.Tsize||0),0);return{Hash:n,NumLinks:o.Links.length,BlockSize:c,LinksSize:c-(o.Data||[]).length,DataSize:(o.Data||[]).length,CumulativeSize:c+u}}return Q(i)}l();l();function bQ({repo:r,preload:e}){let t=ss({repo:r,preload:e}),i=dc({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a);return i({...c,Links:c.Links.concat([o])},a)}return Q(n)}l();Ri();function wQ({repo:r,preload:e}){let t=ss({repo:r,preload:e}),i=dc({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a),u=Li([c.Data||[],o]);return i({...c,Data:u},a)}return Q(n)}l();function _Q({repo:r,preload:e}){let t=ss({repo:r,preload:e}),i=dc({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a),u=(typeof o=="string"?o:o.Name)||"";return c.Links=c.Links.filter(f=>f.Name!==u),i(c,a)}return Q(n)}l();function vQ({repo:r,preload:e}){let t=ss({repo:r,preload:e}),i=dc({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a);return i({...c,Data:o},a)}return Q(n)}var gR=class{constructor({repo:e,preload:t}){this.addLink=bQ({repo:e,preload:t}),this.appendData=wQ({repo:e,preload:t}),this.rmLink=_Q({repo:e,preload:t}),this.setData=vQ({repo:e,preload:t})}};var mR=class{constructor({repo:e,codecs:t,preload:i}){this.data=pQ({repo:e,preload:i}),this.get=ss({repo:e,preload:i}),this.links=yQ({repo:e,codecs:t}),this.new=gQ({repo:e,preload:i}),this.put=dc({repo:e,preload:i}),this.stat=mQ({repo:e,preload:i}),this.patch=new gR({repo:e,preload:i})}};l();l();var EQ=A(le());var rke=(0,EQ.default)("ipfs:repo:gc");function SQ({repo:r,hashers:e}){async function*t(i={}){let n=Date.now(),s;try{s=await x0({repo:r,hashers:e},i),await r.pins.pinRecursively(s),yield*r.gc()}finally{s&&await r.pins.unpin(s)}rke(`Complete (${Date.now()-n}ms)`)}return Q(t)}l();function Z6({repo:r}){async function e(t={}){let i=await r.stat();return{numObjects:BigInt(i.numObjects.toString()),repoSize:BigInt(i.repoSize.toString()),repoPath:i.repoPath,version:`${i.version}`,storageMax:BigInt(i.storageMax.toString())}}return Q(e)}l();l();var D0=12;function AQ({repo:r}){async function e(t={}){try{await r._checkInitialized(t)}catch(i){if([/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(s=>s.test(i.message)))return D0;throw i}return r.version.get()}return Q(e)}var bR=class{constructor({repo:e,hashers:t}){this.gc=SQ({repo:e,hashers:t}),this.stat=Z6({repo:e}),this.version=AQ({repo:e}),this.setApiAddr=i=>e.apiAddr.set(i)}};l();l();var RQ=A(St());var xQ=A(st());function IQ(r,e){let t;if(r.metrics?e.peer?t=r.metrics.forPeer(xQ.default.parse(e.peer)):e.proto?t=r.metrics.forProtocol(e.proto):t=r.metrics.global:t=void 0,!t)return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0};let{movingAverages:i,snapshot:n}=t;return{totalIn:BigInt(n.dataReceived.integerValue().toString()),totalOut:BigInt(n.dataSent.integerValue().toString()),rateIn:i.dataReceived[6e4].movingAverage()/60,rateOut:i.dataSent[6e4].movingAverage()/60}}function TQ({network:r}){return Q(async function*(t={}){let{libp2p:i}=await r.use(t);if(!t.poll){yield IQ(i,t);return}let n=t.interval||1e3,s=-1;try{if(s=typeof n=="string"?sl(n)||-1:n,!s||s<0)throw new Error("invalid duration")}catch(a){throw(0,RQ.default)(a,"ERR_INVALID_POLL_INTERVAL")}let o;try{for(;;)yield IQ(i,t),await new Promise(a=>{o=setTimeout(a,s)})}finally{clearTimeout(o)}})}var wR=class{constructor({repo:e,network:t}){this.repo=Z6({repo:e}),this.bw=TQ({network:t}),this.bitswap=jb({network:t})}};l();var x4e=A(le());l();l();var GR=A(_R()),ZZ=A(le()),Fd=A(Dd());l();l();l();we();Mr();var DQ=A(le()),NQ=A(Sg());rn();Vs();tn();var oke=(0,DQ.default)("ipfs:repo:migrator:migration-8");function BQ(r){return r.child?BQ(r.child):r}function ake(r){try{let e=lr.decode(`b${r.toString().toLowerCase().slice(1)}`),t=L.decode(e).multihash.bytes,i=lr.encode(t).slice(1).toUpperCase();return new xe(`/${i}`,!1)}catch(e){return r}}function cke(r){try{let e=lr.decode(`b${r.toString().toLowerCase().slice(1)}`),t=fi(e),i=lr.encode(L.createV1(Bi,t).bytes).slice(1);return new xe(`/${i.toUpperCase()}`,!1)}catch{return r}}async function LQ(r,e,t){let i=r.blocks;await i.open();let n=BQ(i),s=await(0,NQ.default)(n.queryKeys({filters:[o=>t(o).toString()!==o.toString()]}));try{let o=0;for await(let a of n.query({})){let c=t(a.key);c.toString()!==a.key.toString()&&(o+=1,oke(`Migrating Block from ${a.key} to ${c}`,await n.has(a.key)),await n.delete(a.key),await n.put(c,a.value),e(o/s*100,`Migrated Block from ${a.key} to ${c}`))}}finally{await i.close()}}var MQ={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(r,e=()=>{})=>LQ(r,e,ake),revert:(r,e=()=>{})=>LQ(r,e,cke)};l();we();Ju();l();we();l();var Nd=A(Br()),jQ=Nd.default.Reader,uke=Nd.default.Writer,Pbt=Nd.default.util,J6=Nd.default.roots.default||(Nd.default.roots.default={}),qQ=J6.ipfs=(()=>{let r={};return r.pin=function(){let e={};return e.Set=function(){function t(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return t.prototype.version=0,t.prototype.fanout=0,t.prototype.seed=0,t.encode=function(n,s){return s||(s=uke.create()),n.version!=null&&Object.hasOwnProperty.call(n,"version")&&s.uint32(8).uint32(n.version),n.fanout!=null&&Object.hasOwnProperty.call(n,"fanout")&&s.uint32(16).uint32(n.fanout),n.seed!=null&&Object.hasOwnProperty.call(n,"seed")&&s.uint32(29).fixed32(n.seed),s},t.decode=function(n,s){n instanceof jQ||(n=jQ.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new J6.ipfs.pin.Set;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.version=n.uint32();break;case 2:a.fanout=n.uint32();break;case 3:a.seed=n.fixed32();break;default:n.skipType(c&7);break}}return a},t.fromObject=function(n){if(n instanceof J6.ipfs.pin.Set)return n;var s=new J6.ipfs.pin.Set;return n.version!=null&&(s.version=n.version>>>0),n.fanout!=null&&(s.fanout=n.fanout>>>0),n.seed!=null&&(s.seed=n.seed>>>0),s},t.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(o.version=0,o.fanout=0,o.seed=0),n.version!=null&&n.hasOwnProperty("version")&&(o.version=n.version),n.fanout!=null&&n.hasOwnProperty("fanout")&&(o.fanout=n.fanout),n.seed!=null&&n.hasOwnProperty("seed")&&(o.seed=n.seed),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,Nd.default.util.toJSONOptions)},t}(),e}(),r})();var zQ=A(FQ()),r5=A(Xn());l();Mr();rn();we();var Ag=new xe("/local/pins"),e5=256,KQ=8192,ER=L.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),Bd={direct:"direct",recursive:"recursive"};function SR(r){return new xe(`/${lr.encode(r.multihash.bytes).toUpperCase().substring(1)}`)}Ri();t5();et();at();Si();var AR=qQ.pin.Set;function lke(r){let e=r.Data;if(!e)throw new Error("No data present");let t=r5.default.decode(e),i=r5.default.decode.bytes;if(i<=0)throw new Error("Invalid Set header length");if(i+t>e.length)throw new Error("Impossibly large set header length");let n=e.slice(i,t+i),s=AR.toObject(AR.decode(n),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(s.version!==1)throw new Error(`Unsupported Set version: ${s.version}`);if(s.fanout>r.Links.length)throw new Error("Impossibly large fanout");return{header:s,data:e.slice(t+i)}}function fke(r,e){let t=new Uint8Array(4);new DataView(t.buffer).setUint32(0,r,!0);let n=Qe(e.toString()),s=Li([t,n],t.byteLength+n.byteLength);return(0,zQ.default)($e(s))}async function*HQ(r,e){let t=lke(e),i=0;for(let n of e.Links){if(i<t.header.fanout){let s=n.Hash;if(!ER.equals(s)){let o=await r.get(s),a=Nt(o);yield*HQ(r,a)}}else yield n.Hash;i++}}async function*xg(r,e,t){let i=e.Links.find(o=>o.Name===t);if(!i)throw new Error("No link found with name "+t);let n=await r.get(i.Hash),s=Nt(n);yield*HQ(r,s)}function dke(r,e){return t(e,0);async function t(i,n){let s=AR.encode({version:1,fanout:e5,seed:n}).finish(),o=r5.default.encode(s.length),a=Li([o,s]),c=[];for(let f=0;f<e5;f++)c.push({Name:"",Tsize:1,Hash:ER});if(i.length<=KQ){let f=i.map(p=>({link:{Name:"",Tsize:1,Hash:p.key},data:p.data||new Uint8Array})).sort((p,y)=>Rg(p.link.Hash.bytes,y.link.Hash.bytes)),d=c.concat(f.map(p=>p.link));return{Data:Li([a,...f.map(p=>p.data)]),Links:d}}else{let f=i.reduce((h,p)=>{let y=fke(n,p.key)%e5;return h[y]=y in h?h[y].concat([p]):[p],h},[]),d=0;for(let h of f){let p=await t(h,n+1);await u(p,d),d++}return{Data:a,Links:c}}async function u(f,d){let h=ut(f),p=await Lr.digest(h),y=L.createV0(p);await r.put(y,h);let g=f.Links.reduce((w,b)=>w+(b.Tsize||0),0)+h.length;c[d]={Name:"",Tsize:g,Hash:y}}}}async function RR(r,e,t){let i=await dke(r,t.map(c=>({key:c}))),n=ut(i),s=await Lr.digest(n),o=L.createV0(s);await r.put(o,n);let a=i.Links.reduce((c,u)=>c+u.Tsize,0)+n.length;return{Name:e,Tsize:a,Hash:o}}var i5=A(Sg());Si();tn();rn();async function hke(r,e,t,i){if(!await e.has(Ag))return;let n=await e.get(Ag),s=L.decode(n),o=await r.get(s),a=Nt(o),c=0,u=await(0,i5.default)(xg(r,a,Bd.recursive))+await(0,i5.default)(xg(r,a,Bd.direct));for await(let f of xg(r,a,Bd.recursive)){c++;let d={depth:1/0};f.version!==0&&(d.version=f.version),f.code!==wt&&(d.codec=f.code),await t.put(SR(f),Wn(d)),i(c/u*100,`Migrated recursive pin ${f}`)}for await(let f of xg(r,a,Bd.direct)){c++;let d={depth:0};f.version!==0&&(d.version=f.version),f.code!==wt&&(d.codec=f.code),await t.put(SR(f),Wn(d)),i(c/u*100,`Migrated direct pin ${f}`)}await r.delete(s),await e.delete(Ag)}async function pke(r,e,t,i){let n=[],s=[],o=0,a=await(0,i5.default)(t.queryKeys({}));for await(let{key:h,value:p}of t.query({})){o++;let y=vi(p),g=L.create(y.version||0,y.codec||wt,fi(lr.decode("b"+h.toString().toLowerCase().split("/").pop())));y.depth===0?(i(o/a*100,`Reverted direct pin ${g}`),s.push(g)):(i(o/a*100,`Reverted recursive pin ${g}`),n.push(g))}i(100,"Updating pin root");let c={Links:[await RR(r,Bd.direct,s),await RR(r,Bd.recursive,n)]},u=ut(c),f=await Lr.digest(u),d=L.createV0(f);await r.put(d,u),await e.put(Ag,d.bytes)}async function $Q(r,e,t){let i=r.blocks,n=r.datastore,s=r.pins;await i.open(),await n.open(),await s.open();try{await t(i,n,s,e)}finally{await s.close(),await n.close(),await i.close()}}var GQ={version:9,description:"Migrates pins to datastore",migrate:(r,e=()=>{})=>$Q(r,e,hke),revert:(r,e=()=>{})=>$Q(r,e,pke)};l();l();Mr();eo();var WQ=new xe("/config"),Ig=new xe("/version");function Tg(r){let e=r;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}async function yke(r,e,t){let i=await e(r);if(i)return i;let n=Tg(t);return n?new Promise((s,o)=>{let a=n.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{s(Boolean(a.result))}}):!1}async function gke(r,e,t,i){if(await t(r))return e(r);let n=Tg(i);if(!n)throw xi();return new Promise((s,o)=>{let a=n.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return s(a.result);o(xi())}})}function n5(r){let e=r.get.bind(r),t=r.has.bind(r);return r.get=i=>gke(i,e,t,r),r.has=i=>yke(i,t,r),r}function xR(r){return{...r,root:n5(r.root),datastore:n5(r.datastore),pins:n5(r.pins),keys:n5(r.keys)}}at();et();async function mke(r,e,t=()=>{}){let i=Tg(e);if(!i){t(`${r} did not need an upgrade`);return}t(`Upgrading ${r}`),await ZQ(i,(s,o)=>[{type:"del",key:s},{type:"put",key:Qe(s),value:o}])}async function bke(r,e,t=()=>{}){let i=Tg(e);if(!i){t(`${r} did not need a downgrade`);return}t(`Downgrading ${r}`),await ZQ(i,(s,o)=>[{type:"del",key:s},{type:"put",key:$e(s),value:o}])}function YQ(r){return r.child?YQ(r.child):r}async function XQ(r,e,t){let i=Object.entries(r).map(([o,a])=>({key:o,backend:YQ(a)})).filter(({key:o,backend:a})=>a.constructor.name==="LevelDatastore").map(({key:o,backend:a})=>({name:o,store:a}));e(0,`Migrating ${i.length} dbs`);let n=0,s=o=>{e(Math.round(n/i.length*100),o)};for(let{name:o,store:a}of i){await a.open();try{await t(o,a,s)}finally{n++,await a.close()}}e(100,`Migrated ${i.length} dbs`)}var QQ={version:10,description:"Migrates datastore-level keys to binary",migrate:(r,e=()=>{})=>XQ(r,e,mke),revert:(r,e=()=>{})=>XQ(r,e,bke)};function ZQ(r,e){function t(i,n){let s=r.store("readwrite"),o=s.transaction,a=0,c;o.onabort=()=>n(c||o.error||new Error("aborted by user")),o.oncomplete=()=>n();function u(){let f=i[a++],d=f.key,h;try{h=f.type==="del"?s.delete(d):s.put(f.value,d)}catch(p){c=p,o.abort();return}a<i.length&&(h.onsuccess=u)}u()}return new Promise((i,n)=>{let s=r.iterator(),o=c=>c;s._deserializeKey=s._deserializeValue=o,a();function a(){let c=(u,f,d)=>{if(u||f===void 0){let h=p=>{if(p){n(p);return}i()};s.end(h);return}t(e(f,d),a)};s.next(c)}})}l();Mr();var Fl=new xe("/local/filesroot");async function wke(r,e=()=>{}){if(e(100,"Migrating MFS root to repo datastore"),await r.root.open(),await r.datastore.open(),await r.root.has(Fl)){let t=await r.root.get(Fl);await r.datastore.put(Fl,t),await r.root.delete(Fl)}await r.datastore.close(),await r.root.close(),e(100,"Stored MFS root in repo datastore")}async function _ke(r,e=()=>{}){if(e(100,"Migrating MFS root to repo root datastore"),await r.root.open(),await r.datastore.open(),await r.datastore.has(Fl)){let t=await r.datastore.get(Fl);await r.root.put(Fl,t),await r.datastore.delete(Fl)}await r.datastore.close(),await r.root.close(),e(100,"Stored MFS root in repo root datastore")}var JQ={version:11,description:"Store mfs root in the datastore",migrate:wke,revert:_ke};l();var kR=A(Br());Mr();l();var Ld=A(Br()),eZ=Ld.default.Reader,vke=Ld.default.Writer,Eke=Ld.default.util,s5=Ld.default.roots.default||(Ld.default.roots.default={}),IR=s5.Protocols=(()=>{function r(e){if(this.protocols=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.protocols=Eke.emptyArray,r.encode=function(t,i){if(i||(i=vke.create()),t.protocols!=null&&t.protocols.length)for(var n=0;n<t.protocols.length;++n)i.uint32(10).string(t.protocols[n]);return i},r.decode=function(t,i){t instanceof eZ||(t=eZ.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new s5.Protocols;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(t.string());break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof s5.Protocols)return t;var i=new s5.Protocols;if(t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Protocols.protocols: array expected");i.protocols=[];for(var n=0;n<t.protocols.length;++n)i.protocols[n]=String(t.protocols[n])}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.protocols=[]),t.protocols&&t.protocols.length){n.protocols=[];for(var s=0;s<t.protocols.length;++s)n.protocols[s]=t.protocols[s]}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Ld.default.util.toJSONOptions)},r})();l();var du=A(Br()),N0=du.default.Reader,TR=du.default.Writer,Kr=du.default.util,Qi=du.default.roots.default||(du.default.roots.default={}),PR=Qi.Addresses=(()=>{function r(e){if(this.addrs=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.addrs=Kr.emptyArray,r.prototype.certifiedRecord=null,r.encode=function(t,i){if(i||(i=TR.create()),t.addrs!=null&&t.addrs.length)for(var n=0;n<t.addrs.length;++n)Qi.Addresses.Address.encode(t.addrs[n],i.uint32(10).fork()).ldelim();return t.certifiedRecord!=null&&Object.hasOwnProperty.call(t,"certifiedRecord")&&Qi.Addresses.CertifiedRecord.encode(t.certifiedRecord,i.uint32(18).fork()).ldelim(),i},r.decode=function(t,i){t instanceof N0||(t=N0.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Qi.Addresses;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.addrs&&s.addrs.length||(s.addrs=[]),s.addrs.push(Qi.Addresses.Address.decode(t,t.uint32()));break;case 2:s.certifiedRecord=Qi.Addresses.CertifiedRecord.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Qi.Addresses)return t;var i=new Qi.Addresses;if(t.addrs){if(!Array.isArray(t.addrs))throw TypeError(".Addresses.addrs: array expected");i.addrs=[];for(var n=0;n<t.addrs.length;++n){if(typeof t.addrs[n]!="object")throw TypeError(".Addresses.addrs: object expected");i.addrs[n]=Qi.Addresses.Address.fromObject(t.addrs[n])}}if(t.certifiedRecord!=null){if(typeof t.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");i.certifiedRecord=Qi.Addresses.CertifiedRecord.fromObject(t.certifiedRecord)}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addrs=[]),i.defaults&&(n.certifiedRecord=null),t.addrs&&t.addrs.length){n.addrs=[];for(var s=0;s<t.addrs.length;++s)n.addrs[s]=Qi.Addresses.Address.toObject(t.addrs[s],i)}return t.certifiedRecord!=null&&t.hasOwnProperty("certifiedRecord")&&(n.certifiedRecord=Qi.Addresses.CertifiedRecord.toObject(t.certifiedRecord,i)),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,du.default.util.toJSONOptions)},r.Address=function(){function e(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.multiaddr=Kr.newBuffer([]),e.prototype.isCertified=null;let t;return Object.defineProperty(e.prototype,"_isCertified",{get:Kr.oneOfGetter(t=["isCertified"]),set:Kr.oneOfSetter(t)}),e.encode=function(n,s){return s||(s=TR.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&s.uint32(10).bytes(n.multiaddr),n.isCertified!=null&&Object.hasOwnProperty.call(n,"isCertified")&&s.uint32(16).bool(n.isCertified),s},e.decode=function(n,s){n instanceof N0||(n=N0.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new Qi.Addresses.Address;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.multiaddr=n.bytes();break;case 2:a.isCertified=n.bool();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof Qi.Addresses.Address)return n;var s=new Qi.Addresses.Address;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?Kr.base64.decode(n.multiaddr,s.multiaddr=Kr.newBuffer(Kr.base64.length(n.multiaddr)),0):n.multiaddr.length&&(s.multiaddr=n.multiaddr)),n.isCertified!=null&&(s.isCertified=Boolean(n.isCertified)),s},e.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(s.bytes===String?o.multiaddr="":(o.multiaddr=[],s.bytes!==Array&&(o.multiaddr=Kr.newBuffer(o.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(o.multiaddr=s.bytes===String?Kr.base64.encode(n.multiaddr,0,n.multiaddr.length):s.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),n.isCertified!=null&&n.hasOwnProperty("isCertified")&&(o.isCertified=n.isCertified,s.oneofs&&(o._isCertified="isCertified")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,du.default.util.toJSONOptions)},e}(),r.CertifiedRecord=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.seq=Kr.Long?Kr.Long.fromBits(0,0,!0):0,e.prototype.raw=Kr.newBuffer([]),e.encode=function(i,n){return n||(n=TR.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&n.uint32(8).uint64(i.seq),i.raw!=null&&Object.hasOwnProperty.call(i,"raw")&&n.uint32(18).bytes(i.raw),n},e.decode=function(i,n){i instanceof N0||(i=N0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Qi.Addresses.CertifiedRecord;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.seq=i.uint64();break;case 2:o.raw=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Qi.Addresses.CertifiedRecord)return i;var n=new Qi.Addresses.CertifiedRecord;return i.seq!=null&&(Kr.Long?(n.seq=Kr.Long.fromValue(i.seq)).unsigned=!0:typeof i.seq=="string"?n.seq=parseInt(i.seq,10):typeof i.seq=="number"?n.seq=i.seq:typeof i.seq=="object"&&(n.seq=new Kr.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0))),i.raw!=null&&(typeof i.raw=="string"?Kr.base64.decode(i.raw,n.raw=Kr.newBuffer(Kr.base64.length(i.raw)),0):i.raw.length&&(n.raw=i.raw)),n},e.toObject=function(i,n){n||(n={});var s={};if(n.defaults){if(Kr.Long){var o=new Kr.Long(0,0,!0);s.seq=n.longs===String?o.toString():n.longs===Number?o.toNumber():o}else s.seq=n.longs===String?"0":0;n.bytes===String?s.raw="":(s.raw=[],n.bytes!==Array&&(s.raw=Kr.newBuffer(s.raw)))}return i.seq!=null&&i.hasOwnProperty("seq")&&(typeof i.seq=="number"?s.seq=n.longs===String?String(i.seq):i.seq:s.seq=n.longs===String?Kr.Long.prototype.toString.call(i.seq):n.longs===Number?new Kr.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0):i.seq),i.raw!=null&&i.hasOwnProperty("raw")&&(s.raw=n.bytes===String?Kr.base64.encode(i.raw,0,i.raw.length):n.bytes===Array?Array.prototype.slice.call(i.raw):i.raw),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,du.default.util.toJSONOptions)},e}(),r})();l();var hu=A(Br()),B0=hu.default.Reader,CR=hu.default.Writer,ar=hu.default.util,Ii=hu.default.roots.default||(hu.default.roots.default={}),OR=Ii.Peer=(()=>{function r(t){if(this.addresses=[],this.protocols=[],this.metadata=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.addresses=ar.emptyArray,r.prototype.protocols=ar.emptyArray,r.prototype.metadata=ar.emptyArray,r.prototype.pubKey=null,r.prototype.peerRecordEnvelope=null;let e;return Object.defineProperty(r.prototype,"_pubKey",{get:ar.oneOfGetter(e=["pubKey"]),set:ar.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_peerRecordEnvelope",{get:ar.oneOfGetter(e=["peerRecordEnvelope"]),set:ar.oneOfSetter(e)}),r.encode=function(i,n){if(n||(n=CR.create()),i.addresses!=null&&i.addresses.length)for(var s=0;s<i.addresses.length;++s)Ii.Address.encode(i.addresses[s],n.uint32(10).fork()).ldelim();if(i.protocols!=null&&i.protocols.length)for(var s=0;s<i.protocols.length;++s)n.uint32(18).string(i.protocols[s]);if(i.metadata!=null&&i.metadata.length)for(var s=0;s<i.metadata.length;++s)Ii.Metadata.encode(i.metadata[s],n.uint32(26).fork()).ldelim();return i.pubKey!=null&&Object.hasOwnProperty.call(i,"pubKey")&&n.uint32(34).bytes(i.pubKey),i.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(i,"peerRecordEnvelope")&&n.uint32(42).bytes(i.peerRecordEnvelope),n},r.decode=function(i,n){i instanceof B0||(i=B0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ii.Peer;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.addresses&&o.addresses.length||(o.addresses=[]),o.addresses.push(Ii.Address.decode(i,i.uint32()));break;case 2:o.protocols&&o.protocols.length||(o.protocols=[]),o.protocols.push(i.string());break;case 3:o.metadata&&o.metadata.length||(o.metadata=[]),o.metadata.push(Ii.Metadata.decode(i,i.uint32()));break;case 4:o.pubKey=i.bytes();break;case 5:o.peerRecordEnvelope=i.bytes();break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof Ii.Peer)return i;var n=new Ii.Peer;if(i.addresses){if(!Array.isArray(i.addresses))throw TypeError(".Peer.addresses: array expected");n.addresses=[];for(var s=0;s<i.addresses.length;++s){if(typeof i.addresses[s]!="object")throw TypeError(".Peer.addresses: object expected");n.addresses[s]=Ii.Address.fromObject(i.addresses[s])}}if(i.protocols){if(!Array.isArray(i.protocols))throw TypeError(".Peer.protocols: array expected");n.protocols=[];for(var s=0;s<i.protocols.length;++s)n.protocols[s]=String(i.protocols[s])}if(i.metadata){if(!Array.isArray(i.metadata))throw TypeError(".Peer.metadata: array expected");n.metadata=[];for(var s=0;s<i.metadata.length;++s){if(typeof i.metadata[s]!="object")throw TypeError(".Peer.metadata: object expected");n.metadata[s]=Ii.Metadata.fromObject(i.metadata[s])}}return i.pubKey!=null&&(typeof i.pubKey=="string"?ar.base64.decode(i.pubKey,n.pubKey=ar.newBuffer(ar.base64.length(i.pubKey)),0):i.pubKey.length&&(n.pubKey=i.pubKey)),i.peerRecordEnvelope!=null&&(typeof i.peerRecordEnvelope=="string"?ar.base64.decode(i.peerRecordEnvelope,n.peerRecordEnvelope=ar.newBuffer(ar.base64.length(i.peerRecordEnvelope)),0):i.peerRecordEnvelope.length&&(n.peerRecordEnvelope=i.peerRecordEnvelope)),n},r.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addresses=[],s.protocols=[],s.metadata=[]),i.addresses&&i.addresses.length){s.addresses=[];for(var o=0;o<i.addresses.length;++o)s.addresses[o]=Ii.Address.toObject(i.addresses[o],n)}if(i.protocols&&i.protocols.length){s.protocols=[];for(var o=0;o<i.protocols.length;++o)s.protocols[o]=i.protocols[o]}if(i.metadata&&i.metadata.length){s.metadata=[];for(var o=0;o<i.metadata.length;++o)s.metadata[o]=Ii.Metadata.toObject(i.metadata[o],n)}return i.pubKey!=null&&i.hasOwnProperty("pubKey")&&(s.pubKey=n.bytes===String?ar.base64.encode(i.pubKey,0,i.pubKey.length):n.bytes===Array?Array.prototype.slice.call(i.pubKey):i.pubKey,n.oneofs&&(s._pubKey="pubKey")),i.peerRecordEnvelope!=null&&i.hasOwnProperty("peerRecordEnvelope")&&(s.peerRecordEnvelope=n.bytes===String?ar.base64.encode(i.peerRecordEnvelope,0,i.peerRecordEnvelope.length):n.bytes===Array?Array.prototype.slice.call(i.peerRecordEnvelope):i.peerRecordEnvelope,n.oneofs&&(s._peerRecordEnvelope="peerRecordEnvelope")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,hu.default.util.toJSONOptions)},r})(),d6t=Ii.Address=(()=>{function r(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.multiaddr=ar.newBuffer([]),r.prototype.isCertified=null;let e;return Object.defineProperty(r.prototype,"_isCertified",{get:ar.oneOfGetter(e=["isCertified"]),set:ar.oneOfSetter(e)}),r.encode=function(i,n){return n||(n=CR.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),i.isCertified!=null&&Object.hasOwnProperty.call(i,"isCertified")&&n.uint32(16).bool(i.isCertified),n},r.decode=function(i,n){i instanceof B0||(i=B0.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ii.Address;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;case 2:o.isCertified=i.bool();break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof Ii.Address)return i;var n=new Ii.Address;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?ar.base64.decode(i.multiaddr,n.multiaddr=ar.newBuffer(ar.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),i.isCertified!=null&&(n.isCertified=Boolean(i.isCertified)),n},r.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=ar.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?ar.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),i.isCertified!=null&&i.hasOwnProperty("isCertified")&&(s.isCertified=i.isCertified,n.oneofs&&(s._isCertified="isCertified")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,hu.default.util.toJSONOptions)},r})(),h6t=Ii.Metadata=(()=>{function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.key="",r.prototype.value=ar.newBuffer([]),r.encode=function(t,i){return i||(i=CR.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&i.uint32(10).string(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(18).bytes(t.value),i},r.decode=function(t,i){t instanceof B0||(t=B0.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Ii.Metadata;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.key=t.string();break;case 2:s.value=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Ii.Metadata)return t;var i=new Ii.Metadata;return t.key!=null&&(i.key=String(t.key)),t.value!=null&&(typeof t.value=="string"?ar.base64.decode(t.value,i.value=ar.newBuffer(ar.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.key="",i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=ar.newBuffer(n.value)))),t.key!=null&&t.hasOwnProperty("key")&&(n.key=t.key),t.value!=null&&t.hasOwnProperty("value")&&(n.value=i.bytes===String?ar.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,hu.default.util.toJSONOptions)},r})();l();var Md=A(Br()),tZ=Md.default.Reader,Ske=Md.default.Writer,Vr=Md.default.util,o5=Md.default.roots.default||(Md.default.roots.default={}),rZ=o5.Envelope=(()=>{function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.publicKey=Vr.newBuffer([]),r.prototype.payloadType=Vr.newBuffer([]),r.prototype.payload=Vr.newBuffer([]),r.prototype.signature=Vr.newBuffer([]),r.encode=function(t,i){return i||(i=Ske.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&i.uint32(10).bytes(t.publicKey),t.payloadType!=null&&Object.hasOwnProperty.call(t,"payloadType")&&i.uint32(18).bytes(t.payloadType),t.payload!=null&&Object.hasOwnProperty.call(t,"payload")&&i.uint32(26).bytes(t.payload),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&i.uint32(42).bytes(t.signature),i},r.decode=function(t,i){t instanceof tZ||(t=tZ.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new o5.Envelope;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.publicKey=t.bytes();break;case 2:s.payloadType=t.bytes();break;case 3:s.payload=t.bytes();break;case 5:s.signature=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof o5.Envelope)return t;var i=new o5.Envelope;return t.publicKey!=null&&(typeof t.publicKey=="string"?Vr.base64.decode(t.publicKey,i.publicKey=Vr.newBuffer(Vr.base64.length(t.publicKey)),0):t.publicKey.length&&(i.publicKey=t.publicKey)),t.payloadType!=null&&(typeof t.payloadType=="string"?Vr.base64.decode(t.payloadType,i.payloadType=Vr.newBuffer(Vr.base64.length(t.payloadType)),0):t.payloadType.length&&(i.payloadType=t.payloadType)),t.payload!=null&&(typeof t.payload=="string"?Vr.base64.decode(t.payload,i.payload=Vr.newBuffer(Vr.base64.length(t.payload)),0):t.payload.length&&(i.payload=t.payload)),t.signature!=null&&(typeof t.signature=="string"?Vr.base64.decode(t.signature,i.signature=Vr.newBuffer(Vr.base64.length(t.signature)),0):t.signature.length&&(i.signature=t.signature)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=Vr.newBuffer(n.publicKey))),i.bytes===String?n.payloadType="":(n.payloadType=[],i.bytes!==Array&&(n.payloadType=Vr.newBuffer(n.payloadType))),i.bytes===String?n.payload="":(n.payload=[],i.bytes!==Array&&(n.payload=Vr.newBuffer(n.payload))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=Vr.newBuffer(n.signature)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?Vr.base64.encode(t.publicKey,0,t.publicKey.length):i.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.payloadType!=null&&t.hasOwnProperty("payloadType")&&(n.payloadType=i.bytes===String?Vr.base64.encode(t.payloadType,0,t.payloadType.length):i.bytes===Array?Array.prototype.slice.call(t.payloadType):t.payloadType),t.payload!=null&&t.hasOwnProperty("payload")&&(n.payload=i.bytes===String?Vr.base64.encode(t.payload,0,t.payload.length):i.bytes===Array?Array.prototype.slice.call(t.payload):t.payload),t.signature!=null&&t.hasOwnProperty("signature")&&(n.signature=i.bytes===String?Vr.base64.encode(t.signature,0,t.signature.length):i.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Md.default.util.toJSONOptions)},r})();l();var Kl=A(Br()),a5=Kl.default.Reader,iZ=Kl.default.Writer,ei=Kl.default.util,sa=Kl.default.roots.default||(Kl.default.roots.default={}),nZ=sa.PeerRecord=(()=>{function r(e){if(this.addresses=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.peerId=ei.newBuffer([]),r.prototype.seq=ei.Long?ei.Long.fromBits(0,0,!0):0,r.prototype.addresses=ei.emptyArray,r.encode=function(t,i){if(i||(i=iZ.create()),t.peerId!=null&&Object.hasOwnProperty.call(t,"peerId")&&i.uint32(10).bytes(t.peerId),t.seq!=null&&Object.hasOwnProperty.call(t,"seq")&&i.uint32(16).uint64(t.seq),t.addresses!=null&&t.addresses.length)for(var n=0;n<t.addresses.length;++n)sa.PeerRecord.AddressInfo.encode(t.addresses[n],i.uint32(26).fork()).ldelim();return i},r.decode=function(t,i){t instanceof a5||(t=a5.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new sa.PeerRecord;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.peerId=t.bytes();break;case 2:s.seq=t.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(sa.PeerRecord.AddressInfo.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof sa.PeerRecord)return t;var i=new sa.PeerRecord;if(t.peerId!=null&&(typeof t.peerId=="string"?ei.base64.decode(t.peerId,i.peerId=ei.newBuffer(ei.base64.length(t.peerId)),0):t.peerId.length&&(i.peerId=t.peerId)),t.seq!=null&&(ei.Long?(i.seq=ei.Long.fromValue(t.seq)).unsigned=!0:typeof t.seq=="string"?i.seq=parseInt(t.seq,10):typeof t.seq=="number"?i.seq=t.seq:typeof t.seq=="object"&&(i.seq=new ei.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0))),t.addresses){if(!Array.isArray(t.addresses))throw TypeError(".PeerRecord.addresses: array expected");i.addresses=[];for(var n=0;n<t.addresses.length;++n){if(typeof t.addresses[n]!="object")throw TypeError(".PeerRecord.addresses: object expected");i.addresses[n]=sa.PeerRecord.AddressInfo.fromObject(t.addresses[n])}}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addresses=[]),i.defaults)if(i.bytes===String?n.peerId="":(n.peerId=[],i.bytes!==Array&&(n.peerId=ei.newBuffer(n.peerId))),ei.Long){var s=new ei.Long(0,0,!0);n.seq=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.seq=i.longs===String?"0":0;if(t.peerId!=null&&t.hasOwnProperty("peerId")&&(n.peerId=i.bytes===String?ei.base64.encode(t.peerId,0,t.peerId.length):i.bytes===Array?Array.prototype.slice.call(t.peerId):t.peerId),t.seq!=null&&t.hasOwnProperty("seq")&&(typeof t.seq=="number"?n.seq=i.longs===String?String(t.seq):t.seq:n.seq=i.longs===String?ei.Long.prototype.toString.call(t.seq):i.longs===Number?new ei.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0):t.seq),t.addresses&&t.addresses.length){n.addresses=[];for(var o=0;o<t.addresses.length;++o)n.addresses[o]=sa.PeerRecord.AddressInfo.toObject(t.addresses[o],i)}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Kl.default.util.toJSONOptions)},r.AddressInfo=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.multiaddr=ei.newBuffer([]),e.encode=function(i,n){return n||(n=iZ.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),n},e.decode=function(i,n){i instanceof a5||(i=a5.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new sa.PeerRecord.AddressInfo;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof sa.PeerRecord.AddressInfo)return i;var n=new sa.PeerRecord.AddressInfo;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?ei.base64.decode(i.multiaddr,n.multiaddr=ei.newBuffer(ei.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=ei.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?ei.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Kl.default.util.toJSONOptions)},e}(),r})();var DR=A(lt());kR.default.util.Long=void 0;kR.default.configure();async function Ake(r,e=()=>{}){e(0,"Storing each peerstore key under a single datastore key"),await r.datastore.open();let t={},i=[];for await(let{key:n,value:s}of r.datastore.query({prefix:"/peers"})){i.push(n);let o=n.toString(),[a,c,u,f,d]=o.split("/");if(c==="peers"&&!!["protos","addrs","metadata","keys"].includes(u)&&!!f)if(t[f]=t[f]||{addresses:[],protocols:[],metadata:[]},u==="protos"){let h=IR.decode(s);t[f].protocols=h.protocols.sort()}else if(u==="addrs"){let h=PR.decode(s);t[f].addresses=h.addrs.sort((p,y)=>new DR.Multiaddr(p.multiaddr).toString().localeCompare(new DR.Multiaddr(y.multiaddr).toString())),h.certifiedRecord&&h.certifiedRecord.raw&&(t[f].peerRecordEnvelope=h.certifiedRecord.raw)}else u==="metadata"?t[f].metadata.push({key:d,value:s}):u==="keys"&&(t[f].pubKey=s)}e(33,"Read peer data from store");for(let n of i)await r.datastore.delete(n);e(66,"Removed existing peer data from store");for(let n of Object.keys(t)){let s=t[n];s.metadata=s.metadata.sort((a,c)=>a.key.localeCompare(c.key));let o=OR.encode(s).finish();await r.datastore.put(new xe(`/peers/${n}`),o)}await r.datastore.close(),e(100,"Stored each peerstore key under a single datastore key")}async function Rke(r,e=()=>{}){e(0,"Storing each peerstore key under a multiple datastore keys"),await r.datastore.open();let t={},i=[];for await(let{key:n,value:s}of r.datastore.query({prefix:"/peers"})){i.push(n);let o=n.toString(),[a,c,u]=o.split("/");t[u]=OR.decode(s)}e(33,"Read peer data from store");for(let n of i)await r.datastore.delete(n);e(66,"Removed existing peer data from store");for(let[n,s]of Object.entries(t)){if(s.protocols&&s.protocols.length>0&&await r.datastore.put(new xe(`/peers/protos/${n}`),IR.encode({protocols:s.protocols}).finish()),s.addresses&&s.addresses.length>0){let o=s.peerRecordEnvelope,a;if(o){let c=rZ.decode(o),u=nZ.decode(c.payload);a={raw:o,seq:u.seq}}await r.datastore.put(new xe(`/peers/addrs/${n}`),PR.encode({addrs:s.addresses,certifiedRecord:a}).finish())}if(s.metadata&&s.metadata.length>0)for(let{key:o,value:a}of s.metadata)await r.datastore.put(new xe(`/peers/metadata/${n}/${o}`),a);s.pubKey&&await r.datastore.put(new xe(`/peers/keys/${n}`),s.pubKey)}await r.datastore.close(),e(100,"Stored each peerstore key under multiple datastore keys")}var sZ={version:12,description:"Store each peerstore peer under a single datastore key",migrate:Ake,revert:Rke};var jd={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0},c5=[Object.assign({version:1},jd),Object.assign({version:2},jd),Object.assign({version:3},jd),Object.assign({version:4},jd),Object.assign({version:5},jd),Object.assign({version:6},jd),Object.assign({version:7},jd),MQ,GQ,QQ,JQ,sZ];l();l();var oZ=A(le());var NR={};Pt(NR,{InvalidValueError:()=>Og,MissingRepoOptionsError:()=>pu,NonReversibleMigrationError:()=>Pg,NotInitializedRepoError:()=>qd,RequiredParameterError:()=>Cg});l();var Pg=class extends Error{constructor(e){super(e);this.name="NonReversibleMigrationError",this.code=Pg.code,this.message=e}};Pg.code="ERR_NON_REVERSIBLE_MIGRATION";var qd=class extends Error{constructor(e){super(e);this.name="NotInitializedRepoError",this.code=qd.code,this.message=e}};qd.code="ERR_NOT_INITIALIZED_REPO";var Cg=class extends Error{constructor(e){super(e);this.name="RequiredParameterError",this.code=Cg.code,this.message=e}};Cg.code="ERR_REQUIRED_PARAMETER";var Og=class extends Error{constructor(e){super(e);this.name="InvalidValueError",this.code=Og.code,this.message=e}};Og.code="ERR_INVALID_VALUE";var pu=class extends Error{constructor(e){super(e);this.name="MissingRepoOptionsError",this.code=pu.code,this.message=e}};pu.code="ERR_MISSING_REPO_OPTIONS";var BR=(0,oZ.default)("ipfs:repo:migrator:repo:init");async function aZ(r){if(!r)throw new pu("Please pass repo options when trying to open a repo");let e=r.root;try{await e.open();let t=await e.has(Ig),i=await e.has(WQ);return!t||!i?(BR(`Version entry present: ${t}`),BR(`Config entry present: ${i}`),!1):!0}catch(t){return BR("While checking if repo is initialized error was thrown: "+t.message),!1}finally{if(e!==void 0)try{await e.close()}catch{}}}at();et();async function LR(r){if(!await aZ(r))throw new qd("Repo is not initialized!");let e=r.root;await e.open();try{return parseInt($e(await e.get(Ig)))}finally{await e.close()}}async function kg(r,e){if(!e)throw new pu("Please pass repo options when trying to open a repo");let t=e.root;await t.open(),await t.put(Ig,Qe(String(r))),await t.close()}var cZ=A(le()),oa=(0,cZ.default)("ipfs:repo:migrator");function xke(r){return r=r||c5,!Array.isArray(r)||r.length===0?0:r[r.length-1].version}async function uZ(r,e,t,i,{ignoreLock:n=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||c5,!r)throw new lo.RequiredParameterError("Path argument is required!");if(!t)throw new lo.RequiredParameterError("repoOptions argument is required!");if(!i)throw new lo.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(i)||i<=0)throw new lo.InvalidValueError("Version has to be positive integer!");e=xR(e);let c=await LR(e);if(c===i){oa("Nothing to migrate.");return}if(c>i)throw new lo.InvalidValueError(`Current repo's version (${c}) is higher then toVersion (${i}), you probably wanted to revert it?`);fZ(a,c,i);let u;!o&&!n&&(u=await t.repoLock.lock(r));try{for(let f of a){if(i!==void 0&&f.version>i)break;if(!(f.version<=c)){oa(`Migrating version ${f.version}`);try{if(!o){let d=()=>{};s&&(d=(h,p)=>s(f.version,h.toFixed(2),p)),await f.migrate(e,d)}}catch(d){let h=f.version-1;throw oa(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${h}`),await kg(h,e),new Error(`During migration to version ${f.version} exception was raised: ${d.stack||d.message||d}`)}oa(`Migrating to version ${f.version} finished`)}}o||await kg(i||xke(a),e),oa("Repo successfully migrated",i!==void 0?`to version ${i}!`:"to latest version!")}finally{!o&&!n&&u&&await u.close()}}async function lZ(r,e,t,i,{ignoreLock:n=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||c5,!r)throw new lo.RequiredParameterError("Path argument is required!");if(!t)throw new lo.RequiredParameterError("repoOptions argument is required!");if(!i)throw new lo.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(i)||i<=0)throw new lo.InvalidValueError("Version has to be positive integer!");e=xR(e);let c=await LR(e);if(c===i){oa("Nothing to revert.");return}if(c<i)throw new lo.InvalidValueError(`Current repo's version (${c}) is lower then toVersion (${i}), you probably wanted to migrate it?`);fZ(a,i,c,!0);let u;!o&&!n&&(u=await t.repoLock.lock(r)),oa(`Reverting from version ${c} to ${i}`);try{let f=a.slice().reverse();for(let d of f){if(d.version<=i)break;if(!(d.version>c)){oa(`Reverting migration version ${d.version}`);try{if(!o){let h=()=>{};s&&(h=(p,y)=>s(d.version,p.toFixed(2),y)),await d.revert(e,h)}}catch(h){let p=d.version;throw oa(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${p}`),await kg(p,e),h.message=`During reversion to version ${d.version} exception was raised: ${h.message}`,h}oa(`Reverting to version ${d.version} finished`)}}o||await kg(i,e),oa(`All migrations successfully reverted to version ${i}!`)}finally{!o&&!n&&u&&await u.close()}}function fZ(r,e,t,i=!1){let n=0;for(let s of r){if(s.version>t)break;if(s.version>e){if(i&&!s.revert)throw new lo.NonReversibleMigrationError(`It is not possible to revert to version ${e} because migration version ${s.version} is not reversible. Cancelling reversion.`);n++}}if(n!==t-e)throw new lo.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${e} to ${t}`)}var lo=NR;var JZ=A(pZ());l();Mr();var bZ=A(le());et();at();l();l();var L0=class extends Error{constructor(e){super(e);this.name="LockExistsError",this.code=L0.code}};L0.code="ERR_LOCK_EXISTS";var fo=class extends Error{constructor(e){super(e);this.name="NotFoundError",this.code=fo.code}};fo.code="ERR_NOT_FOUND";var M0=class extends Error{constructor(e){super(e);this.name="InvalidRepoVersionError",this.code=M0.code}};M0.code="ERR_INVALID_REPO_VERSION";var Ud="ERR_REPO_NOT_INITIALIZED",yZ="ERR_REPO_ALREADY_OPEN",gZ="ERR_REPO_ALREADY_CLOSED";async function l5(r,e,t){let i=await e(r);if(i)return i;let n=mZ(t);return n?new Promise((s,o)=>{let a=n.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{s(Boolean(a.result))}}):!1}async function f5(r,e,t,i){if(await t(r))return e(r);let n=mZ(i);if(!n)throw new fo;return new Promise((s,o)=>{let a=n.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return s(a.result);o(new fo)}})}function mZ(r){let e=r;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}var Oke=(0,bZ.default)("ipfs:repo:version"),MR=new xe("version");function wZ(r){return{async exists(){return l5(MR,r.has.bind(r),r)},async get(){let e=await f5(MR,r.get.bind(r),r.has.bind(r),r);return parseInt($e(e),10)},set(e){return r.put(MR,Qe(String(e)))},async check(e){let t=await this.get();return Oke("comparing version: %s and %s",t,e),t===e||(t===6&&e===7||e===6&&t===7)}}}l();Mr();var d5=A(Go()),_Z=A(_R()),vZ=A(UA()),h5=A(Dd());et();at();var kke=d5.default.default?d5.default.default:d5.default,jR=new xe("config");function EZ(r){let e=new kke({concurrency:1}),t={async getAll(s={}){let o=await f5(jR,r.get.bind(r),r.has.bind(r),r);return JSON.parse($e(o))},async get(s,o={}){if(s==null)throw new fo(`Key ${s} does not exist in config`);let a=await this.getAll(o),c=(0,_Z.default)(a,s);if(c===void 0)throw new fo(`Key ${s} does not exist in config`);return c},set(s,o,a={}){if(typeof s!="string"&&!(s instanceof String))throw(0,h5.default)(new Error("Invalid key type: "+typeof s),"ERR_INVALID_KEY");if(o===void 0||o instanceof Uint8Array)throw(0,h5.default)(new Error("Invalid value type: "+typeof o),"ERR_INVALID_VALUE");return e.add(()=>i({key:s,value:o},a.signal))},replace(s,o={}){if(!s||s instanceof Uint8Array)throw(0,h5.default)(new Error("Invalid value type: "+typeof s),"ERR_INVALID_VALUE");return e.add(()=>i({key:void 0,value:s},o.signal))},async exists(){return l5(jR,r.has.bind(r),r)}};return t;async function i(s,o){if(o&&o.aborted)return;let a=s.key,c=s.value;if(a){let u=await t.getAll();return typeof u=="object"&&u!==null&&(0,vZ.default)(u,a,c),n(u)}return n(c)}function n(s){let o=Qe(JSON.stringify(s,null,2));return r.put(jR,o)}}l();Xp();var IZ=A(xZ());et();at();var UR=new xe("datastore_spec");function TZ(r){return{exists(){return r.has(UR)},async get(){let e=await r.get(UR);return JSON.parse($e(e))},async set(e){return r.put(UR,Qe(JSON.stringify((0,IZ.default)(e,{deep:!0}))))}}}l();Mr();at();var FR=new xe("api");function PZ(r){return{async get(){let e=await r.get(FR);return e&&e.toString()},set(e){return r.put(FR,Qe(e.toString()))},delete(){return r.delete(FR)}}}l();var CZ=A(is()),OZ=A(Za()),kZ=A(rs());we();var DZ=A(Dd());Hc();function NZ(r){return{open(){return r.open()},close(){return r.close()},query(e,t){return r.query(e,t)},queryKeys(e,t){return r.queryKeys(e,t)},async get(e,t){let i=zl(e);return i.isIdentity?Promise.resolve(i.digest):r.get(e,t)},async*getMany(e,t){for await(let i of e)yield this.get(i,t)},async put(e,t,i){let{isIdentity:n}=zl(e);n||await r.put(e,t,i)},async*putMany(e,t){let i=(0,OZ.default)();(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{await(0,kZ.default)(r.putMany(async function*(){for await(let{key:s,value:o}of e)zl(s).isIdentity||(yield{key:s,value:o}),i.push({key:s,value:o})}())),i.end()}catch(s){i.end(s)}}),yield*i},has(e,t){let{isIdentity:i}=zl(e);return i?Promise.resolve(!0):r.has(e,t)},delete(e,t){let{isIdentity:i}=zl(e);return i?Promise.resolve():r.delete(e,t)},deleteMany(e,t){return r.deleteMany((0,CZ.default)(e,i=>!zl(i).isIdentity),t)},batch(){let e=r.batch();return{put(t,i){let{isIdentity:n}=zl(t);n||e.put(t,i)},delete(t){let{isIdentity:i}=zl(t);i||e.delete(t)},commit:t=>e.commit(t)}}}}function zl(r){let e=L.asCID(r);if(e==null)throw(0,DZ.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return e.multihash.code!==bs.code?{isIdentity:!1}:{isIdentity:!0,digest:e.multihash.digest}}l();l();var BZ=A(le()),LZ=(0,BZ.default)("ipfs:repo:lock:memory"),MZ="repo.lock",Dg={};async function Dke(r){let e=r+"/"+MZ;if(LZ("locking %s",e),Dg[e]===!0)throw new L0(`Lock already being held for file: ${e}`);return Dg[e]=!0,{async close(){Dg[e]&&delete Dg[e]}}}async function Nke(r){let e=r+"/"+MZ;return LZ(`checking lock: ${e}`),Boolean(Dg[e])}var p5={lock:Dke,locked:Nke};var jZ={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:p5};l();var KR={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};l();we();var FZ=A(Dd()),KZ=A(le()),zR=A(Td());Ju();l();Mr();up();Vs();var qZ=A(Dd());rn();tn();function Ng(r){let e=L.asCID(r);if(e==null)throw(0,qZ.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");let t=lr.encode(e.multihash.bytes);return new xe("/"+t.slice(1).toUpperCase(),!1)}function VR(r){return fi(lr.decode(`b${r.toString().toLowerCase().substring(1)}`))}l();var UZ=A(le());var Bke=(0,UZ.default)("ipfs:repo:utils:walk-dag");async function*j0(r,e,t,i){try{let n=await e.get(r,i),s=await t(r.code),o=E0({bytes:n,cid:r,codec:s});for(let[,a]of o.links())yield a,yield*j0(a,e,t,i)}catch(n){throw Bke("Could not walk DAG for CID",r.toString(),n),n}}function Lke(r){let e=`Invalid type '${r}', must be one of {direct, indirect, recursive, all}`;return(0,FZ.default)(new Error(e),"ERR_INVALID_PIN_TYPE")}var HR=class{constructor({pinstore:e,blockstore:t,loadCodec:i}){this.pinstore=e,this.blockstore=t,this.loadCodec=i,this.log=(0,KZ.default)("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,t={}){await this.blockstore.get(e,t);let i={depth:0};return e.version!==0&&(i.version=e.version),e.code!==wt&&(i.codec=e.code),t.metadata&&(i.metadata=t.metadata),this.pinstore.put(Ng(e),Wn(i))}unpin(e,t){return this.pinstore.delete(Ng(e),t)}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);let i={depth:1/0};e.version!==0&&(i.version=e.version),e.code!==wt&&(i.codec=e.code),t.metadata&&(i.metadata=t.metadata),await this.pinstore.put(Ng(e),Wn(i))}async*directKeys(e){for await(let t of this.pinstore.query({filters:[i=>vi(i.value).depth===0]})){let i=vi(t.value),n=i.version||0,s=i.codec!=null?i.codec:wt,o=VR(t.key);yield{cid:L.create(n,s,o),metadata:i.metadata}}}async*recursiveKeys(e){for await(let t of this.pinstore.query({filters:[i=>vi(i.value).depth===1/0]})){let i=vi(t.value),n=i.version||0,s=i.codec!=null?i.codec:wt,o=VR(t.key);yield{cid:L.create(n,s,o),metadata:i.metadata}}}async*indirectKeys(e){for await(let{cid:t}of this.recursiveKeys())for await(let i of j0(t,this.blockstore,this.loadCodec,e)){let n=[Ot.recursive];(await this.isPinnedWithType(i,n)).pinned||(yield i)}}async isPinnedWithType(e,t,i){Array.isArray(t)||(t=[t]);let n=t.includes(Ot.all),s=t.includes(Ot.direct),o=t.includes(Ot.recursive),a=t.includes(Ot.indirect);if(o||s||n){let f=await(0,zR.default)(this.pinstore.query({prefix:Ng(e).toString(),filters:[d=>{if(n)return!0;let h=vi(d.value);return t.includes(h.depth===0?Ot.direct:Ot.recursive)}],limit:1}));if(f){let d=vi(f.value);return{cid:e,pinned:!0,reason:d.depth===0?Ot.direct:Ot.recursive,metadata:d.metadata}}}let c=this;async function*u(f,d){for await(let{cid:h}of d)for await(let p of j0(h,c.blockstore,c.loadCodec))if(p.equals(f)){yield h;return}}if(n||a){let f=await(0,zR.default)(u(e,this.recursiveKeys()));if(f)return{cid:e,pinned:!0,reason:Ot.indirect,parent:f}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t){let i=new Set,n=async(s,o)=>{if(i.has(s.toString()))return;i.add(s.toString());let a=await this.blockstore.get(s,o),c=await this.loadCodec(s.code),u=E0({bytes:a,cid:s,codec:c});await Promise.all([...u.links()].map(([,f])=>n(f,o)))};await n(e,t)}static checkPinType(e){if(typeof e!="string"||!Object.keys(Ot).includes(e))throw Lke(e);return!0}};l();var VZ=A(wn()),zZ=A(Dd());function HZ(r,e){return{open(){return e.open()},close(){return e.close()},query(t,i){return e.query(t,i)},queryKeys(t,i){return e.queryKeys(t,i)},async get(t,i){return e.get(t,i)},async*getMany(t,i){yield*e.getMany(t,i)},async put(t,i,n){await e.put(t,i,n)},async*putMany(t,i){yield*e.putMany(t,i)},has(t,i){return e.has(t,i)},async delete(t,i){return await $Z(t,r),e.delete(t,i)},deleteMany(t,i){return e.deleteMany((0,VZ.default)(t,async n=>(await $Z(n,r),n)),i)},batch(){return e.batch()}}}async function $Z(r,e){let{pinned:t,reason:i}=await e.isPinnedWithType(r,Ot.all);if(t)throw(0,zZ.default)(new Error(`pinned: ${i}`),"ERR_BLOCK_PINNED")}var eJ=A(z6());l();we();var GZ=A(le());eo();var WZ=A(Qb()),YZ=A(dr()),$R=A(Al()),y5=A(wn()),XZ=A(is());Mr();rn();var Bg=(0,GZ.default)("ipfs:repo:gc"),Mke=xi().code,jke=256,qke=new xe("/local/filesroot");function QZ({gcLock:r,pins:e,blockstore:t,root:i,loadCodec:n}){async function*s(){let o=Date.now();Bg("Creating set of marked blocks");let a=await r.writeLock();try{let c=await Uke({pins:e,blockstore:t,root:i,loadCodec:n}),u=t.queryKeys({});yield*Fke({blockstore:t},c,u),Bg(`Complete (${Date.now()-o}ms)`)}finally{a()}}return s}async function Uke({pins:r,blockstore:e,loadCodec:t,root:i}){let n=async function*(){let a;try{a=await i.get(qke)}catch(u){if(u.code===Mke){Bg("No blocks in MFS");return}throw u}let c=L.decode(a);yield c,yield*j0(c,e,t)}(),s=(0,$R.default)((0,y5.default)(r.recursiveKeys(),({cid:a})=>a),r.indirectKeys(),(0,y5.default)(r.directKeys(),({cid:a})=>a),n),o=new Set;for await(let a of(0,$R.default)(s,n))o.add(lr.encode(a.multihash.bytes));return o}async function*Fke({blockstore:r},e,t){let i=0,n=0;yield*(0,YZ.pipe)((0,WZ.default)((0,y5.default)(t,async o=>async function(){i++;try{let c=lr.encode(o.multihash.bytes);if(e.has(c))return null;try{await r.delete(o),n++}catch(u){return{err:new Error(`Could not delete block with CID ${o}: ${u.message}`)}}return{cid:o}}catch(c){let u=`Could delete block with CID ${o}`;return Bg(u,c),{err:new Error(u+`: ${c.message}`)}}}),jke),o=>(0,XZ.default)(o,Boolean)),Bg(`Marked set has ${e.size} unique blocks. Blockstore has ${i} blocks. Deleted ${n} blocks.`)}var os=(0,ZZ.default)("ipfs:repo"),Kke=Number.MAX_SAFE_INTEGER,Vke="repoAutoMigrate",tJ=class{constructor(e,t,i,n){if(typeof e!="string")throw new Error("missing repo path");if(typeof t!="function")throw new Error("missing codec loader");this.options=Ct(jZ,n),this.closed=!0,this.path=e,this.root=i.root,this.datastore=i.datastore,this.keys=i.keys;let s=i.blocks,o=i.pins;this.pins=new HR({pinstore:o,blockstore:s,loadCodec:t});let a=HZ(this.pins,s);this.blocks=NZ(a),this.version=wZ(this.root),this.config=EZ(this.root),this.spec=TZ(this.root),this.apiAddr=PZ(this.root),this.gcLock=(0,eJ.default)(e,{singleProcess:this.options.repoOwner!==!1}),this.gc=QZ({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:t})}async init(e){os("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(zke(e)),await this.spec.set(Hke(e)),await this.version.set(D0)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch(e){return!1}}async open(){if(!this.closed)throw(0,Fd.default)(new Error("repo is already open"),yZ);os("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),os("acquired repo.lock"),!await this.version.check(D0))if(await this._isAutoMigrationEnabled())await this._migrate(D0,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new M0("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");os("creating datastore"),await this.datastore.open(),os("creating blocks"),await this.blocks.open(),os("creating keystore"),await this.keys.open(),os("creating pins"),await this.pins.pinstore.open(),this.closed=!1,os("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(t){os("error removing lock",t)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(){let e=await this.options.repoLock.lock(this.path);if(typeof e.close!="function")throw(0,Fd.default)(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){os("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(t){throw t.code==="ERR_NOT_FOUND"?(0,Fd.default)(new Error("repo is not initialized yet"),Ud,{path:this.path}):t}if(!e)throw(0,Fd.default)(new Error("repo is not initialized yet"),Ud,{path:this.path})}async close(){if(this.closed)throw(0,Fd.default)(new Error("repo is already closed"),gZ);os("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==Ud&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(e=>e&&e.close())),os("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[e,t,i,n,s]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),rJ(this.datastore),rJ(this.keys)]),o=t.size+n+s;return{repoPath:this.path,storageMax:e,version:i,numObjects:t.count,repoSize:o}}throw(0,Fd.default)(new Error("repo is not initialized yet"),Ud,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(Vke)}catch(t){if(t.code===fo.code)e=!0;else throw t}return e}async _migrate(e,t){return await this.version.get()>e?(os(`reverting to version ${e}`),lZ(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(os(`migrating to version ${e}`),uZ(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let e=await this.config.get("Datastore.StorageMax");return BigInt((0,JZ.default)(e))}catch(e){return BigInt(Kke)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(let{key:i,value:n}of this.blocks.query({}))e+=BigInt(1),t+=BigInt(n.byteLength),t+=BigInt(i.bytes.byteLength);return{count:e,size:t}}};async function rJ(r){let e=BigInt(0);for await(let t of r.query({}))e+=BigInt(t.value.byteLength),e+=BigInt(t.key.uint8Array().byteLength);return e}function iJ(r,e,t,i){return new tJ(r,e,t,i)}function zke(r){return r.Datastore=Object.assign({},KR,(0,GR.default)(r,"datastore")),r}function Hke(r){let e={...KR.Spec,...(0,GR.default)(r,"Datastore.Spec")};return{type:e.type,mounts:e.mounts.map(t=>({mountpoint:t.mountpoint,type:t.child.type,path:t.child.path,shardFunc:t.child.shardFunc}))}}l();Xp();Ob();var nm=A(is()),jre=A(wn()),mI=A(fd()),bI=A(WR()),qre=A(Mre()),ih=class extends sn{constructor(e,t){super();this.path=e,this.opts=t,t&&t.db?(this.database=t.db,delete t.db):this.database=qre.default}_initDb(){return new Promise((e,t)=>{this.db=this.database(this.path,{...this.opts,valueEncoding:"binary",compression:!1},i=>{if(i)return t(i);e(this.db)})})}async open(){try{this.db?await this.db.open():this.db=await this._initDb()}catch(e){throw yd.dbOpenFailedError(e)}}async put(e,t){try{await this.db.put(e.toString(),t)}catch(i){throw yd.dbWriteFailedError(i)}}async get(e){let t;try{t=await this.db.get(e.toString())}catch(i){throw i.notFound?yd.notFoundError(i):yd.dbWriteFailedError(i)}return t}async has(e){try{await this.db.get(e.toString())}catch(t){if(t.notFound)return!1;throw t}return!0}async delete(e){try{await this.db.del(e.toString())}catch(t){throw yd.dbDeleteFailedError(t)}}close(){return this.db&&this.db.close()}batch(){let e=[];return{put:(t,i)=>{e.push({type:"put",key:t.toString(),value:i})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce((s,o)=>(0,nm.default)(s,o),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((s,o)=>(0,bI.default)(s,o),t));let{offset:i,limit:n}=e;if(i){let s=0;t=(0,nm.default)(t,()=>s++>=i)}return n&&(t=(0,mI.default)(t,n)),t}queryKeys(e){let t=(0,jre.default)(this._query({values:!1,prefix:e.prefix}),({key:s})=>s);Array.isArray(e.filters)&&(t=e.filters.reduce((s,o)=>(0,nm.default)(s,o),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((s,o)=>(0,bI.default)(s,o),t));let{offset:i,limit:n}=e;if(i){let s=0;t=(0,nm.default)(t,()=>s++>=i)}return n&&(t=(0,mI.default)(t,n)),t}_query(e){let t={keys:!0,keyAsBuffer:!0,values:e.values};if(e.prefix!=null){let i=e.prefix.toString();t.gte=i,t.lt=i+"\xFF"}return AMe(this.db.iterator(t))}};function AMe(r){return{[Symbol.asyncIterator](){return{next:()=>new Promise((e,t)=>{r.next((i,n,s)=>{if(i)return t(i);if(n==null)return r.end(o=>{if(o)return t(o);e({done:!0,value:void 0})});e({done:!1,value:{key:new xe(n,!1),value:s}})})}),return:()=>new Promise((e,t)=>{r.end(i=>{if(i)return t(i);e({done:!0,value:void 0})})})}}}}l();var vI=A(rs()),EI=A(Za());Mr();we();Vs();tn();rn();di();var Hre=A(Kre());l();var wI=A(rs()),nh=A(is()),_I=A(fd()),Vre=A(Jo()),zre=(r,e)=>async function*(){yield*(await(0,Vre.default)(r)).sort(e)}(),wu=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,i){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:i,value:n}of e)await this.put(i,n,t),yield{key:i,value:n}}async*getMany(e,t={}){for await(let i of e)yield this.get(i,t)}async*deleteMany(e,t={}){for await(let i of e)await this.delete(i,t),yield i}batch(){let e=[],t=[];return{put(i,n){e.push({key:i,value:n})},delete(i){t.push(i)},commit:async i=>{await(0,wI.default)(this.putMany(e,i)),e=[],await(0,wI.default)(this.deleteMany(t,i)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let i=this._all(e,t);if(e.prefix!=null&&(i=(0,nh.default)(i,n=>n.key.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>(0,nh.default)(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>zre(n,s),i)),e.offset!=null){let n=0;i=(0,nh.default)(i,()=>n++>=(e.offset||0))}return e.limit!=null&&(i=(0,_I.default)(i,e.limit)),i}queryKeys(e,t){let i=this._allKeys(e,t);if(e.prefix!=null&&(i=(0,nh.default)(i,n=>n.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>(0,nh.default)(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>zre(n,s),i)),e.offset!=null){let n=0;i=(0,nh.default)(i,()=>n++>=e.offset)}return e.limit!=null&&(i=(0,_I.default)(i,e.limit)),i}};function n1(r){let e=L.asCID(r);if(!e)throw(0,Hre.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return new xe("/"+lr.encode(e.multihash.bytes).slice(1).toUpperCase(),!1)}function Zl(r){return L.createV1(Bi,fi(lr.decode("b"+r.toString().slice(1).toLowerCase())))}function SI(r){let e=r.substring(0,1);if(e==="/")return SI(r.substring(1));let t;e.toLowerCase()==="b"?t=s=>lr.decode(s.toLowerCase()).subarray(2):e.toLowerCase()==="c"?t=s=>Nv.decode(s.toLowerCase()).subarray(2):e==="z"?t=s=>yt.decode(s).subarray(2):e==="Q"?t=s=>yt.decode("z"+s):t=s=>lr.decode("b"+s.toLowerCase()).subarray(2);let i;for(let s=1;s<r.length;s++)try{i=t(r.substring(0,s))}catch(o){if(o.message!=="Unexpected end of data")throw o}let n="/C";return i&&(n=`/${lr.encode(i).slice(1,-1).toUpperCase()||"C"}`),n}function xMe(r){return{...r,prefix:r.prefix?SI(r.prefix):void 0,filters:r.filters?r.filters.map(e=>t=>e({key:Zl(t.key),value:t.value})):void 0,orders:r.orders?r.orders.map(e=>(t,i)=>e({key:Zl(t.key),value:t.value},{key:Zl(i.key),value:i.value})):void 0}}function IMe(r){return{...r,prefix:r.prefix?SI(r.prefix):void 0,filters:r.filters?r.filters.map(e=>t=>e(Zl(t))):void 0,orders:r.orders?r.orders.map(e=>(t,i)=>e(Zl(t),Zl(i))):void 0}}var AI=class extends wu{constructor(e){super();this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,t){for await(let{key:i,value:n}of this.child.query(xMe(e),t))yield{key:Zl(i),value:n}}async*queryKeys(e,t){for await(let i of this.child.queryKeys(IMe(e),t))yield Zl(i)}async get(e,t){return this.child.get(n1(e),t)}async*getMany(e,t){for await(let i of e)yield this.get(i,t)}async put(e,t,i){await this.child.put(n1(e),t,i)}async*putMany(e,t){let i=(0,EI.default)();(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{let s=this.child;await(0,vI.default)(this.child.putMany(async function*(){for await(let o of e){let a=n1(o.key);await s.has(a,t)||(yield{key:a,value:o.value}),i.push(o)}}())),i.end()}catch(s){i.end(s)}}),yield*i}has(e,t){return this.child.has(n1(e),t)}delete(e,t){return this.child.delete(n1(e),t)}deleteMany(e,t){let i=(0,EI.default)();return(0,vI.default)(this.child.deleteMany(async function*(){for await(let n of e)yield n1(n),i.push(n);i.end()}(),t)).catch(n=>{i.end(n)}),i}};function $re(r,e,t){let i=t.path||"ipfs";return iJ(i,n=>e.getCodec(n),{root:new ih(i,{prefix:"",version:2}),blocks:new AI(new ih(`${i}/blocks`,{prefix:"",version:2})),datastore:new ih(`${i}/datastore`,{prefix:"",version:2}),keys:new ih(`${i}/keys`,{prefix:"",version:2}),pins:new ih(`${i}/pins`,{prefix:"",version:2})},{autoMigrate:t.autoMigrate,onMigrationProgress:t.onMigrationProgress||r,repoLock:p5})}at();et();var V_=A(st());l();var Wt=A(N2());var _4e=A(St());l();var Vne=A(tT()),rT={gossipsub:Vne.default};var v4e=A(Xne()),E4e=A(rse());l();l();var wqe=r=>Promise.reject(new Error(`No base found for "${r}"`)),lm=class{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||wqe;for(let t of e.bases)this.addBase(t)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];let t=await this._loadBase(e);return this._basesByName[t.name]==null&&this._basesByPrefix[t.prefix]==null&&this.addBase(t),t}listBases(){return Object.values(this._basesByName)}};l();var _qe=r=>Promise.reject(new Error(`No codec found for "${r}"`)),fm=class{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||_qe;for(let t of e.codecs)this.addCodec(t)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){let t=typeof e=="string"?this._codecsByName:this._codecsByCode;if(t[e])return t[e];let i=await this._loadCodec(e);return t[e]==null&&this.addCodec(i),i}listCodecs(){return Object.values(this._codecsByName)}};l();var vqe=r=>Promise.reject(new Error(`No hasher found for "${r}"`)),dm=class{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||vqe;for(let t of e.hashers)this.addHasher(t)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){let t=typeof e=="string"?this._hashersByName:this._hashersByCode;if(t[e])return t[e];let i=await this._loadHasher(e);return t[e]==null&&this.addHasher(i),i}listHashers(){return Object.values(this._hashersByName)}};var Wqe=A(y7());Hc();s4();l();l();we();l();l();var nT=A(lt()),bc=A(my());var ose=A(le()),ch=A(Tp());l();var ise=A(lt()),nse=A(U6());function iT(r){try{r=(0,nse.default)(new ise.Multiaddr(r))}catch(e){}return r=r.toString(),r}l();var sse=()=>{};var ase=(0,ose.default)("ipfs-http-client:lib:error-handler"),Eqe=Ct.bind({ignoreUndefined:!0}),Sqe=bc.isBrowser||bc.isWebWorker?location.protocol:"http",Aqe=bc.isBrowser||bc.isWebWorker?location.hostname:"localhost",Rqe=bc.isBrowser||bc.isWebWorker?location.port:"5001",xqe=(r={})=>{let e,t={},i;if(typeof r=="string"||nT.Multiaddr.isMultiaddr(r))e=new URL(iT(r));else if(r instanceof URL)e=r;else if(typeof r.url=="string"||nT.Multiaddr.isMultiaddr(r.url))e=new URL(iT(r.url)),t=r;else if(r.url instanceof URL)e=r.url,t=r;else{t=r||{};let n=(t.protocol||Sqe).replace(":",""),s=(t.host||Aqe).split(":")[0],o=t.port||Rqe;e=new URL(`${n}://${s}:${o}`)}if(t.apiPath?e.pathname=t.apiPath:(e.pathname==="/"||e.pathname===void 0)&&(e.pathname="api/v0"),bc.isNode){let n=sse(e);i=t.agent||new n({keepAlive:!0,maxSockets:6})}return{...t,host:e.host,protocol:e.protocol.replace(":",""),port:Number(e.port),apiPath:e.pathname,url:e,agent:i}},Iqe=async r=>{let e;try{if((r.headers.get("Content-Type")||"").startsWith("application/json")){let i=await r.json();ase(i),e=i.Message||i.message}else e=await r.text()}catch(i){ase("Failed to parse error response",i),e=i.message}let t=new ch.default.HTTPError(r);throw e&&(e.includes("deadline has elapsed")&&(t=new ch.default.TimeoutError),e&&e.includes("context deadline exceeded")&&(t=new ch.default.TimeoutError)),e&&e.includes("request timed out")&&(t=new ch.default.TimeoutError),e&&(t.message=e),t},Tqe=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,cse=r=>r.replace(Tqe,function(e){return"-"+e.toLowerCase()}),Pqe=r=>typeof r=="string"?sl(r):r,uh=class extends ch.default{constructor(e={}){let t=xqe(e);super({timeout:Pqe(t.timeout||0)||void 0,headers:t.headers,base:`${t.url}`,handleError:Iqe,transformSearchParams:n=>{let s=new URLSearchParams;for(let[o,a]of n)a!=="undefined"&&a!=="null"&&o!=="signal"&&s.append(cse(o),a),o==="timeout"&&!isNaN(a)&&s.append(cse(o),a);return s},agent:t.agent});delete this.get,delete this.put,delete this.delete,delete this.options;let i=this.fetch;this.fetch=(n,s={})=>(typeof n=="string"&&!n.startsWith("/")&&(n=`${t.url}/${n}`),i.call(this,n,Eqe(s,{method:"POST"})))}},X_t=ch.default.HTTPError;var q=r=>e=>r(new uh(e),e);l();l();function Pw(r){if(r!=null)return typeof r=="string"?r:r.toString(8).padStart(4,"0")}l();var fse=A(lh());function Cw(r){if(r==null)return;let e;if(r.secs!=null&&(e={secs:r.secs,nsecs:r.nsecs}),r.Seconds!=null&&(e={secs:r.Seconds,nsecs:r.FractionalNanoseconds}),Array.isArray(r)&&(e={secs:r[0],nsecs:r[1]}),r instanceof Date){let t=r.getTime(),i=Math.floor(t/1e3);e={secs:i,nsecs:(t-i*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw(0,fse.default)(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}function K({arg:r,searchParams:e,hashAlg:t,mtime:i,mode:n,...s}={}){e&&(s={...s,...e}),t&&(s.hash=t),i!=null&&(i=Cw(i),s.mtime=i.secs,s.mtimeNsecs=i.nsecs),n!=null&&(s.mode=Pw(n)),s.timeout&&!isNaN(s.timeout)&&(s.timeout=`${s.timeout}ms`),r==null?r=[]:Array.isArray(r)||(r=[r]);let o=new URLSearchParams(s);return r.forEach(a=>o.append("arg",a)),o}var dse=q(r=>{async function e(t={}){return((await(await r.post("bitswap/wantlist",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()).Keys||[]).map(n=>L.parse(n["/"]))}return e});l();we();var hse=q(r=>{async function e(t,i={}){return((await(await r.post("bitswap/wantlist",{signal:i.signal,searchParams:K({...i,peer:t.toString()}),headers:i.headers})).json()).Keys||[]).map(s=>L.parse(s["/"]))}return e});l();we();var Ow=q(r=>{async function e(t={}){let i=await r.post("bitswap/stat",{searchParams:K(t),signal:t.signal,headers:t.headers});return Oqe(await i.json())}return e});function Oqe(r){return{provideBufLen:r.ProvideBufLen,wantlist:(r.Wantlist||[]).map(e=>L.parse(e["/"])),peers:r.Peers||[],blocksReceived:BigInt(r.BlocksReceived),dataReceived:BigInt(r.DataReceived),blocksSent:BigInt(r.BlocksSent),dataSent:BigInt(r.DataSent),dupBlksReceived:BigInt(r.DupBlksReceived),dupDataReceived:BigInt(r.DupDataReceived)}}l();var pse=q(r=>{async function e(t,i={}){return(await r.post("bitswap/unwant",{signal:i.signal,searchParams:K({arg:t.toString(),...i}),headers:i.headers})).json()}return e});function yse(r){return{wantlist:dse(r),wantlistForPeer:hse(r),unwant:pse(r),stat:Ow(r)}}l();l();var kw=q(r=>{async function e(t,i={}){let n=await r.post("block/get",{signal:i.signal,searchParams:K({arg:t.toString(),...i}),headers:i.headers});return new Uint8Array(await n.arrayBuffer())}return e});l();we();l();l();l();var gse=A(Vf()),mse=A(s0()),bse=A(n0()),wse=A(Jo());async function _se(r){if(so(r))return new Blob([r]);if(typeof r=="string"||r instanceof String)return new Blob([r.toString()]);if(su(r))return r;if(ou(r)&&(r=(0,bse.default)(r)),Symbol.iterator in r||Symbol.asyncIterator in r){let e=(0,mse.default)(r),{value:t,done:i}=await e.peek();if(i)return vse(e);if(e.push(t),Number.isInteger(t))return new Blob([Uint8Array.from(await(0,wse.default)(e))]);if(so(t)||typeof t=="string"||t instanceof String)return vse(e)}throw(0,gse.default)(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT")}async function vse(r){let e=[];for await(let t of r)e.push(t);return new Blob(e)}function Ese(r){return s6(r,_se,!0)}l();function Sse(r){if(r!=null)return typeof r=="string"?r:r.toString(8).padStart(4,"0")}async function Ci(r,e,t={}){let i=[],n=new FormData,s=0,o=0;for await(let{content:a,path:c,mode:u,mtime:f}of Ese(r)){let d="",h=a?"file":"dir";s>0&&(d=`-${s}`);let p=h+d,y=[];if(u!=null&&y.push(`mode=${Sse(u)}`),f!=null){let{secs:g,nsecs:w}=f;y.push(`mtime=${g}`),w!=null&&y.push(`mtime-nsecs=${w}`)}if(y.length&&(p=`${p}?${y.join("&")}`),a){n.set(p,a,c!=null?encodeURIComponent(c):void 0);let g=o+a.size;i.push({name:c,start:o,end:g}),o=g}else if(c!=null)n.set(p,new File([""],encodeURIComponent(c),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");s++}return{total:o,parts:i,headers:t,body:n}}l();var Ase=A($o());function kqe(r){return r.filter(Boolean)}function Oi(...r){return(0,Ase.anySignal)(kqe(r))}var Rse=q(r=>{async function e(t,i={}){let n=new AbortController,s=Oi(n.signal,i.signal),o;try{o=await(await r.post("block/put",{signal:s,searchParams:K(i),...await Ci([t],n,i.headers)})).json()}catch(a){if(i.format==="dag-pb")return e(t,{...i,format:"protobuf"});if(i.format==="dag-cbor")return e(t,{...i,format:"cbor"});throw a}return L.parse(o.Key)}return e});l();we();var xse=q(r=>{async function*e(t,i={}){Array.isArray(t)||(t=[t]);let n=await r.post("block/rm",{signal:i.signal,searchParams:K({arg:t.map(s=>s.toString()),"stream-channels":!0,...i}),headers:i.headers});for await(let s of n.ndjson())yield Dqe(s)}return e});function Dqe(r){let e={cid:L.parse(r.Hash)};return r.Error&&(e.error=new Error(r.Error)),e}l();we();var Ise=q(r=>{async function e(t,i={}){let s=await(await r.post("block/stat",{signal:i.signal,searchParams:K({arg:t.toString(),...i}),headers:i.headers})).json();return{cid:L.parse(s.Key),size:s.Size}}return e});function Tse(r){return{get:kw(r),put:Rse(r),rm:xse(r),stat:Ise(r)}}l();l();var Pse=A(lt()),Cse=q(r=>{async function e(t,i={}){let n=await r.post("bootstrap/add",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new Pse.Multiaddr(o))}}return e});l();var Ose=A(lt()),kse=q(r=>{async function e(t={}){let i=await r.post("bootstrap/rm",{signal:t.signal,searchParams:K({...t,all:!0}),headers:t.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new Ose.Multiaddr(s))}}return e});l();var Dse=A(lt()),Nse=q(r=>{async function e(t={}){let i=await r.post("bootstrap/list",{signal:t.signal,searchParams:K(t),headers:t.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new Dse.Multiaddr(s))}}return e});l();var Bse=A(lt()),Lse=q(r=>{async function e(t={}){let i=await r.post("bootstrap/add",{signal:t.signal,searchParams:K({...t,default:!0}),headers:t.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new Bse.Multiaddr(s))}}return e});l();var Mse=A(lt()),jse=q(r=>{async function e(t,i={}){let n=await r.post("bootstrap/rm",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new Mse.Multiaddr(o))}}return e});function qse(r){return{add:Cse(r),clear:kse(r),list:Nse(r),reset:Lse(r),rm:jse(r)}}l();l();l();var Use=q(r=>{async function e(t,i={}){let s=await(await r.post("config/profile/apply",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).json();return{original:s.OldCfg,updated:s.NewCfg}}return e});l();l();function Dt(r){if(r==null)return r;let e=/^[A-Z]+$/,t={};return Object.keys(r).reduce((i,n)=>(e.test(n)?i[n.toLowerCase()]=r[n]:e.test(n[0])?i[n[0].toLowerCase()+n.slice(1)]=r[n]:i[n]=r[n],i),t)}var Fse=q(r=>{async function e(t={}){return(await(await r.post("config/profile/list",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()).map(s=>Dt(s))}return e});function Kse(r){return{apply:Use(r),list:Fse(r)}}l();var Vse=q(r=>async(t,i={})=>{if(!t)throw new Error("key argument is required");return(await(await r.post("config",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).json()).Value});l();var zse=q(r=>async(t={})=>await(await r.post("config/show",{signal:t.signal,searchParams:K({...t}),headers:t.headers})).json());l();at();var Hse=q(r=>async(t,i={})=>{let n=new AbortController,s=Oi(n.signal,i.signal);await(await r.post("config/replace",{signal:s,searchParams:K(i),...await Ci([Qe(JSON.stringify(t))],n,i.headers)})).text()});l();var $se=q(r=>async(t,i,n={})=>{if(typeof t!="string")throw new Error("Invalid key type");let s={...n,...Nqe(t,i)};await(await r.post("config",{signal:n.signal,searchParams:K(s),headers:n.headers})).text()}),Nqe=(r,e)=>{switch(typeof e){case"boolean":return{arg:[r,e.toString()],bool:!0};case"string":return{arg:[r,e]};default:return{arg:[r,JSON.stringify(e)],json:!0}}};function Gse(r){return{getAll:zse(r),get:Vse(r),set:$se(r),replace:Hse(r),profiles:Kse(r)}}l();l();var Wse=q(r=>{async function*e(t,i={}){yield*(await r.post("dag/export",{signal:i.signal,searchParams:K({arg:t.toString()}),headers:i.headers})).iterator()}return e});l();l();we();var sT=A(lh());async function*oT(r,e,t,i,n){let s=async u=>{let f=await t.getCodec(u.code),d=await i(u,n);return f.decode(d)},o=e.split("/").filter(Boolean),a=await s(r),c=r;for(;o.length;){let u=o.shift();if(!u)throw(0,sT.default)(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(a,u))a=a[u],yield{value:a,remainderPath:o.join("/")};else throw(0,sT.default)(new Error(`no link named "${u}" under ${c}`),"ERR_NO_LINK");let f=L.asCID(a);f&&(c=f,a=await s(a))}yield{value:a,remainderPath:""}}var Yse=A(Td()),Xse=A(Zn()),Qse=A(lh());var Zse=(r,e)=>q((i,n)=>{let s=kw(n);return async(a,c={})=>{if(c.path){let p=c.localResolve?await(0,Yse.default)(oT(a,c.path,r,s,c)):await(0,Xse.default)(oT(a,c.path,r,s,c));if(!p)throw(0,Qse.default)(new Error("Not found"),"ERR_NOT_FOUND");return p}let u=await r.getCodec(a.code),f=await s(a,c);return{value:u.decode(f),remainderPath:""}}})(e);l();we();var Jse=q(r=>{async function*e(t,i={}){let n=new AbortController,s=Oi(n.signal,i.signal),{headers:o,body:a}=await Ci(t,n,i.headers),c=await r.post("dag/import",{signal:s,headers:o,body:a,searchParams:K({"pin-roots":i.pinRoots})});for await(let{Root:u}of c.ndjson())if(u!==void 0){let{Cid:{"/":f},PinErrorMsg:d}=u;yield{root:{cid:L.parse(f),pinErrorMsg:d}}}}return e});l();we();var Dw=(r,e)=>q(i=>async(s,o={})=>{let a={storeCodec:"dag-cbor",hashAlg:"sha2-256",...o},c;if(a.inputCodec){if(!(s instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");c=s}else c=(await r.getCodec(a.storeCodec)).encode(s),a.inputCodec=a.storeCodec;let u=new AbortController,f=Oi(u.signal,a.signal),h=await(await i.post("dag/put",{timeout:a.timeout,signal:f,searchParams:K(a),...await Ci([c],u,a.headers)})).json();return L.parse(h.Cid["/"])})(e);l();we();var eoe=q(r=>async(t,i={})=>{let s=await(await r.post("dag/resolve",{signal:i.signal,searchParams:K({arg:`${t}${i.path?`/${i.path}`.replace(/\/[/]+/g,"/"):""}`,...i}),headers:i.headers})).json();return{cid:L.parse(s.Cid["/"]),remainderPath:s.RemPath}});function toe(r,e){return{export:Wse(e),get:Zse(r,e),import:Jse(e),put:Dw(r,e),resolve:eoe(e)}}l();l();l();at();l();var roe=0,ioe=1,noe=2,soe=3,ooe=4,aoe=5,coe=6,uoe=7;var hm=A(lt()),mo=r=>{if(r.Type===roe)return{to:r.ID,name:"SENDING_QUERY",type:r.Type};if(r.Type===ioe)return{from:r.ID,name:"PEER_RESPONSE",type:r.Type,messageType:0,messageName:"PUT_VALUE",closer:(r.Responses||[]).map(({ID:e,Addrs:t})=>({id:e,multiaddrs:t.map(i=>new hm.Multiaddr(i))})),providers:(r.Responses||[]).map(({ID:e,Addrs:t})=>({id:e,multiaddrs:t.map(i=>new hm.Multiaddr(i))}))};if(r.Type===noe){let e={id:r.ID,multiaddrs:[]};return r.Responses&&r.Responses.length&&(e={id:r.Responses[0].ID,multiaddrs:r.Responses[0].Addrs.map(t=>new hm.Multiaddr(t))}),{from:r.ID,name:"FINAL_PEER",type:r.Type,peer:e}}if(r.Type===soe)return{from:r.ID,name:"QUERY_ERROR",type:r.Type,error:new Error(r.Extra)};if(r.Type===ooe)return{from:r.ID,name:"PROVIDER",type:r.Type,providers:r.Responses.map(({ID:e,Addrs:t})=>({id:e,multiaddrs:t.map(i=>new hm.Multiaddr(i))}))};if(r.Type===aoe)return{from:r.ID,name:"VALUE",type:r.Type,value:Qe(r.Extra,"base64pad")};if(r.Type===coe){let e=r.Responses.map(({ID:t})=>t);if(!e.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:r.Type,peer:e[0]}}if(r.Type===uoe)return{name:"DIALING_PEER",type:r.Type,peer:r.ID};throw new Error("Unknown DHT event type")};var loe=q(r=>{async function*e(t,i={}){let n=await r.post("dht/findpeer",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers});for await(let s of n.ndjson())yield mo(s)}return e});l();var foe=q(r=>{async function*e(t,i={}){let n=await r.post("dht/findprovs",{signal:i.signal,searchParams:K({arg:t.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())yield mo(s)}return e});l();et();var doe=q(r=>{async function*e(t,i={}){let n=await r.post("dht/get",{signal:i.signal,searchParams:K({arg:t instanceof Uint8Array?$e(t):t.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())yield mo(s)}return e});l();var hoe=q(r=>{async function*e(t,i={recursive:!1}){let n=Array.isArray(t)?t:[t],s=await r.post("dht/provide",{signal:i.signal,searchParams:K({arg:n.map(o=>o.toString()),...i}),headers:i.headers});for await(let o of s.ndjson())yield mo(o)}return e});l();et();var poe=q(r=>{async function*e(t,i,n={}){let s=new AbortController,o=Oi(s.signal,n.signal),a=await r.post("dht/put",{signal:o,searchParams:K({arg:t instanceof Uint8Array?$e(t):t.toString(),...n}),...await Ci([i],s,n.headers)});for await(let c of a.ndjson())yield mo(c)}return e});l();var yoe=q(r=>{async function*e(t,i={}){let n=await r.post("dht/query",{signal:i.signal,searchParams:K({arg:t.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())yield mo(s)}return e});function goe(r){return{findPeer:loe(r),findProvs:foe(r),get:doe(r),provide:hoe(r),put:poe(r),query:yoe(r)}}l();l();var moe=q(r=>{async function e(t={}){return(await r.post("diag/cmds",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()}return e});l();var boe=q(r=>{async function e(t={}){return(await r.post("diag/net",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()}return e});l();var woe=q(r=>{async function e(t={}){return(await r.post("diag/sys",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()}return e});function _oe(r){return{cmds:moe(r),net:boe(r),sys:woe(r)}}l();l();var voe=q(r=>{async function e(t,i,n={}){await(await r.post("files/chmod",{signal:n.signal,searchParams:K({arg:t,mode:i,...n}),headers:n.headers})).text()}return e});l();we();var Eoe=q(r=>{async function e(t,i,n={}){let s=Array.isArray(t)?t:[t];await(await r.post("files/cp",{signal:n.signal,searchParams:K({arg:s.concat(i).map(a=>L.asCID(a)?`/ipfs/${a}`:a),...n}),headers:n.headers})).text()}return e});l();we();var Soe=q(r=>{async function e(t,i={}){if(!t||typeof t!="string")throw new Error("ipfs.files.flush requires a path");let s=await(await r.post("files/flush",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).json();return L.parse(s.Cid)}return e});l();we();l();function pm(r){let e=Dt(r);return Object.prototype.hasOwnProperty.call(e,"mode")&&(e.mode=parseInt(e.mode,8)),Object.prototype.hasOwnProperty.call(e,"mtime")&&(e.mtime={secs:e.mtime,nsecs:e.mtimeNsecs||0},delete e.mtimeNsecs),e}var Aoe=q(r=>{async function*e(t,i={}){if(!t)throw new Error("ipfs.files.ls requires a path");let n=await r.post("files/ls",{signal:i.signal,searchParams:K({arg:L.asCID(t)?`/ipfs/${t}`:t,long:!0,...i,stream:!0}),headers:i.headers});for await(let s of n.ndjson())if("Entries"in s)for(let o of s.Entries||[])yield Roe(pm(o));else yield Roe(pm(s))}return e});function Roe(r){return r.hash&&(r.cid=L.parse(r.hash)),delete r.hash,r.type=r.type===1?"directory":"file",r}l();var xoe=q(r=>{async function e(t,i={}){await(await r.post("files/mkdir",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).text()}return e});l();var Ioe=q(r=>{async function e(t,i,n={}){Array.isArray(t)||(t=[t]),await(await r.post("files/mv",{signal:n.signal,searchParams:K({arg:t.concat(i),...n}),headers:n.headers})).text()}return e});l();var Poe=A(ym()),Coe=q(r=>{async function*e(t,i={}){let n=await r.post("files/read",{signal:i.signal,searchParams:K({arg:t,count:i.length,...i}),headers:i.headers});yield*(0,Poe.default)(n.body)}return e});l();var Ooe=A(Tp()),koe=q(r=>{async function e(t,i={}){let n=await r.post("files/rm",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers}),s=await n.text();if(s!==""){let o=new Ooe.default.HTTPError(n);throw o.message=s,o}}return e});l();we();var Nw=q(r=>{async function e(t,i={}){let s=await(await r.post("files/stat",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).json();return s.WithLocality=s.WithLocality||!1,Bqe(pm(s))}return e});function Bqe(r){return r.cid=L.parse(r.hash),delete r.hash,r}l();var Doe=q(r=>{async function e(t,i={}){await(await r.post("files/touch",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).text()}return e});l();var Noe=q(r=>{async function e(t,i,n={}){let s=new AbortController,o=Oi(s.signal,n.signal);await(await r.post("files/write",{signal:o,searchParams:K({arg:t,streamChannels:!0,count:n.length,...n}),...await Ci([{content:i,path:"arg",mode:Pw(n.mode),mtime:Cw(n.mtime)}],s,n.headers)})).text()}return e});function Boe(r){return{chmod:voe(r),cp:Eoe(r),flush:Soe(r),ls:Aoe(r),mkdir:xoe(r),mv:Ioe(r),read:Coe(r),rm:koe(r),stat:Nw(r),touch:Doe(r),write:Noe(r)}}l();l();var Loe=A(lh()),Moe=q(r=>async(t,i,n={})=>{throw(0,Loe.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});l();var joe=q(r=>{async function e(t,i={type:"rsa",size:2048}){let s=await(await r.post("key/gen",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).json();return Dt(s)}return e});l();var qoe=q(r=>{async function e(t,i,n,s={}){let a=await(await r.post("key/import",{signal:s.signal,searchParams:K({arg:t,pem:i,password:n,...s}),headers:s.headers})).json();return Dt(a)}return e});l();var Uoe=A(lh()),Foe=q(r=>async(t,i={})=>{throw(0,Uoe.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});l();var Koe=q(r=>{async function e(t={}){return((await(await r.post("key/list",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()).Keys||[]).map(s=>Dt(s))}return e});l();var Voe=q(r=>{async function e(t,i,n={}){let s=await r.post("key/rename",{signal:n.signal,searchParams:K({arg:[t,i],...n}),headers:n.headers});return Dt(await s.json())}return e});l();var zoe=q(r=>{async function e(t,i={}){let s=await(await r.post("key/rm",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).json();return Dt(s.Keys[0])}return e});function Hoe(r){return{export:Moe(r),gen:joe(r),import:qoe(r),info:Foe(r),list:Koe(r),rename:Voe(r),rm:zoe(r)}}l();l();var $oe=q(r=>{async function e(t,i,n={}){let s=await r.post("log/level",{signal:n.signal,searchParams:K({arg:[t,i],...n}),headers:n.headers});return Dt(await s.json())}return e});l();var Goe=q(r=>{async function e(t={}){return(await(await r.post("log/ls",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()).Strings}return e});l();var Woe=q(r=>{async function*e(t={}){yield*(await r.post("log/tail",{signal:t.signal,searchParams:K(t),headers:t.headers})).ndjson()}return e});function Yoe(r){return{level:$oe(r),ls:Goe(r),tail:Woe(r)}}l();l();var Xoe=q(r=>{async function e(t,i={}){let n=await r.post("name/publish",{signal:i.signal,searchParams:K({arg:`${t}`,...i}),headers:i.headers});return Dt(await n.json())}return e});l();var Qoe=q(r=>{async function*e(t,i={}){let n=await r.post("name/resolve",{signal:i.signal,searchParams:K({arg:t,stream:!0,...i}),headers:i.headers});for await(let s of n.ndjson())yield s.Path}return e});l();l();var Zoe=q(r=>{async function e(t,i={}){let n=await r.post("name/pubsub/cancel",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers});return Dt(await n.json())}return e});l();var Joe=q(r=>{async function e(t={}){let i=await r.post("name/pubsub/state",{signal:t.signal,searchParams:K(t),headers:t.headers});return Dt(await i.json())}return e});l();var eae=q(r=>{async function e(t={}){return(await(await r.post("name/pubsub/subs",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()).Strings||[]}return e});function tae(r){return{cancel:Zoe(r),state:Joe(r),subs:eae(r)}}function rae(r){return{publish:Xoe(r),resolve:Qoe(r),pubsub:tae(r)}}l();l();we();var iae=q(r=>{async function e(t,i={}){let s=await(await r.post("object/data",{signal:i.signal,searchParams:K({arg:`${t instanceof Uint8Array?L.decode(t):t}`,...i}),headers:i.headers})).arrayBuffer();return new Uint8Array(s,0,s.byteLength)}return e});l();we();at();var nae=q(r=>{async function e(t,i={}){let s=await(await r.post("object/get",{signal:i.signal,searchParams:K({arg:`${t instanceof Uint8Array?L.decode(t):t}`,dataEncoding:"base64",...i}),headers:i.headers})).json();return{Data:Qe(s.Data,"base64pad"),Links:(s.Links||[]).map(o=>({Name:o.Name,Hash:L.parse(o.Hash),Tsize:o.Size}))}}return e});l();we();var sae=q(r=>{async function e(t,i={}){return((await(await r.post("object/links",{signal:i.signal,searchParams:K({arg:`${t instanceof Uint8Array?L.decode(t):t}`,...i}),headers:i.headers})).json()).Links||[]).map(o=>({Name:o.Name,Tsize:o.Size,Hash:L.parse(o.Hash)}))}return e});l();we();var oae=q(r=>{async function e(t={}){let i=await r.post("object/new",{signal:t.signal,searchParams:K({arg:t.template,...t}),headers:t.headers}),{Hash:n}=await i.json();return L.parse(n)}return e});l();var aae=(r,e)=>q(i=>{let n=Dw(r,e);async function s(o,a={}){return n(o,{...a,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}return s})(e);l();we();var cae=q(r=>{async function e(t,i={}){let s=await(await r.post("object/stat",{signal:i.signal,searchParams:K({arg:`${t}`,...i}),headers:i.headers})).json();return{...s,Hash:L.parse(s.Hash)}}return e});l();l();we();var uae=q(r=>{async function e(t,i,n={}){let s=await r.post("object/patch/add-link",{signal:n.signal,searchParams:K({arg:[`${t}`,i.Name||i.name||"",(i.Hash||i.cid||"").toString()||null],...n}),headers:n.headers}),{Hash:o}=await s.json();return L.parse(o)}return e});l();we();var lae=q(r=>{async function e(t,i,n={}){let s=new AbortController,o=Oi(s.signal,n.signal),a=await r.post("object/patch/append-data",{signal:o,searchParams:K({arg:`${t}`,...n}),...await Ci([i],s,n.headers)}),{Hash:c}=await a.json();return L.parse(c)}return e});l();we();var fae=q(r=>{async function e(t,i,n={}){let s=await r.post("object/patch/rm-link",{signal:n.signal,searchParams:K({arg:[`${t}`,i.Name||i.name||null],...n}),headers:n.headers}),{Hash:o}=await s.json();return L.parse(o)}return e});l();we();var dae=q(r=>{async function e(t,i,n={}){let s=new AbortController,o=Oi(s.signal,n.signal),a=await r.post("object/patch/set-data",{signal:o,searchParams:K({arg:[`${t}`],...n}),...await Ci([i],s,n.headers)}),{Hash:c}=await a.json();return L.parse(c)}return e});function hae(r){return{addLink:uae(r),appendData:lae(r),rmLink:fae(r),setData:dae(r)}}function pae(r,e){return{data:iae(e),get:nae(e),links:sae(e),new:oae(e),put:aae(r,e),stat:cae(e),patch:hae(e)}}l();l();we();var Bw=q(r=>{async function*e(t,i={}){for await(let{path:n,recursive:s,metadata:o}of Xa(t)){let a=await r.post("pin/add",{signal:i.signal,searchParams:K({...i,arg:n,recursive:s,metadata:o?JSON.stringify(o):void 0,stream:!0}),headers:i.headers});for await(let c of a.ndjson()){if(c.Pins){for(let u of c.Pins)yield L.parse(u);continue}yield L.parse(c)}}}return e});l();var yae=A(Zn());function gae(r){let e=Bw(r);return q(()=>{async function t(i,n={}){return(0,yae.default)(e([{path:i,...n}],n))}return t})(r)}l();we();function mae(r,e,t){let i={type:r,cid:L.parse(e)};return t&&(i.metadata=t),i}var bae=q(r=>{async function*e(t={}){let i=[];t.paths&&(i=Array.isArray(t.paths)?t.paths:[t.paths]);let n=await r.post("pin/ls",{signal:t.signal,searchParams:K({...t,arg:i.map(s=>`${s}`),stream:!0}),headers:t.headers});for await(let s of n.ndjson()){if(s.Keys){for(let o of Object.keys(s.Keys))yield mae(s.Keys[o].Type,o,s.Keys[o].Metadata);return}yield mae(s.Type,s.Cid,s.Metadata)}}return e});l();we();var Lw=q(r=>{async function*e(t,i={}){for await(let{path:n,recursive:s}of Xa(t)){let o=new URLSearchParams(i.searchParams);o.append("arg",`${n}`),s!=null&&o.set("recursive",String(s));let a=await r.post("pin/rm",{signal:i.signal,headers:i.headers,searchParams:K({...i,arg:`${n}`,recursive:s})});for await(let c of a.ndjson()){if(c.Pins){yield*c.Pins.map(u=>L.parse(u));continue}yield L.parse(c)}}}return e});l();var wae=A(Zn());var _ae=r=>{let e=Lw(r);return q(()=>{async function t(i,n={}){return(0,wae.default)(e([{path:i,...n}],n))}return t})(r)};l();l();l();we();var Mw=({Name:r,Status:e,Cid:t})=>({cid:L.parse(t),name:r,status:e}),vae=r=>{if(typeof r=="string"&&r!=="")return r;throw new TypeError("service name must be passed")},Eae=r=>{if(L.asCID(r))return r.toString();throw new TypeError(`CID instance expected instead of ${typeof r}`)},p1=({service:r,cid:e,name:t,status:i,all:n})=>{let s=K({service:vae(r),name:t,force:n?!0:void 0});if(e)for(let o of e)s.append("cid",Eae(o));if(i)for(let o of i)s.append("status",o);return s},Sae=({cid:r,service:e,background:t,name:i,origins:n})=>{let s=K({arg:Eae(r),service:vae(e),name:i,background:t?!0:void 0});if(n)for(let o of n)s.append("origin",o.toString());return s};function Aae(r){async function e(t,{timeout:i,signal:n,headers:s,...o}){let a=await r.post("pin/remote/add",{timeout:i,signal:n,headers:s,searchParams:Sae({cid:t,...o})});return Mw(await a.json())}return e}l();function Rae(r){async function*e({timeout:t,signal:i,headers:n,...s}){let o=await r.post("pin/remote/ls",{timeout:t,signal:i,headers:n,searchParams:p1(s)});for await(let a of o.ndjson())yield Mw(a)}return e}l();function xae(r){async function e({timeout:t,signal:i,headers:n,...s}){await r.post("pin/remote/rm",{timeout:t,signal:i,headers:n,searchParams:p1({...s,all:!1})})}return e}l();function Iae(r){async function e({timeout:t,signal:i,headers:n,...s}){await r.post("pin/remote/rm",{timeout:t,signal:i,headers:n,searchParams:p1({...s,all:!0})})}return e}l();l();l();function Tae(r){let e=String(r);if(e==="undefined")throw Error("endpoint is required");return e[e.length-1]==="/"?e.slice(0,-1):e}function Pae(r){return{service:r.Service,endpoint:new URL(r.ApiEndpoint),...r.Stat&&{stat:Lqe(r.Stat)}}}function Lqe(r){switch(r.Status){case"valid":{let{Pinning:e,Pinned:t,Queued:i,Failed:n}=r.PinCount;return{status:"valid",pinCount:{queued:i,pinning:e,pinned:t,failed:n}}}case"invalid":return{status:"invalid"};default:return{status:r.Status}}}function Cae(r){async function e(t,i){let{endpoint:n,key:s,headers:o,timeout:a,signal:c}=i;await r.post("pin/remote/service/add",{timeout:a,signal:c,searchParams:K({arg:[t,Tae(n),s]}),headers:o})}return e}l();function Oae(r){async function e(t={}){let{stat:i,headers:n,timeout:s,signal:o}=t,a=await r.post("pin/remote/service/ls",{timeout:s,signal:o,headers:n,searchParams:i===!0?K({stat:i}):void 0}),{RemoteServices:c}=await a.json();return c.map(Pae)}return e}l();function kae(r){async function e(t,i={}){await r.post("pin/remote/service/rm",{signal:i.signal,headers:i.headers,searchParams:K({arg:t})})}return e}function Dae(r){let e=new uh(r);return{add:Cae(e),ls:Oae(e),rm:kae(e)}}function Nae(r){let e=new uh(r);return{add:Aae(e),ls:Rae(e),rm:xae(e),rmAll:Iae(e),service:Dae(r)}}function Bae(r){return{addAll:Bw(r),add:gae(r),ls:bae(r),rmAll:Lw(r),rm:_ae(r),remote:Nae(r)}}l();l();l();at();et();el();var jw=r=>Array.isArray(r)?r.map(Mqe):r,Mqe=r=>$e(qw(r)),qw=r=>e4.decode(r),y1=r=>e4.encode(Qe(r));var Lae=q(r=>{async function e(t={}){let{Strings:i}=await(await r.post("pubsub/ls",{signal:t.signal,searchParams:K(t),headers:t.headers})).json();return jw(i)||[]}return e});l();var Mae=q(r=>{async function e(t,i={}){let n=await r.post("pubsub/peers",{signal:i.signal,searchParams:K({arg:y1(t),...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e});l();var jae=q(r=>{async function e(t,i,n={}){let s=K({arg:y1(t),...n}),o=new AbortController,a=Oi(o.signal,n.signal);await(await r.post("pubsub/pub",{signal:a,searchParams:s,...await Ci([i],o,n.headers)})).text()}return e});l();var qae=A(le());var jqe=(0,qae.default)("ipfs-http-client:pubsub:subscribe"),Uae=(r,e)=>q(t=>{async function i(n,s,o={}){o.signal=e.subscribe(n,s,o.signal);let a,c,u=new Promise((d,h)=>{a=d,c=h}),f=setTimeout(()=>a(),1e3);return t.post("pubsub/sub",{signal:o.signal,searchParams:K({arg:y1(n),...o}),headers:o.headers}).catch(d=>{e.unsubscribe(n,s),c(d)}).then(d=>{clearTimeout(f),!!d&&(qqe(d,{onMessage:s,onEnd:()=>e.unsubscribe(n,s),onError:o.onError}),a())}),u}return i})(r);async function qqe(r,{onMessage:e,onEnd:t,onError:i}){i=i||jqe;try{for await(let n of r.ndjson())try{if(!n.from)continue;e({from:n.from,data:qw(n.data),seqno:qw(n.seqno),topicIDs:jw(n.topicIDs)})}catch(s){s.message=`Failed to parse pubsub message: ${s.message}`,i(s,!1,n)}}catch(n){Uqe(n)||i(n,!0)}finally{t()}}var Uqe=r=>{switch(r.type){case"aborted":return!0;case"abort":return!0;default:return r.name==="AbortError"}};l();var Fae=(r,e)=>{async function t(i,n){e.unsubscribe(i,n)}return t};l();var aT=class{constructor(){this._subs=new Map}subscribe(e,t,i){let n=this._subs.get(e)||[];if(n.find(o=>o.handler===t))throw new Error(`Already subscribed to ${e} with this handler`);let s=new AbortController;return this._subs.set(e,[{handler:t,controller:s}].concat(n)),i&&i.addEventListener("abort",()=>this.unsubscribe(e,t)),s.signal}unsubscribe(e,t){let i=this._subs.get(e)||[],n;t?(this._subs.set(e,i.filter(s=>s.handler!==t)),n=i.filter(s=>s.handler===t)):(this._subs.set(e,[]),n=i),(this._subs.get(e)||[]).length||this._subs.delete(e),n.forEach(s=>s.controller.abort())}};function Kae(r){let e=new aT;return{ls:Lae(r),peers:Mae(r),publish:jae(r),subscribe:Uae(r,e),unsubscribe:Fae(r,e)}}l();we();l();var Vae=q(r=>{async function*e(t={}){yield*(await r.post("refs/local",{signal:t.signal,transform:Dt,searchParams:K(t),headers:t.headers})).ndjson()}return e});var zae=q((r,e)=>Object.assign(async function*(i,n={}){let s=Array.isArray(i)?i:[i];yield*(await r.post("refs",{signal:n.signal,searchParams:K({arg:s.map(a=>`${a instanceof Uint8Array?L.decode(a):a}`),...n}),headers:n.headers,transform:Dt})).ndjson()},{local:Vae(e)}));l();l();we();var Hae=q(r=>{async function*e(t={}){yield*(await r.post("repo/gc",{signal:t.signal,searchParams:K(t),headers:t.headers,transform:n=>({err:n.Error?new Error(n.Error):null,cid:(n.Key||{})["/"]?L.parse(n.Key["/"]):null})})).ndjson()}return e});l();var Uw=q(r=>{async function e(t={}){let n=await(await r.post("repo/stat",{signal:t.signal,searchParams:K(t),headers:t.headers})).json();return{numObjects:BigInt(n.NumObjects),repoSize:BigInt(n.RepoSize),repoPath:n.RepoPath,version:n.Version,storageMax:BigInt(n.StorageMax)}}return e});l();var $ae=q(r=>{async function e(t={}){return(await(await r.post("repo/version",{signal:t.signal,searchParams:K(t),headers:t.headers})).json()).Version}return e});function Gae(r){return{gc:Hae(r),stat:Uw(r),version:$ae(r)}}l();l();var Wae=q(r=>{async function*e(t={}){yield*(await r.post("stats/bw",{signal:t.signal,searchParams:K(t),headers:t.headers,transform:n=>({totalIn:BigInt(n.TotalIn),totalOut:BigInt(n.TotalOut),rateIn:parseFloat(n.RateIn),rateOut:parseFloat(n.RateOut)})})).ndjson()}return e});function Yae(r){return{bitswap:Ow(r),repo:Uw(r),bw:Wae(r)}}l();l();var Xae=A(lt());var Qae=q(r=>{async function e(t={}){let i=await r.post("swarm/addrs",{signal:t.signal,searchParams:K(t),headers:t.headers}),{Addrs:n}=await i.json();return Object.keys(n).map(s=>({id:s,addrs:(n[s]||[]).map(o=>new Xae.Multiaddr(o))}))}return e});l();var Zae=q(r=>{async function e(t,i={}){let n=await r.post("swarm/connect",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e});l();var Jae=q(r=>{async function e(t,i={}){let n=await r.post("swarm/disconnect",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e});l();var ece=A(lt());var tce=q(r=>{async function e(t={}){let i=await r.post("swarm/addrs/local",{signal:t.signal,searchParams:K(t),headers:t.headers}),{Strings:n}=await i.json();return(n||[]).map(s=>new ece.Multiaddr(s))}return e});l();var rce=A(lt());var ice=q(r=>{async function e(t={}){let i=await r.post("swarm/peers",{signal:t.signal,searchParams:K(t),headers:t.headers}),{Peers:n}=await i.json();return(n||[]).map(s=>({addr:new rce.Multiaddr(s.Addr),peer:s.Peer,muxer:s.Muxer,latency:s.Latency,streams:s.Streams,direction:s.Direction==null?void 0:s.Direction===0?"inbound":"outbound"}))}return e});function nce(r){return{addrs:Qae(r),connect:Zae(r),disconnect:Jae(r),localAddrs:tce(r),peers:ice(r)}}l();l();we();var Fw=q(r=>{async function*e(t,i={}){let n=new AbortController,s=Oi(n.signal,i.signal),{headers:o,body:a,total:c,parts:u}=await Ci(t,n,i.headers),[f,d]=typeof i.progress=="function"?Fqe(c,u,i.progress):[void 0,void 0],h=await r.post("add",{searchParams:K({"stream-channels":!0,...i,progress:Boolean(f)}),onUploadProgress:d,signal:s,headers:o,body:a});for await(let p of h.ndjson())p=Dt(p),p.hash!==void 0?yield Vqe(p):f&&f(p.bytes||0,p.name)}return e}),Fqe=(r,e,t)=>e?[void 0,Kqe(r,e,t)]:[t,void 0],Kqe=(r,e,t)=>{let i=0,n=e.length;return({loaded:s,total:o})=>{let a=Math.floor(s/o*r);for(;i<n;){let{start:c,end:u,name:f}=e[i];if(a<u){t(a-c,f);break}else t(u-c,f),i+=1}}};function Vqe({name:r,hash:e,size:t,mode:i,mtime:n,mtimeNsecs:s}){let o={path:r,cid:L.parse(e),size:parseInt(t)};return i!=null&&(o.mode=parseInt(i,8)),n!=null&&(o.mtime={secs:n,nsecs:s||0}),o}var sce=A(Zn());function oce(r){let e=Fw(r);return q(()=>{async function t(i,n={}){return await(0,sce.default)(e(Yb(i),n))}return t})(r)}l();var ace=q(r=>{async function*e(t,i={}){yield*(await r.post("cat",{signal:i.signal,searchParams:K({arg:t.toString(),...i}),headers:i.headers})).iterator()}return e});l();var cce=q(r=>async(t={})=>(await r.post("commands",{signal:t.signal,searchParams:K(t),headers:t.headers})).json());l();var uce=q(r=>async(t,i={})=>(await(await r.post("dns",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers})).json()).Path);l();var lce=q(r=>()=>{let e=new URL(r.opts.base||"");return{host:e.hostname,port:e.port,protocol:e.protocol,pathname:e.pathname,"api-path":e.pathname}});l();we();var fce=q(r=>{async function*e(t,i={}){let n={arg:`${t instanceof Uint8Array?L.decode(t):t}`,...i};n.compressionLevel&&(n["compression-level"]=n.compressionLevel,delete n.compressionLevel),yield*(await r.post("get",{signal:i.signal,searchParams:K(n),headers:i.headers})).iterator()}return e});l();var dce=A(lt());var Kw=q(r=>{async function e(t={}){let n=await(await r.post("id",{signal:t.signal,searchParams:K({arg:t.peerId?t.peerId.toString():void 0,...t}),headers:t.headers})).json(),s={...Dt(n)};return s.addresses&&(s.addresses=s.addresses.map(o=>new dce.Multiaddr(o))),s}return e});l();var hce=r=>{let e=Kw(r);async function t(i={}){let n=await e(i);return Boolean(n&&n.addresses&&n.addresses.length)}return t};l();we();var pce=q((r,e)=>{async function*t(i,n={}){let s=`${i instanceof Uint8Array?L.decode(i):i}`;async function o(c){let u=c.Hash;if(u.includes("/")){let d=u.startsWith("/ipfs/")?u:`/ipfs/${u}`;u=(await Nw(e)(d)).cid}else u=L.parse(u);let f={name:c.Name,path:s+(c.Name?`/${c.Name}`:""),size:c.Size,cid:u,type:zqe(c)};return c.Mode&&(f.mode=parseInt(c.Mode,8)),c.Mtime!==void 0&&c.Mtime!==null&&(f.mtime={secs:c.Mtime},c.MtimeNsecs!==void 0&&c.MtimeNsecs!==null&&(f.mtime.nsecs=c.MtimeNsecs)),f}let a=await r.post("ls",{signal:n.signal,searchParams:K({arg:s,...n}),headers:n.headers});for await(let c of a.ndjson()){if(c=c.Objects,!c)throw new Error("expected .Objects in results");if(c=c[0],!c)throw new Error("expected one array in results.Objects");let u=c.Links;if(!Array.isArray(u))throw new Error("expected one array in results.Objects[0].Links");if(!u.length){yield o(c);return}yield*u.map(o)}}return t});function zqe(r){switch(r.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}l();var yce=q(r=>{async function e(t={}){let i=await r.post("dns",{signal:t.signal,searchParams:K(t),headers:t.headers});return Dt(await i.json())}return e});l();var gce=q(r=>{async function*e(t,i={}){yield*(await r.post("ping",{signal:i.signal,searchParams:K({arg:`${t}`,...i}),headers:i.headers,transform:Dt})).ndjson()}return e});l();var mce=q(r=>{async function e(t,i={}){let n=await r.post("resolve",{signal:i.signal,searchParams:K({arg:t,...i}),headers:i.headers}),{Path:s}=await n.json();return s}return e});l();var bce=A(lh()),wce=q(r=>async(t={})=>{throw(0,bce.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});l();var _ce=q(r=>{async function e(t={}){await(await r.post("shutdown",{signal:t.signal,searchParams:K(t),headers:t.headers})).text()}return e});l();var vce=q(r=>{async function e(t={}){let i=await r.post("version",{signal:t.signal,searchParams:K(t),headers:t.headers});return{...Dt(await i.json()),"ipfs-http-client":"1.0.0"}}return e});var Yqe=A(cT());we();var Xqe=A(lt()),Qqe=A(uT());function Sce(r={}){let e={name:bs.name,code:bs.code,encode:u=>u,decode:u=>u},t=Object.values(Uf);(r.ipld&&r.ipld.bases?r.ipld.bases:[]).forEach(u=>t.push(u));let i=new lm({bases:t,loadBase:r.ipld&&r.ipld.loadBase}),n=Object.values(n4);[Tn,ky,Ny,Wqe,e].concat(r.ipld&&r.ipld.codecs||[]).forEach(u=>n.push(u));let s=new fm({codecs:n,loadCodec:r.ipld&&r.ipld.loadCodec}),o=Object.values(i4);(r.ipld&&r.ipld.hashers?r.ipld.hashers:[]).forEach(u=>o.push(u));let a=new dm({hashers:o,loadHasher:r.ipld&&r.ipld.loadHasher});return{add:oce(r),addAll:Fw(r),bitswap:yse(r),block:Tse(r),bootstrap:qse(r),cat:ace(r),commands:cce(r),config:Gse(r),dag:toe(s,r),dht:goe(r),diag:_oe(r),dns:uce(r),files:Boe(r),get:fce(r),getEndpointConfig:lce(r),id:Kw(r),isOnline:hce(r),key:Hoe(r),log:Yoe(r),ls:pce(r),mount:yce(r),name:rae(r),object:pae(s,r),pin:Bae(r),ping:gce(r),pubsub:Kae(r),refs:zae(r),repo:Gae(r),resolve:mce(r),start:wce(r),stats:Yae(r),stop:_ce(r),swarm:nce(r),version:vce(r),bases:i,codecs:s,hashers:a}}var S4e=A(lt());l();var L0e=A(Sue()),M0e=A(cfe()),j0e=A(Cfe()),q0e=A(Zde()),U0e=A(D0e()),F0e=A(tT());l();var N0e={func:(r,e)=>ud.validate(e,r)};function B0e(r,e){return ud.select(e[0],e[1])}function K0e(){return{dialer:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4},modules:{transport:[L0e.default,M0e.default],streamMuxer:[j0e.default],connEncryption:[q0e.NOISE],peerDiscovery:[],dht:U0e.default,pubsub:F0e.default},config:{peerDiscovery:{autoDial:!0,bootstrap:{enabled:!0},webRTCStar:{enabled:!0}},dht:{kBucketSize:20,enabled:!0,clientMode:!0,validators:{ipns:N0e},selectors:{ipns:B0e}},pubsub:{enabled:!0,emitSelf:!0},nat:{enabled:!1}},metrics:{enabled:!0},peerStore:{persistence:!0}}}var A4e=A($0e()),R4e=A(w4e());var Mtt=Ct.bind({ignoreUndefined:!0});function l3({options:r={},peerId:e,multiaddrs:t=[],repo:i,keychainConfig:n={},config:s={}}){let{datastore:o,keys:a}=i,c=jtt({options:r,config:s,datastore:o,keys:a,keychainConfig:n,peerId:e,multiaddrs:t});return typeof r.libp2p=="function"?r.libp2p({libp2pOptions:c,options:r,config:s,datastore:o,peerId:e}):R4e.default.create(c)}function jtt({options:r,config:e,datastore:t,keys:i,keychainConfig:n,peerId:s,multiaddrs:o}){let a=()=>{let y=(0,Wt.default)(e,"Pubsub.Router")||"gossipsub";if(!rT[y])throw(0,_4e.default)(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${y} router.`),"ERR_NOT_SUPPORTED");return rT[y]},c={datastore:t,peerId:s,modules:{}},u={modules:{pubsub:a(),contentRouting:[],peerRouting:[]},config:{peerDiscovery:{mdns:{enabled:(0,Wt.default)(r,"config.Discovery.MDNS.Enabled",(0,Wt.default)(e,"Discovery.MDNS.Enabled",!0))},webRTCStar:{enabled:(0,Wt.default)(r,"config.Discovery.webRTCStar.Enabled",(0,Wt.default)(e,"Discovery.webRTCStar.Enabled",!0))},bootstrap:{list:(0,Wt.default)(r,"config.Bootstrap",(0,Wt.default)(e,"Bootstrap",[]))}},relay:{enabled:(0,Wt.default)(r,"relay.enabled",(0,Wt.default)(e,"relay.enabled",!0)),hop:{enabled:(0,Wt.default)(r,"relay.hop.enabled",(0,Wt.default)(e,"relay.hop.enabled",!1)),active:(0,Wt.default)(r,"relay.hop.active",(0,Wt.default)(e,"relay.hop.active",!1))}},dht:{enabled:(0,Wt.default)(e,"Routing.Type","dhtclient")!=="none",clientMode:(0,Wt.default)(e,"Routing.Type","dht")!=="dhtserver",kBucketSize:(0,Wt.default)(r,"dht.kBucketSize",20),validators:{ipns:ud}},pubsub:{enabled:(0,Wt.default)(r,"config.Pubsub.Enabled",(0,Wt.default)(e,"Pubsub.Enabled",!0))},nat:{enabled:!(0,Wt.default)(e,"Swarm.DisableNatPortMap",!1)}},addresses:{listen:o.map(y=>y.toString()),announce:(0,Wt.default)(r,"addresses.announce",(0,Wt.default)(e,"Addresses.Announce",[])),noAnnounce:(0,Wt.default)(r,"addresses.noAnnounce",(0,Wt.default)(e,"Addresses.NoAnnounce",[]))},connectionManager:(0,Wt.default)(r,"connectionManager",{maxConnections:(0,Wt.default)(r,"config.Swarm.ConnMgr.HighWater",(0,Wt.default)(e,"Swarm.ConnMgr.HighWater")),minConnections:(0,Wt.default)(r,"config.Swarm.ConnMgr.LowWater",(0,Wt.default)(e,"Swarm.ConnMgr.LowWater"))}),keychain:{datastore:i,...n},host:{agentVersion:`js-ipfs/${Id}`}},f=(0,Wt.default)(r,"libp2p",void 0);typeof f=="function"&&(f=void 0);let d=Mtt(c,K0e(),u,f);(0,Wt.default)(d,"config.peerDiscovery.bootstrap.list",[]).length>0&&d.modules.peerDiscovery.push(A4e.default);let p=(0,Wt.default)(r,"config.Addresses.Delegates",(0,Wt.default)(e,"Addresses.Delegates",[]));if(p.length>0){let y=p[Math.floor(Math.random()*p.length)],g=new S4e.Multiaddr(y).toOptions(),w={host:g.host,protocol:parseInt(g.port)===443?"https":"http",port:g.port},b=Sce(w);u.modules.contentRouting=u.modules.contentRouting||[],u.modules.contentRouting.push(new E4e.default(s,b)),u.modules.peerRouting=u.modules.peerRouting||[],u.modules.peerRouting.push(new v4e.default(b))}return d}var I4e=Ct.bind({ignoreUndefined:!0}),f3=(0,x4e.default)("ipfs:components:peer:storage"),d3=class{constructor(e,t,i,n,s){this.print=n,this.peerId=e,this.keychain=t,this.repo=i,this.print=n,this.isNew=s}static async start(e,t,i){let{repoAutoMigrate:n,repo:s,onMigrationProgress:o}=i,a=typeof s=="string"||s==null?$re(e,t,{path:s,autoMigrate:n,onMigrationProgress:o}):s,{peerId:c,keychain:u,isNew:f}=await qtt(e,a,i);return new d3(c,u,a,e,f)}},qtt=async(r,e,t)=>{if(!e.closed)return{...await T4e(e,t),isNew:!1};try{return await e.open(),{...await T4e(e,t),isNew:!1}}catch(i){if(i.code!==Ud)throw i;if(t.init&&t.init.allowNew===!1)throw new La("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await Utt(r,e,t),isNew:!0}}},Utt=async(r,e,t)=>{let i=t.init||{},n=await e.exists();if(f3("repo exists?",n),n===!0)throw new Error("repo already exists");let s=i.privateKey?await Ftt(i.privateKey):await Ktt(r,i),o=Vtt(s);f3("peer identity: %s",o.PeerID);let a={...I4e(P4e(nu(),i.profiles),t.config),Identity:o};await e.init(a),await e.open(),f3("repo opened");let c={pass:t.pass};try{c.dek=await e.config.get("Keychain.DEK")}catch(f){if(f.code!=="ERR_NOT_FOUND")throw f}let u=await l3({options:void 0,multiaddrs:void 0,peerId:s,repo:e,config:a,keychainConfig:c});return u.keychain&&u.keychain.opts&&(await u.loadKeychain(),await e.config.set("Keychain",{DEK:u.keychain.opts.dek})),{peerId:s,keychain:u.keychain}},Ftt=r=>(f3("using user-supplied private-key"),typeof r=="object"?r:V_.default.createFromPrivKey(Qe(r,"base64pad"))),Ktt=(r,{algorithm:e="Ed25519",bits:t=2048})=>(r("generating %s keypair...",e),V_.default.create({keyType:e,bits:t})),Vtt=r=>({PeerID:r.toB58String(),PrivKey:$e(r.privKey.bytes,"base64pad")}),T4e=async(r,e)=>{let t=e.config,i=e.init&&e.init.profiles||[],n=e.pass,s=await r.config.getAll(),o=ztt(P4e(s,i),t);if(s!==o&&await r.config.replace(o),!o.Identity||!o.Identity.PrivKey)throw new tl("No private key was found in the config, please intialize the repo");let a=await V_.default.createFromPrivKey(o.Identity.PrivKey),c=await l3({options:void 0,multiaddrs:void 0,peerId:a,repo:r,config:o,keychainConfig:{pass:n,...o.Keychain}});return c.keychain&&await c.loadKeychain(),{peerId:a,keychain:c.keychain}},ztt=(r,e)=>e?I4e(r,e):r,P4e=(r,e)=>(e||[]).reduce((t,i)=>{let n=v0[i];if(!n)throw new Error(`Could not find profile with name '${i}'`);return f3("applying profile %s",i),n.transform(t)},r);l();l();l();l();l();we();Si();di();var X4e=A(V4e());l();var h3=A(Xn());function nrt(r){let e=new Uint8Array(r.reduce((i,n)=>i+h3.default.encodingLength(n),0)),t=0;for(let i of r)e=h3.encode(i,e,t),t+=h3.default.encodingLength(i);return e}var z4e=nrt;l();var dO=A(le());hi();l();l();l();di();var z_=class{constructor(e,t,i){this._refCounter=1,this.cid=e,this.priority=t||1,this.wantType=i}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(yt)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}};di();l();var Sa=A(Br()),kc=Sa.default.Reader,p3=Sa.default.Writer,Zt=Sa.default.util,Vt=Sa.default.roots["ipfs-bitswap"]||(Sa.default.roots["ipfs-bitswap"]={}),Ns=Vt.Message=(()=>{function r(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.wantlist=null,r.prototype.blocks=Zt.emptyArray,r.prototype.payload=Zt.emptyArray,r.prototype.blockPresences=Zt.emptyArray,r.prototype.pendingBytes=0,r.encode=function(t,i){if(i||(i=p3.create()),t.wantlist!=null&&Object.hasOwnProperty.call(t,"wantlist")&&Vt.Message.Wantlist.encode(t.wantlist,i.uint32(10).fork()).ldelim(),t.blocks!=null&&t.blocks.length)for(var n=0;n<t.blocks.length;++n)i.uint32(18).bytes(t.blocks[n]);if(t.payload!=null&&t.payload.length)for(var n=0;n<t.payload.length;++n)Vt.Message.Block.encode(t.payload[n],i.uint32(26).fork()).ldelim();if(t.blockPresences!=null&&t.blockPresences.length)for(var n=0;n<t.blockPresences.length;++n)Vt.Message.BlockPresence.encode(t.blockPresences[n],i.uint32(34).fork()).ldelim();return t.pendingBytes!=null&&Object.hasOwnProperty.call(t,"pendingBytes")&&i.uint32(40).int32(t.pendingBytes),i},r.decode=function(t,i){t instanceof kc||(t=kc.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Vt.Message;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.wantlist=Vt.Message.Wantlist.decode(t,t.uint32());break;case 2:s.blocks&&s.blocks.length||(s.blocks=[]),s.blocks.push(t.bytes());break;case 3:s.payload&&s.payload.length||(s.payload=[]),s.payload.push(Vt.Message.Block.decode(t,t.uint32()));break;case 4:s.blockPresences&&s.blockPresences.length||(s.blockPresences=[]),s.blockPresences.push(Vt.Message.BlockPresence.decode(t,t.uint32()));break;case 5:s.pendingBytes=t.int32();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Vt.Message)return t;var i=new Vt.Message;if(t.wantlist!=null){if(typeof t.wantlist!="object")throw TypeError(".Message.wantlist: object expected");i.wantlist=Vt.Message.Wantlist.fromObject(t.wantlist)}if(t.blocks){if(!Array.isArray(t.blocks))throw TypeError(".Message.blocks: array expected");i.blocks=[];for(var n=0;n<t.blocks.length;++n)typeof t.blocks[n]=="string"?Zt.base64.decode(t.blocks[n],i.blocks[n]=Zt.newBuffer(Zt.base64.length(t.blocks[n])),0):t.blocks[n].length&&(i.blocks[n]=t.blocks[n])}if(t.payload){if(!Array.isArray(t.payload))throw TypeError(".Message.payload: array expected");i.payload=[];for(var n=0;n<t.payload.length;++n){if(typeof t.payload[n]!="object")throw TypeError(".Message.payload: object expected");i.payload[n]=Vt.Message.Block.fromObject(t.payload[n])}}if(t.blockPresences){if(!Array.isArray(t.blockPresences))throw TypeError(".Message.blockPresences: array expected");i.blockPresences=[];for(var n=0;n<t.blockPresences.length;++n){if(typeof t.blockPresences[n]!="object")throw TypeError(".Message.blockPresences: object expected");i.blockPresences[n]=Vt.Message.BlockPresence.fromObject(t.blockPresences[n])}}return t.pendingBytes!=null&&(i.pendingBytes=t.pendingBytes|0),i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocks=[],n.payload=[],n.blockPresences=[]),i.defaults&&(n.wantlist=null,n.pendingBytes=0),t.wantlist!=null&&t.hasOwnProperty("wantlist")&&(n.wantlist=Vt.Message.Wantlist.toObject(t.wantlist,i)),t.blocks&&t.blocks.length){n.blocks=[];for(var s=0;s<t.blocks.length;++s)n.blocks[s]=i.bytes===String?Zt.base64.encode(t.blocks[s],0,t.blocks[s].length):i.bytes===Array?Array.prototype.slice.call(t.blocks[s]):t.blocks[s]}if(t.payload&&t.payload.length){n.payload=[];for(var s=0;s<t.payload.length;++s)n.payload[s]=Vt.Message.Block.toObject(t.payload[s],i)}if(t.blockPresences&&t.blockPresences.length){n.blockPresences=[];for(var s=0;s<t.blockPresences.length;++s)n.blockPresences[s]=Vt.Message.BlockPresence.toObject(t.blockPresences[s],i)}return t.pendingBytes!=null&&t.hasOwnProperty("pendingBytes")&&(n.pendingBytes=t.pendingBytes),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Sa.default.util.toJSONOptions)},r.Wantlist=function(){function e(t){if(this.entries=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.entries=Zt.emptyArray,e.prototype.full=!1,e.encode=function(i,n){if(n||(n=p3.create()),i.entries!=null&&i.entries.length)for(var s=0;s<i.entries.length;++s)Vt.Message.Wantlist.Entry.encode(i.entries[s],n.uint32(10).fork()).ldelim();return i.full!=null&&Object.hasOwnProperty.call(i,"full")&&n.uint32(16).bool(i.full),n},e.decode=function(i,n){i instanceof kc||(i=kc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Vt.Message.Wantlist;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.entries&&o.entries.length||(o.entries=[]),o.entries.push(Vt.Message.Wantlist.Entry.decode(i,i.uint32()));break;case 2:o.full=i.bool();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Vt.Message.Wantlist)return i;var n=new Vt.Message.Wantlist;if(i.entries){if(!Array.isArray(i.entries))throw TypeError(".Message.Wantlist.entries: array expected");n.entries=[];for(var s=0;s<i.entries.length;++s){if(typeof i.entries[s]!="object")throw TypeError(".Message.Wantlist.entries: object expected");n.entries[s]=Vt.Message.Wantlist.Entry.fromObject(i.entries[s])}}return i.full!=null&&(n.full=Boolean(i.full)),n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.entries=[]),n.defaults&&(s.full=!1),i.entries&&i.entries.length){s.entries=[];for(var o=0;o<i.entries.length;++o)s.entries[o]=Vt.Message.Wantlist.Entry.toObject(i.entries[o],n)}return i.full!=null&&i.hasOwnProperty("full")&&(s.full=i.full),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Sa.default.util.toJSONOptions)},e.WantType=function(){let t={},i=Object.create(t);return i[t[0]="Block"]=0,i[t[1]="Have"]=1,i}(),e.Entry=function(){function t(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return t.prototype.block=Zt.newBuffer([]),t.prototype.priority=0,t.prototype.cancel=!1,t.prototype.wantType=0,t.prototype.sendDontHave=!1,t.encode=function(n,s){return s||(s=p3.create()),n.block!=null&&Object.hasOwnProperty.call(n,"block")&&s.uint32(10).bytes(n.block),n.priority!=null&&Object.hasOwnProperty.call(n,"priority")&&s.uint32(16).int32(n.priority),n.cancel!=null&&Object.hasOwnProperty.call(n,"cancel")&&s.uint32(24).bool(n.cancel),n.wantType!=null&&Object.hasOwnProperty.call(n,"wantType")&&s.uint32(32).int32(n.wantType),n.sendDontHave!=null&&Object.hasOwnProperty.call(n,"sendDontHave")&&s.uint32(40).bool(n.sendDontHave),s},t.decode=function(n,s){n instanceof kc||(n=kc.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new Vt.Message.Wantlist.Entry;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.block=n.bytes();break;case 2:a.priority=n.int32();break;case 3:a.cancel=n.bool();break;case 4:a.wantType=n.int32();break;case 5:a.sendDontHave=n.bool();break;default:n.skipType(c&7);break}}return a},t.fromObject=function(n){if(n instanceof Vt.Message.Wantlist.Entry)return n;var s=new Vt.Message.Wantlist.Entry;switch(n.block!=null&&(typeof n.block=="string"?Zt.base64.decode(n.block,s.block=Zt.newBuffer(Zt.base64.length(n.block)),0):n.block.length&&(s.block=n.block)),n.priority!=null&&(s.priority=n.priority|0),n.cancel!=null&&(s.cancel=Boolean(n.cancel)),n.wantType){case"Block":case 0:s.wantType=0;break;case"Have":case 1:s.wantType=1;break}return n.sendDontHave!=null&&(s.sendDontHave=Boolean(n.sendDontHave)),s},t.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(s.bytes===String?o.block="":(o.block=[],s.bytes!==Array&&(o.block=Zt.newBuffer(o.block))),o.priority=0,o.cancel=!1,o.wantType=s.enums===String?"Block":0,o.sendDontHave=!1),n.block!=null&&n.hasOwnProperty("block")&&(o.block=s.bytes===String?Zt.base64.encode(n.block,0,n.block.length):s.bytes===Array?Array.prototype.slice.call(n.block):n.block),n.priority!=null&&n.hasOwnProperty("priority")&&(o.priority=n.priority),n.cancel!=null&&n.hasOwnProperty("cancel")&&(o.cancel=n.cancel),n.wantType!=null&&n.hasOwnProperty("wantType")&&(o.wantType=s.enums===String?Vt.Message.Wantlist.WantType[n.wantType]:n.wantType),n.sendDontHave!=null&&n.hasOwnProperty("sendDontHave")&&(o.sendDontHave=n.sendDontHave),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,Sa.default.util.toJSONOptions)},t}(),e}(),r.Block=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.prefix=Zt.newBuffer([]),e.prototype.data=Zt.newBuffer([]),e.encode=function(i,n){return n||(n=p3.create()),i.prefix!=null&&Object.hasOwnProperty.call(i,"prefix")&&n.uint32(10).bytes(i.prefix),i.data!=null&&Object.hasOwnProperty.call(i,"data")&&n.uint32(18).bytes(i.data),n},e.decode=function(i,n){i instanceof kc||(i=kc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Vt.Message.Block;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.prefix=i.bytes();break;case 2:o.data=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Vt.Message.Block)return i;var n=new Vt.Message.Block;return i.prefix!=null&&(typeof i.prefix=="string"?Zt.base64.decode(i.prefix,n.prefix=Zt.newBuffer(Zt.base64.length(i.prefix)),0):i.prefix.length&&(n.prefix=i.prefix)),i.data!=null&&(typeof i.data=="string"?Zt.base64.decode(i.data,n.data=Zt.newBuffer(Zt.base64.length(i.data)),0):i.data.length&&(n.data=i.data)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.prefix="":(s.prefix=[],n.bytes!==Array&&(s.prefix=Zt.newBuffer(s.prefix))),n.bytes===String?s.data="":(s.data=[],n.bytes!==Array&&(s.data=Zt.newBuffer(s.data)))),i.prefix!=null&&i.hasOwnProperty("prefix")&&(s.prefix=n.bytes===String?Zt.base64.encode(i.prefix,0,i.prefix.length):n.bytes===Array?Array.prototype.slice.call(i.prefix):i.prefix),i.data!=null&&i.hasOwnProperty("data")&&(s.data=n.bytes===String?Zt.base64.encode(i.data,0,i.data.length):n.bytes===Array?Array.prototype.slice.call(i.data):i.data),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Sa.default.util.toJSONOptions)},e}(),r.BlockPresenceType=function(){let e={},t=Object.create(e);return t[e[0]="Have"]=0,t[e[1]="DontHave"]=1,t}(),r.BlockPresence=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.cid=Zt.newBuffer([]),e.prototype.type=0,e.encode=function(i,n){return n||(n=p3.create()),i.cid!=null&&Object.hasOwnProperty.call(i,"cid")&&n.uint32(10).bytes(i.cid),i.type!=null&&Object.hasOwnProperty.call(i,"type")&&n.uint32(16).int32(i.type),n},e.decode=function(i,n){i instanceof kc||(i=kc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Vt.Message.BlockPresence;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.cid=i.bytes();break;case 2:o.type=i.int32();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Vt.Message.BlockPresence)return i;var n=new Vt.Message.BlockPresence;switch(i.cid!=null&&(typeof i.cid=="string"?Zt.base64.decode(i.cid,n.cid=Zt.newBuffer(Zt.base64.length(i.cid)),0):i.cid.length&&(n.cid=i.cid)),i.type){case"Have":case 0:n.type=0;break;case"DontHave":case 1:n.type=1;break}return n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.cid="":(s.cid=[],n.bytes!==Array&&(s.cid=Zt.newBuffer(s.cid))),s.type=n.enums===String?"Have":0),i.cid!=null&&i.hasOwnProperty("cid")&&(s.cid=n.bytes===String?Zt.base64.encode(i.cid,0,i.cid.length):n.bytes===Array?Array.prototype.slice.call(i.cid):i.cid),i.type!=null&&i.hasOwnProperty("type")&&(s.type=n.enums===String?Vt.Message.BlockPresenceType[i.type]:i.type),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Sa.default.util.toJSONOptions)},e}(),r})();var H4e=A(xh()),$4e={Block:Ns.Wantlist.WantType.Block,Have:Ns.Wantlist.WantType.Have},srt=(r,e)=>Array.prototype.slice.call(e,0).sort((t,i)=>{let n=r(t),s=r(i);return n<s?-1:n>s?1:0}),Dc=class{constructor(e,t){this.set=t?(0,H4e.default)({system:"ipfs",component:"bitswap",metric:"wantlist",metrics:t.metrics}):new Map,this._stats=e}get length(){return this.set.size}add(e,t,i){let n=e.toString(yt),s=this.set.get(n);s?(s.inc(),s.priority=t,s.wantType===$4e.Have&&i===$4e.Block&&(s.wantType=i)):(this.set.set(n,new z_(e,t,i)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){let t=e.toString(yt),i=this.set.get(t);!i||(i.dec(),!i.hasRefs()&&(this.set.delete(t),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(srt(e=>e[1].key,Array.from(this.set.entries())))}contains(e){let t=e.toString(yt);return this.set.has(t)}get(e){let t=e.toString(yt);return this.set.get(t)}};Dc.Entry=z_;di();var ort=Dc.Entry,jh=class{constructor(e,t,i,n,s){this.entry=new ort(e,t,i),this.cancel=Boolean(n),this.sendDontHave=Boolean(s)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(yt)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}};var Bo=(r,e)=>{let t=["bitswap"];return e&&t.push(e),r&&t.push(`${r.toB58String().slice(0,8)}`),Object.assign((0,dO.default)(t.join(":")),{error:(0,dO.default)(t.concat(["error"]).join(":"))})};var H_=(r,e)=>{if(r.size!==e.size)return!1;for(let[t,i]of r){let n=e.get(t);if(n===void 0||i instanceof Uint8Array&&n instanceof Uint8Array&&!Hs(i,n)||i instanceof jh&&n instanceof jh&&!i.equals(n))return!1}return!0};var Q4e=A(Y4e()),ur=class{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(e,t,i,n,s){i==null&&(i=ur.WantType.Block);let o=e.toString(yt),a=this.wantlist.get(o);a?(a.wantType===i&&(a.priority=t),n&&(a.cancel=Boolean(n)),s&&(a.sendDontHave=Boolean(s)),i===ur.WantType.Block&&a.wantType===ur.WantType.Have&&(a.wantType=i)):this.wantlist.set(o,new jh(e,t,i,n,s))}addBlock(e,t){let i=e.toString(yt);this.blocks.set(i,t)}addHave(e){let t=e.toString(yt);this.blockPresences.has(t)||this.blockPresences.set(t,ur.BlockPresenceType.Have)}addDontHave(e){let t=e.toString(yt);this.blockPresences.has(t)||this.blockPresences.set(t,ur.BlockPresenceType.DontHave)}cancel(e){let t=e.toString(yt);this.wantlist.delete(t),this.addEntry(e,0,ur.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),cancel:Boolean(t.cancel)})),full:this.full?!0:void 0},blocks:Array.from(this.blocks.values())};return Ns.encode(e).finish()}serializeToBitswap110(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),wantType:t.wantType,cancel:Boolean(t.cancel),sendDontHave:Boolean(t.sendDontHave)})),full:this.full?!0:void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(let[t,i]of this.blocks.entries()){let n=L.parse(t),s=n.version,o=n.code,a=n.multihash.code,c=n.multihash.digest.length,u=z4e([s,o,a,c]);e.payload.push(new Ns.Block({prefix:u,data:i}))}for(let[t,i]of this.blockPresences)e.blockPresences.push(new Ns.BlockPresence({cid:L.parse(t).bytes,type:i}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),Ns.encode(e).finish()}equals(e){return!(this.full!==e.full||this.pendingBytes!==e.pendingBytes||!H_(this.wantlist,e.wantlist)||!H_(this.blocks,e.blocks)||!H_(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){let e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}};ur.deserialize=async(r,e)=>{let t=Ns.decode(r),i=t.wantlist&&t.wantlist.full||!1,n=new ur(i);return t.wantlist&&t.wantlist.entries&&t.wantlist.entries.forEach(s=>{if(!s.block)return;let o=L.decode(s.block);n.addEntry(o,s.priority||0,s.wantType,Boolean(s.cancel),Boolean(s.sendDontHave))}),t.blockPresences&&t.blockPresences.forEach(s=>{if(!s.cid)return;let o=L.decode(s.cid);s.type===ur.BlockPresenceType.Have?n.addHave(o):n.addDontHave(o)}),t.blocks.length>0?(await Promise.all(t.blocks.map(async s=>{let o=await Lr.digest(s),a=L.createV0(o);n.addBlock(a,s)})),n):(t.payload.length>0&&(await Promise.all(t.payload.map(async s=>{if(!s.prefix||!s.data)return;let o=(0,X4e.default)(s.prefix),a=o[0],c=o[1],u=o[2],f=u===Lr.code?Lr:e&&await e.getHasher(u);if(!f)throw(0,Q4e.default)(new Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");let d=await f.digest(s.data),h=L.create(a,c,d);n.addBlock(h,s.data)})),n.setPendingBytes(t.pendingBytes)),n)};ur.blockPresenceSize=r=>r.bytes.length+1;ur.Entry=jh;ur.WantType={Block:Ns.Wantlist.WantType.Block,Have:Ns.Wantlist.WantType.Have};ur.BlockPresenceType={Have:Ns.BlockPresenceType.Have,DontHave:Ns.BlockPresenceType.DontHave};l();var hO=1e3,Z4e=3,J4e=10*hO,PLt=15*hO,CLt=15*hO,ebe=Math.pow(2,31)-1,tbe=1e3,rbe=1;l();var sbe=A(nbe());var pO=class{constructor(e,t,i){this.peerId=t,this.network=i,this.refcnt=1,this._entries=[],this._log=Bo(e,"msgqueue"),this.sendEntries=(0,sbe.default)(this._sendEntries.bind(this),rbe)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;let e=new ur(!1);this._entries.forEach(t=>{t.cancel?e.cancel(t.cid):e.addEntry(t.cid,t.priority)}),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(t){this._log.error("cant connect to peer %s: %s",this.peerId.toB58String(),t.message);return}this._log("sending message to peer %s",this.peerId.toB58String()),this.network.sendMessage(this.peerId,e).catch(t=>{this._log.error("send error: %s",t.message)})}};di();var obe=A(xh()),yO=class{constructor(e,t,i,n){this.peers=(0,obe.default)({system:"ipfs",component:"bitswap",metric:"want-manager-peers",metrics:n.metrics}),this.wantlist=new Dc(i,n),this.network=t,this._stats=i,this._peerId=e,this._log=Bo(e,"want")}_addEntries(e,t,i){let n=e.map((s,o)=>new ur.Entry(s,ebe-o,ur.WantType.Block,t));n.forEach(s=>{s.cancel?i?this.wantlist.removeForce(s.cid.toString(yt)):this.wantlist.remove(s.cid):(this._log("adding to wl"),this.wantlist.add(s.cid,s.priority))});for(let s of this.peers.values())s.addEntries(n)}_startPeerHandler(e){let t=this.peers.get(e.toB58String());if(t){t.refcnt++;return}t=new pO(this._peerId,e,this.network);let i=new ur(!0);for(let n of this.wantlist.entries())i.addEntry(n[1].cid,n[1].priority);return t.addMessage(i),this.peers.set(e.toB58String(),t),t}_stopPeerHandler(e){let t=this.peers.get(e.toB58String());!t||(t.refcnt--,!(t.refcnt>0)&&this.peers.delete(e.toB58String()))}wantBlocks(e,t={}){this._addEntries(e,!1),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>this.disconnected(e.peerId))}};l();var gO=A(go()),mO=A(dr()),abe=A(dw());var bO="/ipfs/bitswap/1.0.0",wO="/ipfs/bitswap/1.1.0",_O="/ipfs/bitswap/1.2.0",vO=class{constructor(e,t,i,n={}){this._log=Bo(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[bO],n.b100Only||(this._protocols.unshift(wO),this._protocols.unshift(_O)),this._stats=i,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=n.hashLoader}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection);let e=new abe.default({multicodecs:this._protocols,handlers:{onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect}});this._registrarId=await this._libp2p.registrar.register(e);for await(let t of this._libp2p.peerStore.getPeers()){let i=this._libp2p.connectionManager.get(t.id);i&&this._onPeerConnect(i.remotePeer)}}async stop(){this._running=!1,await this._libp2p.unhandle(this._protocols),this._registrarId!=null&&this._libp2p.registrar.unregister(this._registrarId)}async _onConnection({protocol:e,stream:t,connection:i}){if(!!this._running){this._log("incoming new bitswap %s connection from %s",e,i.remotePeer.toB58String());try{await(0,mO.pipe)(t,gO.default.decode(),async n=>{for await(let s of n)try{let o=await ur.deserialize(s.slice(),this._hashLoader);await this._bitswap._receiveMessage(i.remotePeer,o)}catch(o){this._bitswap._receiveError(o);break}})}catch(n){this._log(n)}}}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,t,i={}){return this._libp2p.contentRouting.findProviders(e,{timeout:J4e,maxNumProviders:t})}async findAndConnect(e,t){let i=[];for await(let n of this.findProviders(e,Z4e,t))this._log(`connecting to provider ${n.id}`),i.push(this.connectTo(n.id,t).catch(s=>{this._log.error(s)}));await Promise.all(i)}async provide(e,t){await this._libp2p.contentRouting.provide(e,t)}async sendMessage(e,t){if(!this._running)throw new Error("network isn't running");let i=e.toB58String();this._log("sendMessage to %s",i,t);let n=await this._libp2p.dial(e),{stream:s,protocol:o}=await n.newStream([_O,wO,bO]),a;switch(o){case bO:a=t.serializeToBitswap100();break;case wO:case _O:a=t.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+o)}urt(s,a,this._log),this._updateSentStats(e,t.blocks)}async connectTo(e,t){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,t)}_updateSentStats(e,t){let i=e.toB58String();if(this._stats){for(let n of t.values())this._stats.push(i,"dataSent",n.length);this._stats.push(i,"blocksSent",t.size)}}};async function urt(r,e,t){try{await(0,mO.pipe)([e],gO.default.encode(),r)}catch(i){t(i)}}l();we();di();l();var EO=class{constructor(e){this.partner=e,this.wantlist=new Dc,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=e}wants(e,t,i){this.wantlist.add(e,t,i)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}};l();l();var $_=class extends Map{constructor(e,t){super();this._cmp=t||this._defaultSort,this._keys=[];for(let[i,n]of e||[])this.set(i,n)}update(e){if(e<0||e>=this._keys.length)return;let t=this._keys[e];this._keys.splice(e,1);let i=this._find(t);this._keys.splice(i,0,t)}set(e,t){if(this.has(e)){let n=this.indexOf(e);this._keys.splice(n,1)}super.set(e,t);let i=this._find(e);return this._keys.splice(i,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;let t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;let t=this._find(e);if(this._keys[t]===e)return t;for(let i=1;i<this._keys.length;i++){if(this._keys[t+i]===e)return t+i;if(this._keys[t-i]===e)return t-i}return-1}_find(e){let t=0,i=this._keys.length;for(;t<i;){let n=t+i>>>1,s=this._kCmp(this._keys[n],e);if(s<0)t=n+1;else if(s>0)i=n;else return n}return t}*keys(){for(let e of this._keys)yield e}*values(){for(let e of this._keys)yield this.get(e)}*entries(){for(let e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,t){if(!!e)for(let i of this._keys)e.apply(t,[[i,this.get(i)]])}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}};var lrt={hasNewInfo(){return!1},merge(){}},SO=class{constructor(e=lrt){this._taskMerger=e,this._byPeer=new $_([],AO.compare)}pushTasks(e,t){let i=this._byPeer.get(e.toB58String());i||(i=new AO(e,this._taskMerger)),i.pushTasks(t),this._byPeer.set(e.toB58String(),i)}popTasks(e){let t=this._head();if(t===void 0)return{tasks:[],pendingSize:0};let{tasks:i,pendingSize:n}=t.popTasks(e);if(i.length===0)return{tasks:i,pendingSize:n};let s=t.peerId;return t.isIdle()?this._byPeer.delete(s.toB58String()):this._byPeer.update(0),{peerId:s,tasks:i,pendingSize:n}}_head(){if(this._byPeer.size!==0)for(let[,e]of this._byPeer)return e}remove(e,t){let i=this._byPeer.get(t.toB58String());i&&i.remove(e)}tasksDone(e,t){let i=this._byPeer.get(e.toB58String());if(!i)return;let n=this._byPeer.indexOf(e.toB58String());for(let s of t)i.taskDone(s);this._byPeer.update(n)}},AO=class{constructor(e,t){this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new cbe,this._active=new Set}pushTasks(e){for(let t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;let t=this._pending.get(e.topic);if(t){e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),this._taskMerger.merge(e,t);return}this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){let t=[];for(let i of this._active)i.topic===e.topic&&t.push(i);return t.length===0?!0:this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0,i=[],n=this._pending.tasks();for(let s=0;s<n.length&&t<e;s++){let o=n[s];i.push(o),t+=o.size,this._pending.delete(o.topic),this._activeTotalSize+=o.size,this._active.add(o)}return{tasks:i,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(e,t){return e[1]._pending.length===0?1:t[1]._pending.length===0?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}},cbe=class{constructor(){this._tasks=new $_([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,t)=>e+t.task.size,0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,t){let i=this._tasks.get(e);if(!i)return;let n=this._tasks.indexOf(e);i.task.priority=t,this._tasks.update(n)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}};l();var ube={hasNewInfo(r,e){let t=!1,i=!1;for(let n of e)n.data.haveBlock&&(t=!0),n.data.isWantBlock&&(i=!0);return!!(!i&&r.data.isWantBlock||!t&&r.data.haveBlock)},merge(r,e){let t=r.data,i=e.data;!i.haveBlock&&t.haveBlock&&(i.haveBlock=t.haveBlock,i.blockSize=t.blockSize),!i.isWantBlock&&t.isWantBlock&&(i.isWantBlock=!0,(!i.haveBlock||t.haveBlock)&&(i.haveBlock=t.haveBlock,e.size=r.size)),i.isWantBlock&&i.haveBlock&&(e.size=i.blockSize)}};var lbe=A(xh()),fbe=ur.WantType,frt=16*1024,drt=1024,RO=class{constructor(e,t,i,n,s,o={}){this._log=Bo(e,"engine"),this.blockstore=t,this.network=i,this._stats=n,this._opts=this._processOpts(o),this.ledgerMap=(0,lbe.default)({system:"ipfs",component:"bitswap",metric:"ledger-map",metrics:s.metrics}),this._running=!1,this._requestQueue=new SO(ube)}_processOpts(e){return{maxSizeReplaceHasWithBlock:drt,targetMessageSize:frt,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}async _processTasks(){if(!this._running)return;let{peerId:e,tasks:t,pendingSize:i}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(t.length===0)return;let n=new ur(!1);n.setPendingBytes(i);let s=[],o=new Map;for(let c of t){let u=L.parse(c.topic);c.data.haveBlock?c.data.isWantBlock?(s.push(u),o.set(c.topic,c.data)):n.addHave(u):n.addDontHave(u)}let a=await this._getBlocks(s);for(let[c,u]of o){let f=L.parse(c),d=a.get(c);d?n.addBlock(f,d):u.sendDontHave&&n.addDontHave(f)}if(n.empty){e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks();return}try{e&&await this.network.sendMessage(e,n);for(let[c,u]of a.entries())e&&this.messageSent(e,L.parse(c),u)}catch(c){this._log.error(c)}e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks()}wantlistForPeer(e){let t=e.toB58String(),i=this.ledgerMap.get(t);return i?i.wantlist.sortedEntries():new Map}ledgerForPeer(e){let t=e.toB58String(),i=this.ledgerMap.get(t);return i?{peer:i.partner,value:i.debtRatio(),sent:i.accounting.bytesSent,recv:i.accounting.bytesRecv,exchanged:i.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){if(!!e.length){for(let t of this.ledgerMap.values())for(let i of e){let n=t.wantlistContains(i.cid);if(!n)continue;let s=i.data.length,o=this._sendAsBlock(n.wantType,s),a=s;o||(a=ur.blockPresenceSize(n.cid)),this._requestQueue.pushTasks(t.partner,[{topic:n.cid.toString(yt),priority:n.priority,size:a,data:{blockSize:s,isWantBlock:o,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,t){let i=this._findOrCreate(e);if(t.empty)return;if(t.full&&(i.wantlist=new Dc),this._updateBlockAccounting(t.blocks,i),t.wantlist.size===0){this._scheduleProcessTasks();return}let n=[],s=[];t.wantlist.forEach(o=>{o.cancel?(i.cancelWant(o.cid),n.push(o.cid)):(i.wants(o.cid,o.priority,o.wantType),s.push(o))}),this._cancelWants(e,n),await this._addWants(e,s),this._scheduleProcessTasks()}_cancelWants(e,t){for(let i of t)this._requestQueue.remove(i.toString(yt),e)}async _addWants(e,t){let i=await this._getBlockSizes(t.map(s=>s.cid)),n=[];for(let s of t){let o=s.cid.toString(yt),a=i.get(o);if(a==null)s.sendDontHave&&n.push({topic:o,priority:s.priority,size:ur.blockPresenceSize(s.cid),data:{isWantBlock:s.wantType===fbe.Block,blockSize:0,haveBlock:!1,sendDontHave:s.sendDontHave}});else{let c=this._sendAsBlock(s.wantType,a),u=a;c||(u=ur.blockPresenceSize(s.cid)),n.push({topic:o,priority:s.priority,size:u,data:{isWantBlock:c,blockSize:a,haveBlock:!0,sendDontHave:s.sendDontHave}})}this._requestQueue.pushTasks(e,n)}}_sendAsBlock(e,t){return e===fbe.Block||t<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){let t=await this._getBlocks(e);return new Map([...t].map(([i,n])=>[i,n.length]))}async _getBlocks(e){let t=new Map;return await Promise.all(e.map(async i=>{try{let n=await this.blockstore.get(i);t.set(i.toString(yt),n)}catch(n){n.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",i,n)}})),t}_updateBlockAccounting(e,t){for(let i of e.values())this._log("got block (%s bytes)",i.length),t.receivedBytes(i.length)}messageSent(e,t,i){let n=this._findOrCreate(e);n.sentBytes(i.length),n.wantlist.remove(t)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){this.ledgerMap.delete(e.toB58String())}_findOrCreate(e){let t=e.toB58String(),i=this.ledgerMap.get(t);if(i)return i;let n=new EO(e);return this.ledgerMap.set(t,n),this._stats&&this._stats.push(t,"peerCount",1),n}start(){this._running=!0}stop(){this._running=!1}};l();var dbe=A(Ut());et();var hbe=r=>`unwant:${$e(r.multihash.bytes,"base64")}`,pbe=r=>`block:${$e(r.multihash.bytes,"base64")}`,xO=class extends dbe.EventEmitter{constructor(e){super();this.setMaxListeners(tbe),this._log=Bo(e,"notif")}hasBlock(e,t){let i=pbe(e);this._log(i),this.emit(i,t)}wantBlock(e,t={}){if(!e)throw new Error("Not a valid cid");let i=pbe(e),n=hbe(e);return this._log(`wantBlock:${e}`),new Promise((s,o)=>{let a=()=>{this.removeListener(i,c),o(new Error(`Block for ${e} unwanted`))},c=u=>{this.removeListener(n,a),s(u)};this.once(n,a),this.once(i,c),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.removeListener(i,c),this.removeListener(n,a),o(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){let t=hbe(e);this._log(t),this.emit(t)}};l();var gbe=A(Ut());l();var ybe=A(Ut()),IO=A(LC()),G_=class extends ybe.EventEmitter{constructor(e,t){super();this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(i=>{this._stats[i]=BigInt(0),this._movingAverages[i]={},this._options.movingAverageIntervals.forEach(n=>{(this._movingAverages[i][n]=(0,IO.default)(n)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){let t=e=this._queue.shift();t&&this._applyOp(t)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let t=e-this._frequencyLastTime;t&&Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let s=n/t*1e3,o=this._movingAverages[e];o||(o=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(a=>{let c=o[a];c||(c=o[a]=(0,IO.default)(a)),c.push(i,s)})}_applyOp(e){let t=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(i),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=i}};var mbe=A(xh()),bbe={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]},TO=class extends gbe.EventEmitter{constructor(e,t=[],i=bbe){super();let n=Object.assign({},bbe,i);if(typeof n.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof n.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=t,this._options=n,this._enabled=this._options.enabled,this._global=new G_(t,n),this._global.on("update",s=>this.emit("update",s)),this._peers=(0,mbe.default)({system:"ipfs",component:"bitswap",metric:"stats-peers",metrics:e.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(let e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){let t=typeof e!="string"&&e.toB58String?e.toB58String():`${e}`;return this._peers.get(t)}push(e,t,i){if(this._enabled&&(this._global.push(t,i),e)){let n=this._peers.get(e);n||(n=new G_(this._initialCounters,this._options),this._peers.set(e,n)),n.push(t,i)}}disconnected(e){let t=e.toB58String(),i=this._peers.get(t);i&&(i.stop(),this._peers.delete(t))}};var wbe=A($o());we();var hrt={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},prt=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"],PO=class extends wu{constructor(e,t,i={}){super();this._libp2p=e,this._log=Bo(this.peerId),this._options=Object.assign({},hrt,i),this._stats=new TO(e,prt,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new vO(e,this,this._stats,{hashLoader:i.hashLoader}),this.blockstore=t,this.engine=new RO(this.peerId,t,this.network,this._stats,e),this.wm=new yO(this.peerId,this.network,this._stats,e),this.notifications=new xO(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,t){try{await this.engine.messageReceived(e,t)}catch(n){this._log("failed to receive message",t)}if(t.blocks.size===0)return;let i=[];for(let[n,s]of t.blocks.entries()){let o=L.parse(n);i.push({wasWanted:this.wm.wantlist.contains(o),cid:o,data:s})}this.wm.cancelWants(i.filter(({wasWanted:n})=>n).map(({cid:n})=>n)),await Promise.all(i.map(({cid:n,wasWanted:s,data:o})=>this._handleReceivedBlock(e,n,o,s)))}async _handleReceivedBlock(e,t,i,n){this._log("received block");let s=await this.blockstore.has(t);this._updateReceiveCounters(e.toB58String(),t,i,s),!!n&&await this.put(t,i)}_updateReceiveCounters(e,t,i,n){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",i.length),n&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",i.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,t={}){let i=(u,f)=>(this.wm.wantBlocks([u],f),this.notifications.wantBlock(u,f)),n=!1,s=async(u,f)=>{try{return await this.blockstore.get(u,f)}catch(d){if(d.code!=="ERR_NOT_FOUND")throw d;return n||(n=!0,this.network.findAndConnect(u).catch(h=>this._log.error(h))),i(u,f)}},o=new AbortController,a=t.signal?(0,wbe.anySignal)([t.signal,o.signal]):o.signal,c=await Promise.race([this.notifications.wantBlock(e,{signal:a}),s(e,{signal:a})]);return o.abort(),c}async*getMany(e,t={}){for await(let i of e)yield this.get(i,t)}unwant(e){let t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach(i=>this.notifications.unwantBlock(i))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,t,i){await this.blockstore.put(e,t),this._sendHaveBlockNotifications(e,t)}async*putMany(e,t){for await(let{key:i,value:n}of this.blockstore.putMany(e,t))this._sendHaveBlockNotifications(i,n),yield{key:i,value:n}}_sendHaveBlockNotifications(e,t){this.notifications.hasBlock(e,t),this.engine.receivedBlocks([{cid:e,data:t}]),this.network.provide(e).catch(i=>{this._log.error("Failed to provide: %s",i.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this._stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}};var _be=(r,e,t={})=>new PO(r,e,t);var Ibe=A(lt()),Tbe=A(St());l();l();var OO={};Pt(OO,{abortedError:()=>grt,notFoundError:()=>Abe});l();var CO=A(Sbe());function Abe(r){return r=r||new Error("Not Found"),(0,CO.default)(r,"ERR_NOT_FOUND")}function grt(r){return r=r||new Error("Aborted"),(0,CO.default)(r,"ERR_ABORTED")}l();rn();Vs();we();tn();var LMt={...OO};var Rbe=A(Al()),kO=A(Za()),xbe=A(is()),DO=class extends wu{constructor(e,t){super();this.child=e,this.bitswap=t}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(e,t,i={}){await this.has(e)||(this.bitswap.isStarted()?await this.bitswap.put(e,t,i):await this.child.put(e,t,i))}async*putMany(e,t={}){let i=(0,xbe.default)(e,async({key:n})=>!await this.has(n));this.bitswap.isStarted()?yield*this.bitswap.putMany(i,t):yield*this.child.putMany(i,t)}async get(e,t={}){return!await this.has(e)&&this.bitswap.isStarted()?this.bitswap.get(e,t):this.child.get(e,t)}async*getMany(e,t={}){let i=(0,kO.default)(),n=(0,kO.default)();Promise.resolve().then(async()=>{for await(let s of e)!await this.has(s)&&this.bitswap.isStarted()?i.push(s):n.push(s);i.end(),n.end()}),yield*(0,Rbe.default)(this.bitswap.getMany(i,t),this.child.getMany(n,t))}async delete(e,t){await this.child.delete(e,t)}async*deleteMany(e,t){yield*this.child.deleteMany(e,t)}async has(e,t={}){return this.child.has(e,t)}async*query(e,t={}){yield*this.child.query(e,t)}async*queryKeys(e,t={}){yield*this.child.queryKeys(e,t)}};var y3=class{constructor(e,t,i,n,s){this.peerId=e,this.libp2p=t,this.bitswap=i,this.repo=n,this.blockstore=s}static async start({peerId:e,repo:t,print:i,hashers:n,options:s}){t.closed&&await t.open();let o=await t.config.getAll(),a=await l3({options:s,repo:t,peerId:e,multiaddrs:mrt(e,o),config:o,keychainConfig:void 0});a.keychain&&await a.loadKeychain(),await a.start();for(let f of a.multiaddrs)i(`Swarm listening on ${f}/p2p/${e.toB58String()}`);let c=_be(a,t.blocks,{statsEnabled:!0,hashLoader:n});await c.start();let u=new DO(t.blocks,c);return t.blocks=u,t.pins.blockstore=u,new y3(e,a,c,t,u)}static async stop(e){e.repo.blocks=e.blockstore.unwrap(),e.repo.pins.blockstore=e.blockstore.unwrap(),await e.bitswap.stop(),await e.libp2p.stop()}},mrt=(r,e)=>{let t=r.toB58String(),i=[],n=e.Addresses&&e.Addresses.Swarm||[];for(let s of n){let o=new Ibe.Multiaddr(s);if(o.protoCodes().includes(brt))throw(0,Tbe.default)(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");let a=o.getPeerId();a&&a!==t&&(o=o.encapsulate(`/p2p/${t}`)),i.push(o)}return i},brt=479;l();l();function Pbe({network:r}){async function e(t={}){let i=[],{libp2p:n}=await r.use(t);for await(let s of n.peerStore.getPeers())i.push({id:s.id.toB58String(),addrs:s.addresses.map(o=>o.multiaddr)});return i}return Q(e)}l();function Cbe({network:r}){async function e(t,i={}){let{libp2p:n}=await r.use(i);await n.dial(t,i)}return Q(e)}l();function Obe({network:r}){async function e(t,i={}){let{libp2p:n}=await r.use(i);await n.hangUp(t)}return Q(e)}l();function kbe({network:r}){async function e(t={}){let{libp2p:i}=await r.use(t);return i.multiaddrs}return Q(e)}l();function Dbe({network:r}){async function e(t={}){let{libp2p:i}=await r.use(t),n=[];for(let[s,o]of i.connections)for(let a of o){let c={addr:a.remoteAddr,peer:s};(t.verbose||t.direction)&&(c.direction=a.stat.direction),t.verbose&&(c.muxer=a.stat.multiplexer,c.latency="n/a",c.streams=[]),n.push(c)}return n}return Q(e)}var NO=class{constructor({network:e}){this.addrs=Pbe({network:e}),this.connect=Cbe({network:e}),this.disconnect=Obe({network:e}),this.localAddrs=kbe({network:e}),this.peers=Dbe({network:e})}};l();var Nbe=A(st());var g3={success:!0,time:0,text:""};function Bbe({network:r}){async function*e(t,i={}){let{libp2p:n}=await r.use();i.count=i.count||10;let s=Nbe.default.createFromB58String(t),o=await n.peerStore.get(s),a=o&&o.id;if(!a){yield{...g3,text:`Looking up peer ${t}`};let f=await n.peerRouting.findPeer(s);a=f&&f.id}if(!a)throw new Error("Peer was not found");yield{...g3,text:`PING ${a.toB58String()}`};let c=0,u=0;for(let f=0;f<i.count;f++)try{let d=await n.ping(a);u+=d,c++,yield{...g3,time:d}}catch(d){yield{...g3,success:!1,text:d.toString()}}if(c){let f=u/c;yield{...g3,text:`Average latency: ${f}ms`}}}return Q(e)}l();var BO=A(st()),W_=A(St());var Lbe=A(N2());var qh=A(wn());we();di();Ly();Ri();at();var LO="/ipns/";function Mbe(r){r.startsWith(LO)&&(r=r.substring(LO.length));let e;if((r[0]==="1"||r[0]==="Q")&&(r=`z${r}`),r[0]==="z"&&(e=yt.decode(r)),r[0]==="k"&&(e=fp.decode(r)),!e)throw new Error("Could not parse string");if(e[0]!==1&&e[1]!==114&&(e=Li([[1,114],e])),e.length!==40)throw new Error("Incorrect length "+e.length);return Li([Qe(LO),e.subarray(2)])}function dy(r){if(r.name==="SENDING_QUERY")return{type:r.type,name:r.name,to:r.to.toB58String()};if(r.name==="PEER_RESPONSE")return{type:r.type,name:r.name,messageType:r.messageType,messageName:r.messageName,closer:r.closer.map(({id:e,multiaddrs:t})=>({id:e.toB58String(),multiaddrs:t})),providers:r.providers.map(({id:e,multiaddrs:t})=>({id:e.toB58String(),multiaddrs:t})),record:r.record,from:r.from.toB58String()};if(r.name==="FINAL_PEER")return{type:r.type,name:r.name,from:r.from.toB58String(),peer:{id:r.peer.id.toB58String(),multiaddrs:r.peer.multiaddrs}};if(r.name==="QUERY_ERROR")return{type:r.type,name:r.name,error:r.error,from:r.from.toB58String()};if(r.name==="PROVIDER")return{type:r.type,name:r.name,providers:r.providers.map(({id:e,multiaddrs:t})=>({id:e.toB58String(),multiaddrs:t})),from:r.from.toB58String()};if(r.name==="VALUE")return{type:r.type,name:r.name,value:r.value,from:r.from.toB58String()};if(r.name==="ADDING_PEER")return{type:r.type,name:r.name,peer:r.peer.toB58String()};if(r.name==="DIALING_PEER")return{type:r.type,name:r.name,peer:r.peer.toB58String()};throw(0,W_.default)(new Error("Unknown DHT event type"),"ERR_UNKNOWN_DHT_EVENT")}function jbe({network:r,repo:e,peerId:t}){let{get:i,put:n,findProvs:s,findPeer:o,provide:a,query:c}={async*get(u,f={}){let{libp2p:d}=await hy(r,t,f),h=u instanceof Uint8Array?u:Mbe(u);yield*(0,qh.default)(d._dht.get(h,f),dy)},async*put(u,f,d){let{libp2p:h}=await hy(r,t,d),p=u instanceof Uint8Array?u:Mbe(u);yield*(0,qh.default)(h._dht.put(p,f),dy)},async*findProvs(u,f={}){let{libp2p:d}=await hy(r,t,f);yield*(0,qh.default)(d._dht.findProviders(u,{signal:f.signal}),dy)},async*findPeer(u,f={}){let{libp2p:d}=await hy(r,t,f);yield*(0,qh.default)(d._dht.findPeer(BO.default.parse(u),{signal:f.signal}),dy)},async*provide(u,f={recursive:!1}){let{libp2p:d}=await hy(r,t,f);if(!await e.blocks.has(u))throw(0,W_.default)(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(f.recursive)throw(0,W_.default)(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");yield*(0,qh.default)(d._dht.provide(u),dy)},async*query(u,f={}){let{libp2p:d}=await hy(r,t,f),h,p=L.asCID(u);p!=null?h=p.multihash.bytes:h=BO.default.parse(u.toString()).toBytes(),yield*(0,qh.default)(d._dht.getClosestPeers(h,f),dy)}};return{get:Q(i),put:Q(n),findProvs:Q(s),findPeer:Q(o),provide:Q(a),query:Q(c)}}var hy=async(r,e,t)=>{let i=await r.use(t);if((0,Lbe.default)(i.libp2p,"_config.dht.enabled",!1))return i;{let n=async function*(){yield{from:e,name:"QUERY_ERROR",type:3,error:new La("dht not enabled")}};return{libp2p:{_dht:{get:n,put:n,findProvs:n,findPeer:n,provide:n,query:n}}}}};l();var qbe=A(St());var Ube=A(N2());function Fbe({network:r,config:e}){let t=(0,Ube.default)(e||{},"Pubsub.Enabled",!0);return{subscribe:t?Q(i):m3,unsubscribe:t?Q(n):m3,publish:t?Q(s):m3,ls:t?Q(o):m3,peers:t?Q(a):m3};async function i(c,u,f={}){let{libp2p:d}=await r.use(f);return d.pubsub.subscribe(c,u,f)}async function n(c,u,f={}){let{libp2p:d}=await r.use(f);d.pubsub.unsubscribe(c,u,f)}async function s(c,u,f={}){let{libp2p:d}=await r.use(f);if(!u)throw(0,qbe.default)(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await d.pubsub.publish(c,u)}async function o(c={}){let{libp2p:u}=await r.use(c);return u.pubsub.getTopics()}async function a(c,u={}){let{libp2p:f}=await r.use(u);return f.pubsub.getSubscribers(c)}}var m3=async()=>{throw new La("pubsub not enabled")};var _rt=Ct.bind({ignoreUndefined:!0}),Cf=Object.assign((0,MO.default)("ipfs"),{error:(0,MO.default)("ipfs:error")}),Vbe=class{constructor({print:e,storage:t,codecs:i,options:n}){let{peerId:s,repo:o,keychain:a}=t,c=kn.create(y3),u=kY(n.preload),f=cj(),d=uj({network:c}),h=new dS(n),p=Object.values(i4);(n.ipld&&n.ipld.hashers?n.ipld.hashers:[]).forEach(Be=>p.push(Be)),this.hashers=new dm({hashers:p,loadHasher:n.ipld&&n.ipld.loadHasher});let y=Object.values(Uf);(n.ipld&&n.ipld.bases?n.ipld.bases:[]).forEach(Be=>y.push(Be)),this.bases=new lm({bases:y,loadBase:n.ipld&&n.ipld.loadBase});let g=new u9({repo:o,codecs:i}),w=new RS({codecs:i,hashers:this.hashers,preload:u,repo:o}),b=new wS({dns:f,ipns:h,repo:o,codecs:i,peerId:s,isOnline:d,keychain:a,options:n}),v=vF({repo:o,codecs:i,bases:this.bases,name:b}),R=new XA({repo:o,codecs:i,hashers:this.hashers,preload:u}),k=Object.assign(FV({repo:o,codecs:i,resolve:v,preload:u}),{local:KV({repo:t.repo})}),{add:C,addAll:T,cat:D,get:j,ls:M}=new jA({preload:u,repo:o,options:n.EXPERIMENTAL,hashers:this.hashers}),se=nQ({repo:o,preload:u,hashers:this.hashers,options:n}),ie=DY({files:se,preload:u,options:n.preload});this.preload=u,this.name=b,this.ipns=h,this.pin=g,this.resolve=v,this.block=w,this.refs=k,this.start=TM({network:c,peerId:s,repo:o,preload:u,ipns:h,mfsPreload:ie,print:e,keychain:a,hashers:this.hashers,options:n}),this.stop=PM({network:c,preload:u,mfsPreload:ie,ipns:h,repo:o}),this.dht=jbe({network:c,repo:o,peerId:s}),this.pubsub=Fbe({network:c,config:n.config}),this.dns=f,this.isOnline=d,this.id=GW({network:c,peerId:s}),this.version=VW({repo:o}),this.bitswap=new ES({network:c}),this.bootstrap=new SS({repo:o}),this.config=QW({repo:o}),this.ping=Bbe({network:c}),this.add=C,this.addAll=T,this.cat=D,this.get=j,this.ls=M,this.dag=R,this.files=se,this.key=new pR({keychain:a}),this.object=new mR({preload:u,codecs:i,repo:o}),this.repo=new bR({repo:o,hashers:this.hashers}),this.stats=new wR({repo:o,network:c}),this.swarm=new NO({network:c}),Object.defineProperty(this,"libp2p",{get(){let Be=c.try();return Be?Be.libp2p:void 0}});let fe=()=>Promise.reject((0,jO.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),pe=async function*(){throw(0,jO.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=fe,this.diag={cmds:fe,net:fe,sys:fe},this.log={level:fe,ls:fe,tail:pe},this.mount=fe,this.codecs=i}async init(){throw new Ba}},vrt=async r=>{let e=ut({Data:new dt({type:"directory"}).marshal(),Links:[]}),t=await r.block.put(e,{mhtype:"sha2-256",format:"dag-pb"});return await r.pin.add(t),t},Ert=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!Kbe.isTest,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}});async function zbe(r={}){r=_rt(Ert(),r);let e=r.init||{},t={name:bs.name,code:bs.code,encode:u=>u,decode:u=>u},i=Object.values(n4);[Tn,ky,Ny,wrt,t].concat(r.ipld&&r.ipld.codecs||[]).forEach(u=>i.push(u));let n=new fm({codecs:i,loadCodec:r.ipld&&r.ipld.loadCodec}),s=r.silent?Cf:console.log;Cf("creating repo");let o=await d3.start(s,n,r);Cf("getting repo config");let a=await o.repo.config.getAll(),c=new Vbe({storage:o,print:s,codecs:n,options:{...r,config:a}});if(Cf("starting preload"),await c.preload.start(),Cf("starting storage"),c.ipns.startOffline(o),o.isNew&&!e.emptyRepo){let u=await vrt(c);Cf("adding default assets"),await LB({addAll:c.addAll,print:s}),Cf("initializing IPNS keyspace"),await c.ipns.initializeKeyspace(o.peerId.privKey,Qe(`/ipfs/${u}`))}return r.start!==!1&&(Cf("starting node"),await c.start()),c}var Hbe=A(Qa()),$be=A(Sp()),Gbe=A(st()),Wbe=A(cT()),Ybe=A(uT());we();var Xbe=A(lt()),Srt=zbe,Art=Hbe.default,Rrt=$be.default,xrt=Gbe.default,Irt=Wbe.default,Trt=Ybe.default;return Prt;})();
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/**
 * Timestamp for 64-bit time_t, nanosecond precision and strftime
 *
 * @author Yusuke Kawasaki
 * @license MIT
 * @see https://github.com/kawanet/timestamp-nano
 */
return IpfsCore}));
